/*! For license information please see 767.1251ba93.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkalter_buddy=self.webpackChunkalter_buddy||[]).push([[767],{5767:(e,t,n)=>{n.r(t),n.d(t,{HMSEffectsPlugin:()=>o});var r=n(5650),i="https://assets.100ms.live/effectsdk/3.2.3/",o=class{constructor(e,t){this.blurAmount=0,this.background="none",this.backgroundType="none",this.preset="balanced",this.initialised=!1,this.intervalId=null,this.effects=new r.tsvb(e),this.onInit=t,this.effects.config({sdk_url:i,models:{colorcorrector:"",facedetector:"",lowlighter:""},wasmPaths:{"ort-wasm.wasm":"".concat(i,"ort-wasm.wasm"),"ort-wasm-simd.wasm":"".concat(i,"ort-wasm-simd.wasm")}}),this.canvas=document.createElement("canvas"),this.effects.onError((e=>{(!e.type||"error"===e.type)&&console.error("[HMSEffectsPlugin]",e)})),this.effects.cache(),this.effects.onReady=()=>{var e;this.effects&&(this.initialised=!0,null==(e=this.onInit)||e.call(this),this.effects.run(),this.effects.setBackgroundFitMode("fill"),this.effects.setSegmentationPreset(this.preset),this.applyEffect())}}getName(){return"HMSEffects"}executeAfterInit(e){this.initialised&&e(),null!==this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval((()=>{this.initialised&&(clearInterval(this.intervalId),e())}),100)}removeBlur(){this.blurAmount=0,this.executeAfterInit((()=>{this.effects.clearBlur()}))}removeBackground(){this.background="",this.executeAfterInit((()=>{this.effects.clearBackground()}))}setBlur(e){this.blurAmount=e,this.backgroundType="blur",this.removeBackground(),this.executeAfterInit((()=>{this.effects.setBlur(this.blurAmount)}))}setPreset(e){return((e,t,n)=>new Promise(((r,i)=>{var o=e=>{try{s(n.next(e))}catch(t){i(t)}},a=e=>{try{s(n.throw(e))}catch(t){i(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())})))(this,null,(function*(){return this.preset=e,new Promise(((e,t)=>{this.executeAfterInit((()=>{this.effects.setSegmentationPreset(this.preset).then(e).catch(t)}))}))}))}onResolutionChange(e){this.onResolutionChangeCallback=e}getPreset(){return this.preset}removeEffects(){this.backgroundType="none",this.removeBackground(),this.removeBlur()}setBackground(e){this.background=e,this.backgroundType="image",this.removeBlur(),this.executeAfterInit((()=>{this.effects.setBackground(this.background)}))}getBlurAmount(){return this.blurAmount}getBackground(){return this.background||this.backgroundType}updateCanvas(e){let{height:t,width:n}=e.getVideoTracks()[0].getSettings();this.canvas.width=n,this.canvas.height=t,this.effects.useStream(e),this.effects.toCanvas(this.canvas)}apply(e){return this.effects.clear(),this.applyEffect(),this.effects.onChangeInputResolution((()=>{var t;this.updateCanvas(e);let{height:n,width:r}=e.getVideoTracks()[0].getSettings();null==(t=this.onResolutionChangeCallback)||t.call(this,r,n)})),this.updateCanvas(e),this.canvas.captureStream(30)||e}stop(){this.removeEffects(),this.executeAfterInit((()=>{this.effects.stop()}))}applyEffect(){this.blurAmount?this.setBlur(this.blurAmount):this.background&&this.setBackground(this.background)}}},5650:(module,exports,__webpack_require__)=>{var __filename="/index.js",__dirname="/",__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;Object.defineProperty(exports,"__esModule",{value:!0}),exports.tsvb=void 0;var _excluded=["region"],_excluded2=["chars","padding","resolution","textureWidth","textureHeight"];function _wrapNativeSuper(e){var t="function"===typeof Map?new Map:void 0;return _wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)},_wrapNativeSuper(e)}function _construct(e,t,n){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&_setPrototypeOf(i,n.prototype),i}function _isNativeFunction(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"===typeof e}}function _objectWithoutProperties(e,t){if(null==e)return{};var n,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function _get(){return _get="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},_get.apply(this,arguments)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_typeof(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(_typeof(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _createForOfIteratorHelper(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _asyncIterator(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new AsyncFromSyncIterator(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return AsyncFromSyncIterator=function(e){this.s=e,this.n=e.next},AsyncFromSyncIterator.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new AsyncFromSyncIterator(e)}var __webpack_modules__={4912:function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,o),!0;case 6:return l.fn.call(l.context,t,r,i,o,a),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,i);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},6240:function(e){var t;t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isNotPNG=function(e){return e===a},t.isNotAPNG=function(e){return e===s},t.default=function(e){var t=new Uint8Array(e);if(Array.prototype.some.call(u,(function(e,n){return e!==t[n]})))return a;var n=!1;if(c(t,(function(e){return!(n="acTL"===e)})),!n)return s;var r=[],i=[],l=null,p=null,y=0,g=new o.APNG;if(c(t,(function(e,t,n,a){var s=new DataView(t.buffer);switch(e){case"IHDR":l=t.subarray(n+8,n+8+a),g.width=s.getUint32(n+8),g.height=s.getUint32(n+12);break;case"acTL":g.numPlays=s.getUint32(n+8+4);break;case"fcTL":p&&(g.frames.push(p),y++),(p=new o.Frame).width=s.getUint32(n+8+4),p.height=s.getUint32(n+8+8),p.left=s.getUint32(n+8+12),p.top=s.getUint32(n+8+16);var u=s.getUint16(n+8+20),c=s.getUint16(n+8+22);0===c&&(c=100),p.delay=1e3*u/c,p.delay<=10&&(p.delay=100),g.playTime+=p.delay,p.disposeOp=s.getUint8(n+8+24),p.blendOp=s.getUint8(n+8+25),p.dataParts=[],0===y&&2===p.disposeOp&&(p.disposeOp=1);break;case"fdAT":p&&p.dataParts.push(t.subarray(n+8+4,n+8+a));break;case"IDAT":p&&p.dataParts.push(t.subarray(n+8,n+8+a));break;case"IEND":i.push(h(t,n,12+a));break;default:r.push(h(t,n,12+a))}})),p&&g.frames.push(p),0==g.frames.length)return s;var m=new Blob(r),v=new Blob(i);return g.frames.forEach((function(e){var t=[];t.push(u),l.set(d(e.width),0),l.set(d(e.height),4),t.push(f("IHDR",l)),t.push(m),e.dataParts.forEach((function(e){return t.push(f("IDAT",e))})),t.push(v),e.imageData=new Blob(t,{type:"image/png"}),delete e.dataParts,t=null})),g};var r,i=(r=n(1))&&r.__esModule?r:{default:r},o=n(2),a=new Error("Not a PNG"),s=new Error("Not an animated PNG"),u=new Uint8Array([137,80,78,71,13,10,26,10]);function c(e,t){var n=new DataView(e.buffer),r=8,i=void 0,o=void 0,a=void 0;do{o=n.getUint32(r),a=t(i=l(e,r+4,4),e,r,o),r+=12+o}while(!1!==a&&"IEND"!=i&&r<e.length)}function l(e,t,n){var r=Array.prototype.slice.call(e.subarray(t,t+n));return String.fromCharCode.apply(String,r)}function h(e,t,n){var r=new Uint8Array(n);return r.set(e.subarray(t,t+n)),r}var f=function(e,t){var n=e.length+t.length,r=new Uint8Array(n+8),o=new DataView(r.buffer);o.setUint32(0,t.length),r.set(function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e),4),r.set(t,8);var a=(0,i.default)(r,4,n);return o.setUint32(n+4,a),r},d=function(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1,i=t,o=t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-t);i<o;i++)r=r>>>8^n[255&(r^e[i])];return~r};for(var n=new Uint32Array(256),r=0;r<256;r++){for(var i=r,o=0;o<8;o++)i=0!=(1&i)?3988292384^i>>>1:i>>>1;n[r]=i}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Frame=t.APNG=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(r=n(3))&&r.__esModule?r:{default:r};function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.APNG=function(){function e(){a(this,e),this.width=0,this.height=0,this.numPlays=0,this.playTime=0,this.frames=[]}return i(e,[{key:"createImages",value:function(){return Promise.all(this.frames.map((function(e){return e.createImage()})))}},{key:"getPlayer",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.createImages().then((function(){return new o.default(t,e,n)}))}}]),e}(),t.Frame=function(){function e(){a(this,e),this.left=0,this.top=0,this.width=0,this.height=0,this.delay=0,this.disposeOp=0,this.blendOp=0,this.imageData=null,this.imageElement=null}return i(e,[{key:"createImage",value:function(){var e=this;return this.imageElement?Promise.resolve():new Promise((function(t,n){var r=URL.createObjectURL(e.imageData);e.imageElement=document.createElement("img"),e.imageElement.onload=function(){URL.revokeObjectURL(r),t()},e.imageElement.onerror=function(){URL.revokeObjectURL(r),e.imageElement=null,n(new Error("Image creation error"))},e.imageElement.src=r}))}}]),e}()},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.playbackRate=1,i._currentFrameNumber=0,i._ended=!1,i._paused=!0,i._numPlays=0,i._apng=e,i.context=n,i.stop(),r&&i.play(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length,this._currentFrameNumber===this._apng.frames.length-1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._ended=!0,this._paused=!0)),this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var e=this.currentFrame;this._prevFrame=e,this._prevFrameData=null,2==e.disposeOp&&(this._prevFrameData=this.context.getImageData(e.left,e.top,e.width,e.height)),0==e.blendOp&&this.context.clearRect(e.left,e.top,e.width,e.height),this.context.drawImage(e.imageElement,e.left,e.top),this.emit("frame",this._currentFrameNumber),this._ended&&this.emit("end")}},{key:"play",value:function(){var e=this;this.emit("play"),this._ended&&this.stop(),this._paused=!1;var t=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame((function n(r){if(!e._ended&&!e._paused){if(r>=t){for(;r-t>=e._apng.playTime/e.playbackRate;)t+=e._apng.playTime/e.playbackRate,e._numPlays++;do{e.renderNextFrame(),t+=e.currentFrame.delay/e.playbackRate}while(!e._ended&&r>t)}requestAnimationFrame(n)}}))}},{key:"pause",value:function(){this._paused||(this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this.emit("stop"),this._numPlays=0,this._ended=!1,this._paused=!0,this._currentFrameNumber=-1,this.context.clearRect(0,0,this._apng.width,this._apng.height),this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]),t}(((r=n(4))&&r.__esModule?r:{default:r}).default);t.default=o},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"object"==_typeof(e)&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,a,s,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(o(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(i(n))for(s=Array.prototype.slice.call(arguments,1),a=(c=n.slice()).length,u=0;u<a;u++)c[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var a;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(a=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var n,o,a,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=s;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}}])},e.exports=t()},9899:function(e,t,n){e.exports=n(2860)},1816:function(e,t,n){var r=n(2652),i=n(1776),o=n(2484),a=n(3640),s=n(6784),u=n(320),c=n(8104),l=n(5108),h=n(288),f=n(6432);e.exports=function(e){return new Promise((function(t,n){var d,p=e.data,y=e.headers,g=e.responseType;function m(){e.cancelToken&&e.cancelToken.unsubscribe(d),e.signal&&e.signal.removeEventListener("abort",d)}r.isFormData(p)&&delete y["Content-Type"];var v=new XMLHttpRequest;if(e.auth){var w=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";y.Authorization="Basic "+btoa(w+":"+b)}var x=s(e.baseURL,e.url);function _(){if(v){var r="getAllResponseHeaders"in v?u(v.getAllResponseHeaders()):null,o={data:g&&"text"!==g&&"json"!==g?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:r,config:e,request:v};i((function(e){t(e),m()}),(function(e){n(e),m()}),o),v=null}}if(v.open(e.method.toUpperCase(),a(x,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,"onloadend"in v?v.onloadend=_:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(_)},v.onabort=function(){v&&(n(l("Request aborted",e,"ECONNABORTED",v)),v=null)},v.onerror=function(){n(l("Network Error",e,null,v)),v=null},v.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||h;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",v)),v=null},r.isStandardBrowserEnv()){var I=(e.withCredentials||c(x))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;I&&(y[e.xsrfHeaderName]=I)}"setRequestHeader"in v&&r.forEach(y,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete y[t]:v.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),g&&"json"!==g&&(v.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&v.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(d=function(e){v&&(n(!e||e&&e.type?new f("canceled"):e),v.abort(),v=null)},e.cancelToken&&e.cancelToken.subscribe(d),e.signal&&(e.signal.aborted?d():e.signal.addEventListener("abort",d))),p||(p=null),v.send(p)}))}},2860:function(e,t,n){var r=n(2652),i=n(9504),o=n(2508),a=n(6183),s=function e(t){var n=new o(t),s=i(o.prototype.request,n);return r.extend(s,o.prototype,n),r.extend(s,n),s.create=function(n){return e(a(t,n))},s}(n(5260));s.Axios=o,s.Cancel=n(6432),s.CancelToken=n(6312),s.isCancel=n(9864),s.VERSION=n(8340).version,s.all=function(e){return Promise.all(e)},s.spread=n(9092),s.isAxiosError=n(6288),e.exports=s,e.exports.default=s},6432:function(e){function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},6312:function(e,t,n){var r=n(6432);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},9864:function(e){e.exports=function(e){return!(!e||!e.__CANCEL__)}},2508:function(e,t,n){var r=n(2652),i=n(3640),o=n(2747),a=n(9088),s=n(6183),u=n(5984),c=u.validators;function l(e){this.defaults=e,this.interceptors={request:new o,response:new o}}l.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&u.assertOptions(n,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var r=[],i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));var o,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!i){var h=[a,void 0];for(Array.prototype.unshift.apply(h,r),h=h.concat(l),o=Promise.resolve(t);h.length;)o=o.then(h.shift(),h.shift());return o}for(var f=t;r.length;){var d=r.shift(),p=r.shift();try{f=d(f)}catch(e){p(e);break}}try{o=a(f)}catch(e){return Promise.reject(e)}for(;l.length;)o=o.then(l.shift(),l.shift());return o},l.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),e.exports=l},2747:function(e,t,n){var r=n(2652);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},6784:function(e,t,n){var r=n(7992),i=n(344);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},5108:function(e,t,n){var r=n(7544);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}},9088:function(e,t,n){var r=n(2652),i=n(712),o=n(9864),a=n(5260),s=n(6432);function u(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}e.exports=function(e){return u(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},7544:function(e){e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},6183:function(e,t,n){var r=n(2652);e.exports=function(e,t){t=t||{};var n={};function i(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function o(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(e[n],t[n])}function a(e){if(!r.isUndefined(t[e]))return i(void 0,t[e])}function s(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(void 0,t[n])}function u(n){return n in t?i(e[n],t[n]):n in e?i(void 0,e[n]):void 0}var c={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:u};return r.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||o,i=t(e);r.isUndefined(i)&&t!==u||(n[e]=i)})),n}},1776:function(e,t,n){var r=n(5108);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},712:function(e,t,n){var r=n(2652),i=n(5260);e.exports=function(e,t,n){var o=this||i;return r.forEach(n,(function(n){e=n.call(o,e,t)})),e}},5260:function(e,t,n){var r=n(6512),i=n(2652),o=n(7700),a=n(7544),s=n(288),u={"Content-Type":"application/x-www-form-urlencoded"};function c(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,h={transitional:s,adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==r&&"[object process]"===Object.prototype.toString.call(r))&&(l=n(1816)),l),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(c(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(c(t,"application/json"),function(e){if(i.isString(e))try{return(0,JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||h.transitional,n=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||r&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw a(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){h.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){h.headers[e]=i.merge(u)})),e.exports=h},288:function(e){e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},8340:function(e){e.exports={version:"0.26.1"}},9504:function(e){e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},3640:function(e,t,n){var r=n(2652);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},344:function(e){e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},2484:function(e,t,n){var r=n(2652);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},7992:function(e){e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},6288:function(e,t,n){var r=n(2652);e.exports=function(e){return r.isObject(e)&&!0===e.isAxiosError}},8104:function(e,t,n){var r=n(2652);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},7700:function(e,t,n){var r=n(2652);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},320:function(e,t,n){var r=n(2652),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},9092:function(e){e.exports=function(e){return function(t){return e.apply(null,t)}}},5984:function(e,t,n){var r=n(8340).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return _typeof(n)===e||"a"+(t<1?"n ":" ")+e}}));var o={};i.transitional=function(e,t,n){function i(e,t){return"[Axios v"+r+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,a){if(!1===e)throw new Error(i(r," has been removed"+(t?" in "+t:"")));return t&&!o[r]&&(o[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,a)}},e.exports={assertOptions:function(e,t,n){if("object"!=_typeof(e))throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var o=r[i],a=t[o];if(a){var s=e[o],u=void 0===s||a(s,o,e);if(!0!==u)throw new TypeError("option "+o+" must be "+u)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:i}},2652:function(e,t,n){var r=n(9504),i=Object.prototype.toString;function o(e){return Array.isArray(e)}function a(e){return void 0===e}function s(e){return"[object ArrayBuffer]"===i.call(e)}function u(e){return null!==e&&"object"==_typeof(e)}function c(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===i.call(e)}function h(e,t){if(null!=e)if("object"!=_typeof(e)&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:s,isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===i.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&s(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isPlainObject:c,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:l,isStream:function(e){return u(e)&&l(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===i.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:h,merge:function e(){var t={};function n(n,r){c(t[r])&&c(n)?t[r]=e(t[r],n):c(n)?t[r]=e({},n):o(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)h(arguments[r],n);return t},extend:function(e,t,n){return h(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},5620:function(e,t,n){n.d(t,{M:function(){return c}});function r(e){return r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},r(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:String(t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=o((function e(){s(this,e)}));u.APP_ENV="web",u.API_URL="https://effectssdk.ai/sdk/session/",u.STATS_URL="https://effectssdk.ai/sdk/stats/",u.BASE_URL="https://effectssdk.ai/",u.SDK_URL=u.BASE_URL+"sdk/",u.VB_MODEL=u.SDK_URL+"models/model-1.2.1.tsvb",u.PRESET="balanced",u.DEMO_IMAGE=u.SDK_URL+"100.jpg",u.DEMO_VIDEO=u.SDK_URL+"video-background.mp4";var c=function(){function e(){s(this,e)}return o(e,null,[{key:"getModelUrl",value:function(t){return e.SDK_URL+t}},{key:"getPresetUrl",value:function(t){return e.SDK_URL+t}},{key:"setVersion",value:function(){e.VERSION="3.2.3"}}]),e}();c.VERSION="0.0.0",c.CUSTOMER_ID="",c.APP_ENV=u.APP_ENV,c.API_URL=u.API_URL,c.STATS_URL=u.STATS_URL,c.MODEL_URL=u.SDK_URL+"models/model-1.2.1.tsvb",c.PRESET=u.PRESET,c.SDK_URL=u.SDK_URL,c.MODELS={colorcorrector:"models/model-cc-1.0.0.tsvb",facedetector:"models/model-fd-1.1.0.tsvb",lowlighter:"models/model-ll-1.2.0.tsvb"},c.PROXY=!0,c.STATS=!1,c.PROVIDER="wasm",c.WASM_PATHS={},c.PRESETS={quality:"models/model-1.0.1.tsvb",balanced:"models/model-5.5.0.tsvb",speed:"models/model-3.1.1.tsvb",lightning:"models/model-4.0.1.tsvb"},c.PRESETS_PORTRAIT={quality:"models/m-model-1.0.1.tsvb",balanced:"models/m-model-5.5.0.tsvb",speed:"models/m-model-3.1.1.tsvb",lightning:"models/m-model-4.0.1.tsvb"},c.STATES_PRESET={overlay:!1,overlay_attrs:{url:"https://effectssdk.ai/assets/videos/overlay/esdk.mp4"},lowerthird:!1,lowerthird_type:"lowerthird_3",lowerthird_text:{text:{title:"Max Troshin",subtitle:"CEO at Effects SDK / effectssdk.com"}},lowerthird_color:{color:{primary:161271}},lowerthird_offset:{offset:{x:15/1280,y:75/720}},emoji_duration:{duration:3500},emoji_size:{size:.3},emoji_position:{position:{placement:"top-left"}},giphy_duration:{duration:3500},giphy_size:{size:.3},giphy_position:{position:{placement:"top-left"}},seg_mode:"balanced",background:"none",layout:"center",layout_custom:void 0,blur:!0,blur_power:.6,beautification:!0,beauty_power:.68,boundary:0,frameskipping:!1,sz_switch:!0,sz_facearea:.1,sz_drawface:!1,sz_drawprefaces:!1,sz_accuracy:.75,sz_smoothing:.2,sz_period:100,cc_switch:!1,cc_power:1,cc_part:1,cc_period:1e3,cf_switch:!1,cf_lut:{lut:"none"},cf_part:{part:1},cf_power:{power:1},cf_capacity:{capacity:5},sh_switch:!1,sh_power:.5}},1140:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},r(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:String(t)}n.d(t,{E7:function(){return s},cL:function(){return a},ie:function(){return u}});var a,s,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}],(n=[{key:"subscribe",value:function(e){var t="function"==typeof e;this.onErrorFunction=t?e:void 0}},{key:"notify",value:function(e){"function"==typeof this.onErrorFunction&&(e.emitter&&(e.message="[ ".concat(e.emitter," ]: ").concat(e.message)),e.type||(e.type=a.ERROR),this.onErrorFunction(e))}}])&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}().getInstance();!function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error"}(a||(a={})),function(e){e.TSVB="tsvb",e.COMPONENTS_SYSTEM="components_system",e.SRTEAM_PROCESSOR="stream_processor",e.ML_INFERENCE="ml_inference",e.PRESET_INIT="preset_init",e.RENDERER="renderer",e.RECORDER="recorder",e.EFFECT_VIRTUAL_BACKGROUND="effect_virtual_background",e.EFFECT_COLOR_CORRECTION="effect_color_correction",e.EFFECT_COLOR_FILTER="effect_color_filter",e.EFFECT_SMART_ZOOM="effect_smart_zoom",e.EFFECT_LOW_LIGHT="effect_low_light"}(s||(s={}))},4220:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},r(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:String(t)}n.d(t,{w:function(){return a}});var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"createPromise",value:function(){var e=this;return this._promise=new Promise((function(t,n){e.resolver=t,e.rejecter=n})),this._promise}},{key:"promise",get:function(){return this._promise}},{key:"resolve",value:function(e){if("function"!=typeof this.resolver)return!1;this.resolver(e),this.resolver=void 0}},{key:"reject",value:function(e){if("function"!=typeof this.rejecter)return!1;this.rejecter(e),this.rejecter=void 0,this._promise=void 0}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9456:function(e,t,n){function r(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}n.d(t,{cB:function(){return P},CS:function(){return p},k7:function(){return d}});var i=n(5620),o=n(4941),a=n(9899),s=n.n(a);function u(e){return u="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},u(e)}function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:String(t)}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=[],this.delay=5e3,this.isRunning=!1,this.deferred=new Set}var t,n,r;return t=e,r=[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}],(n=[{key:"setCustomerID",value:function(e){this.customer_id=e}},{key:"push",value:function(e){var t=this;i.M.STATS&&(this.checkRunning(e),this.isRunning?(clearTimeout(this.timer),this.data.push({feature:e,user_id:o.i.getInstance().getUID(this.customer_id)}),this.timer=setTimeout((function(){return t.send()}),this.delay)):this.deferred.add(e))}},{key:"send",value:function(){var e=this,t=c(this.data);this.data=[];var n=i.M.STATS_URL+this.customer_id,r={"Tsvb-Version":i.M.VERSION};s().post(n,t,{headers:r}).catch((function(n){return e.data=[].concat(c(t),c(e.data)),n}))}},{key:"checkRunning",value:function(e){var t=this,n=o.i.getInstance().getUID(this.customer_id);"run"===e&&(this.isRunning=!0,this.deferred.forEach((function(e){t.data.push({feature:e,user_id:n})})),this.deferred.clear())}}])&&h(t.prototype,n),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return function(t,n,i){var o=i.value;i.value=function(){var t=n+r(e);d.Instance.push(t);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return o.apply(this,a)}}}function y(e){return y="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},y(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:String(t)}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"isStattable",value:function(e,t){var n;return(null!==(n=this.FEATURES[e])&&void 0!==n?n:[]).includes(t)}}],null&&g(t.prototype,null),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function w(e){return w="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},w(e)}function b(){b=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new R(r||[]);return i(a,"_invoke",{value:T(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function x(){}var _={};c(_,a,(function(){return this}));var I=Object.getPrototypeOf,A=I&&I(I(B([])));A&&A!==n&&r.call(A,a)&&(_=A);var C=x.prototype=m.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==w(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=E(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function E(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function B(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(w(t)+" is not iterable")}return v.prototype=x,i(C,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:v,configurable:!0}),v.displayName=c(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,u,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},k(S.prototype),c(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new S(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(C),c(C,u,"Generator"),c(C,a,(function(){return this})),c(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=B,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:B(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}v.FEATURES={recorder:["start","stop","pause","resume"],tsvb:["run","stop","enableBeautification","disableBeautification","setBlur","clearBlur","setBackground","clearBackground","enableSmartZoom","disableSmartZoom","enableColorCorrector","disableColorCorrector","enableFrameSkipping","disableFrameSkipping","setLayout","enableColorFilter","disableColorFilter","setSegmentationPreset","enableLowLightEffect","disableLowLightEffect","enableSharpnessEffect","disableSharpnessEffect"]},v.SDK_RUNNING_INTERVALS=[{feature:"run5",delay_ms:3e5},{feature:"run10",delay_ms:3e5},{feature:"run15",delay_ms:3e5},{feature:"run20",delay_ms:3e5}];var x=b().mark(A);function _(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){var t,n,r;return b().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=_(e),i.prev=1,t.s();case 3:if((n=t.n()).done){i.next=9;break}return r=n.value,i.next=7,r;case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(1),t.e(i.t0);case 14:return i.prev=14,t.f(),i.finish(14);case 17:case"end":return i.stop()}}),x,null,[[1,11,14,17]])}function C(e){return C="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},C(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function S(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:String(t)}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}],(n=[{key:"setFeatureData",value:function(e,t){this.feature=t,this.type=e}},{key:"handle",value:function(){this.isDisableToPush()||(this.pushStat(),this.isSdkRunFeature()&&(clearTimeout(this.sdkRunningTimer),this.intervalIterator=A(v.SDK_RUNNING_INTERVALS),this.handleSdkRunningInterval()),this.isSdkStopFeature()&&clearTimeout(this.sdkRunningTimer))}},{key:"isDisableToPush",value:function(){return!v.isStattable(this.type,this.feature)||!!this.isEqualLastPushedFeature()}},{key:"pushStat",value:function(){var e=this.getFeatureName();d.Instance.push(e),this.lastPushedFeature=e}},{key:"getFeatureName",value:function(){var e="tsvb"!==this.type?r(this.type):"";return this.feature+e}},{key:"isSdkRunFeature",value:function(){return"tsvb"===this.type&&"run"===this.feature}},{key:"isSdkStopFeature",value:function(){return"tsvb"===this.type&&"stop"===this.feature}},{key:"isEqualLastPushedFeature",value:function(){return this.lastPushedFeature===this.getFeatureName()}},{key:"handleSdkRunningInterval",value:function(){var e=this.intervalIterator.next(),t=e.value;e.done||this.startSdkRunningTimer(t.feature,t.delay_ms)}},{key:"startSdkRunningTimer",value:function(e,t){var n=this;this.sdkRunningTimer=setTimeout((function(){d.Instance.push(e),n.handleSdkRunningInterval()}),t)}}])&&k(t.prototype,n),i&&k(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}().getInstance();function E(e){return E="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},E(e)}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){return function(t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(Object.getOwnPropertyNames(t.prototype));try{var i=function(){var r=n.value,i=Object.getOwnPropertyDescriptor(t.prototype,r);if(!i)return 0;var o=i.value;if(!(o instanceof Function))return 0;i.value=function(){T.setFeatureData(e,r),T.handle();for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=o.apply(this,n);if("object"===E(a)&&"function"==typeof a.then){var s=a.then((function(){}));"function"==typeof s.catch&&s.catch((function(e){return e}))}return a},Object.defineProperty(t.prototype,r,i)};for(r.s();!(n=r.n()).done;)i()}catch(e){r.e(e)}finally{r.f()}}}},4941:function(e,t,n){function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}n.d(t,{i:function(){return y}});var i,o=function e(t,n){function i(e,i,o){if("undefined"!=typeof document){"number"==typeof(o=r({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var s in o)o[s]&&(a+="; "+s,!0!==o[s]&&(a+="="+o[s].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+a}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var o=n[i].split("="),a=o.slice(1).join("=");try{var s=decodeURIComponent(o[0]);if(r[s]=t.read(a,s),e===s)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){i(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},s=new Uint8Array(16);function u(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(s)}for(var c=[],l=0;l<256;++l)c.push((l+256).toString(16).slice(1));var h=function(e,t,n){if(a.randomUUID&&!t&&!e)return a.randomUUID();var r=(e=e||{}).random||(e.rng||u)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]}(r)};function f(e){return f="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},f(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:String(t)}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}],(n=[{key:"getUID",value:function(e){if(this._uid)return this._uid;var t=o.get("TSVB_UID");return t||(t=h(),o.set("TSVB_UID",t)),t}},{key:"setUID",value:function(e){this._uid=e}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},5704:function(e,t){t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=s(e),a=o[0],u=o[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,u)),l=0,h=u>0?a-4:a;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;return 2===u&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[l++]=255&t),1===u&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,c=r-i;s<c;s+=a)o.push(u(e,s,s+a>c?c:s+a));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},3296:function(e,t,n){var r=n(5704),i=n(4404),o=n(9600);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=s(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return G(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return k(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function w(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,r){return H(G(t,e.length-n),e,n,r)}function x(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return x(e,t,n,r)}function I(e,t,n,r){return H(z(t),e,n,r)}function A(e,t,n,r){return H(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function k(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,c=e[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=S));return n}(r)}t.Sn=u,t.ZK=50,u.TYPED_ARRAY_SUPPORT=void 0!==n.g.TYPED_ARRAY_SUPPORT?n.g.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?k(this,0,e):y.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.ZK;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(r,i),l=e.slice(t,n),h=0;h<s;++h)if(c[h]!==l[h]){o=c[h],a=l[h];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return x(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function O(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=j(e[o]);return i}function P(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function M(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function L(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,o){return o||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||B(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||B(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);B(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);B(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=u.isBuffer(e)?e:G(new u(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}},2768:function(e,t,n){var r=n(6604),i=n(4572),o=i(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&o(e,".prototype.")>-1?i(n):n}},4572:function(e,t,n){var r=n(268),i=n(6604),o=n(2392),a=n(6556),s=i("%Function.prototype.apply%"),u=i("%Function.prototype.call%"),c=i("%Reflect.apply%",!0)||r.call(u,s),l=n(8252),h=i("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=c(r,u,arguments);return o(t,1+h(0,e.length-(arguments.length-1)),!0)};var f=function(){return c(r,s,arguments)};l?l(e.exports,"apply",{value:f}):e.exports.apply=f},1528:function(e,t,n){var r=n(6384);function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(e){var t=new i;t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var o=0;o<n.length;++o){var a=n[o];if("array"===a||"object"==_typeof(a)&&a.blockIndices){if(t.argTypes[o]="array",t.arrayArgs.push(o),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)t.scalarArgs.push(o),t.shimArgs.push("scalar"+o);else if("index"===a){if(t.indexArgs.push(o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(t.shapeArgs.push(o),o<t.pre.args.length&&t.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<t.post.args.length&&t.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=_typeof(a)||!a.offset)throw new Error("cwise: Unknown argument type "+n[o]);t.argTypes[o]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(o)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,r(t)}},9676:function(e,t,n){var r=n(2248);function i(e,t,n){var r,i,o=e.length,a=t.arrayArgs.length,s=t.indexArgs.length>0,u=[],c=[],l=0,h=0;for(r=0;r<o;++r)c.push(["i",r,"=0"].join(""));for(i=0;i<a;++i)for(r=0;r<o;++r)h=l,l=e[r],0===r?c.push(["d",i,"s",r,"=t",i,"p",l].join("")):c.push(["d",i,"s",r,"=(t",i,"p",l,"-s",h,"*t",i,"p",h,")"].join(""));for(c.length>0&&u.push("var "+c.join(",")),r=o-1;r>=0;--r)l=e[r],u.push(["for(i",r,"=0;i",r,"<s",l,";++i",r,"){"].join(""));for(u.push(n),r=0;r<o;++r){for(h=l,l=e[r],i=0;i<a;++i)u.push(["p",i,"+=d",i,"s",r].join(""));s&&(r>0&&u.push(["index[",h,"]-=s",h].join("")),u.push(["++index[",l,"]"].join(""))),u.push("}")}return u.join("\n")}function o(e,t,n){for(var r=e.body,i=[],o=[],a=0;a<e.args.length;++a){var s=e.args[a];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),c="",l=t.arrayArgs.indexOf(a);switch(t.argTypes[a]){case"offset":var h=t.offsetArgIndex.indexOf(a);l=t.offsetArgs[h].array,c="+q"+h;case"array":c="p"+l+c;var f="l"+a,d="a"+l;if(0===t.arrayBlockIndices[l])1===s.count?"generic"===n[l]?s.lvalue?(i.push(["var ",f,"=",d,".get(",c,")"].join("")),r=r.replace(u,f),o.push([d,".set(",c,",",f,")"].join(""))):r=r.replace(u,[d,".get(",c,")"].join("")):r=r.replace(u,[d,"[",c,"]"].join("")):"generic"===n[l]?(i.push(["var ",f,"=",d,".get(",c,")"].join("")),r=r.replace(u,f),s.lvalue&&o.push([d,".set(",c,",",f,")"].join(""))):(i.push(["var ",f,"=",d,"[",c,"]"].join("")),r=r.replace(u,f),s.lvalue&&o.push([d,"[",c,"]=",f].join("")));else{for(var p=[s.name],y=[c],g=0;g<Math.abs(t.arrayBlockIndices[l]);g++)p.push("\\s*\\[([^\\]]+)\\]"),y.push("$"+(g+1)+"*t"+l+"b"+g);if(u=new RegExp(p.join(""),"g"),c=y.join("+"),"generic"===n[l])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(u,[d,"[",c,"]"].join(""))}break;case"scalar":r=r.replace(u,"Y"+t.scalarArgs.indexOf(a));break;case"index":r=r.replace(u,"index");break;case"shape":r=r.replace(u,"shape")}}}return[i.join("\n"),r,o.join("\n")].join("\n").trim()}function a(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var i=e[r],o=i.match(/\d+/);o=o?o[0]:"",0===i.charAt(0)?t[r]="u"+i.charAt(1)+o:t[r]=i.charAt(0)+o,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}e.exports=function(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,s=new Array(e.arrayArgs.length),u=new Array(e.arrayArgs.length),c=0;c<e.arrayArgs.length;++c)u[c]=t[2*c],s[c]=t[2*c+1];var l=[],h=[],f=[],d=[],p=[];for(c=0;c<e.arrayArgs.length;++c){e.arrayBlockIndices[c]<0?(f.push(0),d.push(n),l.push(n),h.push(n+e.arrayBlockIndices[c])):(f.push(e.arrayBlockIndices[c]),d.push(e.arrayBlockIndices[c]+n),l.push(0),h.push(e.arrayBlockIndices[c]));for(var y=[],g=0;g<s[c].length;g++)f[c]<=s[c][g]&&s[c][g]<d[c]&&y.push(s[c][g]-f[c]);p.push(y)}var m=["SS"],v=["'use strict'"],w=[];for(g=0;g<n;++g)w.push(["s",g,"=SS[",g,"]"].join(""));for(c=0;c<e.arrayArgs.length;++c){for(m.push("a"+c),m.push("t"+c),m.push("p"+c),g=0;g<n;++g)w.push(["t",c,"p",g,"=t",c,"[",f[c]+g,"]"].join(""));for(g=0;g<Math.abs(e.arrayBlockIndices[c]);++g)w.push(["t",c,"b",g,"=t",c,"[",l[c]+g,"]"].join(""))}for(c=0;c<e.scalarArgs.length;++c)m.push("Y"+c);if(e.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),e.indexArgs.length>0){var b=new Array(n);for(c=0;c<n;++c)b[c]="0";w.push(["index=[",b.join(","),"]"].join(""))}for(c=0;c<e.offsetArgs.length;++c){var x=e.offsetArgs[c],_=[];for(g=0;g<x.offset.length;++g)0!==x.offset[g]&&(1===x.offset[g]?_.push(["t",x.array,"p",g].join("")):_.push([x.offset[g],"*t",x.array,"p",g].join("")));0===_.length?w.push("q"+c+"=0"):w.push(["q",c,"=",_.join("+")].join(""))}var I=r([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((w=w.concat(I)).length>0&&v.push("var "+w.join(",")),c=0;c<e.arrayArgs.length;++c)v.push("p"+c+"|=0");e.pre.body.length>3&&v.push(o(e.pre,e,u));var A=o(e.body,e,u),C=function(e){for(var t=0,n=e[0].length;t<n;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}(p);C<n?v.push(function(e,t,n,r){for(var o=t.length,a=n.arrayArgs.length,s=n.blockSize,u=n.indexArgs.length>0,c=[],l=0;l<a;++l)c.push(["var offset",l,"=p",l].join(""));for(l=e;l<o;++l)c.push(["for(var j"+l+"=SS[",t[l],"]|0;j",l,">0;){"].join("")),c.push(["if(j",l,"<",s,"){"].join("")),c.push(["s",t[l],"=j",l].join("")),c.push(["j",l,"=0"].join("")),c.push(["}else{s",t[l],"=",s].join("")),c.push(["j",l,"-=",s,"}"].join("")),u&&c.push(["index[",t[l],"]=j",l].join(""));for(l=0;l<a;++l){for(var h=["offset"+l],f=e;f<o;++f)h.push(["j",f,"*t",l,"p",t[f]].join(""));c.push(["p",l,"=(",h.join("+"),")"].join(""))}for(c.push(i(t,n,r)),l=e;l<o;++l)c.push("}");return c.join("\n")}(C,p[0],e,A)):v.push(i(p[0],e,A)),e.post.body.length>3&&v.push(o(e.post,e,u)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+v.join("\n")+"\n----------");var k=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",C,a(u)].join("");return new Function(["function ",k,"(",m.join(","),"){",v.join("\n"),"} return ",k].join(""))()}},6384:function(e,t,n){var r=n(9676);e.exports=function(e){var t=["'use strict'","var CACHED={}"],n=[],i=e.funcName+"_cwise_thunk";t.push(["return function ",i,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],u=[],c=[],l=0;l<e.arrayArgs.length;++l){var h=e.arrayArgs[l];n.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),o.push("t"+h),o.push("r"+h),a.push("t"+h),a.push("r"+h+".join()"),s.push("array"+h+".data"),s.push("array"+h+".stride"),s.push("array"+h+".offset|0"),l>0&&(u.push("array"+e.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[l]))),c.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[l])+"]"))}for(e.arrayArgs.length>1&&(t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),l=0;l<e.scalarArgs.length;++l)s.push("scalar"+e.scalarArgs[l]);return n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(r.bind(void 0,e))}},5456:function(e,t,n){var r=n(8252),i=n(7668),o=n(6556),a=n(872);e.exports=function(e,t,n){if(!e||"object"!=_typeof(e)&&"function"!=typeof e)throw new o("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=_typeof(t))throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,l=arguments.length>6&&arguments[6],h=!!a&&a(e,t);if(r)r(e,t,{configurable:null===c&&h?h.configurable:!c,enumerable:null===s&&h?h.enumerable:!s,value:n,writable:null===u&&h?h.writable:!u});else{if(!l&&(s||u||c))throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=n}}},1948:function(e){function t(e,t,r){r=r||2;var o,a,s,u,h,f,p,y=t&&t.length,g=y?t[0]*r:e.length,m=n(e,0,g,r,!0),v=[];if(!m||m.next===m.prev)return v;if(y&&(m=function(e,t,r,i){var o,a,s,u=[];for(o=0,a=t.length;o<a;o++)(s=n(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i,!1))===s.next&&(s.steiner=!0),u.push(d(s));for(u.sort(c),o=0;o<u.length;o++)r=l(u[o],r);return r}(e,t,m,r)),e.length>80*r){o=s=e[0],a=u=e[1];for(var w=r;w<g;w+=r)(h=e[w])<o&&(o=h),(f=e[w+1])<a&&(a=f),h>s&&(s=h),f>u&&(u=f);p=0!==(p=Math.max(s-o,u-a))?32767/p:0}return i(m,v,r,o,a,p,0),v}function n(e,t,n,r,i){var o,a;if(i===k(e,t,n,r)>0)for(o=t;o<n;o+=r)a=I(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=I(o,e[o],e[o+1],a);return a&&m(a,a.next)&&(A(a),a=a.next),a}function r(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(A(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function i(e,t,n,c,l,h,d){if(e){!d&&h&&function(e,t,n,r){var i=e;do{0===i.z&&(i.z=f(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,u,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(e,c,l,h);for(var p,y,g=e;e.prev!==e.next;)if(p=e.prev,y=e.next,h?a(e,c,l,h):o(e))t.push(p.i/n|0),t.push(e.i/n|0),t.push(y.i/n|0),A(e),e=y.next,g=y.next;else if((e=y)===g){d?1===d?i(e=s(r(e),t,n),t,n,c,l,h,2):2===d&&u(e,t,n,c,l,h):i(r(e),t,n,c,l,h,1);break}}}function o(e){var t=e.prev,n=e,r=e.next;if(g(t,n,r)>=0)return!1;for(var i=t.x,o=n.x,a=r.x,s=t.y,u=n.y,c=r.y,l=i<o?i<a?i:a:o<a?o:a,h=s<u?s<c?s:c:u<c?u:c,f=i>o?i>a?i:a:o>a?o:a,d=s>u?s>c?s:c:u>c?u:c,y=r.next;y!==t;){if(y.x>=l&&y.x<=f&&y.y>=h&&y.y<=d&&p(i,s,o,u,a,c,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function a(e,t,n,r){var i=e.prev,o=e,a=e.next;if(g(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,c=a.x,l=i.y,h=o.y,d=a.y,y=s<u?s<c?s:c:u<c?u:c,m=l<h?l<d?l:d:h<d?h:d,v=s>u?s>c?s:c:u>c?u:c,w=l>h?l>d?l:d:h>d?h:d,b=f(y,m,t,n,r),x=f(v,w,t,n,r),_=e.prevZ,I=e.nextZ;_&&_.z>=b&&I&&I.z<=x;){if(_.x>=y&&_.x<=v&&_.y>=m&&_.y<=w&&_!==i&&_!==a&&p(s,l,u,h,c,d,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,I.x>=y&&I.x<=v&&I.y>=m&&I.y<=w&&I!==i&&I!==a&&p(s,l,u,h,c,d,I.x,I.y)&&g(I.prev,I,I.next)>=0)return!1;I=I.nextZ}for(;_&&_.z>=b;){if(_.x>=y&&_.x<=v&&_.y>=m&&_.y<=w&&_!==i&&_!==a&&p(s,l,u,h,c,d,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;I&&I.z<=x;){if(I.x>=y&&I.x<=v&&I.y>=m&&I.y<=w&&I!==i&&I!==a&&p(s,l,u,h,c,d,I.x,I.y)&&g(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function s(e,t,n){var i=e;do{var o=i.prev,a=i.next.next;!m(o,a)&&v(o,i,i.next,a)&&x(o,a)&&x(a,o)&&(t.push(o.i/n|0),t.push(i.i/n|0),t.push(a.i/n|0),A(i),A(i.next),i=e=a),i=i.next}while(i!==e);return r(i)}function u(e,t,n,o,a,s){var u=e;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&y(u,c)){var l=_(u,c);return u=r(u,u.next),l=r(l,l.next),i(u,t,n,o,a,s,0),void i(l,t,n,o,a,s,0)}c=c.next}u=u.next}while(u!==e)}function c(e,t){return e.x-t.x}function l(e,t){var n=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==t);if(!n)return null;var u,c=n,l=n.x,f=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&p(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),x(r,e)&&(u<d||u===d&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,d=u)),r=r.next}while(r!==c);return n}(e,t);if(!n)return t;var i=_(n,e);return r(i,i.next),r(n,n.next)}function h(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function f(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function p(e,t,n,r,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(r-s)>=(n-a)*(t-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&v(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(x(e,t)&&x(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||m(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,n,r){var i=b(g(e,t,n)),o=b(g(e,t,r)),a=b(g(n,r,e)),s=b(g(n,r,t));return i!==o&&a!==s||!(0!==i||!w(e,n,t))||!(0!==o||!w(e,r,t))||!(0!==a||!w(n,e,r))||!(0!==s||!w(n,t,r))}function w(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function b(e){return e>0?1:e<0?-1:0}function x(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function _(e,t){var n=new C(e.i,e.x,e.y),r=new C(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function I(e,t,n,r){var i=new C(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function k(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,a=Math.abs(k(e,0,o,n));if(i)for(var s=0,u=t.length;s<u;s++){var c=t[s]*n,l=s<u-1?t[s+1]*n:e.length;a-=Math.abs(k(e,c,l,n))}var h=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,d=r[s+1]*n,p=r[s+2]*n;h+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},t.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},8252:function(e,t,n){var r=n(6604)("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch(e){r=!1}e.exports=r},9576:function(e){e.exports=EvalError},2772:function(e){e.exports=Error},5360:function(e){e.exports=RangeError},2380:function(e){e.exports=ReferenceError},7668:function(e){e.exports=SyntaxError},6556:function(e){e.exports=TypeError},568:function(e){e.exports=URIError},9328:function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,o),!0;case 6:return l.fn.call(l.context,t,r,i,o,a),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,i);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},3444:function(e,t){!function(e){var t=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,r=2*n,i=new WeakMap,o=function(e){return function(t,n){return e.set(t,n),n}}(i),a=function(e,i){return function(o){var a=i.get(o),s=void 0===a?o.size:a<r?a+1:0;if(!o.has(s))return e(o,s);if(o.size<n){for(;o.has(s);)s=Math.floor(Math.random()*r);return e(o,s)}if(o.size>t)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;o.has(s);)s=Math.floor(Math.random()*t);return e(o,s)}}(o,i),s=function(e){return function(t){var n=e(t);return t.add(n),n}}(a);e.addUniqueNumber=s,e.generateUniqueNumber=a}(t)},4412:function(e,t,n){var r,i;void 0===(i="function"==typeof(r=function(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function n(e,t){this.name=e||"Unknown",this.type=t||"Unknown"}function r(e,t){n.call(this,e,t||"Uint")}function i(e){return e.length%2==1?"0"+e:e}function o(e,t){n.call(this,e,t||"Float")}function a(e,t){n.call(this,e,t||"Container")}function s(e){a.call(this,"File","File"),this.setSource(e)}function u(e,t,n,r){if("object"==_typeof(n)&&(r=n,n=void 0),!n)return new Promise((function(n){u(e,t,n,r)}));try{var i=new FileReader;i.onloadend=function(){try{var o=new s(new Uint8Array(i.result));o.fixDuration(t,r)&&(e=o.toBlob(e.type))}catch(e){}n(e)},i.readAsArrayBuffer(e)}catch(t){n(e)}}return n.prototype.updateBySource=function(){},n.prototype.setSource=function(e){this.source=e,this.updateBySource()},n.prototype.updateByData=function(){},n.prototype.setData=function(e){this.data=e,this.updateByData()},t(r,n),r.prototype.updateBySource=function(){this.data="";for(var e=0;e<this.source.length;e++){var t=this.source[e].toString(16);this.data+=i(t)}},r.prototype.updateByData=function(){var e=this.data.length/2;this.source=new Uint8Array(e);for(var t=0;t<e;t++){var n=this.data.substr(2*t,2);this.source[t]=parseInt(n,16)}},r.prototype.getValue=function(){return parseInt(this.data,16)},r.prototype.setValue=function(e){this.setData(i(e.toString(16)))},t(o,n),o.prototype.getFloatArrayType=function(){return this.source&&4===this.source.length?Float32Array:Float64Array},o.prototype.updateBySource=function(){var e=this.source.reverse(),t=new(this.getFloatArrayType())(e.buffer);this.data=t[0]},o.prototype.updateByData=function(){var e=new(this.getFloatArrayType())([this.data]),t=new Uint8Array(e.buffer);this.source=t.reverse()},o.prototype.getValue=function(){return this.data},o.prototype.setValue=function(e){this.setData(e)},t(a,n),a.prototype.readByte=function(){return this.source[this.offset++]},a.prototype.readUint=function(){for(var e=this.readByte(),t=8-e.toString(2).length,n=e-(1<<7-t),r=0;r<t;r++)n*=256,n+=this.readByte();return n},a.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=s){var t=this.readUint(),i=this.readUint(),s=Math.min(this.offset+i,this.source.length),u=this.source.slice(this.offset,s),c=e[t]||{name:"Unknown",type:"Unknown"},l=n;switch(c.type){case"Container":l=a;break;case"Uint":l=r;break;case"Float":l=o}var h=new l(c.name,c.type);h.setSource(u),this.data.push({id:t,idHex:t.toString(16),data:h})}},a.prototype.writeUint=function(e,t){for(var n=1,r=128;e>=r&&n<8;n++,r*=128);if(!t)for(var i=r+e,o=n-1;o>=0;o--){var a=i%256;this.source[this.offset+o]=a,i=(i-a)/256}this.offset+=n},a.prototype.writeSections=function(e){this.offset=0;for(var t=0;t<this.data.length;t++){var n=this.data[t],r=n.data.source,i=r.length;this.writeUint(n.id,e),this.writeUint(i,e),e||this.source.set(r,this.offset),this.offset+=i}return this.offset},a.prototype.updateByData=function(){var e=this.writeSections("draft");this.source=new Uint8Array(e),this.writeSections()},a.prototype.getSectionById=function(e){for(var t=0;t<this.data.length;t++){var n=this.data[t];if(n.id===e)return n.data}return null},t(s,a),s.prototype.fixDuration=function(e,t){var n=t&&t.logger;void 0===n?n=function(e){console.log(e)}:n||(n=function(){});var r=this.getSectionById(139690087);if(!r)return n("[fix-webm-duration] Segment section is missing"),!1;var i=r.getSectionById(88713574);if(!i)return n("[fix-webm-duration] Info section is missing"),!1;var a=i.getSectionById(710577);if(!a)return n("[fix-webm-duration] TimecodeScale section is missing"),!1;var s=i.getSectionById(1161);if(s){if(!(s.getValue()<=0))return n("[fix-webm-duration] Duration section is present"),!1;n("[fix-webm-duration] Duration section is present, but the value is empty"),s.setValue(e)}else n("[fix-webm-duration] Duration section is missing"),(s=new o("Duration","Float")).setValue(e),i.data.push({id:1161,data:s});return a.setValue(1e6),i.updateByData(),r.updateByData(),this.updateByData(),!0},s.prototype.toBlob=function(e){return new Blob([this.source.buffer],{type:e||"video/webm"})},u.default=u,u})?r.call(t,n,t,e):r)||(e.exports=i)},7840:function(e){var t=Object.prototype.toString,n=Math.max,r=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var i=0;i<t.length;i+=1)n[i+e.length]=t[i];return n};e.exports=function(e){var i=this;if("function"!=typeof i||"[object Function]"!==t.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,a=function(e){for(var t=[],n=1,r=0;n<e.length;n+=1,r+=1)t[r]=e[n];return t}(arguments),s=n(0,i.length-a.length),u=[],c=0;c<s;c++)u[c]="$"+c;if(o=Function("binder","return function ("+function(e){for(var t="",n=0;n<e.length;n+=1)t+=e[n],n+1<e.length&&(t+=",");return t}(u)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var t=i.apply(this,r(a,arguments));return Object(t)===t?t:this}return i.apply(e,r(a,arguments))})),i.prototype){var l=function(){};l.prototype=i.prototype,o.prototype=new l,l.prototype=null}return o}},268:function(e,t,n){var r=n(7840);e.exports=Function.prototype.bind||r},6604:function(e,t,n){var r,i=n(2772),o=n(9576),a=n(5360),s=n(2380),u=n(7668),c=n(6556),l=n(568),h=Function,f=function(e){try{return h('"use strict"; return ('+e+").constructor;")()}catch(e){}},d=Object.getOwnPropertyDescriptor;if(d)try{d({},"")}catch(e){d=null}var p=function(){throw new c},y=d?function(){try{return p}catch(e){try{return d(arguments,"callee").get}catch(e){return p}}}():p,g=n(4308)(),m=n(7636)(),v=Object.getPrototypeOf||(m?function(e){return e.__proto__}:null),w={},b="undefined"!=typeof Uint8Array&&v?v(Uint8Array):r,x={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":g&&v?v([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":i,"%eval%":eval,"%EvalError%":o,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":h,"%GeneratorFunction%":w,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":g&&v?v(v([][Symbol.iterator]())):r,"%JSON%":"object"==("undefined"===typeof JSON?"undefined":_typeof(JSON))?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&g&&v?v((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":a,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&g&&v?v((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":g&&v?v(""[Symbol.iterator]()):r,"%Symbol%":g?Symbol:r,"%SyntaxError%":u,"%ThrowTypeError%":y,"%TypedArray%":b,"%TypeError%":c,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":l,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(v)try{null.error}catch(e){var _=v(v(e));x["%Error.prototype%"]=_}var I=function e(t){var n;if("%AsyncFunction%"===t)n=f("async function () {}");else if("%GeneratorFunction%"===t)n=f("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=f("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&v&&(n=v(i.prototype))}return x[t]=n,n},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},C=n(268),k=n(5176),S=C.call(Function.call,Array.prototype.concat),T=C.call(Function.apply,Array.prototype.splice),E=C.call(Function.call,String.prototype.replace),O=C.call(Function.call,String.prototype.slice),P=C.call(Function.call,RegExp.prototype.exec),R=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,B=/\\(\\)?/g,D=function(e,t){var n,r=e;if(k(A,r)&&(r="%"+(n=A[r])[0]+"%"),k(x,r)){var i=x[r];if(i===w&&(i=I(r)),void 0===i&&!t)throw new c("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new u("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new c("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new c('"allowMissing" argument must be a boolean');if(null===P(/^%?[^%]*%?$/,e))throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(e){var t=O(e,0,1),n=O(e,-1);if("%"===t&&"%"!==n)throw new u("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new u("invalid intrinsic syntax, expected opening `%`");var r=[];return E(e,R,(function(e,t,n,i){r[r.length]=n?E(i,B,"$1"):t||e})),r}(e),r=n.length>0?n[0]:"",i=D("%"+r+"%",t),o=i.name,a=i.value,s=!1,l=i.alias;l&&(r=l[0],T(n,S([0,1],l)));for(var h=1,f=!0;h<n.length;h+=1){var p=n[h],y=O(p,0,1),g=O(p,-1);if(('"'===y||"'"===y||"`"===y||'"'===g||"'"===g||"`"===g)&&y!==g)throw new u("property names with quotes must have matching quotes");if("constructor"!==p&&f||(s=!0),k(x,o="%"+(r+="."+p)+"%"))a=x[o];else if(null!=a){if(!(p in a)){if(!t)throw new c("base intrinsic for "+e+" exists, but the property is not available.");return}if(d&&h+1>=n.length){var m=d(a,p);a=(f=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:a[p]}else f=k(a,p),a=a[p];f&&!s&&(x[o]=a)}}return a}},872:function(e,t,n){var r=n(6604)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(e){r=null}e.exports=r},1188:function(e,t,n){var r=n(8252),i=function(){return!!r};i.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=i},7636:function(e){var t={foo:{}},n=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof n)}},4308:function(e,t,n){var r="undefined"!=typeof Symbol&&Symbol,i=n(1968);e.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==_typeof(r("foo"))&&"symbol"==_typeof(Symbol("bar"))&&i()}},1968:function(e){e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==_typeof(Symbol.iterator))return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},5176:function(e,t,n){var r=Function.prototype.call,i=Object.prototype.hasOwnProperty,o=n(268);e.exports=o.call(r,i)},4404:function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+d]=255&a,d+=p,a/=256,c-=8);e[n+d-p]|=128*y}},4819:function(e){e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},6792:function(e){function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},9600:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},8684:function(e,t,n){var r=n(1528),i={body:"",args:[],thisVars:[],localVars:[]};function o(e){if(!e)return i;for(var t=0;t<e.args.length;++t){var n=e.args[t];e.args[t]=0===t?{name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function a(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(function(e){return r({args:e.args,pre:o(e.pre),body:o(e.body),post:o(e.proc),funcName:e.funcName})}(e))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var n=s[e];t[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var n=u[e];t[e]=a({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:e}),t[e+"eq"]=a({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in c){var n=c[e];t[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var l=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<l.length;++e){var n=l[e];t[n]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),t[n+"eq"]=a({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var e=0;e<h.length;++e){var n=h[e];t[n]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),t[n+"s"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),t[n+"eq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),t[n+"seq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var f=["atan2","pow"];!function(){for(var e=0;e<f.length;++e){var n=f[e];t[n+"op"]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),t[n+"ops"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),t[n+"opeq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),t[n+"opseq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),t.any=r({args:["array"],pre:i,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=r({args:["array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=r({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=r({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=r({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=r({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=a({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=a({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=a({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=r({args:["array","array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},4300:function(e,t,n){var r=n(4819),i=n(6792),o="undefined"!=typeof Float64Array;function a(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(a);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function u(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var i="generic"===e;if(-1===t){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===t)return o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",new Function("TrivialArray",o)(c[e][0]);o=["'use strict'"];var a=r(t),u=a.map((function(e){return"i"+e})),l="this.offset+"+a.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),h=a.map((function(e){return"b"+e})).join(","),f=a.map((function(e){return"c"+e})).join(",");o.push("function "+n+"(a,"+h+","+f+",d){this.data=a","this.shape=["+h+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+a.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+u.join(",")+",v){"),i?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+n+"_get("+u.join(",")+"){"),i?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+n+"_index(",u.join(),"){return "+l+"}"),o.push("proto.hi=function "+n+"_hi("+u.join(",")+"){return new "+n+"(this.data,"+a.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+a.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var d=a.map((function(e){return"a"+e+"=this.shape["+e+"]"})),p=a.map((function(e){return"c"+e+"=this.stride["+e+"]"}));o.push("proto.lo=function "+n+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+p.join(","));for(var y=0;y<t;++y)o.push("if(typeof i"+y+"==='number'&&i"+y+">=0){d=i"+y+"|0;b+=c"+y+"*d;a"+y+"-=d}");for(o.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"c"+e})).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+u.join(",")+"){var "+a.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+a.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),y=0;y<t;++y)o.push("if(typeof i"+y+"==='number'){d=i"+y+"|0;if(d<0){c+=b"+y+"*(a"+y+"-1);a"+y+"=ceil(-a"+y+"/d)}else{a"+y+"=ceil(a"+y+"/d)}b"+y+"*=d}");o.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"b"+e})).join(",")+",c)}");var g=new Array(t),m=new Array(t);for(y=0;y<t;++y)g[y]="a[i"+y+"]",m[y]="b[i"+y+"]";for(o.push("proto.transpose=function "+n+"_transpose("+u+"){"+u.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+g.join(",")+","+m.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+u+"){var a=[],b=[],c=this.offset"),y=0;y<t;++y)o.push("if(typeof i"+y+"==='number'&&i"+y+">=0){c=(c+this.stride["+y+"]*i"+y+")|0}else{a.push(this.shape["+y+"]);b.push(this.stride["+y+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+a.map((function(e){return"shape["+e+"]"})).join(",")+","+a.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(c[e],s)}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,c.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===n){n=new Array(a);for(var s=a-1,l=1;s>=0;--s)n[s]=l,l*=t[s]}if(void 0===r)for(r=0,s=0;s<a;++s)n[s]<0&&(r-=(t[s]-1)*n[s]);for(var h=function(e){if(i(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),f=c[h];f.length<=a+1;)f.push(u(h,f.length-1));return(0,f[a+1])(e,t,n,r)}},7872:function(e,t,n){var r="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=r&&i&&"function"==typeof i.get?i.get:null,a=r&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=s&&u&&"function"==typeof u.get?u.get:null,l=s&&Set.prototype.forEach,h="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,d="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,y=Object.prototype.toString,g=Function.prototype.toString,m=String.prototype.match,v=String.prototype.slice,w=String.prototype.replace,b=String.prototype.toUpperCase,x=String.prototype.toLowerCase,_=RegExp.prototype.test,I=Array.prototype.concat,A=Array.prototype.join,C=Array.prototype.slice,k=Math.floor,S="function"==typeof BigInt?BigInt.prototype.valueOf:null,T=Object.getOwnPropertySymbols,E="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?Symbol.prototype.toString:null,O="function"==typeof Symbol&&"object"==_typeof(Symbol.iterator),P="function"==typeof Symbol&&Symbol.toStringTag&&(_typeof(Symbol.toStringTag),1)?Symbol.toStringTag:null,R=Object.prototype.propertyIsEnumerable,B=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function D(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var r=e<0?-k(-e):k(e);if(r!==e){var i=String(r),o=v.call(t,i.length+1);return w.call(i,n,"$&_")+"."+w.call(w.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return w.call(t,n,"$&_")}var M=n(6204),L=M.custom,F=z(L)?L:null;function N(e,t,n){var r="double"===(n.quoteStyle||t)?'"':"'";return r+e+r}function U(e){return w.call(String(e),/"/g,"&quot;")}function j(e){return!("[object Array]"!==W(e)||P&&"object"==_typeof(e)&&P in e)}function G(e){return!("[object RegExp]"!==W(e)||P&&"object"==_typeof(e)&&P in e)}function z(e){if(O)return e&&"object"==_typeof(e)&&e instanceof Symbol;if("symbol"==_typeof(e))return!0;if(!e||"object"!=_typeof(e)||!E)return!1;try{return E.call(e),!0}catch(e){}return!1}e.exports=function e(t,r,i,s){var u=r||{};if(V(u,"quoteStyle")&&"single"!==u.quoteStyle&&"double"!==u.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(V(u,"maxStringLength")&&("number"==typeof u.maxStringLength?u.maxStringLength<0&&u.maxStringLength!==1/0:null!==u.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var y=!V(u,"customInspect")||u.customInspect;if("boolean"!=typeof y&&"symbol"!==y)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(V(u,"indent")&&null!==u.indent&&"\t"!==u.indent&&!(parseInt(u.indent,10)===u.indent&&u.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(V(u,"numericSeparator")&&"boolean"!=typeof u.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var b=u.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return Y(t,u);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var _=String(t);return b?D(t,_):_}if("bigint"==typeof t){var k=String(t)+"n";return b?D(t,k):k}var T=void 0===u.depth?5:u.depth;if(void 0===i&&(i=0),i>=T&&T>0&&"object"==_typeof(t))return j(t)?"[Array]":"[Object]";var L=function(e,t){var n;if("\t"===e.indent)n="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;n=A.call(Array(e.indent+1)," ")}return{base:n,prev:A.call(Array(t+1),n)}}(u,i);if(void 0===s)s=[];else if($(s,t)>=0)return"[Circular]";function H(t,n,r){if(n&&(s=C.call(s)).push(n),r){var o={depth:u.depth};return V(u,"quoteStyle")&&(o.quoteStyle=u.quoteStyle),e(t,o,i+1,s)}return e(t,u,i+1,s)}if("function"==typeof t&&!G(t)){var K=function(e){if(e.name)return e.name;var t=m.call(g.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}(t),ee=Q(t,H);return"[Function"+(K?": "+K:" (anonymous)")+"]"+(ee.length>0?" { "+A.call(ee,", ")+" }":"")}if(z(t)){var te=O?w.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):E.call(t);return"object"!=_typeof(t)||O?te:X(te)}if(function(e){return!(!e||"object"!=_typeof(e))&&("undefined"!=typeof HTMLElement&&e instanceof HTMLElement||"string"==typeof e.nodeName&&"function"==typeof e.getAttribute)}(t)){for(var ne="<"+x.call(String(t.nodeName)),re=t.attributes||[],ie=0;ie<re.length;ie++)ne+=" "+re[ie].name+"="+N(U(re[ie].value),"double",u);return ne+=">",t.childNodes&&t.childNodes.length&&(ne+="..."),ne+"</"+x.call(String(t.nodeName))+">"}if(j(t)){if(0===t.length)return"[]";var oe=Q(t,H);return L&&!function(e){for(var t=0;t<e.length;t++)if($(e[t],"\n")>=0)return!1;return!0}(oe)?"["+J(oe,L)+"]":"[ "+A.call(oe,", ")+" ]"}if(function(e){return!("[object Error]"!==W(e)||P&&"object"==_typeof(e)&&P in e)}(t)){var ae=Q(t,H);return"cause"in Error.prototype||!("cause"in t)||R.call(t,"cause")?0===ae.length?"["+String(t)+"]":"{ ["+String(t)+"] "+A.call(ae,", ")+" }":"{ ["+String(t)+"] "+A.call(I.call("[cause]: "+H(t.cause),ae),", ")+" }"}if("object"==_typeof(t)&&y){if(F&&"function"==typeof t[F]&&M)return M(t,{depth:T-i});if("symbol"!==y&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=_typeof(e))return!1;try{o.call(e);try{c.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var se=[];return a&&a.call(t,(function(e,n){se.push(H(n,t,!0)+" => "+H(e,t))})),q("Map",o.call(t),se,L)}if(function(e){if(!c||!e||"object"!=_typeof(e))return!1;try{c.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var ue=[];return l&&l.call(t,(function(e){ue.push(H(e,t))})),q("Set",c.call(t),ue,L)}if(function(e){if(!h||!e||"object"!=_typeof(e))return!1;try{h.call(e,h);try{f.call(e,f)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Z("WeakMap");if(function(e){if(!f||!e||"object"!=_typeof(e))return!1;try{f.call(e,f);try{h.call(e,h)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Z("WeakSet");if(function(e){if(!d||!e||"object"!=_typeof(e))return!1;try{return d.call(e),!0}catch(e){}return!1}(t))return Z("WeakRef");if(function(e){return!("[object Number]"!==W(e)||P&&"object"==_typeof(e)&&P in e)}(t))return X(H(Number(t)));if(function(e){if(!e||"object"!=_typeof(e)||!S)return!1;try{return S.call(e),!0}catch(e){}return!1}(t))return X(H(S.call(t)));if(function(e){return!("[object Boolean]"!==W(e)||P&&"object"==_typeof(e)&&P in e)}(t))return X(p.call(t));if(function(e){return!("[object String]"!==W(e)||P&&"object"==_typeof(e)&&P in e)}(t))return X(H(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if(t===n.g)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==W(e)||P&&"object"==_typeof(e)&&P in e)}(t)&&!G(t)){var ce=Q(t,H),le=B?B(t)===Object.prototype:t instanceof Object||t.constructor===Object,he=t instanceof Object?"":"null prototype",fe=!le&&P&&Object(t)===t&&P in t?v.call(W(t),8,-1):he?"Object":"",de=(le||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(fe||he?"["+A.call(I.call([],fe||[],he||[]),": ")+"] ":"");return 0===ce.length?de+"{}":L?de+"{"+J(ce,L)+"}":de+"{ "+A.call(ce,", ")+" }"}return String(t)};var H=Object.prototype.hasOwnProperty||function(e){return e in this};function V(e,t){return H.call(e,t)}function W(e){return y.call(e)}function $(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Y(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return Y(v.call(e,0,t.maxStringLength),t)+r}return N(w.call(w.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,K),"single",t)}function K(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+b.call(t.toString(16))}function X(e){return"Object("+e+")"}function Z(e){return e+" { ? }"}function q(e,t,n,r){return e+" ("+t+") {"+(r?J(n,r):A.call(n,", "))+"}"}function J(e,t){if(0===e.length)return"";var n="\n"+t.prev+t.base;return n+A.call(e,","+n)+"\n"+t.prev}function Q(e,t){var n=j(e),r=[];if(n){r.length=e.length;for(var i=0;i<e.length;i++)r[i]=V(e,i)?t(e[i],e):""}var o,a="function"==typeof T?T(e):[];if(O){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var u in e)V(e,u)&&(n&&String(Number(u))===u&&u<e.length||O&&o["$"+u]instanceof Symbol||(_.call(/[^\w$]/,u)?r.push(t(u,e)+": "+t(e[u],e)):r.push(u+": "+t(e[u],e))));if("function"==typeof T)for(var c=0;c<a.length;c++)R.call(e,a[c])&&r.push("["+t(a[c])+"]: "+t(e[a[c]],e));return r}},6512:function(e){var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,u=[],c=!1,l=-1;function h(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length&&f())}function f(){if(!c){var e=a(h);c=!0;for(var t=u.length;t;){for(s=u,u=[];++l<t;)s&&s[l].run();l=-1,t=u.length}s=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||c||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},7568:function(e,t,n){var r;e=n.nmd(e),function(){t&&t.nodeType,e&&e.nodeType;var i="object"==_typeof(n.g)&&n.g;i.global!==i&&i.window!==i&&i.self;var o,a=2147483647,s=36,u=/^xn--/,c=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,d=String.fromCharCode;function p(e){throw new RangeError(h[e])}function y(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function g(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+y((e=e.replace(l,".")).split("."),t).join(".")}function m(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function v(e){return y(e,(function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+d(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function b(e,t,n){var r=0;for(e=n?f(e/700):e>>1,e+=f(e/t);e>455;r+=s)e=f(e/35);return f(r+36*e/(e+38))}function x(e){var t,n,r,i,o,u,c,l,h,d,y,g=[],m=e.length,w=0,x=128,_=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&p("not-basic"),g.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<m;){for(o=w,u=1,c=s;i>=m&&p("invalid-input"),((l=(y=e.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:s)>=s||l>f((a-w)/u))&&p("overflow"),w+=l*u,!(l<(h=c<=_?1:c>=_+26?26:c-_));c+=s)u>f(a/(d=s-h))&&p("overflow"),u*=d;_=b(w-o,t=g.length+1,0==o),f(w/t)>a-x&&p("overflow"),x+=f(w/t),w%=t,g.splice(w++,0,x)}return v(g)}function _(e){var t,n,r,i,o,u,c,l,h,y,g,v,x,_,I,A=[];for(v=(e=m(e)).length,t=128,n=0,o=72,u=0;u<v;++u)(g=e[u])<128&&A.push(d(g));for(r=i=A.length,i&&A.push("-");r<v;){for(c=a,u=0;u<v;++u)(g=e[u])>=t&&g<c&&(c=g);for(c-t>f((a-n)/(x=r+1))&&p("overflow"),n+=(c-t)*x,t=c,u=0;u<v;++u)if((g=e[u])<t&&++n>a&&p("overflow"),g==t){for(l=n,h=s;!(l<(y=h<=o?1:h>=o+26?26:h-o));h+=s)I=l-y,_=s-y,A.push(d(w(y+I%_,0))),l=f(I/_);A.push(d(w(l,0))),o=b(n,x,r==i),n=0,++r}++n,++t}return A.join("")}o={version:"1.4.1",ucs2:{decode:m,encode:v},decode:x,encode:_,toASCII:function(e){return g(e,(function(e){return c.test(e)?"xn--"+_(e):e}))},toUnicode:function(e){return g(e,(function(e){return u.test(e)?x(e.slice(4).toLowerCase()):e}))}},void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)}()},6515:function(e){var t=String.prototype.replace,n=/%20/g,r="RFC3986";e.exports={default:r,formatters:{RFC1738:function(e){return t.call(e,n,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:r}},7392:function(e,t,n){var r=n(4368),i=n(4812),o=n(6515);e.exports={formats:o,parse:i,stringify:r}},4812:function(e,t,n){var r=n(5872),i=Object.prototype.hasOwnProperty,o=Array.isArray,a={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:r.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},u=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},c=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=n.depth>0&&/(\[[^[\]]*])/.exec(o),c=s?o.slice(0,s.index):o,l=[];if(c){if(!n.plainObjects&&i.call(Object.prototype,c)&&!n.allowPrototypes)return;l.push(c)}for(var h=0;n.depth>0&&null!==(s=a.exec(o))&&h<n.depth;){if(h+=1,!n.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+o.slice(s.index)+"]"),function(e,t,n,r){for(var i=r?t:u(t,n),o=e.length-1;o>=0;--o){var a,s=e[o];if("[]"===s&&n.parseArrays)a=[].concat(i);else{a=n.plainObjects?Object.create(null):{};var c="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,l=parseInt(c,10);n.parseArrays||""!==c?!isNaN(l)&&s!==c&&String(l)===c&&l>=0&&n.parseArrays&&l<=n.arrayLimit?(a=[])[l]=i:"__proto__"!==c&&(a[c]=i):a={0:i}}i=a}return i}(l,t,n,r)}};e.exports=function(e,t){var n=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:a.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||r.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return n.plainObjects?Object.create(null):{};for(var l="string"==typeof e?function(e,t){var n,c={__proto__:null},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,h=t.parameterLimit===1/0?void 0:t.parameterLimit,f=l.split(t.delimiter,h),d=-1,p=t.charset;if(t.charsetSentinel)for(n=0;n<f.length;++n)0===f[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===f[n]?p="utf-8":"utf8=%26%2310003%3B"===f[n]&&(p="iso-8859-1"),d=n,n=f.length);for(n=0;n<f.length;++n)if(n!==d){var y,g,m=f[n],v=m.indexOf("]="),w=-1===v?m.indexOf("="):v+1;-1===w?(y=t.decoder(m,a.decoder,p,"key"),g=t.strictNullHandling?null:""):(y=t.decoder(m.slice(0,w),a.decoder,p,"key"),g=r.maybeMap(u(m.slice(w+1),t),(function(e){return t.decoder(e,a.decoder,p,"value")}))),g&&t.interpretNumericEntities&&"iso-8859-1"===p&&(g=s(g)),m.indexOf("[]=")>-1&&(g=o(g)?[g]:g),i.call(c,y)?c[y]=r.combine(c[y],g):c[y]=g}return c}(e,n):e,h=n.plainObjects?Object.create(null):{},f=Object.keys(l),d=0;d<f.length;++d){var p=f[d],y=c(p,l[p],n,"string"==typeof e);h=r.merge(h,y,n)}return!0===n.allowSparse?h:r.compact(h)}},4368:function(e,t,n){var r=n(7223),i=n(5872),o=n(6515),a=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Array.isArray,c=Array.prototype.push,l=function(e,t){c.apply(e,u(t)?t:[t])},h=Date.prototype.toISOString,f=o.default,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:f,formatter:o.formatters[f],indices:!1,serializeDate:function(e){return h.call(e)},skipNulls:!1,strictNullHandling:!1},p={},y=function e(t,n,o,a,s,c,h,f,y,g,m,v,w,b,x,_){for(var I,A=t,C=_,k=0,S=!1;void 0!==(C=C.get(p))&&!S;){var T=C.get(t);if(k+=1,void 0!==T){if(T===k)throw new RangeError("Cyclic object value");S=!0}void 0===C.get(p)&&(k=0)}if("function"==typeof f?A=f(n,A):A instanceof Date?A=m(A):"comma"===o&&u(A)&&(A=i.maybeMap(A,(function(e){return e instanceof Date?m(e):e}))),null===A){if(s)return h&&!b?h(n,d.encoder,x,"key",v):n;A=""}if("string"==typeof(I=A)||"number"==typeof I||"boolean"==typeof I||"symbol"==_typeof(I)||"bigint"==typeof I||i.isBuffer(A))return h?[w(b?n:h(n,d.encoder,x,"key",v))+"="+w(h(A,d.encoder,x,"value",v))]:[w(n)+"="+w(String(A))];var E,O=[];if(void 0===A)return O;if("comma"===o&&u(A))b&&h&&(A=i.maybeMap(A,h)),E=[{value:A.length>0?A.join(",")||null:void 0}];else if(u(f))E=f;else{var P=Object.keys(A);E=y?P.sort(y):P}for(var R=a&&u(A)&&1===A.length?n+"[]":n,B=0;B<E.length;++B){var D=E[B],M="object"==_typeof(D)&&void 0!==D.value?D.value:A[D];if(!c||null!==M){var L=u(A)?"function"==typeof o?o(R,D):R:R+(g?"."+D:"["+D+"]");_.set(t,k);var F=r();F.set(p,_),l(O,e(M,L,o,a,s,c,"comma"===o&&b&&u(A)?null:h,f,y,g,m,v,w,b,x,F))}}return O};e.exports=function(e,t){var n,i=e,c=function(e){if(!e)return d;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=o.default;if(void 0!==e.format){if(!a.call(o.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var r=o.formatters[n],i=d.filter;return("function"==typeof e.filter||u(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===e.allowDots?d.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:i,format:n,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}(t);"function"==typeof c.filter?i=(0,c.filter)("",i):u(c.filter)&&(n=c.filter);var h,f=[];if("object"!=_typeof(i)||null===i)return"";h=t&&t.arrayFormat in s?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var p=s[h];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var g="comma"===p&&t&&t.commaRoundTrip;n||(n=Object.keys(i)),c.sort&&n.sort(c.sort);for(var m=r(),v=0;v<n.length;++v){var w=n[v];c.skipNulls&&null===i[w]||l(f,y(i[w],w,p,g,c.strictNullHandling,c.skipNulls,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.format,c.formatter,c.encodeValuesOnly,c.charset,m))}var b=f.join(c.delimiter),x=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?x+="utf8=%26%2310003%3B&":x+="utf8=%E2%9C%93&"),b.length>0?x+b:""}},5872:function(e,t,n){var r=n(6515),i=Object.prototype.hasOwnProperty,o=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n};e.exports={arrayToObject:s,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var i=t[r],a=i.obj[i.prop],s=Object.keys(a),u=0;u<s.length;++u){var c=s[u],l=a[c];"object"==_typeof(l)&&null!==l&&-1===n.indexOf(l)&&(t.push({obj:a,prop:c}),n.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(o(n)){for(var r=[],i=0;i<n.length;++i)void 0!==n[i]&&r.push(n[i]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,i,o){if(0===e.length)return e;var s=e;if("symbol"==_typeof(e)?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===n)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var u="",c=0;c<s.length;++c){var l=s.charCodeAt(c);45===l||46===l||95===l||126===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||o===r.RFC1738&&(40===l||41===l)?u+=s.charAt(c):l<128?u+=a[l]:l<2048?u+=a[192|l>>6]+a[128|63&l]:l<55296||l>=57344?u+=a[224|l>>12]+a[128|l>>6&63]+a[128|63&l]:(c+=1,l=65536+((1023&l)<<10|1023&s.charCodeAt(c)),u+=a[240|l>>18]+a[128|l>>12&63]+a[128|l>>6&63]+a[128|63&l])}return u},isBuffer:function(e){return!(!e||"object"!=_typeof(e))&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(o(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if("object"!=_typeof(n)){if(o(t))t.push(n);else{if(!t||"object"!=_typeof(t))return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!i.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!=_typeof(t))return[t].concat(n);var a=t;return o(t)&&!o(n)&&(a=s(t,r)),o(t)&&o(n)?(n.forEach((function(n,o){if(i.call(t,o)){var a=t[o];a&&"object"==_typeof(a)&&n&&"object"==_typeof(n)?t[o]=e(a,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var a=n[o];return i.call(t,o)?t[o]=e(t[o],a,r):t[o]=a,t}),a)}}},2392:function(e,t,n){var r=n(6604),i=n(5456),o=n(1188)(),a=n(872),s=n(6556),u=r("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new s("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||u(t)!==t)throw new s("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,c=!0;if("length"in e&&a){var l=a(e,"length");l&&!l.configurable&&(r=!1),l&&!l.writable&&(c=!1)}return(r||c||!n)&&(o?i(e,"length",t,!0,!0):i(e,"length",t)),e}},7223:function(e,t,n){var r=n(6604),i=n(2768),o=n(7872),a=n(6556),s=r("%WeakMap%",!0),u=r("%Map%",!0),c=i("WeakMap.prototype.get",!0),l=i("WeakMap.prototype.set",!0),h=i("WeakMap.prototype.has",!0),f=i("Map.prototype.get",!0),d=i("Map.prototype.set",!0),p=i("Map.prototype.has",!0),y=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n};e.exports=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new a("Side channel does not contain "+o(e))},get:function(r){if(s&&r&&("object"==_typeof(r)||"function"==typeof r)){if(e)return c(e,r)}else if(u){if(t)return f(t,r)}else if(n)return function(e,t){var n=y(e,t);return n&&n.value}(n,r)},has:function(r){if(s&&r&&("object"==_typeof(r)||"function"==typeof r)){if(e)return h(e,r)}else if(u){if(t)return p(t,r)}else if(n)return function(e,t){return!!y(e,t)}(n,r);return!1},set:function(r,i){s&&r&&("object"==_typeof(r)||"function"==typeof r)?(e||(e=new s),l(e,r,i)):u?(t||(t=new u),d(t,r,i)):(n||(n={key:{},next:null}),function(e,t,n){var r=y(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,i))}};return r}},2248:function(e){e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],a=1;a<r;++a)if(o=i,t(i=e[a],o)){if(a===n){n++;continue}e[n++]=i}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,(r=e[o])!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},4776:function(e,t,n){var r=n(7568);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(u),l=["%","/","?",";","#"].concat(c),h=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=n(7392);function v(e,t,n){if(e&&"object"==_typeof(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}i.prototype.parse=function(e,t,n){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+_typeof(e));var i=e.indexOf("?"),a=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var v=e=u.join(a);if(v=v.trim(),!n&&1===e.split("#").length){var w=s.exec(v);if(w)return this.path=v,this.href=v,this.pathname=w[1],w[2]?(this.search=w[2],this.query=t?m.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var b=o.exec(v);if(b){var x=(b=b[0]).toLowerCase();this.protocol=x,v=v.substr(b.length)}if(n||b||v.match(/^\/\/[^@/]+@[^@/]+/)){var _="//"===v.substr(0,2);!_||b&&y[b]||(v=v.substr(2),this.slashes=!0)}if(!y[b]&&(_||b&&!g[b])){for(var I,A,C=-1,k=0;k<h.length;k++)-1!==(S=v.indexOf(h[k]))&&(-1===C||S<C)&&(C=S);for(-1!==(A=-1===C?v.lastIndexOf("@"):v.lastIndexOf("@",C))&&(I=v.slice(0,A),v=v.slice(A+1),this.auth=decodeURIComponent(I)),C=-1,k=0;k<l.length;k++){var S;-1!==(S=v.indexOf(l[k]))&&(-1===C||S<C)&&(C=S)}-1===C&&(C=v.length),this.host=v.slice(0,C),v=v.slice(C),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var E=this.hostname.split(/\./),O=(k=0,E.length);k<O;k++){var P=E[k];if(P&&!P.match(f)){for(var R="",B=0,D=P.length;B<D;B++)P.charCodeAt(B)>127?R+="x":R+=P[B];if(!R.match(f)){var M=E.slice(0,k),L=E.slice(k+1),F=P.match(d);F&&(M.push(F[1]),L.unshift(F[2])),L.length&&(v="/"+L.join(".")+v),this.hostname=M.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=r.toASCII(this.hostname));var N=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+N,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!p[x])for(k=0,O=c.length;k<O;k++){var j=c[k];if(-1!==v.indexOf(j)){var G=encodeURIComponent(j);G===j&&(G=escape(j)),v=v.split(j).join(G)}}var z=v.indexOf("#");-1!==z&&(this.hash=v.substr(z),v=v.slice(0,z));var H=v.indexOf("?");if(-1!==H?(this.search=v.substr(H),this.query=v.substr(H+1),t&&(this.query=m.parse(this.query)),v=v.slice(0,H)):t&&(this.search="",this.query={}),v&&(this.pathname=v),g[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){N=this.pathname||"";var V=this.search||"";this.path=N+V}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"==_typeof(this.query)&&Object.keys(this.query).length&&(o=m.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+r},i.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if("string"==typeof e){var t=new i;t.parse(e,!1,!0),e=t}for(var n=new i,r=Object.keys(this),o=0;o<r.length;o++){var a=r[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var c=s[u];"protocol"!==c&&(n[c]=e[c])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.pathname="/",n.path=n.pathname),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!g[e.protocol]){for(var l=Object.keys(e),h=0;h<l.length;h++){var f=l[h];n[f]=e[f]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||y[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",m=n.search||"";n.path=p+m}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=w||v||n.host&&e.pathname,x=b,_=n.pathname&&n.pathname.split("/")||[],I=(d=e.pathname&&e.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(I&&(n.hostname="",n.port=null,n.host&&(""===_[0]?_[0]=n.host:_.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),b=b&&(""===d[0]||""===_[0])),w)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,_=d;else if(d.length)_||(_=[]),_.pop(),_=_.concat(d),n.search=e.search,n.query=e.query;else if(null!=e.search)return I&&(n.host=_.shift(),n.hostname=n.host,(T=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=T.shift(),n.hostname=T.shift(),n.host=n.hostname)),n.search=e.search,n.query=e.query,null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!_.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=_.slice(-1)[0],C=(n.host||e.host||_.length>1)&&("."===A||".."===A)||""===A,k=0,S=_.length;S>=0;S--)"."===(A=_[S])?_.splice(S,1):".."===A?(_.splice(S,1),k++):k&&(_.splice(S,1),k--);if(!b&&!x)for(;k--;k)_.unshift("..");!b||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),C&&"/"!==_.join("/").substr(-1)&&_.push("");var T,E=""===_[0]||_[0]&&"/"===_[0].charAt(0);return I&&(n.hostname=E?"":_.length?_.shift():"",n.host=n.hostname,(T=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=T.shift(),n.hostname=T.shift(),n.host=n.hostname)),(b=b||n.host&&_.length)&&!E&&_.unshift(""),_.length>0?n.pathname=_.join("/"):(n.pathname=null,n.path=null),null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.K0=v,t.WI=function(e,t){return v(e,!1,!0).resolve(t)},t.E9=function(e){return"string"==typeof e&&(e=v(e)),e instanceof i?e.format():i.prototype.format.call(e)}},8804:function(e){e.exports="data:application/javascript;base64,ZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQociwgbCkgeyB2YXIgdCA9IG51bGwgPT0gciA/IG51bGwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU3ltYm9sICYmIHJbU3ltYm9sLml0ZXJhdG9yXSB8fCByWyJAQGl0ZXJhdG9yIl07IGlmIChudWxsICE9IHQpIHsgdmFyIGUsIG4sIGksIHUsIGEgPSBbXSwgZiA9ICEwLCBvID0gITE7IHRyeSB7IGlmIChpID0gKHQgPSB0LmNhbGwocikpLm5leHQsIDAgPT09IGwpIHsgaWYgKE9iamVjdCh0KSAhPT0gdCkgcmV0dXJuOyBmID0gITE7IH0gZWxzZSBmb3IgKDsgIShmID0gKGUgPSBpLmNhbGwodCkpLmRvbmUpICYmIChhLnB1c2goZS52YWx1ZSksIGEubGVuZ3RoICE9PSBsKTsgZiA9ICEwKTsgfSBjYXRjaCAocikgeyBvID0gITAsIG4gPSByOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIWYgJiYgbnVsbCAhPSB0WyJyZXR1cm4iXSAmJiAodSA9IHRbInJldHVybiJdKCksIE9iamVjdCh1KSAhPT0gdSkpIHJldHVybjsgfSBmaW5hbGx5IHsgaWYgKG8pIHRocm93IG47IH0gfSByZXR1cm4gYTsgfSB9CmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQpmdW5jdGlvbiBfY29uc3RydWN0KHQsIGUsIHIpIHsgaWYgKF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSkgcmV0dXJuIFJlZmxlY3QuY29uc3RydWN0LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7IHZhciBvID0gW251bGxdOyBvLnB1c2guYXBwbHkobywgZSk7IHZhciBwID0gbmV3ICh0LmJpbmQuYXBwbHkodCwgbykpKCk7IHJldHVybiByICYmIF9zZXRQcm90b3R5cGVPZihwLCByLnByb3RvdHlwZSksIHA7IH0KZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgdHJ5IHsgdmFyIHQgPSAhQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyB9IGNhdGNoICh0KSB7fSByZXR1cm4gKF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyByZXR1cm4gISF0OyB9KSgpOyB9CmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZi5iaW5kKCkgOiBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfQpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgJiYgaXRlcltTeW1ib2wuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlclsiQEBpdGVyYXRvciJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7IH0KZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBrZXkgPSBfdG9Qcm9wZXJ0eUtleShrZXkpOyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KZnVuY3Rpb24gX3RvUHJvcGVydHlLZXkodCkgeyB2YXIgaSA9IF90b1ByaW1pdGl2ZSh0LCAic3RyaW5nIik7IHJldHVybiAic3ltYm9sIiA9PSBfdHlwZW9mKGkpID8gaSA6IFN0cmluZyhpKTsgfQpmdW5jdGlvbiBfdG9QcmltaXRpdmUodCwgcikgeyBpZiAoIm9iamVjdCIgIT0gX3R5cGVvZih0KSB8fCAhdCkgcmV0dXJuIHQ7IHZhciBlID0gdFtTeW1ib2wudG9QcmltaXRpdmVdOyBpZiAodm9pZCAwICE9PSBlKSB7IHZhciBpID0gZS5jYWxsKHQsIHIgfHwgImRlZmF1bHQiKTsgaWYgKCJvYmplY3QiICE9IF90eXBlb2YoaSkpIHJldHVybiBpOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoInN0cmluZyIgPT09IHIgPyBTdHJpbmcgOiBOdW1iZXIpKHQpOyB9CmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7IHZhciBpdCA9IHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSB8fCBvWyJAQGl0ZXJhdG9yIl07IGlmICghaXQpIHsgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHsgaWYgKGl0KSBvID0gaXQ7IHZhciBpID0gMDsgdmFyIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4geyBkb25lOiB0cnVlIH07IHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogb1tpKytdIH07IH0sIGU6IGZ1bmN0aW9uIGUoX2U0KSB7IHRocm93IF9lNDsgfSwgZjogRiB9OyB9IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfSB2YXIgbm9ybWFsQ29tcGxldGlvbiA9IHRydWUsIGRpZEVyciA9IGZhbHNlLCBlcnI7IHJldHVybiB7IHM6IGZ1bmN0aW9uIHMoKSB7IGl0ID0gaXQuY2FsbChvKTsgfSwgbjogZnVuY3Rpb24gbigpIHsgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7IG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7IHJldHVybiBzdGVwOyB9LCBlOiBmdW5jdGlvbiBlKF9lNSkgeyBkaWRFcnIgPSB0cnVlOyBlcnIgPSBfZTU7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdFsicmV0dXJuIl0gIT0gbnVsbCkgaXRbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChkaWRFcnIpIHRocm93IGVycjsgfSB9IH07IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH0KZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTsgcmV0dXJuIGFycjI7IH0KZnVuY3Rpb24gX3R5cGVvZihvKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IHJldHVybiBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykgeyByZXR1cm4gdHlwZW9mIG87IH0gOiBmdW5jdGlvbiAobykgeyByZXR1cm4gbyAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvOyB9LCBfdHlwZW9mKG8pOyB9Ci8qISBGb3IgbGljZW5zZSBpbmZvcm1hdGlvbiBwbGVhc2Ugc2VlIGxvd0xpZ2h0LmpzLkxJQ0VOU0UudHh0ICovCihmdW5jdGlvbiAoKSB7CiAgInVzZSBzdHJpY3QiOwoKICBmdW5jdGlvbiB0KGUpIHsKICAgIHJldHVybiB0ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIHQoZSk7CiAgfQogIGZ1bmN0aW9uIGUodCwgZSkgewogICAgZm9yICh2YXIgciA9IDA7IHIgPCBlLmxlbmd0aDsgcisrKSB7CiAgICAgIHZhciBhID0gZVtyXTsKICAgICAgYS5lbnVtZXJhYmxlID0gYS5lbnVtZXJhYmxlIHx8ICExLCBhLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIGEgJiYgKGEud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBuKGEua2V5KSwgYSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG4oZSkgewogICAgdmFyIG4gPSBmdW5jdGlvbiAoZSwgbikgewogICAgICBpZiAoIm9iamVjdCIgIT0gdChlKSB8fCAhZSkgcmV0dXJuIGU7CiAgICAgIHZhciByID0gZVtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSByKSB7CiAgICAgICAgdmFyIGEgPSByLmNhbGwoZSwgbiB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSB0KGEpKSByZXR1cm4gYTsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IG4gPyBTdHJpbmcgOiBOdW1iZXIpKGUpOwogICAgfShlLCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gdChuKSA/IG4gOiBTdHJpbmcobik7CiAgfQogIHZhciByID0gLjAwODg1NiwKICAgIGEgPSAxIC8gTWF0aC5zcXJ0KDIpLAogICAgbyA9IDEgLyBNYXRoLnNxcnQoMyksCiAgICBpID0gMSAvIE1hdGguc3FydCg2KSwKICAgIHUgPSBNYXRoLmxvZygxMCksCiAgICBsID0gZnVuY3Rpb24gKCkgewogICAgICBmdW5jdGlvbiB0KCkgewogICAgICAgICFmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgICB9KHRoaXMsIHQpOwogICAgICB9CiAgICAgIHZhciBuLCBsLCBjOwogICAgICByZXR1cm4gbiA9IHQsIGMgPSBbewogICAgICAgIGtleTogIlJHQnRvWFlaIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlIsCiAgICAgICAgICAgIG4gPSB0LkcsCiAgICAgICAgICAgIHIgPSB0LkI7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBYOiAuNDEyNDUzICogKGUgPSBhKGUpKSArIC4zNTc1OCAqIChuID0gYShuKSkgKyAuMTgwNDIzICogKHIgPSBhKHIpKSwKICAgICAgICAgICAgWTogLjIxMjY3MSAqIGUgKyAuNzE1MTYgKiBuICsgLjA3MjE2OSAqIHIsCiAgICAgICAgICAgIFo6IC4wMTkzMzQgKiBlICsgLjExOTE5MyAqIG4gKyAuOTUwMjI3ICogcgogICAgICAgICAgfTsKICAgICAgICAgIGZ1bmN0aW9uIGEodCkgewogICAgICAgICAgICByZXR1cm4gKHQgLz0gMjU1KSA+IC4wNDA0NSA/IE1hdGgucG93KCh0ICsgLjA1NSkgLyAxLjA1NSwgMi40KSA6IHQgLyAxMi45MjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJSR0J0b0NJRUxhYiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLlhZWnRvQ0lFTGFiKHRoaXMuUkdCdG9YWVoodCkpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlJHQnRvTE1TIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlIsCiAgICAgICAgICAgIG4gPSB0LkcsCiAgICAgICAgICAgIHIgPSB0LkI7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBMOiAuMzgxMSAqIGUgKyAuNTc4MyAqIG4gKyAuMDQwMiAqIHIsCiAgICAgICAgICAgIE06IC4xOTY3ICogZSArIC43MjQ0ICogbiArIC4wNzgyICogciwKICAgICAgICAgICAgUzogLjAyNDEgKiBlICsgLjEyODggKiBuICsgLjg0NDQgKiByCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlJHQnRvTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuTE1TdG9MYWIodGhpcy5SR0J0b0xNUyh0KSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiUkdCdG9ZIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgWTogKC4yOTkgKiB0LlIgKyAuNTg3ICogdC5HICsgLjExNCAqIHQuQikgLyAyNTUKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiWFladG9SR0IiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuWCwKICAgICAgICAgICAgbiA9IHQuWSwKICAgICAgICAgICAgciA9IHQuWiwKICAgICAgICAgICAgYSA9IHUoMy4yNDA2ICogZSArIC0xLjUzNzIgKiBuICsgLS40OTg2ICogciksCiAgICAgICAgICAgIG8gPSB1KC0uOTY4OSAqIGUgKyAxLjg3NTggKiBuICsgLjA0MTUgKiByKSwKICAgICAgICAgICAgaSA9IHUoLjA1NTcgKiBlICsgLS4yMDQgKiBuICsgMS4wNTcgKiByKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFI6IHMoMjU1ICogYSksCiAgICAgICAgICAgIEc6IHMoMjU1ICogbyksCiAgICAgICAgICAgIEI6IHMoMjU1ICogaSkKICAgICAgICAgIH07CiAgICAgICAgICBmdW5jdGlvbiB1KHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgPiAuMDAzMTMwOCA/IDEuMDU1ICogTWF0aC5wb3codCwgMSAvIDIuNCkgLSAuMDU1IDogMTIuOTIgKiB0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlhZWnRvQ0lFTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlgsCiAgICAgICAgICAgIG4gPSB0LlksCiAgICAgICAgICAgIGEgPSB0LlosCiAgICAgICAgICAgIG8gPSAhKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdKSB8fCBhcmd1bWVudHNbMV0sCiAgICAgICAgICAgIGkgPSBuID4gciA/IDExNiAqIE1hdGgucG93KG4sIDEgLyAzKSAtIDE2IDogOTAzLjMgKiBuLAogICAgICAgICAgICB1ID0gNTAwICogKHMoZSkgLSBzKG4pKSwKICAgICAgICAgICAgbCA9IDIwMCAqIChzKG4pIC0gcyhhKSk7CiAgICAgICAgICByZXR1cm4gbyA/IHRoaXMubm9ybWFsaXplQ0lFTGFiKHsKICAgICAgICAgICAgTDogaSwKICAgICAgICAgICAgYTogdSwKICAgICAgICAgICAgYjogbAogICAgICAgICAgfSkgOiB7CiAgICAgICAgICAgIEw6IGksCiAgICAgICAgICAgIGE6IHUsCiAgICAgICAgICAgIGI6IGwKICAgICAgICAgIH07CiAgICAgICAgICBmdW5jdGlvbiBzKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgPiByID8gTWF0aC5wb3codCwgMSAvIDMpIDogNy43ODcgKiB0ICsgMTYgLyAxMTY7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiQ0lFTGFidG9YWVoiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdICYmICFhcmd1bWVudHNbMV0gPyB0IDogdGhpcy5ub3JtYWxpemVCYWNrQ0lFTGFiKHQpLAogICAgICAgICAgICBuID0gZS5MLAogICAgICAgICAgICBhID0gZS5hLAogICAgICAgICAgICBvID0gZS5iLAogICAgICAgICAgICBpID0gKG4gKyAxNikgLyAxMTYsCiAgICAgICAgICAgIHUgPSBzKGEgLyA1MDAgKyBpKSwKICAgICAgICAgICAgbCA9IHMoaSAtIG8gLyAyMDApOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgWDogdSwKICAgICAgICAgICAgWTogcyhpKSwKICAgICAgICAgICAgWjogbAogICAgICAgICAgfTsKICAgICAgICAgIGZ1bmN0aW9uIHModCkgewogICAgICAgICAgICB2YXIgZSA9IE1hdGgucG93KHQsIDMpOwogICAgICAgICAgICByZXR1cm4gZSA+IHIgPyBlIDogKHQgLSAxNiAvIDExNikgLyA3Ljc4NzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJDSUVMYWJ0b1JHQiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLlhZWnRvUkdCKHRoaXMuQ0lFTGFidG9YWVoodCkpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIm5vcm1hbGl6ZUNJRUxhYiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIEw6IHQuTCAvIDEwMCwKICAgICAgICAgICAgYTogKHQuYSArIDEyOCkgLyAyNTUsCiAgICAgICAgICAgIGI6ICh0LmIgKyAxMjgpIC8gMjU1CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIm5vcm1hbGl6ZUJhY2tDSUVMYWIiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuYSwKICAgICAgICAgICAgciA9IHQuYjsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIEw6IE1hdGgubWluKDEwMCwgTWF0aC5tYXgoMCwgMTAwICogZSkpLAogICAgICAgICAgICBhOiBNYXRoLm1pbigxMjcsIE1hdGgubWF4KC0xMjcsIDI1NSAqIG4gLSAxMjgpKSwKICAgICAgICAgICAgYjogTWF0aC5taW4oMTI3LCBNYXRoLm1heCgtMTI3LCAyNTUgKiByIC0gMTI4KSkKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiTE1TdG9SR0IiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuTSwKICAgICAgICAgICAgciA9IHQuUzsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFI6IHMoNC40Njg2ICogZSAtIDMuNTg4NiAqIG4gKyAuMTE5NiAqIHIpLAogICAgICAgICAgICBHOiBzKC0xLjIxOTcgKiBlICsgMi4zODMgKiBuIC0gLjE2MjYgKiByKSwKICAgICAgICAgICAgQjogcyguMDU4NSAqIGUgLSAuMjYxICogbiArIDEuMjA1NiAqIHIpCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIkxNU3RvTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LkwsCiAgICAgICAgICAgIG4gPSB0Lk0sCiAgICAgICAgICAgIHIgPSB0LlM7CiAgICAgICAgICByZXR1cm4gZSAmJiAoZSA9IE1hdGgubG9nKGUpIC8gdSksIG4gJiYgKG4gPSBNYXRoLmxvZyhuKSAvIHUpLCByICYmIChyID0gTWF0aC5sb2cocikgLyB1KSwgewogICAgICAgICAgICBMOiAoZSArIG4gKyByKSAqIG8sCiAgICAgICAgICAgIGE6IChlICsgbiAtIDIgKiByKSAqIGksCiAgICAgICAgICAgIGI6IChlIC0gbikgKiBhCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIkxhYnRvUkdCIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuTE1TdG9SR0IodGhpcy5MYWJ0b0xNUyh0KSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiTGFidG9MTVMiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuYSwKICAgICAgICAgICAgciA9IHQuYjsKICAgICAgICAgIHJldHVybiBlICo9IG8sIG4gKj0gaSwgciAqPSBhLCB7CiAgICAgICAgICAgIEw6IE1hdGgucG93KDEwLCBlICsgbiArIHIpLAogICAgICAgICAgICBNOiBNYXRoLnBvdygxMCwgZSArIG4gLSByKSwKICAgICAgICAgICAgUzogTWF0aC5wb3coMTAsIGUgLSAyICogbikKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9XSwgKGwgPSBudWxsKSAmJiBlKG4ucHJvdG90eXBlLCBsKSwgYyAmJiBlKG4sIGMpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkobiwgInByb3RvdHlwZSIsIHsKICAgICAgICB3cml0YWJsZTogITEKICAgICAgfSksIHQ7CiAgICB9KCk7CiAgZnVuY3Rpb24gcyh0KSB7CiAgICByZXR1cm4gTWF0aC5taW4oMjU1LCBNYXRoLm1heCgwLCB0KSk7CiAgfQogIGZ1bmN0aW9uIGModCkgewogICAgcmV0dXJuIGMgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gX3R5cGVvZihTeW1ib2wuaXRlcmF0b3IpID8gZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuIF90eXBlb2YodCk7CiAgICB9IDogZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuIHQgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIHQuY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiB0ICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mKHQpOwogICAgfSwgYyh0KTsKICB9CiAgZnVuY3Rpb24gZih0LCBlKSB7CiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsKICAgICAgdmFyIHIgPSBlW25dOwogICAgICByLmVudW1lcmFibGUgPSByLmVudW1lcmFibGUgfHwgITEsIHIuY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gciAmJiAoci53cml0YWJsZSA9ICEwKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGgoci5rZXkpLCByKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gaCh0KSB7CiAgICB2YXIgZSA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgIGlmICgib2JqZWN0IiAhPSBjKHQpIHx8ICF0KSByZXR1cm4gdDsKICAgICAgdmFyIG4gPSB0W1N5bWJvbC50b1ByaW1pdGl2ZV07CiAgICAgIGlmICh2b2lkIDAgIT09IG4pIHsKICAgICAgICB2YXIgciA9IG4uY2FsbCh0LCBlIHx8ICJkZWZhdWx0Iik7CiAgICAgICAgaWYgKCJvYmplY3QiICE9IGMocikpIHJldHVybiByOwogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuIik7CiAgICAgIH0KICAgICAgcmV0dXJuICgic3RyaW5nIiA9PT0gZSA/IFN0cmluZyA6IE51bWJlcikodCk7CiAgICB9KHQsICJzdHJpbmciKTsKICAgIHJldHVybiAic3ltYm9sIiA9PSBjKGUpID8gZSA6IFN0cmluZyhlKTsKICB9CiAgdmFyIHYgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiB0KGUpIHsKICAgICAgIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfSh0aGlzLCB0KSwgdGhpcy5hQXZlcmFnZSA9IHt9LCB0aGlzLnN0ZERldiA9IHt9LCB0aGlzLnN1bSA9IHt9LCB0aGlzLnN1bVNxciA9IHt9LCB0aGlzLnBpeGVsc0NvdW50ID0gZTsKICAgIH0KICAgIHZhciBlLCBuLCByOwogICAgcmV0dXJuIGUgPSB0LCAobiA9IFt7CiAgICAgIGtleTogImFkZFBpeGVsIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgT2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgICAgdmFyIHIsIGE7CiAgICAgICAgICBlLnN1bVtuXSA9IChudWxsICE9PSAociA9IGUuc3VtW25dKSAmJiB2b2lkIDAgIT09IHIgPyByIDogMCkgKyB0W25dLCBlLnN1bVNxcltuXSA9IChudWxsICE9PSAoYSA9IGUuc3VtU3FyW25dKSAmJiB2b2lkIDAgIT09IGEgPyBhIDogMCkgKyBNYXRoLnBvdyh0W25dLCAyKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjb3VudEF2ZXJhZ2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnN1bSkuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIG47CiAgICAgICAgICB0LmFBdmVyYWdlW2VdID0gKG51bGwgIT09IChuID0gdC5zdW1bZV0pICYmIHZvaWQgMCAhPT0gbiA/IG4gOiAwKSAvIHQucGl4ZWxzQ291bnQ7CiAgICAgICAgfSksIHRoaXMuYUF2ZXJhZ2U7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY291bnRTdGREZXYiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnN1bVNxcikuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIG4sCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIGEgPSAobnVsbCAhPT0gKG4gPSB0LnN1bVNxcltlXSkgJiYgdm9pZCAwICE9PSBuID8gbiA6IDApIC0gdC5waXhlbHNDb3VudCAqIE1hdGgucG93KG51bGwgIT09IChyID0gdC5hQXZlcmFnZVtlXSkgJiYgdm9pZCAwICE9PSByID8gciA6IDAsIDIpOwogICAgICAgICAgdC5zdGREZXZbZV0gPSBNYXRoLnNxcnQoK2EudG9GaXhlZCg1KSAvICh0LnBpeGVsc0NvdW50IC0gMSkpOwogICAgICAgIH0pLCB0aGlzLnN0ZERldjsKICAgICAgfQogICAgfV0pICYmIGYoZS5wcm90b3R5cGUsIG4pLCByICYmIGYoZSwgciksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAicHJvdG90eXBlIiwgewogICAgICB3cml0YWJsZTogITEKICAgIH0pLCB0OwogIH0oKTsKICBmdW5jdGlvbiBiKHQpIHsKICAgIHJldHVybiBiID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIGIodCk7CiAgfQogIGZ1bmN0aW9uIHkodCwgZSkgewogICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgIHZhciByID0gZVtuXTsKICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBtKHIua2V5KSwgcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG0odCkgewogICAgdmFyIGUgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICBpZiAoIm9iamVjdCIgIT0gYih0KSB8fCAhdCkgcmV0dXJuIHQ7CiAgICAgIHZhciBuID0gdFtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSBuKSB7CiAgICAgICAgdmFyIHIgPSBuLmNhbGwodCwgZSB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSBiKHIpKSByZXR1cm4gcjsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IGUgPyBTdHJpbmcgOiBOdW1iZXIpKHQpOwogICAgfSh0LCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gYihlKSA/IGUgOiBTdHJpbmcoZSk7CiAgfQogIHZhciBwID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gdChlKSB7CiAgICAgICFmdW5jdGlvbiAodCwgZSkgewogICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBlKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgICAgIH0odGhpcywgdCksIHRoaXMuZGF0YVJHQmEgPSBlLCB0aGlzLnBpeGVsc0NvdW50ID0gZS5sZW5ndGggLyA0LCB0aGlzLmNoYW5uZWxzQ0lFTGFiID0gbmV3IHYodGhpcy5waXhlbHNDb3VudCksIHRoaXMuY2hhbm5lbHNMYWIgPSBuZXcgdih0aGlzLnBpeGVsc0NvdW50KSwgdGhpcy5jaGFubmVsc1kgPSBuZXcgdih0aGlzLnBpeGVsc0NvdW50KTsKICAgIH0KICAgIHZhciBlLCBuLCByOwogICAgcmV0dXJuIGUgPSB0LCAobiA9IFt7CiAgICAgIGtleTogImNvdW50QXZlcmFnZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICB0aGlzLmNoYW5uZWxzQ0lFTGFiLmNvdW50QXZlcmFnZSgpLCB0aGlzLmNoYW5uZWxzTGFiLmNvdW50QXZlcmFnZSgpLCB0aGlzLmNoYW5uZWxzWS5jb3VudEF2ZXJhZ2UoKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjb3VudFN0ZERldiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICB0aGlzLmNoYW5uZWxzQ0lFTGFiLmNvdW50U3RkRGV2KCksIHRoaXMuY2hhbm5lbHNMYWIuY291bnRTdGREZXYoKSwgdGhpcy5jaGFubmVsc1kuY291bnRTdGREZXYoKTsKICAgICAgfQogICAgfV0pICYmIHkoZS5wcm90b3R5cGUsIG4pLCByICYmIHkoZSwgciksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAicHJvdG90eXBlIiwgewogICAgICB3cml0YWJsZTogITEKICAgIH0pLCB0OwogIH0oKTsKICBmdW5jdGlvbiBMKHQpIHsKICAgIHJldHVybiBMID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIEwodCk7CiAgfQogIGZ1bmN0aW9uIGQodCwgZSkgewogICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgIHZhciByID0gZVtuXTsKICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBnKHIua2V5KSwgcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGcodCkgewogICAgdmFyIGUgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICBpZiAoIm9iamVjdCIgIT0gTCh0KSB8fCAhdCkgcmV0dXJuIHQ7CiAgICAgIHZhciBuID0gdFtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSBuKSB7CiAgICAgICAgdmFyIHIgPSBuLmNhbGwodCwgZSB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSBMKHIpKSByZXR1cm4gcjsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IGUgPyBTdHJpbmcgOiBOdW1iZXIpKHQpOwogICAgfSh0LCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gTChlKSA/IGUgOiBTdHJpbmcoZSk7CiAgfQogIHZhciBFID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gdCgpIHsKICAgICAgIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfSh0aGlzLCB0KSwgdGhpcy5kZWZhdWx0TFVUMzZfUkdCID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9SR0IoKSwgdGhpcy5kZWZhdWx0TFVUMzZfQ0lFTGFiID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9DSUVMYWIodGhpcy5kZWZhdWx0TFVUMzZfUkdCKSwgdGhpcy5kZWZhdWx0TFVUMzZfTGFiID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9MYWIodGhpcy5kZWZhdWx0TFVUMzZfUkdCKSwgdGhpcy5kZWZhdWx0TFVUMzZfWSA9IHRoaXMuZ2VuZXJhdGVEZWZhdWx0TFVUMzZfWSh0aGlzLmRlZmF1bHRMVVQzNl9SR0IpOwogICAgfQogICAgdmFyIGUsIG4sIHI7CiAgICByZXR1cm4gZSA9IHQsIG4gPSBbewogICAgICBrZXk6ICJwcm9jZXNzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIGUpIHsKICAgICAgICBmb3IgKHZhciBuID0gdGhpcywgciA9IG5ldyBwKHQpLCBhID0gbmV3IHAoZSksIG8gPSAwOyBvIDwgci5kYXRhUkdCYS5sZW5ndGg7IG8gKz0gNCkgewogICAgICAgICAgdmFyIGkgPSB7CiAgICAgICAgICAgICAgUjogci5kYXRhUkdCYVtvICsgMF0sCiAgICAgICAgICAgICAgRzogci5kYXRhUkdCYVtvICsgMV0sCiAgICAgICAgICAgICAgQjogci5kYXRhUkdCYVtvICsgMl0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgdSA9IHsKICAgICAgICAgICAgICBSOiBhLmRhdGFSR0JhW28gKyAwXSwKICAgICAgICAgICAgICBHOiBhLmRhdGFSR0JhW28gKyAxXSwKICAgICAgICAgICAgICBCOiBhLmRhdGFSR0JhW28gKyAyXQogICAgICAgICAgICB9LAogICAgICAgICAgICBzID0gbC5SR0J0b0NJRUxhYihpKSwKICAgICAgICAgICAgYyA9IGwuUkdCdG9DSUVMYWIodSk7CiAgICAgICAgICByLmNoYW5uZWxzQ0lFTGFiLmFkZFBpeGVsKHMpLCBhLmNoYW5uZWxzQ0lFTGFiLmFkZFBpeGVsKGMpOwogICAgICAgICAgdmFyIGYgPSBsLlJHQnRvTGFiKGkpLAogICAgICAgICAgICBoID0gbC5SR0J0b0xhYih1KTsKICAgICAgICAgIHIuY2hhbm5lbHNMYWIuYWRkUGl4ZWwoZiksIGEuY2hhbm5lbHNMYWIuYWRkUGl4ZWwoaCk7CiAgICAgICAgICB2YXIgdiA9IGwuUkdCdG9ZKGkpLAogICAgICAgICAgICBiID0gbC5SR0J0b1kodSk7CiAgICAgICAgICByLmNoYW5uZWxzWS5hZGRQaXhlbCh2KSwgYS5jaGFubmVsc1kuYWRkUGl4ZWwoYik7CiAgICAgICAgfQogICAgICAgIHIuY291bnRBdmVyYWdlKCksIGEuY291bnRBdmVyYWdlKCksIHIuY291bnRTdGREZXYoKSwgYS5jb3VudFN0ZERldigpOwogICAgICAgIGZvciAodmFyIHkgPSBbXSwgbSA9IGZ1bmN0aW9uIG0oKSB7CiAgICAgICAgICAgIHZhciB0ID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9DSUVMYWJbMyAqIEwgKyAwXSwgIkwiLCByLmNoYW5uZWxzQ0lFTGFiLCBhLmNoYW5uZWxzQ0lFTGFiLCAhMCksCiAgICAgICAgICAgICAgZSA9IG4ubWVyZ2Uobi5kZWZhdWx0TFVUMzZfQ0lFTGFiWzMgKiBMICsgMV0sICJhIiwgci5jaGFubmVsc0NJRUxhYiwgYS5jaGFubmVsc0NJRUxhYiwgITApLAogICAgICAgICAgICAgIG8gPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X0NJRUxhYlszICogTCArIDJdLCAiYiIsIHIuY2hhbm5lbHNDSUVMYWIsIGEuY2hhbm5lbHNDSUVMYWIsICEwKSwKICAgICAgICAgICAgICBpID0gbC5DSUVMYWJ0b1JHQih7CiAgICAgICAgICAgICAgICBMOiB0LAogICAgICAgICAgICAgICAgYTogZSwKICAgICAgICAgICAgICAgIGI6IG8KICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICB1ID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9MYWJbMyAqIEwgKyAwXSwgIkwiLCByLmNoYW5uZWxzTGFiLCBhLmNoYW5uZWxzTGFiKSwKICAgICAgICAgICAgICBzID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9MYWJbMyAqIEwgKyAxXSwgImEiLCByLmNoYW5uZWxzTGFiLCBhLmNoYW5uZWxzTGFiKSwKICAgICAgICAgICAgICBjID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9MYWJbMyAqIEwgKyAyXSwgImIiLCByLmNoYW5uZWxzTGFiLCBhLmNoYW5uZWxzTGFiKSwKICAgICAgICAgICAgICBmID0gbC5MYWJ0b1JHQih7CiAgICAgICAgICAgICAgICBMOiB1LAogICAgICAgICAgICAgICAgYTogcywKICAgICAgICAgICAgICAgIGI6IGMKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBoID0gbi5taXgoaSwgZiwgLjYpLAogICAgICAgICAgICAgIHYgPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X1lbTF0sICJZIiwgci5jaGFubmVsc1ksIGEuY2hhbm5lbHNZLCAhMCksCiAgICAgICAgICAgICAgYiA9IGwuUkdCdG9ZKGgpLlksCiAgICAgICAgICAgICAgbSA9IGZ1bmN0aW9uIG0odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKDI1NSwgdCAqIHYgLyBNYXRoLm1heChiLCAxIC8gMjU1KSk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBwID0gewogICAgICAgICAgICAgICAgUjogbShoLlIpLAogICAgICAgICAgICAgICAgRzogbShoLkcpLAogICAgICAgICAgICAgICAgQjogbShoLkIpCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkID0gewogICAgICAgICAgICAgICAgUjogMjU1ICogbi5kZWZhdWx0TFVUMzZfWVtMXSwKICAgICAgICAgICAgICAgIEc6IDI1NSAqIG4uZGVmYXVsdExVVDM2X1lbTF0sCiAgICAgICAgICAgICAgICBCOiAyNTUgKiBuLmRlZmF1bHRMVVQzNl9ZW0xdCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBnID0gbi5taXgocCwgZCwgLjkpOwogICAgICAgICAgICB5LnB1c2goZy5SLCBnLkcsIGcuQiwgMjU1KTsKICAgICAgICAgIH0sIEwgPSAwOyBMIDwgdGhpcy5kZWZhdWx0TFVUMzZfUkdCLmxlbmd0aCAvIDM7IEwrKykgbSgpOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBORVdfTFVUMzZfUkdCYV9USU5URUQ6IHkKICAgICAgICB9OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdlbmVyYXRlRGVmYXVsdExVVDM2X1JHQiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICBmb3IgKHZhciB0ID0gMzYsIGUgPSBNYXRoLnBvdygyMTYsIDIpLCBuID0gMjU1IC8gdCwgciA9IG5ldyBVaW50OENsYW1wZWRBcnJheSgzICogZSksIGEgPSAwOyBhIDwgZTsgYSsrKSB7CiAgICAgICAgICB2YXIgbyA9IGkoYSwgNiwgdCk7CiAgICAgICAgICByWzMgKiBhICsgMF0gPSBhICUgdCAqIG4sIHJbMyAqIGEgKyAxXSA9IE1hdGgudHJ1bmMoYSAvIDIxNiAlIHQpICogbiwgclszICogYSArIDJdID0gbyAqICgyNTUgLyAzNik7CiAgICAgICAgfQogICAgICAgIHJldHVybiByOwogICAgICAgIGZ1bmN0aW9uIGkodCwgZSwgbikgewogICAgICAgICAgdmFyIHIgPSBNYXRoLnRydW5jKHQgLyBuKSAlIGU7CiAgICAgICAgICByZXR1cm4gZSAqIE1hdGgudHJ1bmModCAvIChuICogbiAqIGUpKSArIHI7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdlbmVyYXRlRGVmYXVsdExVVDM2X0NJRUxhYiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgZm9yICh2YXIgZSA9IG5ldyBBcnJheSh0Lmxlbmd0aCksIG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgewogICAgICAgICAgdmFyIHIgPSB7CiAgICAgICAgICAgICAgUjogdFszICogbiArIDBdLAogICAgICAgICAgICAgIEc6IHRbMyAqIG4gKyAxXSwKICAgICAgICAgICAgICBCOiB0WzMgKiBuICsgMl0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgYSA9IGwuUkdCdG9DSUVMYWIociksCiAgICAgICAgICAgIG8gPSBhLkwsCiAgICAgICAgICAgIGkgPSBhLmEsCiAgICAgICAgICAgIHUgPSBhLmI7CiAgICAgICAgICBlWzMgKiBuICsgMF0gPSBvLCBlWzMgKiBuICsgMV0gPSBpLCBlWzMgKiBuICsgMl0gPSB1OwogICAgICAgIH0KICAgICAgICByZXR1cm4gZTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZW5lcmF0ZURlZmF1bHRMVVQzNl9MYWIiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgIGZvciAodmFyIGUgPSBuZXcgQXJyYXkodC5sZW5ndGgpLCBuID0gMDsgbiA8IHQubGVuZ3RoIC8gMzsgbisrKSB7CiAgICAgICAgICB2YXIgciA9IHsKICAgICAgICAgICAgICBSOiB0WzMgKiBuICsgMF0sCiAgICAgICAgICAgICAgRzogdFszICogbiArIDFdLAogICAgICAgICAgICAgIEI6IHRbMyAqIG4gKyAyXQogICAgICAgICAgICB9LAogICAgICAgICAgICBhID0gbC5SR0J0b0xhYihyKSwKICAgICAgICAgICAgbyA9IGEuTCwKICAgICAgICAgICAgaSA9IGEuYSwKICAgICAgICAgICAgdSA9IGEuYjsKICAgICAgICAgIGVbMyAqIG4gKyAwXSA9IG8sIGVbMyAqIG4gKyAxXSA9IGksIGVbMyAqIG4gKyAyXSA9IHU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdlbmVyYXRlRGVmYXVsdExVVDM2X1kiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgIGZvciAodmFyIGUgPSBbXSwgbiA9IDA7IG4gPCB0Lmxlbmd0aCAvIDM7IG4rKykgewogICAgICAgICAgdmFyIHIgPSB7CiAgICAgICAgICAgICAgUjogdFszICogbiArIDBdLAogICAgICAgICAgICAgIEc6IHRbMyAqIG4gKyAxXSwKICAgICAgICAgICAgICBCOiB0WzMgKiBuICsgMl0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgYSA9IGwuUkdCdG9ZKHIpLlk7CiAgICAgICAgICBlLnB1c2goYSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm1lcmdlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIGUsIG4sIHIpIHsKICAgICAgICB2YXIgYSwKICAgICAgICAgIG8sCiAgICAgICAgICBpLAogICAgICAgICAgdSwKICAgICAgICAgIGwgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1s0XSAmJiBhcmd1bWVudHNbNF0sCiAgICAgICAgICBzID0gbnVsbCAhPT0gKGEgPSBuLmFBdmVyYWdlW2VdKSAmJiB2b2lkIDAgIT09IGEgPyBhIDogMCwKICAgICAgICAgIGMgPSBudWxsICE9PSAobyA9IHIuYUF2ZXJhZ2VbZV0pICYmIHZvaWQgMCAhPT0gbyA/IG8gOiAwLAogICAgICAgICAgZiA9IG51bGwgIT09IChpID0gbi5zdGREZXZbZV0pICYmIHZvaWQgMCAhPT0gaSA/IGkgOiAwLAogICAgICAgICAgaCA9IG51bGwgIT09ICh1ID0gci5zdGREZXZbZV0pICYmIHZvaWQgMCAhPT0gdSA/IHUgOiAwOwogICAgICAgIGlmICghbi5zdGREZXZbZV0gfHwgIXIuc3RkRGV2W2VdKSB7CiAgICAgICAgICB2YXIgdiA9IHQgKyBjIC0gczsKICAgICAgICAgIHJldHVybiBNYXRoLm1pbigxLCBNYXRoLm1heCgwLCB2KSk7CiAgICAgICAgfQogICAgICAgIHZhciBiID0gKHQgLSBzKSAvIGYgKiBoICsgYzsKICAgICAgICByZXR1cm4gbCA/IE1hdGgubWluKDEsIE1hdGgubWF4KDAsIGIpKSA6IGI7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAibWl4IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIGUsIG4pIHsKICAgICAgICByZXR1cm4gbiA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIG4pKSwgewogICAgICAgICAgUjogcih0LlIsIGUuUiksCiAgICAgICAgICBHOiByKHQuRywgZS5HKSwKICAgICAgICAgIEI6IHIodC5CLCBlLkIpCiAgICAgICAgfTsKICAgICAgICBmdW5jdGlvbiByKHQsIGUpIHsKICAgICAgICAgIHJldHVybiB0ICogbiArIGUgKiAoMSAtIG4pOwogICAgICAgIH0KICAgICAgfQogICAgfV0sIG4gJiYgZChlLnByb3RvdHlwZSwgbiksIHIgJiYgZChlLCByKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsICJwcm90b3R5cGUiLCB7CiAgICAgIHdyaXRhYmxlOiAhMQogICAgfSksIHQ7CiAgfSgpOwogIHZhciBTID0gU3ltYm9sKCJDb21saW5rLnByb3h5IiksCiAgICBSID0gU3ltYm9sKCJDb21saW5rLmVuZHBvaW50IiksCiAgICB3ID0gU3ltYm9sKCJDb21saW5rLnJlbGVhc2VQcm94eSIpLAogICAgRyA9IFN5bWJvbCgiQ29tbGluay5maW5hbGl6ZXIiKSwKICAgIE0gPSBTeW1ib2woIkNvbWxpbmsudGhyb3duIiksCiAgICBCID0gZnVuY3Rpb24gQih0KSB7CiAgICAgIHJldHVybiAib2JqZWN0IiA9PSBfdHlwZW9mKHQpICYmIG51bGwgIT09IHQgfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdDsKICAgIH0sCiAgICBUID0gbmV3IE1hcChbWyJwcm94eSIsIHsKICAgICAgY2FuSGFuZGxlOiBmdW5jdGlvbiBjYW5IYW5kbGUodCkgewogICAgICAgIHJldHVybiBCKHQpICYmIHRbU107CiAgICAgIH0sCiAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24gc2VyaWFsaXplKHQpIHsKICAgICAgICB2YXIgX01lc3NhZ2VDaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCksCiAgICAgICAgICBlID0gX01lc3NhZ2VDaGFubmVsLnBvcnQxLAogICAgICAgICAgbiA9IF9NZXNzYWdlQ2hhbm5lbC5wb3J0MjsKICAgICAgICByZXR1cm4gQyh0LCBlKSwgW24sIFtuXV07CiAgICAgIH0sCiAgICAgIGRlc2VyaWFsaXplOiBmdW5jdGlvbiBkZXNlcmlhbGl6ZSh0KSB7CiAgICAgICAgcmV0dXJuIHQuc3RhcnQoKSwgXyh0LCBbXSwgZSk7CiAgICAgICAgdmFyIGU7CiAgICAgIH0KICAgIH1dLCBbInRocm93IiwgewogICAgICBjYW5IYW5kbGU6IGZ1bmN0aW9uIGNhbkhhbmRsZSh0KSB7CiAgICAgICAgcmV0dXJuIEIodCkgJiYgTSBpbiB0OwogICAgICB9LAogICAgICBzZXJpYWxpemU6IGZ1bmN0aW9uIHNlcmlhbGl6ZShfcmVmKSB7CiAgICAgICAgdmFyIHQgPSBfcmVmLnZhbHVlOwogICAgICAgIHZhciBlOwogICAgICAgIHJldHVybiBlID0gdCBpbnN0YW5jZW9mIEVycm9yID8gewogICAgICAgICAgaXNFcnJvcjogITAsCiAgICAgICAgICB2YWx1ZTogewogICAgICAgICAgICBtZXNzYWdlOiB0Lm1lc3NhZ2UsCiAgICAgICAgICAgIG5hbWU6IHQubmFtZSwKICAgICAgICAgICAgc3RhY2s6IHQuc3RhY2sKICAgICAgICAgIH0KICAgICAgICB9IDogewogICAgICAgICAgaXNFcnJvcjogITEsCiAgICAgICAgICB2YWx1ZTogdAogICAgICAgIH0sIFtlLCBbXV07CiAgICAgIH0sCiAgICAgIGRlc2VyaWFsaXplOiBmdW5jdGlvbiBkZXNlcmlhbGl6ZSh0KSB7CiAgICAgICAgaWYgKHQuaXNFcnJvcikgdGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3IodC52YWx1ZS5tZXNzYWdlKSwgdC52YWx1ZSk7CiAgICAgICAgdGhyb3cgdC52YWx1ZTsKICAgICAgfQogICAgfV1dKTsKICBmdW5jdGlvbiBDKHQpIHsKICAgIHZhciBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBnbG9iYWxUaGlzOwogICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IFsiKiJdOwogICAgZS5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgZnVuY3Rpb24gcihhKSB7CiAgICAgIGlmICghYSB8fCAhYS5kYXRhKSByZXR1cm47CiAgICAgIGlmICghZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodCksCiAgICAgICAgICBfc3RlcDsKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIF9uID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgIGlmIChlID09PSBfbiB8fCAiKiIgPT09IF9uKSByZXR1cm4gITA7CiAgICAgICAgICAgIGlmIChfbiBpbnN0YW5jZW9mIFJlZ0V4cCAmJiBfbi50ZXN0KGUpKSByZXR1cm4gITA7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gITE7CiAgICAgIH0obiwgYS5vcmlnaW4pKSByZXR1cm4gdm9pZCBjb25zb2xlLndhcm4oIkludmFsaWQgb3JpZ2luICciLmNvbmNhdChhLm9yaWdpbiwgIicgZm9yIGNvbWxpbmsgcHJveHkiKSk7CiAgICAgIHZhciBfT2JqZWN0JGFzc2lnbiA9IE9iamVjdC5hc3NpZ24oewogICAgICAgICAgcGF0aDogW10KICAgICAgICB9LCBhLmRhdGEpLAogICAgICAgIG8gPSBfT2JqZWN0JGFzc2lnbi5pZCwKICAgICAgICBpID0gX09iamVjdCRhc3NpZ24udHlwZSwKICAgICAgICB1ID0gX09iamVjdCRhc3NpZ24ucGF0aCwKICAgICAgICBsID0gKGEuZGF0YS5hcmd1bWVudExpc3QgfHwgW10pLm1hcChEKTsKICAgICAgdmFyIHM7CiAgICAgIHRyeSB7CiAgICAgICAgdmFyIF9lID0gdS5zbGljZSgwLCAtMSkucmVkdWNlKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgIHJldHVybiB0W2VdOwogICAgICAgICAgfSwgdCksCiAgICAgICAgICBfbjIgPSB1LnJlZHVjZShmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICByZXR1cm4gdFtlXTsKICAgICAgICAgIH0sIHQpOwogICAgICAgIHN3aXRjaCAoaSkgewogICAgICAgICAgY2FzZSAiR0VUIjoKICAgICAgICAgICAgcyA9IF9uMjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJTRVQiOgogICAgICAgICAgICBfZVt1LnNsaWNlKC0xKVswXV0gPSBEKGEuZGF0YS52YWx1ZSksIHMgPSAhMDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJBUFBMWSI6CiAgICAgICAgICAgIHMgPSBfbjIuYXBwbHkoX2UsIGwpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIkNPTlNUUlVDVCI6CiAgICAgICAgICAgIHMgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHQsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgUywgITApKTsKICAgICAgICAgICAgfShfY29uc3RydWN0KF9uMiwgX3RvQ29uc3VtYWJsZUFycmF5KGwpKSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiRU5EUE9JTlQiOgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdmFyIF9NZXNzYWdlQ2hhbm5lbDIgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKSwKICAgICAgICAgICAgICAgIF9lMiA9IF9NZXNzYWdlQ2hhbm5lbDIucG9ydDEsCiAgICAgICAgICAgICAgICBfbjMgPSBfTWVzc2FnZUNoYW5uZWwyLnBvcnQyOwogICAgICAgICAgICAgIEModCwgX24zKSwgcyA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gai5zZXQodCwgZSksIHQ7CiAgICAgICAgICAgICAgfShfZTIsIFtfZTJdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIlJFTEVBU0UiOgogICAgICAgICAgICBzID0gdm9pZCAwOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICBzID0gX2RlZmluZVByb3BlcnR5KHsKICAgICAgICAgIHZhbHVlOiB0CiAgICAgICAgfSwgTSwgMCk7CiAgICAgIH0KICAgICAgUHJvbWlzZS5yZXNvbHZlKHMpWyJjYXRjaCJdKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgcmV0dXJuIF9kZWZpbmVQcm9wZXJ0eSh7CiAgICAgICAgICB2YWx1ZTogdAogICAgICAgIH0sIE0sIDApOwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgdmFyIF9BID0gQShuKSwKICAgICAgICAgIF9BMiA9IF9zbGljZWRUb0FycmF5KF9BLCAyKSwKICAgICAgICAgIGEgPSBfQTJbMF0sCiAgICAgICAgICB1ID0gX0EyWzFdOwogICAgICAgIGUucG9zdE1lc3NhZ2UoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBhKSwgewogICAgICAgICAgaWQ6IG8KICAgICAgICB9KSwgdSksICJSRUxFQVNFIiA9PT0gaSAmJiAoZS5yZW1vdmVFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgciksIGsoZSksIEcgaW4gdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiB0W0ddICYmIHRbR10oKSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgdmFyIF9BMyA9IEEoX2RlZmluZVByb3BlcnR5KHsKICAgICAgICAgICAgdmFsdWU6IG5ldyBUeXBlRXJyb3IoIlVuc2VyaWFsaXphYmxlIHJldHVybiB2YWx1ZSIpCiAgICAgICAgICB9LCBNLCAwKSksCiAgICAgICAgICBfQTQgPSBfc2xpY2VkVG9BcnJheShfQTMsIDIpLAogICAgICAgICAgbiA9IF9BNFswXSwKICAgICAgICAgIHIgPSBfQTRbMV07CiAgICAgICAgZS5wb3N0TWVzc2FnZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG4pLCB7CiAgICAgICAgICBpZDogbwogICAgICAgIH0pLCByKTsKICAgICAgfSk7CiAgICB9KSwgZS5zdGFydCAmJiBlLnN0YXJ0KCk7CiAgfQogIGZ1bmN0aW9uIGsodCkgewogICAgKGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiAiTWVzc2FnZVBvcnQiID09PSB0LmNvbnN0cnVjdG9yLm5hbWU7CiAgICB9KSh0KSAmJiB0LmNsb3NlKCk7CiAgfQogIGZ1bmN0aW9uIEkodCkgewogICAgaWYgKHQpIHRocm93IG5ldyBFcnJvcigiUHJveHkgaGFzIGJlZW4gcmVsZWFzZWQgYW5kIGlzIG5vdCB1c2VhYmxlIik7CiAgfQogIGZ1bmN0aW9uIFkodCkgewogICAgcmV0dXJuIE8odCwgewogICAgICB0eXBlOiAiUkVMRUFTRSIKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBrKHQpOwogICAgfSk7CiAgfQogIHZhciB4ID0gbmV3IFdlYWtNYXAoKSwKICAgIFAgPSAiRmluYWxpemF0aW9uUmVnaXN0cnkiIGluIGdsb2JhbFRoaXMgJiYgbmV3IEZpbmFsaXphdGlvblJlZ2lzdHJ5KGZ1bmN0aW9uICh0KSB7CiAgICAgIHZhciBlID0gKHguZ2V0KHQpIHx8IDApIC0gMTsKICAgICAgeC5zZXQodCwgZSksIDAgPT09IGUgJiYgWSh0KTsKICAgIH0pOwogIGZ1bmN0aW9uIF8odCkgewogICAgdmFyIGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFtdOwogICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZ1bmN0aW9uICgpIHt9OwogICAgdmFyIHIgPSAhMTsKICAgIHZhciBhID0gbmV3IFByb3h5KG4sIHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQobiwgbykgewogICAgICAgIGlmIChJKHIpLCBvID09PSB3KSByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgIWZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIFAgJiYgUC51bnJlZ2lzdGVyKHQpOwogICAgICAgICAgfShhKSwgWSh0KSwgciA9ICEwOwogICAgICAgIH07CiAgICAgICAgaWYgKCJ0aGVuIiA9PT0gbykgewogICAgICAgICAgaWYgKDAgPT09IGUubGVuZ3RoKSByZXR1cm4gewogICAgICAgICAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKCkgewogICAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgdmFyIF9uNCA9IE8odCwgewogICAgICAgICAgICB0eXBlOiAiR0VUIiwKICAgICAgICAgICAgcGF0aDogZS5tYXAoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gdC50b1N0cmluZygpOwogICAgICAgICAgICB9KQogICAgICAgICAgfSkudGhlbihEKTsKICAgICAgICAgIHJldHVybiBfbjQudGhlbi5iaW5kKF9uNCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfKHQsIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZSksIFtvXSkpOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChuLCBhLCBvKSB7CiAgICAgICAgSShyKTsKICAgICAgICB2YXIgX0E2ID0gQShvKSwKICAgICAgICAgIF9BNyA9IF9zbGljZWRUb0FycmF5KF9BNiwgMiksCiAgICAgICAgICBpID0gX0E3WzBdLAogICAgICAgICAgdSA9IF9BN1sxXTsKICAgICAgICByZXR1cm4gTyh0LCB7CiAgICAgICAgICB0eXBlOiAiU0VUIiwKICAgICAgICAgIHBhdGg6IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZSksIFthXSkubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHJldHVybiB0LnRvU3RyaW5nKCk7CiAgICAgICAgICB9KSwKICAgICAgICAgIHZhbHVlOiBpCiAgICAgICAgfSwgdSkudGhlbihEKTsKICAgICAgfSwKICAgICAgYXBwbHk6IGZ1bmN0aW9uIGFwcGx5KG4sIGEsIG8pIHsKICAgICAgICBJKHIpOwogICAgICAgIHZhciBpID0gZVtlLmxlbmd0aCAtIDFdOwogICAgICAgIGlmIChpID09PSBSKSByZXR1cm4gTyh0LCB7CiAgICAgICAgICB0eXBlOiAiRU5EUE9JTlQiCiAgICAgICAgfSkudGhlbihEKTsKICAgICAgICBpZiAoImJpbmQiID09PSBpKSByZXR1cm4gXyh0LCBlLnNsaWNlKDAsIC0xKSk7CiAgICAgICAgdmFyIF9VID0gVShvKSwKICAgICAgICAgIF9VMiA9IF9zbGljZWRUb0FycmF5KF9VLCAyKSwKICAgICAgICAgIHUgPSBfVTJbMF0sCiAgICAgICAgICBsID0gX1UyWzFdOwogICAgICAgIHJldHVybiBPKHQsIHsKICAgICAgICAgIHR5cGU6ICJBUFBMWSIsCiAgICAgICAgICBwYXRoOiBlLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgICAgICByZXR1cm4gdC50b1N0cmluZygpOwogICAgICAgICAgfSksCiAgICAgICAgICBhcmd1bWVudExpc3Q6IHUKICAgICAgICB9LCBsKS50aGVuKEQpOwogICAgICB9LAogICAgICBjb25zdHJ1Y3Q6IGZ1bmN0aW9uIGNvbnN0cnVjdChuLCBhKSB7CiAgICAgICAgSShyKTsKICAgICAgICB2YXIgX1UzID0gVShhKSwKICAgICAgICAgIF9VNCA9IF9zbGljZWRUb0FycmF5KF9VMywgMiksCiAgICAgICAgICBvID0gX1U0WzBdLAogICAgICAgICAgaSA9IF9VNFsxXTsKICAgICAgICByZXR1cm4gTyh0LCB7CiAgICAgICAgICB0eXBlOiAiQ09OU1RSVUNUIiwKICAgICAgICAgIHBhdGg6IGUubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHJldHVybiB0LnRvU3RyaW5nKCk7CiAgICAgICAgICB9KSwKICAgICAgICAgIGFyZ3VtZW50TGlzdDogbwogICAgICAgIH0sIGkpLnRoZW4oRCk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgIHZhciBuID0gKHguZ2V0KGUpIHx8IDApICsgMTsKICAgICAgeC5zZXQoZSwgbiksIFAgJiYgUC5yZWdpc3Rlcih0LCBlLCB0KTsKICAgIH0oYSwgdCksIGE7CiAgfQogIGZ1bmN0aW9uIFUodCkgewogICAgdmFyIGUgPSB0Lm1hcChBKTsKICAgIHJldHVybiBbZS5tYXAoZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuIHRbMF07CiAgICB9KSwgKG4gPSBlLm1hcChmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gdFsxXTsKICAgIH0pLCBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBuKSldOwogICAgdmFyIG47CiAgfQogIHZhciBqID0gbmV3IFdlYWtNYXAoKTsKICBmdW5jdGlvbiBBKHQpIHsKICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoVCksCiAgICAgIF9zdGVwMjsKICAgIHRyeSB7CiAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgdmFyIF9zdGVwMiR2YWx1ZSA9IF9zbGljZWRUb0FycmF5KF9zdGVwMi52YWx1ZSwgMiksCiAgICAgICAgICBfZTMgPSBfc3RlcDIkdmFsdWVbMF0sCiAgICAgICAgICBfbjUgPSBfc3RlcDIkdmFsdWVbMV07CiAgICAgICAgaWYgKF9uNS5jYW5IYW5kbGUodCkpIHsKICAgICAgICAgIHZhciBfbjUkc2VyaWFsaXplID0gX241LnNlcmlhbGl6ZSh0KSwKICAgICAgICAgICAgX241JHNlcmlhbGl6ZTIgPSBfc2xpY2VkVG9BcnJheShfbjUkc2VyaWFsaXplLCAyKSwKICAgICAgICAgICAgX3IgPSBfbjUkc2VyaWFsaXplMlswXSwKICAgICAgICAgICAgX2EgPSBfbjUkc2VyaWFsaXplMlsxXTsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICB0eXBlOiAiSEFORExFUiIsCiAgICAgICAgICAgIG5hbWU6IF9lMywKICAgICAgICAgICAgdmFsdWU6IF9yCiAgICAgICAgICB9LCBfYV07CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICB9IGZpbmFsbHkgewogICAgICBfaXRlcmF0b3IyLmYoKTsKICAgIH0KICAgIHJldHVybiBbewogICAgICB0eXBlOiAiUkFXIiwKICAgICAgdmFsdWU6IHQKICAgIH0sIGouZ2V0KHQpIHx8IFtdXTsKICB9CiAgZnVuY3Rpb24gRCh0KSB7CiAgICBzd2l0Y2ggKHQudHlwZSkgewogICAgICBjYXNlICJIQU5ETEVSIjoKICAgICAgICByZXR1cm4gVC5nZXQodC5uYW1lKS5kZXNlcmlhbGl6ZSh0LnZhbHVlKTsKICAgICAgY2FzZSAiUkFXIjoKICAgICAgICByZXR1cm4gdC52YWx1ZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gTyh0LCBlLCBuKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHIpIHsKICAgICAgdmFyIGEgPSBuZXcgQXJyYXkoNCkuZmlsbCgwKS5tYXAoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikudG9TdHJpbmcoMTYpOwogICAgICB9KS5qb2luKCItIik7CiAgICAgIHQuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uIGUobikgewogICAgICAgIG4uZGF0YSAmJiBuLmRhdGEuaWQgJiYgbi5kYXRhLmlkID09PSBhICYmICh0LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBlKSwgcihuLmRhdGEpKTsKICAgICAgfSksIHQuc3RhcnQgJiYgdC5zdGFydCgpLCB0LnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24oewogICAgICAgIGlkOiBhCiAgICAgIH0sIGUpLCBuKTsKICAgIH0pOwogIH0KICB2YXIgTiA9IG5ldyBFKCk7CiAgQyh7CiAgICBnZXRMVVRUZXh0dXJlOiBmdW5jdGlvbiBnZXRMVVRUZXh0dXJlKHQsIGUpIHsKICAgICAgcmV0dXJuIE4ucHJvY2Vzcyh0LCBlKS5ORVdfTFVUMzZfUkdCYV9USU5URUQ7CiAgICB9CiAgfSk7Cn0pKCk7"},6204:function(){},1472:function _(__unused_webpack___webpack_module__,__nested_webpack_exports__,__nested_webpack_require_351316__){__nested_webpack_require_351316__.d(__nested_webpack_exports__,{CU:function(){return Nd},_K:function(){return ee},w3:function(){return Re}});var process=__nested_webpack_require_351316__(6512),Buffer=__nested_webpack_require_351316__(3296).Sn,Fd=Object.create,kn=Object.defineProperty,Cd=Object.getOwnPropertyDescriptor,$d=Object.getOwnPropertyNames,Bd=Object.getPrototypeOf,kd=Object.prototype.hasOwnProperty,Ka=(a=function(e){if(_typeof(__webpack_require__(2805))<"u")return __webpack_require__(2805).apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},_typeof(__webpack_require__(2805))<"u"?__webpack_require__(2805):("undefined"===typeof Proxy?"undefined":_typeof(Proxy))<"u"?new Proxy(a,{get:function(e,t){return(_typeof(__webpack_require__(2805))<"u"?__webpack_require__(2805):e)[t]}}):a),a,L=function(e,t){return function(){return e&&(t=e(e=0)),t}},ye=function(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports}},kr=function(e,t){for(var n in t)kn(e,n,{get:t[n],enumerable:!0})},Ja=function(e,t,n,r){if(t&&"object"==_typeof(t)||"function"==typeof t){var i,o=_createForOfIteratorHelper($d(t));try{var a=function(){var o=i.value;!kd.call(e,o)&&o!==n&&kn(e,o,{get:function(){return t[o]},enumerable:!(r=Cd(t,o))||r.enumerable})};for(o.s();!(i=o.n()).done;)a()}catch(s){o.e(s)}finally{o.f()}}return e},Nr=function(e,t,n){return n=null!=e?Fd(Bd(e)):{},Ja(!t&&e&&e.__esModule?n:kn(n,"default",{value:e,enumerable:!0}),e)},fr=function(e){return Ja(kn({},"__esModule",{value:!0}),e)},Nn,cr,pr,Rn,Mn=L((function(){Nn=new Map,cr=[],pr=function(e,t,n){if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");var r=Nn.get(e);if(void 0===r)Nn.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error('cannot register backend "'.concat(e,'" using priority ').concat(n))}if(n>=0){var i=cr.indexOf(e);-1!==i&&cr.splice(i,1);for(var o=0;o<cr.length;o++)if(Nn.get(cr[o]).priority<=n)return void cr.splice(o,0,e);cr.push(e)}},Rn=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o,a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0===t.length?cr:t,r=[],i=_createForOfIteratorHelper(n),e.prev=2,i.s();case 4:if((o=i.n()).done){e.next=29;break}if(a=o.value,!(s=Nn.get(a))){e.next=27;break}if(!s.initialized){e.next=10;break}return e.abrupt("return",s.backend);case 10:if(!s.aborted){e.next=12;break}return e.abrupt("continue",27);case 12:return u=!!s.initPromise,e.prev=13,u||(s.initPromise=s.backend.init(a)),e.next=17,s.initPromise;case 17:return s.initialized=!0,e.abrupt("return",s.backend);case 21:e.prev=21,e.t0=e.catch(13),u||r.push({name:a,err:e.t0}),s.aborted=!0;case 24:return e.prev=24,delete s.initPromise,e.finish(24);case 27:e.next=4;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(2),i.e(e.t1);case 34:return e.prev=34,i.f(),e.finish(34);case 37:throw new Error("no available backend found. ERR: ".concat(r.map((function(e){return"[".concat(e.name,"] ").concat(e.err)})).join(", ")));case 38:case"end":return e.stop()}}),e,null,[[2,31,34,37],[13,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()})),Za=L((function(){Mn()})),Qa,es=L((function(){Qa="1.17.0"})),ts,dr,Ko=L((function(){es(),ts="warning",dr={wasm:{},webgl:{},webgpu:{},versions:{common:Qa},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error("Unsupported logging level: ".concat(e));ts=e}},get logLevel(){return ts}},Object.defineProperty(dr,"logLevel",{enumerable:!0})})),ee,rs=L((function(){Ko(),ee=dr})),ns,os,is=L((function(){ns=function(e,t){var n=("undefined"===typeof document?"undefined":_typeof(document))<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];var r=n.getContext("2d");if(null!=r){var i,o;void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);var a,s,u=void 0!==(null===t||void 0===t?void 0:t.format)?t.format:"RGB",c=null===t||void 0===t?void 0:t.norm;void 0===c||void 0===c.mean?a=[255,255,255,255]:"number"==typeof c.mean?a=[c.mean,c.mean,c.mean,c.mean]:(a=[c.mean[0],c.mean[1],c.mean[2],0],void 0!==c.mean[3]&&(a[3]=c.mean[3])),void 0===c||void 0===c.bias?s=[0,0,0,0]:"number"==typeof c.bias?s=[c.bias,c.bias,c.bias,c.bias]:(s=[c.bias[0],c.bias[1],c.bias[2],0],void 0!==c.bias[3]&&(s[3]=c.bias[3]));var l=o*i,h=0,f=l,d=2*l,p=-1;"RGBA"===u?(h=0,f=l,d=2*l,p=3*l):"RGB"===u?(h=0,f=l,d=2*l):"RBG"===u&&(h=0,d=l,f=2*l);for(var y=0;y<o;y++)for(var g=0;g<i;g++){var m=(e.data[h++]-s[0])*a[0],v=(e.data[f++]-s[1])*a[1],w=(e.data[d++]-s[2])*a[2],b=-1===p?255:(e.data[p++]-s[3])*a[3];r.fillStyle="rgba("+m+","+v+","+w+","+b+")",r.fillRect(g,y,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},os=function(e,t){var n,r,i,o,a=("undefined"===typeof document?"undefined":_typeof(document))<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==a)throw new Error("Can not access image data");void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(r=e.dims[2],i=e.dims[1],o=e.dims[3]):(r=e.dims[3],i=e.dims[2],o=e.dims[1]);var s,u,c=void 0!==t&&void 0!==t.format?t.format:"RGB",l=null===t||void 0===t?void 0:t.norm;void 0===l||void 0===l.mean?s=[255,255,255,255]:"number"==typeof l.mean?s=[l.mean,l.mean,l.mean,l.mean]:(s=[l.mean[0],l.mean[1],l.mean[2],255],void 0!==l.mean[3]&&(s[3]=l.mean[3])),void 0===l||void 0===l.bias?u=[0,0,0,0]:"number"==typeof l.bias?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(u[3]=l.bias[3]));var h=i*r;if(void 0!==t&&(void 0!==t.format&&4===o&&"RGBA"!==t.format||3===o&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");var f=0,d=1,p=2,y=3,g=0,m=h,v=2*h,w=-1;"RGBA"===c?(g=0,m=h,v=2*h,w=3*h):"RGB"===c?(g=0,m=h,v=2*h):"RBG"===c&&(g=0,v=h,m=2*h),n=a.createImageData(r,i);for(var b=0;b<i*r;f+=4,d+=4,p+=4,y+=4,b++)n.data[f]=(e.data[g++]-u[0])*s[0],n.data[d]=(e.data[m++]-u[1])*s[1],n.data[p]=(e.data[v++]-u[2])*s[2],n.data[y]=-1===w?255:(e.data[w++]-u[3])*s[3];return n}})),Jo,as,ss,us,ls,fs=L((function(){Gn(),Jo=function(e,t){var n,r,i;if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");var o,a,s=t.height,u=t.width,c=null!==(n=t.norm)&&void 0!==n?n:{mean:255,bias:0};o="number"==typeof c.mean?[c.mean,c.mean,c.mean,c.mean]:[c.mean[0],c.mean[1],c.mean[2],null!==(r=c.mean[3])&&void 0!==r?r:255],a="number"==typeof c.bias?[c.bias,c.bias,c.bias,c.bias]:[c.bias[0],c.bias[1],c.bias[2],null!==(i=c.bias[3])&&void 0!==i?i:0];var l=void 0!==t.format?t.format:"RGBA",h=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",f=s*u,d="RGBA"===h?new Float32Array(4*f):new Float32Array(3*f),p=4,y=0,g=1,m=2,v=3,w=0,b=f,x=2*f,_=-1;"RGB"===l&&(p=3,y=0,g=1,m=2,v=-1),"RGBA"===h?_=3*f:"RBG"===h?(w=0,x=f,b=2*f):"BGR"===h&&(x=0,b=f,w=2*f);for(var I=0;I<f;I++,y+=p,m+=p,g+=p,v+=p)d[w++]=(e[y]+a[0])/o[0],d[b++]=(e[g]+a[1])/o[1],d[x++]=(e[m]+a[2])/o[2],-1!==_&&-1!==v&&(d[_++]=(e[v]+a[3])/o[3]);return new Xe("float32",d,"RGBA"===h?[1,4,s,u]:[1,3,s,u])},as=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=("undefined"===typeof HTMLImageElement?"undefined":_typeof(HTMLImageElement))<"u"&&t instanceof HTMLImageElement,o=("undefined"===typeof ImageData?"undefined":_typeof(ImageData))<"u"&&t instanceof ImageData,a=("undefined"===typeof ImageBitmap?"undefined":_typeof(ImageBitmap))<"u"&&t instanceof ImageBitmap,s="string"==typeof t,u=null!==n&&void 0!==n?n:{},c=function(){if(("undefined"===typeof document?"undefined":_typeof(document))<"u")return document.createElement("canvas");if(("undefined"===typeof OffscreenCanvas?"undefined":_typeof(OffscreenCanvas))<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=function(e){return e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null},!i){e.next=18;break}if((h=c()).width=t.width,h.height=t.height,null!=(f=l(h))){e.next=7;break}throw new Error("Can not access image data");case 7:if(d=t.height,p=t.width,void 0!==n&&void 0!==n.resizedHeight&&void 0!==n.resizedWidth&&(d=n.resizedHeight,p=n.resizedWidth),void 0===n){e.next=14;break}if(u=n,void 0===n.tensorFormat){e.next=11;break}throw new Error("Image input config format must be RGBA for HTMLImageElement");case 11:u.tensorFormat="RGBA",u.height=d,u.width=p,e.next=15;break;case 14:u.tensorFormat="RGBA",u.height=d,u.width=p;case 15:f.drawImage(t,0,0),r=f.getImageData(0,0,p,d).data,e.next=42;break;case 18:if(o){e.next=32;break}if(!a){e.next=29;break}if(void 0!==n){e.next=22;break}throw new Error("Please provide image config with format for Imagebitmap");case 22:if((y=c()).width=t.width,y.height=t.height,null==(g=l(y))){e.next=28;break}return m=t.height,v=t.width,e.abrupt("return",(g.drawImage(t,0,0,v,m),r=g.getImageData(0,0,v,m).data,u.height=m,u.width=v,Jo(r,u)));case 28:throw new Error("Can not access image data");case 29:if(!s){e.next=31;break}return e.abrupt("return",new Promise((function(e,n){var r=c(),i=l(r);if(!t||!i)return n();var o=new Image;o.crossOrigin="Anonymous",o.src=t,o.onload=function(){r.width=o.width,r.height=o.height,i.drawImage(o,0,0,r.width,r.height);var t=i.getImageData(0,0,r.width,r.height);u.height=r.height,u.width=r.width,e(Jo(t.data,u))}})));case 31:throw new Error("Input data provided is not supported - aborted tensor creation");case 32:if(void 0!==n&&void 0!==n.resizedWidth&&void 0!==n.resizedHeight?(w=n.resizedHeight,b=n.resizedWidth):(w=t.height,b=t.width),void 0!==n&&(u=n),u.format="RGBA",u.height=w,u.width=b,void 0===n){e.next=41;break}if((x=c()).width=b,x.height=w,null!=(_=l(x))){e.next=38;break}throw new Error("Can not access image data");case 38:_.putImageData(t,0,0),r=_.getImageData(0,0,b,w).data,e.next=42;break;case 41:r=t.data;case 42:if(void 0===r){e.next=44;break}return e.abrupt("return",Jo(r,u));case 44:throw new Error("Input data provided is not supported - aborted tensor creation");case 45:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ss=function(e,t){var n=t.width,r=t.height,i=t.download,o=t.dispose;return new Xe({location:"texture",type:"float32",texture:e,dims:[1,r,n,4],download:i,dispose:o})},us=function(e,t){var n=t.dataType,r=t.dims,i=t.download,o=t.dispose;return new Xe({location:"gpu-buffer",type:null!==n&&void 0!==n?n:"float32",gpuBuffer:e,dims:r,download:i,dispose:o})},ls=function(e,t,n){return new Xe({location:"cpu-pinned",type:e,data:t,dims:null!==n&&void 0!==n?n:[t.length]})}})),an,Un,cs,ps,ds=L((function(){an=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Un=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),cs=!1,ps=function(){if(!cs){cs=!0;var e=("undefined"===typeof BigInt64Array?"undefined":_typeof(BigInt64Array))<"u"&&"function"==typeof BigInt64Array.from,t=("undefined"===typeof BigUint64Array?"undefined":_typeof(BigUint64Array))<"u"&&"function"==typeof BigUint64Array.from;e&&(an.set("int64",BigInt64Array),Un.set(BigInt64Array,"int64")),t&&(an.set("uint64",BigUint64Array),Un.set(BigUint64Array,"uint64"))}}})),hs,ms,bs=L((function(){Gn(),hs=function(e){for(var t=1,n=0;n<e.length;n++){var r=e[n];if("number"!=typeof r||!Number.isSafeInteger(r))throw new TypeError("dims[".concat(n,"] must be an integer, got: ").concat(r));if(r<0)throw new RangeError("dims[".concat(n,"] must be a non-negative integer, got: ").concat(r));t*=r}return t},ms=function(e,t){switch(e.location){case"cpu":return new Xe(e.type,e.data,t);case"cpu-pinned":return new Xe({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Xe({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Xe({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error("tensorReshape: tensor location ".concat(e.location," is not supported"))}}})),Xe,Gn=L((function(){is(),fs(),ds(),bs(),Xe=function(){function e(t,n,r){var i,o;if(_classCallCheck(this,e),ps(),"object"==_typeof(t)&&"location"in t)switch(this.dataLocation=t.location,i=t.type,o=t.dims,t.location){case"cpu-pinned":var a=an.get(i);if(!a)throw new TypeError('unsupported type "'.concat(i,'" to create tensor from pinned buffer'));if(!(t.data instanceof a))throw new TypeError("buffer should be of type ".concat(a.name));this.cpuData=t.data;break;case"texture":if("float32"!==i)throw new TypeError('unsupported type "'.concat(i,'" to create tensor from texture'));this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break;case"gpu-buffer":if("float32"!==i&&"float16"!==i&&"int32"!==i&&"int64"!==i&&"uint32"!==i&&"bool"!==i)throw new TypeError('unsupported type "'.concat(i,'" to create tensor from gpu buffer'));this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break;default:throw new Error("Tensor constructor: unsupported location '".concat(this.dataLocation,"'"))}else{var s,u;if("string"==typeof t)if(i=t,u=r,"string"===t){if(!Array.isArray(n))throw new TypeError("A string tensor's data must be a string array.");s=n}else{var c=an.get(t);if(void 0===c)throw new TypeError("Unsupported tensor type: ".concat(t,"."));if(Array.isArray(n)){if("float16"===t)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");s="uint64"===t||"int64"===t?c.from(n,BigInt):c.from(n)}else{if(!(n instanceof c))throw new TypeError("A ".concat(i," tensor's data must be type of ").concat(c));s=n}}else if(u=n,Array.isArray(t)){if(0===t.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");var l=_typeof(t[0]);if("string"===l)i="string",s=t;else{if("boolean"!==l)throw new TypeError("Invalid element type of data array: ".concat(l,"."));i="bool",s=Uint8Array.from(t)}}else{var h=Un.get(t.constructor);if(void 0===h)throw new TypeError("Unsupported type for tensor data: ".concat(t.constructor,"."));i=h,s=t}if(void 0===u)u=[s.length];else if(!Array.isArray(u))throw new TypeError("A tensor's dims must be a number array");o=u,this.cpuData=s,this.dataLocation="cpu"}var f=hs(o);if(this.cpuData&&f!==this.cpuData.length)throw new Error("Tensor's size(".concat(f,") does not match data length(").concat(this.cpuData.length,")."));this.type=i,this.dims=o,this.size=f}return _createClass(e,[{key:"toDataURL",value:function(e){return ns(this,e)}},{key:"toImageData",value:function(e){return os(this,e)}},{key:"data",get:function(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}},{key:"location",get:function(){return this.dataLocation}},{key:"texture",get:function(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}},{key:"gpuBuffer",get:function(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}},{key:"getData",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=(this.ensureValid(),this.dataLocation),e.next="cpu"===e.t0||"cpu-pinned"===e.t0?3:"texture"===e.t0||"gpu-buffer"===e.t0?4:17;break;case 3:return e.abrupt("return",this.data);case 4:if(this.downloader){e.next=6;break}throw new Error("The current tensor is not created with a specified data downloader.");case 6:if(!this.isDownloading){e.next=8;break}throw new Error("The current tensor is being downloaded.");case 8:return e.prev=8,this.isDownloading=!0,e.next=12,this.downloader();case 12:return n=e.sent,e.abrupt("return",(this.downloader=void 0,this.dataLocation="cpu",this.cpuData=n,t&&this.disposer&&(this.disposer(),this.disposer=void 0),n));case 14:return e.prev=14,this.isDownloading=!1,e.finish(14);case 17:throw new Error("cannot get data from location: ".concat(this.dataLocation));case 18:case"end":return e.stop()}}),e,this,[[8,,14,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}},{key:"ensureValid",value:function(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}},{key:"reshape",value:function(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return ms(this,e)}}],[{key:"fromImage",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",as(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fromTexture",value:function(e,t){return ss(e,t)}},{key:"fromGpuBuffer",value:function(e,t){return us(e,t)}},{key:"fromPinnedBuffer",value:function(e,t,n){return ls(e,t,n)}}]),e}()})),Re,zn=L((function(){Gn(),Re=Xe})),gs,ys,hr,mr,Zo=L((function(){Ko(),gs=function(e,t){dr.wasm.trace&&console.timeStamp("".concat(e,"::ORT::").concat(t))},ys=function(e,t){for(var n,r=(null===(n=(new Error).stack)||void 0===n?void 0:n.split(/\r\n|\r|\n/g))||[],i=!1,o=0;o<r.length;o++){if(i&&!r[o].includes("TRACE_FUNC")){var a="FUNC_".concat(e,"::").concat(r[o].trim().split(" ")[1]);return t&&(a+="::".concat(t)),void gs("CPU",a)}r[o].includes("TRACE_FUNC")&&(i=!0)}},hr=function(e){dr.wasm.trace&&ys("BEGIN",e)},mr=function(e){dr.wasm.trace&&ys("END",e)}})),Wn,Ts=L((function(){Mn(),zn(),Zo(),Wn=function(){function e(t){_classCallCheck(this,e),this.handler=t}return _createClass(e,[{key:"run",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_,I,A,C;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(hr(),i={},o={},!("object"!=_typeof(t)||null===t||t instanceof Re||Array.isArray(t))){e.next=4;break}throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");case 4:if(a=!0,"object"!=_typeof(n)){e.next=57;break}if(null!==n){e.next=8;break}throw new TypeError("Unexpected argument[1]: cannot be null.");case 8:if(!(n instanceof Re)){e.next=10;break}throw new TypeError("'fetches' cannot be a Tensor");case 10:if(!Array.isArray(n)){e.next=42;break}if(0!==n.length){e.next=13;break}throw new TypeError("'fetches' cannot be an empty array.");case 13:a=!1,s=_createForOfIteratorHelper(n),e.prev=15,s.s();case 17:if((u=s.n()).done){e.next=26;break}if("string"==typeof(c=u.value)){e.next=21;break}throw new TypeError("'fetches' must be a string array or an object.");case 21:if(-1!==this.outputNames.indexOf(c)){e.next=23;break}throw new RangeError("'fetches' contains invalid output name: ".concat(c,"."));case 23:i[c]=null;case 24:e.next=17;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(15),s.e(e.t0);case 31:return e.prev=31,s.f(),e.finish(31);case 34:if("object"!=_typeof(r)||null===r){e.next=38;break}o=r,e.next=40;break;case 38:if(!(_typeof(r)<"u")){e.next=40;break}throw new TypeError("'options' must be an object.");case 40:e.next=55;break;case 42:l=!1,h=Object.getOwnPropertyNames(n),f=_createForOfIteratorHelper(this.outputNames);try{for(f.s();!(d=f.n()).done;)p=d.value,-1!==h.indexOf(p)&&(null===(y=n[p])||y instanceof Re)&&(l=!0,a=!1,i[p]=y)}catch(k){f.e(k)}finally{f.f()}if(!l){e.next=54;break}if("object"!=_typeof(r)||null===r){e.next=50;break}o=r,e.next=52;break;case 50:if(!(_typeof(r)<"u")){e.next=52;break}throw new TypeError("'options' must be an object.");case 52:e.next=55;break;case 54:o=n;case 55:e.next=59;break;case 57:if(!(_typeof(n)<"u")){e.next=59;break}throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");case 59:g=_createForOfIteratorHelper(this.inputNames),e.prev=60,g.s();case 62:if((m=g.n()).done){e.next=68;break}if(v=m.value,!(_typeof(t[v])>"u")){e.next=66;break}throw new Error("input '".concat(v,"' is missing in 'feeds'."));case 66:e.next=62;break;case 68:e.next=73;break;case 70:e.prev=70,e.t1=e.catch(60),g.e(e.t1);case 73:return e.prev=73,g.f(),e.finish(73);case 76:if(a){w=_createForOfIteratorHelper(this.outputNames);try{for(w.s();!(b=w.n()).done;)x=b.value,i[x]=null}catch(k){w.e(k)}finally{w.f()}}return e.next=79,this.handler.run(t,i,o);case 79:for(A in _=e.sent,I={},_)Object.hasOwnProperty.call(_,A)&&(C=_[A],I[A]=C instanceof Re?C:new Re(C.type,C.data,C.dims));return e.abrupt("return",(mr(),I));case 83:case"end":return e.stop()}}),e,this,[[15,28,31,34],[60,70,73,76]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.handler.dispose());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.configure(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"auth",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.auth(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startProfiling",value:function(){this.handler.startProfiling()}},{key:"endProfiling",value:function(){this.handler.endProfiling()}},{key:"inputNames",get:function(){return this.handler.inputNames}},{key:"outputNames",get:function(){return this.handler.outputNames}}],[{key:"create",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,r,i,o){var a,s,u,c,l,h,f;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(hr(),s={},"string"!=typeof n){t.next=11;break}if(a=n,"object"!=_typeof(r)||null===r){t.next=7;break}s=r,t.next=9;break;case 7:if(!(_typeof(r)<"u")){t.next=9;break}throw new TypeError("'options' must be an object.");case 9:t.next=52;break;case 11:if(!(n instanceof Uint8Array)){t.next=20;break}if(a=n,"object"!=_typeof(r)||null===r){t.next=16;break}s=r,t.next=18;break;case 16:if(!(_typeof(r)<"u")){t.next=18;break}throw new TypeError("'options' must be an object.");case 18:t.next=52;break;case 20:if(n instanceof ArrayBuffer||("undefined"===typeof SharedArrayBuffer?"undefined":_typeof(SharedArrayBuffer))<"u"&&n instanceof SharedArrayBuffer){t.next=22;break}throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");case 22:if(u=n,c=0,l=n.byteLength,"object"!=_typeof(r)||null===r){t.next=27;break}s=r,t.next=51;break;case 27:if("number"!=typeof r){t.next=49;break}if(c=r,Number.isSafeInteger(c)){t.next=30;break}throw new RangeError("'byteOffset' must be an integer.");case 30:if(!(c<0||c>=u.byteLength)){t.next=32;break}throw new RangeError("'byteOffset' is out of range [0, ".concat(u.byteLength,")."));case 32:if(l=n.byteLength-c,"number"!=typeof i){t.next=45;break}if(l=i,Number.isSafeInteger(l)){t.next=35;break}throw new RangeError("'byteLength' must be an integer.");case 35:if(!(l<=0||c+l>u.byteLength)){t.next=37;break}throw new RangeError("'byteLength' is out of range (0, ".concat(u.byteLength-c,"]."));case 37:if("object"!=_typeof(o)||null===o){t.next=41;break}s=o,t.next=43;break;case 41:if(!(_typeof(o)<"u")){t.next=43;break}throw new TypeError("'options' must be an object.");case 43:t.next=47;break;case 45:if(!(_typeof(i)<"u")){t.next=47;break}throw new TypeError("'byteLength' must be a number.");case 47:t.next=51;break;case 49:if(!(_typeof(r)<"u")){t.next=51;break}throw new TypeError("'options' must be an object.");case 51:a=new Uint8Array(u,c,l);case 52:return h=(s.executionProviders||[]).map((function(e){return"string"==typeof e?e:e.name})),t.next=55,Rn(h);case 55:return t.next=57,t.sent.createInferenceSessionHandler(a,s);case 57:return f=t.sent,t.abrupt("return",(mr(),new e(f)));case 59:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()}]),e}()})),Nd,xs=L((function(){Ts(),Nd=Wn})),ws=L((function(){})),Rd,Vn,vs=L((function(){Mn(),zn(),Rd="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Vn=function(){function e(t,n,r){_classCallCheck(this,e),this.handler=t,this.hasOptimizerModel=n,this.hasEvalModel=r}return _createClass(e,[{key:"trainingInputNames",get:function(){return this.handler.inputNames}},{key:"trainingOutputNames",get:function(){return this.handler.outputNames}},{key:"evalInputNames",get:function(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}},{key:"evalOutputNames",get:function(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}},{key:"typeNarrowingForRunStep",value:function(e,t,n,r,i){var o={},a={};if("object"!=_typeof(n)||null===n||n instanceof Re||Array.isArray(n))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");var s=!0;if("object"==_typeof(r)){if(null===r)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof Re)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(0===r.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;var u,c=_createForOfIteratorHelper(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;if("string"!=typeof l)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(l))throw new RangeError("'fetches' contains invalid output name: ".concat(l,"."));o[l]=null}}catch(_){c.e(_)}finally{c.f()}if("object"==_typeof(i)&&null!==i)a=i;else if(_typeof(i)<"u")throw new TypeError("'options' must be an object.")}else{var h,f=!1,d=Object.getOwnPropertyNames(r),p=_createForOfIteratorHelper(t);try{for(p.s();!(h=p.n()).done;){var y=h.value;if(-1!==d.indexOf(y)){var g=r[y];(null===g||g instanceof Re)&&(f=!0,s=!1,o[y]=g)}}}catch(_){p.e(_)}finally{p.f()}if(f){if("object"==_typeof(i)&&null!==i)a=i;else if(_typeof(i)<"u")throw new TypeError("'options' must be an object.")}else a=r}}else if(_typeof(r)<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");var m,v=_createForOfIteratorHelper(e);try{for(v.s();!(m=v.n()).done;){var w=m.value;if(_typeof(n[w])>"u")throw new Error("input '".concat(w,"' is missing in 'feeds'."))}}catch(_){v.e(_)}finally{v.f()}if(s){var b,x=_createForOfIteratorHelper(t);try{for(x.s();!(b=x.n()).done;){o[b.value]=null}}catch(_){x.e(_)}finally{x.f()}}return[o,a]}},{key:"convertHandlerReturnTypeToMapOfTensors",value:function(e){var t={};for(var n in e)if(Object.hasOwnProperty.call(e,n)){var r=e[n];t[n]=r instanceof Re?r:new Re(r.type,r.data,r.dims)}return t}},{key:"lazyResetGrad",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.lazyResetGrad();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"runTrainStep",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,t,n,r),o=_slicedToArray(i,2),a=o[0],s=o[1],e.next=6,this.handler.runTrainStep(t,a,s);case 6:return u=e.sent,e.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(u));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"runOptimizerStep",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasOptimizerModel){e.next=2;break}throw new Error("This TrainingSession has no OptimizerModel loaded.");case 2:return e.next=4,this.handler.runOptimizerStep(t||{});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"runEvalStep",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasEvalModel){e.next=9;break}return i=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,t,n,r),o=_slicedToArray(i,2),a=o[0],s=o[1],e.next=7,this.handler.runEvalStep(t,a,s);case 7:return u=e.sent,e.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(u));case 9:throw new Error("This TrainingSession has no EvalModel loaded.");case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getParametersSize",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.abrupt("return",this.handler.getParametersSize(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadParametersBuffer",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.getParametersSize(n);case 3:if(r=e.sent,t.length===4*r){e.next=6;break}throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");case 6:return e.abrupt("return",this.handler.loadParametersBuffer(t,n));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getContiguousParameters",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.abrupt("return",this.handler.getContiguousParameters(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.handler.dispose());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"create",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,r){var i,o,a,s,u,c;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.evalModel||"",o=n.optimizerModel||"",s=((a=r||{}).executionProviders||[]).map((function(e){return"string"==typeof e?e:e.name})),t.next=6,Rn(s);case 6:if(!(u=t.sent).createTrainingSessionHandler){t.next=12;break}return t.next=10,u.createTrainingSessionHandler(n.checkpointState,n.trainModel,i,o,a);case 10:return c=t.sent,t.abrupt("return",new e(c,!!n.optimizerModel,!!n.evalModel));case 12:throw new Error(Rd);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}()})),Md,_s=L((function(){vs(),Md=Vn})),Qo={};kr(Qo,{InferenceSession:function(){return Nd},TRACE:function(){return gs},TRACE_FUNC_BEGIN:function(){return hr},TRACE_FUNC_END:function(){return mr},Tensor:function(){return Re},TrainingSession:function(){return Md},env:function(){return ee},registerBackend:function(){return pr}});var It=L((function(){Za(),rs(),xs(),zn(),Zo(),ws(),_s()}));function Zt(e,t,n,r){if(void 0===t)return Ud(e);if(void 0===n)Hn(e,t,1);else if("number"==typeof n&&void 0===r)Hn(e,t,n);else if("string"==typeof n&&void 0===r)Hn(e,n,1,t);else{if("string"!=typeof n||"number"!=typeof r)throw new TypeError("input is valid");Hn(e,n,r,t)}}function Ud(e){return{verbose:Zt.verbose.bind(null,e),info:Zt.info.bind(null,e),warning:Zt.warning.bind(null,e),error:Zt.error.bind(null,e),fatal:Zt.fatal.bind(null,e)}}function Hn(e,t,n,r){var i=sn[r||""]||sn[""];Is[e]<Is[i.minimalSeverity]||(i.logDateTime&&(t="".concat((new Date).toISOString(),"|").concat(t)),i.logSourceLocation,Gd[i.provider].log(e,t,r))}var ei,ti,Is,Gd,Ss,sn,pe,qn,Yn,Xn,jn,dt=L((function(){ei=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e,t,n){}}]),e}(),ti=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e,t,n){console.log("".concat(this.color(e)," ").concat(n?"\x1b[35m"+n+"\x1b[0m ":"").concat(t))}},{key:"color",value:function(e){switch(e){case"verbose":return"\x1b[34;40mv\x1b[0m";case"info":return"\x1b[32mi\x1b[0m";case"warning":return"\x1b[30;43mw\x1b[0m";case"error":return"\x1b[31;40me\x1b[0m";case"fatal":return"\x1b[101mf\x1b[0m";default:throw new Error("unsupported severity: ".concat(e))}}}]),e}(),Is={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},Gd={none:new ei,console:new ti},sn={"":Ss={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1}},function(e){function t(e){sn={},n("",e||{})}function n(e,n){if("*"===e)t(n);else{var r=sn[e]||Ss;sn[e]={provider:n.provider||r.provider,minimalSeverity:n.minimalSeverity||r.minimalSeverity,logDateTime:void 0===n.logDateTime?r.logDateTime:n.logDateTime,logSourceLocation:void 0===n.logSourceLocation?r.logSourceLocation:n.logSourceLocation}}}e.verbose=function(t,n){e("verbose",t,n)},e.info=function(t,n){e("info",t,n)},e.warning=function(t,n){e("warning",t,n)},e.error=function(t,n){e("error",t,n)},e.fatal=function(t,n){e("fatal",t,n)},e.reset=t,e.set=n,e.setWithEnv=function(e){var t={};e.logLevel&&(t.minimalSeverity=e.logLevel),n("",t)}}(Zt||(Zt={})),pe=Zt,qn=function(){function e(t,n,r,i,o,a){_classCallCheck(this,e),this.category=t,this.name=n,this.startTime=r,this.endCallback=i,this.timer=o,this.ctx=a}return _createClass(e,[{key:"end",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.endCallback(this));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkTimer",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.ctx&&void 0!==this.timer){e.next=2;break}throw new Error("No webgl timer found");case 2:return e.abrupt("return",(this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Yn=_createClass((function e(t,n,r,i){_classCallCheck(this,e),this.category=t,this.name=n,this.startTime=r,this.endTime=i})),Xn=function(){function e(t,n,r){_classCallCheck(this,e),this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=void 0===t?1e4:t,this._flushBatchSize=void 0===n?10:n,this._flushIntervalInMilliseconds=void 0===r?5e3:r}return _createClass(e,[{key:"start",value:function(){this._started=!0,this._timingEvents=[],this._flushTime=jn(),this._flushPointer=0}},{key:"stop",value:function(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}},{key:"event",value:function(e,t,n,r){var i=this._started?this.begin(e,t,r):void 0,o=!1,a=n();if(a&&"function"==typeof a.then)return o=!0,new Promise((function(e,t){a.then(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=i,!t.t0){t.next=4;break}return t.next=4,i.end();case 4:e(n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i,!e.t0){e.next=4;break}return e.next=4,i.end();case 4:t(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));if(!o&&i){var s=i.end();if(s&&"function"==typeof s.then)return new Promise((function(e,t){s.then((function(){e(a)}),(function(e){t(e)}))}))}return a}},{key:"begin",value:function(e,t,n){var r=this;if(!this._started)throw new Error("profiler is not started yet");if(void 0===n){var i=jn();return this.flush(i),new qn(e,t,i,(function(e){return r.endSync(e)}))}var o=n.beginTimer();return new qn(e,t,0,function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.end(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o,n)}},{key:"end",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkTimer();case 2:n=e.sent,this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(t.category,t.name,t.startTime,n)),this.flush(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"endSync",value:function(e){var t=jn();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(e.category,e.name,e.startTime,t)),this.flush(t))}},{key:"logOneEvent",value:function(e){pe.verbose("Profiler.".concat(e.category),"".concat((e.endTime-e.startTime).toFixed(2),"ms on event '").concat(e.name,"' at ").concat(e.endTime.toFixed(2)))}},{key:"flush",value:function(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(var t=this._flushPointer;this._flushPointer<t+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=jn()}}},{key:"started",get:function(){return this._started}}],[{key:"create",value:function(e){return void 0===e?new this:new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds)}}]),e}(),jn=("undefined"===typeof performance?"undefined":_typeof(performance))<"u"&&performance.now?function(){return performance.now()}:Date.now}));function As(e,t,n){var r,i=_createForOfIteratorHelper(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o[0],s=o[1],u=o[2],c=o[3],l=o[4];if(e.opType===a){var h,f=_createForOfIteratorHelper(t);try{for(f.s();!(h=f.n()).done;){var d=h.value;if((d.domain===s||"ai.onnx"===d.domain&&""===s)&&zd(d.version,u))return{opImpl:c,opInit:l}}}catch(p){f.e(p)}finally{f.f()}}}}catch(p){i.e(p)}finally{i.f()}throw new TypeError("cannot resolve operator '".concat(e.opType,"' with opsets: ").concat(t.map((function(e){return"".concat(e.domain||"ai.onnx"," v").concat(e.version)})).join(", ")))}function zd(e,t){if(t.endsWith("+")){var n=Number.parseInt(t.substring(0,t.length-1),10);return!isNaN(n)&&n<=e}if(2===t.split("-").length){var r=t.split("-"),i=Number.parseInt(r[0],10),o=Number.parseInt(r[1],10);return!isNaN(i)&&!isNaN(o)&&i<=e&&e<=o}return Number.parseInt(t,10)===e}var Es=L((function(){})),Ps=ye((function(e){e.__esModule=!0;var t=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var n=t.toString();return t&&(t instanceof e||e.validator.test(n))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",n=0;n<e;n++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();e.Guid=t}));function Te(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function He(e){return!0===(e&&e.__isLong__)}function Ds(e){var t=Math.clz32(e&-e);return e?31-t:t}function br(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=Fs[e])?r:(n=le(e,0,!0),i&&(Fs[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=Ls[e])?r:(n=le(e,e<0?-1:0,!1),i&&(Ls[e]=n),n)}function mt(e,t){if(isNaN(e))return t?Ht:St;if(t){if(e<0)return Ht;if(e>=ks)return Ms}else{if(e<=-$s)return rt;if(e+1>=$s)return Rs}return e<0?mt(-e,t).neg():le(e%Mr|0,e/Mr|0,t)}function le(e,t,n){return new Te(e,t,n)}function oi(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?Ht:St;if((n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return oi(e.substring(1),t,n).neg();for(var i=mt(Kn(n,8)),o=St,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),n);if(s<8){var c=mt(Kn(n,s));o=o.mul(c).add(mt(u))}else o=(o=o.mul(i)).add(mt(u))}return o.unsigned=t,o}function At(e,t){return"number"==typeof e?mt(e,t):"string"==typeof e?oi(e,t):le(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}var ht,Ls,Fs,Kn,Cs,Vd,Mr,ks,$s,Bs,St,Ht,Rr,Ns,ni,Rs,Ms,rt,k,jt,ii=L((function(){ht=null;try{ht=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}Te.prototype.__isLong__,Object.defineProperty(Te.prototype,"__isLong__",{value:!0}),Te.isLong=He,Ls={},Fs={},Te.fromInt=br,Te.fromNumber=mt,Te.fromBits=le,Kn=Math.pow,Te.fromString=oi,Te.fromValue=At,$s=(ks=(Mr=(Cs=65536)*Cs)*Mr)/2,Bs=br(Vd=1<<24),St=br(0),Te.ZERO=St,Ht=br(0,!0),Te.UZERO=Ht,Rr=br(1),Te.ONE=Rr,Ns=br(1,!0),Te.UONE=Ns,ni=br(-1),Te.NEG_ONE=ni,Rs=le(-1,2147483647,!1),Te.MAX_VALUE=Rs,Ms=le(-1,-1,!0),Te.MAX_UNSIGNED_VALUE=Ms,rt=le(0,-2147483648,!1),Te.MIN_VALUE=rt,(k=Te.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*Mr+(this.low>>>0):this.high*Mr+(this.low>>>0)},k.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(rt)){var t=mt(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=mt(Kn(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(rt)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},k.isZero=function(){return 0===this.high&&0===this.low},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return 1==(1&this.low)},k.isEven=function(){return 0==(1&this.low)},k.equals=function(e){return He(e)||(e=At(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},k.eq=k.equals,k.notEquals=function(e){return!this.eq(e)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(e){return this.comp(e)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(e){return this.comp(e)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(e){return this.comp(e)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(e){return this.comp(e)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(e){if(He(e)||(e=At(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(rt)?rt:this.not().add(Rr)},k.neg=k.negate,k.add=function(e){He(e)||(e=At(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,c=0,l=0,h=0;return l+=(h+=i+(65535&e.low))>>>16,c+=(l+=r+s)>>>16,u+=(c+=n+a)>>>16,u+=t+o,le((l&=65535)<<16|(h&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},k.subtract=function(e){return He(e)||(e=At(e)),this.add(e.neg())},k.sub=k.subtract,k.multiply=function(e){if(this.isZero())return this;if(He(e)||(e=At(e)),ht)return le(ht.mul(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned);if(e.isZero())return this.unsigned?Ht:St;if(this.eq(rt))return e.isOdd()?rt:St;if(e.eq(rt))return this.isOdd()?rt:St;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Bs)&&e.lt(Bs))return mt(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,c=0,l=0,h=0,f=0;return h+=(f+=i*u)>>>16,l+=(h+=r*u)>>>16,h&=65535,l+=(h+=i*s)>>>16,c+=(l+=n*u)>>>16,l&=65535,c+=(l+=r*s)>>>16,l&=65535,c+=(l+=i*a)>>>16,c+=t*u+n*s+r*a+i*o,le((h&=65535)<<16|(f&=65535),(c&=65535)<<16|(l&=65535),this.unsigned)},k.mul=k.multiply,k.divide=function(e){if(He(e)||(e=At(e)),e.isZero())throw Error("division by zero");var t,n,r;if(ht)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?le((this.unsigned?ht.div_u:ht.div_s)(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Ht:St;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ht;if(e.gt(this.shru(1)))return Ns;r=Ht}else{if(this.eq(rt))return e.eq(Rr)||e.eq(ni)?rt:e.eq(rt)?Rr:(t=this.shr(1).div(e).shl(1)).eq(St)?e.isNegative()?Rr:ni:(n=this.sub(e.mul(t)),r=t.add(n.div(e)));if(e.eq(rt))return this.unsigned?Ht:St;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=St}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:Kn(2,i-48),a=mt(t),s=a.mul(e);s.isNegative()||s.gt(n);)s=(a=mt(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=Rr),r=r.add(a),n=n.sub(s)}return r},k.div=k.divide,k.modulo=function(e){return He(e)||(e=At(e)),ht?le((this.unsigned?ht.rem_u:ht.rem_s)(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return le(~this.low,~this.high,this.unsigned)},k.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},k.clz=k.countLeadingZeros,k.countTrailingZeros=function(){return this.low?Ds(this.low):Ds(this.high)+32},k.ctz=k.countTrailingZeros,k.and=function(e){return He(e)||(e=At(e)),le(this.low&e.low,this.high&e.high,this.unsigned)},k.or=function(e){return He(e)||(e=At(e)),le(this.low|e.low,this.high|e.high,this.unsigned)},k.xor=function(e){return He(e)||(e=At(e)),le(this.low^e.low,this.high^e.high,this.unsigned)},k.shiftLeft=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):le(0,this.low<<e-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):le(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):le(32===e?this.high:this.high>>>e-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.rotateLeft=function(e){var t;return He(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),le(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},k.rotl=k.rotateLeft,k.rotateRight=function(e){var t;return He(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),le(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},k.rotr=k.rotateRight,k.toSigned=function(){return this.unsigned?le(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:le(this.low,this.high,!0)},k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Te.fromBytes=function(e,t,n){return n?Te.fromBytesLE(e,t):Te.fromBytesBE(e,t)},Te.fromBytesLE=function(e,t){return new Te(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Te.fromBytesBE=function(e,t){return new Te(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},jt=Te})),O,Jn=L((function(){(O={}).Table,O.SIZEOF_SHORT=2,O.SIZEOF_INT=4,O.FILE_IDENTIFIER_LENGTH=4,O.SIZE_PREFIX_LENGTH=4,O.Encoding={UTF8_BYTES:1,UTF16_STRING:2},O.int32=new Int32Array(2),O.float32=new Float32Array(O.int32.buffer),O.float64=new Float64Array(O.int32.buffer),O.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],O.Long=function(e,t){this.low=0|e,this.high=0|t},O.Long.create=function(e,t){return 0==e&&0==t?O.Long.ZERO:new O.Long(e,t)},O.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},O.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high},O.Long.ZERO=new O.Long(0,0),O.Builder=function(e){if(e)var t=e;else t=1024;this.bb=O.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},O.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},O.Builder.prototype.forceDefaults=function(e){this.force_defaults=e},O.Builder.prototype.dataBuffer=function(){return this.bb},O.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},O.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var n=1+~(this.bb.capacity()-this.space+t)&e-1;this.space<n+e+t;){var r=this.bb.capacity();this.bb=O.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-r}this.pad(n)},O.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0)},O.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)},O.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)},O.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)},O.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)},O.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)},O.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)},O.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)},O.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)},O.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)},O.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)},O.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)},O.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)},O.Builder.prototype.addFieldInt8=function(e,t,n){(this.force_defaults||t!=n)&&(this.addInt8(t),this.slot(e))},O.Builder.prototype.addFieldInt16=function(e,t,n){(this.force_defaults||t!=n)&&(this.addInt16(t),this.slot(e))},O.Builder.prototype.addFieldInt32=function(e,t,n){(this.force_defaults||t!=n)&&(this.addInt32(t),this.slot(e))},O.Builder.prototype.addFieldInt64=function(e,t,n){(this.force_defaults||!t.equals(n))&&(this.addInt64(t),this.slot(e))},O.Builder.prototype.addFieldFloat32=function(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat32(t),this.slot(e))},O.Builder.prototype.addFieldFloat64=function(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat64(t),this.slot(e))},O.Builder.prototype.addFieldOffset=function(e,t,n){(this.force_defaults||t!=n)&&(this.addOffset(t),this.slot(e))},O.Builder.prototype.addFieldStruct=function(e,t,n){t!=n&&(this.nested(t),this.slot(e))},O.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},O.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},O.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()},O.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},O.Builder.growByteBuffer=function(e){var t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var n=t<<1,r=O.ByteBuffer.allocate(n);return r.setPosition(n-t),r.bytes().set(e.bytes(),n-t),r},O.Builder.prototype.addOffset=function(e){this.prep(O.SIZEOF_INT,0),this.writeInt32(this.offset()-e+O.SIZEOF_INT)},O.Builder.prototype.startObject=function(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()},O.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&0==this.vtable[t];t--);for(var n=t+1;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);var r=(n+2)*O.SIZEOF_SHORT;this.addInt16(r);var i=0,o=this.space;e:for(t=0;t<this.vtables.length;t++){var a=this.bb.capacity()-this.vtables[t];if(r==this.bb.readInt16(a)){for(var s=O.SIZEOF_SHORT;s<r;s+=O.SIZEOF_SHORT)if(this.bb.readInt16(o+s)!=this.bb.readInt16(a+s))continue e;i=this.vtables[t];break}}return i?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,i-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e},O.Builder.prototype.finish=function(e,t,n){var r=n?O.SIZE_PREFIX_LENGTH:0;if(t){var i=t;if(this.prep(this.minalign,O.SIZEOF_INT+O.FILE_IDENTIFIER_LENGTH+r),i.length!=O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+O.FILE_IDENTIFIER_LENGTH);for(var o=O.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(i.charCodeAt(o))}this.prep(this.minalign,O.SIZEOF_INT+r),this.addOffset(e),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},O.Builder.prototype.finishSizePrefixed=function(e,t){this.finish(e,t,!0)},O.Builder.prototype.requiredField=function(e,t){var n=this.bb.capacity()-e,r=n-this.bb.readInt32(n);if(0==this.bb.readInt16(r+t))throw new Error("FlatBuffers: field "+t+" must be set")},O.Builder.prototype.startVector=function(e,t,n){this.notNested(),this.vector_num_elems=t,this.prep(O.SIZEOF_INT,e*t),this.prep(n,e*t)},O.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},O.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else{t=[];for(var n=0;n<e.length;){var r,i=e.charCodeAt(n++);(r=i<55296||i>=56320?i:(i<<10)+e.charCodeAt(n++)+-56613888)<128?t.push(r):(r<2048?t.push(r>>6&31|192):(r<65536?t.push(r>>12&15|224):t.push(r>>18&7|240,r>>12&63|128),t.push(r>>6&63|128)),t.push(63&r|128))}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),n=0;for(var o=this.space,a=this.bb.bytes();n<t.length;n++)a[o++]=t[n];return this.endVector()},O.Builder.prototype.createLong=function(e,t){return O.Long.create(e,t)},O.ByteBuffer=function(e){this.bytes_=e,this.position_=0},O.ByteBuffer.allocate=function(e){return new O.ByteBuffer(new Uint8Array(e))},O.ByteBuffer.prototype.clear=function(){this.position_=0},O.ByteBuffer.prototype.bytes=function(){return this.bytes_},O.ByteBuffer.prototype.position=function(){return this.position_},O.ByteBuffer.prototype.setPosition=function(e){this.position_=e},O.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},O.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24},O.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]},O.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16},O.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8},O.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24},O.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0},O.ByteBuffer.prototype.readInt64=function(e){return new O.Long(this.readInt32(e),this.readInt32(e+4))},O.ByteBuffer.prototype.readUint64=function(e){return new O.Long(this.readUint32(e),this.readUint32(e+4))},O.ByteBuffer.prototype.readFloat32=function(e){return O.int32[0]=this.readInt32(e),O.float32[0]},O.ByteBuffer.prototype.readFloat64=function(e){return O.int32[O.isLittleEndian?0:1]=this.readInt32(e),O.int32[O.isLittleEndian?1:0]=this.readInt32(e+4),O.float64[0]},O.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t},O.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t},O.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},O.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},O.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},O.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},O.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)},O.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)},O.ByteBuffer.prototype.writeFloat32=function(e,t){O.float32[0]=t,this.writeInt32(e,O.int32[0])},O.ByteBuffer.prototype.writeFloat64=function(e,t){O.float64[0]=t,this.writeInt32(e,O.int32[O.isLittleEndian?0:1]),this.writeInt32(e+4,O.int32[O.isLittleEndian?1:0])},O.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+O.SIZEOF_INT+O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<O.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+O.SIZEOF_INT+t));return e},O.ByteBuffer.prototype.__offset=function(e,t){var n=e-this.readInt32(e);return t<this.readInt16(n)?this.readInt16(n+t):0},O.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e},O.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var n=this.readInt32(e),r="",i=0;if(e+=O.SIZEOF_INT,t===O.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+n);for(;i<n;){var o,a=this.readUint8(e+i++);if(a<192)o=a;else{var s=this.readUint8(e+i++);if(a<224)o=(31&a)<<6|63&s;else{var u=this.readUint8(e+i++);o=a<240?(15&a)<<12|(63&s)<<6|63&u:(7&a)<<18|(63&s)<<12|(63&u)<<6|63&this.readUint8(e+i++)}}o<65536?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode(55296+(o>>10),56320+(1023&o)))}return r},O.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)},O.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+O.SIZEOF_INT},O.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))},O.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+O.FILE_IDENTIFIER_LENGTH);for(var t=0;t<O.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+O.SIZEOF_INT+t))return!1;return!0},O.ByteBuffer.prototype.createLong=function(e,t){return O.Long.create(e,t)}})),H,un=L((function(){Jn(),function(e){!function(e){!function(e){var t;(t=e.AttributeType||(e.AttributeType={}))[t.UNDEFINED=0]="UNDEFINED",t[t.FLOAT=1]="FLOAT",t[t.INT=2]="INT",t[t.STRING=3]="STRING",t[t.TENSOR=4]="TENSOR",t[t.GRAPH=5]="GRAPH",t[t.FLOATS=6]="FLOATS",t[t.INTS=7]="INTS",t[t.STRINGS=8]="STRINGS",t[t.TENSORS=9]="TENSORS",t[t.GRAPHS=10]="GRAPHS",t[t.SPARSE_TENSOR=11]="SPARSE_TENSOR",t[t.SPARSE_TENSORS=12]="SPARSE_TENSORS"}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t;(t=e.DimensionValueType||(e.DimensionValueType={}))[t.UNKNOWN=0]="UNKNOWN",t[t.VALUE=1]="VALUE",t[t.PARAM=2]="PARAM"}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t;(t=e.TensorDataType||(e.TensorDataType={}))[t.UNDEFINED=0]="UNDEFINED",t[t.FLOAT=1]="FLOAT",t[t.UINT8=2]="UINT8",t[t.INT8=3]="INT8",t[t.UINT16=4]="UINT16",t[t.INT16=5]="INT16",t[t.INT32=6]="INT32",t[t.INT64=7]="INT64",t[t.STRING=8]="STRING",t[t.BOOL=9]="BOOL",t[t.FLOAT16=10]="FLOAT16",t[t.DOUBLE=11]="DOUBLE",t[t.UINT32=12]="UINT32",t[t.UINT64=13]="UINT64",t[t.COMPLEX64=14]="COMPLEX64",t[t.COMPLEX128=15]="COMPLEX128",t[t.BFLOAT16=16]="BFLOAT16",t[t.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",t[t.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",t[t.FLOAT8E5M2=19]="FLOAT8E5M2",t[t.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t;(t=e.NodeType||(e.NodeType={}))[t.Primitive=0]="Primitive",t[t.Fused=1]="Fused"}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t;(t=e.TypeInfoValue||(e.TypeInfoValue={}))[t.NONE=0]="NONE",t[t.tensor_type=1]="tensor_type",t[t.sequence_type=2]="sequence_type",t[t.map_type=3]="map_type"}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"dim",value:function(t,n){var r=this.bb.__offset(this.bb_pos,4);return r?(n||new e.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"dimLength",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsShape",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsShape",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startShape",value:function(e){e.startObject(1)}},{key:"addDim",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"createDimVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startDimVector",value:function(e,t){e.startVector(4,t,4)}},{key:"endShape",value:function(e){return e.endObject()}},{key:"createShape",value:function(e,n){return t.startShape(e),t.addDim(e,n),t.endShape(e)}}]),t}();t.Shape=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"value",value:function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"denotation",value:function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}}],[{key:"getRootAsDimension",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsDimension",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startDimension",value:function(e){e.startObject(2)}},{key:"addValue",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addDenotation",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"endDimension",value:function(e){return e.endObject()}},{key:"createDimension",value:function(e,n,r){return t.startDimension(e),t.addValue(e,n),t.addDenotation(e,r),t.endDimension(e)}}]),t}();t.Dimension=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t=function(){function e(){_classCallCheck(this,e),this.bb=null,this.bb_pos=0}return _createClass(e,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"dimType",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):0}},{key:"dimValue",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}},{key:"dimParam",value:function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}}],[{key:"getRootAsDimensionValue",value:function(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"getSizePrefixedRootAsDimensionValue",value:function(t,n){return t.setPosition(t.position()+O.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"startDimensionValue",value:function(e){e.startObject(3)}},{key:"addDimType",value:function(e,t){e.addFieldInt8(0,t,0)}},{key:"addDimValue",value:function(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}},{key:"addDimParam",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"endDimensionValue",value:function(e){return e.endObject()}},{key:"createDimensionValue",value:function(t,n,r,i){return e.startDimensionValue(t),e.addDimType(t,n),e.addDimValue(t,r),e.addDimParam(t,i),e.endDimensionValue(t)}}]),e}();e.DimensionValue=t}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"elemType",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}},{key:"shape",value:function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}}],[{key:"getRootAsTensorTypeAndShape",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsTensorTypeAndShape",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startTensorTypeAndShape",value:function(e){e.startObject(2)}},{key:"addElemType",value:function(e,t){e.addFieldInt32(0,t,0)}},{key:"addShape",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"endTensorTypeAndShape",value:function(e){return e.endObject()}},{key:"createTensorTypeAndShape",value:function(e,n,r){return t.startTensorTypeAndShape(e),t.addElemType(e,n),t.addShape(e,r),t.endTensorTypeAndShape(e)}}]),t}();t.TensorTypeAndShape=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"keyType",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}},{key:"valueType",value:function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}}],[{key:"getRootAsMapType",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsMapType",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startMapType",value:function(e){e.startObject(2)}},{key:"addKeyType",value:function(e,t){e.addFieldInt32(0,t,0)}},{key:"addValueType",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"endMapType",value:function(e){return e.endObject()}},{key:"createMapType",value:function(e,n,r){return t.startMapType(e),t.addKeyType(e,n),t.addValueType(e,r),t.endMapType(e)}}]),t}();t.MapType=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"elemType",value:function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}}],[{key:"getRootAsSequenceType",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsSequenceType",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startSequenceType",value:function(e){e.startObject(1)}},{key:"addElemType",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"endSequenceType",value:function(e){return e.endObject()}},{key:"createSequenceType",value:function(e,n){return t.startSequenceType(e),t.addElemType(e,n),t.endSequenceType(e)}}]),t}();t.SequenceType=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){(e.fbs||(e.fbs={})).EdgeEnd=function(){function e(){_classCallCheck(this,e),this.bb=null,this.bb_pos=0}return _createClass(e,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"nodeIndex",value:function(){return this.bb.readUint32(this.bb_pos)}},{key:"srcArgIndex",value:function(){return this.bb.readInt32(this.bb_pos+4)}},{key:"dstArgIndex",value:function(){return this.bb.readInt32(this.bb_pos+8)}}],[{key:"createEdgeEnd",value:function(e,t,n,r){return e.prep(4,12),e.writeInt32(r),e.writeInt32(n),e.writeInt32(t),e.offset()}}]),e}()}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"nodeIndex",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb_pos+e):0}},{key:"inputEdges",value:function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+r)+12*t,this.bb):null}},{key:"inputEdgesLength",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"outputEdges",value:function(t,n){var r=this.bb.__offset(this.bb_pos,8);return r?(n||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+r)+12*t,this.bb):null}},{key:"outputEdgesLength",value:function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsNodeEdge",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsNodeEdge",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startNodeEdge",value:function(e){e.startObject(3)}},{key:"addNodeIndex",value:function(e,t){e.addFieldInt32(0,t,0)}},{key:"addInputEdges",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"startInputEdgesVector",value:function(e,t){e.startVector(12,t,4)}},{key:"addOutputEdges",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"startOutputEdgesVector",value:function(e,t){e.startVector(12,t,4)}},{key:"endNodeEdge",value:function(e){return e.endObject()}},{key:"createNodeEdge",value:function(e,n,r,i){return t.startNodeEdge(e),t.addNodeIndex(e,n),t.addInputEdges(e,r),t.addOutputEdges(e,i),t.endNodeEdge(e)}}]),t}();t.NodeEdge=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"name",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"docString",value:function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"domain",value:function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"sinceVersion",value:function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}},{key:"index",value:function(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb_pos+e):0}},{key:"opType",value:function(e){var t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"type",value:function(){var e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readInt32(this.bb_pos+e):0}},{key:"executionProviderType",value:function(e){var t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"inputs",value:function(e,t){var n=this.bb.__offset(this.bb_pos,20);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}},{key:"inputsLength",value:function(){var e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"outputs",value:function(e,t){var n=this.bb.__offset(this.bb_pos,22);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}},{key:"outputsLength",value:function(){var e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"attributes",value:function(t,n){var r=this.bb.__offset(this.bb_pos,24);return r?(n||new e.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"attributesLength",value:function(){var e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"inputArgCounts",value:function(e){var t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}},{key:"inputArgCountsLength",value:function(){var e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"inputArgCountsArray",value:function(){var e=this.bb.__offset(this.bb_pos,26);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}},{key:"implicitInputs",value:function(e,t){var n=this.bb.__offset(this.bb_pos,28);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}},{key:"implicitInputsLength",value:function(){var e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsNode",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsNode",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startNode",value:function(e){e.startObject(13)}},{key:"addName",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addDocString",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"addDomain",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"addSinceVersion",value:function(e,t){e.addFieldInt32(3,t,0)}},{key:"addIndex",value:function(e,t){e.addFieldInt32(4,t,0)}},{key:"addOpType",value:function(e,t){e.addFieldOffset(5,t,0)}},{key:"addType",value:function(e,t){e.addFieldInt32(6,t,0)}},{key:"addExecutionProviderType",value:function(e,t){e.addFieldOffset(7,t,0)}},{key:"addInputs",value:function(e,t){e.addFieldOffset(8,t,0)}},{key:"createInputsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startInputsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addOutputs",value:function(e,t){e.addFieldOffset(9,t,0)}},{key:"createOutputsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startOutputsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addAttributes",value:function(e,t){e.addFieldOffset(10,t,0)}},{key:"createAttributesVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startAttributesVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addInputArgCounts",value:function(e,t){e.addFieldOffset(11,t,0)}},{key:"createInputArgCountsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}},{key:"startInputArgCountsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addImplicitInputs",value:function(e,t){e.addFieldOffset(12,t,0)}},{key:"createImplicitInputsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startImplicitInputsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"endNode",value:function(e){return e.endObject()}},{key:"createNode",value:function(e,n,r,i,o,a,s,u,c,l,h,f,d,p){return t.startNode(e),t.addName(e,n),t.addDocString(e,r),t.addDomain(e,i),t.addSinceVersion(e,o),t.addIndex(e,a),t.addOpType(e,s),t.addType(e,u),t.addExecutionProviderType(e,c),t.addInputs(e,l),t.addOutputs(e,h),t.addAttributes(e,f),t.addInputArgCounts(e,d),t.addImplicitInputs(e,p),t.endNode(e)}}]),t}();t.Node=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"name",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"docString",value:function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"type",value:function(t){var n=this.bb.__offset(this.bb_pos,8);return n?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}}],[{key:"getRootAsValueInfo",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsValueInfo",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startValueInfo",value:function(e){e.startObject(3)}},{key:"addName",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addDocString",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"addType",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"endValueInfo",value:function(e){return e.endObject()}},{key:"createValueInfo",value:function(e,n,r,i){return t.startValueInfo(e),t.addName(e,n),t.addDocString(e,r),t.addType(e,i),t.endValueInfo(e)}}]),t}();t.ValueInfo=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t=function(){function e(){_classCallCheck(this,e),this.bb=null,this.bb_pos=0}return _createClass(e,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"denotation",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"valueType",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):0}},{key:"value",value:function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}}],[{key:"getRootAsTypeInfo",value:function(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"getSizePrefixedRootAsTypeInfo",value:function(t,n){return t.setPosition(t.position()+O.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"startTypeInfo",value:function(e){e.startObject(3)}},{key:"addDenotation",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addValueType",value:function(e,t){e.addFieldInt8(1,t,0)}},{key:"addValue",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"endTypeInfo",value:function(e){return e.endObject()}},{key:"createTypeInfo",value:function(t,n,r,i){return e.startTypeInfo(t),e.addDenotation(t,n),e.addValueType(t,r),e.addValue(t,i),e.endTypeInfo(t)}}]),e}();e.TypeInfo=t}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t=function(){function e(){_classCallCheck(this,e),this.bb=null,this.bb_pos=0}return _createClass(e,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"domain",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"version",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}}],[{key:"getRootAsOperatorSetId",value:function(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"getSizePrefixedRootAsOperatorSetId",value:function(t,n){return t.setPosition(t.position()+O.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"startOperatorSetId",value:function(e){e.startObject(2)}},{key:"addDomain",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addVersion",value:function(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}},{key:"endOperatorSetId",value:function(e){return e.endObject()}},{key:"createOperatorSetId",value:function(t,n,r){return e.startOperatorSetId(t),e.addDomain(t,n),e.addVersion(t,r),e.endOperatorSetId(t)}}]),e}();e.OperatorSetId=t}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t=function(){function e(){_classCallCheck(this,e),this.bb=null,this.bb_pos=0}return _createClass(e,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"name",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"docString",value:function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"dims",value:function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}},{key:"dimsLength",value:function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"dataType",value:function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}},{key:"rawData",value:function(e){var t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0}},{key:"rawDataLength",value:function(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"rawDataArray",value:function(){var e=this.bb.__offset(this.bb_pos,12);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}},{key:"stringData",value:function(e,t){var n=this.bb.__offset(this.bb_pos,14);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}},{key:"stringDataLength",value:function(){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsTensor",value:function(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"getSizePrefixedRootAsTensor",value:function(t,n){return t.setPosition(t.position()+O.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"startTensor",value:function(e){e.startObject(6)}},{key:"addName",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addDocString",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"addDims",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"createDimsVector",value:function(e,t){e.startVector(8,t.length,8);for(var n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}},{key:"startDimsVector",value:function(e,t){e.startVector(8,t,8)}},{key:"addDataType",value:function(e,t){e.addFieldInt32(3,t,0)}},{key:"addRawData",value:function(e,t){e.addFieldOffset(4,t,0)}},{key:"createRawDataVector",value:function(e,t){e.startVector(1,t.length,1);for(var n=t.length-1;n>=0;n--)e.addInt8(t[n]);return e.endVector()}},{key:"startRawDataVector",value:function(e,t){e.startVector(1,t,1)}},{key:"addStringData",value:function(e,t){e.addFieldOffset(5,t,0)}},{key:"createStringDataVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startStringDataVector",value:function(e,t){e.startVector(4,t,4)}},{key:"endTensor",value:function(e){return e.endObject()}},{key:"createTensor",value:function(t,n,r,i,o,a,s){return e.startTensor(t),e.addName(t,n),e.addDocString(t,r),e.addDims(t,i),e.addDataType(t,o),e.addRawData(t,a),e.addStringData(t,s),e.endTensor(t)}}]),e}();e.Tensor=t}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"values",value:function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"indices",value:function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"dims",value:function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}},{key:"dimsLength",value:function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsSparseTensor",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsSparseTensor",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startSparseTensor",value:function(e){e.startObject(3)}},{key:"addValues",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addIndices",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"addDims",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"createDimsVector",value:function(e,t){e.startVector(8,t.length,8);for(var n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}},{key:"startDimsVector",value:function(e,t){e.startVector(8,t,8)}},{key:"endSparseTensor",value:function(e){return e.endObject()}},{key:"createSparseTensor",value:function(e,n,r,i){return t.startSparseTensor(e),t.addValues(e,n),t.addIndices(e,r),t.addDims(e,i),t.endSparseTensor(e)}}]),t}();t.SparseTensor=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"name",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"docString",value:function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"type",value:function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):0}},{key:"f",value:function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb_pos+e):0}},{key:"i",value:function(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}},{key:"s",value:function(e){var t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"t",value:function(t){var n=this.bb.__offset(this.bb_pos,16);return n?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"g",value:function(t){var n=this.bb.__offset(this.bb_pos,18);return n?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"floats",value:function(e){var t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+4*e):0}},{key:"floatsLength",value:function(){var e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"floatsArray",value:function(){var e=this.bb.__offset(this.bb_pos,20);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}},{key:"ints",value:function(e){var t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}},{key:"intsLength",value:function(){var e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"strings",value:function(e,t){var n=this.bb.__offset(this.bb_pos,24);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}},{key:"stringsLength",value:function(){var e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"tensors",value:function(t,n){var r=this.bb.__offset(this.bb_pos,26);return r?(n||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"tensorsLength",value:function(){var e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"graphs",value:function(t,n){var r=this.bb.__offset(this.bb_pos,28);return r?(n||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"graphsLength",value:function(){var e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsAttribute",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsAttribute",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startAttribute",value:function(e){e.startObject(13)}},{key:"addName",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addDocString",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"addType",value:function(e,t){e.addFieldInt32(2,t,0)}},{key:"addF",value:function(e,t){e.addFieldFloat32(3,t,0)}},{key:"addI",value:function(e,t){e.addFieldInt64(4,t,e.createLong(0,0))}},{key:"addS",value:function(e,t){e.addFieldOffset(5,t,0)}},{key:"addT",value:function(e,t){e.addFieldOffset(6,t,0)}},{key:"addG",value:function(e,t){e.addFieldOffset(7,t,0)}},{key:"addFloats",value:function(e,t){e.addFieldOffset(8,t,0)}},{key:"createFloatsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()}},{key:"startFloatsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addInts",value:function(e,t){e.addFieldOffset(9,t,0)}},{key:"createIntsVector",value:function(e,t){e.startVector(8,t.length,8);for(var n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}},{key:"startIntsVector",value:function(e,t){e.startVector(8,t,8)}},{key:"addStrings",value:function(e,t){e.addFieldOffset(10,t,0)}},{key:"createStringsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startStringsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addTensors",value:function(e,t){e.addFieldOffset(11,t,0)}},{key:"createTensorsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startTensorsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addGraphs",value:function(e,t){e.addFieldOffset(12,t,0)}},{key:"createGraphsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startGraphsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"endAttribute",value:function(e){return e.endObject()}},{key:"createAttribute",value:function(e,n,r,i,o,a,s,u,c,l,h,f,d,p){return t.startAttribute(e),t.addName(e,n),t.addDocString(e,r),t.addType(e,i),t.addF(e,o),t.addI(e,a),t.addS(e,s),t.addT(e,u),t.addG(e,c),t.addFloats(e,l),t.addInts(e,h),t.addStrings(e,f),t.addTensors(e,d),t.addGraphs(e,p),t.endAttribute(e)}}]),t}();t.Attribute=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"initializers",value:function(t,n){var r=this.bb.__offset(this.bb_pos,4);return r?(n||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"initializersLength",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"nodeArgs",value:function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"nodeArgsLength",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"nodes",value:function(t,n){var r=this.bb.__offset(this.bb_pos,8);return r?(n||new e.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"nodesLength",value:function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"maxNodeIndex",value:function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb_pos+e):0}},{key:"nodeEdges",value:function(t,n){var r=this.bb.__offset(this.bb_pos,12);return r?(n||new e.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"nodeEdgesLength",value:function(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"inputs",value:function(e,t){var n=this.bb.__offset(this.bb_pos,14);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}},{key:"inputsLength",value:function(){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"outputs",value:function(e,t){var n=this.bb.__offset(this.bb_pos,16);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+4*e,t):null}},{key:"outputsLength",value:function(){var e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"sparseInitializers",value:function(t,n){var r=this.bb.__offset(this.bb_pos,18);return r?(n||new e.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"sparseInitializersLength",value:function(){var e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsGraph",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsGraph",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startGraph",value:function(e){e.startObject(8)}},{key:"addInitializers",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"createInitializersVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startInitializersVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addNodeArgs",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"createNodeArgsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startNodeArgsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addNodes",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"createNodesVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startNodesVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addMaxNodeIndex",value:function(e,t){e.addFieldInt32(3,t,0)}},{key:"addNodeEdges",value:function(e,t){e.addFieldOffset(4,t,0)}},{key:"createNodeEdgesVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startNodeEdgesVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addInputs",value:function(e,t){e.addFieldOffset(5,t,0)}},{key:"createInputsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startInputsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addOutputs",value:function(e,t){e.addFieldOffset(6,t,0)}},{key:"createOutputsVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startOutputsVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addSparseInitializers",value:function(e,t){e.addFieldOffset(7,t,0)}},{key:"createSparseInitializersVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startSparseInitializersVector",value:function(e,t){e.startVector(4,t,4)}},{key:"endGraph",value:function(e){return e.endObject()}},{key:"createGraph",value:function(e,n,r,i,o,a,s,u,c){return t.startGraph(e),t.addInitializers(e,n),t.addNodeArgs(e,r),t.addNodes(e,i),t.addMaxNodeIndex(e,o),t.addNodeEdges(e,a),t.addInputs(e,s),t.addOutputs(e,u),t.addSparseInitializers(e,c),t.endGraph(e)}}]),t}();t.Graph=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"irVersion",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}},{key:"opsetImport",value:function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"opsetImportLength",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"producerName",value:function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"producerVersion",value:function(e){var t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"domain",value:function(e){var t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"modelVersion",value:function(){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}},{key:"docString",value:function(e){var t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"graph",value:function(t){var n=this.bb.__offset(this.bb_pos,18);return n?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"graphDocString",value:function(e){var t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__string(this.bb_pos+t,e):null}}],[{key:"getRootAsModel",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsModel",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startModel",value:function(e){e.startObject(9)}},{key:"addIrVersion",value:function(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}},{key:"addOpsetImport",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"createOpsetImportVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startOpsetImportVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addProducerName",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"addProducerVersion",value:function(e,t){e.addFieldOffset(3,t,0)}},{key:"addDomain",value:function(e,t){e.addFieldOffset(4,t,0)}},{key:"addModelVersion",value:function(e,t){e.addFieldInt64(5,t,e.createLong(0,0))}},{key:"addDocString",value:function(e,t){e.addFieldOffset(6,t,0)}},{key:"addGraph",value:function(e,t){e.addFieldOffset(7,t,0)}},{key:"addGraphDocString",value:function(e,t){e.addFieldOffset(8,t,0)}},{key:"endModel",value:function(e){return e.endObject()}},{key:"createModel",value:function(e,n,r,i,o,a,s,u,c,l){return t.startModel(e),t.addIrVersion(e,n),t.addOpsetImport(e,r),t.addProducerName(e,i),t.addProducerVersion(e,o),t.addDomain(e,a),t.addModelVersion(e,s),t.addDocString(e,u),t.addGraph(e,c),t.addGraphDocString(e,l),t.endModel(e)}}]),t}();t.Model=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(e){!function(e){var t=function(){function e(){_classCallCheck(this,e),this.bb=null,this.bb_pos=0}return _createClass(e,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"nodeIndices",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb.__vector(this.bb_pos+t)+4*e):0}},{key:"nodeIndicesLength",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}},{key:"nodeIndicesArray",value:function(){var e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}},{key:"kernelDefHashes",value:function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}},{key:"kernelDefHashesLength",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsKernelCreateInfos",value:function(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"getSizePrefixedRootAsKernelCreateInfos",value:function(t,n){return t.setPosition(t.position()+O.SIZE_PREFIX_LENGTH),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}},{key:"startKernelCreateInfos",value:function(e){e.startObject(2)}},{key:"addNodeIndices",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"createNodeIndicesVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}},{key:"startNodeIndicesVector",value:function(e,t){e.startVector(4,t,4)}},{key:"addKernelDefHashes",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"createKernelDefHashesVector",value:function(e,t){e.startVector(8,t.length,8);for(var n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}},{key:"startKernelDefHashesVector",value:function(e,t){e.startVector(8,t,8)}},{key:"endKernelCreateInfos",value:function(e){return e.endObject()}},{key:"createKernelCreateInfos",value:function(t,n,r){return e.startKernelCreateInfos(t),e.addNodeIndices(t,n),e.addKernelDefHashes(t,r),e.endKernelCreateInfos(t)}}]),e}();e.KernelCreateInfos=t}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"graphId",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"sessionState",value:function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}}],[{key:"getRootAsSubGraphSessionState",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsSubGraphSessionState",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startSubGraphSessionState",value:function(e){e.startObject(2)}},{key:"addGraphId",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addSessionState",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"endSubGraphSessionState",value:function(e){var t=e.endObject();return e.requiredField(t,4),t}},{key:"createSubGraphSessionState",value:function(e,n,r){return t.startSubGraphSessionState(e),t.addGraphId(e,n),t.addSessionState(e,r),t.endSubGraphSessionState(e)}}]),t}();t.SubGraphSessionState=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"kernels",value:function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"subGraphSessionStates",value:function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}},{key:"subGraphSessionStatesLength",value:function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}}],[{key:"getRootAsSessionState",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsSessionState",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"startSessionState",value:function(e){e.startObject(2)}},{key:"addKernels",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addSubGraphSessionStates",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"createSubGraphSessionStatesVector",value:function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}},{key:"startSubGraphSessionStatesVector",value:function(e,t){e.startVector(4,t,4)}},{key:"endSessionState",value:function(e){return e.endObject()}},{key:"createSessionState",value:function(e,n,r){return t.startSessionState(e),t.addKernels(e,n),t.addSubGraphSessionStates(e,r),t.endSessionState(e)}}]),t}();t.SessionState=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={})),function(e){!function(t){!function(t){var n=function(){function t(){_classCallCheck(this,t),this.bb=null,this.bb_pos=0}return _createClass(t,[{key:"__init",value:function(e,t){return this.bb_pos=e,this.bb=t,this}},{key:"ortVersion",value:function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}},{key:"model",value:function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}},{key:"sessionState",value:function(t){var n=this.bb.__offset(this.bb_pos,8);return n?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}}],[{key:"getRootAsInferenceSession",value:function(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"getSizePrefixedRootAsInferenceSession",value:function(e,n){return e.setPosition(e.position()+O.SIZE_PREFIX_LENGTH),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}},{key:"bufferHasIdentifier",value:function(e){return e.__has_identifier("ORTM")}},{key:"startInferenceSession",value:function(e){e.startObject(3)}},{key:"addOrtVersion",value:function(e,t){e.addFieldOffset(0,t,0)}},{key:"addModel",value:function(e,t){e.addFieldOffset(1,t,0)}},{key:"addSessionState",value:function(e,t){e.addFieldOffset(2,t,0)}},{key:"endInferenceSession",value:function(e){return e.endObject()}},{key:"finishInferenceSessionBuffer",value:function(e,t){e.finish(t,"ORTM")}},{key:"finishSizePrefixedInferenceSessionBuffer",value:function(e,t){e.finish(t,"ORTM",!0)}},{key:"createInferenceSession",value:function(e,n,r,i){return t.startInferenceSession(e),t.addOrtVersion(e,n),t.addModel(e,r),t.addSessionState(e,i),t.endInferenceSession(e)}}]),t}();t.InferenceSession=n}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(H||(H={}))})),Us=ye((function(e,t){t.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}})),Hs=ye((function(e){var t=e;t.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};var n,r=new Array(64),i=new Array(123);for(n=0;n<64;)i[r[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;t.encode=function(e,t,n){for(var i,o=null,a=[],s=0,u=0;t<n;){var c=e[t++];switch(u){case 0:a[s++]=r[c>>2],i=(3&c)<<4,u=1;break;case 1:a[s++]=r[i|c>>4],i=(15&c)<<2,u=2;break;case 2:a[s++]=r[i|c>>6],a[s++]=r[63&c],u=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return u&&(a[s++]=r[i],a[s++]=61,1===u&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var o="invalid encoding";t.decode=function(e,t,n){for(var r,a=n,s=0,u=0;u<e.length;){var c=e.charCodeAt(u++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error(o);switch(s){case 0:r=c,s=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:t[n++]=(3&r)<<6|c,s=0}}if(1===s)throw Error(o);return n-a},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}})),qs=ye((function(e,t){function n(){this._listeners={}}t.exports=n,n.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},n.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},n.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}})),eu=ye((function(e,t){function n(e){return("undefined"===typeof Float32Array?"undefined":_typeof(Float32Array))<"u"?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,i),e.readFloatLE=n.bind(null,o),e.readFloatBE=n.bind(null,a)}(),("undefined"===typeof Float64Array?"undefined":_typeof(Float64Array))<"u"?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=r*Math.pow(2,-u))>>>0,i,o+t),e((a<<31|u+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,u=a>>>20&2047,c=4294967296*(1048575&a)+o;return 2047===u?c?NaN:s*(1/0):0===u?5e-324*s*c:s*Math.pow(2,u-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=n.bind(null,o,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function r(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function i(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=n(n)})),tu=ye((function(exports,module){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire})),nu=ye((function(e){var t=e;t.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},t.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},t.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}})),iu=ye((function(e,t){t.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}})),su=ye((function(e,t){t.exports=r;var n=er();function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=r.zero=new r(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,o=(e-n)/4294967296>>>0;return t&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new r(n,o)},r.from=function(e){if("number"==typeof e)return r.fromNumber(e);if(n.isString(e)){if(!n.Long)return r.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):i},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var a=String.prototype.charCodeAt;r.fromHash=function(e){return e===o?i:new r((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}})),er=ye((function(e){var t=e;function n(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)(void 0===e[r[i]]||!n)&&(e[r[i]]=t[r[i]]);return e}function r(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=Us(),t.base64=Hs(),t.EventEmitter=qs(),t.float=eu(),t.inquire=tu(),t.utf8=nu(),t.pool=iu(),t.LongBits=su(),t.isNode=!!(("undefined"===typeof __webpack_require__.g?"undefined":_typeof(__webpack_require__.g))<"u"&&__webpack_require__.g&&__webpack_require__.g.process&&__webpack_require__.g.process.versions&&__webpack_require__.g.process.versions.node),t.global=t.isNode&&__webpack_require__.g||("undefined"===typeof window?"undefined":_typeof(window))<"u"&&window||("undefined"===typeof self?"undefined":_typeof(self))<"u"&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==_typeof(e)},t.isset=t.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=_typeof(n)||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(n){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):("undefined"===typeof Uint8Array?"undefined":_typeof(Uint8Array))>"u"?e:new Uint8Array(e)},t.Array=("undefined"===typeof Uint8Array?"undefined":_typeof(Uint8Array))<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,n){var r=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(r.lo,r.hi,n):r.toNumber(!!n)},t.merge=n,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=r,t.ProtocolError=r("ProtocolError"),t.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},t.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}})),hi=ye((function(e,t){t.exports=l;var n,r=er(),i=r.LongBits,o=r.base64,a=r.utf8;function s(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function l(){this.len=0,this.head=new s(u,0,0),this.tail=this.head,this.states=null}var h=function(){return r.Buffer?function(){return(l.create=function(){return new n})()}:function(){return new l}};function f(e,t,n){t[n]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}l.create=h(),l.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(l.alloc=r.pool(l.alloc,r.Array.prototype.subarray)),l.prototype._push=function(e,t,n){return this.tail=this.tail.next=new s(e,t,n),this.len+=t,this},d.prototype=Object.create(s.prototype),d.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},l.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},l.prototype.int32=function(e){return e<0?this._push(p,10,i.fromNumber(e)):this.uint32(e)},l.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},l.prototype.uint64=function(e){var t=i.from(e);return this._push(p,t.length(),t)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(p,t.length(),t)},l.prototype.bool=function(e){return this._push(f,1,e?1:0)},l.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(e){var t=i.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},l.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var g=r.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};l.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(r.isString(e)){var n=l.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},l.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},l.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new s(u,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(u,0,0),this.len=0),this},l.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},l.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},l._configure=function(e){n=e,l.create=h(),n._configure()}})),bu=ye((function(e,t){t.exports=i;var n=hi();(i.prototype=Object.create(n.prototype)).constructor=i;var r=er();function i(){n.call(this)}function o(e,t,n){e.length<40?r.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=r._Buffer_allocUnsafe,i.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=r.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()})),gi=ye((function(e,t){t.exports=s;var n,r=er(),i=r.LongBits,o=r.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function s(e){this.buf=e,this.pos=0,this.len=e.length}var u,c=("undefined"===typeof Uint8Array?"undefined":_typeof(Uint8Array))<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new s(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new s(e);throw Error("illegal buffer")},l=function(){return r.Buffer?function(e){return(s.create=function(e){return r.Buffer.isBuffer(e)?new n(e):c(e)})(e)}:c};function h(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw a(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}s.create=l(),s.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,s.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),s.prototype.int32=function(){return 0|this.uint32()},s.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},s.prototype.bool=function(){return 0!==this.uint32()},s.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},s.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},s.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},s.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},s.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},s.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},s.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},s._configure=function(e){n=e,s.create=l(),n._configure();var t=r.Long?"toLong":"toNumber";r.merge(s.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}})),Iu=ye((function(e,t){t.exports=i;var n=gi();(i.prototype=Object.create(n.prototype)).constructor=i;var r=er();function i(e){n.call(this,e)}i._configure=function(){r.Buffer&&(i.prototype._slice=r.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()})),Au=ye((function(e,t){t.exports=r;var n=er();function r(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!r}(r.prototype=Object.create(n.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,r,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return n.asPromise(e,s,t,r,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}})),Pu=ye((function(e){e.Service=Au()})),Lu=ye((function(e,t){t.exports={}})),$u=ye((function(e){var t=e;function n(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=hi(),t.BufferWriter=bu(),t.Reader=gi(),t.BufferReader=Iu(),t.util=er(),t.rpc=Pu(),t.roots=Lu(),t.configure=n,n()})),ku=ye((function(e,t){t.exports=$u()})),Ur=ye((function(e,t){var n=ku(),r=n.Reader,i=n.Writer,o=n.util,a=n.roots.default||(n.roots.default={});a.onnx=function(){var e,t,s={};return s.Version=(e={},(t=Object.create(e))[e[0]="_START_VERSION"]=0,t[e[1]="IR_VERSION_2017_10_10"]=1,t[e[2]="IR_VERSION_2017_10_30"]=2,t[e[3]="IR_VERSION_2017_11_3"]=3,t[e[4]="IR_VERSION_2019_1_22"]=4,t[e[5]="IR_VERSION_2019_3_18"]=5,t[e[6]="IR_VERSION_2019_9_19"]=6,t[e[7]="IR_VERSION_2020_5_8"]=7,t[e[8]="IR_VERSION_2021_7_30"]=8,t[e[9]="IR_VERSION"]=9,t),s.AttributeProto=function(){function e(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.refAttrName="",e.prototype.docString="",e.prototype.type=0,e.prototype.f=0,e.prototype.i=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.s=o.newBuffer([]),e.prototype.t=null,e.prototype.g=null,e.prototype.sparseTensor=null,e.prototype.tp=null,e.prototype.floats=o.emptyArray,e.prototype.ints=o.emptyArray,e.prototype.strings=o.emptyArray,e.prototype.tensors=o.emptyArray,e.prototype.graphs=o.emptyArray,e.prototype.sparseTensors=o.emptyArray,e.prototype.typeProtos=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.f&&Object.hasOwnProperty.call(e,"f")&&t.uint32(21).float(e.f),null!=e.i&&Object.hasOwnProperty.call(e,"i")&&t.uint32(24).int64(e.i),null!=e.s&&Object.hasOwnProperty.call(e,"s")&&t.uint32(34).bytes(e.s),null!=e.t&&Object.hasOwnProperty.call(e,"t")&&a.onnx.TensorProto.encode(e.t,t.uint32(42).fork()).ldelim(),null!=e.g&&Object.hasOwnProperty.call(e,"g")&&a.onnx.GraphProto.encode(e.g,t.uint32(50).fork()).ldelim(),null!=e.floats&&e.floats.length){t.uint32(58).fork();for(var n=0;n<e.floats.length;++n)t.float(e.floats[n]);t.ldelim()}if(null!=e.ints&&e.ints.length){for(t.uint32(66).fork(),n=0;n<e.ints.length;++n)t.int64(e.ints[n]);t.ldelim()}if(null!=e.strings&&e.strings.length)for(n=0;n<e.strings.length;++n)t.uint32(74).bytes(e.strings[n]);if(null!=e.tensors&&e.tensors.length)for(n=0;n<e.tensors.length;++n)a.onnx.TensorProto.encode(e.tensors[n],t.uint32(82).fork()).ldelim();if(null!=e.graphs&&e.graphs.length)for(n=0;n<e.graphs.length;++n)a.onnx.GraphProto.encode(e.graphs[n],t.uint32(90).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(106).string(e.docString),null!=e.tp&&Object.hasOwnProperty.call(e,"tp")&&a.onnx.TypeProto.encode(e.tp,t.uint32(114).fork()).ldelim(),null!=e.typeProtos&&e.typeProtos.length)for(n=0;n<e.typeProtos.length;++n)a.onnx.TypeProto.encode(e.typeProtos[n],t.uint32(122).fork()).ldelim();if(null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(160).int32(e.type),null!=e.refAttrName&&Object.hasOwnProperty.call(e,"refAttrName")&&t.uint32(170).string(e.refAttrName),null!=e.sparseTensor&&Object.hasOwnProperty.call(e,"sparseTensor")&&a.onnx.SparseTensorProto.encode(e.sparseTensor,t.uint32(178).fork()).ldelim(),null!=e.sparseTensors&&e.sparseTensors.length)for(n=0;n<e.sparseTensors.length;++n)a.onnx.SparseTensorProto.encode(e.sparseTensors[n],t.uint32(186).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.AttributeProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 21:i.refAttrName=e.string();break;case 13:i.docString=e.string();break;case 20:i.type=e.int32();break;case 2:i.f=e.float();break;case 3:i.i=e.int64();break;case 4:i.s=e.bytes();break;case 5:i.t=a.onnx.TensorProto.decode(e,e.uint32());break;case 6:i.g=a.onnx.GraphProto.decode(e,e.uint32());break;case 22:i.sparseTensor=a.onnx.SparseTensorProto.decode(e,e.uint32());break;case 14:i.tp=a.onnx.TypeProto.decode(e,e.uint32());break;case 7:if(i.floats&&i.floats.length||(i.floats=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.floats.push(e.float());else i.floats.push(e.float());break;case 8:if(i.ints&&i.ints.length||(i.ints=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.ints.push(e.int64());else i.ints.push(e.int64());break;case 9:i.strings&&i.strings.length||(i.strings=[]),i.strings.push(e.bytes());break;case 10:i.tensors&&i.tensors.length||(i.tensors=[]),i.tensors.push(a.onnx.TensorProto.decode(e,e.uint32()));break;case 11:i.graphs&&i.graphs.length||(i.graphs=[]),i.graphs.push(a.onnx.GraphProto.decode(e,e.uint32()));break;case 23:i.sparseTensors&&i.sparseTensors.length||(i.sparseTensors=[]),i.sparseTensors.push(a.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 15:i.typeProtos&&i.typeProtos.length||(i.typeProtos=[]),i.typeProtos.push(a.onnx.TypeProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&!o.isString(e.refAttrName))return"refAttrName: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:}if(null!=e.f&&e.hasOwnProperty("f")&&"number"!=typeof e.f)return"f: number expected";if(null!=e.i&&e.hasOwnProperty("i")&&!o.isInteger(e.i)&&!(e.i&&o.isInteger(e.i.low)&&o.isInteger(e.i.high)))return"i: integer|Long expected";if(null!=e.s&&e.hasOwnProperty("s")&&!(e.s&&"number"==typeof e.s.length||o.isString(e.s)))return"s: buffer expected";if(null!=e.t&&e.hasOwnProperty("t")&&(n=a.onnx.TensorProto.verify(e.t)))return"t."+n;if(null!=e.g&&e.hasOwnProperty("g")&&(n=a.onnx.GraphProto.verify(e.g)))return"g."+n;if(null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(n=a.onnx.SparseTensorProto.verify(e.sparseTensor)))return"sparseTensor."+n;if(null!=e.tp&&e.hasOwnProperty("tp")&&(n=a.onnx.TypeProto.verify(e.tp)))return"tp."+n;if(null!=e.floats&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var t=0;t<e.floats.length;++t)if("number"!=typeof e.floats[t])return"floats: number[] expected"}if(null!=e.ints&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(t=0;t<e.ints.length;++t)if(!(o.isInteger(e.ints[t])||e.ints[t]&&o.isInteger(e.ints[t].low)&&o.isInteger(e.ints[t].high)))return"ints: integer|Long[] expected"}if(null!=e.strings&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(t=0;t<e.strings.length;++t)if(!(e.strings[t]&&"number"==typeof e.strings[t].length||o.isString(e.strings[t])))return"strings: buffer[] expected"}if(null!=e.tensors&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(t=0;t<e.tensors.length;++t)if(n=a.onnx.TensorProto.verify(e.tensors[t]))return"tensors."+n}if(null!=e.graphs&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(t=0;t<e.graphs.length;++t)if(n=a.onnx.GraphProto.verify(e.graphs[t]))return"graphs."+n}if(null!=e.sparseTensors&&e.hasOwnProperty("sparseTensors")){if(!Array.isArray(e.sparseTensors))return"sparseTensors: array expected";for(t=0;t<e.sparseTensors.length;++t)if(n=a.onnx.SparseTensorProto.verify(e.sparseTensors[t]))return"sparseTensors."+n}if(null!=e.typeProtos&&e.hasOwnProperty("typeProtos")){if(!Array.isArray(e.typeProtos))return"typeProtos: array expected";for(t=0;t<e.typeProtos.length;++t){var n;if(n=a.onnx.TypeProto.verify(e.typeProtos[t]))return"typeProtos."+n}}return null},e.fromObject=function(e){if(e instanceof a.onnx.AttributeProto)return e;var t=new a.onnx.AttributeProto;switch(null!=e.name&&(t.name=String(e.name)),null!=e.refAttrName&&(t.refAttrName=String(e.refAttrName)),null!=e.docString&&(t.docString=String(e.docString)),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"UNDEFINED":case 0:t.type=0;break;case"FLOAT":case 1:t.type=1;break;case"INT":case 2:t.type=2;break;case"STRING":case 3:t.type=3;break;case"TENSOR":case 4:t.type=4;break;case"GRAPH":case 5:t.type=5;break;case"SPARSE_TENSOR":case 11:t.type=11;break;case"TYPE_PROTO":case 13:t.type=13;break;case"FLOATS":case 6:t.type=6;break;case"INTS":case 7:t.type=7;break;case"STRINGS":case 8:t.type=8;break;case"TENSORS":case 9:t.type=9;break;case"GRAPHS":case 10:t.type=10;break;case"SPARSE_TENSORS":case 12:t.type=12;break;case"TYPE_PROTOS":case 14:t.type=14}if(null!=e.f&&(t.f=Number(e.f)),null!=e.i&&(o.Long?(t.i=o.Long.fromValue(e.i)).unsigned=!1:"string"==typeof e.i?t.i=parseInt(e.i,10):"number"==typeof e.i?t.i=e.i:"object"==_typeof(e.i)&&(t.i=new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),null!=e.s&&("string"==typeof e.s?o.base64.decode(e.s,t.s=o.newBuffer(o.base64.length(e.s)),0):e.s.length>=0&&(t.s=e.s)),null!=e.t){if("object"!=_typeof(e.t))throw TypeError(".onnx.AttributeProto.t: object expected");t.t=a.onnx.TensorProto.fromObject(e.t)}if(null!=e.g){if("object"!=_typeof(e.g))throw TypeError(".onnx.AttributeProto.g: object expected");t.g=a.onnx.GraphProto.fromObject(e.g)}if(null!=e.sparseTensor){if("object"!=_typeof(e.sparseTensor))throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");t.sparseTensor=a.onnx.SparseTensorProto.fromObject(e.sparseTensor)}if(null!=e.tp){if("object"!=_typeof(e.tp))throw TypeError(".onnx.AttributeProto.tp: object expected");t.tp=a.onnx.TypeProto.fromObject(e.tp)}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");t.floats=[];for(var n=0;n<e.floats.length;++n)t.floats[n]=Number(e.floats[n])}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(t.ints=[],n=0;n<e.ints.length;++n)o.Long?(t.ints[n]=o.Long.fromValue(e.ints[n])).unsigned=!1:"string"==typeof e.ints[n]?t.ints[n]=parseInt(e.ints[n],10):"number"==typeof e.ints[n]?t.ints[n]=e.ints[n]:"object"==_typeof(e.ints[n])&&(t.ints[n]=new o.LongBits(e.ints[n].low>>>0,e.ints[n].high>>>0).toNumber())}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(t.strings=[],n=0;n<e.strings.length;++n)"string"==typeof e.strings[n]?o.base64.decode(e.strings[n],t.strings[n]=o.newBuffer(o.base64.length(e.strings[n])),0):e.strings[n].length>=0&&(t.strings[n]=e.strings[n])}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(t.tensors=[],n=0;n<e.tensors.length;++n){if("object"!=_typeof(e.tensors[n]))throw TypeError(".onnx.AttributeProto.tensors: object expected");t.tensors[n]=a.onnx.TensorProto.fromObject(e.tensors[n])}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(t.graphs=[],n=0;n<e.graphs.length;++n){if("object"!=_typeof(e.graphs[n]))throw TypeError(".onnx.AttributeProto.graphs: object expected");t.graphs[n]=a.onnx.GraphProto.fromObject(e.graphs[n])}}if(e.sparseTensors){if(!Array.isArray(e.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");for(t.sparseTensors=[],n=0;n<e.sparseTensors.length;++n){if("object"!=_typeof(e.sparseTensors[n]))throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");t.sparseTensors[n]=a.onnx.SparseTensorProto.fromObject(e.sparseTensors[n])}}if(e.typeProtos){if(!Array.isArray(e.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");for(t.typeProtos=[],n=0;n<e.typeProtos.length;++n){if("object"!=_typeof(e.typeProtos[n]))throw TypeError(".onnx.AttributeProto.typeProtos: object expected");t.typeProtos[n]=a.onnx.TypeProto.fromObject(e.typeProtos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.floats=[],n.ints=[],n.strings=[],n.tensors=[],n.graphs=[],n.typeProtos=[],n.sparseTensors=[]),t.defaults){if(n.name="",n.f=0,o.Long){var r=new o.Long(0,0,!1);n.i=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.i=t.longs===String?"0":0;t.bytes===String?n.s="":(n.s=[],t.bytes!==Array&&(n.s=o.newBuffer(n.s))),n.t=null,n.g=null,n.docString="",n.tp=null,n.type=t.enums===String?"UNDEFINED":0,n.refAttrName="",n.sparseTensor=null}if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.f&&e.hasOwnProperty("f")&&(n.f=t.json&&!isFinite(e.f)?String(e.f):e.f),null!=e.i&&e.hasOwnProperty("i")&&("number"==typeof e.i?n.i=t.longs===String?String(e.i):e.i:n.i=t.longs===String?o.Long.prototype.toString.call(e.i):t.longs===Number?new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),null!=e.s&&e.hasOwnProperty("s")&&(n.s=t.bytes===String?o.base64.encode(e.s,0,e.s.length):t.bytes===Array?Array.prototype.slice.call(e.s):e.s),null!=e.t&&e.hasOwnProperty("t")&&(n.t=a.onnx.TensorProto.toObject(e.t,t)),null!=e.g&&e.hasOwnProperty("g")&&(n.g=a.onnx.GraphProto.toObject(e.g,t)),e.floats&&e.floats.length){n.floats=[];for(var i=0;i<e.floats.length;++i)n.floats[i]=t.json&&!isFinite(e.floats[i])?String(e.floats[i]):e.floats[i]}if(e.ints&&e.ints.length)for(n.ints=[],i=0;i<e.ints.length;++i)"number"==typeof e.ints[i]?n.ints[i]=t.longs===String?String(e.ints[i]):e.ints[i]:n.ints[i]=t.longs===String?o.Long.prototype.toString.call(e.ints[i]):t.longs===Number?new o.LongBits(e.ints[i].low>>>0,e.ints[i].high>>>0).toNumber():e.ints[i];if(e.strings&&e.strings.length)for(n.strings=[],i=0;i<e.strings.length;++i)n.strings[i]=t.bytes===String?o.base64.encode(e.strings[i],0,e.strings[i].length):t.bytes===Array?Array.prototype.slice.call(e.strings[i]):e.strings[i];if(e.tensors&&e.tensors.length)for(n.tensors=[],i=0;i<e.tensors.length;++i)n.tensors[i]=a.onnx.TensorProto.toObject(e.tensors[i],t);if(e.graphs&&e.graphs.length)for(n.graphs=[],i=0;i<e.graphs.length;++i)n.graphs[i]=a.onnx.GraphProto.toObject(e.graphs[i],t);if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),null!=e.tp&&e.hasOwnProperty("tp")&&(n.tp=a.onnx.TypeProto.toObject(e.tp,t)),e.typeProtos&&e.typeProtos.length)for(n.typeProtos=[],i=0;i<e.typeProtos.length;++i)n.typeProtos[i]=a.onnx.TypeProto.toObject(e.typeProtos[i],t);if(null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?void 0===a.onnx.AttributeProto.AttributeType[e.type]?e.type:a.onnx.AttributeProto.AttributeType[e.type]:e.type),null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&(n.refAttrName=e.refAttrName),null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(n.sparseTensor=a.onnx.SparseTensorProto.toObject(e.sparseTensor,t)),e.sparseTensors&&e.sparseTensors.length)for(n.sparseTensors=[],i=0;i<e.sparseTensors.length;++i)n.sparseTensors[i]=a.onnx.SparseTensorProto.toObject(e.sparseTensors[i],t);return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.AttributeProto"},e.AttributeType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t[e[3]="STRING"]=3,t[e[4]="TENSOR"]=4,t[e[5]="GRAPH"]=5,t[e[11]="SPARSE_TENSOR"]=11,t[e[13]="TYPE_PROTO"]=13,t[e[6]="FLOATS"]=6,t[e[7]="INTS"]=7,t[e[8]="STRINGS"]=8,t[e[9]="TENSORS"]=9,t[e[10]="GRAPHS"]=10,t[e[12]="SPARSE_TENSORS"]=12,t[e[14]="TYPE_PROTOS"]=14,t}(),e}(),s.ValueInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.type=null,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&a.onnx.TypeProto.encode(e.type,t.uint32(18).fork()).ldelim(),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(26).string(e.docString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.ValueInfoProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 2:i.type=a.onnx.TypeProto.decode(e,e.uint32());break;case 3:i.docString=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type")){var t=a.onnx.TypeProto.verify(e.type);if(t)return"type."+t}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.ValueInfoProto)return e;var t=new a.onnx.ValueInfoProto;if(null!=e.name&&(t.name=String(e.name)),null!=e.type){if("object"!=_typeof(e.type))throw TypeError(".onnx.ValueInfoProto.type: object expected");t.type=a.onnx.TypeProto.fromObject(e.type)}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.name="",n.type=null,n.docString=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(n.type=a.onnx.TypeProto.toObject(e.type,t)),null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ValueInfoProto"},e}(),s.NodeProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.name="",e.prototype.opType="",e.prototype.domain="",e.prototype.attribute=o.emptyArray,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.input&&e.input.length)for(var n=0;n<e.input.length;++n)t.uint32(10).string(e.input[n]);if(null!=e.output&&e.output.length)for(n=0;n<e.output.length;++n)t.uint32(18).string(e.output[n]);if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(26).string(e.name),null!=e.opType&&Object.hasOwnProperty.call(e,"opType")&&t.uint32(34).string(e.opType),null!=e.attribute&&e.attribute.length)for(n=0;n<e.attribute.length;++n)a.onnx.AttributeProto.encode(e.attribute[n],t.uint32(42).fork()).ldelim();return null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(58).string(e.domain),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.NodeProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.input&&i.input.length||(i.input=[]),i.input.push(e.string());break;case 2:i.output&&i.output.length||(i.output=[]),i.output.push(e.string());break;case 3:i.name=e.string();break;case 4:i.opType=e.string();break;case 7:i.domain=e.string();break;case 5:i.attribute&&i.attribute.length||(i.attribute=[]),i.attribute.push(a.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:i.docString=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.opType&&e.hasOwnProperty("opType")&&!o.isString(e.opType))return"opType: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t){var n=a.onnx.AttributeProto.verify(e.attribute[t]);if(n)return"attribute."+n}}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.NodeProto)return e;var t=new a.onnx.NodeProto;if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");t.input=[];for(var n=0;n<e.input.length;++n)t.input[n]=String(e.input[n])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");for(t.output=[],n=0;n<e.output.length;++n)t.output[n]=String(e.output[n])}if(null!=e.name&&(t.name=String(e.name)),null!=e.opType&&(t.opType=String(e.opType)),null!=e.domain&&(t.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(t.attribute=[],n=0;n<e.attribute.length;++n){if("object"!=_typeof(e.attribute[n]))throw TypeError(".onnx.NodeProto.attribute: object expected");t.attribute[n]=a.onnx.AttributeProto.fromObject(e.attribute[n])}}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.input=[],n.output=[],n.attribute=[]),t.defaults&&(n.name="",n.opType="",n.docString="",n.domain=""),e.input&&e.input.length){n.input=[];for(var r=0;r<e.input.length;++r)n.input[r]=e.input[r]}if(e.output&&e.output.length)for(n.output=[],r=0;r<e.output.length;++r)n.output[r]=e.output[r];if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.opType&&e.hasOwnProperty("opType")&&(n.opType=e.opType),e.attribute&&e.attribute.length)for(n.attribute=[],r=0;r<e.attribute.length;++r)n.attribute[r]=a.onnx.AttributeProto.toObject(e.attribute[r],t);return null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.NodeProto"},e}(),s.TrainingInfoProto=function(){function e(e){if(this.initializationBinding=[],this.updateBinding=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.initialization=null,e.prototype.algorithm=null,e.prototype.initializationBinding=o.emptyArray,e.prototype.updateBinding=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.initialization&&Object.hasOwnProperty.call(e,"initialization")&&a.onnx.GraphProto.encode(e.initialization,t.uint32(10).fork()).ldelim(),null!=e.algorithm&&Object.hasOwnProperty.call(e,"algorithm")&&a.onnx.GraphProto.encode(e.algorithm,t.uint32(18).fork()).ldelim(),null!=e.initializationBinding&&e.initializationBinding.length)for(var n=0;n<e.initializationBinding.length;++n)a.onnx.StringStringEntryProto.encode(e.initializationBinding[n],t.uint32(26).fork()).ldelim();if(null!=e.updateBinding&&e.updateBinding.length)for(n=0;n<e.updateBinding.length;++n)a.onnx.StringStringEntryProto.encode(e.updateBinding[n],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TrainingInfoProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.initialization=a.onnx.GraphProto.decode(e,e.uint32());break;case 2:i.algorithm=a.onnx.GraphProto.decode(e,e.uint32());break;case 3:i.initializationBinding&&i.initializationBinding.length||(i.initializationBinding=[]),i.initializationBinding.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 4:i.updateBinding&&i.updateBinding.length||(i.updateBinding=[]),i.updateBinding.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.initialization&&e.hasOwnProperty("initialization")&&(n=a.onnx.GraphProto.verify(e.initialization)))return"initialization."+n;if(null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(n=a.onnx.GraphProto.verify(e.algorithm)))return"algorithm."+n;if(null!=e.initializationBinding&&e.hasOwnProperty("initializationBinding")){if(!Array.isArray(e.initializationBinding))return"initializationBinding: array expected";for(var t=0;t<e.initializationBinding.length;++t)if(n=a.onnx.StringStringEntryProto.verify(e.initializationBinding[t]))return"initializationBinding."+n}if(null!=e.updateBinding&&e.hasOwnProperty("updateBinding")){if(!Array.isArray(e.updateBinding))return"updateBinding: array expected";for(t=0;t<e.updateBinding.length;++t){var n;if(n=a.onnx.StringStringEntryProto.verify(e.updateBinding[t]))return"updateBinding."+n}}return null},e.fromObject=function(e){if(e instanceof a.onnx.TrainingInfoProto)return e;var t=new a.onnx.TrainingInfoProto;if(null!=e.initialization){if("object"!=_typeof(e.initialization))throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");t.initialization=a.onnx.GraphProto.fromObject(e.initialization)}if(null!=e.algorithm){if("object"!=_typeof(e.algorithm))throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");t.algorithm=a.onnx.GraphProto.fromObject(e.algorithm)}if(e.initializationBinding){if(!Array.isArray(e.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");t.initializationBinding=[];for(var n=0;n<e.initializationBinding.length;++n){if("object"!=_typeof(e.initializationBinding[n]))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");t.initializationBinding[n]=a.onnx.StringStringEntryProto.fromObject(e.initializationBinding[n])}}if(e.updateBinding){if(!Array.isArray(e.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");for(t.updateBinding=[],n=0;n<e.updateBinding.length;++n){if("object"!=_typeof(e.updateBinding[n]))throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");t.updateBinding[n]=a.onnx.StringStringEntryProto.fromObject(e.updateBinding[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.initializationBinding=[],n.updateBinding=[]),t.defaults&&(n.initialization=null,n.algorithm=null),null!=e.initialization&&e.hasOwnProperty("initialization")&&(n.initialization=a.onnx.GraphProto.toObject(e.initialization,t)),null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(n.algorithm=a.onnx.GraphProto.toObject(e.algorithm,t)),e.initializationBinding&&e.initializationBinding.length){n.initializationBinding=[];for(var r=0;r<e.initializationBinding.length;++r)n.initializationBinding[r]=a.onnx.StringStringEntryProto.toObject(e.initializationBinding[r],t)}if(e.updateBinding&&e.updateBinding.length)for(n.updateBinding=[],r=0;r<e.updateBinding.length;++r)n.updateBinding[r]=a.onnx.StringStringEntryProto.toObject(e.updateBinding[r],t);return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TrainingInfoProto"},e}(),s.ModelProto=function(){function e(e){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.irVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.opsetImport=o.emptyArray,e.prototype.producerName="",e.prototype.producerVersion="",e.prototype.domain="",e.prototype.modelVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.docString="",e.prototype.graph=null,e.prototype.metadataProps=o.emptyArray,e.prototype.trainingInfo=o.emptyArray,e.prototype.functions=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.irVersion&&Object.hasOwnProperty.call(e,"irVersion")&&t.uint32(8).int64(e.irVersion),null!=e.producerName&&Object.hasOwnProperty.call(e,"producerName")&&t.uint32(18).string(e.producerName),null!=e.producerVersion&&Object.hasOwnProperty.call(e,"producerVersion")&&t.uint32(26).string(e.producerVersion),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(34).string(e.domain),null!=e.modelVersion&&Object.hasOwnProperty.call(e,"modelVersion")&&t.uint32(40).int64(e.modelVersion),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.graph&&Object.hasOwnProperty.call(e,"graph")&&a.onnx.GraphProto.encode(e.graph,t.uint32(58).fork()).ldelim(),null!=e.opsetImport&&e.opsetImport.length)for(var n=0;n<e.opsetImport.length;++n)a.onnx.OperatorSetIdProto.encode(e.opsetImport[n],t.uint32(66).fork()).ldelim();if(null!=e.metadataProps&&e.metadataProps.length)for(n=0;n<e.metadataProps.length;++n)a.onnx.StringStringEntryProto.encode(e.metadataProps[n],t.uint32(114).fork()).ldelim();if(null!=e.trainingInfo&&e.trainingInfo.length)for(n=0;n<e.trainingInfo.length;++n)a.onnx.TrainingInfoProto.encode(e.trainingInfo[n],t.uint32(162).fork()).ldelim();if(null!=e.functions&&e.functions.length)for(n=0;n<e.functions.length;++n)a.onnx.FunctionProto.encode(e.functions[n],t.uint32(202).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.ModelProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.irVersion=e.int64();break;case 8:i.opsetImport&&i.opsetImport.length||(i.opsetImport=[]),i.opsetImport.push(a.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:i.producerName=e.string();break;case 3:i.producerVersion=e.string();break;case 4:i.domain=e.string();break;case 5:i.modelVersion=e.int64();break;case 6:i.docString=e.string();break;case 7:i.graph=a.onnx.GraphProto.decode(e,e.uint32());break;case 14:i.metadataProps&&i.metadataProps.length||(i.metadataProps=[]),i.metadataProps.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 20:i.trainingInfo&&i.trainingInfo.length||(i.trainingInfo=[]),i.trainingInfo.push(a.onnx.TrainingInfoProto.decode(e,e.uint32()));break;case 25:i.functions&&i.functions.length||(i.functions=[]),i.functions.push(a.onnx.FunctionProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&!o.isInteger(e.irVersion)&&!(e.irVersion&&o.isInteger(e.irVersion.low)&&o.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var t=0;t<e.opsetImport.length;++t)if(n=a.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+n}if(null!=e.producerName&&e.hasOwnProperty("producerName")&&!o.isString(e.producerName))return"producerName: string expected";if(null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&!o.isString(e.producerVersion))return"producerVersion: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&!o.isInteger(e.modelVersion)&&!(e.modelVersion&&o.isInteger(e.modelVersion.low)&&o.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.graph&&e.hasOwnProperty("graph")&&(n=a.onnx.GraphProto.verify(e.graph)))return"graph."+n;if(null!=e.metadataProps&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(t=0;t<e.metadataProps.length;++t)if(n=a.onnx.StringStringEntryProto.verify(e.metadataProps[t]))return"metadataProps."+n}if(null!=e.trainingInfo&&e.hasOwnProperty("trainingInfo")){if(!Array.isArray(e.trainingInfo))return"trainingInfo: array expected";for(t=0;t<e.trainingInfo.length;++t)if(n=a.onnx.TrainingInfoProto.verify(e.trainingInfo[t]))return"trainingInfo."+n}if(null!=e.functions&&e.hasOwnProperty("functions")){if(!Array.isArray(e.functions))return"functions: array expected";for(t=0;t<e.functions.length;++t){var n;if(n=a.onnx.FunctionProto.verify(e.functions[t]))return"functions."+n}}return null},e.fromObject=function(e){if(e instanceof a.onnx.ModelProto)return e;var t=new a.onnx.ModelProto;if(null!=e.irVersion&&(o.Long?(t.irVersion=o.Long.fromValue(e.irVersion)).unsigned=!1:"string"==typeof e.irVersion?t.irVersion=parseInt(e.irVersion,10):"number"==typeof e.irVersion?t.irVersion=e.irVersion:"object"==_typeof(e.irVersion)&&(t.irVersion=new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");t.opsetImport=[];for(var n=0;n<e.opsetImport.length;++n){if("object"!=_typeof(e.opsetImport[n]))throw TypeError(".onnx.ModelProto.opsetImport: object expected");t.opsetImport[n]=a.onnx.OperatorSetIdProto.fromObject(e.opsetImport[n])}}if(null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.producerVersion&&(t.producerVersion=String(e.producerVersion)),null!=e.domain&&(t.domain=String(e.domain)),null!=e.modelVersion&&(o.Long?(t.modelVersion=o.Long.fromValue(e.modelVersion)).unsigned=!1:"string"==typeof e.modelVersion?t.modelVersion=parseInt(e.modelVersion,10):"number"==typeof e.modelVersion?t.modelVersion=e.modelVersion:"object"==_typeof(e.modelVersion)&&(t.modelVersion=new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),null!=e.docString&&(t.docString=String(e.docString)),null!=e.graph){if("object"!=_typeof(e.graph))throw TypeError(".onnx.ModelProto.graph: object expected");t.graph=a.onnx.GraphProto.fromObject(e.graph)}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(t.metadataProps=[],n=0;n<e.metadataProps.length;++n){if("object"!=_typeof(e.metadataProps[n]))throw TypeError(".onnx.ModelProto.metadataProps: object expected");t.metadataProps[n]=a.onnx.StringStringEntryProto.fromObject(e.metadataProps[n])}}if(e.trainingInfo){if(!Array.isArray(e.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");for(t.trainingInfo=[],n=0;n<e.trainingInfo.length;++n){if("object"!=_typeof(e.trainingInfo[n]))throw TypeError(".onnx.ModelProto.trainingInfo: object expected");t.trainingInfo[n]=a.onnx.TrainingInfoProto.fromObject(e.trainingInfo[n])}}if(e.functions){if(!Array.isArray(e.functions))throw TypeError(".onnx.ModelProto.functions: array expected");for(t.functions=[],n=0;n<e.functions.length;++n){if("object"!=_typeof(e.functions[n]))throw TypeError(".onnx.ModelProto.functions: object expected");t.functions[n]=a.onnx.FunctionProto.fromObject(e.functions[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.opsetImport=[],n.metadataProps=[],n.trainingInfo=[],n.functions=[]),t.defaults){if(o.Long){var r=new o.Long(0,0,!1);n.irVersion=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.irVersion=t.longs===String?"0":0;n.producerName="",n.producerVersion="",n.domain="",o.Long?(r=new o.Long(0,0,!1),n.modelVersion=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.modelVersion=t.longs===String?"0":0,n.docString="",n.graph=null}if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&("number"==typeof e.irVersion?n.irVersion=t.longs===String?String(e.irVersion):e.irVersion:n.irVersion=t.longs===String?o.Long.prototype.toString.call(e.irVersion):t.longs===Number?new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),null!=e.producerName&&e.hasOwnProperty("producerName")&&(n.producerName=e.producerName),null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&(n.producerVersion=e.producerVersion),null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&("number"==typeof e.modelVersion?n.modelVersion=t.longs===String?String(e.modelVersion):e.modelVersion:n.modelVersion=t.longs===String?o.Long.prototype.toString.call(e.modelVersion):t.longs===Number?new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),null!=e.graph&&e.hasOwnProperty("graph")&&(n.graph=a.onnx.GraphProto.toObject(e.graph,t)),e.opsetImport&&e.opsetImport.length){n.opsetImport=[];for(var i=0;i<e.opsetImport.length;++i)n.opsetImport[i]=a.onnx.OperatorSetIdProto.toObject(e.opsetImport[i],t)}if(e.metadataProps&&e.metadataProps.length)for(n.metadataProps=[],i=0;i<e.metadataProps.length;++i)n.metadataProps[i]=a.onnx.StringStringEntryProto.toObject(e.metadataProps[i],t);if(e.trainingInfo&&e.trainingInfo.length)for(n.trainingInfo=[],i=0;i<e.trainingInfo.length;++i)n.trainingInfo[i]=a.onnx.TrainingInfoProto.toObject(e.trainingInfo[i],t);if(e.functions&&e.functions.length)for(n.functions=[],i=0;i<e.functions.length;++i)n.functions[i]=a.onnx.FunctionProto.toObject(e.functions[i],t);return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ModelProto"},e}(),s.StringStringEntryProto=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.StringStringEntryProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.key=e.string();break;case 2:i.value=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!o.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!o.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.StringStringEntryProto)return e;var t=new a.onnx.StringStringEntryProto;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.StringStringEntryProto"},e}(),s.TensorAnnotation=function(){function e(e){if(this.quantParameterTensorNames=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tensorName="",e.prototype.quantParameterTensorNames=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.tensorName&&Object.hasOwnProperty.call(e,"tensorName")&&t.uint32(10).string(e.tensorName),null!=e.quantParameterTensorNames&&e.quantParameterTensorNames.length)for(var n=0;n<e.quantParameterTensorNames.length;++n)a.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorAnnotation;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.tensorName=e.string();break;case 2:i.quantParameterTensorNames&&i.quantParameterTensorNames.length||(i.quantParameterTensorNames=[]),i.quantParameterTensorNames.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.tensorName&&e.hasOwnProperty("tensorName")&&!o.isString(e.tensorName))return"tensorName: string expected";if(null!=e.quantParameterTensorNames&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var t=0;t<e.quantParameterTensorNames.length;++t){var n=a.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[t]);if(n)return"quantParameterTensorNames."+n}}return null},e.fromObject=function(e){if(e instanceof a.onnx.TensorAnnotation)return e;var t=new a.onnx.TensorAnnotation;if(null!=e.tensorName&&(t.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");t.quantParameterTensorNames=[];for(var n=0;n<e.quantParameterTensorNames.length;++n){if("object"!=_typeof(e.quantParameterTensorNames[n]))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");t.quantParameterTensorNames[n]=a.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.quantParameterTensorNames=[]),t.defaults&&(n.tensorName=""),null!=e.tensorName&&e.hasOwnProperty("tensorName")&&(n.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){n.quantParameterTensorNames=[];for(var r=0;r<e.quantParameterTensorNames.length;++r)n.quantParameterTensorNames[r]=a.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[r],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorAnnotation"},e}(),s.GraphProto=function(){function e(e){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.node=o.emptyArray,e.prototype.name="",e.prototype.initializer=o.emptyArray,e.prototype.sparseInitializer=o.emptyArray,e.prototype.docString="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.valueInfo=o.emptyArray,e.prototype.quantizationAnnotation=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.node&&e.node.length)for(var n=0;n<e.node.length;++n)a.onnx.NodeProto.encode(e.node[n],t.uint32(10).fork()).ldelim();if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.initializer&&e.initializer.length)for(n=0;n<e.initializer.length;++n)a.onnx.TensorProto.encode(e.initializer[n],t.uint32(42).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(82).string(e.docString),null!=e.input&&e.input.length)for(n=0;n<e.input.length;++n)a.onnx.ValueInfoProto.encode(e.input[n],t.uint32(90).fork()).ldelim();if(null!=e.output&&e.output.length)for(n=0;n<e.output.length;++n)a.onnx.ValueInfoProto.encode(e.output[n],t.uint32(98).fork()).ldelim();if(null!=e.valueInfo&&e.valueInfo.length)for(n=0;n<e.valueInfo.length;++n)a.onnx.ValueInfoProto.encode(e.valueInfo[n],t.uint32(106).fork()).ldelim();if(null!=e.quantizationAnnotation&&e.quantizationAnnotation.length)for(n=0;n<e.quantizationAnnotation.length;++n)a.onnx.TensorAnnotation.encode(e.quantizationAnnotation[n],t.uint32(114).fork()).ldelim();if(null!=e.sparseInitializer&&e.sparseInitializer.length)for(n=0;n<e.sparseInitializer.length;++n)a.onnx.SparseTensorProto.encode(e.sparseInitializer[n],t.uint32(122).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.GraphProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.node&&i.node.length||(i.node=[]),i.node.push(a.onnx.NodeProto.decode(e,e.uint32()));break;case 2:i.name=e.string();break;case 5:i.initializer&&i.initializer.length||(i.initializer=[]),i.initializer.push(a.onnx.TensorProto.decode(e,e.uint32()));break;case 15:i.sparseInitializer&&i.sparseInitializer.length||(i.sparseInitializer=[]),i.sparseInitializer.push(a.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 10:i.docString=e.string();break;case 11:i.input&&i.input.length||(i.input=[]),i.input.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:i.output&&i.output.length||(i.output=[]),i.output.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:i.valueInfo&&i.valueInfo.length||(i.valueInfo=[]),i.valueInfo.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:i.quantizationAnnotation&&i.quantizationAnnotation.length||(i.quantizationAnnotation=[]),i.quantizationAnnotation.push(a.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var t=0;t<e.node.length;++t)if(n=a.onnx.NodeProto.verify(e.node[t]))return"node."+n}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.initializer&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(t=0;t<e.initializer.length;++t)if(n=a.onnx.TensorProto.verify(e.initializer[t]))return"initializer."+n}if(null!=e.sparseInitializer&&e.hasOwnProperty("sparseInitializer")){if(!Array.isArray(e.sparseInitializer))return"sparseInitializer: array expected";for(t=0;t<e.sparseInitializer.length;++t)if(n=a.onnx.SparseTensorProto.verify(e.sparseInitializer[t]))return"sparseInitializer."+n}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(t=0;t<e.input.length;++t)if(n=a.onnx.ValueInfoProto.verify(e.input[t]))return"input."+n}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(n=a.onnx.ValueInfoProto.verify(e.output[t]))return"output."+n}if(null!=e.valueInfo&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(t=0;t<e.valueInfo.length;++t)if(n=a.onnx.ValueInfoProto.verify(e.valueInfo[t]))return"valueInfo."+n}if(null!=e.quantizationAnnotation&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(t=0;t<e.quantizationAnnotation.length;++t){var n;if(n=a.onnx.TensorAnnotation.verify(e.quantizationAnnotation[t]))return"quantizationAnnotation."+n}}return null},e.fromObject=function(e){if(e instanceof a.onnx.GraphProto)return e;var t=new a.onnx.GraphProto;if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");t.node=[];for(var n=0;n<e.node.length;++n){if("object"!=_typeof(e.node[n]))throw TypeError(".onnx.GraphProto.node: object expected");t.node[n]=a.onnx.NodeProto.fromObject(e.node[n])}}if(null!=e.name&&(t.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(t.initializer=[],n=0;n<e.initializer.length;++n){if("object"!=_typeof(e.initializer[n]))throw TypeError(".onnx.GraphProto.initializer: object expected");t.initializer[n]=a.onnx.TensorProto.fromObject(e.initializer[n])}}if(e.sparseInitializer){if(!Array.isArray(e.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");for(t.sparseInitializer=[],n=0;n<e.sparseInitializer.length;++n){if("object"!=_typeof(e.sparseInitializer[n]))throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");t.sparseInitializer[n]=a.onnx.SparseTensorProto.fromObject(e.sparseInitializer[n])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");for(t.input=[],n=0;n<e.input.length;++n){if("object"!=_typeof(e.input[n]))throw TypeError(".onnx.GraphProto.input: object expected");t.input[n]=a.onnx.ValueInfoProto.fromObject(e.input[n])}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");for(t.output=[],n=0;n<e.output.length;++n){if("object"!=_typeof(e.output[n]))throw TypeError(".onnx.GraphProto.output: object expected");t.output[n]=a.onnx.ValueInfoProto.fromObject(e.output[n])}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(t.valueInfo=[],n=0;n<e.valueInfo.length;++n){if("object"!=_typeof(e.valueInfo[n]))throw TypeError(".onnx.GraphProto.valueInfo: object expected");t.valueInfo[n]=a.onnx.ValueInfoProto.fromObject(e.valueInfo[n])}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(t.quantizationAnnotation=[],n=0;n<e.quantizationAnnotation.length;++n){if("object"!=_typeof(e.quantizationAnnotation[n]))throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");t.quantizationAnnotation[n]=a.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.node=[],n.initializer=[],n.input=[],n.output=[],n.valueInfo=[],n.quantizationAnnotation=[],n.sparseInitializer=[]),t.defaults&&(n.name="",n.docString=""),e.node&&e.node.length){n.node=[];for(var r=0;r<e.node.length;++r)n.node[r]=a.onnx.NodeProto.toObject(e.node[r],t)}if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),e.initializer&&e.initializer.length)for(n.initializer=[],r=0;r<e.initializer.length;++r)n.initializer[r]=a.onnx.TensorProto.toObject(e.initializer[r],t);if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),e.input&&e.input.length)for(n.input=[],r=0;r<e.input.length;++r)n.input[r]=a.onnx.ValueInfoProto.toObject(e.input[r],t);if(e.output&&e.output.length)for(n.output=[],r=0;r<e.output.length;++r)n.output[r]=a.onnx.ValueInfoProto.toObject(e.output[r],t);if(e.valueInfo&&e.valueInfo.length)for(n.valueInfo=[],r=0;r<e.valueInfo.length;++r)n.valueInfo[r]=a.onnx.ValueInfoProto.toObject(e.valueInfo[r],t);if(e.quantizationAnnotation&&e.quantizationAnnotation.length)for(n.quantizationAnnotation=[],r=0;r<e.quantizationAnnotation.length;++r)n.quantizationAnnotation[r]=a.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[r],t);if(e.sparseInitializer&&e.sparseInitializer.length)for(n.sparseInitializer=[],r=0;r<e.sparseInitializer.length;++r)n.sparseInitializer[r]=a.onnx.SparseTensorProto.toObject(e.sparseInitializer[r],t);return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.GraphProto"},e}(),s.TensorProto=function(){function e(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dims=o.emptyArray,e.prototype.dataType=0,e.prototype.segment=null,e.prototype.floatData=o.emptyArray,e.prototype.int32Data=o.emptyArray,e.prototype.stringData=o.emptyArray,e.prototype.int64Data=o.emptyArray,e.prototype.name="",e.prototype.docString="",e.prototype.rawData=o.newBuffer([]),e.prototype.externalData=o.emptyArray,e.prototype.dataLocation=0,e.prototype.doubleData=o.emptyArray,e.prototype.uint64Data=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.dims&&e.dims.length){t.uint32(10).fork();for(var n=0;n<e.dims.length;++n)t.int64(e.dims[n]);t.ldelim()}if(null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.segment&&Object.hasOwnProperty.call(e,"segment")&&a.onnx.TensorProto.Segment.encode(e.segment,t.uint32(26).fork()).ldelim(),null!=e.floatData&&e.floatData.length){for(t.uint32(34).fork(),n=0;n<e.floatData.length;++n)t.float(e.floatData[n]);t.ldelim()}if(null!=e.int32Data&&e.int32Data.length){for(t.uint32(42).fork(),n=0;n<e.int32Data.length;++n)t.int32(e.int32Data[n]);t.ldelim()}if(null!=e.stringData&&e.stringData.length)for(n=0;n<e.stringData.length;++n)t.uint32(50).bytes(e.stringData[n]);if(null!=e.int64Data&&e.int64Data.length){for(t.uint32(58).fork(),n=0;n<e.int64Data.length;++n)t.int64(e.int64Data[n]);t.ldelim()}if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(66).string(e.name),null!=e.rawData&&Object.hasOwnProperty.call(e,"rawData")&&t.uint32(74).bytes(e.rawData),null!=e.doubleData&&e.doubleData.length){for(t.uint32(82).fork(),n=0;n<e.doubleData.length;++n)t.double(e.doubleData[n]);t.ldelim()}if(null!=e.uint64Data&&e.uint64Data.length){for(t.uint32(90).fork(),n=0;n<e.uint64Data.length;++n)t.uint64(e.uint64Data[n]);t.ldelim()}if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(98).string(e.docString),null!=e.externalData&&e.externalData.length)for(n=0;n<e.externalData.length;++n)a.onnx.StringStringEntryProto.encode(e.externalData[n],t.uint32(106).fork()).ldelim();return null!=e.dataLocation&&Object.hasOwnProperty.call(e,"dataLocation")&&t.uint32(112).int32(e.dataLocation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:if(i.dims&&i.dims.length||(i.dims=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.dims.push(e.int64());else i.dims.push(e.int64());break;case 2:i.dataType=e.int32();break;case 3:i.segment=a.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(i.floatData&&i.floatData.length||(i.floatData=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.floatData.push(e.float());else i.floatData.push(e.float());break;case 5:if(i.int32Data&&i.int32Data.length||(i.int32Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.int32Data.push(e.int32());else i.int32Data.push(e.int32());break;case 6:i.stringData&&i.stringData.length||(i.stringData=[]),i.stringData.push(e.bytes());break;case 7:if(i.int64Data&&i.int64Data.length||(i.int64Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.int64Data.push(e.int64());else i.int64Data.push(e.int64());break;case 8:i.name=e.string();break;case 12:i.docString=e.string();break;case 9:i.rawData=e.bytes();break;case 13:i.externalData&&i.externalData.length||(i.externalData=[]),i.externalData.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:i.dataLocation=e.int32();break;case 10:if(i.doubleData&&i.doubleData.length||(i.doubleData=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.doubleData.push(e.double());else i.doubleData.push(e.double());break;case 11:if(i.uint64Data&&i.uint64Data.length||(i.uint64Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.uint64Data.push(e.uint64());else i.uint64Data.push(e.uint64());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var t=0;t<e.dims.length;++t)if(!(o.isInteger(e.dims[t])||e.dims[t]&&o.isInteger(e.dims[t].low)&&o.isInteger(e.dims[t].high)))return"dims: integer|Long[] expected"}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&!o.isInteger(e.dataType))return"dataType: integer expected";if(null!=e.segment&&e.hasOwnProperty("segment")&&(n=a.onnx.TensorProto.Segment.verify(e.segment)))return"segment."+n;if(null!=e.floatData&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(t=0;t<e.floatData.length;++t)if("number"!=typeof e.floatData[t])return"floatData: number[] expected"}if(null!=e.int32Data&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(t=0;t<e.int32Data.length;++t)if(!o.isInteger(e.int32Data[t]))return"int32Data: integer[] expected"}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(t=0;t<e.stringData.length;++t)if(!(e.stringData[t]&&"number"==typeof e.stringData[t].length||o.isString(e.stringData[t])))return"stringData: buffer[] expected"}if(null!=e.int64Data&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(t=0;t<e.int64Data.length;++t)if(!(o.isInteger(e.int64Data[t])||e.int64Data[t]&&o.isInteger(e.int64Data[t].low)&&o.isInteger(e.int64Data[t].high)))return"int64Data: integer|Long[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.rawData&&e.hasOwnProperty("rawData")&&!(e.rawData&&"number"==typeof e.rawData.length||o.isString(e.rawData)))return"rawData: buffer expected";if(null!=e.externalData&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(t=0;t<e.externalData.length;++t){var n;if(n=a.onnx.StringStringEntryProto.verify(e.externalData[t]))return"externalData."+n}}if(null!=e.dataLocation&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(null!=e.doubleData&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(t=0;t<e.doubleData.length;++t)if("number"!=typeof e.doubleData[t])return"doubleData: number[] expected"}if(null!=e.uint64Data&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(t=0;t<e.uint64Data.length;++t)if(!(o.isInteger(e.uint64Data[t])||e.uint64Data[t]&&o.isInteger(e.uint64Data[t].low)&&o.isInteger(e.uint64Data[t].high)))return"uint64Data: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof a.onnx.TensorProto)return e;var t=new a.onnx.TensorProto;if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");t.dims=[];for(var n=0;n<e.dims.length;++n)o.Long?(t.dims[n]=o.Long.fromValue(e.dims[n])).unsigned=!1:"string"==typeof e.dims[n]?t.dims[n]=parseInt(e.dims[n],10):"number"==typeof e.dims[n]?t.dims[n]=e.dims[n]:"object"==_typeof(e.dims[n])&&(t.dims[n]=new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber())}if(null!=e.dataType&&(t.dataType=0|e.dataType),null!=e.segment){if("object"!=_typeof(e.segment))throw TypeError(".onnx.TensorProto.segment: object expected");t.segment=a.onnx.TensorProto.Segment.fromObject(e.segment)}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(t.floatData=[],n=0;n<e.floatData.length;++n)t.floatData[n]=Number(e.floatData[n])}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(t.int32Data=[],n=0;n<e.int32Data.length;++n)t.int32Data[n]=0|e.int32Data[n]}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(t.stringData=[],n=0;n<e.stringData.length;++n)"string"==typeof e.stringData[n]?o.base64.decode(e.stringData[n],t.stringData[n]=o.newBuffer(o.base64.length(e.stringData[n])),0):e.stringData[n].length>=0&&(t.stringData[n]=e.stringData[n])}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(t.int64Data=[],n=0;n<e.int64Data.length;++n)o.Long?(t.int64Data[n]=o.Long.fromValue(e.int64Data[n])).unsigned=!1:"string"==typeof e.int64Data[n]?t.int64Data[n]=parseInt(e.int64Data[n],10):"number"==typeof e.int64Data[n]?t.int64Data[n]=e.int64Data[n]:"object"==_typeof(e.int64Data[n])&&(t.int64Data[n]=new o.LongBits(e.int64Data[n].low>>>0,e.int64Data[n].high>>>0).toNumber())}if(null!=e.name&&(t.name=String(e.name)),null!=e.docString&&(t.docString=String(e.docString)),null!=e.rawData&&("string"==typeof e.rawData?o.base64.decode(e.rawData,t.rawData=o.newBuffer(o.base64.length(e.rawData)),0):e.rawData.length>=0&&(t.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(t.externalData=[],n=0;n<e.externalData.length;++n){if("object"!=_typeof(e.externalData[n]))throw TypeError(".onnx.TensorProto.externalData: object expected");t.externalData[n]=a.onnx.StringStringEntryProto.fromObject(e.externalData[n])}}switch(e.dataLocation){default:if("number"==typeof e.dataLocation){t.dataLocation=e.dataLocation;break}break;case"DEFAULT":case 0:t.dataLocation=0;break;case"EXTERNAL":case 1:t.dataLocation=1}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(t.doubleData=[],n=0;n<e.doubleData.length;++n)t.doubleData[n]=Number(e.doubleData[n])}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(t.uint64Data=[],n=0;n<e.uint64Data.length;++n)o.Long?(t.uint64Data[n]=o.Long.fromValue(e.uint64Data[n])).unsigned=!0:"string"==typeof e.uint64Data[n]?t.uint64Data[n]=parseInt(e.uint64Data[n],10):"number"==typeof e.uint64Data[n]?t.uint64Data[n]=e.uint64Data[n]:"object"==_typeof(e.uint64Data[n])&&(t.uint64Data[n]=new o.LongBits(e.uint64Data[n].low>>>0,e.uint64Data[n].high>>>0).toNumber(!0))}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.dims=[],n.floatData=[],n.int32Data=[],n.stringData=[],n.int64Data=[],n.doubleData=[],n.uint64Data=[],n.externalData=[]),t.defaults&&(n.dataType=0,n.segment=null,n.name="",t.bytes===String?n.rawData="":(n.rawData=[],t.bytes!==Array&&(n.rawData=o.newBuffer(n.rawData))),n.docString="",n.dataLocation=t.enums===String?"DEFAULT":0),e.dims&&e.dims.length){n.dims=[];for(var r=0;r<e.dims.length;++r)"number"==typeof e.dims[r]?n.dims[r]=t.longs===String?String(e.dims[r]):e.dims[r]:n.dims[r]=t.longs===String?o.Long.prototype.toString.call(e.dims[r]):t.longs===Number?new o.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber():e.dims[r]}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&(n.dataType=e.dataType),null!=e.segment&&e.hasOwnProperty("segment")&&(n.segment=a.onnx.TensorProto.Segment.toObject(e.segment,t)),e.floatData&&e.floatData.length)for(n.floatData=[],r=0;r<e.floatData.length;++r)n.floatData[r]=t.json&&!isFinite(e.floatData[r])?String(e.floatData[r]):e.floatData[r];if(e.int32Data&&e.int32Data.length)for(n.int32Data=[],r=0;r<e.int32Data.length;++r)n.int32Data[r]=e.int32Data[r];if(e.stringData&&e.stringData.length)for(n.stringData=[],r=0;r<e.stringData.length;++r)n.stringData[r]=t.bytes===String?o.base64.encode(e.stringData[r],0,e.stringData[r].length):t.bytes===Array?Array.prototype.slice.call(e.stringData[r]):e.stringData[r];if(e.int64Data&&e.int64Data.length)for(n.int64Data=[],r=0;r<e.int64Data.length;++r)"number"==typeof e.int64Data[r]?n.int64Data[r]=t.longs===String?String(e.int64Data[r]):e.int64Data[r]:n.int64Data[r]=t.longs===String?o.Long.prototype.toString.call(e.int64Data[r]):t.longs===Number?new o.LongBits(e.int64Data[r].low>>>0,e.int64Data[r].high>>>0).toNumber():e.int64Data[r];if(null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.rawData&&e.hasOwnProperty("rawData")&&(n.rawData=t.bytes===String?o.base64.encode(e.rawData,0,e.rawData.length):t.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length)for(n.doubleData=[],r=0;r<e.doubleData.length;++r)n.doubleData[r]=t.json&&!isFinite(e.doubleData[r])?String(e.doubleData[r]):e.doubleData[r];if(e.uint64Data&&e.uint64Data.length)for(n.uint64Data=[],r=0;r<e.uint64Data.length;++r)"number"==typeof e.uint64Data[r]?n.uint64Data[r]=t.longs===String?String(e.uint64Data[r]):e.uint64Data[r]:n.uint64Data[r]=t.longs===String?o.Long.prototype.toString.call(e.uint64Data[r]):t.longs===Number?new o.LongBits(e.uint64Data[r].low>>>0,e.uint64Data[r].high>>>0).toNumber(!0):e.uint64Data[r];if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),e.externalData&&e.externalData.length)for(n.externalData=[],r=0;r<e.externalData.length;++r)n.externalData[r]=a.onnx.StringStringEntryProto.toObject(e.externalData[r],t);return null!=e.dataLocation&&e.hasOwnProperty("dataLocation")&&(n.dataLocation=t.enums===String?void 0===a.onnx.TensorProto.DataLocation[e.dataLocation]?e.dataLocation:a.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto"},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="UINT8"]=2,t[e[3]="INT8"]=3,t[e[4]="UINT16"]=4,t[e[5]="INT16"]=5,t[e[6]="INT32"]=6,t[e[7]="INT64"]=7,t[e[8]="STRING"]=8,t[e[9]="BOOL"]=9,t[e[10]="FLOAT16"]=10,t[e[11]="DOUBLE"]=11,t[e[12]="UINT32"]=12,t[e[13]="UINT64"]=13,t[e[14]="COMPLEX64"]=14,t[e[15]="COMPLEX128"]=15,t[e[16]="BFLOAT16"]=16,t[e[17]="FLOAT8E4M3FN"]=17,t[e[18]="FLOAT8E4M3FNUZ"]=18,t[e[19]="FLOAT8E5M2"]=19,t[e[20]="FLOAT8E5M2FNUZ"]=20,t}(),e.Segment=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.begin=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.end=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.begin&&Object.hasOwnProperty.call(e,"begin")&&t.uint32(8).int64(e.begin),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int64(e.end),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorProto.Segment;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.begin=e.int64();break;case 2:i.end=e.int64();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null==e.begin||!e.hasOwnProperty("begin")||o.isInteger(e.begin)||e.begin&&o.isInteger(e.begin.low)&&o.isInteger(e.begin.high)?null==e.end||!e.hasOwnProperty("end")||o.isInteger(e.end)||e.end&&o.isInteger(e.end.low)&&o.isInteger(e.end.high)?null:"end: integer|Long expected":"begin: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.onnx.TensorProto.Segment)return e;var t=new a.onnx.TensorProto.Segment;return null!=e.begin&&(o.Long?(t.begin=o.Long.fromValue(e.begin)).unsigned=!1:"string"==typeof e.begin?t.begin=parseInt(e.begin,10):"number"==typeof e.begin?t.begin=e.begin:"object"==_typeof(e.begin)&&(t.begin=new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber())),null!=e.end&&(o.Long?(t.end=o.Long.fromValue(e.end)).unsigned=!1:"string"==typeof e.end?t.end=parseInt(e.end,10):"number"==typeof e.end?t.end=e.end:"object"==_typeof(e.end)&&(t.end=new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(o.Long){var r=new o.Long(0,0,!1);n.begin=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.begin=t.longs===String?"0":0;o.Long?(r=new o.Long(0,0,!1),n.end=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.end=t.longs===String?"0":0}return null!=e.begin&&e.hasOwnProperty("begin")&&("number"==typeof e.begin?n.begin=t.longs===String?String(e.begin):e.begin:n.begin=t.longs===String?o.Long.prototype.toString.call(e.begin):t.longs===Number?new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber():e.begin),null!=e.end&&e.hasOwnProperty("end")&&("number"==typeof e.end?n.end=t.longs===String?String(e.end):e.end:n.end=t.longs===String?o.Long.prototype.toString.call(e.end):t.longs===Number?new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber():e.end),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto.Segment"},e}(),e.DataLocation=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="EXTERNAL"]=1,t}(),e}(),s.SparseTensorProto=function(){function e(e){if(this.dims=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.values=null,e.prototype.indices=null,e.prototype.dims=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.values&&Object.hasOwnProperty.call(e,"values")&&a.onnx.TensorProto.encode(e.values,t.uint32(10).fork()).ldelim(),null!=e.indices&&Object.hasOwnProperty.call(e,"indices")&&a.onnx.TensorProto.encode(e.indices,t.uint32(18).fork()).ldelim(),null!=e.dims&&e.dims.length){t.uint32(26).fork();for(var n=0;n<e.dims.length;++n)t.int64(e.dims[n]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.SparseTensorProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.values=a.onnx.TensorProto.decode(e,e.uint32());break;case 2:i.indices=a.onnx.TensorProto.decode(e,e.uint32());break;case 3:if(i.dims&&i.dims.length||(i.dims=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.dims.push(e.int64());else i.dims.push(e.int64());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";var t;if(null!=e.values&&e.hasOwnProperty("values")&&(t=a.onnx.TensorProto.verify(e.values)))return"values."+t;if(null!=e.indices&&e.hasOwnProperty("indices")&&(t=a.onnx.TensorProto.verify(e.indices)))return"indices."+t;if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var n=0;n<e.dims.length;++n)if(!(o.isInteger(e.dims[n])||e.dims[n]&&o.isInteger(e.dims[n].low)&&o.isInteger(e.dims[n].high)))return"dims: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof a.onnx.SparseTensorProto)return e;var t=new a.onnx.SparseTensorProto;if(null!=e.values){if("object"!=_typeof(e.values))throw TypeError(".onnx.SparseTensorProto.values: object expected");t.values=a.onnx.TensorProto.fromObject(e.values)}if(null!=e.indices){if("object"!=_typeof(e.indices))throw TypeError(".onnx.SparseTensorProto.indices: object expected");t.indices=a.onnx.TensorProto.fromObject(e.indices)}if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");t.dims=[];for(var n=0;n<e.dims.length;++n)o.Long?(t.dims[n]=o.Long.fromValue(e.dims[n])).unsigned=!1:"string"==typeof e.dims[n]?t.dims[n]=parseInt(e.dims[n],10):"number"==typeof e.dims[n]?t.dims[n]=e.dims[n]:"object"==_typeof(e.dims[n])&&(t.dims[n]=new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber())}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.dims=[]),t.defaults&&(n.values=null,n.indices=null),null!=e.values&&e.hasOwnProperty("values")&&(n.values=a.onnx.TensorProto.toObject(e.values,t)),null!=e.indices&&e.hasOwnProperty("indices")&&(n.indices=a.onnx.TensorProto.toObject(e.indices,t)),e.dims&&e.dims.length){n.dims=[];for(var r=0;r<e.dims.length;++r)"number"==typeof e.dims[r]?n.dims[r]=t.longs===String?String(e.dims[r]):e.dims[r]:n.dims[r]=t.longs===String?o.Long.prototype.toString.call(e.dims[r]):t.longs===Number?new o.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber():e.dims[r]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.SparseTensorProto"},e}(),s.TensorShapeProto=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dim=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.dim&&e.dim.length)for(var n=0;n<e.dim.length;++n)a.onnx.TensorShapeProto.Dimension.encode(e.dim[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorShapeProto;e.pos<n;){var o=e.uint32();o>>>3==1?(i.dim&&i.dim.length||(i.dim=[]),i.dim.push(a.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()))):e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.dim&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var t=0;t<e.dim.length;++t){var n=a.onnx.TensorShapeProto.Dimension.verify(e.dim[t]);if(n)return"dim."+n}}return null},e.fromObject=function(e){if(e instanceof a.onnx.TensorShapeProto)return e;var t=new a.onnx.TensorShapeProto;if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");t.dim=[];for(var n=0;n<e.dim.length;++n){if("object"!=_typeof(e.dim[n]))throw TypeError(".onnx.TensorShapeProto.dim: object expected");t.dim[n]=a.onnx.TensorShapeProto.Dimension.fromObject(e.dim[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.dim=[]),e.dim&&e.dim.length){n.dim=[];for(var r=0;r<e.dim.length;++r)n.dim[r]=a.onnx.TensorShapeProto.Dimension.toObject(e.dim[r],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto"},e.Dimension=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.dimValue=null,e.prototype.dimParam=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:o.oneOfGetter(t=["dimValue","dimParam"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.dimValue&&Object.hasOwnProperty.call(e,"dimValue")&&t.uint32(8).int64(e.dimValue),null!=e.dimParam&&Object.hasOwnProperty.call(e,"dimParam")&&t.uint32(18).string(e.dimParam),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(26).string(e.denotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorShapeProto.Dimension;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.dimValue=e.int64();break;case 2:i.dimParam=e.string();break;case 3:i.denotation=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";var t={};if(null!=e.dimValue&&e.hasOwnProperty("dimValue")&&(t.value=1,!(o.isInteger(e.dimValue)||e.dimValue&&o.isInteger(e.dimValue.low)&&o.isInteger(e.dimValue.high))))return"dimValue: integer|Long expected";if(null!=e.dimParam&&e.hasOwnProperty("dimParam")){if(1===t.value)return"value: multiple values";if(t.value=1,!o.isString(e.dimParam))return"dimParam: string expected"}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.TensorShapeProto.Dimension)return e;var t=new a.onnx.TensorShapeProto.Dimension;return null!=e.dimValue&&(o.Long?(t.dimValue=o.Long.fromValue(e.dimValue)).unsigned=!1:"string"==typeof e.dimValue?t.dimValue=parseInt(e.dimValue,10):"number"==typeof e.dimValue?t.dimValue=e.dimValue:"object"==_typeof(e.dimValue)&&(t.dimValue=new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber())),null!=e.dimParam&&(t.dimParam=String(e.dimParam)),null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.denotation=""),null!=e.dimValue&&e.hasOwnProperty("dimValue")&&("number"==typeof e.dimValue?n.dimValue=t.longs===String?String(e.dimValue):e.dimValue:n.dimValue=t.longs===String?o.Long.prototype.toString.call(e.dimValue):t.longs===Number?new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber():e.dimValue,t.oneofs&&(n.value="dimValue")),null!=e.dimParam&&e.hasOwnProperty("dimParam")&&(n.dimParam=e.dimParam,t.oneofs&&(n.value="dimParam")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(n.denotation=e.denotation),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto.Dimension"},e}(),e}(),s.TypeProto=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.tensorType=null,e.prototype.sequenceType=null,e.prototype.mapType=null,e.prototype.optionalType=null,e.prototype.sparseTensorType=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:o.oneOfGetter(t=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.tensorType&&Object.hasOwnProperty.call(e,"tensorType")&&a.onnx.TypeProto.Tensor.encode(e.tensorType,t.uint32(10).fork()).ldelim(),null!=e.sequenceType&&Object.hasOwnProperty.call(e,"sequenceType")&&a.onnx.TypeProto.Sequence.encode(e.sequenceType,t.uint32(34).fork()).ldelim(),null!=e.mapType&&Object.hasOwnProperty.call(e,"mapType")&&a.onnx.TypeProto.Map.encode(e.mapType,t.uint32(42).fork()).ldelim(),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(50).string(e.denotation),null!=e.sparseTensorType&&Object.hasOwnProperty.call(e,"sparseTensorType")&&a.onnx.TypeProto.SparseTensor.encode(e.sparseTensorType,t.uint32(66).fork()).ldelim(),null!=e.optionalType&&Object.hasOwnProperty.call(e,"optionalType")&&a.onnx.TypeProto.Optional.encode(e.optionalType,t.uint32(74).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.tensorType=a.onnx.TypeProto.Tensor.decode(e,e.uint32());break;case 4:i.sequenceType=a.onnx.TypeProto.Sequence.decode(e,e.uint32());break;case 5:i.mapType=a.onnx.TypeProto.Map.decode(e,e.uint32());break;case 9:i.optionalType=a.onnx.TypeProto.Optional.decode(e,e.uint32());break;case 8:i.sparseTensorType=a.onnx.TypeProto.SparseTensor.decode(e,e.uint32());break;case 6:i.denotation=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";var t={};if(null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(t.value=1,n=a.onnx.TypeProto.Tensor.verify(e.tensorType)))return"tensorType."+n;if(null!=e.sequenceType&&e.hasOwnProperty("sequenceType")){if(1===t.value)return"value: multiple values";if(t.value=1,n=a.onnx.TypeProto.Sequence.verify(e.sequenceType))return"sequenceType."+n}if(null!=e.mapType&&e.hasOwnProperty("mapType")){if(1===t.value)return"value: multiple values";if(t.value=1,n=a.onnx.TypeProto.Map.verify(e.mapType))return"mapType."+n}if(null!=e.optionalType&&e.hasOwnProperty("optionalType")){if(1===t.value)return"value: multiple values";if(t.value=1,n=a.onnx.TypeProto.Optional.verify(e.optionalType))return"optionalType."+n}if(null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")){if(1===t.value)return"value: multiple values";var n;if(t.value=1,n=a.onnx.TypeProto.SparseTensor.verify(e.sparseTensorType))return"sparseTensorType."+n}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto)return e;var t=new a.onnx.TypeProto;if(null!=e.tensorType){if("object"!=_typeof(e.tensorType))throw TypeError(".onnx.TypeProto.tensorType: object expected");t.tensorType=a.onnx.TypeProto.Tensor.fromObject(e.tensorType)}if(null!=e.sequenceType){if("object"!=_typeof(e.sequenceType))throw TypeError(".onnx.TypeProto.sequenceType: object expected");t.sequenceType=a.onnx.TypeProto.Sequence.fromObject(e.sequenceType)}if(null!=e.mapType){if("object"!=_typeof(e.mapType))throw TypeError(".onnx.TypeProto.mapType: object expected");t.mapType=a.onnx.TypeProto.Map.fromObject(e.mapType)}if(null!=e.optionalType){if("object"!=_typeof(e.optionalType))throw TypeError(".onnx.TypeProto.optionalType: object expected");t.optionalType=a.onnx.TypeProto.Optional.fromObject(e.optionalType)}if(null!=e.sparseTensorType){if("object"!=_typeof(e.sparseTensorType))throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");t.sparseTensorType=a.onnx.TypeProto.SparseTensor.fromObject(e.sparseTensorType)}return null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.denotation=""),null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(n.tensorType=a.onnx.TypeProto.Tensor.toObject(e.tensorType,t),t.oneofs&&(n.value="tensorType")),null!=e.sequenceType&&e.hasOwnProperty("sequenceType")&&(n.sequenceType=a.onnx.TypeProto.Sequence.toObject(e.sequenceType,t),t.oneofs&&(n.value="sequenceType")),null!=e.mapType&&e.hasOwnProperty("mapType")&&(n.mapType=a.onnx.TypeProto.Map.toObject(e.mapType,t),t.oneofs&&(n.value="mapType")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(n.denotation=e.denotation),null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")&&(n.sparseTensorType=a.onnx.TypeProto.SparseTensor.toObject(e.sparseTensorType,t),t.oneofs&&(n.value="sparseTensorType")),null!=e.optionalType&&e.hasOwnProperty("optionalType")&&(n.optionalType=a.onnx.TypeProto.Optional.toObject(e.optionalType,t),t.oneofs&&(n.value="optionalType")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto"},e.Tensor=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&a.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Tensor;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.elemType=e.int32();break;case 2:i.shape=a.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=a.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Tensor)return e;var t=new a.onnx.TypeProto.Tensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=_typeof(e.shape))throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");t.shape=a.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=0,n.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(n.shape=a.onnx.TensorShapeProto.toObject(e.shape,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Tensor"},e}(),e.Sequence=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&a.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Sequence;e.pos<n;){var o=e.uint32();o>>>3==1?i.elemType=a.onnx.TypeProto.decode(e,e.uint32()):e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=a.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Sequence)return e;var t=new a.onnx.TypeProto.Sequence;if(null!=e.elemType){if("object"!=_typeof(e.elemType))throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");t.elemType=a.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=a.onnx.TypeProto.toObject(e.elemType,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Sequence"},e}(),e.Map=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.keyType=0,e.prototype.valueType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.keyType&&Object.hasOwnProperty.call(e,"keyType")&&t.uint32(8).int32(e.keyType),null!=e.valueType&&Object.hasOwnProperty.call(e,"valueType")&&a.onnx.TypeProto.encode(e.valueType,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Map;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.keyType=e.int32();break;case 2:i.valueType=a.onnx.TypeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.keyType&&e.hasOwnProperty("keyType")&&!o.isInteger(e.keyType))return"keyType: integer expected";if(null!=e.valueType&&e.hasOwnProperty("valueType")){var t=a.onnx.TypeProto.verify(e.valueType);if(t)return"valueType."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Map)return e;var t=new a.onnx.TypeProto.Map;if(null!=e.keyType&&(t.keyType=0|e.keyType),null!=e.valueType){if("object"!=_typeof(e.valueType))throw TypeError(".onnx.TypeProto.Map.valueType: object expected");t.valueType=a.onnx.TypeProto.fromObject(e.valueType)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.keyType=0,n.valueType=null),null!=e.keyType&&e.hasOwnProperty("keyType")&&(n.keyType=e.keyType),null!=e.valueType&&e.hasOwnProperty("valueType")&&(n.valueType=a.onnx.TypeProto.toObject(e.valueType,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Map"},e}(),e.Optional=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&a.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Optional;e.pos<n;){var o=e.uint32();o>>>3==1?i.elemType=a.onnx.TypeProto.decode(e,e.uint32()):e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=a.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Optional)return e;var t=new a.onnx.TypeProto.Optional;if(null!=e.elemType){if("object"!=_typeof(e.elemType))throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");t.elemType=a.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=a.onnx.TypeProto.toObject(e.elemType,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Optional"},e}(),e.SparseTensor=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&a.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.SparseTensor;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.elemType=e.int32();break;case 2:i.shape=a.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=a.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.SparseTensor)return e;var t=new a.onnx.TypeProto.SparseTensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=_typeof(e.shape))throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");t.shape=a.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.elemType=0,n.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(n.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(n.shape=a.onnx.TensorShapeProto.toObject(e.shape,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.SparseTensor"},e}(),e}(),s.OperatorSetIdProto=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.domain="",e.prototype.version=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(10).string(e.domain),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.OperatorSetIdProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.domain=e.string();break;case 2:i.version=e.int64();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null==e.version||!e.hasOwnProperty("version")||o.isInteger(e.version)||e.version&&o.isInteger(e.version.low)&&o.isInteger(e.version.high)?null:"version: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.onnx.OperatorSetIdProto)return e;var t=new a.onnx.OperatorSetIdProto;return null!=e.domain&&(t.domain=String(e.domain)),null!=e.version&&(o.Long?(t.version=o.Long.fromValue(e.version)).unsigned=!1:"string"==typeof e.version?t.version=parseInt(e.version,10):"number"==typeof e.version?t.version=e.version:"object"==_typeof(e.version)&&(t.version=new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.domain="",o.Long){var r=new o.Long(0,0,!1);n.version=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.version=t.longs===String?"0":0;return null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),null!=e.version&&e.hasOwnProperty("version")&&("number"==typeof e.version?n.version=t.longs===String?String(e.version):e.version:n.version=t.longs===String?o.Long.prototype.toString.call(e.version):t.longs===Number?new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.OperatorSetIdProto"},e}(),s.OperatorStatus=function(){var e={},t=Object.create(e);return t[e[0]="EXPERIMENTAL"]=0,t[e[1]="STABLE"]=1,t}(),s.FunctionProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.attribute=o.emptyArray,e.prototype.attributeProto=o.emptyArray,e.prototype.node=o.emptyArray,e.prototype.docString="",e.prototype.opsetImport=o.emptyArray,e.prototype.domain="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.input&&e.input.length)for(var n=0;n<e.input.length;++n)t.uint32(34).string(e.input[n]);if(null!=e.output&&e.output.length)for(n=0;n<e.output.length;++n)t.uint32(42).string(e.output[n]);if(null!=e.attribute&&e.attribute.length)for(n=0;n<e.attribute.length;++n)t.uint32(50).string(e.attribute[n]);if(null!=e.node&&e.node.length)for(n=0;n<e.node.length;++n)a.onnx.NodeProto.encode(e.node[n],t.uint32(58).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(66).string(e.docString),null!=e.opsetImport&&e.opsetImport.length)for(n=0;n<e.opsetImport.length;++n)a.onnx.OperatorSetIdProto.encode(e.opsetImport[n],t.uint32(74).fork()).ldelim();if(null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(82).string(e.domain),null!=e.attributeProto&&e.attributeProto.length)for(n=0;n<e.attributeProto.length;++n)a.onnx.AttributeProto.encode(e.attributeProto[n],t.uint32(90).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new a.onnx.FunctionProto;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 4:i.input&&i.input.length||(i.input=[]),i.input.push(e.string());break;case 5:i.output&&i.output.length||(i.output=[]),i.output.push(e.string());break;case 6:i.attribute&&i.attribute.length||(i.attribute=[]),i.attribute.push(e.string());break;case 11:i.attributeProto&&i.attributeProto.length||(i.attributeProto=[]),i.attributeProto.push(a.onnx.AttributeProto.decode(e,e.uint32()));break;case 7:i.node&&i.node.length||(i.node=[]),i.node.push(a.onnx.NodeProto.decode(e,e.uint32()));break;case 8:i.docString=e.string();break;case 9:i.opsetImport&&i.opsetImport.length||(i.opsetImport=[]),i.opsetImport.push(a.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 10:i.domain=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected"}if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t)if(!o.isString(e.attribute[t]))return"attribute: string[] expected"}if(null!=e.attributeProto&&e.hasOwnProperty("attributeProto")){if(!Array.isArray(e.attributeProto))return"attributeProto: array expected";for(t=0;t<e.attributeProto.length;++t)if(n=a.onnx.AttributeProto.verify(e.attributeProto[t]))return"attributeProto."+n}if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(t=0;t<e.node.length;++t)if(n=a.onnx.NodeProto.verify(e.node[t]))return"node."+n}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(t=0;t<e.opsetImport.length;++t){var n;if(n=a.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+n}}return null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null},e.fromObject=function(e){if(e instanceof a.onnx.FunctionProto)return e;var t=new a.onnx.FunctionProto;if(null!=e.name&&(t.name=String(e.name)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.FunctionProto.input: array expected");t.input=[];for(var n=0;n<e.input.length;++n)t.input[n]=String(e.input[n])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.FunctionProto.output: array expected");for(t.output=[],n=0;n<e.output.length;++n)t.output[n]=String(e.output[n])}if(e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");for(t.attribute=[],n=0;n<e.attribute.length;++n)t.attribute[n]=String(e.attribute[n])}if(e.attributeProto){if(!Array.isArray(e.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");for(t.attributeProto=[],n=0;n<e.attributeProto.length;++n){if("object"!=_typeof(e.attributeProto[n]))throw TypeError(".onnx.FunctionProto.attributeProto: object expected");t.attributeProto[n]=a.onnx.AttributeProto.fromObject(e.attributeProto[n])}}if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.FunctionProto.node: array expected");for(t.node=[],n=0;n<e.node.length;++n){if("object"!=_typeof(e.node[n]))throw TypeError(".onnx.FunctionProto.node: object expected");t.node[n]=a.onnx.NodeProto.fromObject(e.node[n])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");for(t.opsetImport=[],n=0;n<e.opsetImport.length;++n){if("object"!=_typeof(e.opsetImport[n]))throw TypeError(".onnx.FunctionProto.opsetImport: object expected");t.opsetImport[n]=a.onnx.OperatorSetIdProto.fromObject(e.opsetImport[n])}}return null!=e.domain&&(t.domain=String(e.domain)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.input=[],n.output=[],n.attribute=[],n.node=[],n.opsetImport=[],n.attributeProto=[]),t.defaults&&(n.name="",n.docString="",n.domain=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),e.input&&e.input.length){n.input=[];for(var r=0;r<e.input.length;++r)n.input[r]=e.input[r]}if(e.output&&e.output.length)for(n.output=[],r=0;r<e.output.length;++r)n.output[r]=e.output[r];if(e.attribute&&e.attribute.length)for(n.attribute=[],r=0;r<e.attribute.length;++r)n.attribute[r]=e.attribute[r];if(e.node&&e.node.length)for(n.node=[],r=0;r<e.node.length;++r)n.node[r]=a.onnx.NodeProto.toObject(e.node[r],t);if(null!=e.docString&&e.hasOwnProperty("docString")&&(n.docString=e.docString),e.opsetImport&&e.opsetImport.length)for(n.opsetImport=[],r=0;r<e.opsetImport.length;++r)n.opsetImport[r]=a.onnx.OperatorSetIdProto.toObject(e.opsetImport[r],t);if(null!=e.domain&&e.hasOwnProperty("domain")&&(n.domain=e.domain),e.attributeProto&&e.attributeProto.length)for(n.attributeProto=[],r=0;r<e.attributeProto.length;++r)n.attributeProto[r]=a.onnx.AttributeProto.toObject(e.attributeProto[r],t);return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.FunctionProto"},e}(),s}(),t.exports=a}));function zr(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function dn(e){return(new TextDecoder).decode(e)}var we,Tr,Ti,Ke,ro,Ve,ot,z,pn,xr,wr,vr,fe=L((function(){Jn(),ii(),we=Nr(Ur()),_r(),Tr=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"arraysEqual",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}}]),e}(),Ti=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"preprocessInputShapes",value:function(e,t){return[1===e.length?[1,e[0]]:e,1===t.length?[t[0],1]:t]}},{key:"postprocessOutputShape",value:function(e,t,n){1===t&&e.splice(e.length-2,1),1===n&&e.pop()}},{key:"calcMatMulShape",value:function(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}}]),e}(),Ke=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"calcShape",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.length,i=t.length;if(0===r)return t;if(0===i)return e;var o=Math.max(e.length,t.length),a=new Array(o);if(n){if(r<2||i<2)return;var s=Ti.calcMatMulShape([e[r-2],e[r-1]],[t[i-2],t[i-1]]);if(void 0===s)return;var u=_slicedToArray(s,2);a[o-2]=u[0],a[o-1]=u[1]}for(var c=n?3:1;c<=o;c++){var l=r-c<0?1:e[r-c],h=i-c<0?1:t[i-c];if(l!==h&&l>1&&h>1)return;a[o-c]=Math.max(l,h)}return a}},{key:"index",value:function(t,n){var r=new Array(n.length);return e.fillIndex(t,n,r),r}},{key:"fillIndex",value:function(e,t,n){for(var r=e.length-t.length,i=0;i<t.length;i++)n[i]=e[r+i]%t[i]}},{key:"calc",value:function(t,n,r,i,o){var a=e.calcShape(t.dims,n.dims);if(a){if(i&&!z.areEqual(a,t.dims))return;var s=z.size(a),u=i?t:new Ce(a,o||t.type);if(0===a.length)u.set([],r(t.get([]),n.get([])));else{var c,l=new Array(a.length),h=new Array(t.dims.length),f=new Array(n.dims.length),d=0,p=0,y=!1,g=!1;0===t.dims.length&&(d=t.get([]),y=!0),0===n.dims.length&&(p=n.get([]),g=!0);for(var m=0;m<s;m++){c=m;for(var v=a.length-1;v>=0;v--)l[v]=c%a[v],c=Math.floor(c/a[v]);y||(e.fillIndex(l,t.dims,h),d=t.get(h)),g||(e.fillIndex(l,n.dims,f),p=n.get(f)),u.set(l,r(d,p))}}return u}}},{key:"isValidBroadcast",value:function(e,t){var n=e.length,r=t.length;if(n>r)return!1;for(var i=1;i<=n;i++)if(1!==e[n-i]&&e[n-i]!==t[r-i])return!1;return!0}},{key:"getBroadcastDims",value:function(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var o=n-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&r.unshift(o)}return r}}]),e}(),ro=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getShapeOfGemmResult",value:function(e,t,n,r,i){if(2!==e.length||2!==n.length)throw new Error("shape need to be of size 2");var o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);var u=-1;if(r?(s=n[0],u=1):(s=n[1],u=0),n[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!Ke.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]}}]),e}(),Ve=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"tensorDataTypeFromProto",value:function(e){switch(e){case we.onnx.TensorProto.DataType.INT8:return"int8";case we.onnx.TensorProto.DataType.UINT8:return"uint8";case we.onnx.TensorProto.DataType.BOOL:return"bool";case we.onnx.TensorProto.DataType.INT16:return"int16";case we.onnx.TensorProto.DataType.UINT16:return"uint16";case we.onnx.TensorProto.DataType.INT32:return"int32";case we.onnx.TensorProto.DataType.UINT32:return"uint32";case we.onnx.TensorProto.DataType.FLOAT:return"float32";case we.onnx.TensorProto.DataType.DOUBLE:return"float64";case we.onnx.TensorProto.DataType.STRING:return"string";case we.onnx.TensorProto.DataType.INT64:return"int32";case we.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error("unsupported data type: ".concat(we.onnx.TensorProto.DataType[e]))}}},{key:"tensorDataTypeStringToEnum",value:function(e){switch(e){case"int8":return we.onnx.TensorProto.DataType.INT8;case"uint8":return we.onnx.TensorProto.DataType.UINT8;case"bool":return we.onnx.TensorProto.DataType.BOOL;case"int16":return we.onnx.TensorProto.DataType.INT16;case"uint16":return we.onnx.TensorProto.DataType.UINT16;case"int32":return we.onnx.TensorProto.DataType.INT32;case"uint32":return we.onnx.TensorProto.DataType.UINT32;case"float32":return we.onnx.TensorProto.DataType.FLOAT;case"float64":return we.onnx.TensorProto.DataType.DOUBLE;case"string":return we.onnx.TensorProto.DataType.STRING;case"int64":return we.onnx.TensorProto.DataType.INT64;case"uint64":return we.onnx.TensorProto.DataType.UINT64;default:throw new Error("unsupported data type: ".concat(e))}}},{key:"tensorDimsFromProto",value:function(e){return e.map((function(e){return jt.isLong(e)?e.toNumber():e}))}},{key:"tensorValueTypeFromProto",value:function(t){return{tensorType:e.tensorDataTypeFromProto(t.elemType),shape:{dims:e.tensorDimsFromProto(t.shape.dim.map((function(e){return e.dimValue})))}}}},{key:"tensorDimsFromORTFormat",value:function(e){for(var t=[],n=0;n<e.dimsLength();n++)t.push(ot.longToNumber(e.dims(n)));return t}},{key:"tensorAttributesFromORTFormat",value:function(e){for(var t=[],n=0;n<e.attributesLength();n++)t.push(e.attributes(n));return t}}]),e}(),ot=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"longToNumber",value:function(e,t){return jt.isLong(e)?e.toNumber():e instanceof O.Long?jt.fromValue({low:e.low,high:e.high,unsigned:null!==t&&void 0!==t&&t}).toNumber():e}},{key:"isLong",value:function(e){return jt.isLong(e)||e instanceof O.Long}}]),e}(),z=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"size",value:function(t){return e.getSizeFromDimensionRange(t,0,t.length)}},{key:"sizeFromDimension",value:function(t,n){if(n<0||n>t.length)throw new Error("invalid dimension of ".concat(n," for sizeFromDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,n,t.length)}},{key:"sizeToDimension",value:function(t,n){if(n<0||n>t.length)throw new Error("invalid dimension of ".concat(n," for sizeToDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,0,n)}},{key:"getSizeFromDimensionRange",value:function(e,t,n){for(var r=1,i=t;i<n;i++){if(e[i]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");r*=e[i]}return r}},{key:"computeStrides",value:function(e){var t=e.length;if(0===t)return[];if(1===t)return[1];var n=new Array(t);n[t-1]=1,n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}},{key:"transpose",value:function(e){return e.slice().reverse()}},{key:"indicesToOffset",value:function(e,t,n){void 0===n&&(n=e.length);for(var r=0,i=0;i<n;++i)r+=t[i]*e[i];return r}},{key:"offsetToIndices",value:function(e,t){var n=t.length;if(0===n)return[];if(1===n)return[e*t[0]];for(var r=new Array(t.length),i=0;i<r.length-1;++i)r[i]=Math.floor(e/t[i]),e-=r[i]*t[i];return r[r.length-1]=e,r}},{key:"normalizeAxis",value:function(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}},{key:"normalizeAxes",value:function(e,t){var n=this;return e.map((function(e){return n.normalizeAxis(e,t)}))}},{key:"incrementIndex",value:function(e,t,n){if(0===t.length||0===e.length)throw new Error("Index incrementing unsupported for scalar Tensor");if(void 0===n)n=t.length;else if(n<=0||n>t.length)throw new Error("Incorrect axis to increment on");for(var r=n-1;r>=0&&(e[r]++,!(e[r]<t[r]));--r)e[r]=0}},{key:"calculateReshapedDims",value:function(t,n){if(0===n.length){if(0===t.length||1===e.size(t))return[];throw new Error("cannot reshape to a scalar Tensor")}for(var r=n.length,i=new Array(r),o=-1,a=1,s=0;s<r;s++){if(n[s]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(-1===n[s]){if(-1!==o)throw new Error("at most one dimension in shape hints can be -1");o=s}else{if(0===n[s]){if(s>=t.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");i[s]=t[s]}else i[s]=n[s];a*=i[s]}}var u=e.size(t);if(-1!==o){if(u%a!=0)throw new Error("the input tensor cannot be reshaped to the requested shape. Input shape: [".concat(t,"] Output shape: [").concat(n,"]"));i[o]=u/a}else if(a!==u)throw new Error("reshapedDims and originalDims don't have matching sizes");return i}},{key:"sortBasedOnPerm",value:function(e,t){return t?t.map((function(t){return e[t]})):e.slice().reverse()}},{key:"padShape",value:function(e,t){var n=e.length;return e.map((function(e,r){return e+t[r]+t[r+n]}))}},{key:"areEqual",value:function(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}},{key:"validateDimsAndCalcSize",value:function(e){if(e.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");var t,n=1,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!Number.isInteger(i))throw new TypeError("Invalid shape: ".concat(i," is not an integer"));if(i<0||i>2147483647)throw new TypeError("Invalid shape: length ".concat(i," is not allowed"));n*=i}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"flattenShape",value:function(e,t){t<0&&(t+=e.length);var n=e.reduce((function(e,t){return e*t}),1),r=e.slice(t).reduce((function(e,t){return e*t}),1);return[n/r,r]}},{key:"squeezeShape",value:function(t,n){var r=new Array;n=e.normalizeAxes(n,t.length);for(var i=0;i<t.length;i++){var o=n.indexOf(i)>=0;if(o&&1!==t[i])throw new Error("squeeze an axis of size different than 1");(0===n.length&&t[i]>1||n.length>0&&!o)&&r.push(t[i])}return r}},{key:"unsqueezeShape",value:function(t,n){var r=new Array(t.length+n.length);r.fill(0);for(var i=0;i<n.length;i++){var o=e.normalizeAxis(n[i],r.length);if(o>=r.length)throw new Error("'axes' has an out of range axis");if(0!==r[o])throw new Error("'axes' has a duplicate axis");r[o]=1}for(var a=0,s=0;s<r.length;s++)0===r[s]&&(r[s]=t[a++]);if(a!==t.length)throw new Error("the unsqueezed dimension could not be established");return r}}]),e}(),pn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"splitShape",value:function(t,n,r,i){if(0===r.length){if(!i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");e.determineSplit(t[n],i,r)}for(var o=[],a=[0],s=0;s<r.length;++s){0!==s&&a.push(a[s-1]+r[s-1]);var u=t.slice();u[n]=r[s],o.push(u)}return[o,a]}},{key:"determineSplit",value:function(e,t,n){if(e%t!=0)throw new Error("cannot split tensor to equal sized parts");for(var r=0;r<t;++r)n.push(e/t)}}]),e}(),xr=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"adjustPoolAttributes",value:function(e,t,n,r,i,o){if(!e&&n.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(var a=0;a<t.length-2;a++)a>=n.length?n.push(t[a+2]):n[a]=t[a+2];for(var s=0;s<n.length;s++)if(s<r.length){if(r[s]<0)throw new Error("strides should be greater than or equal to 1")}else r.push(1);for(var u=0;u<n.length;u++)if(u<i.length){if(i[u]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(var c=0;c<2*n.length;c++)if(c<o.length){if(o[c]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(var l=0;l<n.length;l++){if(n[l]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[l]>=n[l]||o[l+n.length]>=n[l])throw new Error("pads should be smaller than kernel")}}},{key:"adjustPadsBasedOnAutoPad",value:function(t,n,r,i,o,a){if(a){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(var s=0;s<t.length-2;s++)e.adjustPadAndReturnShape(t[s+2],n[s],r[s],i[s],o,s,s+t.length-2,a)}}},{key:"computePoolOutputShape",value:function(t,n,r,i,o,a,s){if(n.length<=0)throw new Error("input shape must be of size greater than 0");var u=[n[0],n[1]];return e.computeShapeHelper(t,n,u,r,i,o,a,s),u}},{key:"computeConvOutputShape",value:function(t,n,r,i,o,a,s){if(t.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");var u=[t[0],n[0]];return e.computeShapeHelper(!1,t,u,r,i,o,a,s),u}},{key:"computeShapeHelper",value:function(t,n,r,i,o,a,s,u){if(t)for(var c=0;c<n.length-2;c++)r.push(1);else for(var l=0;l<n.length-2;l++)r.push(e.adjustPadAndReturnShape(n[l+2],i[l],o[l],a[l],s,l,l+n.length-2,u))}},{key:"adjustPadAndReturnShape",value:function(e,t,n,r,i,o,a,s){var u=n*(r-1)+1;if(!s||"NOTSET"===s)return Math.floor((e+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==n)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");var c=((e+t-1)/t-1)*t+r-e;return i[o]=Math.floor("SAME_LOWER"===s?(c+1)/2:c/2),i[a]=c-i[o],Math.floor((e+c-r)/t+1);default:throw new Error("Unsupported AutoPad type")}}}]),e}(),wr=-34028234663852886e22,vr=34028234663852886e22}));function eh(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error("cannot calculate sizeof() on type ".concat(e))}}function Ru(e){switch(e){case re.onnx.TensorProto.DataType.UINT8:case re.onnx.TensorProto.DataType.INT8:case re.onnx.TensorProto.DataType.BOOL:return 1;case re.onnx.TensorProto.DataType.UINT16:case re.onnx.TensorProto.DataType.INT16:return 2;case re.onnx.TensorProto.DataType.FLOAT:case re.onnx.TensorProto.DataType.INT32:case re.onnx.TensorProto.DataType.UINT32:return 4;case re.onnx.TensorProto.DataType.INT64:case re.onnx.TensorProto.DataType.DOUBLE:case re.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error("cannot calculate sizeof() on type ".concat(re.onnx.TensorProto.DataType[e]))}}function th(e,t){return new(Uu(t))(e)}function Uu(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function wi(e,t){if(t===re.onnx.TensorProto.DataType.INT64||t===xi.TensorDataType.INT64){if(e.greaterThanOrEqual(2147483648)||e.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(t!==re.onnx.TensorProto.DataType.UINT32&&t!==xi.TensorDataType.UINT32&&t!==re.onnx.TensorProto.DataType.UINT64&&t!==xi.TensorDataType.UINT64)throw new TypeError("not a LONG type: ".concat(re.onnx.TensorProto.DataType[t]));if(e.greaterThanOrEqual(4294967296)||e.lessThan(0))throw new TypeError("uint64 is not supported")}return e.toNumber()}function Mu(e,t,n){switch(t){case re.onnx.TensorProto.DataType.BOOL:case re.onnx.TensorProto.DataType.UINT8:return e.getUint8(n);case re.onnx.TensorProto.DataType.INT8:return e.getInt8(n);case re.onnx.TensorProto.DataType.UINT16:return e.getUint16(n,!0);case re.onnx.TensorProto.DataType.INT16:return e.getInt16(n,!0);case re.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(n,!0);case re.onnx.TensorProto.DataType.INT32:return e.getInt32(n,!0);case re.onnx.TensorProto.DataType.UINT32:return e.getUint32(n,!0);case re.onnx.TensorProto.DataType.INT64:return wi(jt.fromBits(e.getUint32(n,!0),e.getUint32(n+4,!0),!1),t);case re.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(n,!0);case re.onnx.TensorProto.DataType.UINT64:return wi(jt.fromBits(e.getUint32(n,!0),e.getUint32(n+4,!0),!0),t);default:throw new Error("cannot read from DataView for type ".concat(re.onnx.TensorProto.DataType[t]))}}var Gu,re,xi,Ce,_r=L((function(){Gu=Nr(Ps()),ii(),un(),re=Nr(Ur()),fe(),xi=H.experimental.fbs,Ce=function(){function e(t,n,r,i,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Gu.Guid.create();_classCallCheck(this,e),this.dims=t,this.type=n,this.dataProvider=r,this.asyncDataProvider=i,this.cache=o,this.dataId=a,this.size=z.validateDimsAndCalcSize(t);var s=this.size,u=void 0===r&&void 0===i&&void 0===o;if(void 0!==o&&o.length!==s)throw new RangeError("Input dims doesn't match data length.");if("string"===n){if(!(void 0===o||Array.isArray(o)&&o.every((function(e){return"string"==typeof e}))))throw new TypeError("cache should be a string array");u&&(this.cache=new Array(s))}else{if(void 0!==o){var c=Uu(n);if(!(o instanceof c))throw new TypeError("cache should be type ".concat(c.name))}if(u){var l=new ArrayBuffer(s*eh(n));this.cache=th(l,n)}}}return _createClass(e,[{key:"data",get:function(){if(void 0===this.cache){var e=this.dataProvider(this.dataId);if(e.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=e}return this.cache}},{key:"stringData",get:function(){if("string"!==this.type)throw new TypeError("data type is not string");return this.data}},{key:"integerData",get:function(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}},{key:"floatData",get:function(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}},{key:"numberData",get:function(){if("string"!==this.type)return this.data;throw new TypeError("type cannot be non-number (string)")}},{key:"get",value:function(e){return this.data[z.indicesToOffset(e,this.strides)]}},{key:"set",value:function(e,t){this.data[z.indicesToOffset(e,this.strides)]=t}},{key:"getData",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=void 0===this.cache,!e.t0){e.next=5;break}return e.next=4,this.asyncDataProvider(this.dataId);case 4:this.cache=e.sent;case 5:return e.abrupt("return",this.cache);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"strides",get:function(){return this._strides||(this._strides=z.computeStrides(this.dims)),this._strides}}],[{key:"fromProto",value:function(t){if(!t)throw new Error("cannot construct Value from an empty tensor");var n=Ve.tensorDataTypeFromProto(t.dataType),r=new e(Ve.tensorDimsFromProto(t.dims),n);if("string"===n)t.stringData.forEach((function(e,t){r.data[t]=dn(e)}));else if(t.rawData&&"number"==typeof t.rawData.byteLength&&t.rawData.byteLength>0){var i=r.data,o=new DataView(t.rawData.buffer,t.rawData.byteOffset,t.rawData.byteLength),a=Ru(t.dataType),s=t.rawData.byteLength/a;if(t.rawData.byteLength%a!=0)throw new Error("invalid buffer length");if(i.length!==s)throw new Error("buffer length mismatch");for(var u=0;u<s;u++){var c=Mu(o,t.dataType,u*a);i[u]=c}}else{var l;switch(t.dataType){case re.onnx.TensorProto.DataType.FLOAT:l=t.floatData;break;case re.onnx.TensorProto.DataType.INT32:case re.onnx.TensorProto.DataType.INT16:case re.onnx.TensorProto.DataType.UINT16:case re.onnx.TensorProto.DataType.INT8:case re.onnx.TensorProto.DataType.UINT8:case re.onnx.TensorProto.DataType.BOOL:l=t.int32Data;break;case re.onnx.TensorProto.DataType.INT64:l=t.int64Data;break;case re.onnx.TensorProto.DataType.DOUBLE:l=t.doubleData;break;case re.onnx.TensorProto.DataType.UINT32:case re.onnx.TensorProto.DataType.UINT64:l=t.uint64Data;break;default:throw new Error("unspecific error")}if(null==l)throw new Error("failed to populate data from a tensorproto value");var h=r.data;if(h.length!==l.length)throw new Error("array length mismatch");for(var f=0;f<l.length;f++){var d=l[f];jt.isLong(d)?h[f]=wi(d,t.dataType):h[f]=d}}return r}},{key:"fromData",value:function(t,n,r){return new e(n,r,void 0,void 0,t)}},{key:"fromOrtTensor",value:function(t){if(!t)throw new Error("cannot construct Value from an empty tensor");var n=Ve.tensorDimsFromORTFormat(t),r=Ve.tensorDataTypeFromProto(t.dataType()),i=new e(n,r);if("string"===r)for(var o=0;o<t.stringDataLength();o++)i.data[o]=t.stringData(o);else if(t.rawDataArray()&&"number"==typeof t.rawDataLength()&&t.rawDataLength()>0){var a=i.data,s=new DataView(t.rawDataArray().buffer,t.rawDataArray().byteOffset,t.rawDataLength()),u=Ru(t.dataType()),c=t.rawDataLength()/u;if(t.rawDataLength()%u!=0)throw new Error("invalid buffer length");if(a.length!==c)throw new Error("buffer length mismatch");for(var l=0;l<c;l++){var h=Mu(s,t.dataType(),l*u);a[l]=h}}return i}}]),e}()}));function q(e){return 1===e?rh:nh}function zu(e){var t=q(e);return"".concat(t.version,"\n      precision highp float;\n      ").concat(t.attribute," vec3 position;\n      ").concat(t.attribute," vec2 textureCoord;\n\n      ").concat(t.varyingVertex," vec2 TexCoords;\n\n      void main()\n      {\n          gl_Position = vec4(position, 1.0);\n          TexCoords = textureCoord;\n      }")}function Wu(e){var t=q(e);return"".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFrag," vec2 TexCoords;\n    ").concat(t.outputDeclaration,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    // Custom vector types to handle higher dimenalities.\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    ")}function Vu(e,t){return"\n  void main() {\n    int indices[".concat(t,"];\n    toVec(TexCoords, indices);\n    vec4 result = vec4(process(indices));\n    ").concat(q(e).output," = result;\n  }\n  ")}var rh,nh,ve=L((function(){rh={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},nh={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}})),ae=L((function(){}));function vi(e){return _vi.apply(this,arguments)}function _vi(){return _vi=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:function(e){return 0},r=i.length>2?i[2]:void 0,e.abrupt("return",new Promise((function(e,i){var o=0;!function a(){if(t())e();else{o++;var s=n(o);null!=r&&o>=r?i():setTimeout(a,s)}}()})));case 3:case"end":return e.stop()}}),e)}))),_vi.apply(this,arguments)}function no(e){return zr(_typeof(e)<"u"&&0!==e.length,(function(){return"empty string found for sampler name"})),"get"+e.charAt(0).toUpperCase()+e.slice(1)}function Hu(e){return zr(_typeof(e)<"u"&&0!==e.length,(function(){return"empty string found for sampler name"})),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords"}function Wr(e,t){JSON.parse(JSON.stringify(e));return t}function Vr(e,t){return t.map((function(t){return e[t]})).join(", ")}function Je(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function Dt(){return["x","y","z","w","u","v"].slice(0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:6)}var Bt=L((function(){fe()}));function oh(e,t){return Dt(t).map((function(t){return"".concat(e,".").concat(t)}))}function Hr(e,t){return 1===t?[e]:oh(e,t)}function kt(){return"\n    float getChannel(vec4 frag, int dim) {\n      int modCoord = imod(dim, 2);\n      return modCoord == 0 ? frag.r : frag.g;\n    }\n\n    float getChannel(vec4 frag, vec2 innerDims) {\n      vec2 modCoord = mod(innerDims, 2.);\n      return modCoord.x == 0. ?\n        (modCoord.y == 0. ? frag.r : frag.g) :\n        (modCoord.y == 0. ? frag.b : frag.a);\n    }\n  "}var Or=L((function(){Bt()}));function ah(e,t,n){if(0===e)return"false";if(1===e)return"rc > ".concat(t[0]);for(var r="",i=e-2;i<e;i++)r+="".concat(n[i]," >= ").concat(t[i-e+2]),i<e-1&&(r+="||");return r}function sh(e,t){var n=e.length;if(0===n)return"getA(), 0, 0, 0";if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");var r="";if(n>2)for(var i=0;i<n-2;++i)r+="".concat(t[i],",");return"getA(".concat(r,"r, c),\n          rEdge ? 0. : getA(").concat(r,"rp1, c),\n          cEdge ? 0. : getA(").concat(r,"r, cp1),\n          rEdge || cEdge ? 0. : getA(").concat(r,"rp1, cp1)")}function uh(e,t,n,r){return 0===e||1===e?"":"\n    int r = ".concat(t[e-2],";\n    int c = ").concat(t[e-1],";\n    int rp1 = ").concat(t[e-2]," + 1;\n    int cp1 = ").concat(t[e-1]," + 1;\n    bool rEdge = rp1 >= ").concat(r,";\n    bool cEdge = cp1 >= ").concat(n,";\n    ")}var ju,ih,qu,Yu=L((function(){ve(),ae(),Bt(),Or(),ju={name:"pack",inputNames:["A"],inputTypes:[1]},ih=function(e,t){var n=q(e.session.backend.glContext.version),r=t.dims,i=r.length,o=t.dims.length,a=Je(o),s=Hr("rc",o),u=uh(o,s,r[r.length-2],r[r.length-1]),c=ah(o,0===i?[1,1]:1===i?[r[0],1]:[r[o-1],r[o-2]],s),l=sh(r,s),h="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(c,") {\n            ").concat(n.output," = vec4(0);\n          } else {\n            ").concat(u,"\n\n            ").concat(n.output," = vec4(").concat(l,");\n          }\n        }\n      ");return _objectSpread(_objectSpread({},ju),{},{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:2},shaderSource:h})},qu=function(e,t){return _objectSpread(_objectSpread({},ju),{},{get:function(){return ih(e,t)}})}}));function _i(e){if(0===e.length)return[1,1,1];for(var t=1,n=0;n<e.length-2;++n)t*=e[n];return[t,e.length>1?e[e.length-2]:1,e[e.length-1]]}function Ku(e,t){return 0===e.length||0===t.length||(e.length<2||t.length<2?e[e.length-1]===t[t.length-1]:e[e.length-1]===t[t.length-1]&&e[e.length-2]===t[t.length-2])}function ch(e){var t=z.computeStrides(e),n=["b","r","c"],r="index";return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t.map((function(e,i){return"".concat("int ".concat(n[i]," = ").concat(r," / ").concat(e),"; ",i===t.length-1?"int ".concat(n[i+1]," = ").concat(r," - ").concat(n[i]," * ").concat(e):"index -= ".concat(n[i]," * ").concat(e),";")})).join(""),"\n      return ivec3(b, r, c);\n    }\n  ")}function ph(e){var t=z.computeStrides(e);return"\n  int getFlattenedIndex(ivec3 coords) {\n    // reverse y, z order\n    return coords.x * ".concat(t[0]," + coords.z * ").concat(t[1]," + coords.y;\n  }\n")}var lh,fh,Xu,Ju=L((function(){fe(),ve(),ae(),Or(),lh=function(e){return{name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:"".concat(e)}},fh=function(e,t,n,r){for(var i=t.dims,o=r,a="",s=0;s<4;s++){var u="";switch(s){case 0:u="outputCoords = rc;";break;case 1:u="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:u="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:u="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}a+="\n        ".concat(u,"\n        ").concat(s>0?"if(outputCoords.y < rows && outputCoords.z < cols){":"","\n          int flattenedIndex = getFlattenedIndex(outputCoords);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);\n          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(s,"] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);\n\n        ").concat(s>0?"}":"","\n      ")}var c=q(e.session.backend.glContext.version),l="\n      ".concat(ch(i),"\n      ").concat(ph(o),"\n      ").concat(kt(),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.0);\n\n        ivec3 outputCoords;\n        int rows = ").concat(o[2],";\n        int cols = ").concat(o[1],";\n\n        ").concat(a,"\n        ").concat(c.output," = result;\n      }\n    ");return _objectSpread(_objectSpread({},n),{},{output:{dims:o,type:t.type,textureType:2},shaderSource:l,hasMain:!0})},Xu=function(e,t,n){var r=lh(n);return _objectSpread(_objectSpread({},r),{},{get:function(){return fh(e,t,r,n)}})}})),Oi,Zu=L((function(){ve(),ae(),Oi=function(e,t){var n=t.shape,r=q(e.session.backend.glContext.version),i="\n    const float FLOAT_MAX = 1.70141184e38;\n    const float FLOAT_MIN = 1.17549435e-38;\n\n    bool isNaN(float val) {\n      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;\n    }\n\n    highp vec4 encodeAsUint8(highp float v) {\n      if (isNaN(v)) {\n        return vec4(255, 255, 255, 255);\n      }\n\n      highp float av = abs(v);\n\n      if(av < FLOAT_MIN) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n      } else if(v > FLOAT_MAX) {\n        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n      } else if(v < -FLOAT_MAX) {\n        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n      }\n\n      highp vec4 c = vec4(0,0,0,0);\n\n      highp float e = floor(log2(av));\n      highp float m = exp2(fract(log2(av))) - 1.0;\n\n      c[2] = floor(128.0 * m);\n      m -= c[2] / 128.0;\n      c[1] = floor(32768.0 * m);\n      m -= c[1] / 32768.0;\n      c[0] = floor(8388608.0 * m);\n\n      highp float ebias = e + 127.0;\n      c[3] = floor(ebias / 2.0);\n      ebias -= c[3] * 2.0;\n      c[2] += floor(ebias) * 128.0;\n\n      c[3] += 128.0 * step(0.0, -v);\n\n      return c / 255.0;\n    }\n\n    void main() {\n      float value = ".concat(r.texture2D,"(X,TexCoords).r;\n      ").concat(r.output," = encodeAsUint8(value);\n    }"),o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:n,type:t.tensor.type,textureType:3},shaderSource:i,hasMain:!0};return e.executeProgram(o,[t.tensor])}}));function hh(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}var Qu,dh,el,tl=L((function(){ve(),ae(),Bt(),Or(),Qu={name:"unpack",inputNames:["A"],inputTypes:[2]},dh=function(e,t){var n=t.dims.length,r=Hr("rc",n),i=r.slice(-2),o=Je(n),a=kt(),s=0===t.dims.length?"":hh(n,r),u=n<=1?"rc":"vec2(".concat(i.join(","),")"),c="\n    ".concat(a,"\n    void main() {\n      ").concat(o," rc = getOutputCoords();\n\n       // Sample the texture with the coords to get the rgba channel value.\n       vec4 packedInput = getA(").concat(s,");\n\n       ").concat(q(e.session.backend.glContext.version).output," = vec4(getChannel(packedInput, ").concat(u,"), 0, 0, 0);\n     }\n   ");return _objectSpread(_objectSpread({},Qu),{},{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:c})},el=function(e,t){return _objectSpread(_objectSpread({},Qu),{},{get:function(){return dh(e,t)}})}})),oo,hn,io,mn=L((function(){dt(),oo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(_classCallCheck(this,e),1===n)this.internalFormat=t.R32F,this.format=t.RED,this.textureType=t.FLOAT,this.channelSize=n;else{if(4!==n)throw new Error("Invalid number of channels: ".concat(n));this.internalFormat=t.RGBA32F,this.format=t.RGBA,this.textureType=t.FLOAT,this.channelSize=n}}return _createClass(e,[{key:"encode",value:function(e,t){var n,r;return e.constructor!==Float32Array&&(pe.warning("Encoder","data was not of type Float32; creating new Float32Array"),r=new Float32Array(e)),t*this.channelSize>e.length?(pe.warning("Encoder","Source data too small. Allocating larger array"),r=e,n=this.allocate(t*this.channelSize),r.forEach((function(e,t){return n[t]=e}))):n=r=e,n}},{key:"allocate",value:function(e){return new Float32Array(4*e)}},{key:"decode",value:function(e,t){return 1===this.channelSize?e.filter((function(e,t){return t%4==0})).subarray(0,t):e.subarray(0,t)}}]),e}(),hn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(_classCallCheck(this,e),1!==n&&4!==n)throw new Error("Invalid number of channels: ".concat(n));this.internalFormat=t.RGBA,this.format=t.RGBA,this.channelSize=n,this.textureType=r||t.FLOAT}return _createClass(e,[{key:"encode",value:function(e,t){var n=e;return 1===this.channelSize&&(pe.verbose("Encoder","Exploding into a larger array"),n=this.allocate(t),e.forEach((function(e,t){return n[4*t]=e}))),n}},{key:"allocate",value:function(e){return new Float32Array(4*e)}},{key:"decode",value:function(e,t){return 1===this.channelSize?e.filter((function(e,t){return t%4==0})).subarray(0,t):e.subarray(0,t)}}]),e}(),io=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(_classCallCheck(this,e),this.channelSize=4,1===n)this.internalFormat=t.ALPHA,this.format=t.ALPHA,this.textureType=t.UNSIGNED_BYTE,this.channelSize=n;else{if(4!==n)throw new Error("Invalid number of channels: ".concat(n));this.internalFormat=t.RGBA,this.format=t.RGBA,this.textureType=t.UNSIGNED_BYTE,this.channelSize=n}}return _createClass(e,[{key:"encode",value:function(e,t){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}},{key:"allocate",value:function(e){return new Uint8Array(e*this.channelSize)}},{key:"decode",value:function(e,t){if(e instanceof Uint8Array)return e.subarray(0,t);throw new Error("Invalid array type: ".concat(e.constructor))}}]),e}()})),bn,rl,Ii,nl=L((function(){fe(),ae(),bn=function(e,t,n){var r=0===n||1===n?1:4,i=2===n,o=1===n||2===n,a=4===n?t.length-1:void 0,s=4===n?t.map((function(e,n){return n===t.length-1?4*e:e})):void 0;return Ii(e,t,r,s,{isPacked:i,reverseWH:o,breakAxis:a})},rl=function(e,t,n){var r=bn(e,t,n);return[r.width,r.height]},Ii=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=!(!i||!i.isPacked),a=_slicedToArray(e.computeTextureWH(o&&r||t,i),2),s=a[0],u=a[1],c=t.length,l=t.slice(0);if(0===c&&(l=[1]),1===n)r=t;else if(o){if(4!==n)throw new Error("a packed texture must be 4-channel");r=t,c>0&&(l[c-1]=Math.ceil(l[c-1]/2)),c>1&&(l[c-2]=Math.ceil(l[c-2]/2))}else if(!r)throw new Error("Unpacked shape is needed when using channels > 1");return{width:s,height:u,channels:n,isPacked:o,shape:l,strides:z.computeStrides(l),unpackedShape:r,reversedWH:i&&i.reverseWH}}})),bh,ao,il=L((function(){dt(),_r(),fe(),Yu(),Ju(),Zu(),tl(),mn(),nl(),ae(),bh=function(e,t){var n=t.map((function(e){return"".concat(e.unpackedShape.join(","),";").concat(e.width,"x").concat(e.height)})).join("_"),r=e.name;return e.cacheHint&&(r+="["+e.cacheHint+"]"),r+=":"+n},ao=function(){function e(t){_classCallCheck(this,e),this.session=t,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}return _createClass(e,[{key:"calculateTextureWidthAndHeight",value:function(e,t){return rl(this.session.layoutStrategy,e,t)}},{key:"executeProgram",value:function(e,t){if(t.length<e.inputNames.length)throw new Error("Input size mustn't be less than ".concat(e.inputNames.length,"."));if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");for(var n=[],r=0;r<e.inputNames.length;++r)n[r]=this.getOrCreateTextureData(t[r],e.inputTypes[r]);var i=bh(e,n),o=this.session.programManager.getArtifact(i),a=o?o.programInfo:"function"==typeof e.get?e.get():e,s=bn(this.session.layoutStrategy,a.output.dims,a.output.textureType),u=this.createTextureData(s,a.output.type);return o||(o=this.session.programManager.build(a,n,u),this.session.programManager.setArtifact(i,o)),this.runProgram(o,n,u),u}},{key:"run",value:function(e,t){return this.executeProgram(e,t).tensor}},{key:"runProgram",value:function(e,t,n){for(var r=0;r<t.length;++r)if(!!t[r].isPacked!=(2===e.programInfo.inputTypes[r]))throw new Error("input[".concat(r,"] property packed inconsistent"));if(!!n.isPacked!=(2===e.programInfo.output.textureType))throw new Error("output property packed inconsistent");this.session.programManager.run(e,t,n)}},{key:"getOrCreateTextureData",value:function(e,t){var n=this.getTextureData(e.dataId,2===t);if(!n&&(n=this.getTextureData(e.dataId,2!==t)))return 2===t?this.pack(n):this.unpack(n);if(!n){var r=bn(this.session.layoutStrategy,e.dims,t);if(4===t){var i=e.dims;if(4===i.length){var o=[i[0],Math.ceil(i[1]*i[2]*i[3]/4)],a=bn(this.session.layoutStrategy,o,t),s=e.numberData;if(i[1]*i[2]*i[3]%4!=0){var u=i[0],c=i[1]*i[2]*i[3],l=4*Math.ceil(1*c/4);s=new Float32Array(u*l);for(var h=0;h<u;++h){var f=h*c,d=h*l+h%1*c;s.set(e.numberData.subarray(f,f+c),d)}}return this.createTextureData(a,e.type,s,e,1)}}if(2===t){var p=Ii(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),y=this.createTextureData(p,e.type,e.numberData,e,1);n=this.pack(y)}else n=this.createTextureData(r,e.type,e.numberData,e,1)}return n}},{key:"createTextureDataFromLayoutBindTensor",value:function(e,t,n,r){return this.createTextureData(e,t,n,r,1)}},{key:"createTextureData",value:function(e,t,n,r,i){pe.verbose("InferenceHandler","Creating TextureData: layout:[".concat(JSON.stringify(e),"]"));var o=this.session.textureManager.createTextureFromLayout(t,e,n,i);return this.createTextureDataFromTexture(e,t,o,r)}},{key:"reshapeUnpacked",value:function(e,t){var n=this.getOrCreateTextureData(e,0),r={channels:n.channels,height:n.height,width:n.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t};return this.createTextureDataFromTexture(r,e.type,n.texture).tensor}},{key:"reshapePacked",value:function(e,t){var n=this.getOrCreateTextureData(e,2);if(Ku(e.dims,t)){var r={channels:n.channels,height:n.height,width:n.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t,isPacked:!0};return this.createTextureDataFromTexture(r,e.type,n.texture).tensor}var i=_i(e.dims),o=_i(t),a=this.reshapePacked(e,i),s=this.run(Xu(this,a,o),[a]);return this.reshapePacked(s,t)}},{key:"cast",value:function(e,t){var n=this.getOrCreateTextureData(e,0);return this.createTextureDataFromTexture(n,t,n.texture).tensor}},{key:"createTextureDataFromTexture",value:function(e,t,n,r,i){var o=this,a=_objectSpread(_objectSpread({},e),{},{tensor:r||new Ce(e.unpackedShape,t,(function(e){return o.readTexture(a)}),function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.readTextureAsync(a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),void 0,i),texture:n});return this.setTextureData(a.tensor.dataId,a,e.isPacked),a}},{key:"getTextureData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.session.isInitializer(e)?this.session.getTextureData(e,t):t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}},{key:"setTextureData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.session.isInitializer(e)?this.session.setTextureData(e,t,n):(n?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,t)}},{key:"isTextureLayoutCached",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!this.getTextureData(e.dataId,t)}},{key:"dispose",value:function(){var e=this;this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((function(t){return e.session.textureManager.releaseTexture(t)})),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((function(t){return e.session.textureManager.releaseTexture(t)})),this.unpackedTextureDataCache=new Map}},{key:"readTexture",value:function(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(Oi(this,e))}},{key:"readTextureAsync",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.isPacked?this.readTextureAsync(this.unpack(t)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(t,t.tensor.type,t.channels):this.session.textureManager.readUint8TextureAsFloat(Oi(this,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pack",value:function(e){return this.executeProgram(qu(this,e.tensor),[e.tensor])}},{key:"unpack",value:function(e){return this.executeProgram(el(this,e.tensor),[e.tensor])}}]),e}()})),Si,te,Ge=L((function(){Si=function(){function e(t){_classCallCheck(this,e),Object.assign(this,t)}return _createClass(e,[{key:"cacheKey",get:function(){var e=this;return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map((function(t){return"".concat(e[t])})).join(";")),this.key}}]),e}(),te=function(e){return new Si(e)}})),al,sl,ul,gh,yh,ll=L((function(){Ge(),ve(),ae(),al={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},sl=function(e,t,n){return yh(t),[e.run(_objectSpread(_objectSpread({},al),{},{cacheHint:n.cacheKey,get:function(){return gh(e,t,n)}}),t)]},ul=function(e){var t=e.attributes.getFloat("epsilon",1e-5),n=e.attributes.getFloat("momentum",.9),r=e.attributes.getInt("spatial",1);return te({epsilon:t,momentum:n,spatial:r})},gh=function(e,t,n){var r=q(e.session.backend.glContext.version),i=t[0].dims.length,o=_slicedToArray(e.calculateTextureWidthAndHeight(t[1].dims,0),2),a=o[0],s=o[1],u="\n  float process(int[".concat(i,"] indices) {\n    vec2 position = offsetToCoords(indices[1], ").concat(a,", ").concat(s,");\n    float scale = getColorAsFloat(").concat(r.texture2D,"(Scale, position));\n    float mean = getColorAsFloat(").concat(r.texture2D,"(Mean, position));\n    float variance = getColorAsFloat(").concat(r.texture2D,"(Variance, position));\n    float b = getColorAsFloat(").concat(r.texture2D,"(B, position));\n\n    return scale * ( (_A(indices) - mean) / sqrt(variance + float(").concat(n.epsilon,")) ) + b;\n  }");return _objectSpread(_objectSpread({},al),{},{output:{dims:t[0].dims,type:t[0].type,textureType:0},shaderSource:u})},yh=function(e){if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs.");var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4];if(t.dims.length<3||1!==n.dims.length||1!==r.dims.length||1!==i.dims.length||1!==o.dims.length)throw new Error("invalid input shape.");if(n.dims[0]!==t.dims[1]||r.dims[0]!==t.dims[1]||i.dims[0]!==t.dims[1]||o.dims[0]!==t.dims[1])throw new Error("invalid input shape.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==i.type&&"float64"!==i.type||"float32"!==o.type&&"float64"!==o.type)throw new Error("invalid input tensor types.")}})),so,gt,G,gn,uo,qt=L((function(){so=_createClass((function e(t,n,r,i){_classCallCheck(this,e),this.glContext=t,this.programInfo=n,this.inputTextureLayouts=r,this.outputTextureLayout=i})),gt=_createClass((function e(t){_classCallCheck(this,e),this.context=t})),G=_createClass((function e(t,n){_classCallCheck(this,e),this.routineBody=t,this.dependencies=n})),gn=function(){function e(t,n,r){_classCallCheck(this,e),this.name=t,this.dependencies=r||[],n&&(this.routineBody=n)}return _createClass(e,[{key:"addDependency",value:function(e){e&&this.dependencies.push(e)}}]),e}(),uo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"returnOrderedNodes",value:function(e){if(!e||0===e.length)return[];if(1===e.length)return e;var t=new Set,n=new Set,r=new Array;return this.createOrderedNodes(e,t,n,r),r}},{key:"createOrderedNodes",value:function(e,t,n,r){for(var i=0;i<e.length;++i)this.dfsTraverse(e[i],t,n,r)}},{key:"dfsTraverse",value:function(e,t,n,r){if(e&&!n.has(e.name)){if(t.has(e.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");t.add(e.name);var i=e.dependencies;if(i&&i.length>0)for(var o=0;o<i.length;++o)this.dfsTraverse(i[o],t,n,r);r.push(e),n.add(e.name),t.delete(e.name)}}}]),e}()}));function xh(){var e="add_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a + b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 + v2;\n  }\n  "),name:e,type:0}}function wh(){var e="div_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a / b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 / v2;\n  }\n  "),name:e,type:0}}function vh(){var e="mul_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a * b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 * v2;\n  }\n  "),name:e,type:0}}function _h(){var e="sub_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a - b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 - v2;\n  }\n  "),name:e,type:0}}function Oh(){var e="equal_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float(a == b);\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4(equal(v1, v2));\n  }\n  "),name:e,type:0}}function Ih(){var e="greater_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float(a > b);\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4( v1.r > v2.r ,\n      v1.g > v2.g,\n      v1.b > v2.b,\n      v1.a > v2.a );\n  }\n  "),name:e,type:0}}function Sh(){var e="less_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float(a < b);\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4( v1.r < v2.r ,\n                v1.g < v2.g,\n                v1.b < v2.b,\n                v1.a < v2.a );\n  }\n  "),name:e,type:0}}function Ah(){var e="and_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float( bool(a) && bool(b) );\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r && b2.r ,\n                b1.g && b2.g,\n                b1.b && b2.b,\n                b1.a && b2.a );\n  }\n  "),name:e,type:0}}function Eh(){var e="or_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float( bool(a) || bool(b) );\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r || b2.r ,\n                b1.g || b2.g,\n                b1.b || b2.b,\n                b1.a || b2.a );\n  }\n  "),name:e,type:0}}function Ph(){var e="xor_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float( bool(a) ^^ bool(b) );\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r ^^ b2.r ,\n                b1.g ^^ b2.g,\n                b1.b ^^ b2.b,\n                b1.a ^^ b2.a );\n  }\n  "),name:e,type:0}}function Dh(){return Fh("pow")}function Lh(){var e="prelu_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a < 0.0 ? a * b: a;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4(\n      v1.r < 0.0 ? v1.r * v2.r: v1.r,\n      v1.g < 0.0 ? v1.g * v2.g: v1.g,\n      v1.b < 0.0 ? v1.b * v2.b: v1.b,\n      v1.a < 0.0 ? v1.a * v2.a: v1.a\n      );\n  }\n  "),name:e,type:0}}function Fh(e){var t="".concat(e,"_");return{body:"\n  float ".concat(t,"(float a, float b) {\n    return ").concat(e,"(a, b);\n  }\n  vec4 ").concat(t,"(vec4 v1, vec4 v2) {\n    return ").concat(e,"(v1, v2);\n  }\n  "),name:t,type:0}}var yt,Ch,fl,cl,pl,dl,hl,ml,bl,gl,yl,Tl,xl,wl,vl=L((function(){fe(),qt(),ve(),ae(),yt=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t[0].type,i=arguments.length>4?arguments[4]:void 0,o=e.session.pack?2:0;return{name:n.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:i,get:function(){return Ch(e,t,n,r)}}},Ch=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t[0].type,i=e.session.pack?2:0,o=!z.areEqual(t[0].dims,t[1].dims),a=t[0].dims,s=e.session.pack;if(o){var u=Ke.calcShape(t[0].dims,t[1].dims,!1);if(!u)throw new Error("Can't perform binary op on the given tensors");var c=(a=u).length,l=0!==t[0].dims.length?t[0].dims.length:1,h=0!==t[1].dims.length?t[1].dims.length:1,f=0!==t[0].dims.length?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",d=0!==t[1].dims.length?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",p=q(e.session.backend.glContext.version),y=s?"\n      ".concat(n.body,"\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n        vec4 result = ").concat(n.name,"(a, b);\n        ").concat(p.output," = result;\n      }"):"\n      ".concat(n.body,"\n      float process(int indices[").concat(c,"]) {\n        int aindices[").concat(l,"];\n        int bindices[").concat(h,"];\n        ").concat(f,"\n        ").concat(d,"\n        return ").concat(n.name,"(_A(aindices), _B(bindices));\n      }");return{name:n.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:a,type:r,textureType:i},shaderSource:y,hasMain:s}}var g=q(e.session.backend.glContext.version),m="\n    ".concat(n.body,"\n    void main() {\n      vec4 v1 = ").concat(g.texture2D,"(A, TexCoords);\n      vec4 v2 = ").concat(g.texture2D,"(B, TexCoords);\n      vec4 result = ").concat(n.name,"(v1, v2);\n      ").concat(g.output," = result;\n    }\n    ");return{name:n.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:t[0].dims,type:r,textureType:i},shaderSource:m,hasMain:!0}},fl=function(e,t){return[e.run(yt(e,t,xh()),t)]},cl=function(e,t){return[e.run(yt(e,t,Ah(),"bool"),t)]},pl=function(e,t){return[e.run(yt(e,t,wh()),t)]},dl=function(e,t){return[e.run(yt(e,t,Oh(),"bool"),t)]},hl=function(e,t){return[e.run(yt(e,t,Ih(),"bool"),t)]},ml=function(e,t){return[e.run(yt(e,t,Sh(),"bool"),t)]},bl=function(e,t){return[e.run(yt(e,t,vh()),t)]},gl=function(e,t){return[e.run(yt(e,t,Eh(),"bool"),t)]},yl=function(e,t){return[e.run(yt(e,t,Dh()),t)]},Tl=function(e,t){return[e.run(yt(e,t,Lh()),t)]},xl=function(e,t){return[e.run(yt(e,t,_h()),t)]},wl=function(e,t){return[e.run(yt(e,t,Ph(),"bool"),t)]}})),_l,Ol,Bh,Il=L((function(){fe(),_l=function(e,t,n){return Bh(t),[e.cast(t[0],n)]},Ol=function(e){return Ve.tensorDataTypeFromProto(e.attributes.getInt("to"))},Bh=function(e){if(!e||1!==e.length)throw new Error("Cast requires 1 input.");if("string"===e[0].type)throw new Error("Invalid input type.")}})),kh,Nh,Sl,lo,Al=L((function(){ve(),ae(),Bt(),Or(),kh=function(e,t){return{name:"Concat (packed)",inputNames:Array.from({length:e},(function(e,t){return"X".concat(t)})),inputTypes:Array(e).fill(2),cacheHint:t}},Nh=function(e,t,n,r){var i=n[0].dims.slice();if(r>=i.length||r<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");r<0&&(r=i.length+r);for(var o=i.slice(0),a=1;a<n.length;a++)for(var s=n[a].dims.slice(),u=0;u<i.length;u++)if(u===r)o[r]+=s[u];else if(i[u]!==s[u])throw new Error("non concat dimensions must match");var c=o.length,l=Hr("coords",c),h=Je(c),f=kt(),d=n.map((function(e){return e.dims})),p=Dt(c),y=new Array(d.length-1);y[0]=d[0][r];for(var g=1;g<y.length;g++)y[g]=y[g-1]+d[g][r];for(var m=p[r],v=p.slice(-2),w=p.join(),b="if (".concat(m," < ").concat(y[0],") {\n        return getChannel(\n            getX0(").concat(w,"), vec2(").concat(v.join(),"));\n        }"),x=1;x<y.length;x++){var _=y[x-1];b+="\n            if (".concat(m," < ").concat(y[x],"  && ").concat(m," >= ").concat(y[x-1],") {\n              return getChannel(\n                getX").concat(x,"(").concat(lo(p,m,_),"),\n                vec2(").concat(lo(v,m,_),"));\n            }")}var I=y.length,A=y[y.length-1];b+="\n            return getChannel(\n              getX".concat(I,"(").concat(lo(p,m,A),"),\n              vec2(").concat(lo(v,m,A),"));");var C=q(e.session.backend.glContext.version),k="\n          ".concat(f,"\n          float getValue(").concat(p.map((function(e){return"int "+e})),") {\n            ").concat(b,"\n          }\n\n          void main() {\n            ").concat(h," coords = getOutputCoords();\n            int lastDim = coords.").concat(p[c-1],";\n            coords.").concat(p[c-1]," = coords.").concat(p[c-2],";\n            coords.").concat(p[c-2]," = lastDim;\n\n            vec4 result = vec4(getValue(").concat(l,"), 0., 0., 0.);\n\n            ").concat(l[c-1]," = ").concat(l[c-1]," + 1;\n            if (").concat(l[c-1]," < ").concat(o[c-1],") {\n              result.g = getValue(").concat(l,");\n            }\n\n            ").concat(l[c-2]," = ").concat(l[c-2]," + 1;\n            if (").concat(l[c-2]," < ").concat(o[c-2],") {\n              result.a = getValue(").concat(l,");\n            }\n\n            ").concat(l[c-1]," = ").concat(l[c-1]," - 1;\n            if (").concat(l[c-2]," < ").concat(o[c-2]," &&\n                ").concat(l[c-1]," < ").concat(o[c-1],") {\n              result.b = getValue(").concat(l,");\n            }\n            ").concat(C.output," = result;\n          }\n        ");return _objectSpread(_objectSpread({},t),{},{output:{dims:o,type:n[0].type,textureType:2},shaderSource:k,hasMain:!0})},Sl=function(e,t,n){var r=kh(t.length,n.cacheKey);return _objectSpread(_objectSpread({},r),{},{get:function(){return Nh(e,r,t,n.axis)}})},lo=function(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}})),El,Rh,Mh,Gh,Pl,Uh,zh,Wh,Dl,Vh,Ll=L((function(){Ge(),ae(),Al(),El=function(e,t,n){return Vh(t),e.session.pack&&t[0].dims.length>1?[e.run(Sl(e,t,n),t)]:[e.run(Gh(e,t,n),t)]},Rh=function(e,t){return{name:"Concat",inputNames:Array.from({length:e},(function(e,t){return"X".concat(t)})),inputTypes:Array(e).fill(0),cacheHint:t}},Mh=function(e,t,n,r){var i=n[0].dims.slice();if(r>=i.length||r<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");r<0&&(r=i.length+r);for(var o=i.slice(0),a=1;a<n.length;a++)for(var s=n[a].dims.slice(),u=0;u<i.length;u++)if(u===r)o[r]+=s[u];else if(i[u]!==s[u])throw new Error("non concat dimensions must match");for(var c=o.length,l=new Array(n.length),h=0,f=0;f<l.length;++f)h+=n[f].dims[r],l[f]=h;var d;d=n.length<5?Pl(l):Uh(l);var p="\n        ".concat(zh(n.length,c),"\n        ").concat(Wh(l),"\n        ").concat(d,"\n        float process(int indices[").concat(c,"]) {\n          int textureIndex = getTextureWhereDataResides (indices[").concat(r,"]);\n\n          if(textureIndex != 0) {\n            indices[").concat(r,"] = indices[").concat(r,"] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));\n          }\n\n          return fetchDataFromCorrectTexture(textureIndex, indices);\n        }");return _objectSpread(_objectSpread({},t),{},{output:{dims:o,type:n[0].type,textureType:0},shaderSource:p})},Gh=function(e,t,n){var r=Rh(t.length,n.cacheKey);return _objectSpread(_objectSpread({},r),{},{get:function(){return Mh(e,r,t,n.axis)}})},Pl=function(e){return"int getTextureWhereDataResides(int index) {\n      ".concat(e.map((function(e,t){return"if(index<".concat(e,") {return ").concat(t,";}\n")})).join(""),"\n    }")},Uh=function(e){return Pl(e)},zh=function(e,t){for(var n=["float fetchDataFromCorrectTexture(int textureIndex, int indices[".concat(t,"]) {")],r=0;r<e;++r)0===r?n.push("\tif (textureIndex == ".concat(r,") { return _X").concat(r,"(indices); }")):r===e-1?n.push("\telse { return _X".concat(r,"(indices); }")):n.push("\telse if (textureIndex == ".concat(r,") { return _X").concat(r,"(indices); }"));return n.push("\t}"),n.join("\n")},Wh=function(e){for(var t=["int getSizeInConcatAxisValueFromIndex(int index) {"],n=0;n<e.length;++n)0===n?t.push("\tif (index == ".concat(n,") { return ").concat(e[n],"; }")):n===e.length-1?t.push("\telse { return ".concat(e[n],"; }")):t.push("\telse if (index == ".concat(n,") { return ").concat(e[n],"; }"));return t.push("\t}"),t.join("\n")},Dl=function(e){return te({axis:e.attributes.getInt("axis")})},Vh=function(e){if(!e||e.length<1)throw new Error("too few inputs");var t=e[0].type,n=e[0].dims.length;if("string"===t)throw new Error("string tensor is not supported yet");var r,i=_createForOfIteratorHelper(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.type!==t)throw new Error("input tensors should be one type");if(o.dims.length!==n)throw new Error("input tensors should have the same shape")}}catch(a){i.e(a)}finally{i.f()}}}));function Hh(){return Tt("abs")}function jh(){return Tt("acos")}function qh(){return Tt("asin")}function Yh(){return Tt("atan")}function Xh(){return Tt("ceil")}function Kh(){return Tt("cos")}function Jh(e){var t="elu";return{body:"\n  const float alpha = float(".concat(e,");\n\n  float ").concat(t,"_(float a) {\n    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;\n  }\n  vec4 ").concat(t,"_(vec4 v) {\n    return vec4(").concat(t,"_(v.x), ").concat(t,"_(v.y), ").concat(t,"_(v.z), ").concat(t,"_(v.w));\n  }\n  "),name:t,type:0}}function Zh(){return Tt("exp")}function Qh(){return Tt("floor")}function Ai(e,t){var n="clip";return{body:"\n  const float min = float(".concat(e,");\n  const float max = float(").concat(t,");\n\n  float ").concat(n,"_(float a) {\n    return clamp(a, min, max);\n  }\n  vec4 ").concat(n,"_(vec4 v) {\n    return clamp(v, min, max);\n  }\n  "),name:n,type:0}}function em(){var e="indentity";return{body:"\n  float ".concat(e,"_(float a) {\n    return a;\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return v;\n  }\n  "),name:e,type:0}}function tm(e){var t="leakyRelu";return{body:"\n  const float alpha = float(".concat(e,");\n\n  float ").concat(t,"_(float a) {\n    return a < 0.0 ? a * alpha : a;\n  }\n  vec4 ").concat(t,"_(vec4 v) {\n    return vec4(").concat(t,"_(v.x), ").concat(t,"_(v.y), ").concat(t,"_(v.z), ").concat(t,"_(v.w));\n  }\n  "),name:t,type:0}}function rm(){return Tt("log")}function nm(){var e="neg";return{body:"\n  float ".concat(e,"_(float a) {\n    return -a;\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return -v;\n  }\n  "),name:e,type:0}}function om(){var e="not";return{body:"\n  float ".concat(e,"_(float a) {\n    return float( ! bool(a) );\n  }\n  bool ").concat(e,"_(bool a) {\n    return !a;\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));\n  }\n  bvec4 ").concat(e,"_(bvec4 v) {\n    return bvec4(!v.x, !v.y, !v.z, !v.w);\n  }\n  "),name:e,type:0}}function im(){return Tt("sin")}function Ei(){var e="relu";return{body:"\n  float ".concat(e,"_(float a) {\n    return max( a, 0.0 );\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return max( v, 0.0 );\n  }\n  "),name:e,type:0}}function Pi(){var e="sigmoid";return{body:"\n  float ".concat(e,"_(float a) {\n    return 1.0 / (1.0 + exp(-a));\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return 1.0 / (1.0 + exp(-v));\n  }\n  "),name:e,type:0}}function am(){return Tt("sqrt")}function sm(){return Tt("tan")}function um(){var e="tanh";return{body:"\n  float ".concat(e,"_(float a) {\n    a = clamp(a, -10., 10.);\n    a = exp(2.*a);\n    return (a - 1.) / (a + 1.);\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    v = clamp(v, -10., 10.);\n    v = exp(2.*v);\n    return (v - 1.) / (v + 1.);\n  }\n  "),name:e,type:0}}function Tt(e){return{body:"\n  float ".concat(e,"_(float a) {\n    return ").concat(e,"(a);\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return ").concat(e,"(v);\n  }\n  "),name:e,type:0}}var lm,Le,Fl,Cl,$l,Bl,Di,kl,Nl,fm,Rl,Ml,Gl,Ul,zl,Wl,Li,Vl,Hl,jl,ql,Yl,Xl,Kl,Jl,Zl,Ql,ef,Fi=L((function(){Ge(),fe(),qt(),ve(),ae(),lm=function(e,t,n,r){var i=e.session.pack?2:0,o=q(e.session.backend.glContext.version);return _objectSpread(_objectSpread({},t),{},{output:{dims:n.dims,type:n.type,textureType:i},shaderSource:"\n     ".concat(r.body,"\n     void main() {\n       vec4 v = ").concat(o.texture2D,"(A, TexCoords);\n       v = ").concat(r.name,"_(v);\n       ").concat(o.output," = v;\n     }\n     "),hasMain:!0})},Le=function(e,t,n,r){var i=e.session.pack?2:0,o={name:n.name,inputTypes:[i],inputNames:["A"],cacheHint:r};return _objectSpread(_objectSpread({},o),{},{get:function(){return lm(e,o,t,n)}})},Fl=function(e,t){return[e.run(Le(e,t[0],Hh()),t)]},Cl=function(e,t){return[e.run(Le(e,t[0],jh()),t)]},$l=function(e,t){return[e.run(Le(e,t[0],qh()),t)]},Bl=function(e,t){return[e.run(Le(e,t[0],Yh()),t)]},Di=function(e,t,n){return[e.run(Le(e,t[0],Ai(n.min,n.max),n.cacheKey),t)]},kl=function(e){return te({min:e.attributes.getFloat("min",wr),max:e.attributes.getFloat("max",vr)})},Nl=function(e,t){var n=fm(e,t);return Di(e,[t[0]],n)},fm=function(e,t){if(t.length>=3&&(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)))throw new Error("dynamic clip attributes are not allowed");var n=t.length>=3?t[1].numberData[0]:wr,r=t.length>=3?t[2].numberData[0]:vr;return te({min:n,max:r})},Rl=function(e,t){return[e.run(Le(e,t[0],Xh()),t)]},Ml=function(e,t){return[e.run(Le(e,t[0],Kh()),t)]},Gl=function(e,t,n){return[e.run(Le(e,t[0],Jh(n.alpha),n.cacheKey),t)]},Ul=function(e){return te({alpha:e.attributes.getFloat("alpha",1)})},zl=function(e,t){return[e.run(Le(e,t[0],Zh()),t)]},Wl=function(e,t){return[e.run(Le(e,t[0],Qh()),t)]},Li=function(e,t){return[e.run(Le(e,t[0],em()),t)]},Vl=function(e,t,n){return[e.run(Le(e,t[0],tm(n.alpha),n.cacheKey),t)]},Hl=function(e){return te({alpha:e.attributes.getFloat("alpha",.01)})},jl=function(e,t){return[e.run(Le(e,t[0],rm()),t)]},ql=function(e,t){return[e.run(Le(e,t[0],nm()),t)]},Yl=function(e,t){return[e.run(Le(e,t[0],om()),t)]},Xl=function(e,t){return[e.run(Le(e,t[0],Ei()),t)]},Kl=function(e,t){return[e.run(Le(e,t[0],Pi()),t)]},Jl=function(e,t){return[e.run(Le(e,t[0],im()),t)]},Zl=function(e,t){return[e.run(Le(e,t[0],am()),t)]},Ql=function(e,t){return[e.run(Le(e,t[0],sm()),t)]},ef=function(e,t){return[e.run(Le(e,t[0],um()),t)]}}));function Nt(e){var t;switch(e.activation){case"Relu":t=Ei();break;case"Sigmoid":t=Pi();break;case"Clip":t=Ai(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""}}var n=t.name;return{activationFunction:t.body,applyActivation:"value = ".concat(n,"_(value);")}}var jr,Ir=L((function(){fe(),Fi(),jr=function(e){var t=e.getString("activation","");if("Clip"===t){var n=_slicedToArray(e.getFloats("activation_params",[wr,vr]),2),r=n[0],i=n[1];return{activation:t,clipMax:i,clipMin:r,activationCacheKey:"".concat(t,":").concat(r,",").concat(i)}}return{activation:t,activationCacheKey:t}}})),pm,dm,tf,rf=L((function(){dt(),ve(),ae(),fo(),Ir(),pm=function(e,t){return{name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}},dm=function(e,t,n,r){var i=t.length>2?"value += getBias(output_channel);":"",o=t[0].dims.slice(),a=t[1].dims.slice(),s=a[0]/r.group;pe.verbose("GroupedConv","autpPad:".concat(r.autoPad,", dilations:").concat(r.dilations,", group:").concat(r.group,", kernelShape:").concat(r.kernelShape,", pads:").concat(r.pads,", strides:").concat(r.strides));var u=qr(o,a,r.dilations,r.pads,r.strides),c=q(e.session.backend.glContext.version),l=Nt(r),h=l.activationFunction,f=l.applyActivation,d="\n  const ivec2 strides = ivec2(".concat(r.strides[0],", ").concat(r.strides[1],");\n  const ivec2 pads = ivec2(").concat(r.pads[0],", ").concat(r.pads[1],");\n  ").concat(h,"\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n    ivec2 xRCCorner = coords.zw * strides - pads;\n    int group_id = output_channel / ").concat(s,";\n\n    float value = 0.0;\n    for (int wInChannel = 0; wInChannel < ").concat(a[1],"; wInChannel++) {\n      int input_channel = group_id * ").concat(a[1]," + wInChannel;\n      for (int wHeight = 0; wHeight < ").concat(a[2],"; wHeight++) {\n        int xHeight = xRCCorner.x + wHeight * ").concat(r.dilations[0],";\n\n        if (xHeight < 0 || xHeight >= ").concat(o[2],") {\n          continue;\n        }\n\n        for (int wWidth = 0; wWidth < ").concat(a[3],"; wWidth++) {\n          int xWidth = xRCCorner.y + wWidth * ").concat(r.dilations[1],";\n          if (xWidth < 0 || xWidth >= ").concat(o[3],") {\n            continue;\n          }\n\n          float xVal = getX(batch, input_channel, xWidth, xHeight);\n          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);\n          value += xVal*wVal;\n        }\n      }\n    }\n    ").concat(i,"\n    ").concat(f,"\n    ").concat(c.output," = vec4(value, .0, .0, .0);\n  }\n");return _objectSpread(_objectSpread({},n),{},{output:{dims:u,type:t[0].type,textureType:0},shaderSource:d,hasMain:!0})},tf=function(e,t,n){var r=pm(t.length>2,n.cacheKey);return _objectSpread(_objectSpread({},r),{},{get:function(){return dm(e,t,r,n)}})}})),hm,mm,nf,of=L((function(){ve(),ae(),Or(),hm=function(e){return{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:e}},mm=function(e,t,n,r,i,o){for(var a=n.dims,s=r.dims,u=i.length,c=[s[1]*s[2]*s[3],i[2]*i[3]],l=s[2]*s[3],h=kt(),f=q(e.session.backend.glContext.version),d="",p=0;p<=1;p++)for(var y=0;y<=1;y++)d+="\n            blockIndex = rc.x + ".concat(y,";\n            pos = rc.y + ").concat(p,";\n\n            if(blockIndex < ").concat(c[1]," && pos < ").concat(c[0],") {\n              offsetY = int(blockIndex / (").concat(i[u-1],")) * ").concat(o.strides[0]," -\n                ").concat(o.pads[0],";\n              d0 = offsetY + ").concat(o.dilations[0]," * (imod(pos, ").concat(l,") / ").concat(s[2],");\n\n              if(d0 < ").concat(a[2]," && d0 >= 0) {\n                offsetX = imod(blockIndex, ").concat(i[u-1],") * ").concat(o.strides[1]," -\n                  ").concat(o.pads[1],";\n                d1 = offsetX + ").concat(o.dilations[1]," * imod(imod(pos, ").concat(l,"), ").concat(s[2],");\n\n                if(d1 < ").concat(a[3]," && d1 >= 0) {\n\n                  ch = int(float(pos)/ ").concat(l,".);\n                    innerDims = vec2(d0, d1);\n                    result[").concat(2*p+y,"] = getChannel(\n                      getA(0, ch, int(innerDims.x),\n                      int(innerDims.y)), innerDims);\n                }\n              }\n            }\n\n          ");var g="\n      ".concat(h,"\n\n      void main() {\n        ivec2 rc = getOutputCoords();\n          vec4 result = vec4(0.0);\n          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n          vec2 innerDims;\n          ").concat(d,"\n          ").concat(f.output," = result;\n      }\n            ");return _objectSpread(_objectSpread({},t),{},{output:{dims:c,type:n.type,textureType:2},shaderSource:g,hasMain:!0})},nf=function(e,t,n,r,i){var o=hm(i.cacheKey);return _objectSpread(_objectSpread({},o),{},{get:function(){return mm(e,o,t,n,r,i)}})}}));function gm(e,t,n){var r=t[0].dims,i=t[1].dims,o=Ke.calcShape(r,i,!0);if(!o)throw new Error("Can't use matmul on the given tensors");var a=Je(o.length),s=Dt(),u=Nt(n),c=u.activationFunction,l=u.applyActivation,h=t.length>2,f=h?"value += getBiasForMatmul();":"",d=h?"".concat($i(a,s,t[2].dims,o,!1)):"",p=o.length,y=r.length,g=i.length,m="\n    ".concat(c,"\n    ").concat(d,"\n    float process(int indices[").concat(p,"]) {\n        int a[").concat(y,"];\n        int b[").concat(g,"];\n        bcastMatmulIndices_A(indices, a);\n        bcastMatmulIndices_B(indices, b);\n\n        float value;\n        for (int k=0; k<").concat(r[r.length-1],"; ++k) {\n            a[").concat(y-1,"] = k;\n            b[").concat(g-2,"] = k;\n            value += _A(a) * _B(b);\n        }\n        ").concat(f,"\n        ").concat(l,"\n        return value;\n    }");return _objectSpread(_objectSpread({},e),{},{output:{dims:o,type:t[0].type,textureType:0},shaderSource:m})}function Ci(e,t){var n=bm(e.length>2,t.activationCacheKey);return _objectSpread(_objectSpread({},n),{},{get:function(){return gm(n,e,t)}})}function $i(e,t,n,r,i){var o,a=n.length,s=r.length,u=s-a;o=s<2&&a>0?"coords":n.map((function(e,n){return"coords.".concat(t[n+u])})).join(", ");var c=Ke.getBroadcastDims(n,r).map((function(e){return"coords.".concat(t[e+u]," = 0;")})).join("\n"),l="vec4(outputValue.xx, outputValue.yy)";return 1===z.size(n)&&(l="vec4(outputValue.x)"),i?"\nvec4 getBiasForMatmul() {\n  ".concat(e," coords = getOutputCoords();\n  ").concat(c,"\n  vec4 outputValue = getBias(").concat(o,");\n  return ").concat(l,";\n}"):"\nfloat getBiasForMatmul() {\n  ".concat(e," coords = getOutputCoords();\n  ").concat(c,"\n  return getBias(coords.x);\n}")}var af,sf,bm,ym,co=L((function(){fe(),ae(),Bt(),Ir(),Bi(),af=function(e,t,n){return ym(t),e.session.pack?[e.run(po(e,t,n),t)]:[e.run(Ci(t,n),t)]},sf=function(e){return jr(e.attributes)},bm=function(e,t){return{name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}},ym=function(e){if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type)throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match")}}));function wm(e,t,n,r){var i=[],o=[],a=n[0].dims,s=n[1].dims,u=a.length,c=s.length,l=r.length,h=l-u,f=l-c;i=a.map((function(e,n){return"coords.".concat(t[n+h])})),i[u-1]="i*2",i.join(", "),o=s.map((function(e,n){return"coords.".concat(t[n+f])})),o[c-2]="i*2",o.join(", ");var d=Ke.getBroadcastDims(a,r),p=Ke.getBroadcastDims(s,r),y=d.map((function(e){return"coords.".concat(t[e+h]," = 0;")})).join("\n"),g=p.map((function(e){return"coords.".concat(t[e+f]," = 0;")})).join("\n"),m="int lastDim = coords.".concat(t[l-1],";\n  coords.").concat(t[l-1]," = coords.").concat(t[l-2],";\n  coords.").concat(t[l-2]," = lastDim;");return"\nvec4 getAAtOutCoordsMatmul(int i) {\n  ".concat(e," coords = getOutputCoords();\n  ").concat(m,"\n  ").concat(y,"\n  vec4 outputValue = getA(").concat(i,");\n  return outputValue;\n}\n\nvec4 getBAtOutCoordsMatmul(int i) {\n  ").concat(e," coords = getOutputCoords();\n  ").concat(m,"\n  ").concat(g,"\n  vec4 outputValue = getB(").concat(o,");\n  return outputValue;\n}")}function vm(e,t){for(var n="",r=0;r<t-2;r++)n+="rc.".concat(e[r],", ");return n+="rc.".concat(e[t-2],", i*2")}function _m(e,t){for(var n="",r=0;r<t-2;r++)n+="rc.".concat(e[r],", ");return n+="i*2, rc.".concat(e[t-1])}var Tm,xm,po,Bi=L((function(){fe(),ve(),ae(),Bt(),Ir(),co(),Tm=function(e,t){return{name:"MatMul (packed)",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[2,2,2]:[2,2],cacheHint:t}},xm=function(e,t,n,r){var i=n.length>2,o=i?"value += getBiasForMatmul();":"",a=n[0].dims,s=n[1].dims,u=Ke.calcShape(a,s,!0),c=!z.areEqual(n[0].dims,n[1].dims);if(!u)throw new Error("Can't use matmul on the given tensors");var l=a[a.length-1],h=Math.ceil(l/2),f=a.length,d=s.length,p=q(e.session.backend.glContext.version),y=Je(u.length),g=u.length,m=Dt(),v=Nt(r),w=v.activationFunction,b=v.applyActivation,x=i?"".concat($i(y,m,n[2].dims,u,!0)):"",_=c?"".concat(wm(y,m,n,u)):"",I=c?"getAAtOutCoordsMatmul(i)":"getA(".concat(vm(m,f),")"),A=c?"getBAtOutCoordsMatmul(i)":"getB(".concat(_m(m,d),")"),C="\n            ".concat(_,"\n            ").concat(x,"\n            ").concat(w,"\n            void main() {\n              ").concat(c?"":"".concat(y," rc =\n          getOutputCoords(); int lastDim = rc.").concat(m[g-1],"; rc.").concat(m[g-1]," =\n          rc.").concat(m[g-2],"; rc.").concat(m[g-2]," = lastDim;\n      "),"\n\n              vec4 value = vec4(0);\n              for (int i = 0; i < ").concat(h,"; i++) {\n                vec4 a = ").concat(I,";\n                vec4 b = ").concat(A,";\n\n                value += (a.rrbb * b.rgrg);\n                value += (a.ggaa * b.baba);\n              }\n              ").concat(o,"\n              ").concat(b,"\n              ").concat(p.output," = value;\n            }");return _objectSpread(_objectSpread({},t),{},{output:{dims:u,type:n[0].type,textureType:2},shaderSource:C,hasMain:!0})},po=function(e,t,n){var r=Tm(t.length>2,n.activationCacheKey);return _objectSpread(_objectSpread({},r),{},{get:function(){return xm(e,r,t,n)}})}})),uf,lf=L((function(){fo(),of(),Bi(),uf=function(e,t,n){var r=t[0].dims,i=t[1].dims,o=qr(r,i,n.dilations,n.pads,n.strides),a=e.run(nf(e,t[0],t[1],o,n),[t[0]]),s=e.reshapePacked(t[1],[i[0],i[1]*i[2]*i[3]]),u=3===t.length?[s,a,t[2]]:[s,a],c=e.run(po(e,u,n),u);return e.reshapePacked(c,o)}})),Om,Im,ff,ki,Ni=L((function(){ae(),Om=function(e){return{name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:e}},Im=function(e,t,n,r,i,o){var a=n.dims,s=r.dims,u=i.length,c=ki(a,s,i,4),l="\n        const int XC = ".concat(a[1],";\n        const int XH = ").concat(a[2],";\n        const int XW = ").concat(a[3],";\n        const int KH = ").concat(o.kernelShape[0],";\n        const int KW = ").concat(o.kernelShape[1],";\n        const int dilationH = ").concat(o.dilations[0],";\n        const int dilationW = ").concat(o.dilations[1],";\n        const int strideH = ").concat(o.strides[0],";\n        const int strideW = ").concat(o.strides[1],";\n        const int padH = ").concat(o.pads[0],";\n        const int padW = ").concat(o.pads[1],";\n        const int KHKW = KH*KW;\n        const int XCKHKW = XC * KHKW;\n        const int outputChannels = 4;\n        vec4 process(int indices[").concat(u,"]) {\n          int b  = indices[0]; // batch size\n          int oh = indices[1] * strideH - padH; //output height\n          int ow = indices[2] * strideW - padW; //output width\n          int p = indices[3] * outputChannels; //patch\n          vec4 value = vec4(0.0);\n          for(int i=0; i < outputChannels; ++i) {\n            if(p < XCKHKW) {\n              int patchC = p / KHKW;\n              int patchH = (p - patchC*KHKW) / KW;\n              int patchW = (p - patchC*KHKW) - patchH * KW;\n              int xh2 = oh + patchH * dilationH;\n              int xw2 = ow + patchW * dilationW;\n              int x[").concat(a.length,"];\n              x[0] = b;\n              x[1] = patchC;\n              x[2] = xh2;\n              x[3] = xw2;\n              if(xh2 >= 0 &&\n                  xh2 < XH &&\n                  xw2 >= 0 &&\n                  xw2 < XW) {\n                value[i] = _X(x);\n              }\n            }\n            ++p;\n          }\n          return value;\n        }\n        ");return _objectSpread(_objectSpread({},t),{},{output:{dims:c,type:n.type,textureType:4},shaderSource:l})},ff=function(e,t,n,r,i){var o=Om(i.cacheKey);return _objectSpread(_objectSpread({},o),{},{get:function(){return Im(e,o,t,n,r,i)}})},ki=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;return[n[0],n[2],n[3],Math.ceil(e[1]*t[2]*t[3]/r)]}})),Sm,Am,cf,pf=L((function(){fe(),ve(),ae(),Ir(),Ni(),Sm=function(e,t){return{name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[0,4,0]:[0,4],cacheKey:t.activationCacheKey}},Am=function(e,t,n,r,i){var o=n[0].dims,a=n[1].dims,s=[a[0],Math.ceil(o[1]*a[2]*a[3]/4)],u=ki(o,a,r),c=_slicedToArray(e.calculateTextureWidthAndHeight(s,4),2),l=c[0],h=c[1],f=z.computeStrides(u),d=_slicedToArray(e.calculateTextureWidthAndHeight(u,4),2),p=d[0],y=d[1],g=r.length,m=n.length<3?"0.0":"_B(b)",v=Math.ceil(o[1]*a[2]*a[3]/4),w=Nt(i),b=w.activationFunction,x=w.applyActivation,_=q(e.session.backend.glContext.version),I="\n".concat(b,"\nfloat process(int indices[").concat(g,"]) {\n  int b[1];\n  b[0] = indices[1];\n  int im2col[4];\n  im2col[0] = indices[0];\n  im2col[1] = indices[2];\n  im2col[2] = indices[3];\n  int im2colOffset = im2col[0] * ").concat(f[0]," + im2col[1] * ").concat(f[1]," + im2col[2] * ").concat(f[2],";\n  int kernelOffset = indices[1] * ").concat(s[1],";\n  float value = ").concat(m,";\n  for (int i = 0; i < ").concat(v,"; ++i) {\n    vec2 im2colCoords = offsetToCoords(im2colOffset, ").concat(p,", ").concat(y,");\n    vec2 kernelCoords = offsetToCoords(kernelOffset, ").concat(l,", ").concat(h,");\n    value += dot(").concat(_.texture2D,"(Im2Col, im2colCoords), ").concat(_.texture2D,"(K, kernelCoords));\n    ++im2colOffset;\n    ++kernelOffset;\n  }\n  ").concat(x,"\n  return value;\n}");return _objectSpread(_objectSpread({},t),{},{output:{dims:r,type:n[0].type,textureType:0},shaderSource:I})},cf=function(e,t,n,r){var i=Sm(t.length>2,r);return _objectSpread(_objectSpread({},i),{},{get:function(){return Am(e,i,t,n,r)}})}})),qr,Ri,Em,Pm,Dm,Lm,Mi,Fm,fo=L((function(){Ge(),fe(),rf(),lf(),pf(),Ir(),Ni(),co(),qr=function(e,t,n,r,i){var o,a=e[0],s=e.slice(2),u=s.length,c=t[0],l=t.slice(2).map((function(e,t){return e+(e-1)*(n[t]-1)})),h=s.map((function(e,t){return e+r[t]+r[t+u]})).map((function(e,t){return Math.floor((e-l[t]+i[t])/i[t])}));return(o=[a,c]).concat.apply(o,_toConsumableArray(h))},Ri=function(e,t,n){return Fm(t,n),Em(e,t,n)},Em=function(e,t,n){var r=Lm(n,t),i=e.session.pack,o=1===r.kernelShape[0]&&1===r.kernelShape[1];return r.group>1?[e.run(tf(e,t,r),t)]:o&&i?[Pm(e,t,r)]:i&&4===t[0].dims.length&&1===t[0].dims[0]&&!o?[uf(e,t,r)]:[Dm(e,t,r)]},Pm=function(e,t,n){var r=t[0].dims,i=t[1].dims,o=qr(r,i,n.dilations,n.pads,n.strides),a=e.reshapeUnpacked(t[0],[r[1],r[2]*r[3]]),s=e.reshapeUnpacked(t[1],[i[0],i[1]]),u=t.length>2?[s,a,t[2]]:[s,a],c=e.run(Ci(u,n),u);return e.reshapeUnpacked(c,o)},Dm=function(e,t,n){var r=t[0].dims,i=t[1].dims,o=qr(r,i,n.dilations,n.pads,n.strides),a=e.run(ff(e,t[0],t[1],o,n),[t[0]]),s=3===t.length?[a,t[1],t[2]]:[a,t[1]];return e.run(cf(e,t,o,n),s)},Lm=function(e,t){var n=e.kernelShape.slice();if(0===e.kernelShape.length)for(var r=2;r<t[1].dims.length;++r)n.push(t[1].dims[r]);var i=e.pads.slice();xr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,n,i,e.autoPad);var o=Object.assign({},e);return Object.assign(o,{kernelShape:n,pads:i,cacheKey:e.cacheKey}),o},Mi=function(e){var t=e.attributes,n=jr(t),r=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("pads",[0,0,0,0]),u=t.getInts("strides",[1,1]);return te(_objectSpread({autoPad:r,dilations:i,group:o,kernelShape:a,pads:s,strides:u},n))},Fm=function(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");var n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error("dilations should be ".concat(n,"D"));if(t.strides.length!==n)throw new Error("strides should be ".concat(n,"D"));if(t.pads.length!==2*n)throw new Error("pads should be ".concat(2*n,"D"));if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("Conv input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("Conv input(bias) should be float tensor")}})),Cm,$m,Bm,df,km,Nm,Rm,Mm,Gm,Um,hf,zm,mf=L((function(){Ge(),ve(),ae(),Ir(),Cm=function(e,t,n,r,i,o){return(e-1)*t+n+(r-1)*i+1-o},$m=function(e,t,n,r,i){var o=Math.floor(e/2);"SAME_UPPER"===t?(n[r]=o,n[i]=e-o):"SAME_LOWER"===t&&(n[r]=e-o,n[i]=o)},Bm=function(e,t,n,r,i,o,a,s){for(var u=e.length-2,c=0===s.length,l=0;l<u;++l){var h=c?e[l+2]*o[l]:s[l],f=Cm(e[l+2],o[l],i[l],t[l],n[l],h);$m(f,r,i,l,l+u),c&&s.push(o[l]*(e[l+2]-1)+a[l]+(t[l]-1)*n[l]+1-i[l]-i[l+u])}},df=function(e,t,n){return zm(t,n),km(e,t,n)},km=function(e,t,n){var r=Um(n,t);return[Gm(e,t,r)]},Nm=function(e,t){return{name:"ConvTranspose",inputNames:e?["X","W","B"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}},Rm=function(e,t,n,r){var i=t.length>2?"getB(output_channel)":"0.0",o=t[0].dims,a=t[1].dims,s=a[1],u=a[0]/r.group,c=[t[0].dims[0],t[1].dims[1]*r.group].concat(_toConsumableArray(r.outputShape)),l=q(e.session.backend.glContext.version),h=Nt(r),f=h.activationFunction,d=h.applyActivation,p="\n  const ivec2 strides = ivec2(".concat(r.strides[0],", ").concat(r.strides[1],");\n  const ivec2 pads = ivec2(").concat(r.pads[0],", ").concat(r.pads[1],");\n  ").concat(f,"\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n\n    ivec2 loc = coords.zw + pads;\n\n    int group_id = output_channel / ").concat(s,";\n    int wOutChannel = output_channel - group_id * ").concat(s,";\n\n    float value = ").concat(i,";\n    for (int inChannelOffset = 0; inChannelOffset < ").concat(u,"; inChannelOffset++) {\n      int input_channel = group_id * ").concat(u," + inChannelOffset;\n      for (int wWOff = 0; wWOff < ").concat(a[2],"; wWOff++) {\n        for (int wHOff = 0; wHOff < ").concat(a[3],"; wHOff++) {\n          ivec2 wOff = ivec2(wWOff * ").concat(r.dilations[0],", wHOff * ").concat(r.dilations[1],");\n          ivec2 wLoc = loc - wOff;\n          ivec2 wLocIn = wLoc / strides;\n          if (\n            wLocIn * strides == wLoc &&\n            wLocIn.x >= 0 && wLocIn.x < ").concat(o[2]," &&\n            wLocIn.y >= 0 && wLocIn.y < ").concat(o[3],"\n          ) {\n            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);\n            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);\n            value += xVal * wVal;\n          }\n        }\n      }\n    }\n    ").concat(d,"\n    ").concat(l.output," = vec4(value, .0, .0, .0);\n  }\n");return _objectSpread(_objectSpread({},n),{},{output:{dims:c,type:t[0].type,textureType:0},shaderSource:p,hasMain:!0})},Mm=function(e,t,n){var r=Nm(t.length>2,n.cacheKey);return _objectSpread(_objectSpread({},r),{},{get:function(){return Rm(e,t,r,n)}})},Gm=function(e,t,n){return e.run(Mm(e,t,n),t)},Um=function(e,t){var n=e.kernelShape.slice();if(0===e.kernelShape.length)for(var r=2;r<t[1].dims.length;++r)n.push(t[1].dims[r]);var i=e.pads.slice(),o=e.outputShape.slice(),a=t[0].dims;Bm(a,n,e.dilations,e.autoPad,i,e.strides,e.outputPadding,o);var s=Object.assign({},e);return Object.assign(s,{kernelShape:n,pads:i,outputShape:o,cacheKey:e.cacheKey}),s},hf=function(e){var t=e.attributes,n=jr(t),r=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("output_padding",[0,0]),u=t.getInts("output_shape",[]),c=t.getInts("pads",[0,0,0,0]),l=t.getInts("strides",[1,1]);return te(_objectSpread({autoPad:r,dilations:i,group:o,kernelShape:a,outputPadding:s,outputShape:u,pads:c,strides:l},n))},zm=function(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");var n=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==n))throw new Error("invalid bias");var r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error("dilations should be ".concat(r,"D"));if(t.strides.length!==r)throw new Error("strides should be ".concat(r,"D"));if(t.pads.length!==2*r)throw new Error("pads should be ".concat(2*r,"D"));if(t.outputPadding.length!==r)throw new Error("output_padding should be ".concat(r,"D"));if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("ConvTranspose input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("ConvTranspose input(bias) should be float tensor")}})),bf,Sr,gf,Wm,yf,Vm,Hm,jm,ho=L((function(){Ge(),fe(),ae(),bf={name:"Transpose",inputNames:["A"],inputTypes:[0]},Sr=function(e,t,n){return jm(t),[e.run(_objectSpread(_objectSpread({},bf),{},{cacheHint:n.cacheKey,get:function(){return Wm(e,t[0],n.perm)}}),t)]},gf=function(e){return te({perm:e.attributes.getInts("perm",[])})},Wm=function(e,t,n){var r=t.dims;n=yf(r,n);var i=Vm(r,n),o=r.length,a="\n      ".concat(Hm("perm",n,o),"\n      float process(int indices[").concat(o,"]) {\n        int a[").concat(o,"];\n        perm(a, indices);\n        return _A(a);\n      }");return _objectSpread(_objectSpread({},bf),{},{output:{dims:i,type:t.type,textureType:0},shaderSource:a})},yf=function(e,t){return t&&t.length!==e.length&&(t=_toConsumableArray(e.keys()).reverse()),t},Vm=function(e,t){return t=yf(e,t),z.sortBasedOnPerm(e,t)},Hm=function(e,t,n){var r=[];r.push("void ".concat(e,"(out int a[").concat(n,"], int src[").concat(n,"]) {"));for(var i=0;i<n;++i)r.push("\ta[".concat(t[i],"]=src[").concat(i,"];"));return r.push("\t}"),r.join("\n")},jm=function(e){if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("input should be float tensor")}})),Tf,xf,qm,wf=L((function(){ho(),Tf=function(e,t,n){qm(t);var r=n.blocksize,i=r*r,o="DCR"===n.mode?[0,3,4,1,5,2]:[0,1,4,2,5,3],a="DCR"===n.mode?[t[0].dims[0],r,r,t[0].dims[1]/i,t[0].dims[2],t[0].dims[3]]:[t[0].dims[0],t[0].dims[1]/i,r,r,t[0].dims[2],t[0].dims[3]],s=e.reshapeUnpacked(t[0],a),u={perm:o,cacheKey:"".concat(o)},c=_slicedToArray(Sr(e,[s],u),1)[0],l=[t[0].dims[0],t[0].dims[1]/i,t[0].dims[2]*r,t[0].dims[3]*r];return[e.reshapeUnpacked(c,l)]},xf=function(e){var t=e.attributes.getInt("blocksize");if(t<1)throw new Error("blocksize must be >= 1, but got : ".concat(t," for DepthToSpace"));var n=e.attributes.getString("mode","DCR");if("DCR"!==n&&"CRD"!==n)throw new Error("unrecognized mode: ".concat(n," for DepthToSpace"));return{mode:n,blocksize:t}},qm=function(e){if(1!==e.length)throw new Error("DepthToSpace expect 1 inputs, but got ".concat(e.length));if("string"===e[0].type||4!==e[0].dims.length)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}})),vf,_f,Ym,Of=L((function(){fe(),vf=function(e,t,n){Ym(t,n);var r=z.flattenShape(t[0].dims,n);return[e.reshapeUnpacked(t[0],r)]},_f=function(e){return e.attributes.getInt("axis",1)},Ym=function(e,t){if(!e||1!==e.length)throw new Error("Flatten requires 1 input.");var n=e[0].dims.length;if(0===n)throw new Error("scalar tensor is not supported.");if(t<-n||t>n)throw new Error("Invalid axis");if("string"===e[0].type)throw new Error("string tensor is not supported.")}})),rr,yn=L((function(){rr=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]})),If,Sf,Xm,Km,Jm,Zm,Af=L((function(){Ge(),yn(),fe(),ae(),If=function(e,t,n){return Zm(t,n.axis),[e.run(Jm(e,t,n),t)]},Sf=function(e){return te({axis:e.attributes.getInt("axis",0)})},Xm={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},Km=function(e,t,n,r){var i=n[0].dims.slice(),o=n[1].dims.slice(),a=new Array(i.length+o.length-1);r=z.normalizeAxis(r,i.length);for(var s=[],u=0;u<a.length;u++)u<r?(a[u]=i[u],s.push("inputIdx[".concat(u,"] = outputIdx[").concat(u,"];"))):u<r+o.length?(a[u]=o[u-r],s.push("indexDataIdx[".concat(u-r,"] = outputIdx[").concat(u,"];"))):(a[u]=i[u-o.length+1],s.push("inputIdx[".concat(u-o.length+1,"] = outputIdx[").concat(u,"];")));var c="\n      float process(int outputIdx[".concat(a.length||1,"]) {\n        int inputIdx[").concat(i.length,"];\n        int indexDataIdx[").concat(o.length||1,"];\n        indexDataIdx[0] = 0;\n        ").concat(s.join("\n        "),"\n        int idx = int(_B(indexDataIdx));\n        inputIdx[").concat(r,"] = idx < 0 ? idx + ").concat(i[r]," : idx;\n        return _A(inputIdx);\n      }");return _objectSpread(_objectSpread({},t),{},{output:{dims:a,type:n[0].type,textureType:0},shaderSource:c})},Jm=function(e,t,n){var r=_objectSpread(_objectSpread({},Xm),{},{cacheHint:n.cacheKey});return _objectSpread(_objectSpread({},r),{},{get:function(){return Km(e,r,t,n.axis)}})},Zm=function(e,t){if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.");var n=e[0].dims.length;if(n<1)throw new Error("Invalid input shape.");if(t<-n||t>n-1)throw new Error("Invalid axis.");if(-1===rr.indexOf(e[0].type))throw new Error("Invaid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invaid input type.")}})),Gi,Ef,Pf,Df,Qm,eb,tb,Lf=L((function(){Ge(),fe(),ae(),Gi=function(e,t,n){return tb(t,n),[e.run(Qm(t,n),t)]},Ef=function(e,t){var n=0!==e.attributes.getInt("transA",0),r=0!==e.attributes.getInt("transB",0),i=e.attributes.getFloat("alpha",1),o=e.attributes.getFloat("beta",1);return te({transA:n,transB:r,alpha:i,beta:o,isOptionalC:t})},Pf=function(e){return Ef(e,!1)},Df=function(e){return Ef(e,!0)},Qm=function(e,t){var n={name:"Gemm",inputNames:3===e.length?["A","B","C"]:["A","B"],inputTypes:3===e.length?[0,0,0]:[0,0],key:t.cacheKey};return _objectSpread(_objectSpread({},n),{},{get:function(){return eb(n,e,t)}})},eb=function(e,t,n){var r=t[0].dims.slice(),i=t[1].dims.slice(),o=_slicedToArray(ro.getShapeOfGemmResult(r,n.transA,i,n.transB,3===t.length?t[2].dims:void 0),2),a=[o[0],o[1]];if(!a)throw new Error("Can't use gemm on the given tensors");var s=r[r.length-1],u="";n.transA&&(s=r[0]),n.transA&&n.transB?u="value += _A_T(a) * _B_T(b);":n.transA&&!n.transB?u="value += _A_T(a) * _B(b);":!n.transA&&n.transB?u="value += _A(a) * _B_T(b);":!n.transA&&!n.transB&&(u="value += _A(a) * _B(b);");var c=a.length,l="\n      float process(int indices[".concat(c,"]) {\n          int a[").concat(c,"];\n          int b[").concat(c,"];\n          ").concat(3===t.length?"int c[".concat(t[2].dims.length,"];"):"","\n\n          copyVec(indices, a);\n          copyVec(indices, b);\n          ").concat(3===t.length?"bcastIndices_C(indices, c);":"","\n\n          float value = 0.0;\n          for (int k=0; k<").concat(s,"; ++k) {\n              a[").concat(c-1,"] = k;\n              b[").concat(c-2,"] = k;\n              ").concat(u,"\n          }\n\n          value = value * alpha;\n          ").concat(3===t.length?"value += beta * _C(c);":"","\n          return value;\n      }");return _objectSpread(_objectSpread({},e),{},{output:{dims:a,type:t[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:n.alpha},{name:"beta",type:"float",data:n.beta}],shaderSource:l})},tb=function(e,t){if(!e)throw new Error("Input is missing");if(t.isOptionalC&&(e.length<2||e.length>3))throw new Error("Invaid input shape.");if(!t.isOptionalC&&3!==e.length)throw new Error("Gemm requires 3 inputs");if(3===e.length&&1!==e[2].dims.length&&2!==e[2].dims.length)throw new Error("Invalid input shape of C");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type||3===e.length&&"float32"!==e[2].type&&"float64"!==e[2].type)throw new Error("Invalid input type.");if(e[0].type!==e[1].type||3===e.length&&e[0].type!==e[2].type)throw new Error("Input types are mismatched")}})),Ff,Cf,rb,nb,ob,ib,ab,$f=L((function(){Ge(),ae(),Ff=function(e,t,n){return ab(t),[e.run(ob(e,t,n),t)]},Cf=function(e){var t=e.attributes.getFloat("scale"),n=e.attributes.getFloats("bias");return te({scale:t,bias:n})},rb={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},nb=function(e,t,n,r){var i=n[0].dims.slice(),o=i.length,a="\n      ".concat(ib(r.bias.length),"\n      float process(int indices[").concat(o,"]) {\n        return _X(indices) * scale + getBias(bias, indices[1]);\n      }");return _objectSpread(_objectSpread({},t),{},{output:{dims:i,type:n[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:r.bias.length,data:r.bias},{name:"scale",type:"float",data:r.scale}],shaderSource:a})},ob=function(e,t,n){var r=_objectSpread(_objectSpread({},rb),{},{cacheHint:n.cacheKey});return _objectSpread(_objectSpread({},r),{},{get:function(){return nb(e,r,t,n)}})},ib=function(e){for(var t=["float getBias(float bias[".concat(e,"], int channel) {")],n=0;n<e;++n)0===n?t.push("\tif (channel == ".concat(n,") { return bias[").concat(n,"]; }")):n===e-1?t.push("\telse { return bias[".concat(n,"]; }")):t.push("\telse if (channel == ".concat(n,") { return bias[").concat(n,"]; }"));return t.push("\t}"),t.join("\n")},ab=function(e){if(!e||1!==e.length)throw new Error("ImageScaler requires 1 input.");if(4!==e[0].dims.length)throw new Error("Invalid input shape.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")}})),kf,Nf,Bf,sb,ub,lb,fb,cb,pb,Rf=L((function(){ve(),ae(),kf=function(e,t,n){pb(t);var r=e.run(ub(t[0]),t);return[e.run(cb(e,t[0],n,r.dims),[t[0],r,t[1],t[2]])]},Nf=function(e){return e.attributes.getFloat("epsilon",1e-5)},Bf={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},sb=function(e,t){var n=t.dims.slice(),r=n[1],i=n[2]*n[3],o=[n[0],r],a="\n      vec4 process(int[2] indices) {\n        vec4 v = vec4(0.0);\n        int a[4];\n        a[0] = indices[0];\n        a[1] = indices[1];\n        float temp = 0.0;\n        for(int a2=0; a2<".concat(n[2],"; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<").concat(n[3],"; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += x;\n          }\n        }\n        float mean = temp / float(").concat(i,");\n        temp = 0.0;\n        for(int a2=0; a2<").concat(n[2],"; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<").concat(n[3],"; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += (x - mean) * (x - mean);\n          }\n        }\n        v.r = mean;\n        v.g = temp / float(").concat(i,");\n\n        return v;\n      }");return _objectSpread(_objectSpread({},e),{},{output:{dims:o,type:t.type,textureType:4},shaderSource:a})},ub=function(e){return _objectSpread(_objectSpread({},Bf),{},{get:function(){return sb(Bf,e)}})},lb={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},fb=function(e,t,n,r,i){var o=q(e.session.backend.glContext.version),a=_slicedToArray(e.calculateTextureWidthAndHeight(i,4),2),s=a[0],u=a[1],c="\n      vec4 get_MeanAndVariance(int[2] mv) {\n        int offset = indicesToOffset_MeanAndVariance(mv);\n        vec2 coords = offsetToCoords(offset, ".concat(s/4,", ").concat(u,");\n        return ").concat(o.texture2D,"(MeanAndVariance, coords);\n      }\n\n      float process(int[4] indices) {\n        int mv[2];\n        mv[0] = indices[0];\n        mv[1] = indices[1];\n        vec4 mean_and_variance = get_MeanAndVariance(mv);\n        float mean = mean_and_variance.r;\n        float variance = mean_and_variance.g;\n\n        int sb[1];\n        sb[0] = indices[1];\n        float scale = _Scale(sb);\n        float b = _B(sb);\n\n        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;\n      }");return _objectSpread(_objectSpread({},t),{},{output:{dims:n.dims,type:n.type,textureType:0},variables:[{name:"epsilon",type:"float",data:r}],shaderSource:c})},cb=function(e,t,n,r){var i=_objectSpread(_objectSpread({},lb),{},{cacheHint:"".concat(n)});return _objectSpread(_objectSpread({},i),{},{get:function(){return fb(e,i,t,n,r)}})},pb=function(e){if(!e||3!==e.length)throw new Error("InstanceNormalization requires 3 inputs.");var t=e[0],n=e[1],r=e[2];if(t.dims.length<3||1!==n.dims.length||1!==r.dims.length)throw new Error("Invalid input shape.");if(n.dims[0]!==t.dims[1]||r.dims[0]!==t.dims[1])throw new Error("Input shapes are mismatched.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==r.type&&"float64"!==r.type)throw new Error("Invalid input type.");if(4!==e[0].dims.length)throw new Error("Only support 4-D input shape.")}}));function db(e,t){var n=e[0].dims[1],r=e[0].dims.length,i=-Math.floor((t.size-1)/2),o=Math.ceil((t.size-1)/2),a="float(".concat(t.alpha,") / float(").concat(t.size,")"),s="\n    float process(int indices[".concat(r,"]) {\n        int c = indices[1];\n        float x = _X(indices);\n        float square_sum = 0.0;\n\n        for (int i = ").concat(i,"; i <= ").concat(o,"; i++) {\n          int idx = c + i;\n          if (c >= 0 && c < ").concat(n,") {\n            indices[1] = idx;\n            float j = _X(indices);\n            square_sum += j * j;\n          }\n        }\n        return x / pow(","float(".concat(t.bias,")")," + ").concat(a," * square_sum, ","float(".concat(t.beta,")"),");\n    }");return _objectSpread(_objectSpread({},Uf),{},{cacheHint:t.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:s})}function hb(e,t){return _objectSpread(_objectSpread({},Uf),{},{cacheHint:t.cacheKey,get:function(){return db(e,t)}})}var Mf,Gf,Uf,mb,zf=L((function(){Ge(),ae(),Mf=function(e,t,n){return mb(t),[e.run(hb(t,n),t)]},Gf=function(e){var t=e.attributes.getFloat("alpha",1e-4),n=e.attributes.getFloat("beta",.75),r=e.attributes.getFloat("bias",1),i=e.attributes.getInt("size");return te({alpha:t,beta:n,bias:r,size:i})},Uf={name:"LRN",inputNames:["X"],inputTypes:[0]},mb=function(e){if(!e||1!==e.length)throw new Error("LRN requires 1 input.");if(4!==e[0].dims.length)throw new Error('currently only support LRN for input with "NCHW" format');if("float32"!==e[0].type)throw new Error("input should be float type")}})),bb,Ui,Wf,Vf,Hf,gb,yb,Tb,xb,wb,vb,_b,Ob,jf=L((function(){Ge(),fe(),ve(),ae(),bb={name:"Pad",inputNames:["A"],inputTypes:[0]},Ui=function(e,t,n){return Tb(t),[e.run(_objectSpread(_objectSpread({},bb),{},{cacheHint:n.cacheKey,get:function(){return yb(e,t[0],n)}}),t)]},Wf=function(e){var t=e.attributes.getString("mode","constant"),n=e.attributes.getFloat("value",0),r=e.attributes.getInts("pads");return te({mode:t,value:n,pads:r})},Vf=function(e,t,n){xb(t);var r=gb(e,t,n);return Ui(e,[t[0]],r)},Hf=function(e){return e.attributes.getString("mode","constant")},gb=function(e,t,n){if(!e.session.isInitializer(t[1].dataId)||t.length>=3&&!e.session.isInitializer(t[2].dataId))throw new Error("dynamic pad attributes are not allowed");var r=Array.from(t[1].integerData),i=t.length>=3?t[2].floatData[0]:0;return te({mode:n,pads:r,value:i})},yb=function(e,t,n){var r=z.padShape(t.dims.slice(),n.pads),i=r.length,o="\n      ".concat(wb(e,t,n),"\n      float process(int[").concat(i,"] indices) {\n          return padA(indices);\n      }");return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:r,type:t.type,textureType:0},shaderSource:o}},Tb=function(e){if(!e||1!==e.length)throw new Error("Pad requires 1 input");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},xb=function(e){if(!e||2!==e.length&&3!==e.length)throw new Error("Pad requires 2 or 3 inputs");if("int32"!==e[1].type)throw new Error("Invalid input type.");if(e.length>=3&&"string"===e[2].type)throw new Error("Invalid input type.")},wb=function(e,t,n){var r=q(e.session.backend.glContext.version),i=_slicedToArray(e.calculateTextureWidthAndHeight(t.dims,0),2),o=i[0],a=i[1],s=z.computeStrides(t.dims);switch(n.mode){case"constant":return vb(r,t.dims,s,o,a,n.pads,n.value);case"reflect":return _b(r,t.dims,s,o,a,n.pads);case"edge":return Ob(r,t.dims,s,o,a,n.pads);default:throw new Error("Invalid mode")}},vb=function(e,t,n,r,i,o,a){for(var s=t.length,u="",c=s-1;c>=0;--c)u+="\n        k = m[".concat(c,"] - ").concat(o[c],";\n        if (k < 0)  return constant;\n        if (k >= ").concat(t[c],") return constant;\n        offset += k * ").concat(n[c],";\n        ");return"\n      float padA(int m[".concat(s,"]) {\n        const float constant = float(").concat(a,");\n        int offset = 0;\n        int k = 0;\n        ").concat(u,"\n        vec2 coords = offsetToCoords(offset, ").concat(r,", ").concat(i,");\n        float value = getColorAsFloat(").concat(e.texture2D,"(A, coords));\n        return value;\n      }\n      ")},_b=function(e,t,n,r,i,o){for(var a=t.length,s="",u=a-1;u>=0;--u)s+="\n        k = m[".concat(u,"] - ").concat(o[u],";\n        if (k < 0) { k = -k; }\n        {\n          const int _2n_1 = ").concat(2*(t[u]-1),";\n          k = int( mod( float(k), float(_2n_1) ) ) ;\n          if(k >= ").concat(t[u],") { k = _2n_1 - k; }\n        }\n        offset += k * ").concat(n[u],";\n        ");return"\n      float padA(int m[".concat(a,"]) {\n        int offset = 0;\n        int k = 0;\n        ").concat(s,"\n        vec2 coords = offsetToCoords(offset, ").concat(r,", ").concat(i,");\n        float value = getColorAsFloat(").concat(e.texture2D,"(A, coords));\n        return value;\n      }\n      ")},Ob=function(e,t,n,r,i,o){for(var a=t.length,s="",u=a-1;u>=0;--u)s+="\n        k = m[".concat(u,"] - ").concat(o[u],";\n        if (k < 0)  k = 0;\n        if (k >= ").concat(t[u],") k = ").concat(t[u]-1,";\n        offset += k * ").concat(n[u],";\n      ");return"\n      float padA(int m[".concat(a,"]) {\n        int offset = 0;\n        int k = 0;\n        ").concat(s,"\n        vec2 coords = offsetToCoords(offset, ").concat(r,", ").concat(i,");\n        float value = getColorAsFloat(").concat(e.texture2D,"(A, coords));\n        return value;\n      }\n      ")}})),Yf,Xf,Kf,Jf,Zf,Qf,ec,tc,rc,Ib,qf,nc,bo,oc,mo,Sb,ic=L((function(){Ge(),fe(),ae(),Yf=function(e,t,n){bo(t);var r={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[e.run(_objectSpread(_objectSpread({},r),{},{get:function(){return Kf(t,r,!1,n)}}),t)]},Xf=function(e){var t=e.attributes.getString("auto_pad","NOTSET"),n=e.attributes.getInt("ceil_mode",0),r=0!==e.attributes.getInt("count_include_pad",0),i=e.attributes.getInts("kernel_shape"),o=e.attributes.getInts("strides",[]),a=e.attributes.getInts("pads",[]);if(0!==n)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return te({autoPad:t,ceilMode:n,countIncludePad:r,kernelShape:i,strides:o,pads:a})},Kf=function(e,t,n,r){var i=_slicedToArray(rc(e,r,n),2),o=i[0],a=i[1],s=z.size(o.kernelShape),u="";o.countIncludePad?u+="value /= float(".concat(s,");"):u+="value /= float(".concat(s," - pad);");var c="\n        ".concat(oc(e[0].dims,o,"value += _X(x);",u,"0.0"),"\n      ");return _objectSpread(_objectSpread({},t),{},{output:{dims:a,type:e[0].type,textureType:0},shaderSource:c})},Jf=function(e,t,n){bo(t);var r={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:"".concat(n.countIncludePad)};return[e.run(_objectSpread(_objectSpread({},r),{},{get:function(){return Kf(t,r,!0,n)}}),t)]},Zf=function(e){var t=0!==e.attributes.getInt("count_include_pad",0);return te({autoPad:"",ceilMode:0,countIncludePad:t,kernelShape:[],strides:[],pads:[]})},Qf=function(e,t,n){bo(t);var r={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[e.run(_objectSpread(_objectSpread({},r),{},{get:function(){return tc(t,r,!1,n)}}),t)]},ec=function(e){var t=e.attributes.getString("auto_pad","NOTSET"),n=e.attributes.getInt("ceil_mode",0),r=e.attributes.getInts("kernel_shape"),i=e.attributes.getInts("strides",[]),o=e.attributes.getInts("pads",[]),a=e.attributes.getInt("storage_order",0),s=e.attributes.getInts("dilations",[]);if(0!==a)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==n)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return te({autoPad:t,ceilMode:n,countIncludePad:!1,kernelShape:r,strides:i,pads:o,storageOrder:a,dilations:s})},tc=function(e,t,n,r){var i=_slicedToArray(rc(e,r,n),2),o=i[0],a=i[1],s="\n      ".concat(oc(e[0].dims,o,"\n      value = max(_X(x), value);\n    ","","-1e5"),"\n    ");return _objectSpread(_objectSpread({},t),{},{output:{dims:a,type:e[0].type,textureType:0},shaderSource:s})},rc=function(e,t,n){var r=e[0].dims.slice(),i=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),a=t.strides.slice(),s=i?t.dilations.slice():[],u=t.pads.slice();xr.adjustPoolAttributes(n,r,o,a,s,u);var c=xr.computePoolOutputShape(n,r,a,s,o,u,t.autoPad),l=Object.assign({},t);return i?Object.assign(l,{kernelShape:o,strides:a,pads:u,dilations:s,cacheKey:t.cacheKey}):Object.assign(l,{kernelShape:o,strides:a,pads:u,cacheKey:t.cacheKey}),[l,c]},Ib={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},qf={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},nc=function(e,t){return bo(t),[e.run(_objectSpread(_objectSpread({},qf),{},{get:function(){return tc(t,qf,!0,Ib)}}),t)]},bo=function(e){if(!e||1!==e.length)throw new Error("Pool ops requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},oc=function(e,t,n,r,i){var o=e.length;if(t.kernelShape.length<=2){var a,s=t.kernelShape[t.kernelShape.length-1],u=t.strides[t.strides.length-1],c=t.pads[t.pads.length/2-1],l=t.pads[t.pads.length-1],h=e[o-1],f="",d="";if(a=c+l!==0?"\n          for (int i = 0; i < ".concat(s,"; i++) {\n            x[").concat(o," - 1] = indices[").concat(o," - 1] * ").concat(u," - ").concat(c," + i;\n            if (x[").concat(o," - 1] < 0 || x[").concat(o," - 1] >= ").concat(h,") {\n              pad++;\n              continue;\n            }\n            ").concat(n,"\n          }"):"\n          for (int i = 0; i < ".concat(s,"; i++) {\n            x[").concat(o," - 1] = indices[").concat(o," - 1] * ").concat(u," - ").concat(c," + i;\n            ").concat(n,"\n          }"),2===t.kernelShape.length){var p=t.kernelShape[t.kernelShape.length-2],y=t.strides[t.strides.length-2],g=t.pads[t.pads.length/2-2],m=t.pads[t.pads.length-2],v=e[o-2];f=g+m!==0?"\n            for (int j = 0; j < ".concat(p,"; j++) {\n              x[").concat(o," - 2] = indices[").concat(o," - 2] * ").concat(y," - ").concat(g," + j;\n              if (x[").concat(o," - 2] < 0 || x[").concat(o," - 2] >= ").concat(v,") {\n                pad+= ").concat(s,";\n                continue;\n              }\n          "):"\n            for (int j = 0; j < ".concat(p,"; j++) {\n              x[").concat(o," - 2] = indices[").concat(o," - 2] * ").concat(y," - ").concat(g," + j;\n            "),d="\n          }\n        "}return"\n        float process(int indices[".concat(o,"]) {\n          int x[").concat(o,"];\n          copyVec(indices, x);\n\n          float value = ").concat(i,";\n          int pad = 0;\n          ").concat(f,"\n          ").concat(a,"\n          ").concat(d,"\n          ").concat(r,"\n          return value;\n        }\n      ")}var w,b=z.size(t.kernelShape),x=z.computeStrides(t.kernelShape),_=x.length,I=t.pads.length,A=Sb(_),C=mo(e,"inputDims"),k=mo(t.pads,"pads"),S=mo(x,"kernelStrides"),T=mo(t.strides,"strides");return w=t.pads.reduce((function(e,t){return e+t}))?"\n            if (x[j] >= inputDims[j] || x[j] < 0) {\n              pad++;\n              isPad = true;\n              break;\n            }\n          }\n          if (!isPad) {\n            ".concat(n,"\n          }"):"\n          }\n          ".concat(n,"\n        "),"\n        ".concat(A,"\n        float process(int indices[").concat(o,"]) {\n          int x[").concat(o,"];\n          copyVec(indices, x);\n          int offset[").concat(_,"];\n          int pads[").concat(I,"];\n          int inputDims[").concat(o,"];\n          int kernelStrides[").concat(_,"];\n          int strides[").concat(_,"];\n          ").concat(k,"\n          ").concat(C,"\n          ").concat(T,"\n          ").concat(S,"\n\n          float value = ").concat(i,";\n          int pad = 0;\n          bool isPad = false;\n          for (int i = 0; i < ").concat(b,"; i++) {\n            offsetToIndices(i, kernelStrides, offset);\n            isPad = false;\n            for (int j = ").concat(o," - ").concat(_,"; j < ").concat(o,"; j++) {\n              x[j] = indices[j] * strides[j - ").concat(o," + ").concat(_,"]\n                + offset[j - ").concat(o," + ").concat(_,"] - pads[j - 2];\n              ").concat(w,"\n          }\n          ").concat(r,"\n\n          return value;\n        }\n      ")},mo=function(e,t){for(var n="",r=0;r<e.length;r++)n+="\n      ".concat(t,"[").concat(r,"] = ").concat(e[r],";\n    ");return n},Sb=function(e){return"\n  void offsetToIndices(int offset, int[".concat(e,"] strides, out int[").concat(e,"] indices) {\n    if (").concat(e," == 0) {\n      return;\n    }\n    for (int i = 0; i < ").concat(e," - 1; ++i) {\n      indices[i] = offset / strides[i];\n      offset -= indices[i] * strides[i];\n    }\n    indices[").concat(e," - 1] = offset;\n  }")}})),Ar,nr,Ab,Eb,ac,sc,uc,lc,fc,cc,pc,dc=L((function(){Ge(),yn(),fe(),ae(),Ar=function(e,t,n,r,i){Eb(t);var o={name:r,inputNames:["A"],inputTypes:[0]};return[e.run(_objectSpread(_objectSpread({},o),{},{cacheHint:n.cacheKey,get:function(){return Ab(e,t,n,r,i,o)}}),t)]},nr=function(e){var t=e.attributes.getInts("axes",[]),n=1===e.attributes.getInt("keepdims",1);return te({axes:t,keepDims:n})},Ab=function(e,t,n,r,i,o){for(var a=[],s=t[0].dims.length||1,u=[],c=z.normalizeAxes(n.axes,t[0].dims.length),l=i(t,c),h=l[1],f=0;f<t[0].dims.length;f++)c.indexOf(f)>=0||0===c.length?(n.keepDims&&a.push(1),h="\n          for(int j".concat(f," = 0; j").concat(f," < ").concat(t[0].dims[f],"; j").concat(f,"++) {\n            inputIdx[").concat(f,"] = j").concat(f,";\n            ").concat(h,"\n          }")):(u.push("inputIdx[".concat(f,"] = outputIdx[").concat(a.length,"];")),a.push(t[0].dims[f]));var d="\n      float process(int outputIdx[".concat(a.length||1,"]) {\n        float value;                 // final result\n        int inputIdx[").concat(s,"];      // addressing input data\n        ").concat(u.join("\n"),"\n        ").concat(l[0],"       // init ops for reduce max/min\n        ").concat(h,"\n        ").concat(l[2],"       // final computation for reduce mean\n        return value;\n      }");return _objectSpread(_objectSpread({},o),{},{output:{dims:a,type:t[0].type,textureType:0},shaderSource:d})},Eb=function(e){if(!e||1!==e.length)throw new Error("Reduce op requires 1 input.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.")},ac=function(e,t,n){return Ar(e,t,n,"ReduceSum",(function(){return["value = 0.0;","value += _A(inputIdx);",""]}))},sc=function(e,t,n){return Ar(e,t,n,"ReduceMean",(function(e,t){for(var n=1,r=0;r<e[0].dims.length;r++)(t.indexOf(r)>=0||0===t.length)&&(n*=e[0].dims[r]);return["value = 0.0;","value += _A(inputIdx);","value /= ".concat(n,".;")]}))},uc=function(e,t,n){return Ar(e,t,n,"ReduceMax",(function(e,t){for(var n=[],r=0;r<e[0].dims.length;r++)(t.indexOf(r)>=0||0===t.length)&&n.push("inputIdx[".concat(r,"] = 0;"));return["".concat(n.join("\n"),"\nvalue = _A(inputIdx);"),"value = max(value, _A(inputIdx));",""]}))},lc=function(e,t,n){return Ar(e,t,n,"ReduceMin",(function(e,t){for(var n=[],r=0;r<e[0].dims.length;r++)(t.indexOf(r)>=0||0===t.length)&&n.push("inputIdx[".concat(r,"] = 0;"));return["".concat(n.join("\n"),"\nvalue = _A(inputIdx);"),"value = min(value, _A(inputIdx));",""]}))},fc=function(e,t,n){return Ar(e,t,n,"ReduceProd",(function(){return["value = 1.0;","value *= _A(inputIdx);",""]}))},cc=function(e,t,n){return Ar(e,t,n,"ReduceLogSum",(function(){return["value = 0.0;","value += _A(inputIdx);","value = log(value);"]}))},pc=function(e,t,n){return Ar(e,t,n,"ReduceLogSumSquare",(function(){return["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""]}))}})),hc,mc=L((function(){fe(),hc=function(e,t){var n=z.calculateReshapedDims(t[0].dims,t[1].integerData);return e.session.pack?[e.reshapePacked(t[0],n)]:[e.reshapeUnpacked(t[0],n)]}})),bc,zi,gc,yc,Tn,Pb,Wi,go,Vi=L((function(){Ge(),ve(),ae(),bc={name:"Upsample",inputNames:["X"],inputTypes:[0]},zi=function(e,t,n){return Wi(t,n),[e.run(_objectSpread(_objectSpread({},bc),{},{cacheHint:n.cacheKey,get:function(){return Pb(e,t,n)}}),t)]},gc=function(e){return Tn(e,7)},yc=function(e){return Tn(e,9)},Tn=function(e,t){var n=t>=10,r=e.attributes.getString("mode","nearest");if("nearest"!==r&&"linear"!==r&&(t<11||"cubic"!==r))throw new Error("unrecognized mode: ".concat(r));var i=[];t<9&&(i=e.attributes.getFloats("scales"),go(i,r,n));var o=e.attributes.getFloat("extrapolation_value",0),a=t>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(-1===["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(a))throw new Error("coordinate_transform_mode '".concat(a,"' is not supported"));var s="tf_crop_and_resize"===a,u=s,c="nearest"===r&&t>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(-1===["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(c))throw new Error("nearest_mode '".concat(c,"' is not supported"));var l=e.attributes.getFloat("cubic_coeff_a",-.75),h=0!==e.attributes.getInt("exclude_outside",0);if(h&&"cubic"!==r)throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");var f=t<11||"nearest"===r&&"asymmetric"===a&&"floor"===c,d=0,p=0,y=0;return t>10?e.inputs.length>2?(d=1,p=2,y=3):(p=1,y=2):9===t&&(p=1),te({opset:t,isResize:n,mode:r,scales:i,extrapolationValue:o,coordinateTransformMode:a,useExtrapolation:u,needRoiInput:s,nearestMode:c,cubicCoefficientA:l,excludeOutside:h,useNearest2xOptimization:f,roiInputIdx:d,scalesInputIdx:p,sizesInputIdx:y})},Pb=function(e,t,n){for(var r=q(e.session.backend.glContext.version),i=_slicedToArray(e.calculateTextureWidthAndHeight(t[0].dims,0),2),o=i[0],a=i[1],s=t[0].dims.map((function(e,t){return Math.floor(e*n.scales[t])})),u=_slicedToArray(e.calculateTextureWidthAndHeight(s,0),2),c=u[0],l=u[1],h=s.length,f=new Array(h),d=new Array(h),p="\n      int output_pitches[".concat(h,"];\n      int input_pitches[").concat(h,"];\n      "),y=h-1;y>=0;y--)f[y]=y===h-1?1:f[y+1]*s[y+1],d[y]=y===h-1?1:d[y+1]*t[0].dims[y+1],p+="\n        output_pitches[".concat(y,"] = ").concat(f[y],";\n        input_pitches[").concat(y,"] = ").concat(d[y],";\n        ");var g="\n      float getInputFloat(int index) {\n        vec2 coords = offsetToCoords(index, ".concat(o,", ").concat(a,");\n        float value = getColorAsFloat(").concat(r.texture2D,"(X, coords));\n        return value;\n      }\n      "),m="nearest"===n.mode?"\n    ".concat(g,"\n    float process(int indices[").concat(h,"]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ").concat(c,", ").concat(l,");\n\n      ").concat(p,"\n\n      int d, m;\n      for (int dim = 0; dim < ").concat(h,"; ++dim) {\n        d = output_index / output_pitches[dim];\n        m = output_index - d * output_pitches[dim];\n        output_index = m;\n\n        if (scales[dim] != 1 && d > 0) {\n          int d2 = d / scales[dim];\n          m = d - d2 * scales[dim];\n          d = d2;\n        }\n        input_index += input_pitches[dim] * d;\n      }\n\n      return getInputFloat(input_index);\n    }"):4===h?"\n    ".concat(g,"\n    float process(int indices[4]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ").concat(c,", ").concat(l,");\n\n      ").concat(p,"\n\n      int m;\n      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m / output_pitches[1];\n      m = m - index_of_dim1 * output_pitches[1];\n      index_of_dim2 = m / output_pitches[2];\n      m = m - index_of_dim2 * output_pitches[2];\n      index_of_dim3 = m;\n\n      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;\n      index_of_input_dim2 = index_of_dim2 / scales[2];\n      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];\n      index_of_input_dim3 = index_of_dim3 / scales[3];\n      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];\n\n      input_index = index_of_dim0 * input_pitches[0] +\n            index_of_dim1 * input_pitches[1] +\n            index_of_input_dim2 * input_pitches[2] +\n            index_of_input_dim3;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim2 = false;\n      if (index_of_input_dim2 == (").concat(t[0].dims[2]," - 1)) {\n        // It's the end in dimension 2\n        x01 = x00;\n        end_of_dim2 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[2]);\n      }\n\n      if (index_of_input_dim3 == (input_pitches[2] - 1)) {\n        // It's the end in dimension 3\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);\n    }"):"\n    ".concat(g,"\n    float process(int indices[2]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ").concat(c,", ").concat(l,");\n\n      ").concat(p,"\n\n      int m;\n      int index_of_dim0, index_of_dim1;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m;\n\n      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;\n      index_of_input_dim0 = index_of_dim0 / scales[0];\n      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];\n      index_of_input_dim1 = index_of_dim1 / scales[1];\n      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];\n\n      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim0 = false;\n      if (index_of_input_dim0 == (").concat(t[0].dims[0]," - 1)) {\n        // It's the end in dimension 0\n        x01 = x00;\n        end_of_dim0 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[0]);\n      }\n\n      if (index_of_input_dim1 == (input_pitches[0] - 1)) {\n        // It's the end in dimension 1\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);\n    }");return _objectSpread(_objectSpread({},bc),{},{output:{dims:s,type:t[0].type,textureType:0},shaderSource:m,variables:[{name:"scales",type:"int",arrayLength:n.scales.length,data:n.scales.map((function(e){return Math.ceil(e)}))}]})},Wi=function(e,t){if(!e||t.opset<9&&1!==e.length||t.opset>=9&&t.opset<11&&2!==e.length||t.opset>=11&&e.length<2)throw new Error("invalid inputs.");if(t.scales.length>0&&e[0].dims.length!==t.scales.length)throw new Error("Invalid input shape.");if("string"===e[0].type)throw new Error("Invalid input tensor types.")},go=function(e,t,n){if(n){var r,i=_createForOfIteratorHelper(e);try{for(i.s();!(r=i.n()).done;){if(r.value<=0)throw new Error("Scale value should be greater than 0.")}}catch(s){i.e(s)}finally{i.f()}}else{var o,a=_createForOfIteratorHelper(e);try{for(a.s();!(o=a.n()).done;){if(o.value<1)throw new Error("Scale value should be greater than or equal to 1.")}}catch(s){a.e(s)}finally{a.f()}}if(!("linear"!==t&&"cubic"!==t||2===e.length||4===e.length&&1===e[0]&&1===e[1]))throw new Error("'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ".concat(n?"Resize":"Upsample"," opeartor."))}})),Hi,ji,Tc,xc,Db,Lb,Fb,Cb,wc=L((function(){ve(),ae(),Bt(),Or(),Vi(),Hi={name:"Resize",inputNames:["A"],inputTypes:[2]},ji=function(e,t,n){return Wi(t,n),[e.run(_objectSpread(_objectSpread({},Hi),{},{cacheHint:n.cacheKey,get:function(){return Db(e,t,n)}}),t)]},Tc=function(e){return Tn(e,10)},xc=function(e){return Tn(e,11)},Db=function(e,t,n){var r=q(e.session.backend.glContext.version),i=_slicedToArray(Lb(t,n),2),o=i[0],a=i[1];if(o.every((function(e){return 1===e}))&&"tf_crop_and_resize"!==n.coordinateTransformMode)return _objectSpread(_objectSpread({},Hi),{},{output:{dims:a,type:t[0].type,textureType:2},hasMain:!0,shaderSource:"void main() {\n                    vec4 v = ".concat(r.texture2D,"(X, TexCoords);\n                    ").concat(r.output," = v;\n                }")});var s=a.length;if(s<2)throw new Error("output dimension should be at least 2, but got ".concat(s));var u=a[s-2],c=a[s-1],l=t[0].dims;if(s!==l.length)throw new Error("output dimension should match input ".concat(l.length,", but got ").concat(s));var h=l[s-2],f=l[s-1],d=o[s-2],p=o[s-1],y="";if("linear"!==n.mode)throw new Error("resize (packed) does not support mode: '".concat(n.mode,"'"));switch(n.coordinateTransformMode){case"asymmetric":y="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return vec4(coords) / scaleWHWH;\n                    }\n                ";break;case"half_pixel":y="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;\n                    }\n                ";break;case"pytorch_half_pixel":y="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 fcoords = vec4(coords);\n                        return vec4(\n                            ".concat(c,".0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,\n                            ").concat(u,".0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,\n                            ").concat(c,".0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,\n                            ").concat(u,".0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0\n                          );\n                    }\n                ");break;case"align_corners":y="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 resized = vec4(".concat(c,".0 - 1.0, ").concat(u,".0 - 1.0, ").concat(c,".0 - 1.0,\n                            ").concat(u,".0 - 1.0);\n                        vec4 original = vec4(").concat(f,".0 - 1.0, ").concat(h,".0 - 1.0, ").concat(f,".0 - 1.0,\n                            ").concat(h,".0 - 1.0);\n                        vec4 new_scale = original / resized;\n                        return vec4(coords) * new_scale;\n                    }\n                ");break;default:throw new Error("resize (packed) does not support coordinateTransformMode:                                 '".concat(n.coordinateTransformMode,"'"))}var g=Je(s),m="\n            const vec2 inputWH = vec2(".concat(h,".0, ").concat(f,".0);\n            const vec4 scaleWHWH = vec4(float(").concat(d,"), float(").concat(p,"), float(").concat(d,"), float(").concat(p,"));\n            ").concat(kt(),"\n            ").concat(y,"\n            float getAValue(int x10, int r, int c, int d) {\n                return getChannel(getA(x10, r, c, d), vec2(c, d));\n            }\n            void main() {\n                ").concat(g," rc = getOutputCoords();\n\n                int batch = rc[0];\n                int depth = rc[1];\n\n                // retrieve the 4 coordinates that is used in the 4 packed output values.\n                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);\n\n                // calculate the source index in fraction\n                vec4 sourceFrac = getSourceFracIndex(coords);\n\n                // get the lower and upper bound of the 4 values that will be packed into one texel.\n                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));\n                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));\n                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));\n                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));\n\n                bool hasNextRow = rc.w < ").concat(u-1,";\n                bool hasNextCol = rc.z < ").concat(c-1,";\n\n                // pack x00, x01, x10, x11's top-left corner into one vec4 structure\n                vec4 topLeft = vec4(\n                    getAValue(batch, depth, x00.x, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's top-right corner into one vec4 structure\n                vec4 topRight = vec4(\n                    getAValue(batch, depth, x00.x, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure\n                vec4 bottomLeft = vec4(\n                    getAValue(batch, depth, x00.z, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure\n                vec4 bottomRight = vec4(\n                    getAValue(batch, depth, x00.z, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);\n\n                // calculate the interpolation fraction on u and v direction\n                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);\n                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));\n\n                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);\n                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);\n                vec4 newValue = mix(top, bottom, clampFrac.xxzz);\n\n                ").concat(r.output," = vec4(newValue);\n            }\n        ");return _objectSpread(_objectSpread({},Hi),{},{output:{dims:a,type:t[0].type,textureType:2},hasMain:!0,shaderSource:m})},Lb=function(e,t){var n,r=e[0].dims,i=t.scales;if(0===i.length){var o=e[t.scalesInputIdx];if(o&&0!==o.size){if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");i=Fb(o,t.mode,t.isResize)}else{var a=e[t.sizesInputIdx];if(!a||0===a.size)throw new Error("Either scales or sizes MUST be provided as input.");n=Array.from(a.integerData),i=Cb(n,r,t.mode,t.isResize)}}else if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");var s=n||r.map((function(e,t){return Math.floor(e*i[t])}));return[i,s]},Fb=function(e,t,n){var r=Array.from(e.floatData);return go(r,t,n),r},Cb=function(e,t,n,r){for(var i=t.length,o=new Array(i),a=0,s=i;a<s;a++)if(0===t[a]){if(0!==e[a])throw new Error("Input dim is zero but required output dim is non-zero.");o[a]=1}else o[a]=e[a]/t[a];return go(o,n,r),o}})),vc,$b,_c=L((function(){_r(),vc=function(e,t){return $b(t),[new Ce([t[0].dims.length],"int32",void 0,void 0,new Int32Array(t[0].dims))]},$b=function(e){if(!e||1!==e.length)throw new Error("Shape requires 1 input.")}})),qi,Oc,Ic,Sc,Bb,Ac,kb,Nb,Ec=L((function(){Ge(),yn(),fe(),ae(),qi={name:"Slice",inputNames:["A"],inputTypes:[0]},Oc=function(e,t,n){return Bb(t),[e.run(_objectSpread(_objectSpread({},qi),{},{cacheHint:n.cacheKey,get:function(){return Sc(e,t[0],n)}}),t)]},Ic=function(e){var t=e.attributes.getInts("starts"),n=e.attributes.getInts("ends"),r=e.attributes.getInts("axes",[]);return te({starts:t,ends:n,axes:r})},Sc=function(e,t,n){for(var r=0===n.axes.length?t.dims.slice(0).map((function(e,t){return t})):n.axes,i=z.normalizeAxes(r,t.dims.length),o=n.starts.map((function(e,n){return e>t.dims[i[n]]-1?t.dims[i[n]]:z.normalizeAxis(e,t.dims[i[n]])})),a=n.ends.map((function(e,n){return e>t.dims[i[n]]-1?t.dims[i[n]]:z.normalizeAxis(e,t.dims[i[n]])})),s=t.dims.slice(),u=[],c=0;c<i.length;c++)s[i[c]]=a[c]-o[c],o[c]>0&&u.push("outputIdx[".concat(i[c],"] += ").concat(o[c],";"));var l="\n      float process(int outputIdx[".concat(s.length,"]) {\n        ").concat(u.join("\n      "),"\n        return _A(outputIdx);\n      }");return _objectSpread(_objectSpread({},qi),{},{output:{dims:s,type:t.type,textureType:0},shaderSource:l})},Bb=function(e){if(!e||1!==e.length)throw new Error("Slice requires 1 input.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.")},Ac=function(e,t){Nb(t);var n=kb(e,t);return[e.run(_objectSpread(_objectSpread({},qi),{},{cacheHint:n.cacheKey,get:function(){return Sc(e,t[0],n)}}),[t[0]])]},kb=function(e,t){if(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)||t.length>=4&&!e.session.isInitializer(t[3].dataId)||t.length>=5&&!e.session.isInitializer(t[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(t.length>=5&&t[4].integerData.some((function(e){return 1!==e})))throw new Error("currently non-1 steps is not supported for Slice");var n=Array.from(t[1].integerData),r=Array.from(t[2].integerData),i=t.length>=4?Array.from(t[3].integerData):[];return{starts:n,ends:r,axes:i,cacheKey:"".concat(i,";").concat(n,";").concat(r)}},Nb=function(e){if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if("int32"!==e[1].type||1!==e[1].dims.length)throw new Error("Invalid input type.");if("int32"!==e[2].type||1!==e[2].dims.length)throw new Error("Invalid input type.");if(e.length>=4&&("int32"!==e[3].type||1!==e[3].dims.length))throw new Error("Invalid input type.");if(e.length>=5&&("int32"!==e[4].type||1!==e[4].dims.length))throw new Error("Invalid input type.")}})),Pc,Dc,Lc,Fc,Cc,$c,Bc,kc,Rb,Mb,Gb,Nc,Rc=L((function(){Ge(),fe(),ve(),ae(),ho(),Pc={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},Dc={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},Lc={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},Fc=function(e,t,n){Nc(t);var r=t[0].dims.slice(),i=z.normalizeAxis(n.axis,r.length),o=z.sizeToDimension(r,i),a=z.sizeFromDimension(r,i);return kc(e,t,n,o,a)},Cc=function(e){return te({axis:e.attributes.getInt("axis",1)})},$c=function(e){return te({axis:e.attributes.getInt("axis",-1)})},Bc=function(e,t,n){Nc(t);var r,i=t[0].dims.slice(),o=z.normalizeAxis(n.axis,i.length),a=i.length,s=o!==a-1,u=[],c=[],l=[];s&&(c=Array.from({length:a}).map((function(e,t){return t})),c[o]=a-1,c[a-1]=o,c.map((function(e){return u.push(i[e])})),r=te({perm:c}),l=Sr(e,t,r));var h=s?z.sizeToDimension(u,a-1):z.sizeToDimension(i,a-1),f=s?z.sizeFromDimension(u,a-1):z.sizeFromDimension(i,a-1),d=kc(e,s?l:t,n,h,f);return s?Sr(e,d,r):d},kc=function(e,t,n,r,i){var o=Rb(e,t[0],r,i,[r]),a=e.run(_objectSpread(_objectSpread({},Pc),{},{cacheHint:n.cacheKey,get:function(){return o}}),t),s=Mb(e,t[0],r,i,o.output.dims,[r]),u=e.run(_objectSpread(_objectSpread({},Dc),{},{cacheHint:n.cacheKey,get:function(){return s}}),[t[0],a]),c=Gb(e,t[0],r,i,o.output.dims,s.output.dims);return[e.run(_objectSpread(_objectSpread({},Lc),{},{cacheHint:n.cacheKey,get:function(){return c}}),[t[0],a,u])]},Rb=function(e,t,n,r,i){var o=_slicedToArray(e.calculateTextureWidthAndHeight(t.dims,0),2),a=o[0],s=o[1],u=i.length;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length)throw new Error("Dimensionality of the output should be 1");if(i[0]!==n)throw new Error("Shape of the output should be equal to logical row count");var c=q(e.session.backend.glContext.version),l="\n      float process(int[".concat(u,"] indices) {\n        int logical_row_start_offset = indices[0] * ").concat(r,";\n\n        float max = getColorAsFloat(").concat(c.texture2D,"(A, offsetToCoords(logical_row_start_offset, ").concat(a,",\n        ").concat(s," )));\n        for(int i=1; i<").concat(r,"; ++i)\n        {\n          float current = getColorAsFloat(").concat(c.texture2D,"(A, offsetToCoords(logical_row_start_offset + i,\n            ").concat(a,", ").concat(s,")));\n          if(current > max)\n          max = current;\n        }\n\n        return max;\n      }");return _objectSpread(_objectSpread({},Pc),{},{output:{dims:i,type:t.type,textureType:0},shaderSource:l})},Mb=function(e,t,n,r,i,o){var a=_slicedToArray(e.calculateTextureWidthAndHeight(t.dims,0),2),s=a[0],u=a[1],c=o.length;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==o.length)throw new Error("Dimensionality of the output should be 1");if(o[0]!==n)throw new Error("Shape of the output should be equal to logical row count");if(1!==i.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");var l="\n      float process(int[".concat(c,"] indices) {\n        int logical_row_start_offset = indices[0] * ").concat(r,";\n\n        float norm_factor = 0.0;\n        float max = _Max(indices);\n        for(int i=0; i<").concat(r,"; ++i)\n        {\n          norm_factor += exp(getColorAsFloat(").concat(q(e.session.backend.glContext.version).texture2D,"(A, offsetToCoords(logical_row_start_offset + i,\n            ").concat(s,", ").concat(u,"))) - max);\n        }\n\n        return norm_factor;\n      }");return _objectSpread(_objectSpread({},Dc),{},{output:{dims:o,type:t.type,textureType:0},shaderSource:l})},Gb=function(e,t,n,r,i,o){var a=_slicedToArray(e.calculateTextureWidthAndHeight(t.dims,0),2),s=a[0],u=a[1],c=t.dims.length;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length||1!==o.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==n||o[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");var l="\n      float process(int[".concat(c,"] indices) {\n\n      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)\n      int offset = coordsToOffset(TexCoords, ").concat(s,", ").concat(u,");\n\n      //determine the logical row for this index\n      int logical_row_index[1];\n      logical_row_index[0] = offset / ").concat(r,";\n\n      float norm_factor = _Norm(logical_row_index);\n\n      // avoid possible division by 0\n      // if norm_facor is 0, all elements are zero\n      // if so, return 0\n      if(norm_factor == 0.0)\n        return 0.0;\n\n      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;\n    }");return _objectSpread(_objectSpread({},Lc),{},{output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l})},Nc=function(e){if(!e||1!==e.length)throw new Error("Softmax requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type")}})),Mc,Gc,Uc,Ub,zb,Wb,zc=L((function(){Ge(),fe(),ae(),Mc={name:"Split",inputNames:["A"],inputTypes:[0]},Gc=function(e,t,n){Wb(t);for(var r=z.normalizeAxis(n.axis,t[0].dims.length),i=Ub(e,t,r,n),o=[],a=function(i){o.push(e.run(_objectSpread(_objectSpread({},Mc),{},{cacheHint:"".concat(n.cacheKey,";").concat(i),get:function(){return zb(e,t[0],n,r,i)}}),t))},s=0;s<i;++s)a(s);return o},Uc=function(e){var t=e.attributes.getInt("axis",0),n=e.attributes.getInts("split",[]),r=e.outputs.length;return te({axis:t,split:n,numOutputs:r})},Ub=function(e,t,n,r){return _slicedToArray(pn.splitShape(t[0].dims,n,r.split,r.numOutputs),2)[1].length},zb=function(e,t,n,r,i){var o=_slicedToArray(pn.splitShape(t.dims,r,n.split,n.numOutputs),2),a=o[0],s=o[1][i],u=a[i],c="\n      float process(int indices[".concat(u.length,"]) {\n        indices[").concat(r,"] += ").concat(s,";\n        return _A(indices);\n      }\n    ");return _objectSpread(_objectSpread({},Mc),{},{cacheHint:"".concat(n.cacheKey,":").concat(i),output:{dims:u,type:t.type,textureType:0},shaderSource:c})},Wb=function(e){if(!e||1!==e.length)throw new Error("Split requires one input.");if("int8"!==e[0].type&&"uint8"!==e[0].type&&"int16"!==e[0].type&&"uint16"!==e[0].type&&"int32"!==e[0].type&&"uint32"!==e[0].type&&"float32"!==e[0].type&&"float64"!==e[0].type&&"bool"!==e[0].type)throw new Error("Invalid input type.")}})),Yi,Wc,Vc,Vb,Hb,Hc=L((function(){fe(),Yi=function(e,t,n){Vb(t);var r=z.squeezeShape(t[0].dims,n);return[e.reshapeUnpacked(t[0],r)]},Wc=function(e,t){return Hb(t),Yi(e,[t[0]],Array.from(t[1].integerData))},Vc=function(e){return e.attributes.getInts("axes")},Vb=function(e){if(!e||1!==e.length)throw new Error("Squeeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},Hb=function(e){if(!e||2!==e.length)throw new Error("Squeeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}})),jc,jb,qb,qc=L((function(){ve(),ae(),jc=function(e,t){qb(t);var n={name:"Sum",inputNames:t.map((function(e,t){return"X".concat(t)})),inputTypes:new Array(t.length).fill(0)};return[e.run(_objectSpread(_objectSpread({},n),{},{get:function(){return jb(e,t,n)}}),t)]},jb=function(e,t,n){var r=q(e.session.backend.glContext.version),i=t[0].dims.slice(),o="\n      void main() {\n        vec4 result = ".concat(t.map((function(e,t){return"".concat(r.texture2D,"(X").concat(t,",TexCoords)")})).join(" + "),";\n        ").concat(r.output," = result;\n      }\n    ");return _objectSpread(_objectSpread({},n),{},{output:{dims:i,type:t[0].type,textureType:0},hasMain:!0,shaderSource:o})},qb=function(e){if(!e||0===e.length)throw new Error("Sum requires inputs.");for(var t=e[0].dims.length,n=1;n<e.length;n++){if(t!==e[n].dims.length)throw new Error("Input shapes are mismatched.");for(var r=0;r<t;r++)if(e[0].dims[r]!==e[n].dims[r])throw new Error("Input shapes are not matched.")}if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");for(var i=1;i<e.length;i++)if(e[0].type!==e[i].type)throw new Error("Input types are not matched.")}})),Yc,Yb,Xb,Xc=L((function(){yn(),ae(),Yc=function(e,t){Xb(t);var n={name:"Tile",inputNames:["A"],inputTypes:[0]};return[e.run(_objectSpread(_objectSpread({},n),{},{get:function(){return Yb(e,t,n)}}),t)]},Yb=function(e,t,n){for(var r=t[0].dims.slice(),i=new Array(r.length),o=[],a=0;a<r.length;a++)i[a]=r[a]*t[1].numberData[a],o.push("inputIdx[".concat(a,"] = int(mod(float(outputIdx[").concat(a,"]), ").concat(r[a],".));"));var s=i.length,u="\n      float process(int outputIdx[".concat(s,"]) {\n        int inputIdx[").concat(s,"];\n        ").concat(o.join("\n"),"\n        return _A(inputIdx);\n      }\n    ");return _objectSpread(_objectSpread({},n),{},{output:{dims:i,type:t[0].type,textureType:0},shaderSource:u})},Xb=function(e){if(!e||2!==e.length)throw new Error("Tile requires 2 input.");if(1!==e[1].dims.length)throw new Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw new Error("Invalid input shape.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invalid repeat type.")}})),Xi,Kc,Jc,Kb,Jb,Zc=L((function(){fe(),Xi=function(e,t,n){Kb(t);var r=z.unsqueezeShape(t[0].dims,n);return[e.reshapeUnpacked(t[0],r)]},Kc=function(e,t){return Jb(t),Xi(e,[t[0]],Array.from(t[1].integerData))},Jc=function(e){return e.attributes.getInts("axes")},Kb=function(e){if(!e||1!==e.length)throw new Error("Unsqueeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},Jb=function(e){if(!e||2!==e.length)throw new Error("Unsqueeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}})),Qc,ep=L((function(){ll(),vl(),Il(),Ll(),fo(),mf(),wf(),Of(),Af(),Lf(),$f(),Rf(),zf(),co(),jf(),ic(),dc(),mc(),wc(),_c(),Ec(),Rc(),zc(),Hc(),qc(),Xc(),ho(),Fi(),Zc(),Vi(),Qc=[["Abs","","6+",Fl],["Acos","","7+",Cl],["Add","","7+",fl],["And","","7+",cl],["Asin","","7+",$l],["Atan","","7+",Bl],["AveragePool","","7+",Yf,Xf],["BatchNormalization","","7+",sl,ul],["Cast","","6+",_l,Ol],["Ceil","","6+",Rl],["Clip","","6-10",Di,kl],["Clip","","11+",Nl],["Concat","","4+",El,Dl],["Conv","","1+",Ri,Mi],["ConvTranspose","","1+",df,hf],["Cos","","7+",Ml],["Div","","7+",pl],["Dropout","","7+",Li],["DepthToSpace","","1+",Tf,xf],["Equal","","7+",dl],["Elu","","6+",Gl,Ul],["Exp","","6+",zl],["Flatten","","1+",vf,_f],["Floor","","6+",Wl],["FusedConv","com.microsoft","1+",Ri,Mi],["Gather","","1+",If,Sf],["Gemm","","7-10",Gi,Pf],["Gemm","","11+",Gi,Df],["GlobalAveragePool","","1+",Jf,Zf],["GlobalMaxPool","","1+",nc],["Greater","","7+",hl],["Identity","","1+",Li],["ImageScaler","","1+",Ff,Cf],["InstanceNormalization","","6+",kf,Nf],["LeakyRelu","","6+",Vl,Hl],["Less","","7+",ml],["LRN","","1+",Mf,Gf],["Log","","6+",jl],["MatMul","","1+",af,sf],["MaxPool","","1+",Qf,ec],["Mul","","7+",bl],["Neg","","6+",ql],["Not","","1+",Yl],["Or","","7+",gl],["Pad","","2-10",Ui,Wf],["Pad","","11+",Vf,Hf],["Pow","","7+",yl],["PRelu","","7+",Tl],["ReduceLogSum","","1+",cc,nr],["ReduceMax","","1+",uc,nr],["ReduceMean","","1+",sc,nr],["ReduceMin","","1+",lc,nr],["ReduceProd","","1+",fc,nr],["ReduceSum","","1-12",ac,nr],["ReduceSumSquare","","1+",pc,nr],["Relu","","6+",Xl],["Reshape","","5+",hc],["Resize","","10",ji,Tc],["Resize","","11+",ji,xc],["Shape","","1+",vc],["Sigmoid","","6+",Kl],["Sin","","7+",Jl],["Slice","","10+",Ac],["Slice","","1-9",Oc,Ic],["Softmax","","1-12",Fc,Cc],["Softmax","","13+",Bc,$c],["Split","","2-12",Gc,Uc],["Sqrt","","6+",Zl],["Squeeze","","1-12",Yi,Vc],["Squeeze","","13+",Wc],["Sub","","7+",xl],["Sum","","6+",jc],["Tan","","7+",Ql],["Tanh","","6+",ef],["Tile","","6+",Yc],["Transpose","","1+",Sr,gf],["Upsample","","7-8",zi,gc],["Upsample","","9",zi,yc],["Unsqueeze","","1-12",Xi,Jc],["Unsqueeze","","13+",Kc],["Xor","","7+",wl]]}));function rp(e){for(var t,n={};null!==(t=tp.exec(e));){var r=t[3].split(",").map((function(e){var t=e.trim().split(" ");return t&&2===t.length?{type:t[0],name:t[1]}:null})).filter((function(e){return null!==e}));n[t[2]]={params:r,body:t[4]}}for(var i in n)for(var o=Zb.replace("__FUNC__",i),a=new RegExp(o,"gm"),s=function(){var r=t[1],o=t[2],a=t[3].split(","),s=r?"".concat(r," ").concat(o,";"):"",u=n[i].body,c="";n[i].params.forEach((function(e,t){e&&(c+="".concat(e.type," ").concat(e.name," = ").concat(a[t],";\n"))})),u=(u="".concat(c,"\n ").concat(u)).replace("return","".concat(o," = "));var l="\n      ".concat(s,"\n      {\n        ").concat(u,"\n      }\n      ");e=e.replace(t[0],l)};null!==(t=a.exec(e));)s();return e=e.replace(tp,"")}var tp,Zb,np=L((function(){tp=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,Zb="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"}));function Yr(e,t){for(var n=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:Qb(t,e).sort(),a=0,s=0;s<e.length;++s){if(null!=o){if(o[a]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==o[a]||o[a]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),o[a]<=s&&a++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Qb(e,t){var n=t.length;return zr((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but got axis ").concat(e)})),zr(e.every(eg),(function(){return"All values in axis param must be integers but got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function eg(e){return e%1==0}function tg(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function op(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}var yo,Ki=L((function(){dt(),fe(),yo=function(){function e(t){_classCallCheck(this,e),this.maxTextureSize=t}return _createClass(e,[{key:"computeTextureWH",value:function(e,t){var n=this.computeTexture(e,t);return t&&t.isPacked&&(n[0]/=2,n[1]/=2),t&&t.reverseWH?[n[1],n[0]]:n}},{key:"computeTexture",value:function(e,t){var n=t&&t.isPacked;if(0===e.length)return n?[2,2]:[1,1];var r=this.maxTextureSize;if(t&&void 0!==t.breakAxis){var i=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce((function(e,t){return e*t})),o=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce((function(e,t){return e*t}));if(!(i>r||o>r))return[i,o];pe.verbose("TextureLayout","Given width/height preferences were unattainable: shape:".concat(e,", breakAxis:").concat(t.breakAxis))}var a=e.slice(0);n&&(r*=2,a=a.map((function(e,t){return t>=a.length-2?a[t]%2==0?a[t]:a[t]+1:a[t]})),1===a.length&&(a=[2,a[0]])),2!==a.length&&(a=Yr(a).newShape);var s=tg(a);return a.length<=1&&s<=r?[1,s]:2===a.length&&a[0]<=r&&a[1]<=r?a:3===a.length&&a[0]*a[1]<=r&&a[2]<=r?[a[0]*a[1],a[2]]:3===a.length&&a[0]<=r&&a[1]*a[2]<=r?[a[0],a[1]*a[2]]:4===a.length&&a[0]*a[1]*a[2]<=r&&a[3]<=r?[a[0]*a[1]*a[2],a[3]]:4===a.length&&a[0]<=r&&a[1]*a[2]*a[3]<=r?[a[0],a[1]*a[2]*a[3]]:n?op(s/4).map((function(e){return 2*e})):op(s)}}]),e}()})),To,ip=L((function(){fe(),qt(),ve(),Ki(),Bt(),To=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,[{key:"getFunctions",value:function(){return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}},{key:"getCustomTypes",value:function(){return{}}},{key:"offsetToCoords",value:function(){return{offsetToCoords:new G("\n      vec2 offsetToCoords(int offset, int width, int height) {\n        int t = offset / width;\n        int s = offset - t*width;\n        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);\n        return coords;\n      }\n      ")}}},{key:"coordsToOffset",value:function(){return{coordsToOffset:new G("\n      int coordsToOffset(vec2 coords, int width, int height) {\n        float s = coords.s * float(width);\n        float t = coords.t * float(height);\n        int offset = int(t) * width + int(s);\n        return offset;\n      }\n      ")}}},{key:"getOutputSamplingSnippet",value:function(){var e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e)}},{key:"getPackedOutputSamplingSnippet",value:function(e){var t=e.unpackedShape,n=[e.width,e.height],r={},i="getOutputCoords";switch(t.length){case 0:r[i]=this.getOutputScalarCoords();break;case 1:r[i]=this.getOutputPacked1DCoords(t,n);break;case 2:r[i]=this.getOutputPacked2DCoords(t,n);break;case 3:r[i]=this.getOutputPacked3DCoords(t,n);break;default:r[i]=this.getOutputPackedNDCoords(t,n)}var o="\n      void setOutput(vec4 val) {\n        ".concat(q(this.context.glContext.version).output," = val;\n      }\n    ");return r.floatTextureSetRGBA=new G(o),r}},{key:"getUnpackedOutputSamplingSnippet",value:function(e){var t=e.unpackedShape,n=[e.width,e.height],r={},i="getOutputCoords";switch(t.length){case 0:r[i]=this.getOutputScalarCoords();break;case 1:r[i]=this.getOutputUnpacked1DCoords(t,n);break;case 2:r[i]=this.getOutputUnpacked2DCoords(t,n);break;case 3:r[i]=this.getOutputUnpacked3DCoords(t,n);break;case 4:r[i]=this.getOutputUnpacked4DCoords(t,n);break;case 5:r[i]=this.getOutputUnpacked5DCoords(t,n);break;case 6:r[i]=this.getOutputUnpacked6DCoords(t,n);break;default:throw new Error("Unsupported output dimensionality: ".concat(t.length))}var o="\n        void setOutput(float val) {\n          ".concat(q(this.context.glContext.version).output," = vec4(val, 0, 0, 0);\n        }\n    ");return r.floatTextureSetR=new G(o),r}},{key:"getOutputScalarCoords",value:function(){return new G("\n      int getOutputCoords() {\n        return 0;\n      }\n    ")}},{key:"getOutputPacked1DCoords",value:function(e,t){var n=t,r="";return 1===n[0]?(r="\n          int getOutputCoords() {\n            return 2 * int(TexCoords.y * ".concat(n[1],".0);\n          }\n        "),new G(r)):1===n[1]?(r="\n          int getOutputCoords() {\n            return 2 * int(TexCoords.x * ".concat(n[0],".0);\n          }\n        "),new G(r)):(r="\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                 vec2(".concat(n[0],", ").concat(n[1],"));\n          return 2 * (resTexRC.y * ").concat(n[0]," + resTexRC.x);\n        }\n      "),new G(r))}},{key:"getOutputPacked2DCoords",value:function(e,t){var n="";if(Tr.arraysEqual(e,t))return n="\n        ivec2 getOutputCoords() {\n          return 2 * ivec2(TexCoords.xy * vec2(".concat(t[0],", ").concat(t[1],"));\n        }\n      "),new G(n);var r=t,i=Math.ceil(e[1]/2);return n="\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(r[0],", ").concat(r[1],"));\n\n          int index = resTexRC.y * ").concat(r[0]," + resTexRC.x;\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ").concat(i,") * 2;\n          int c = 2 * (index / ").concat(i,");\n\n          return ivec2(r, c);\n        }\n      "),new G(n)}},{key:"getOutputPacked3DCoords",value:function(e,t){var n=[t[0],t[1]],r=Math.ceil(e[2]/2),i=r*Math.ceil(e[1]/2);return new G("\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(n[0],", ").concat(n[1],"));\n          int index = resTexRC.y * ").concat(n[0]," + resTexRC.x;\n\n          int b = index / ").concat(i,";\n          index -= b * ").concat(i,";\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ").concat(r,") * 2;\n          int c = 2 * (index / ").concat(r,");\n\n          return ivec3(b, r, c);\n        }\n      "))}},{key:"getOutputPackedNDCoords",value:function(e,t){for(var n=[t[0],t[1]],r=Math.ceil(e[e.length-1]/2),i=r*Math.ceil(e[e.length-2]/2),o=i,a="",s="b, r, c",u=2;u<e.length-1;u++)o*=e[e.length-u-1],a="\n      int b".concat(u," = index / ").concat(o,";\n      index -= b").concat(u," * ").concat(o,";\n    ")+a,s="b".concat(u,", ")+s;var c="\n      ivec".concat(e.length," getOutputCoords() {\n        ivec2 resTexRC = ivec2(TexCoords.xy *\n                              vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = resTexRC.y * ").concat(n[0]," + resTexRC.x;\n\n        ").concat(a,"\n\n        int b = index / ").concat(i,";\n        index -= b * ").concat(i,";\n\n        // reverse r and c order for packed texture\n        int r = imod(index, ").concat(r,") * 2;\n        int c = 2 * (index / ").concat(r,");\n\n        return ivec").concat(e.length,"(").concat(s,");\n      }\n    ");return new G(c)}},{key:"getOutputUnpacked1DCoords",value:function(e,t){var n="\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          return resTexRC.y * ").concat(t[0]," + resTexRC.x;\n        }\n      ");return new G(n)}},{key:"getOutputUnpacked2DCoords",value:function(e,t){var n="\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          int r = index / ").concat(e[1],";\n          int c = index - r * ").concat(e[1],";\n          return ivec2(r, c);\n        }\n      ");return new G(n)}},{key:"getOutputUnpacked3DCoords",value:function(e,t){var n,r=e.length,i=null;r<2&&(i=[]),(i=new Array(r-1))[r-2]=e[r-1];for(var o=r-3;o>=0;--o)i[o]=i[o+1]*e[o+1];var a=["r","c","d"],s=i.map((function(e,t){return"".concat("int ".concat(a[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(a[t+1]," = index - ").concat(a[t]," * ").concat(e):"index -= ".concat(a[t]," * ").concat(e),";")})).join("");return n="\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          ").concat(s,"\n          return ivec3(r, c, d);\n        }\n      "),new G(n)}},{key:"getOutputUnpacked4DCoords",value:function(e,t){var n,r=e.length,i=null;r<2&&(i=[]),(i=new Array(r-1))[r-2]=e[r-1];for(var o=r-3;o>=0;--o)i[o]=i[o+1]*e[o+1];var a=["r","c","d","d2"],s=i.map((function(e,t){return"".concat("int ".concat(a[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(a[t+1]," = index - ").concat(a[t]," * ").concat(e):"index -= ".concat(a[t]," * ").concat(e),";")})).join("");return n="\n      ivec4 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          ").concat(s,"\n          return ivec4(r, c, d, d2);\n        }\n      "),new G(n)}},{key:"getOutputUnpacked5DCoords",value:function(e,t){var n,r=e.length,i=null;r<2&&(i=[]),(i=new Array(r-1))[r-2]=e[r-1];for(var o=r-3;o>=0;--o)i[o]=i[o+1]*e[o+1];var a=["r","c","d","d2","d3"],s=i.map((function(e,t){return"".concat("int ".concat(a[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(a[t+1]," = index - ").concat(a[t]," * ").concat(e):"index -= ".concat(a[t]," * ").concat(e),";")})).join("");return n="\n      ivec5 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          ").concat(s,"\n          return ivec5(r, c, d, d2, d3);\n        }\n      "),new G(n)}},{key:"getOutputUnpacked6DCoords",value:function(e,t){var n,r=e.length,i=null;r<2&&(i=[]),(i=new Array(r-1))[r-2]=e[r-1];for(var o=r-3;o>=0;--o)i[o]=i[o+1]*e[o+1];var a=["r","c","d","d2","d3","d4"],s=i.map((function(e,t){return"".concat("int ".concat(a[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(a[t+1]," = index - ").concat(a[t]," * ").concat(e):"index -= ".concat(a[t]," * ").concat(e),";")})).join("");return n="\n     ivec6 getOutputCoords() {\n         ivec2 resTexRC = ivec2(TexCoords.xy *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n         int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n         ").concat(s,"\n         return ivec6(r, c, d, d2, d3, d4);\n       }\n     "),new G(n)}},{key:"getCommonUtilFuncs",value:function(){var e={},t="uvFromFlat";e[t]=new G("\n    vec2 uvFromFlat(int texNumR, int texNumC, int index) {\n      int texC = index / texNumR;\n      int texR = index - texC * texNumR;\n      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to\n      //       v.\n      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);\n    }\n    "),e[t="packedUVfrom1D"]=new G("\n      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n        int texelIndex = index / 2;\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),e[t="packedUVfrom2D"]=new G("\n      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {\n        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),e[t="packedUVfrom3D"]=new G("\n      vec2 packedUVfrom3D(int texNumR, int texNumC,\n          int texelsInBatch, int texelsInLogicalRow, int b,\n          int row, int col) {\n        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = index / texNumC;\n        int texC = index - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="sampleTexture";var n=q(this.context.glContext.version);return e[t]=new G("\n        float sampleTexture(sampler2D textureSampler, vec2 uv) {\n            return ".concat(n.texture2D,"(textureSampler, uv).r;\n        }")),e}},{key:"getInputsSamplingSnippets",value:function(){var e=this,t={},n=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((function(r,i){var o=e.context.inputTextureLayouts[i],a=no(r);o.isPacked?t[a]=e.getPackedSamplerFromInput(a,r,o):t[a]=e.getUnpackedSamplerFromInput(a,r,o);var s=Hu(r);o.unpackedShape.length<=n.unpackedShape.length&&(o.isPacked?t[s]=e.getPackedSamplerAtOutputCoords(s,o,n,r):t[s]=e.getUnpackedSamplerAtOutputCoords(s,o,n,r))})),t}},{key:"getPackedSamplerAtOutputCoords",value:function(e,t,n,r){var i,o=t.unpackedShape,a=n.unpackedShape,s=no(r),u=o.length,c=a.length,l=Ke.getBroadcastDims(o,a),h=Je(c),f=c-u,d=Dt();i=0===u?"":c<2&&l.length>=1?"coords = 0;":l.map((function(e){return"coords.".concat(d[e+f]," = 0;")})).join("\n");var p;p=c<2&&u>0?"coords":o.map((function(e,t){return"coords.".concat(d[t+f])})).join(", ");var y="return outputValue;",g=1===z.size(o),m=1===z.size(a);if(1!==u||g||m){if(g&&!m)y=1===c?"\n          return vec4(outputValue.x, outputValue.x, 0., 0.);\n        ":"\n          return vec4(outputValue.x);\n        ";else if(l.length){var v=u-2,w=u-1;l.indexOf(v)>-1&&l.indexOf(w)>-1?y="return vec4(outputValue.x);":l.indexOf(v)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(w)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);")}}else y="\n        return vec4(outputValue.xy, outputValue.xy);\n      ";var b="\n        int lastDim = coords.".concat(d[c-1],";\n        coords.").concat(d[c-1]," = coords.").concat(d[c-2],";\n        coords.").concat(d[c-2]," = lastDim;\n      ");return new G("\n      vec4 ".concat(e,"() {\n        ").concat(h," coords = getOutputCoords();\n        ").concat(b,"\n        ").concat(i,"\n        vec4 outputValue = ").concat(s,"(").concat(p,");\n        ").concat(y,"\n      }\n    "),["coordinates.getOutputCoords"])}},{key:"getUnpackedSamplerAtOutputCoords",value:function(e,t,n,r){var i=[n.width,n.height],o=[t.width,t.height],a=t.unpackedShape.length,s=n.unpackedShape.length,u=t.unpackedShape,c=n.unpackedShape,l=no(r);if(a===s&&Tr.arraysEqual(o,i))return new G("\n          float ".concat(e,"() {\n            return sampleTexture(").concat(r,", TexCoords);\n          }\n        "),["coordinates.sampleTexture"]);var h,f=Je(s),d=Ke.getBroadcastDims(u,c),p=s-a,y=Dt();h=0===a?"":s<2&&d.length>=1?"coords = 0;":d.map((function(e){return"coords.".concat(y[e+p]," = 0;")})).join("\n");var g;return g=s<2&&a>0?"coords":t.unpackedShape.map((function(e,t){return"coords.".concat(y[t+p])})).join(", "),new G("\n        float ".concat(e,"() {\n          ").concat(f," coords = getOutputCoords();\n          ").concat(h,"\n          return ").concat(l,"(").concat(g,");\n        }\n      "),["coordinates.getOutputCoords"])}},{key:"getPackedSamplerFromInput",value:function(e,t,n){switch(n.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,t);case 1:return this.getPackedSampler1D(e,t,n);case 2:return this.getPackedSampler2D(e,t,n);case 3:return this.getPackedSampler3D(e,t,n);default:return this.getPackedSamplerND(e,t,n)}}},{key:"getUnpackedSamplerFromInput",value:function(e,t,n){var r=n.unpackedShape;switch(r.length){case 0:return this.getUnpackedSamplerScalar(e,t,n);case 1:return this.getUnpackedSampler1D(e,t,n);case 2:return this.getUnpackedSampler2D(e,t,n);case 3:return this.getUnpackedSampler3D(e,t,n);case 4:return this.getUnpackedSampler4D(e,t,n);case 5:return this.getUnpackedSampler5D(e,t,n);case 6:return this.getUnpackedSampler6D(e,t,n);default:throw new Error("Unsupported dimension ".concat(r.length,"-D"))}}},{key:"getPackedSamplerScalar",value:function(e,t){var n="\n          vec4 ".concat(e,"() {\n            return ").concat(q(this.context.glContext.version).texture2D,"(").concat(t,", halfCR);\n          }\n        ");return new G(n)}},{key:"getPackedSampler1D",value:function(e,t,n){var r=[n.width,n.height],i=[r[1],r[0]],o=q(this.context.glContext.version),a="vec4 ".concat(e,"(int index) {\n      vec2 uv = packedUVfrom1D(\n      ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }");return new G(a,["coordinates.packedUVfrom1D"])}},{key:"getPackedSampler2D",value:function(e,t,n){var r=n.unpackedShape,i=[n.width,n.height],o=q(this.context.glContext.version),a=i[0],s=i[1];if(null!=i&&Tr.arraysEqual(r,i)){var u="vec4 ".concat(e,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(a,".0);\n        return ").concat(o.texture2D,"(").concat(t,", uv);\n      }");return new G(u)}var c=i,l=Math.ceil(r[1]/2),h="vec4 ".concat(e,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(c[1],", ").concat(c[0],", ").concat(l,", row, col);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }");return new G(h,["coordinates.packedUVfrom2D"])}},{key:"getPackedSampler3D",value:function(e,t,n){var r=n.unpackedShape,i=[n.width,n.height],o=[i[0],i[1]],a=q(this.context.glContext.version);if(1===r[0]){var s=r.slice(1),u=Wr(r,s),c=JSON.parse(JSON.stringify(n));c.unpackedShape=u;var l=this.getPackedSamplerFromInput(e,t,c),h="".concat(l.routineBody,"\n      vec4 ").concat(e,"(int b, int row, int col) {\n        return ").concat(e,"(").concat(Vr(["b","row","col"],[1,2]),");\n      } ");return new G(h,l.dependencies)}var f=o[0],d=o[1],p=Math.ceil(r[2]/2),y="vec4 ".concat(e,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(d,", ").concat(f,", ").concat(p*Math.ceil(r[1]/2),", ").concat(p,", b, row, col);\n      return ").concat(a.texture2D,"(").concat(t,", uv);}");return new G(y,["coordinates.packedUVfrom3D"])}},{key:"getPackedSamplerND",value:function(e,t,n){for(var r=n.unpackedShape,i=r.length,o=[n.width,n.height],a=q(this.context.glContext.version),s=[o[0],o[1]],u=s[1],c=s[0],l=Math.ceil(r[i-1]/2),h=l*Math.ceil(r[i-2]/2),f="int b, int row, int col",d="b * ".concat(h," + (row / 2) * ").concat(l," + (col / 2)"),p=2;p<i-1;p++)f="int b".concat(p,", ")+f,h*=r[i-p-1],d="b".concat(p," * ").concat(h," + ")+d;var y="vec4 ".concat(e,"(").concat(f,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(c,";\n      int texC = index - texR * ").concat(c,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(c,", ").concat(u,");\n      return ").concat(a.texture2D,"(").concat(t,", uv);\n    }");return new G(y)}},{key:"getUnpackedSamplerScalar",value:function(e,t,n){var r=[n.width,n.height],i=r[0],o=r[1];return 1===i&&1===o?new G("\n          float ".concat(e,"() {\n            return sampleTexture(").concat(t,", halfCR);\n          }\n        "),["coordinates.sampleTexture"]):new G("\n        float ".concat(e,"() {\n          int offset_").concat(t," = coordsToOffset(TexCoords, ").concat(i,", ").concat(o,");\n          vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", offset_").concat(t,");\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}},{key:"getUnpackedSampler1D",value:function(e,t,n){var r=n.width,i=n.height;return 1===i&&1===r?new G("\n        float ".concat(e,"(int index) {\n          return sampleTexture(").concat(t,", halfCR);\n        }\n      "),["coordinates.sampleTexture"]):1===i?new G("\n          float ".concat(e,"(int index) {\n            vec2 uv = vec2((float(index) + 0.5) / ").concat(r,".0, 0.5);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.sampleTexture"]):1===r?new G("\n          float ".concat(e,"(int index) {\n            vec2 uv = vec2(0.5, (float(index) + 0.5) / ").concat(i,".0);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.sampleTexture"]):new G("\n        float ".concat(e,"(int index) {\n          vec2 uv = uvFromFlat(").concat(r,", ").concat(i,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture"])}},{key:"getUnpackedSampler2D",value:function(e,t,n){var r=n.unpackedShape,i=[n.height,n.width];if(null!=i&&Tr.arraysEqual(r,i))return new G("\n          float ".concat(e,"(int row, int col) {\n            vec2 uv = (vec2(row, col) + halfCR) / vec2(").concat(i[1],".0, ").concat(i[0],".0);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.sampleTexture"]);var o=Yr(r),a=o.newShape,s=o.keptDims,u=a;if(u.length<r.length){var c=Wr(r,u),l=JSON.parse(JSON.stringify(n));l.unpackedShape=c;var h="\n          ".concat(this.getUnpackedSamplerFromInput(e,t,l).routineBody,"\n          float ").concat(e,"(int row, int col) {\n            return ").concat(e,"(").concat(Vr(["col","row"],s),");\n          }\n        ");return new G(h,["coordinates.sampleTexture"])}var f=i[1],d=i[0];if(1===d){var p="\n          float ".concat(e,"(int row, int col) {\n            int offset_").concat(t," = coordsToOffset(TexCoords, ").concat(f,", ").concat(d,");\n            float index = dot(vec3(row, col, offset_").concat(t,"), vec3(").concat(r[1],", 1, 1));\n            vec2 uv = vec2(0.5, (index + 0.5) / ").concat(f,".0);\n            return sampleTexture(").concat(t,", uv);\n          }\n        ");return new G(p,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(1===f){var y="\n          float ".concat(e,"(int row, int col) {\n            int offset_").concat(t," = coordsToOffset(TexCoords, ").concat(f,", ").concat(d,");\n            float index = dot(vec3(row, col, offset_").concat(t,"), vec3(").concat(r[1],", 1, 1));\n            vec2 uv = vec2((index + 0.5) / ").concat(d,".0, 0.5);\n            return sampleTexture(").concat(t,", uv);\n          }\n        ");return new G(y,["coordinates.sampleTexture","coordinates.coordsToOffset"])}var g="\n        float ".concat(e,"(int row, int col) {\n          int index = col * ").concat(r[1]," + row;\n          vec2 uv = uvFromFlat(").concat(f,", ").concat(d,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      ");return new G(g,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}},{key:"getUnpackedSampler3D",value:function(e,t,n){var r=n.unpackedShape,i=r[1]*r[2],o=r[2],a=Yr(r),s=a.newShape,u=a.keptDims,c=s;if(c.length<r.length){var l=Wr(r,c),h=JSON.parse(JSON.stringify(n));h.unpackedShape=l;var f=this.getUnpackedSamplerFromInput(e,t,h),d=u.reverse(),p="\n          ".concat(f.routineBody,"\n          float ").concat(e,"(int batch, int row, int col) {\n            return ").concat(e,"(").concat(Vr(["batch","col","row"],d),");\n          }\n        ");return new G(p,f.dependencies)}var y=n.width,g=n.height;return new G("\n          float ".concat(e,"(int depth, int row, int col) {\n            // Explicitly use integer operations as dot() only works on floats.\n            int index = depth * ").concat(i," + col * ").concat(o," + row;\n            vec2 uv = uvFromFlat(").concat(y,", ").concat(g,", index);\n            return sampleTexture(").concat(t,", uv);\n          }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}},{key:"getUnpackedSampler4D",value:function(e,t,n){var r=n.unpackedShape,i=r[3],o=r[2]*i,a=r[1]*o,s=n.width,u=n.height;return new G("\n        float ".concat(e,"(int row, int col, int depth, int depth2) {\n          int index = row * ").concat(a," + col * ").concat(o," +\n              depth2 * ").concat(i," + depth;\n          vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture"])}},{key:"getUnpackedSampler5D",value:function(e,t,n){var r=n.unpackedShape,i=r[4],o=r[3]*i,a=r[2]*o,s=r[1]*a,u=Yr(r),c=u.newShape,l=u.keptDims;if(c.length<r.length){var h=Wr(r,c),f=JSON.parse(JSON.stringify(n));f.unpackedShape=h;var d="\n          ".concat(this.getUnpackedSamplerFromInput(e,t,f).routineBody,"\n          float ").concat(e,"(int row, int col, int depth, int depth2, int depth3) {\n            return ").concat(e,"(").concat(Vr(["row","col","depth","depth2","depth3"],l),");\n          }\n        ");return new G(d,["coordinates.sampleTexture","coordinates.uvFromFlat"])}var p=n.width,y=n.height;return new G("\n        float ".concat(e,"(int row, int col, int depth, int depth2, int depth3) {\n          int index = row * ").concat(s," + col * ").concat(a," + depth * ").concat(o," +\n          depth3 * ").concat(i," + depth2;\n          vec2 uv = uvFromFlat(").concat(p,", ").concat(y,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.sampleTexture","coordinates.uvFromFlat"])}},{key:"getUnpackedSampler6D",value:function(e,t,n){var r=n.unpackedShape,i=r[5],o=r[4]*i,a=r[3]*o,s=r[2]*a,u=r[1]*s,c=Yr(r),l=c.newShape,h=c.keptDims;if(l.length<r.length){var f=Wr(r,l),d=JSON.parse(JSON.stringify(n));d.unpackedShape=f;var p="\n            ".concat(this.getUnpackedSamplerFromInput(e,t,d).routineBody,"\n            float ").concat(e,"(int row, int col, int depth,\n              int depth2, int depth3, int depth4) {\n              return ").concat(e,"(").concat(Vr(["row","col","depth","depth2","depth3","depth4"],h),");\n            }\n          ");return new G(p,["coordinates.sampleTexture","coordinates.uvFromFlat"])}var y=n.width,g=n.height;return new G("\n          float ".concat(e,"(int row, int col, int depth,\n            int depth2, int depth3, int depth4) {\n            int index = row * ").concat(u," + col * ").concat(s," + depth * ").concat(a," +\n            depth2 * ").concat(o," + depth3 * ").concat(i," + depth4;\n            vec2 uv = uvFromFlat(").concat(y,", ").concat(g,", index);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}},{key:"toVec",value:function(){for(var e=this.context.outputTextureLayout,t=e.shape.length,n=e.strides,r=e.width,i=e.height,o=[],a=0;a<t-1;++a)o.push("\n        c[".concat(a,"] = offset / ").concat(n[a],";")),o.push("\n        offset -= c[".concat(a,"] * ").concat(n[a],";"));o.push("\n        c[".concat(t-1,"] = offset;"));var s="\n      void toVec(vec2 texCoords, out int c[".concat(t,"]) {\n        int offset = coordsToOffset(texCoords, ").concat(r,", ").concat(i,");\n        ").concat(o.join(""),"\n      }\n      void toVec(int offset, out int c[").concat(t,"]) {\n        ").concat(o.join(""),"\n      }\n    ");return{toVec:new G(s,["coordinates.coordsToOffset"])}}},{key:"valueFrom",value:function(){var e=this,t={};return this.context.programInfo.inputNames.forEach((function(n,r){var i=e.context.inputTextureLayouts[r],o=(i.unpackedShape.length>0?i.unpackedShape:i.shape).length,a="_".concat(n);t[a]=new G(e.getValueFromSingle(n,o,i.width,i.height,!1),["shapeUtils.indicesToOffset".concat(a),"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),t[a+="_T"]=new G(e.getValueFromSingle(n,o,i.width,i.height,!0),["shapeUtils.indicesToOffset".concat(a),"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])})),t}},{key:"getValueFromSingle",value:function(e,t,n,r,i){var o="_".concat(e);return i&&(o+="_T"),"\n        float ".concat(o,"(int m[").concat(t,"]) {\n          int offset = indicesToOffset").concat(o,"(m);\n          vec2 coords = offsetToCoords(offset, ").concat(n,", ").concat(r,");\n          float value = getColorAsFloat(").concat(q(this.context.glContext.version).texture2D,"(").concat(e,", coords));\n          return value;\n        }\n        ")}},{key:"getPackedValueFrom",value:function(e,t,n,r,i){var o="_".concat(e,"_Pack");return i&&(o+="_T"),"\n        vec4 ".concat(o,"(int m[").concat(t,"]) {\n          int offset = indicesToOffset_").concat(e,"(m);\n          vec2 coords = offsetToCoords(offset, ").concat(n,", ").concat(r,");\n          return ").concat(q(this.context.glContext.version).texture2D,"(").concat(e,", coords);\n        }\n        ")}}]),t}(gt)})),xo,ap=L((function(){qt(),xo=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,[{key:"getFunctions",value:function(){return _objectSpread(_objectSpread({},this.encodeFloat32()),this.decodeFloat32())}},{key:"getCustomTypes",value:function(){return{}}},{key:"encodeFloat32",value:function(){return{encode:new G("highp vec4 encode(highp float f) {\n        return vec4(f, 0.0, 0.0, 0.0);\n      }\n        ")}}},{key:"decodeFloat32",value:function(){return{decode:new G("highp float decode(highp vec4 rgba) {\n        return rgba.r;\n      }\n        ")}}},{key:"encodeUint8",value:function(){var e=t.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new G("\n      highp vec4 encode(highp float f) {\n        highp float F = abs(f);\n        highp float Sign = step(0.0,-f);\n        highp float Exponent = floor(log2(F));\n        highp float Mantissa = (exp2(- Exponent) * F);\n        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));\n        highp vec4 rgba;\n        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));\n        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);\n        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));\n        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));\n        ".concat(e,"\n        rgba = rgba / 255.0; // values need to be normalized to [0,1]\n        return rgba;\n    }\n        "))}}},{key:"decodeUint8",value:function(){var e=t.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new G("\n        highp float decode(highp vec4 rgba) {\n          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]\n          ".concat(e,"\n          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;\n          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;\n          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);\n          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));\n          return Result;\n      }\n        "))}}}],[{key:"isLittleEndian",value:function(){var e=new ArrayBuffer(4),t=new Uint32Array(e),n=new Uint8Array(e);if(t[0]=3735928559,239===n[0])return!0;if(222===n[0])return!1;throw new Error("unknown endianness")}}]),t}(gt)})),wo,sp=L((function(){qt(),ve(),wo=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,[{key:"getFunctions",value:function(){return _objectSpread(_objectSpread({},this.setFragColor()),this.getColorAsFloat())}},{key:"getCustomTypes",value:function(){return{}}},{key:"setFragColor",value:function(){var e=q(this.context.glContext.version);return{setFragColor:new G("\n        void setFragColor(float value) {\n            ".concat(e.output," = encode(value);\n        }\n        "),["encoding.encode"])}}},{key:"getColorAsFloat",value:function(){return{getColorAsFloat:new G("\n        float getColorAsFloat(vec4 color) {\n            return decode(color);\n        }\n        ",["encoding.decode"])}}}]),t}(gt)})),vo,up=L((function(){qt(),vo=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,[{key:"getFunctions",value:function(){return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}},{key:"getCustomTypes",value:function(){return{}}},{key:"bcastIndex",value:function(){var e=this,t=this.context.outputTextureLayout.shape.length,n={};return this.context.programInfo.inputNames.forEach((function(r,i){var o=e.context.inputTextureLayouts[i].unpackedShape;if(o.length<=t){for(var a=o.length,s=t-a,u="bcastIndices_".concat(r),c="",l=0;l<a;++l)c+="\n          realIndices[".concat(l,"] = int( mod(float(bcastedIndices[").concat(s+l,"]), ").concat(o[l],".0) );\n          ");var h="\n        void ".concat(u," (int bcastedIndices[").concat(t,"], out int realIndices[").concat(a,"]) {\n          ").concat(c,"\n        }\n        ");n[u]=new G(h)}})),n}},{key:"bcastMatmulIndex",value:function(){var e=this,t=this.context.outputTextureLayout.shape.length,n={};return this.context.programInfo.inputNames.forEach((function(r,i){var o=e.context.inputTextureLayouts[i].shape;if(!(o.length<2||o.length>t)){for(var a=o.length,s=t-a,u="bcastMatmulIndices_".concat(r),c="",l=0;l<a-2;++l)c+="\n          realIndices[".concat(l,"] = int( mod(float(bcastedIndices[").concat(s+l,"]), ").concat(o[l],".0) );\n          ");var h="\n        void ".concat(u,"(int bcastedIndices[").concat(t,"], out int realIndices[").concat(a,"]) {\n          ").concat(c,"\n          realIndices[").concat(a-1,"] = bcastedIndices[").concat(t-1,"];\n          realIndices[").concat(a-2,"] = bcastedIndices[").concat(t-2,"];\n        }\n        ");n[u]=new G(h)}})),n}},{key:"indicesToOffset",value:function(){var e=this,n={};return this.context.programInfo.inputNames.forEach((function(r,i){var o=e.context.inputTextureLayouts[i].shape,a=e.context.inputTextureLayouts[i].strides,s=o.length,u="indicesToOffset_".concat(r);n[u]=new G(t.indexToOffsetSingle(u,s,a)),u="indicesToOffset_".concat(r,"_T"),n[u]=new G(t.indexToOffsetSingle(u,s,a.slice().reverse()))})),n}},{key:"offsetToIndices",value:function(){var e=this,n={};return this.context.programInfo.inputNames.forEach((function(r,i){var o=e.context.inputTextureLayouts[i].shape,a=e.context.inputTextureLayouts[i].strides,s=o.length,u="offsetToIndices_".concat(r);n[u]=new G(t.offsetToIndicesSingle(u,s,a)),u="offsetToIndices_".concat(r,"_T"),n[u]=new G(t.offsetToIndicesSingle(u,s,a.slice().reverse()))})),n}},{key:"incrementIndices",value:function(){var e=this,t={};return this.context.programInfo.inputNames.forEach((function(n,r){for(var i=e.context.inputTextureLayouts[r].shape,o=i.length,a="incrementIndices_".concat(n),s="",u=0;u<o;++u)s+="\n        shape[".concat(u,"] = ").concat(i[u],";");var c="\n        void ".concat(a,"(int axis, out int indices[").concat(o,"]) {\n          int shape[").concat(o,"];\n          ").concat(s,";\n          for(int i = ").concat(o," -1 ; i >= 0; --i) {\n            if(i > axis) continue;\n            indices[i] += 1;\n            if(indices[i] < shape[i]) {\n              break;\n            }\n            indices[i] = 0;\n          }\n        }\n        ");t[a]=new G(c)})),t}}],[{key:"indexToOffsetSingle",value:function(e,t,n){for(var r="",i=t-1;i>=0;--i)r+="\n        offset += indices[".concat(i,"] * ").concat(n[i],";\n        ");return"\n      int ".concat(e,"(int indices[").concat(t,"]) {\n        int offset = 0;\n        ").concat(r,"\n        return offset;\n      }\n      ")}},{key:"offsetToIndicesSingle",value:function(e,t,n){for(var r=[],i=0;i<t-1;++i)r.push("\n      indices[".concat(i,"] = offset / ").concat(n[i],";")),r.push("\n        offset -= indices[".concat(i,"] * ").concat(n[i],";"));return r.push("\n      indices[".concat(t-1,"] = offset;")),"\n      void ".concat(e,"(int offset, out int indices[").concat(t,"]) {\n        ").concat(r.join(""),"\n      }\n      ")}}]),t}(gt)})),_o,lp=L((function(){qt(),_o=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,[{key:"getCustomTypes",value:function(){return{}}},{key:"getFunctions",value:function(){return _objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}},{key:"binaryVecFunctions",value:function(){var e=this.context.outputTextureLayout.shape.length,t={add:"+=",sub:"-=",mul:"*=",div:"/="},n={};for(var r in t){for(var i="".concat(r,"Vec"),o="",a=0;a<e;++a)o+="\n          dest[".concat(a,"] ").concat(t[r]," src[").concat(a,"];\n          ");var s="\n        void ".concat(i,"(int src[").concat(e,"], out int dest[").concat(e,"]) {\n          ").concat(o,"\n        }\n        ");n[i]=new G(s)}return n}},{key:"copyVec",value:function(){for(var e=this.context.outputTextureLayout.shape.length,t="",n=0;n<e;++n)t+="\n        dest[".concat(n,"] = src[").concat(n,"];\n        ");return{copyVec:new G("\n      void copyVec(int src[".concat(e,"], out int dest[").concat(e,"]) {\n        ").concat(t,"\n      }\n      "))}}},{key:"setVecItem",value:function(){for(var e=this.context.outputTextureLayout.shape.length,t="\n        if(index < 0)\n            index =".concat(e," + index;\n        if (index == 0)\n            m[0] = value;\n        "),n=1;n<e-1;++n)t+="\n        else if (index == ".concat(n,")\n            m[").concat(n,"] = value;\n            ");return t+="\n        else\n            m[".concat(e-1,"] = value;\n        "),{setVecItem:new G("\n      void setVecItem(out int m[".concat(e,"], int index, int value) {\n        ").concat(t,"\n      }\n        "))}}},{key:"getVecItem",value:function(){for(var e=this.context.outputTextureLayout.shape.length,t="\n        if(index < 0)\n            index = ".concat(e," + index;\n        if (index == 0)\n            return m[0];\n      "),n=1;n<e-1;++n)t+="\n        else if (index == ".concat(n,")\n            return m[").concat(n,"];\n      ");return t+="\n        else\n            return m[".concat(e-1,"];\n        "),{getVecItem:new G("\n      int getVecItem(int m[".concat(e,"], int index) {\n        ").concat(t,"\n      }\n    "))}}}]),t}(gt)})),Ji,fp=L((function(){ip(),ap(),sp(),up(),lp(),Ji={encoding:xo,fragcolor:wo,vec:_o,shapeUtils:vo,coordinates:To}})),Oo,cp=L((function(){qt(),np(),fp(),ve(),Oo=function(){function e(t,n,r,i){var o=this;_classCallCheck(this,e),this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new so(t,n,r,i),Object.keys(Ji).forEach((function(e){var t=new Ji[e](o.context);o.libs[e]=t}));var a=this.glslLibRoutineDependencyGraph;for(var s in this.libs){var u=this.libs[s].getFunctions();for(var c in u){var l=void 0,h=s+"."+c;a[h]?(l=a[h]).routineBody=u[c].routineBody:(l=new gn(h,u[c].routineBody),a[h]=l);var f=u[c].dependencies;if(f)for(var d=0;d<f.length;++d)if(a[f[d]])l.addDependency(a[f[d]]);else{var p=new gn(f[d]);a[f[d]]=p,l.addDependency(p)}}}}return _createClass(e,[{key:"preprocess",value:function(){var e=this.context.programInfo,t=e.shaderSource;return this.context.programInfo.hasMain||(t="".concat(t,"\n      ").concat(Vu(this.context.glContext.version,this.context.outputTextureLayout.shape.length))),t=rp(t),"".concat(Wu(this.context.glContext.version),"\n    ").concat(this.getUniforms(e.inputNames,e.variables),"\n    ").concat(this.getImports(t),"\n    ").concat(t)}},{key:"getImports",value:function(e){var t=this.selectGlslLibRoutinesToBeIncluded(e);if(0===t.length)return"";for(var n="",r=0;r<t.length;++r){if(!t[r].routineBody)throw new Error("Missing body for the Glsl Library routine: ".concat(t[r].name));n+=t[r].routineBody+"\n"}return n}},{key:"selectGlslLibRoutinesToBeIncluded",value:function(e){var t=this,n=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach((function(r){var i=r.split(".")[1];-1!==e.indexOf(i)&&n.push(t.glslLibRoutineDependencyGraph[r])})),uo.returnOrderedNodes(n)}},{key:"getUniforms",value:function(e,t){var n=[];if(e){var r,i=_createForOfIteratorHelper(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.push("uniform sampler2D ".concat(o,";"))}}catch(c){i.e(c)}finally{i.f()}}if(t){var a,s=_createForOfIteratorHelper(t);try{for(s.s();!(a=s.n()).done;){var u=a.value;n.push("uniform ".concat(u.type," ").concat(u.name).concat(u.arrayLength?"[".concat(u.arrayLength,"]"):"",";"))}}catch(c){s.e(c)}finally{s.f()}}return n.join("\n")}}]),e}()})),Io,pp=L((function(){It(),dt(),cp(),ve(),Io=function(){function e(t,n,r){_classCallCheck(this,e),this.profiler=t,this.glContext=n,this.textureLayoutStrategy=r,this.repo=new Map,this.attributesBound=!1}return _createClass(e,[{key:"getArtifact",value:function(e){return this.repo.get(e)}},{key:"setArtifact",value:function(e,t){this.repo.set(e,t)}},{key:"run",value:function(e,t,n){var r,i=this;this.profiler.event("op","ProgramManager.run ".concat(null!==(r=e.programInfo.name)&&void 0!==r?r:"unknown kernel"),(function(){var r=i.glContext.gl,o=e.program;r.useProgram(o);try{var a;i.bindOutput(n),i.attributesBound||i.bindAttributes(e.attribLocations),i.bindUniforms(e.uniformLocations,null!==(a=e.programInfo.variables)&&void 0!==a?a:[],t)}catch(t){throw pe.error("ProgramManager",e.programInfo.shaderSource),t}i.profiler.event("backend","GlContext.draw()",(function(){i.glContext.draw()}))}),this.glContext)}},{key:"dispose",value:function(){var e=this;this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach((function(t){return e.glContext.deleteProgram(t.program)}))}},{key:"build",value:function(e,t,n){var r=this;return this.profiler.event("backend","ProgramManager.build",(function(){var i=new Oo(r.glContext,e,t,n),o=i.preprocess(),a=r.compile(o);return{programInfo:e,program:a,uniformLocations:r.getUniformLocations(a,i.context.programInfo.inputNames,i.context.programInfo.variables),attribLocations:r.getAttribLocations(a)}}))}},{key:"compile",value:function(e){if(!this.vertexShader){pe.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");var t=zu(this.glContext.version);this.vertexShader=this.glContext.compileShader(t,this.glContext.gl.VERTEX_SHADER)}ee.debug&&pe.verbose("ProrgramManager","FragShader:\n".concat(e,"\n"));var n=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),r=this.glContext.createProgram(this.vertexShader,n);return this.glContext.deleteShader(n),r}},{key:"bindOutput",value:function(e){var t=e.width,n=e.height;pe.verbose("ProrgramManager","Binding output texture to Framebuffer: w/h=".concat(t,"/").concat(n,", shape=").concat(e.shape,", type=").concat(e.tensor.type)),this.glContext.attachFramebuffer(e.texture,t,n)}},{key:"bindAttributes",value:function(e){var t=e.position,n=e.textureCoord;this.glContext.setVertexAttributes(t,n),this.attributesBound=!0}},{key:"bindUniforms",value:function(e,t,n){var r,i=this,o=this.glContext.gl,a=0,s=_createForOfIteratorHelper(e);try{var u=function(){var e,s=r.value,u=s.name,c=s.type,l=s.location,h=s.arrayLength,f=null===(e=t.find((function(e){return e.name===u})))||void 0===e?void 0:e.data;if("sampler2D"!==c&&!f)throw new Error("variable '".concat(u,"' does not have data defined in program info"));switch(c){case"sampler2D":i.bindTexture(n[a],l,a),a++;break;case"float":h?o.uniform1fv(l,f):o.uniform1f(l,f);break;case"int":h?o.uniform1iv(l,f):o.uniform1i(l,f);break;default:throw new Error("Uniform not implemented: ".concat(c))}};for(s.s();!(r=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}}},{key:"bindTexture",value:function(e,t,n){this.glContext.bindTextureToUniform(e.texture,n,t)}},{key:"getAttribLocations",value:function(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")}}},{key:"getUniformLocations",value:function(e,t,n){var r=[];if(t){var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.push({name:a,type:"sampler2D",location:this.getUniformLocation(e,a)})}}catch(l){o.e(l)}finally{o.f()}}if(n){var s,u=_createForOfIteratorHelper(n);try{for(u.s();!(s=u.n()).done;){var c=s.value;r.push(_objectSpread(_objectSpread({},c),{},{location:this.getUniformLocation(e,c.name)}))}}catch(l){u.e(l)}finally{u.f()}}return r}},{key:"getUniformLocation",value:function(e,t){var n=this.glContext.gl.getUniformLocation(e,t);if(null===n)throw new Error("Uniform ".concat(t," not found."));return n}},{key:"getAttribLocation",value:function(e,t){return this.glContext.gl.getAttribLocation(e,t)}}]),e}()})),So,dp=L((function(){dt(),mn(),So=function(){function e(t,n,r,i){_classCallCheck(this,e),this.glContext=t,this.layoutStrategy=n,this.profiler=r,this.config=i,this.pendingRead=new Map,i.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}return _createClass(e,[{key:"createTextureFromLayout",value:function(e,t,n,r){var i=this.toEncoderType(e),o=this.glContext.getEncoder(i,t.channels||1,r);if(t.isPacked&&1===r)throw new Error("not implemented");var a,s,u=t.width,c=t.height;if(this.config.reuseTextures){a="".concat(u,"x").concat(c,"_").concat(o.format,"_").concat(o.internalFormat,"_").concat(o.textureType),(s=this.inUseTextures.get(a))||(s=[],this.inUseTextures.set(a,s));var l=this.idleTextures.get(a);if(l&&l.length>0){var h=l.pop();return s.push(h),1===r&&this.glContext.updateTexture(h,u,c,o,this.toTextureData(e,n)),h}}pe.verbose("TextureManager","Creating new texture of size ".concat(t.width,"x").concat(t.height));var f=this.glContext.allocateTexture(u,c,o,this.toTextureData(e,n));return this.config.reuseTextures&&(s.push(f),this.textureLookup.set(f,a)),f}},{key:"readTexture",value:function(e,t,n){var r=this;return n||(n=1),this.profiler.event("backend","TextureManager.readTexture",(function(){var i=e.shape.reduce((function(e,t){return e*t}))*n,o=r.glContext.readTexture(e.texture,e.width,e.height,i,r.toEncoderType(t),n);return r.toTensorData(t,o)}))}},{key:"readTextureAsync",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.tensor.dataId,r||(r=1),!this.pendingRead.has(i)){e.next=4;break}return o=this.pendingRead.get(i),e.abrupt("return",new Promise((function(e){return null===o||void 0===o?void 0:o.push(e)})));case 4:return e.abrupt("return",this.profiler.event("backend","TextureManager.readTextureAsync",_asyncToGenerator(_regeneratorRuntime().mark((function e(){var o,s,u,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.pendingRead.set(i,[]),o=t.shape.reduce((function(e,t){return e*t}))*r,e.next=4,a.glContext.createAndWaitForFence();case 4:return s=a.glContext.readTexture(t.texture,t.width,t.height,o,a.toEncoderType(n),r),u=a.toTensorData(n,s),c=a.pendingRead.get(i),e.abrupt("return",(a.pendingRead.delete(i),null!==c&&void 0!==c&&c.forEach((function(e){return e(u)})),u));case 6:case"end":return e.stop()}}),e)})))));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"readUint8TextureAsFloat",value:function(e){var t=this;return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",(function(){var n=e.shape.reduce((function(e,t){return e*t})),r=t.glContext.readTexture(e.texture,e.width,e.height,4*n,"byte",4);return new Float32Array(r.buffer,r.byteOffset,n)}))}},{key:"releaseTexture",value:function(e,t){var n;if(this.config.reuseTextures&&(n=this.textureLookup.get(e.texture))){t&&this.textureLookup.delete(n);var r=this.inUseTextures.get(n);if(r){var i=r.indexOf(e.texture);if(-1!==i){r.splice(i,1);var o=this.idleTextures.get(n);o||(o=[],this.idleTextures.set(n,o)),o.push(e.texture)}}}(!n||t)&&(pe.verbose("TextureManager","Deleting texture of size ".concat(e.width,"x").concat(e.height)),this.glContext.deleteTexture(e.texture))}},{key:"toTensorData",value:function(e,t){switch(e){case"int16":return t instanceof Int16Array?t:Int16Array.from(t);case"int32":return t instanceof Int32Array?t:Int32Array.from(t);case"int8":return t instanceof Int8Array?t:Int8Array.from(t);case"uint16":return t instanceof Uint16Array?t:Uint16Array.from(t);case"uint32":return t instanceof Uint32Array?t:Uint32Array.from(t);case"uint8":case"bool":return t instanceof Uint8Array?t:Uint8Array.from(t);case"float32":return t instanceof Float32Array?t:Float32Array.from(t);case"float64":return t instanceof Float64Array?t:Float64Array.from(t);default:throw new Error("TensorData type ".concat(e," is not supported"))}}},{key:"toTextureData",value:function(e,t){if(t)return t instanceof Float32Array?t:new Float32Array(t)}},{key:"toEncoderType",value:function(e){return"float"}},{key:"clearActiveTextures",value:function(){this.glContext.clearActiveTextures()}}]),e}()})),Ao,hp=L((function(){dt(),Es(),il(),ep(),pp(),Ki(),dp(),Ao=function(){function e(t,n){_classCallCheck(this,e),this.backend=t,this.context=n,this.layoutStrategy=new yo(t.glContext.maxTextureSize),this.programManager=new Io(this.context.profiler,t.glContext,this.layoutStrategy),this.textureManager=new So(t.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:"full"===t.textureCacheMode}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=t.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}return _createClass(e,[{key:"createInferenceHandler",value:function(){return new ao(this)}},{key:"onGraphInitialized",value:function(e){var t=e.getValues().filter((function(e){return-1===e.from&&e.tensor})).map((function(e){return e.tensor.dataId}));this.initializers=new Set(t)}},{key:"isInitializer",value:function(e){return!!this.initializers&&this.initializers.has(e)}},{key:"addInitializer",value:function(e){this.initializers.add(e)}},{key:"getTextureData",value:function(e,t){return t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}},{key:"setTextureData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];pe.verbose("WebGLSessionHandler","Storing Texture data in cache"),n?this.packedTextureDataCache.set(e,t):this.unpackedTextureDataCache.set(e,t)}},{key:"dispose",value:function(){var e=this;this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((function(t){return e.textureManager.releaseTexture(t,!0)})),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((function(t){return e.textureManager.releaseTexture(t,!0)})),this.unpackedTextureDataCache=new Map}},{key:"resolve",value:function(e,t,n){var r=As(e,t,Qc);return{impl:r.opImpl,context:r.opInit?r.opInit(e,n):e}}}]),e}()}));function rg(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}var xn,mp=L((function(){It(),mn(),mn(),Bt(),xn=function(){function e(t,n){_classCallCheck(this,e),this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=t,this.version=n,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}return _createClass(e,[{key:"allocateTexture",value:function(e,t,n,r){var i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);var a=r?n.encode(r,e*t):null;return i.texImage2D(i.TEXTURE_2D,0,n.internalFormat,e,t,0,n.format,n.textureType,a),this.checkError(),o}},{key:"updateTexture",value:function(e,t,n,r,i){var o=this.gl;o.bindTexture(o.TEXTURE_2D,e);var a=r.encode(i,t*n);o.texSubImage2D(o.TEXTURE_2D,0,0,0,t,n,r.format,r.textureType,a),this.checkError()}},{key:"attachFramebuffer",value:function(e,t,n){var r=this.gl;r.bindTexture(r.TEXTURE_2D,e),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.checkError(),r.viewport(0,0,t,n),r.scissor(0,0,t,n)}},{key:"readTexture",value:function(e,t,n,r,i,o){var a=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(e,t,n);var s=this.getEncoder(i,o),u=s.allocate(t*n);return a.bindTexture(a.TEXTURE_2D,e),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.readPixels(0,0,t,n,a.RGBA,s.textureType,u),this.checkError(),s.decode(u,r)}},{key:"isFramebufferReady",value:function(){return!0}},{key:"getActiveTexture",value:function(){var e=this.gl;return"TEXTURE"+(e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0)}},{key:"getTextureBinding",value:function(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}},{key:"getFramebufferBinding",value:function(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}},{key:"setVertexAttributes",value:function(e,t){var n=this.gl;n.vertexAttribPointer(e,3,n.FLOAT,!1,20,0),n.enableVertexAttribArray(e),-1!==t&&(n.vertexAttribPointer(t,2,n.FLOAT,!1,20,12),n.enableVertexAttribArray(t)),this.checkError()}},{key:"createProgram",value:function(e,t){var n=this.gl,r=n.createProgram();return n.attachShader(r,e),n.attachShader(r,t),n.linkProgram(r),r}},{key:"compileShader",value:function(e,t){var n=this.gl,r=n.createShader(t);if(!r)throw new Error("createShader() returned null with type ".concat(t));if(n.shaderSource(r,e),n.compileShader(r),!1===n.getShaderParameter(r,n.COMPILE_STATUS))throw new Error("Failed to compile shader: ".concat(n.getShaderInfoLog(r),"\nShader source:\n").concat(e));return r}},{key:"deleteShader",value:function(e){this.gl.deleteShader(e)}},{key:"bindTextureToUniform",value:function(e,t,n){var r=this.gl;r.activeTexture(r.TEXTURE0+t),this.checkError(),r.bindTexture(r.TEXTURE_2D,e),this.checkError(),r.uniform1i(n,t),this.checkError()}},{key:"draw",value:function(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}},{key:"checkError",value:function(){if(ee.debug){var e=this.gl,t=e.getError(),n="";switch(t){case e.NO_ERROR:return;case e.INVALID_ENUM:n="INVALID_ENUM";break;case e.INVALID_VALUE:n="INVALID_VALUE";break;case e.INVALID_OPERATION:n="INVALID_OPERATION";break;case e.INVALID_FRAMEBUFFER_OPERATION:n="INVALID_FRAMEBUFFER_OPERATION";break;case e.OUT_OF_MEMORY:n="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:n="CONTEXT_LOST_WEBGL";break;default:n="Unknown WebGL Error: ".concat(t.toString(16))}throw new Error(n)}}},{key:"deleteTexture",value:function(e){this.gl.deleteTexture(e)}},{key:"deleteProgram",value:function(e){this.gl.deleteProgram(e)}},{key:"getEncoder",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(2===this.version)return new oo(this.gl,t);switch(e){case"float":return 1===n||this.isRenderFloat32Supported?new hn(this.gl,t):new hn(this.gl,t,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new io(this.gl,t);default:throw new Error("Invalid dataType: ".concat(e))}}},{key:"clearActiveTextures",value:function(){for(var e=this.gl,t=0;t<this.maxTextureImageUnits;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null)}},{key:"dispose",value:function(){if(!this.disposed){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0}}},{key:"createDefaultGeometry",value:function(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}},{key:"createVertexbuffer",value:function(){var e=this.gl,t=e.createBuffer();if(!t)throw new Error("createBuffer() returned null");var n=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this.checkError(),t}},{key:"createFramebuffer",value:function(){var e=this.gl.createFramebuffer();if(!e)throw new Error("createFramebuffer returned null");return e}},{key:"queryVitalParameters",value:function(){var e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),1===this.version&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version}},{key:"getExtensions",value:function(){2===this.version?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}},{key:"checkFloatTextureAttachableToFrameBuffer",value:function(){var e=this.gl,t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);var n=2===this.version?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,n,1,1,0,e.RGBA,e.FLOAT,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(r),i}},{key:"checkRenderFloat32",value:function(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}},{key:"checkFloat32Download",value:function(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}},{key:"checkFloat32Blend",value:function(){var e,t,n,r,i,o=this.gl;try{e=o.createTexture(),t=o.createFramebuffer(),o.bindTexture(o.TEXTURE_2D,e);var a=2===this.version?o.RGBA32F:o.RGBA;return o.texImage2D(o.TEXTURE_2D,0,a,1,1,0,o.RGBA,o.FLOAT,null),o.bindFramebuffer(o.FRAMEBUFFER,t),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),o.enable(o.BLEND),!!((n=o.createShader(o.VERTEX_SHADER))&&(o.shaderSource(n,"void main(){}"),o.compileShader(n),r=o.createShader(o.FRAGMENT_SHADER),r)&&(o.shaderSource(r,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),o.compileShader(r),i=o.createProgram(),i))&&(o.attachShader(i,n),o.attachShader(i,r),o.linkProgram(i),o.useProgram(i),o.drawArrays(o.POINTS,0,1),o.getError()===o.NO_ERROR)}finally{o.disable(o.BLEND),i&&o.deleteProgram(i),n&&o.deleteShader(n),r&&o.deleteShader(r),t&&(o.bindFramebuffer(o.FRAMEBUFFER,null),o.deleteFramebuffer(t)),e&&(o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(e))}}},{key:"beginTimer",value:function(){if(2===this.version&&this.disjointTimerQueryWebgl2Extension){var e=this.gl,t=this.disjointTimerQueryWebgl2Extension,n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}throw new Error("WebGL1 profiling currently not supported.")}},{key:"endTimer",value:function(){if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");var e=this.gl,t=this.disjointTimerQueryWebgl2Extension;e.endQuery(t.TIME_ELAPSED_EXT)}},{key:"isTimerResultAvailable",value:function(e){var t,n;if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");var r=this.gl,i=this.disjointTimerQueryWebgl2Extension;return t=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE),n=r.getParameter(i.GPU_DISJOINT_EXT),t&&!n}},{key:"getTimerResult",value:function(e){var t;if(2!==this.version)throw new Error("WebGL1 profiling currently not supported");var n=this.gl;return t=n.getQueryParameter(e,n.QUERY_RESULT),n.deleteQuery(e),t/1e6}},{key:"waitForQueryAndGetTime",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vi((function(){return n.isTimerResultAvailable(t)}));case 2:return e.abrupt("return",this.getTimerResult(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createAndWaitForFence",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.createFence(this.gl),e.abrupt("return",this.pollFence(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createFence",value:function(e){var t,n=e,r=n.fenceSync(n.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),t=null===r?function(){return!0}:function(){var e=n.clientWaitSync(r,0,0);return e===n.ALREADY_SIGNALED||e===n.CONDITION_SATISFIED},{query:r,isFencePassed:t}}},{key:"pollFence",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.addItemToPoll((function(){return t.isFencePassed()}),(function(){return e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"pollItems",value:function(){for(var e=rg(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),e.t0=!(this.itemsToPoll.length>1),!e.t0){e.next=5;break}return e.next=5,vi((function(){return r.pollItems(),0===r.itemsToPoll.length}));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()}));function Zi(e){var t;if(e&&"webgl2"!==e||!("webgl2"in Xr)?(!e||"webgl"===e)&&"webgl"in Xr&&(t=Xr.webgl):t=Xr.webgl2,!t)try{t=bp(og(),e)}catch(r){t=bp(ng(),e)}e=e||1===t.version?"webgl":"webgl2";var n=t.gl;return Xr[e]=t,n.isContextLost()?(delete Xr[e],Zi(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),t)}function bp(e,t){var n,r={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!t||"webgl2"===t)&&(n=e.getContext("webgl2",r)))try{return new xn(n,2)}catch(e){pe.warning("GlContextFactory","failed to create WebGLContext using contextId 'webgl2'. Error: ".concat(e))}if((!t||"webgl"===t)&&(n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r)))try{return new xn(n,1)}catch(e){pe.warning("GlContextFactory","failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ".concat(e))}throw new Error("WebGL is not supported")}function ng(){if(("undefined"===typeof document?"undefined":_typeof(document))>"u")throw new TypeError("failed to create canvas: document is not supported");var e=document.createElement("canvas");return e.width=1,e.height=1,e}function og(){if(("undefined"===typeof OffscreenCanvas?"undefined":_typeof(OffscreenCanvas))>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var Xr,gp=L((function(){dt(),mp(),Xr={}})),Eo,yp=L((function(){It(),dt(),hp(),gp(),Eo=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"contextId",get:function(){return ee.webgl.contextId},set:function(e){ee.webgl.contextId=e}},{key:"matmulMaxBatchSize",get:function(){return ee.webgl.matmulMaxBatchSize},set:function(e){ee.webgl.matmulMaxBatchSize=e}},{key:"textureCacheMode",get:function(){return ee.webgl.textureCacheMode},set:function(e){ee.webgl.textureCacheMode=e}},{key:"pack",get:function(){return ee.webgl.pack},set:function(e){ee.webgl.pack=e}},{key:"async",get:function(){return ee.webgl.async},set:function(e){ee.webgl.async=e}},{key:"initialize",value:function(){try{return this.glContext=Zi(this.contextId),"number"!=typeof this.matmulMaxBatchSize&&(this.matmulMaxBatchSize=16),"string"!=typeof this.textureCacheMode&&(this.textureCacheMode="full"),"boolean"!=typeof this.pack&&(this.pack=!1),"boolean"!=typeof this.async&&(this.async=!1),pe.setWithEnv(ee),ee.webgl.context||Object.defineProperty(ee.webgl,"context",{value:this.glContext.gl}),pe.verbose("WebGLBackend","Created WebGLContext: ".concat(_typeof(this.glContext)," with matmulMaxBatchSize: ").concat(this.matmulMaxBatchSize,"; textureCacheMode: ").concat(this.textureCacheMode,"; pack: ").concat(this.pack,"; async: ").concat(this.async,".")),!0}catch(e){return pe.warning("WebGLBackend","Unable to initialize WebGLBackend. ".concat(e)),!1}}},{key:"createSessionHandler",value:function(e){return new Ao(this,e)}},{key:"dispose",value:function(){this.glContext.dispose()}}]),t}()}));function Qi(e){return _Qi.apply(this,arguments)}function _Qi(){return _Qi=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Qi(["webgl"]));case 2:n=_createForOfIteratorHelper("string"==typeof t?[t]:t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=18;break}if(i=r.value,!(o=Tp.get(i))){e.next=11;break}return e.abrupt("return",o);case 11:return e.next=13,ag(i);case 13:if(!(a=e.sent)){e.next=16;break}return e.abrupt("return",a);case 16:e.next=6;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),n.e(e.t0);case 23:return e.prev=23,n.f(),e.finish(23);case 26:throw new Error("no available backend to use");case 27:case"end":return e.stop()}}),e,null,[[4,20,23,26]])}))),_Qi.apply(this,arguments)}function ag(e){return _ag.apply(this,arguments)}function _ag(){return _ag=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(_typeof((n=ig)[t])<"u"&&sg(n[t]))){e.next=10;break}if(r=n[t],i=r.initialize(),e.t0="object"==_typeof(i)&&"then"in i,!e.t0){e.next=8;break}return e.next=7,i;case 7:i=e.sent;case 8:if(!i){e.next=10;break}return e.abrupt("return",(Tp.set(t,r),r));case 10:case"end":return e.stop()}}),e)}))),_ag.apply(this,arguments)}function sg(e){var t=e;return"initialize"in t&&"function"==typeof t.initialize&&"createSessionHandler"in t&&"function"==typeof t.createSessionHandler&&"dispose"in t&&"function"==typeof t.dispose}var Tp,ig,xp=L((function(){yp(),Tp=new Map,ig={webgl:new Eo}})),ea,Po,wp=L((function(){dt(),ea=_createClass((function e(t,n){_classCallCheck(this,e),this.op=t,this.node=n})),Po=function(){function e(t,n,r){_classCallCheck(this,e),this.graph=t,this.profiler=r,this.initialize(n)}return _createClass(e,[{key:"initialize",value:function(e){var t=this;this.profiler.event("session","ExecutionPlan.initialize",(function(){var n=t.graph.getNodes();if(n.length!==e.length)throw new Error("The size of nodes and OPs do not match.");t._ops=e.map((function(e,t){return new ea(e,n[t])})),t.reset(),t._starter=[],t._ops.forEach((function(e,n){var r,i=!0,o=_createForOfIteratorHelper(e.node.inputs);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(!t._values[a]&&-1===t.graph.getInputIndices().indexOf(a)){i=!1;break}}}catch(s){o.e(s)}finally{o.f()}i&&t._starter.push(n)}))}))}},{key:"reset",value:function(){this._values=this.graph.getValues().map((function(e){return e.tensor}))}},{key:"execute",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.profiler.event("session","ExecutionPlan.execute",_asyncToGenerator(_regeneratorRuntime().mark((function e(){var i,o,a,s,u,c,l,h,f,d,p;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.reset(),i=t.createInferenceHandler(),o=r.graph.getInputIndices(),n.length===o.length){e.next=4;break}throw new Error("number of input tensors don't match the number of inputs to the model: actual: ".concat(n.length," expected: ").concat(o.length));case 4:n.forEach((function(e,t){var n=o[t];r._values[n]=e})),a=r._starter.slice(0),s=r.graph.getValues(),u=r.graph.getNodes(),c=0,l=_regeneratorRuntime().mark((function e(){var t,n,o,l,h,f;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a[c++],n=r._ops[t],o=n.node.inputs.map((function(e){return r._values[e]})),-1===o.indexOf(void 0)){e.next=3;break}throw new Error("unresolved input detected: op: ".concat(n.node));case 3:return l=o,pe.verbose("ExecPlan","Runing op:".concat(n.node.name," (").concat(l.map((function(e,t){return"'".concat(n.node.inputs[t],"': ").concat(e.type,"[").concat(e.dims.join(","),"]")})).join(", "),")")),e.next=7,r.profiler.event("node",n.node.name,_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.op.impl(i,l,n.op.context));case 1:case"end":return e.stop()}}),e)}))));case 7:if((h=e.sent).length===n.node.outputs.length){e.next=10;break}throw new Error("the size of output does not match model definition.");case 10:h.forEach((function(e,t){var i=n.node.outputs[t];if(r._values[i])throw new Error("output [".concat(i,"] already has value: op:").concat(n.node.name));r._values[i]=e})),f=new Set,h.forEach((function(e,t){var i,o=n.node.outputs[t],a=_createForOfIteratorHelper(s[o].to);try{for(a.s();!(i=a.n()).done;){var c,l=i.value,h=u[l],d=!0,p=_createForOfIteratorHelper(h.inputs);try{for(p.s();!(c=p.n()).done;){var y=c.value;if(!r._values[y]){d=!1;break}}}catch(g){p.e(g)}finally{p.f()}d&&f.add(l)}}catch(g){a.e(g)}finally{a.f()}})),a.push.apply(a,_toConsumableArray(f));case 13:case"end":return e.stop()}}),e)}));case 7:if(!(c<a.length)){e.next=11;break}return e.delegateYield(l(),"t0",9);case 9:e.next=7;break;case 11:h=[],f=0;case 13:if(!(f<r.graph.getOutputIndices().length)){e.next=27;break}if(d=r.graph.getOutputIndices()[f],void 0!==(p=r._values[d])){e.next=17;break}throw new Error("required output [".concat(d,"] does not have value"));case 17:if(0!==d){e.next=22;break}return e.next=20,p.getData();case 20:e.next=23;break;case 22:p.data;case 23:h.push(p);case 24:f++,e.next=13;break;case 27:return e.abrupt("return",(pe.verbose("ExecPlan","disposing of inferenceHandler"),i.dispose(),h));case 28:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()})),oe,xt,wn,vp=L((function(){un(),oe=Nr(Ur()),_r(),fe(),xt=H.experimental.fbs,wn=function(){function e(t){if(_classCallCheck(this,e),this._attributes=new Map,null!=t){var n,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;i instanceof oe.onnx.AttributeProto?this._attributes.set(i.name,[e.getValue(i),e.getType(i)]):i instanceof xt.Attribute&&this._attributes.set(i.name(),[e.getValue(i),e.getType(i)])}}catch(o){r.e(o)}finally{r.f()}if(this._attributes.size<t.length)throw new Error("duplicated attribute names")}}return _createClass(e,[{key:"set",value:function(e,t,n){this._attributes.set(e,[n,t])}},{key:"delete",value:function(e){this._attributes.delete(e)}},{key:"getFloat",value:function(e,t){return this.get(e,"float",t)}},{key:"getInt",value:function(e,t){return this.get(e,"int",t)}},{key:"getString",value:function(e,t){return this.get(e,"string",t)}},{key:"getTensor",value:function(e,t){return this.get(e,"tensor",t)}},{key:"getFloats",value:function(e,t){return this.get(e,"floats",t)}},{key:"getInts",value:function(e,t){return this.get(e,"ints",t)}},{key:"getStrings",value:function(e,t){return this.get(e,"strings",t)}},{key:"getTensors",value:function(e,t){return this.get(e,"tensors",t)}},{key:"get",value:function(e,t,n){var r=this._attributes.get(e);if(void 0===r){if(void 0!==n)return n;throw new Error("required attribute not found: ".concat(e))}if(r[1]!==t)throw new Error("type mismatch: expected ".concat(t," but got ").concat(r[1]));return r[0]}}],[{key:"getType",value:function(e){var t=e instanceof oe.onnx.AttributeProto?e.type:e.type();switch(t){case oe.onnx.AttributeProto.AttributeType.FLOAT:return"float";case oe.onnx.AttributeProto.AttributeType.INT:return"int";case oe.onnx.AttributeProto.AttributeType.STRING:return"string";case oe.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case oe.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case oe.onnx.AttributeProto.AttributeType.INTS:return"ints";case oe.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case oe.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error("attribute type is not supported yet: ".concat(oe.onnx.AttributeProto.AttributeType[t]))}}},{key:"getValue",value:function(e){var t=e instanceof oe.onnx.AttributeProto?e.type:e.type();if(t===oe.onnx.AttributeProto.AttributeType.GRAPH||t===oe.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");var n=this.getValueNoCheck(e);if(t===oe.onnx.AttributeProto.AttributeType.INT&&ot.isLong(n))return ot.longToNumber(n);if(t===oe.onnx.AttributeProto.AttributeType.INTS){for(var r=n,i=new Array(r.length),o=0;o<r.length;o++){var a=r[o];i[o]=ot.longToNumber(a)}return i}if(t===oe.onnx.AttributeProto.AttributeType.TENSOR)return e instanceof oe.onnx.AttributeProto?Ce.fromProto(n):Ce.fromOrtTensor(n);if(t===oe.onnx.AttributeProto.AttributeType.TENSORS){if(e instanceof oe.onnx.AttributeProto)return n.map((function(e){return Ce.fromProto(e)}));if(e instanceof xt.Attribute)return n.map((function(e){return Ce.fromOrtTensor(e)}))}return t===oe.onnx.AttributeProto.AttributeType.STRING&&e instanceof oe.onnx.AttributeProto?dn(n):t===oe.onnx.AttributeProto.AttributeType.STRINGS&&e instanceof oe.onnx.AttributeProto?n.map(dn):n}},{key:"getValueNoCheck",value:function(e){return e instanceof oe.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(e):this.getValueNoCheckFromOrtFormat(e)}},{key:"getValueNoCheckFromOnnxFormat",value:function(e){switch(e.type){case oe.onnx.AttributeProto.AttributeType.FLOAT:return e.f;case oe.onnx.AttributeProto.AttributeType.INT:return e.i;case oe.onnx.AttributeProto.AttributeType.STRING:return e.s;case oe.onnx.AttributeProto.AttributeType.TENSOR:return e.t;case oe.onnx.AttributeProto.AttributeType.GRAPH:return e.g;case oe.onnx.AttributeProto.AttributeType.FLOATS:return e.floats;case oe.onnx.AttributeProto.AttributeType.INTS:return e.ints;case oe.onnx.AttributeProto.AttributeType.STRINGS:return e.strings;case oe.onnx.AttributeProto.AttributeType.TENSORS:return e.tensors;case oe.onnx.AttributeProto.AttributeType.GRAPHS:return e.graphs;default:throw new Error("unsupported attribute type: ".concat(oe.onnx.AttributeProto.AttributeType[e.type]))}}},{key:"getValueNoCheckFromOrtFormat",value:function(e){switch(e.type()){case xt.AttributeType.FLOAT:return e.f();case xt.AttributeType.INT:return e.i();case xt.AttributeType.STRING:return e.s();case xt.AttributeType.TENSOR:return e.t();case xt.AttributeType.GRAPH:return e.g();case xt.AttributeType.FLOATS:return e.floatsArray();case xt.AttributeType.INTS:for(var t=[],n=0;n<e.intsLength();n++)t.push(e.ints(n));return t;case xt.AttributeType.STRINGS:for(var r=[],i=0;i<e.stringsLength();i++)r.push(e.strings(i));return r;case xt.AttributeType.TENSORS:for(var o=[],a=0;a<e.tensorsLength();a++)o.push(e.tensors(a));return o;default:throw new Error("unsupported attribute type: ".concat(xt.AttributeType[e.type()]))}}}]),e}()})),ra,Do,na,Rt,Lo,ta,_p=L((function(){vp(),un(),ra=Nr(Ur()),_r(),fe(),Do=H.experimental.fbs,na={from:function(e,t){return new ta(e,t)}},Rt=function(){function e(t){_classCallCheck(this,e),this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,t&&(this.type=Ve.tensorValueTypeFromProto(t.type.tensorType))}return _createClass(e,[{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}}]),e}(),Lo=_createClass((function e(t,n){_classCallCheck(this,e),t instanceof ra.onnx.NodeProto?(this.name=t.name,this.opType=t.opType,this.attributes=new wn(t.attribute)):t instanceof Do.Node&&(this.name=null!==n&&void 0!==n?n:t.name(),this.opType=t.opType(),this.attributes=new wn(Ve.tensorAttributesFromORTFormat(t))),this.inputs=[],this.outputs=[],this.executeNode=!0})),ta=function(){function e(t,n){if(_classCallCheck(this,e),!t)throw new TypeError("graph is empty");this.buildGraph(t),this.transformGraph(n),this.checkIsAcyclic()}return _createClass(e,[{key:"getInputIndices",value:function(){return this._allInputIndices}},{key:"getInputNames",value:function(){return this._allInputNames}},{key:"getOutputIndices",value:function(){return this._allOutputIndices}},{key:"getOutputNames",value:function(){return this._allOutputNames}},{key:"getValues",value:function(){return this._allData}},{key:"getNodes",value:function(){return this._nodes}},{key:"buildGraph",value:function(e){if(e instanceof ra.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else{if(!(e instanceof Do.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(e)}}},{key:"buildGraphFromOnnxFormat",value:function(e){var t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];var n=new Map;if(!e.input)throw new Error("missing information in graph: input");var r,i=[],o=_createForOfIteratorHelper(e.input);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(t.has(a.name))throw new Error("duplicated input name: ".concat(a.name));var s=this._allData.push(new Rt(a))-1;t.set(a.name,s),i.push(a.name)}}catch(N){o.e(N)}finally{o.f()}if(!e.initializer)throw new Error("missing information in graph: initializer");var u,c=_createForOfIteratorHelper(e.initializer);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=t.get(l.name);if(void 0===h){var f=new Rt;f.type={shape:{dims:Ve.tensorDimsFromProto(l.dims)},tensorType:Ve.tensorDataTypeFromProto(l.dataType)},h=this._allData.push(f)-1,t.set(l.name,h)}this._allData[h]._from=-1,this._allData[h].tensor=Ce.fromProto(l)}}catch(N){c.e(N)}finally{c.f()}for(var d=0;d<this._allData.length;d++)this._allData[d].tensor||(this._allInputIndices.push(d),this._allInputNames.push(i[d]));if(!e.output)throw new Error("missing information in graph: output");var p,y=_createForOfIteratorHelper(e.output);try{for(y.s();!(p=y.n()).done;){var g=p.value;if(t.has(g.name))throw new Error("duplicated output name: ".concat(g.name));var m=this._allData.push(new Rt(g))-1;t.set(g.name,m),this._allOutputIndices.push(m),this._allOutputNames.push(g.name)}}catch(N){y.e(N)}finally{y.f()}if(!e.node)throw new Error("missing information in graph: node");var v,w=_createForOfIteratorHelper(e.node);try{for(w.s();!(v=w.n()).done;){var b=v.value;if(!b.name)for(var x=0;;x++){var _="unnamed_".concat(b.opType,"_").concat(x);if(!n.has(_)){b.name=_;break}}if(n.has(b.name))throw new Error("duplicated node name: ".concat(b.name));var I=this._nodes.push(new Lo(b))-1;n.set(b.name,I)}}catch(N){w.e(N)}finally{w.f()}for(var A=0;A<this._nodes.length;A++){var C=this._nodes[A],k=e.node[A];if(!k.output)throw new Error("missing output for node: ".concat(k.name));var S,T=_createForOfIteratorHelper(k.output);try{for(T.s();!(S=T.n()).done;){var E=S.value,O=t.get(E);if(_typeof(O)>"u"&&(O=this._allData.push(new Rt)-1,t.set(E,O)),C.outputs.push(O),void 0!==this._allData[O]._from)throw new Error("multiple nodes output to one data value: ".concat(O));if(this._allData[O]._from=A,"Constant"===k.opType){if(!k.attribute||1!==k.attribute.length||!k.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!k.output||1!==k.output.length)throw new Error("missing output or incorrect number of outputs for this Constant operator");C.outputs.pop(),C.executeNode=!1,this._allData[O]._from=-1,this._allData[O].tensor=Ce.fromProto(k.attribute[0].t)}}}catch(N){T.e(N)}finally{T.f()}}for(var P=0;P<this._nodes.length;P++){var R=this._nodes[P],B=e.node[P];if(!B.input)throw new Error("missing input for node: ".concat(B.name));var D,M=_createForOfIteratorHelper(B.input);try{for(M.s();!(D=M.n()).done;){var L=D.value,F=t.get(L);if(_typeof(F)>"u"){if(""===L&&(3===B.input.length||4===B.input.length)&&"Resize"===B.opType)continue;throw new Error("unrecognized input '".concat(L,"' for node: ").concat(B.name))}R.inputs.push(F),this._allData[F]._to.push(P)}}catch(N){M.e(N)}finally{M.f()}}return!0}},{key:"buildGraphFromOrtFormat",value:function(e){var t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];for(var n=new Map,r=[],i=0;i<e.inputsLength();i++){var o=e.inputs(i);if(t.has(o))throw new Error("duplicated input name: ".concat(o));for(var a=0;a<e.nodeArgsLength();a++){var s;if((null===(s=e.nodeArgs(a))||void 0===s?void 0:s.name())===o){var u,c=new Rt;if((null===(u=e.nodeArgs(a))||void 0===u||null===(u=u.type())||void 0===u?void 0:u.valueType())!==Do.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");for(var l=e.nodeArgs(a).type().value(new Do.TensorTypeAndShape),h=Ve.tensorDataTypeFromProto(l.elemType()),f=l.shape(),d=[],p=0;p<f.dimLength();p++)d.push(ot.longToNumber(f.dim(p).value().dimValue()));c.type={shape:{dims:d},tensorType:h};var y=this._allData.push(c)-1;t.set(o,y),r.push(o)}}}for(var g=0;g<e.initializersLength();g++){var m=e.initializers(g),v=t.get(m.name());if(void 0===v){var w=new Rt,b=Ve.tensorDimsFromORTFormat(m),x=Ve.tensorDataTypeFromProto(m.dataType());w.type={shape:{dims:b},tensorType:x},v=this._allData.push(w)-1,t.set(m.name(),v)}this._allData[v]._from=-1,this._allData[v].tensor=Ce.fromOrtTensor(m)}for(var _=0;_<this._allData.length;_++)this._allData[_].tensor||(this._allInputIndices.push(_),this._allInputNames.push(r[_]));for(var I=0;I<e.outputsLength();I++){var A=e.outputs(I);if(t.has(A))throw new Error("duplicated output name: ".concat(A));var C=this._allData.push(new Rt)-1;t.set(A,C),this._allOutputIndices.push(C),this._allOutputNames.push(A)}if(!e.nodes)throw new Error("missing information in graph: node");for(var k=0;k<e.nodesLength();k++){var S=e.nodes(k),T=S.name();if(!T)for(var E=0;T="unnamed_".concat(S.opType(),"_").concat(E),n.has(T);E++);if(n.has(T))throw new Error("duplicated node name: ".concat(T));var O=this._nodes.push(new Lo(S,T))-1;n.set(T,O)}for(var P=0;P<this._nodes.length;P++){var R=this._nodes[P],B=e.nodes(P);if(null==B)throw new Error("No node exists at index ".concat(P));if(0===(null===B||void 0===B?void 0:B.outputsLength()))throw new Error("missing output for node: ".concat(B.name));for(var D=0;D<(null===B||void 0===B?void 0:B.outputsLength());D++){var M=null===B||void 0===B?void 0:B.outputs(D),L=t.get(M);if(_typeof(L)>"u"&&(L=this._allData.push(new Rt)-1,t.set(M,L)),R.outputs.push(L),void 0!==this._allData[L]._from)throw new Error("multiple nodes output to one data value: ".concat(L));if(this._allData[L]._from=P,"Constant"===B.opType()){if(1!==B.attributesLength()||!B.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(1!==B.outputsLength())throw new Error("missing output or incorrect number of outputs for this Constant operator");R.outputs.pop(),R.executeNode=!1,this._allData[L]._from=-1,this._allData[L].tensor=Ce.fromOrtTensor(B.attributes(0).t())}}}for(var F=0;F<this._nodes.length;F++){var N=this._nodes[F],U=e.nodes(F);if(0===U.inputsLength())throw new Error("missing input for node: ".concat(U.name));for(var j=0;j<U.inputsLength();j++){var G=U.inputs(j),z=t.get(G);if(_typeof(z)>"u")throw new Error("unrecognized input '".concat(G,"' for node: ").concat(U.name()));N.inputs.push(z),this._allData[z]._to.push(F)}}}},{key:"checkIsAcyclic",value:function(){var e=this,t=new Set;this._allInputIndices.forEach((function(n){e._allData[n]._to.forEach((function(e){t.add(e)}))}));for(var n=Array.from(t),r=new Array(this._nodes.length).fill("white"),i=function(){var t=n.pop();"gray"===r[t]?r[t]="black":(n.push(t),r[t]="gray",e._nodes[t].outputs.forEach((function(i){var o=e._allData[i];if(_typeof(o.tensor)<"u")throw new Error("node outputs should not be initialized");if(o._from!==t)throw new Error("from property of the Value object doesn't match index of Node being processed");o._to.forEach((function(e){if("gray"===r[e])throw new Error("model graph is cyclic");"white"===r[e]&&n.push(e)}))})))};n.length>0;)i()}},{key:"transformGraph",value:function(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph()}},{key:"finalizeGraph",value:function(){for(var e=this,t=0,n=new Array(this._nodes.length,0),r=0,i=0;i<this._nodes.length;i++)n[i]=r,this._nodes[i].executeNode?(r!==i&&(this._nodes[r]=this._nodes[i]),r++):this._nodes[i].outputs.forEach((function(t){e._allData[t]._from=-2}));this._nodes.splice(r,this._nodes.length-r);for(var o=0;o<this._allData.length;o++){var a=this._allData[o];void 0!==a._from&&-1!==a._from&&-2!==a._from&&(a._from=n[a._from]);for(var s=0;s<a._to.length;s++){if(!(a._to[s]>=0))throw new Error("Trying to update a removed node");a._to[s]=n[a._to[s]]}}t=0;for(var u=function(n){if(-2!==e._allData[n].from||-1!==e._allOutputIndices.indexOf(n+t)){if(t>0){var r=-1;void 0!==e._allData[n].from&&-1!==e._allData[n].from?-1!==(r=e._nodes[e._allData[n].from].outputs.indexOf(n+t))&&(e._nodes[e._allData[n].from].outputs[r]=n):-1!==(r=e._allInputIndices.indexOf(n+t))&&(e._allInputIndices[r]=n),e._allData[n].to.forEach((function(i){-1!==(r=e._nodes[i].inputs.indexOf(n+t))&&(e._nodes[i].inputs[r]=n)})),0===e._allData[n].to.length&&(-1!==(r=e._allOutputIndices.indexOf(n+t))&&(e._allOutputIndices[r]=n))}}else t++,e._allData.splice(n,1),n--;c=n},c=0;c<this._allData.length;c++)u(c)}},{key:"deleteNode",value:function(e){var t=this._nodes[e];if(t.outputs.length>1)for(var n=1;n<t.outputs.length;n++)if(this._allData[t.outputs[n]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ");t.executeNode=!1;for(var r=t.inputs[0],i=t.outputs[0],o=this._allData[i].to,a=0;a<t.inputs.length;a++){var s=this._allData[t.inputs[a]].to.indexOf(e);if(-1===s)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[t.inputs[a]].to.splice(s,1)}this._allData[i]._to=[];var u=this._allOutputIndices.indexOf(i);if(-1!==u&&(this._allOutputIndices[u]=r),o&&o.length>0){var c,l=_createForOfIteratorHelper(o);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=this._nodes[h].inputs.indexOf(i);if(-1===f)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[h].inputs[f]=r,this._allData[r].to.push(h)}}catch(d){l.e(d)}finally{l.f()}}}},{key:"removeAllDropoutNodes",value:function(){var e,t=0,n=_createForOfIteratorHelper(this._nodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;if("Dropout"===r.opType){if(1!==r.inputs.length)throw new Error("Dropout nodes should only contain one input. ");if(1!==r.outputs.length&&2!==r.outputs.length)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(2===r.outputs.length&&0!==this._allData[r.outputs[1]]._to.length)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(t)}t++}}catch(i){n.e(i)}finally{n.f()}}},{key:"removeAllIdentityNodes",value:function(){var e,t=0,n=_createForOfIteratorHelper(this._nodes);try{for(n.s();!(e=n.n()).done;){"Identity"===e.value.opType&&this.deleteNode(t),t++}}catch(r){n.e(r)}finally{n.f()}}},{key:"isActivation",value:function(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}},{key:"fuseConvActivationNodes",value:function(){var e,t=_createForOfIteratorHelper(this._nodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("Conv"===n.opType){var r=this._allData[n.outputs[0]]._to;if(1===r.length&&this.isActivation(this._nodes[r[0]])){var i=this._nodes[r[0]];if("Clip"===i.opType)if(1===i.inputs.length)try{n.attributes.set("activation_params","floats",[i.attributes.getFloat("min"),i.attributes.getFloat("max")])}catch(o){n.attributes.set("activation_params","floats",[wr,vr])}else{if(!(i.inputs.length>=3&&void 0!==this._allData[i.inputs[1]].tensor&&void 0!==this._allData[i.inputs[2]].tensor))continue;n.attributes.set("activation_params","floats",[this._allData[i.inputs[1]].tensor.floatData[0],this._allData[i.inputs[2]].tensor.floatData[0]])}n.attributes.set("activation","string",i.opType),this.deleteNode(r[0])}}}}catch(a){t.e(a)}finally{t.f()}}}]),e}()})),Op,ug,Fo,Ip=L((function(){Jn(),_p(),un(),Op=Nr(Ur()),fe(),ug=H.experimental.fbs,Fo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"load",value:function(e,t,n){if(!n)try{return void this.loadFromOnnxFormat(e,t)}catch(e){if(void 0!==n)throw e}this.loadFromOrtFormat(e,t)}},{key:"loadFromOnnxFormat",value:function(e,t){var n=Op.onnx.ModelProto.decode(e);if(ot.longToNumber(n.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=n.opsetImport.map((function(e){return{domain:e.domain,version:ot.longToNumber(e.version)}})),this._graph=na.from(n.graph,t)}},{key:"loadFromOrtFormat",value:function(e,t){var n=new O.ByteBuffer(e),r=ug.InferenceSession.getRootAsInferenceSession(n).model();if(ot.longToNumber(r.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(var i=0;i<r.opsetImportLength();i++){var o=r.opsetImport(i);this._opsets.push({domain:null===o||void 0===o?void 0:o.domain(),version:ot.longToNumber(o.version())})}this._graph=na.from(r.graph(),t)}},{key:"graph",get:function(){return this._graph}},{key:"opsets",get:function(){return this._opsets}}]),e}()})),Co,Sp=L((function(){xp(),wp(),dt(),Ip(),Co=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this._initialized=!1,this.backendHint=t.backendHint,this.profiler=Xn.create(t.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}return _createClass(e,[{key:"inputNames",get:function(){return this._model.graph.getInputNames()}},{key:"outputNames",get:function(){return this._model.graph.getOutputNames()}},{key:"startProfiling",value:function(){this.profiler.start()}},{key:"endProfiling",value:function(){this.profiler.stop()}},{key:"loadModel",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.profiler.event("session","Session.loadModel",_asyncToGenerator(_regeneratorRuntime().mark((function e(){var o,a,s,u,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qi(i.backendHint);case 2:if(o=e.sent,i.sessionHandler=o.createSessionHandler(i.context),i._model=new Fo,"string"!=typeof t){e.next=20;break}if(a=t.endsWith(".ort"),!(_typeof(process)<"u"&&process.versions&&process.versions.node)){e.next=12;break}return e.next=8,(void 0)(t);case 8:s=e.sent,i.initialize(s,a),e.next=18;break;case 12:return e.next=14,fetch(t);case 14:return e.next=16,e.sent.arrayBuffer();case 16:u=e.sent,i.initialize(new Uint8Array(u),a);case 18:e.next=21;break;case 20:ArrayBuffer.isView(t)?i.initialize(t):(c=new Uint8Array(t,n||0,r||t.byteLength),i.initialize(c));case 21:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"initialize",value:function(e,t){var n=this;if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",(function(){var r=n.sessionHandler.transformGraph?n.sessionHandler:void 0;n._model.load(e,r,t),n.sessionHandler.onGraphInitialized&&n.sessionHandler.onGraphInitialized(n._model.graph),n.initializeOps(n._model.graph),n._executionPlan=new Po(n._model.graph,n._ops,n.profiler)})),this._initialized=!0}},{key:"run",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initialized){e.next=2;break}throw new Error("session not initialized yet");case 2:return e.abrupt("return",this.profiler.event("session","Session.run",_asyncToGenerator(_regeneratorRuntime().mark((function e(){var r,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.normalizeAndValidateInputs(t),e.next=3,n._executionPlan.execute(n.sessionHandler,r);case 3:return i=e.sent,e.abrupt("return",n.createOutput(i));case 5:case"end":return e.stop()}}),e)})))));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"normalizeAndValidateInputs",value:function(e){var t=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==t.length)throw new Error("incorrect input array length: expected ".concat(t.length," but got ").concat(e.length))}else{if(e.size!==t.length)throw new Error("incorrect input map size: expected ".concat(t.length," but got ").concat(e.size));for(var n=new Array(e.size),r=0,i=0;i<t.length;++i){var o=e.get(t[i]);if(!o)throw new Error("missing input tensor for: '".concat(name,"'"));n[r++]=o}e=n}if(this.context.graphInputTypes&&0!==this.context.graphInputTypes.length&&this.context.graphInputDims&&0!==this.context.graphInputDims.length)this.validateInputTensorDims(this.context.graphInputDims,e,!1);else{for(var a=this._model.graph.getInputIndices(),s=this._model.graph.getValues(),u=new Array(a.length),c=0;c<a.length;++c){var l=s[a[c]];u[c]=l.type.shape.dims,this.context.graphInputTypes.push(l.type.tensorType),this.context.graphInputDims.push(e[c].dims)}this.validateInputTensorDims(u,e,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,e),e}},{key:"validateInputTensorTypes",value:function(e,t){for(var n=0;n<t.length;n++){var r=e[n],i=t[n].type;if(r!==i)throw new Error("input tensor[".concat(n,"] check failed: expected type '").concat(r,"' but got ").concat(i))}}},{key:"validateInputTensorDims",value:function(e,t,n){for(var r=0;r<t.length;r++){var i=e[r],o=t[r].dims;if(!this.compareTensorDims(i,o,n))throw new Error("input tensor[".concat(r,"] check failed: expected shape '[").concat(i.join(","),"]' but got [").concat(o.join(","),"]"))}}},{key:"compareTensorDims",value:function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r]&&(!n||0!==e[r]))return!1;return!0}},{key:"createOutput",value:function(e){var t=this._model.graph.getOutputNames();if(e.length!==t.length)throw new Error("expected number of outputs do not match number of generated outputs");for(var n=new Map,r=0;r<t.length;++r)n.set(t[r],e[r]);return n}},{key:"initializeOps",value:function(e){var t=e.getNodes();this._ops=new Array(t.length);for(var n=0;n<t.length;n++)this._ops[n]=this.sessionHandler.resolve(t[n],this._model.opsets,e)}}]),e}()})),$o,Ap=L((function(){It(),_r(),$o=function(){function e(t){_classCallCheck(this,e),this.session=t,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}return _createClass(e,[{key:"dispose",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in i=new Map,t)Object.hasOwnProperty.call(t,o)&&(a=t[o],i.set(o,new Ce(a.dims,a.type,void 0,void 0,a.data)));return e.next=4,this.session.run(i);case 4:return s=e.sent,u={},e.abrupt("return",(s.forEach((function(e,t){u[t]=new Re(e.type,e.data,e.dims)})),u));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"auth",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"startProfiling",value:function(){this.session.startProfiling()}},{key:"endProfiling",value:function(){this.session.endProfiling()}}]),e}()})),Ep={};kr(Ep,{onnxjsBackend:function(){return fg}});var oa,fg,Pp=L((function(){Sp(),Ap(),fg=new(oa=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"createInferenceSessionHandler",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Co(n),e.next=3,r.loadModel(t);case 3:return e.abrupt("return",new $o(r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}())})),ia={};kr(ia,{createReadStream:function(){return Dp},readFile:function(){return cg},readFileSync:function(){return pg}});var cg,pg,Dp,aa=L((function(){cg=void 0,pg=void 0,Dp=void 0})),sa={};kr(sa,{join:function(){return dg}});var dg,ua=L((function(){dg=void 0})),Cp=ye((function(e,t){var n=function(){var e=("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return _typeof(__filename)<"u"&&(e=e||__filename),function(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r;i.ready=new Promise((function(e,r){t=e,n=r}));var o,a,s,u=Object.assign({},i),c="./this.program",l="object"==("undefined"===typeof window?"undefined":_typeof(window)),h="function"==typeof importScripts,f="object"==_typeof(process)&&"object"==_typeof(process.versions)&&"string"==typeof process.versions.node,d="";if(f){var p=(aa(),fr(ia)),y=(ua(),fr(sa));d=h?y.dirname(d)+"/":__dirname+"/",o=function(e,t){return e=M(e)?new URL(e):y.normalize(e),p.readFileSync(e,t?void 0:"utf8")},s=function(e){return(e=o(e,!0)).buffer||(e=new Uint8Array(e)),e},a=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e=M(e)?new URL(e):y.normalize(e),p.readFile(e,r?void 0:"utf8",(function(e,i){e?n(e):t(r?i.buffer:i)}))},!i.thisProgram&&1<process.argv.length&&(c=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),i.inspect=function(){return"[Emscripten Module object]"}}else(l||h)&&(h?d=self.location.href:("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript&&(d=document.currentScript.src),e&&(d=e),d=0!==d.indexOf("blob:")?d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},h&&(s=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var g=console.log.bind(console),m=console.error.bind(console);Object.assign(i,u),u=null,"object"!=("undefined"===typeof WebAssembly?"undefined":_typeof(WebAssembly))&&R("no native wasm support detected");var v,w,b,x,_,I,A=!1;function C(){var e=v.buffer;i.HEAP8=w=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=b=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=x=new Int32Array(e),i.HEAPU32=_=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=I=new Float64Array(e)}var k=[],S=[],T=[],E=0,O=null,P=null;function R(e){throw m(e="Aborted("+e+")"),A=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var B,D=function(e){return e.startsWith("data:application/octet-stream;base64,")},M=function(e){return e.startsWith("file://")};if(!D(B="ort-wasm.wasm")){var L=B;B=i.locateFile?i.locateFile(L,d):d+L}function F(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function N(e,t,n){return function(e){if(l||h){if("function"==typeof fetch&&!M(e))return fetch(e,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((function(){return F(e)}));if(a)return new Promise((function(t,n){a(e,(function(e){return t(new Uint8Array(e))}),n)}))}return Promise.resolve().then((function(){return F(e)}))}(e).then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(n,(function(e){m("failed to asynchronously prepare wasm: ".concat(e)),R(e)}))}var U,j={882112:function(e,t,n,r){if(_typeof(i)>"u"||!i.Ga)return 1;if((e=W(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ga.get(e)))return 2;if((t>>>=0)+(n>>>=0)>e.byteLength)return 3;try{return b.set(e.subarray(t,t+n),r>>>0>>>0),0}catch(o){return 4}}};function G(e){this.Da=e-24,this.Fa=function(e){_[this.Da+4>>>2>>>0]=e},this.Ea=function(e){_[this.Da+8>>>2>>>0]=e},this.La=function(e,t){this.Ma(),this.Fa(e),this.Ea(t)},this.Ma=function(){_[this.Da+16>>>2>>>0]=0}}var z,H=("undefined"===typeof TextDecoder?"undefined":_typeof(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,V=function(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&H)return H.decode(e.subarray(t,n));for(r="";t<n;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}return r},W=function(e,t){return(e>>>=0)?V(b,e,t):""},$=function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t},Y=function(e,t,n,r){if(!(0<r))return 0;var i=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(n>=r)break;t[n++>>>0]=a}else{if(2047>=a){if(n+1>=r)break;t[n++>>>0]=192|a>>6}else{if(65535>=a){if(n+2>=r)break;t[n++>>>0]=224|a>>12}else{if(n+3>=r)break;t[n++>>>0]=240|a>>18,t[n++>>>0]=128|a>>12&63}t[n++>>>0]=128|a>>6&63}t[n++>>>0]=128|63&a}}return t[n>>>0]=0,n-i},K=function(e){return e%4==0&&(e%100!=0||e%400==0)},X=[0,31,60,91,121,152,182,213,244,274,305,335],Z=[0,31,59,90,120,151,181,212,243,273,304,334],q=function(e){var t=$(e)+1,n=pe(t);return n&&Y(e,b,n,t),n},J=[],Q={},ee=function(){if(!z){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"===typeof navigator?"undefined":_typeof(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:c||"./this.program"};for(e in Q)void 0===Q[e]?delete t[e]:t[e]=Q[e];var n=[];for(e in t)n.push("".concat(e,"=").concat(t[e]));z=n}return z},te=[null,[],[]],ne=function(e){return(ne=function(){if("object"==("undefined"===typeof crypto?"undefined":_typeof(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return crypto.getRandomValues(e)};if(f)try{var e=Ka("crypto");if(e.randomFillSync)return function(t){return e.randomFillSync(t)};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e}}catch(n){}R("initRandomDevice")}())(e)},re=[31,29,31,30,31,30,31,31,30,31,30,31],ie=[31,28,31,30,31,30,31,31,30,31,30,31];function oe(e,t,n,r){function i(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function o(e,t){return i(e,t,"0")}function a(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.ya;for(e=new Date(new Date(e.za+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(K(e.getFullYear())?re:ie)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),n=s(n),0>=a(t,e)?0>=a(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0;var c=_[40+(r>>>=0)>>>2>>>0];for(var l in r={Ja:x[r>>>2>>>0],Ia:x[r+4>>>2>>>0],Aa:x[r+8>>>2>>>0],Ca:x[r+12>>>2>>>0],Ba:x[r+16>>>2>>>0],za:x[r+20>>>2>>>0],xa:x[r+24>>>2>>>0],ya:x[r+28>>>2>>>0],Na:x[r+32>>>2>>>0],Ha:x[r+36>>>2>>>0],Ka:c?W(c):""},n=W(n),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),c[l]);var h="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f="January February March April May June July August September October November December".split(" ");for(l in c={"%a":function(e){return h[e.xa].substring(0,3)},"%A":function(e){return h[e.xa]},"%b":function(e){return f[e.Ba].substring(0,3)},"%B":function(e){return f[e.Ba]},"%C":function(e){return o((e.za+1900)/100|0,2)},"%d":function(e){return o(e.Ca,2)},"%e":function(e){return i(e.Ca,2," ")},"%g":function(e){return u(e).toString().substring(2)},"%G":function(e){return u(e)},"%H":function(e){return o(e.Aa,2)},"%I":function(e){return 0==(e=e.Aa)?e=12:12<e&&(e-=12),o(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.Ba-1;t+=(K(e.za+1900)?re:ie)[n++]);return o(e.Ca+t,3)},"%m":function(e){return o(e.Ba+1,2)},"%M":function(e){return o(e.Ia,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.Aa&&12>e.Aa?"AM":"PM"},"%S":function(e){return o(e.Ja,2)},"%t":function(){return"\t"},"%u":function(e){return e.xa||7},"%U":function(e){return o(Math.floor((e.ya+7-e.xa)/7),2)},"%V":function(e){var t=Math.floor((e.ya+7-(e.xa+6)%7)/7);if(2>=(e.xa+371-e.ya-2)%7&&t++,t)53==t&&(4==(n=(e.xa+371-e.ya)%7)||3==n&&K(e.za)||(t=1));else{t=52;var n=(e.xa+7-e.ya-1)%7;(4==n||5==n&&K(e.za%400-1))&&t++}return o(t,2)},"%w":function(e){return e.xa},"%W":function(e){return o(Math.floor((e.ya+7-(e.xa+6)%7)/7),2)},"%y":function(e){return(e.za+1900).toString().substring(2)},"%Y":function(e){return e.za+1900},"%z":function(e){return(0<=(e=e.Ha)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4)},"%Z":function(e){return e.Ka},"%%":function(){return"%"}},n=n.replace(/%%/g,"\0\0"),c)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),c[l](r)));return l=function(e){var t=Array($(e)+1);return Y(e,t,0,t.length),t}(n=n.replace(/\0\0/g,"%")),l.length>t?0:(w.set(l,e>>>0),l.length-1)}var ae,se,ue=[],ce=[],le=function(e,t){if(!se){se=new WeakMap;var n=ae.length;if(se)for(var r=0;r<0+n;r++){var i=r,o=ue[i];o||(i>=ue.length&&(ue.length=i+1),ue[i]=o=ae.get(i)),(i=o)&&se.set(i,r)}}if(n=se.get(e)||0)return n;if(ce.length)n=ce.pop();else{try{ae.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}n=ae.length-1}try{r=n,ae.set(r,e),ue[r]=ae.get(r)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){r=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new r(o,e)}else{for(r=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},r.push(96),128>(a=t.length)?r.push(a):r.push(a%128|128,a>>7),a=0;a<t.length;++a)r.push(o[t[a]]);"v"==i?r.push(0):r.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=r.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,r),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}r=n,ae.set(r,t),ue[r]=ae.get(r)}return se.set(e,n),n},he={a:function(e,t,n){throw new G(e>>>=0).La(t>>>0,n>>>0),e},e:function(){return 0},L:function(){},A:function(){},C:function(){},u:function(){return 0},J:function(){},E:function(){},I:function(){},k:function(){},B:function(){},y:function(){},K:function(){},z:function(){},l:function(){return 1},o:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),x[n>>>2>>>0]=e.getUTCSeconds(),x[n+4>>>2>>>0]=e.getUTCMinutes(),x[n+8>>>2>>>0]=e.getUTCHours(),x[n+12>>>2>>>0]=e.getUTCDate(),x[n+16>>>2>>>0]=e.getUTCMonth(),x[n+20>>>2>>>0]=e.getUTCFullYear()-1900,x[n+24>>>2>>>0]=e.getUTCDay(),x[n+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),x[n>>>2>>>0]=e.getSeconds(),x[n+4>>>2>>>0]=e.getMinutes(),x[n+8>>>2>>>0]=e.getHours(),x[n+12>>>2>>>0]=e.getDate(),x[n+16>>>2>>>0]=e.getMonth(),x[n+20>>>2>>>0]=e.getFullYear()-1900,x[n+24>>>2>>>0]=e.getDay(),x[n+28>>>2>>>0]=(K(e.getFullYear())?X:Z)[e.getMonth()]+e.getDate()-1|0,x[n+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var r=new Date(e.getFullYear(),0,1).getTimezoneOffset();x[n+32>>>2>>>0]=0|(t!=r&&e.getTimezoneOffset()==Math.min(r,t))},q:function(e){e>>>=0;var t=new Date(x[e+20>>>2>>>0]+1900,x[e+16>>>2>>>0],x[e+12>>>2>>>0],x[e+8>>>2>>>0],x[e+4>>>2>>>0],x[e>>>2>>>0],0),n=x[e+32>>>2>>>0],r=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>n?x[e+32>>>2>>>0]=+(i!=o&&a==r):0<n!=(a==r)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<n?a:i)-r))),x[e+24>>>2>>>0]=t.getDay(),x[e+28>>>2>>>0]=(K(t.getFullYear())?X:Z)[t.getMonth()]+t.getDate()-1|0,x[e>>>2>>>0]=t.getSeconds(),x[e+4>>>2>>>0]=t.getMinutes(),x[e+8>>>2>>>0]=t.getHours(),x[e+12>>>2>>>0]=t.getDate(),x[e+16>>>2>>>0]=t.getMonth(),x[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(x[de()>>>2>>>0]=61,e=-1):e/=1e3,ge((U=e,1<=+Math.abs(U)?0<U?+Math.floor(U/4294967296)>>>0:~~+Math.ceil((U-+(~~U>>>0))/4294967296)>>>0:0)),e>>>0},m:function(){return-52},n:function(){},w:function(e,t,n){function r(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}n>>>=0;var i=(new Date).getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();_[e>>>0>>>2>>>0]=60*Math.max(i,s),x[t>>>0>>>2>>>0]=+(i!=s),e=r(o),t=r(a),e=q(e),t=q(t),s<i?(_[n>>>2>>>0]=e,_[n+4>>>2>>>0]=t):(_[n>>>2>>>0]=t,_[n+4>>>2>>>0]=e)},d:function(){R("")},D:function(e,t,n){e>>>=0,t>>>=0,n>>>=0,J.length=0;for(var r;r=b[t++>>>0];){var i=105!=r;n+=(i&=112!=r)&&n%8?4:0,J.push(112==r?_[n>>>2>>>0]:105==r?x[n>>>2>>>0]:I[n>>>3>>>0]),n+=i?8:4}return j[e].apply(null,J)},g:function(){return Date.now()},x:function(){return 4294901760},b:function(){return performance.now()},H:function(e,t,n){return t>>>=0,b.copyWithin(e>>>0>>>0,t>>>0,t+(n>>>0)>>>0)},v:function(e){e>>>=0;var t=b.length;if(4294901760<e)return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var i=Math;r=Math.max(e,r);e:{i=(i.min.call(i,4294901760,r+(65536-r%65536)%65536)-v.buffer.byteLength+65535)/65536;try{v.grow(i),C();var o=1;break e}catch(a){}o=void 0}if(o)return!0}return!1},F:function(e,t){e>>>=0,t>>>=0;var n=0;return ee().forEach((function(r,i){var o=t+n;for(i=_[e+4*i>>>2>>>0]=o,o=0;o<r.length;++o)w[i++>>>0>>>0]=r.charCodeAt(o);w[i>>>0>>>0]=0,n+=r.length+1})),0},G:function(e,t){e>>>=0,t>>>=0;var n=ee();_[e>>>2>>>0]=n.length;var r=0;return n.forEach((function(e){return r+=e.length+1})),_[t>>>2>>>0]=r,0},f:function(){return 52},j:function(){return 52},r:function(){return 70},i:function(e,t,n,r){t>>>=0,n>>>=0,r>>>=0;for(var i=0,o=0;o<n;o++){var a=_[t>>>2>>>0],s=_[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var c=b[a+u>>>0],l=te[e];0===c||10===c?((1===e?g:m)(V(l,0)),l.length=0):l.push(c)}i+=s}return _[r>>>2>>>0]=i,0},s:function(e,t){return e>>>=0,ne(b.subarray(e>>>0,e+(t>>>0)>>>0)),0},t:oe,c:function(e,t,n,r){return oe(e>>>0,t>>>0,n>>>0,r>>>0)},h:function(e,t,n,r){var i=ae.length;e=new Uint8Array(b.slice(e+t,e+n));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:v}});for(o in s.exports)le(s.exports[o]);return i<ae.length?i:r}catch(e){return console.log(e),r}}},fe=function(){function e(e){return fe=e.exports,fe=function(){var e=fe,t=function(e){return function(){return e()>>>0}},n=function(e){return function(t){return e(t)>>>0}};return(e=Object.assign({},e)).pa=t(e.pa),e.qa=n(e.qa),e.ua=t(e.ua),e.wa=n(e.wa),e}(),v=fe.M,C(),ae=fe.sa,S.unshift(fe.N),0==--E&&(null!==O&&(clearInterval(O),O=null),P&&(e=P,P=null,e())),fe}var t={a:he};if(E++,i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(e){m("Module.instantiateWasm callback failed with error: ".concat(e)),n(e)}return function(e,t){var n=B;return"function"!=typeof WebAssembly.instantiateStreaming||D(n)||M(n)||f||"function"!=typeof fetch?N(n,e,t):fetch(n,{credentials:"same-origin"}).then((function(r){return WebAssembly.instantiateStreaming(r,e).then(t,(function(r){return m("wasm streaming compile failed: ".concat(r)),m("falling back to ArrayBuffer instantiation"),N(n,e,t)}))}))}(t,(function(t){e(t.instance)})).catch(n),{}}();i._OrtInit=function(e,t){return(i._OrtInit=fe.O)(e,t)},i._OrtGetLastError=function(e,t){return(i._OrtGetLastError=fe.P)(e,t)},i._OrtCreateSessionOptions=function(e,t,n,r,o,a,s,u,c,l){return(i._OrtCreateSessionOptions=fe.Q)(e,t,n,r,o,a,s,u,c,l)},i._OrtAppendExecutionProvider=function(e,t){return(i._OrtAppendExecutionProvider=fe.R)(e,t)},i._OrtAddFreeDimensionOverride=function(e,t,n){return(i._OrtAddFreeDimensionOverride=fe.S)(e,t,n)},i._OrtAddSessionConfigEntry=function(e,t,n){return(i._OrtAddSessionConfigEntry=fe.T)(e,t,n)},i._OrtReleaseSessionOptions=function(e){return(i._OrtReleaseSessionOptions=fe.U)(e)},i._OrtCreateSession=function(e,t,n){return(i._OrtCreateSession=fe.V)(e,t,n)},i._OrtReleaseSession=function(e){return(i._OrtReleaseSession=fe.W)(e)},i._OrtGetInputOutputCount=function(e,t,n){return(i._OrtGetInputOutputCount=fe.X)(e,t,n)},i._OrtGetInputName=function(e,t){return(i._OrtGetInputName=fe.Y)(e,t)},i._OrtGetOutputName=function(e,t){return(i._OrtGetOutputName=fe.Z)(e,t)},i._OrtFree=function(e){return(i._OrtFree=fe._)(e)},i._OrtCreateTensor=function(e,t,n,r,o,a){return(i._OrtCreateTensor=fe.$)(e,t,n,r,o,a)},i._OrtGetTensorData=function(e,t,n,r,o){return(i._OrtGetTensorData=fe.aa)(e,t,n,r,o)},i._OrtReleaseTensor=function(e){return(i._OrtReleaseTensor=fe.ba)(e)},i._OrtCreateRunOptions=function(e,t,n,r){return(i._OrtCreateRunOptions=fe.ca)(e,t,n,r)},i._OrtAddRunConfigEntry=function(e,t,n){return(i._OrtAddRunConfigEntry=fe.da)(e,t,n)},i._OrtReleaseRunOptions=function(e){return(i._OrtReleaseRunOptions=fe.ea)(e)},i._OrtCreateBinding=function(e){return(i._OrtCreateBinding=fe.fa)(e)},i._OrtBindInput=function(e,t,n){return(i._OrtBindInput=fe.ga)(e,t,n)},i._OrtBindOutput=function(e,t,n,r){return(i._OrtBindOutput=fe.ha)(e,t,n,r)},i._OrtClearBoundOutputs=function(e){return(i._OrtClearBoundOutputs=fe.ia)(e)},i._OrtReleaseBinding=function(e){return(i._OrtReleaseBinding=fe.ja)(e)},i._OrtRunWithBinding=function(e,t,n,r,o){return(i._OrtRunWithBinding=fe.ka)(e,t,n,r,o)},i._OrtRun=function(e,t,n,r,o,a,s,u){return(i._OrtRun=fe.la)(e,t,n,r,o,a,s,u)},i._OrtEndProfiling=function(e){return(i._OrtEndProfiling=fe.ma)(e)},i._OrtConfigure=function(e,t){return(i._OrtConfigure=fe.na)(e,t)},i._OrtAuth=function(e,t){return(i._OrtAuth=fe.oa)(e,t)};var de=function(){return(de=fe.pa)()},pe=i._malloc=function(e){return(pe=i._malloc=fe.qa)(e)};i._free=function(e){return(i._free=fe.ra)(e)};var ye,ge=function(e){return(ge=fe.ta)(e)},me=function(){return(me=fe.ua)()},ve=function(e){return(ve=fe.va)(e)},we=function(e){return(we=fe.wa)(e)};function be(){if(!(0<E)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();k.unshift(e)}for(;0<k.length;)k.shift()(i);if(!(0<E||ye||(ye=!0,i.calledRun=!0,A))){for(;0<S.length;)S.shift()(i);for(t(i);0<T.length;)T.shift()(i)}}}return i.___start_em_js=882613,i.___stop_em_js=883225,i.stackAlloc=we,i.stackSave=me,i.stackRestore=ve,i.addFunction=le,i.UTF8ToString=W,i.stringToUTF8=function(e,t,n){return Y(e,b,t,n)},i.lengthBytesUTF8=$,P=function e(){ye||be(),ye||(P=e)},be(),r.ready}}();"object"==_typeof(e)&&"object"==_typeof(t)?t.exports=n:void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return n}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__=[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)})),$p=ye((function(){})),Bp=ye((function(){})),kp={};kr(kp,{cpus:function(){return hg}});var hg,Np=L((function(){hg=void 0})),Gp=ye((function(e,t){var n=function(){var e=("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return _typeof(__filename)<"u"&&(e=e||__filename),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function n(){return E.buffer!=R.buffer&&N(),R}function r(){return E.buffer!=R.buffer&&N(),B}function i(){return E.buffer!=R.buffer&&N(),D}function o(){return E.buffer!=R.buffer&&N(),M}function a(){return E.buffer!=R.buffer&&N(),L}var s,u,c=t;c.ready=new Promise((function(e,t){s=e,u=t}));var l,h,f,d=Object.assign({},c),p="./this.program",y=function(e,t){throw t},g="object"==("undefined"===typeof window?"undefined":_typeof(window)),m="function"==typeof importScripts,v="object"==_typeof(process)&&"object"==_typeof(process.versions)&&"string"==typeof process.versions.node,w=c.ENVIRONMENT_IS_PTHREAD||!1,b="";function x(e){return c.locateFile?c.locateFile(e,b):b+e}if(v){var _,I=(aa(),fr(ia)),A=(ua(),fr(sa));b=m?A.dirname(b)+"/":__dirname+"/",l=function(e,t){return e=Z(e)?new URL(e):A.normalize(e),I.readFileSync(e,t?void 0:"utf8")},f=function(e){return(e=l(e,!0)).buffer||(e=new Uint8Array(e)),e},h=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e=Z(e)?new URL(e):A.normalize(e),I.readFile(e,r?void 0:"utf8",(function(e,i){e?n(e):t(r?i.buffer:i)}))},!c.thisProgram&&1<process.argv.length&&(p=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),y=function(e,t){throw process.exitCode=e,t},c.inspect=function(){return"[Emscripten Module object]"};try{_=$p()}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}__webpack_require__.g.Worker=_.Worker}else(g||m)&&(m?b=self.location.href:("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript&&(b=document.currentScript.src),_typeof(e)<"u"&&e&&(b=e),b=0!==b.indexOf("blob:")?b.substr(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1):"",v||(l=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},m&&(f=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),h=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)}));v&&("undefined"===typeof performance?"undefined":_typeof(performance))>"u"&&(__webpack_require__.g.performance=Bp().performance);var C=console.log.bind(console),k=console.error.bind(console);v&&(C=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return I.writeSync(1,t.join(" ")+"\n")},k=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return I.writeSync(2,t.join(" ")+"\n")});var S=C,T=k;Object.assign(c,d),d=null,"object"!=("undefined"===typeof WebAssembly?"undefined":_typeof(WebAssembly))&&Y("no native wasm support detected");var E,O,P,R,B,D,M,L,F=!1;function N(){var e=E.buffer;c.HEAP8=R=new Int8Array(e),c.HEAP16=new Int16Array(e),c.HEAPU8=B=new Uint8Array(e),c.HEAPU16=new Uint16Array(e),c.HEAP32=D=new Int32Array(e),c.HEAPU32=M=new Uint32Array(e),c.HEAPF32=new Float32Array(e),c.HEAPF64=L=new Float64Array(e)}var U=16777216;if(w)E=c.wasmMemory;else if(c.wasmMemory)E=c.wasmMemory;else if(!((E=new WebAssembly.Memory({initial:U/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw T("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&T("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");N(),U=E.buffer.byteLength;var j=[],G=[],z=[],H=0,V=null,W=null;function $(){if(0==--H&&(null!==V&&(clearInterval(V),V=null),W)){var e=W;W=null,e()}}function Y(e){throw T(e="Aborted("+e+")"),F=!0,P=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),u(e),e}var K,X=function(e){return e.startsWith("data:application/octet-stream;base64,")},Z=function(e){return e.startsWith("file://")};function q(e){if(f)return f(e);throw"both async and sync fetching of the wasm failed"}function J(e,t,n){return function(e){if(g||m){if("function"==typeof fetch&&!Z(e))return fetch(e,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((function(){return q(e)}));if(h)return new Promise((function(t,n){h(e,(function(e){return t(new Uint8Array(e))}),n)}))}return Promise.resolve().then((function(){return q(e)}))}(e).then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(n,(function(e){T("failed to asynchronously prepare wasm: ".concat(e)),Y(e)}))}X(K="ort-wasm-threaded.wasm")||(K=x(K));var Q,ee={886500:function(e,t,n,i){if(_typeof(c)>"u"||!c.hb)return 1;if((e=se(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=c.hb.get(e)))return 2;if(i>>>=0,(t>>>=0)+(n>>>=0)>e.byteLength)return 3;try{return r().set(e.subarray(t,t+n),i>>>0),0}catch(o){return 4}}};function te(e){this.name="ExitStatus",this.message="Program terminated with exit(".concat(e,")"),this.status=e}var ne=function(e){e.terminate(),e.onmessage=function(){}},re=function(e){0==fe.Ta.length&&(he(),fe.bb(fe.Ta[0]));var t=fe.Ta.pop();if(!t)return 6;fe.Ua.push(t),fe.Qa[e.Sa]=t,t.Sa=e.Sa;var n={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return v&&t.unref(),t.postMessage(n,e.ub),0},ie=0,oe=("undefined"===typeof TextDecoder?"undefined":_typeof(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,ae=function(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&oe)return oe.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(r="";t<n;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}return r},se=function(e,t){return(e>>>=0)?ae(r(),e,t):""};function ue(e,t){var n=arguments.length-2,r=arguments;return function(e){var t=At();return e=e(),Ct(t),e}((function(){for(var i=kt(8*n),o=i>>>3,s=0;s<n;s++){var u=r[2+s];a()[o+s>>>0]=u}return vt(e,n,i,t)}))}function ce(e){var t;if(w)return ue(0,1,e);P=e,0<ie||(fe.pb(),null!==(t=c.onExit)&&void 0!==t&&t.call(c,e),F=!0),y(e,new te(e))}var le=function(e){if(P=e,w)throw pe(e),"unwind";ce(e)};function he(){var e=x("ort-wasm-threaded.worker.js");e=new Worker(e),fe.Ta.push(e)}var fe={Ta:[],Ua:[],gb:[],Qa:{},$a:function(){w?(fe.receiveObjectTransfer=fe.nb,fe.threadInitTLS=fe.fb,fe.setExitStatus=fe.eb):function(){for(var e=c.numThreads;e--;)he();j.unshift((function(){H++,function(e){w?e():Promise.all(fe.Ta.map(fe.bb)).then(e)}((function(){return $()}))}))}()},eb:function(e){return P=e},xb:["$terminateWorker"],pb:function(){var e,t=_createForOfIteratorHelper(fe.Ua);try{for(t.s();!(e=t.n()).done;){var n=e.value;ne(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=_createForOfIteratorHelper(fe.Ta);try{for(i.s();!(r=i.n()).done;)n=r.value,ne(n)}catch(o){i.e(o)}finally{i.f()}fe.Ta=[],fe.Ua=[],fe.Qa=[]},cb:function(e){var t=e.Sa;delete fe.Qa[t],fe.Ta.push(e),fe.Ua.splice(fe.Ua.indexOf(e),1),e.Sa=0,wt(t)},nb:function(){},fb:function(){fe.gb.forEach((function(e){return e()}))},bb:function(t){return new Promise((function(n){t.onmessage=function(e){var r=(e=e.data).cmd;if(e.targetThread&&e.targetThread!=pt()){var i=fe.Qa[e.targetThread];i?i.postMessage(e,e.transferList):T('Internal error! Worker sent a message "'.concat(r,'" to target pthread ').concat(e.targetThread,", but that thread no longer exists!"))}else"checkMailbox"===r?Ne():"spawnThread"===r?re(e):"cleanupThread"===r?fe.cb(fe.Qa[e.thread]):"killThread"===r?(e=e.thread,r=fe.Qa[e],delete fe.Qa[e],ne(r),wt(e),fe.Ua.splice(fe.Ua.indexOf(r),1),r.Sa=0):"cancelThread"===r?fe.Qa[e.thread].postMessage({cmd:"cancel"}):"loaded"===r?(t.loaded=!0,v&&!t.Sa&&t.unref(),n(t)):"alert"===r?alert("Thread ".concat(e.threadId,": ").concat(e.text)):"setimmediate"===e.target?t.postMessage(e):"callHandler"===r?c[e.handler].apply(c,_toConsumableArray(e.args)):r&&T("worker sent an unknown command ".concat(r))},t.onerror=function(e){throw T("worker sent an error! ".concat(e.filename,":").concat(e.lineno,": ").concat(e.message)),e},v&&(t.on("message",(function(e){return t.onmessage({data:e})})),t.on("error",(function(e){return t.onerror(e)})));for(var r,i=[],o=0,a=["onExit"];o<a.length;o++)r=a[o],c.hasOwnProperty(r)&&i.push(r);t.postMessage({cmd:"load",handlers:i,urlOrBlob:c.mainScriptUrlOrBlob||e,wasmMemory:E,wasmModule:O})}))}};c.PThread=fe;var de=function(e){for(;0<e.length;)e.shift()(c)};function pe(e){if(w)return ue(1,0,e);le(e)}c.establishStackSpace=function(){var e=pt(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],It(t,t-e),Ct(t)};var ye,ge=[],me=function(e){var t=ge[e];return t||(e>=ge.length&&(ge.length=e+1),ge[e]=t=ye.get(e)),t};function ve(e){this.Za=e-24,this.kb=function(e){o()[this.Za+4>>>2>>>0]=e},this.jb=function(e){o()[this.Za+8>>>2>>>0]=e},this.$a=function(e,t){this.ib(),this.kb(e),this.jb(t)},this.ib=function(){o()[this.Za+16>>>2>>>0]=0}}function we(e,t,n,r){return w?ue(2,1,e,t,n,r):be(e,t,n,r)}function be(e,t,n,r){if(e>>>=0,t>>>=0,n>>>=0,r>>>=0,("undefined"===typeof SharedArrayBuffer?"undefined":_typeof(SharedArrayBuffer))>"u")return T("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return w&&0===i.length?we(e,t,n,r):(e={ob:n,Sa:e,lb:r,ub:i},w?(e.wb="spawnThread",postMessage(e,i),0):re(e))}function xe(e,t,n){return w?ue(3,1,e,t,n):0}function _e(e,t){if(w)return ue(4,1,e,t)}c.invokeEntryPoint=function(e,t){e=me(e)(t),0<ie?fe.eb(e):bt(e)};var Ie=function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t},Ae=function(e,t,n,r){if(!(0<r))return 0;var i=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(n>=r)break;t[n++>>>0]=a}else{if(2047>=a){if(n+1>=r)break;t[n++>>>0]=192|a>>6}else{if(65535>=a){if(n+2>=r)break;t[n++>>>0]=224|a>>12}else{if(n+3>=r)break;t[n++>>>0]=240|a>>18,t[n++>>>0]=128|a>>12&63}t[n++>>>0]=128|a>>6&63}t[n++>>>0]=128|63&a}}return t[n>>>0]=0,n-i},Ce=function(e,t,n){return Ae(e,r(),t,n)};function ke(e,t){if(w)return ue(5,1,e,t)}function Se(e,t,n){if(w)return ue(6,1,e,t,n)}function Te(e,t,n){return w?ue(7,1,e,t,n):0}function Ee(e,t){if(w)return ue(8,1,e,t)}function Oe(e,t,n){if(w)return ue(9,1,e,t,n)}function Pe(e,t,n,r){if(w)return ue(10,1,e,t,n,r)}function Re(e,t,n,r){if(w)return ue(11,1,e,t,n,r)}function Be(e,t,n,r){if(w)return ue(12,1,e,t,n,r)}function De(e){if(w)return ue(13,1,e)}function Me(e,t){if(w)return ue(14,1,e,t)}function Le(e,t,n){if(w)return ue(15,1,e,t,n)}function Fe(e){e>>>=0,"function"==typeof Atomics.vb&&(Atomics.vb(i(),e>>>2,e).value.then(Ne),e+=128,Atomics.store(i(),e>>>2,1))}c.__emscripten_thread_mailbox_await=Fe;var Ne=function(){var e=pt();if(e&&(Fe(e),e=xt,!F))try{if(e(),!(0<ie))try{w?bt(P):le(P)}catch(e){e instanceof te||"unwind"==e||y(1,e)}}catch(e){e instanceof te||"unwind"==e||y(1,e)}};c.checkMailbox=Ne;var Ue=[],je=function(e){return e%4==0&&(e%100!=0||e%400==0)},Ge=[0,31,60,91,121,152,182,213,244,274,305,335],ze=[0,31,59,90,120,151,181,212,243,273,304,334];function He(e,t,n,r,i,o,a,s){return w?ue(16,1,e,t,n,r,i,o,a,s):-52}function Ve(e,t,n,r,i,o,a){if(w)return ue(17,1,e,t,n,r,i,o,a)}var We,$e=function(e){var t=Ie(e)+1,n=yt(t);return n&&Ce(e,n,t),n},Ye=[],Ke={},Xe=function(){if(!We){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"===typeof navigator?"undefined":_typeof(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(e in Ke)void 0===Ke[e]?delete t[e]:t[e]=Ke[e];var n=[];for(e in t)n.push("".concat(e,"=").concat(t[e]));We=n}return We};function Ze(e,t){if(w)return ue(18,1,e,t);e>>>=0,t>>>=0;var r=0;return Xe().forEach((function(i,a){var s=t+r;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)n()[a++>>>0>>>0]=i.charCodeAt(s);n()[a>>>0>>>0]=0,r+=i.length+1})),0}function qe(e,t){if(w)return ue(19,1,e,t);e>>>=0,t>>>=0;var n=Xe();o()[e>>>2>>>0]=n.length;var r=0;return n.forEach((function(e){return r+=e.length+1})),o()[t>>>2>>>0]=r,0}function Je(e){return w?ue(20,1,e):52}function Qe(e,t,n,r){return w?ue(21,1,e,t,n,r):52}function et(e,t,n,r,i){return w?ue(22,1,e,t,n,r,i):70}var tt=[null,[],[]];function nt(e,t,n,i){if(w)return ue(23,1,e,t,n,i);t>>>=0,n>>>=0,i>>>=0;for(var a=0,s=0;s<n;s++){var u=o()[t>>>2>>>0],c=o()[t+4>>>2>>>0];t+=8;for(var l=0;l<c;l++){var h=r()[u+l>>>0],f=tt[e];0===h||10===h?((1===e?S:T)(ae(f,0)),f.length=0):f.push(h)}a+=c}return o()[i>>>2>>>0]=a,0}var rt=function(e){return(rt=function(){if("object"==("undefined"===typeof crypto?"undefined":_typeof(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e};if(v)try{var e=Ka("crypto");if(e.randomFillSync)return function(t){return e.randomFillSync(t)};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e}}catch(n){}Y("initRandomDevice")}())(e)},it=[31,29,31,30,31,30,31,31,30,31,30,31],ot=[31,28,31,30,31,30,31,31,30,31,30,31];function at(e,t,r,a){function s(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function u(e,t){return s(e,t,"0")}function c(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function l(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function h(e){var t=e.Va;for(e=new Date(new Date(e.Wa+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(je(e.getFullYear())?it:ot)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=l(new Date(e.getFullYear(),0,4)),n=l(n),0>=c(t,e)?0>=c(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0,a>>>=0;var f=o()[a+40>>>2>>>0];for(var d in a={sb:i()[a>>>2>>>0],rb:i()[a+4>>>2>>>0],Xa:i()[a+8>>>2>>>0],ab:i()[a+12>>>2>>>0],Ya:i()[a+16>>>2>>>0],Wa:i()[a+20>>>2>>>0],Ra:i()[a+24>>>2>>>0],Va:i()[a+28>>>2>>>0],yb:i()[a+32>>>2>>>0],qb:i()[a+36>>>2>>>0],tb:f?se(f):""},r=se(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(d,"g"),f[d]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(d in f={"%a":function(e){return p[e.Ra].substring(0,3)},"%A":function(e){return p[e.Ra]},"%b":function(e){return y[e.Ya].substring(0,3)},"%B":function(e){return y[e.Ya]},"%C":function(e){return u((e.Wa+1900)/100|0,2)},"%d":function(e){return u(e.ab,2)},"%e":function(e){return s(e.ab,2," ")},"%g":function(e){return h(e).toString().substring(2)},"%G":function(e){return h(e)},"%H":function(e){return u(e.Xa,2)},"%I":function(e){return 0==(e=e.Xa)?e=12:12<e&&(e-=12),u(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.Ya-1;t+=(je(e.Wa+1900)?it:ot)[n++]);return u(e.ab+t,3)},"%m":function(e){return u(e.Ya+1,2)},"%M":function(e){return u(e.rb,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.Xa&&12>e.Xa?"AM":"PM"},"%S":function(e){return u(e.sb,2)},"%t":function(){return"\t"},"%u":function(e){return e.Ra||7},"%U":function(e){return u(Math.floor((e.Va+7-e.Ra)/7),2)},"%V":function(e){var t=Math.floor((e.Va+7-(e.Ra+6)%7)/7);if(2>=(e.Ra+371-e.Va-2)%7&&t++,t)53==t&&(4==(n=(e.Ra+371-e.Va)%7)||3==n&&je(e.Wa)||(t=1));else{t=52;var n=(e.Ra+7-e.Va-1)%7;(4==n||5==n&&je(e.Wa%400-1))&&t++}return u(t,2)},"%w":function(e){return e.Ra},"%W":function(e){return u(Math.floor((e.Va+7-(e.Ra+6)%7)/7),2)},"%y":function(e){return(e.Wa+1900).toString().substring(2)},"%Y":function(e){return e.Wa+1900},"%z":function(e){return(0<=(e=e.qb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4)},"%Z":function(e){return e.tb},"%%":function(){return"%"}},r=r.replace(/%%/g,"\0\0"),f)r.includes(d)&&(r=r.replace(new RegExp(d,"g"),f[d](a)));return d=function(e){var t=Array(Ie(e)+1);return Ae(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),d.length>t?0:(function(e,t){n().set(e,t>>>0)}(d,e),d.length-1)}var st,ut=[],ct=function(e,t){if(!st){st=new WeakMap;var n=ye.length;if(st)for(var r=0;r<0+n;r++){var i=me(r);i&&st.set(i,r)}}if(n=st.get(e)||0)return n;if(ut.length)n=ut.pop();else{try{ye.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}n=ye.length-1}try{r=n,ye.set(r,e),ge[r]=ye.get(r)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){r=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]},a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new r(o,e)}else{for(r=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},r.push(96),128>(a=t.length)?r.push(a):r.push(a%128|128,a>>7),a=0;a<t.length;++a)r.push(o[t[a]]);"v"==i?r.push(0):r.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=r.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,r),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}r=n,ye.set(r,t),ge[r]=ye.get(r)}return st.set(e,n),n};fe.$a();var lt=[ce,pe,we,xe,_e,ke,Se,Te,Ee,Oe,Pe,Re,Be,De,Me,Le,He,Ve,Ze,qe,Je,Qe,et,nt],ht={b:function(e,t,n){throw new ve(e>>>=0).$a(t>>>0,n>>>0),e},O:function(e){gt(e>>>0,!m,1,!g,131072,!1),fe.fb()},m:function(e){e>>>=0,w?postMessage({cmd:"cleanupThread",thread:e}):fe.cb(fe.Qa[e])},J:be,h:xe,U:_e,F:ke,H:Se,y:Te,S:Ee,L:Oe,R:Pe,o:Re,G:Be,D:De,T:Me,E:Le,p:function(){return 1},B:function(e,t){(e>>>=0)==t>>>0?setTimeout((function(){return Ne()})):w?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=fe.Qa[e])&&e.postMessage({cmd:"checkMailbox"})},K:function(e,t,n,r){t>>>=0,Ue.length=n,r=r>>>0>>>3;for(var i=0;i<n;i++)Ue[i]=a()[r+i>>>0];return e=0>e?ee[-e-1]:lt[e],fe.mb=t,t=e.apply(null,Ue),fe.mb=0,t},M:Fe,W:function(e){v&&fe.Qa[e>>>0].ref()},s:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),i()[n>>>2>>>0]=e.getUTCSeconds(),i()[n+4>>>2>>>0]=e.getUTCMinutes(),i()[n+8>>>2>>>0]=e.getUTCHours(),i()[n+12>>>2>>>0]=e.getUTCDate(),i()[n+16>>>2>>>0]=e.getUTCMonth(),i()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[n+28>>>2>>>0]=e},t:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),i()[n>>>2>>>0]=e.getSeconds(),i()[n+4>>>2>>>0]=e.getMinutes(),i()[n+8>>>2>>>0]=e.getHours(),i()[n+12>>>2>>>0]=e.getDate(),i()[n+16>>>2>>>0]=e.getMonth(),i()[n+20>>>2>>>0]=e.getFullYear()-1900,i()[n+24>>>2>>>0]=e.getDay(),t=(je(e.getFullYear())?Ge:ze)[e.getMonth()]+e.getDate()-1|0,i()[n+28>>>2>>>0]=t,i()[n+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var r=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=r&&e.getTimezoneOffset()==Math.min(r,t)),i()[n+32>>>2>>>0]=e},u:function(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),n=i()[e+32>>>2>>>0],r=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>n?i()[e+32>>>2>>>0]=+(o!=a&&s==r):0<n!=(s==r)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<n?s:o)-r))),i()[e+24>>>2>>>0]=t.getDay(),n=(je(t.getFullYear())?Ge:ze)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=n,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[dt()>>>2>>>0]=61,e=-1):e/=1e3,_t((Q=e,1<=+Math.abs(Q)?0<Q?+Math.floor(Q/4294967296)>>>0:~~+Math.ceil((Q-+(~~Q>>>0))/4294967296)>>>0:0)),e>>>0},q:He,r:Ve,A:function(e,t,n){function r(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}e>>>=0,t>>>=0,n>>>=0;var a=(new Date).getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var c=u.getTimezoneOffset(),l=Math.max(a,c);o()[e>>>2>>>0]=60*l,i()[t>>>2>>>0]=+(a!=c),e=r(s),t=r(u),e=$e(e),t=$e(t),c<a?(o()[n>>>2>>>0]=e,o()[n+4>>>2>>>0]=t):(o()[n>>>2>>>0]=t,o()[n+4>>>2>>>0]=e)},c:function(){Y("")},N:function(e,t,n){e>>>=0,t>>>=0,n>>>=0,Ye.length=0;for(var s;s=r()[t++>>>0];){var u=105!=s;n+=(u&=112!=s)&&n%8?4:0,Ye.push(112==s?o()[n>>>2>>>0]:105==s?i()[n>>>2>>>0]:a()[n>>>3>>>0]),n+=u?8:4}return ee[e].apply(null,Ye)},n:function(){},i:function(){return Date.now()},V:function(){throw ie+=1,"unwind"},C:function(){return 4294901760},e:function(){return performance.timeOrigin+performance.now()},f:function(){return v?(Np(),fr(kp)).cpus().length:navigator.hardwareConcurrency},z:function(e){e>>>=0;var t=r().length;if(e<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var i=t*(1+.2/n);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-E.buffer.byteLength+65535)/65536;try{E.grow(o),N();var a=1;break e}catch(s){}a=void 0}if(a)return!0}return!1},P:Ze,Q:qe,I:le,g:Je,l:Qe,v:et,k:nt,w:function(e,t){return e>>>=0,t>>>=0,rt(r().subarray(e>>>0,e+t>>>0)),0},a:E||c.wasmMemory,x:at,d:function(e,t,n,r){return at(e>>>0,t>>>0,n>>>0,r>>>0)},j:function(e,t,n,i){var o=ye.length;e=new Uint8Array(r().slice(e+t,e+n));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:E}});for(a in u.exports)ct(u.exports[a]);return o<ye.length?o:i}catch(e){return console.log(e),i}}},ft=function(){function e(e,t){return ft=e.exports,ft=function(){var e=ft,t=function(e){return function(){return e()>>>0}},n=function(e){return function(t){return e(t)>>>0}};return(e=Object.assign({},e)).za=t(e.za),e.Aa=t(e.Aa),e.Ba=n(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=n(e.Pa),e}(),fe.gb.push(ft.Da),ye=ft.Ea,G.unshift(ft.X),O=t,$(),ft}var t={a:ht};if(H++,c.instantiateWasm)try{return c.instantiateWasm(t,e)}catch(e){T("Module.instantiateWasm callback failed with error: ".concat(e)),u(e)}return function(e,t){var n=K;return"function"!=typeof WebAssembly.instantiateStreaming||X(n)||Z(n)||v||"function"!=typeof fetch?J(n,e,t):fetch(n,{credentials:"same-origin"}).then((function(r){return WebAssembly.instantiateStreaming(r,e).then(t,(function(r){return T("wasm streaming compile failed: ".concat(r)),T("falling back to ArrayBuffer instantiation"),J(n,e,t)}))}))}(t,(function(t){e(t.instance,t.module)})).catch(u),{}}();c._OrtInit=function(e,t){return(c._OrtInit=ft.Y)(e,t)},c._OrtGetLastError=function(e,t){return(c._OrtGetLastError=ft.Z)(e,t)},c._OrtCreateSessionOptions=function(e,t,n,r,i,o,a,s,u,l){return(c._OrtCreateSessionOptions=ft._)(e,t,n,r,i,o,a,s,u,l)},c._OrtAppendExecutionProvider=function(e,t){return(c._OrtAppendExecutionProvider=ft.$)(e,t)},c._OrtAddFreeDimensionOverride=function(e,t,n){return(c._OrtAddFreeDimensionOverride=ft.aa)(e,t,n)},c._OrtAddSessionConfigEntry=function(e,t,n){return(c._OrtAddSessionConfigEntry=ft.ba)(e,t,n)},c._OrtReleaseSessionOptions=function(e){return(c._OrtReleaseSessionOptions=ft.ca)(e)},c._OrtCreateSession=function(e,t,n){return(c._OrtCreateSession=ft.da)(e,t,n)},c._OrtReleaseSession=function(e){return(c._OrtReleaseSession=ft.ea)(e)},c._OrtGetInputOutputCount=function(e,t,n){return(c._OrtGetInputOutputCount=ft.fa)(e,t,n)},c._OrtGetInputName=function(e,t){return(c._OrtGetInputName=ft.ga)(e,t)},c._OrtGetOutputName=function(e,t){return(c._OrtGetOutputName=ft.ha)(e,t)},c._OrtFree=function(e){return(c._OrtFree=ft.ia)(e)},c._OrtCreateTensor=function(e,t,n,r,i,o){return(c._OrtCreateTensor=ft.ja)(e,t,n,r,i,o)},c._OrtGetTensorData=function(e,t,n,r,i){return(c._OrtGetTensorData=ft.ka)(e,t,n,r,i)},c._OrtReleaseTensor=function(e){return(c._OrtReleaseTensor=ft.la)(e)},c._OrtCreateRunOptions=function(e,t,n,r){return(c._OrtCreateRunOptions=ft.ma)(e,t,n,r)},c._OrtAddRunConfigEntry=function(e,t,n){return(c._OrtAddRunConfigEntry=ft.na)(e,t,n)},c._OrtReleaseRunOptions=function(e){return(c._OrtReleaseRunOptions=ft.oa)(e)},c._OrtCreateBinding=function(e){return(c._OrtCreateBinding=ft.pa)(e)},c._OrtBindInput=function(e,t,n){return(c._OrtBindInput=ft.qa)(e,t,n)},c._OrtBindOutput=function(e,t,n,r){return(c._OrtBindOutput=ft.ra)(e,t,n,r)},c._OrtClearBoundOutputs=function(e){return(c._OrtClearBoundOutputs=ft.sa)(e)},c._OrtReleaseBinding=function(e){return(c._OrtReleaseBinding=ft.ta)(e)},c._OrtRunWithBinding=function(e,t,n,r,i){return(c._OrtRunWithBinding=ft.ua)(e,t,n,r,i)},c._OrtRun=function(e,t,n,r,i,o,a,s){return(c._OrtRun=ft.va)(e,t,n,r,i,o,a,s)},c._OrtEndProfiling=function(e){return(c._OrtEndProfiling=ft.wa)(e)},c._OrtConfigure=function(e,t){return(c._OrtConfigure=ft.xa)(e,t)},c._OrtAuth=function(e,t){return(c._OrtAuth=ft.ya)(e,t)};var dt=function(){return(dt=ft.za)()},pt=c._pthread_self=function(){return(pt=c._pthread_self=ft.Aa)()},yt=c._malloc=function(e){return(yt=c._malloc=ft.Ba)(e)};c._free=function(e){return(c._free=ft.Ca)(e)},c.__emscripten_tls_init=function(){return(c.__emscripten_tls_init=ft.Da)()};var gt=c.__emscripten_thread_init=function(e,t,n,r,i,o){return(gt=c.__emscripten_thread_init=ft.Fa)(e,t,n,r,i,o)};c.__emscripten_thread_crashed=function(){return(c.__emscripten_thread_crashed=ft.Ga)()};var mt,vt=function(e,t,n,r){return(vt=ft.Ha)(e,t,n,r)},wt=function(e){return(wt=ft.Ia)(e)},bt=c.__emscripten_thread_exit=function(e){return(bt=c.__emscripten_thread_exit=ft.Ja)(e)},xt=function(){return(xt=ft.Ka)()},_t=function(e){return(_t=ft.La)(e)},It=function(e,t){return(It=ft.Ma)(e,t)},At=function(){return(At=ft.Na)()},Ct=function(e){return(Ct=ft.Oa)(e)},kt=function(e){return(kt=ft.Pa)(e)};function St(){if(!(0<H))if(w)s(c),w||de(G),startWorker(c);else{if(c.preRun)for("function"==typeof c.preRun&&(c.preRun=[c.preRun]);c.preRun.length;)j.unshift(c.preRun.shift());de(j),0<H||mt||(mt=!0,c.calledRun=!0,F||(w||de(G),s(c),w||de(z)))}}return c.___start_em_js=887001,c.___stop_em_js=887613,c.wasmMemory=E,c.stackAlloc=kt,c.stackSave=At,c.stackRestore=Ct,c.keepRuntimeAlive=function(){return 0<ie},c.addFunction=ct,c.UTF8ToString=se,c.stringToUTF8=Ce,c.lengthBytesUTF8=Ie,c.ExitStatus=te,c.PThread=fe,W=function e(){mt||St(),mt||(W=e)},St(),t.ready}}();"object"==_typeof(e)&&"object"==_typeof(t)?t.exports=n:void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return n}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__=[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)})),Up=ye((function(e,t){t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n'})),Wp,bg,ca,pa,Bo,zp,gg,yg,Tg,Vp,Oe,Kr=L((function(){Wp=Cp(),bg=Gp(),pa=!1,Bo=!1,zp=!1,gg=function(e){if(1===e)return!1;if(("undefined"===typeof SharedArrayBuffer?"undefined":_typeof(SharedArrayBuffer))>"u")return("undefined"===typeof self?"undefined":_typeof(self))<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;_typeof(process)<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return("undefined"===typeof MessageChannel?"undefined":_typeof(MessageChannel))<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(t){return!1}},yg=function(){try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(e){return!1}},Tg=function(e,t){return e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm"},Vp=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o,a,s,u,c,l,h,f;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!pa){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(!Bo){e.next=4;break}throw new Error("multiple calls to 'initializeWebAssembly()' detected.");case 4:if(!zp){e.next=6;break}throw new Error("previous call to 'initializeWebAssembly()' failed.");case 6:return Bo=!0,n=t.initTimeout,r=t.numThreads,i=t.simd,o=gg(r),a=i&&yg(),s=t.wasmPaths,u="string"==typeof s?s:void 0,c=Tg(a,o),l="object"==_typeof(s)?s[c]:void 0,h=!1,f=[],n>0&&f.push(new Promise((function(e){setTimeout((function(){h=!0,e()}),n)}))),f.push(new Promise((function(e,t){var n=o?bg:Wp,i={locateFile:function(e,t){return o&&e.endsWith(".worker.js")&&("undefined"===typeof Blob?"undefined":_typeof(Blob))<"u"?URL.createObjectURL(new Blob([Up()],{type:"text/javascript"})):e.endsWith(".wasm")?l||(null!==u&&void 0!==u?u:t)+c:t+e}};if(o)if(i.numThreads=r,("undefined"===typeof Blob?"undefined":_typeof(Blob))>"u")i.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{var a="var ortWasmThreaded=".concat(n.toString(),";");i.mainScriptUrlOrBlob=new Blob([a],{type:"text/javascript"})}n(i).then((function(t){Bo=!1,pa=!0,ca=t,e()}),(function(e){Bo=!1,zp=!0,t(e)}))}))),e.next=12,Promise.race(f);case 12:if(!h){e.next=14;break}throw new Error("WebAssembly backend initializing failed due to timeout: ".concat(n,"ms"));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){if(pa&&ca)return ca;throw new Error("WebAssembly is not initialized yet.")}})),Fe,_vn,Se,ko=L((function(){Kr(),Fe=function(e,t){var n=Oe(),r=n.lengthBytesUTF8(e)+1,i=n._malloc(r);return n.stringToUTF8(e,i,r),t.push(i),i},_vn=function(e,t,n,r){if("object"==_typeof(e)&&null!==e){if(n.has(e))throw new Error("Circular reference in options");n.add(e)}Object.entries(e).forEach((function(e){var i=_slicedToArray(e,2),o=i[0],a=i[1],s=t?t+o:o;if("object"==_typeof(a))_vn(a,s+".",n,r);else if("string"==typeof a||"number"==typeof a)r(s,a.toString());else{if("boolean"!=typeof a)throw new Error("Can't handle extra config type: "+_typeof(a));r(s,a?"1":"0")}}))},Se=function(e){var t=Oe(),n=t.stackSave();try{var r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);var i=t.HEAP32[r/4],o=t.HEAPU32[r/4+1],a=o?t.UTF8ToString(o):"";throw new Error("".concat(e," ERROR_CODE: ").concat(i,", ERROR_MESSAGE: ").concat(a))}finally{t.stackRestore(n)}}})),Hp,jp=L((function(){Kr(),ko(),Hp=function(e){var t=Oe(),n=0,r=[],i=e||{};try{if(void 0===(null===e||void 0===e?void 0:e.logSeverityLevel))i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error("log serverity level is not valid: ".concat(e.logSeverityLevel));if(void 0===(null===e||void 0===e?void 0:e.logVerbosityLevel))i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error("log verbosity level is not valid: ".concat(e.logVerbosityLevel));void 0===(null===e||void 0===e?void 0:e.terminate)&&(i.terminate=!1);var o=0;return void 0!==(null===e||void 0===e?void 0:e.tag)&&(o=Fe(e.tag,r)),0===(n=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o))&&Se("Can't create run options."),void 0!==(null===e||void 0===e?void 0:e.extra)&&_vn(e.extra,"",new WeakSet,(function(e,i){var o=Fe(e,r),a=Fe(i,r);0!==t._OrtAddRunConfigEntry(n,o,a)&&Se("Can't set a run config entry: ".concat(e," - ").concat(i,"."))})),[n,r]}catch(e){throw 0!==n&&t._OrtReleaseRunOptions(n),r.forEach((function(e){return t._free(e)})),e}}})),xg,wg,vg,_g,qp,Yp=L((function(){Kr(),ko(),xg=function(e){switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error("unsupported graph optimization level: ".concat(e))}},wg=function(e){switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error("unsupported execution mode: ".concat(e))}},vg=function(e){e.extra||(e.extra={}),e.extra.session||(e.extra.session={});var t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((function(e){return"webgpu"===("string"==typeof e?e:e.name)}))&&(e.enableMemPattern=!1)},_g=function(e,t,n){var r,i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a="string"==typeof o?o:o.name;switch(a){case"webnn":if(a="WEBNN","string"!=typeof o){var s=o;if(null!==s&&void 0!==s&&s.deviceType){var u=Fe("deviceType",n),c=Fe(s.deviceType,n);0!==Oe()._OrtAddSessionConfigEntry(e,u,c)&&Se("Can't set a session config entry: 'deviceType' - ".concat(s.deviceType,"."))}if(null!==s&&void 0!==s&&s.numThreads){var l=s.numThreads;("number"!=typeof l||!Number.isInteger(l)||l<0)&&(l=0);var h=Fe("numThreads",n),f=Fe(l.toString(),n);0!==Oe()._OrtAddSessionConfigEntry(e,h,f)&&Se("Can't set a session config entry: 'numThreads' - ".concat(s.numThreads,"."))}if(null!==s&&void 0!==s&&s.powerPreference){var d=Fe("powerPreference",n),p=Fe(s.powerPreference,n);0!==Oe()._OrtAddSessionConfigEntry(e,d,p)&&Se("Can't set a session config entry: 'powerPreference' - ".concat(s.powerPreference,"."))}}break;case"webgpu":if(a="JS","string"!=typeof o){var y=o;if(null!==y&&void 0!==y&&y.preferredLayout){if("NCHW"!==y.preferredLayout&&"NHWC"!==y.preferredLayout)throw new Error("preferredLayout must be either 'NCHW' or 'NHWC': ".concat(y.preferredLayout));var g=Fe("preferredLayout",n),m=Fe(y.preferredLayout,n);0!==Oe()._OrtAddSessionConfigEntry(e,g,m)&&Se("Can't set a session config entry: 'preferredLayout' - ".concat(y.preferredLayout,"."))}}break;case"wasm":case"cpu":continue;default:throw new Error("not supported execution provider: ".concat(a))}var v=Fe(a,n);0!==Oe()._OrtAppendExecutionProvider(e,v)&&Se("Can't append execution provider: ".concat(a,"."))}}catch(w){i.e(w)}finally{i.f()}},qp=function(e){var t=Oe(),n=0,r=[],i=e||{};vg(i);try{var o,a,s,u,c=xg(null!==(o=i.graphOptimizationLevel)&&void 0!==o?o:"all"),l=wg(null!==(a=i.executionMode)&&void 0!==a?a:"sequential"),h="string"==typeof i.logId?Fe(i.logId,r):0,f=null!==(s=i.logSeverityLevel)&&void 0!==s?s:2;if(!Number.isInteger(f)||f<0||f>4)throw new Error("log serverity level is not valid: ".concat(f));var d=null!==(u=i.logVerbosityLevel)&&void 0!==u?u:0;if(!Number.isInteger(d)||d<0||d>4)throw new Error("log verbosity level is not valid: ".concat(d));var p="string"==typeof i.optimizedModelFilePath?Fe(i.optimizedModelFilePath,r):0;if(0===(n=t._OrtCreateSessionOptions(c,!!i.enableCpuMemArena,!!i.enableMemPattern,l,!!i.enableProfiling,0,h,f,d,p))&&Se("Can't create session options."),i.executionProviders&&_g(n,i.executionProviders,r),i.freeDimensionOverrides)for(var y=0,g=Object.entries(i.freeDimensionOverrides);y<g.length;y++){var m=_slicedToArray(g[y],2),v=m[0],w=m[1];if("string"!=typeof v)throw new Error("free dimension override name must be a string: ".concat(v));if("number"!=typeof w||!Number.isInteger(w)||w<0)throw new Error("free dimension override value must be a non-negative integer: ".concat(w));var b=Fe(v,r);0!==t._OrtAddFreeDimensionOverride(n,b,w)&&Se("Can't set a free dimension override: ".concat(v," - ").concat(w,"."))}return void 0!==i.extra&&_vn(i.extra,"",new WeakSet,(function(e,i){var o=Fe(e,r),a=Fe(i,r);0!==t._OrtAddSessionConfigEntry(n,o,a)&&Se("Can't set a session config entry: ".concat(e," - ").concat(i,"."))})),[n,r]}catch(e){throw 0!==n&&t._OrtReleaseSessionOptions(n),r.forEach((function(e){return t._free(e)})),e}}})),da,Xp,ha,Kp,Jp,No,Zp,ma=L((function(){da=function(e){switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error("unsupported data type: ".concat(e))}},Xp=function(e){switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error("unsupported data type: ".concat(e))}},ha=function(e){return[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e]},Kp=function(e){switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error("unsupported type: ".concat(e))}},Jp=function(e){switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error("unsupported logging level: ".concat(e))}},No=function(e){return"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e},Zp=function(e){switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error("unsupported data location: ".concat(e))}}})),_n,ba=L((function(){_n=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=11;break}if(!(t instanceof Blob)){e.next=9;break}return e.t1=Uint8Array,e.next=5,t.arrayBuffer();case 5:e.t2=e.sent,e.t0=new e.t1(e.t2),e.next=10;break;case 9:e.t0=t instanceof Uint8Array?t:new Uint8Array(t);case 10:return e.abrupt("return",e.t0);case 11:if(_typeof(process)<"u"&&process.versions&&process.versions.node){e.next=50;break}return e.next=14,fetch(t);case 14:if((n=e.sent).ok){e.next=17;break}throw new Error("failed to load external data file: ".concat(t));case 17:if(r=n.headers.get("Content-Length"),!((i=r?parseInt(r,10):0)<1073741824)){e.next=24;break}return e.t3=Uint8Array,e.next=22,n.arrayBuffer();case 22:return e.t4=e.sent,e.abrupt("return",new e.t3(e.t4));case 24:if(n.body){e.next=26;break}throw new Error("failed to load external data file: ".concat(t,", no response body."));case 26:a=n.body.getReader(),e.prev=27,o=new ArrayBuffer(i),e.next=37;break;case 31:if(e.prev=31,e.t5=e.catch(27),e.t5 instanceof RangeError){e.next=35;break}throw e.t5;case 35:s=Math.ceil(i/65536),o=new WebAssembly.Memory({initial:s,maximum:s}).buffer;case 37:u=0;case 38:return e.next=40,a.read();case 40:if(c=e.sent,l=c.done,h=c.value,!l){e.next=45;break}return e.abrupt("break",49);case 45:f=h.byteLength,new Uint8Array(o,u,f).set(h),u+=f;case 47:e.next=38;break;case 49:return e.abrupt("return",new Uint8Array(o,0,i));case 50:return e.prev=50,e.t6=Uint8Array,e.next=54,(void 0)(t);case 54:return e.t7=e.sent,e.abrupt("return",new e.t6(e.t7));case 58:if(e.prev=58,e.t8=e.catch(50),"ERR_FS_FILE_TOO_LARGE"!==e.t8.code){e.next=91;break}d=(void 0)(t),p=[],y=!1,g=!1,e.prev=64,v=_asyncIterator(d);case 66:return e.next=68,v.next();case 68:if(!(y=!(w=e.sent).done)){e.next=74;break}b=w.value,p.push(b);case 71:y=!1,e.next=66;break;case 74:e.next=80;break;case 76:e.prev=76,e.t9=e.catch(64),g=!0,m=e.t9;case 80:if(e.prev=80,e.prev=81,!y||null==v.return){e.next=85;break}return e.next=85,v.return();case 85:if(e.prev=85,!g){e.next=88;break}throw m;case 88:return e.finish(85);case 89:return e.finish(80);case 90:return e.abrupt("return",new Uint8Array(Buffer.concat(p)));case 91:throw e.t8;case 92:case"end":return e.stop()}}),e,null,[[27,31],[50,58],[64,76,80,90],[81,,85,89]])})));return function(t){return e.apply(this,arguments)}}()})),Og,ed,td,On,Ig,ga,rd,nd,Qp,od,id,ad,sd,ud,ld=L((function(){jp(),Yp(),ma(),Kr(),ko(),ba(),Og=function(e,t){0!==Oe()._OrtInit(e,t)&&Se("Can't initialize onnxruntime.")},ed=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Og(t.wasm.numThreads,Jp(t.logLevel));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),td=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),On=new Map,Ig=function(e){var t=Oe(),n=t.stackSave();try{var r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&Se("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(n)}},ga=function(e){var t=Oe(),n=t._malloc(e.byteLength);if(0===n)throw new Error("Can't create a session. failed to allocate a buffer of size ".concat(e.byteLength,"."));return t.HEAPU8.set(e,n),[n,e.byteLength]},rd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_,I,A,C,k,S,T,E,O,P,R;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Oe(),Array.isArray(t)?(r=_slicedToArray(t,2),s=r[0],u=r[1]):t.buffer===c.HEAPU8.buffer?(i=[t.byteOffset,t.byteLength],s=i[0],u=i[1]):(o=ga(t),a=_slicedToArray(o,2),s=a[0],u=a[1]),l=0,h=0,f=[],d=[],p=[],e.prev=3,y=qp(n),g=_slicedToArray(y,2),h=g[0],f=g[1],null===n||void 0===n||!n.externalData||!c.mountExternalData){e.next=24;break}m=[],v=_createForOfIteratorHelper(n.externalData),e.prev=7,b=_regeneratorRuntime().mark((function e(){var t,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=w.value,n="string"==typeof t?t:t.path,m.push(_n("string"==typeof t?t:t.data).then((function(e){c.mountExternalData(n,e)})));case 3:case"end":return e.stop()}}),e)})),v.s();case 10:if((w=v.n()).done){e.next=14;break}return e.delegateYield(b(),"t0",12);case 12:e.next=10;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(7),v.e(e.t1);case 19:return e.prev=19,v.f(),e.finish(19);case 22:return e.next=24,Promise.all(m);case 24:for(0===(l=c._OrtCreateSession(s,u,h))&&Se("Can't create a session."),x=Ig(l),_=_slicedToArray(x,2),I=_[0],A=_[1],C=[],k=[],S=0;S<I;S++)0===(T=c._OrtGetInputName(l,S))&&Se("Can't get an input name."),d.push(T),C.push(c.UTF8ToString(T));for(E=0;E<A;E++)0===(O=c._OrtGetOutputName(l,E))&&Se("Can't get an output name."),p.push(O),P=c.UTF8ToString(O),k.push(P);return e.abrupt("return",(On.set(l,[l,d,p,null]),[l,C,k]));case 32:throw e.prev=32,e.t2=e.catch(3),d.forEach((function(e){return c._OrtFree(e)})),p.forEach((function(e){return c._OrtFree(e)})),0!==l&&c._OrtReleaseSession(l),e.t2;case 35:return e.prev=35,c._free(s),0!==h&&c._OrtReleaseSessionOptions(h),f.forEach((function(e){return c._free(e)})),null===(R=c.unmountExternalData)||void 0===R||R.call(c),e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[3,32,35,38],[7,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}(),nd=function(e){var t,n=Oe(),r=On.get(e);if(!r)throw new Error("cannot release session. invalid session id: ".concat(e));var i=_slicedToArray(r,4),o=i[0],a=i[1],s=i[2],u=i[3];u&&n._OrtReleaseBinding(u.handle),null!==(t=n.jsepUnregisterBuffers)&&void 0!==t&&t.call(n,e),a.forEach((function(e){return n._OrtFree(e)})),s.forEach((function(e){return n._OrtFree(e)})),n._OrtReleaseSession(o),On.delete(e)},Qp=function(e,t,n,r,i){if(e){var o,a,s=Oe(),u=e[0],c=e[1],l=e[3];if("string"===u&&"gpu-buffer"===l)throw new Error("String tensor is not supported on GPU.");if("gpu-buffer"===l){var h=e[2].gpuBuffer,f=ha(da(u));a=c.reduce((function(e,t){return e*t}),1)*f,o=s.jsepRegisterBuffer(r,i,h,a)}else{var d=e[2];if(Array.isArray(d)){a=4*d.length,o=s._malloc(a),n.push(o);for(var p=o/4,y=0;y<d.length;y++){if("string"!=typeof d[y])throw new TypeError("tensor data at index ".concat(y," is not a string"));s.HEAPU32[p++]=Fe(d[y],n)}}else a=d.byteLength,o=s._malloc(a),n.push(o),s.HEAPU8.set(new Uint8Array(d.buffer,d.byteOffset,a),o)}var g=s.stackSave(),m=s.stackAlloc(4*c.length);try{var v=m/4;c.forEach((function(e){return s.HEAP32[v++]=e}));var w=s._OrtCreateTensor(da(u),o,a,m,c.length,Zp(l));0===w&&Se("Can't create tensor for input/output. session=".concat(r,", index=").concat(i,".")),t.push(w)}finally{s.stackRestore(g)}}else t.push(0)},od=function(e){var t=(new TextEncoder).encode(e),n=Oe(),r=n._malloc(t.byteLength);n.HEAPU8.set(t,r);var i=n._OrtConfigure(r,t.byteLength);if(0===i)throw new Error("Can't get an configure key");var o=n.UTF8ToString(i);return n._OrtFree(i),o},id=function(e){var t=(new TextEncoder).encode(e),n=Oe(),r=n._malloc(t.byteLength);n.HEAPU8.set(t,r);var i=n._OrtAuth(r,t.byteLength);if(0===i)throw new Error("Can't get an auth result");var o=n.UTF8ToString(i);return n._OrtFree(i),o},ad=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i,o,a){var s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_,I,A,C,k,S,T,E,O,P,R,B,D,M,L,F,N;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=Oe(),u=On.get(t)){e.next=3;break}throw new Error("cannot run inference. invalid session id: ".concat(t));case 3:for(c=_slicedToArray(u,4),l=c[0],h=c[1],f=c[2],d=c[3],p=n.length,y=i.length,g=0,m=[],v=[],w=[],b=[],x=s.stackSave(),_=s.stackAlloc(4*p),I=s.stackAlloc(4*p),A=s.stackAlloc(4*y),C=s.stackAlloc(4*y),e.prev=4,k=Hp(a),S=_slicedToArray(k,2),g=S[0],m=S[1],T=0;T<p;T++)Qp(r[T],v,b,t,n[T]);for(E=0;E<y;E++)Qp(o[E],w,b,t,p+i[E]);for(O=_/4,P=I/4,R=A/4,B=C/4,D=0;D<p;D++)s.HEAPU32[O++]=v[D],s.HEAPU32[P++]=h[n[D]];for(M=0;M<y;M++)s.HEAPU32[R++]=w[M],s.HEAPU32[B++]=f[i[M]];return e.next=16,s._OrtRun(l,I,_,p,C,y,A,g);case 16:0!==e.sent&&Se("failed to call OrtRun()."),L=[],F=_regeneratorRuntime().mark((function e(){var t,n,r,a,u,c,l,h,f,p,y,g,m,v,b,x,_,I,C,k,S,T;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=s.HEAPU32[A/4+N])!==w[N]){e.next=4;break}return L.push(o[N]),e.abrupt("return",1);case 4:for(r=s.stackSave(),a=s.stackAlloc(16),u=!1,c=0,e.prev=5,0!==s._OrtGetTensorData(t,a,a+4,a+8,a+12)&&Se("Can't access output tensor data on index ".concat(N,".")),l=a/4,h=s.HEAPU32[l++],c=s.HEAPU32[l++],f=s.HEAPU32[l++],p=s.HEAPU32[l++],y=[],g=0;g<p;g++)y.push(s.HEAPU32[f/4+g]);if(s._OrtFree(f),m=y.reduce((function(e,t){return e*t}),1),n=Xp(h),v=null===d||void 0===d?void 0:d.outputPreferredLocations[i[N]],"string"!==n){e.next=23;break}if("gpu-buffer"!==v){e.next=18;break}throw new Error("String tensor is not supported on GPU.");case 18:for(b=[],x=c/4,_=0;_<m;_++)I=s.HEAPU32[x++],C=_===m-1?void 0:s.HEAPU32[x]-I,b.push(s.UTF8ToString(I,C));L.push([n,y,b,"cpu"]),e.next=32;break;case 23:if(!("gpu-buffer"===v&&m>0)){e.next=30;break}if(k=s.jsepGetBuffer(c),void 0!==(S=ha(h))&&No(n)){e.next=27;break}throw new Error("Unsupported data type: ".concat(n));case 27:u=!0,L.push([n,y,{gpuBuffer:k,download:s.jsepCreateDownloader(k,m*S,n),dispose:function(){s._OrtReleaseTensor(t)}},"gpu-buffer"]),e.next=32;break;case 30:T=new(Kp(n))(m),new Uint8Array(T.buffer,T.byteOffset,T.byteLength).set(s.HEAPU8.subarray(c,c+T.byteLength)),L.push([n,y,T,"cpu"]);case 32:return e.prev=32,s.stackRestore(r),"string"===n&&c&&s._free(c),u||s._OrtReleaseTensor(t),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[5,,32,35]])})),N=0;case 21:if(!(N<y)){e.next=28;break}return e.delegateYield(F(),"t0",23);case 23:if(!e.t0){e.next=25;break}return e.abrupt("continue",25);case 25:N++,e.next=21;break;case 28:return e.abrupt("return",(d&&s._OrtClearBoundOutputs(d.handle),L));case 29:return e.prev=29,s.stackRestore(x),v.forEach((function(e){return s._OrtReleaseTensor(e)})),w.forEach((function(e){return s._OrtReleaseTensor(e)})),b.forEach((function(e){return s._free(e)})),0!==g&&s._OrtReleaseRunOptions(g),m.forEach((function(e){return s._free(e)})),e.finish(29);case 32:case"end":return e.stop()}}),e,null,[[4,,29,32]])})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}(),sd=function(e){var t=Oe(),n=On.get(e);if(!n)throw new Error("invalid session id");var r=n[0],i=t._OrtEndProfiling(r);0===i&&Se("Can't get an profile file name."),t._OrtFree(i)},ud=function(e){var t,n=[],r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var i=t.value[2];!Array.isArray(i)&&"buffer"in i&&n.push(i.buffer)}}catch(o){r.e(o)}finally{r.f()}return n}})),fd=ye((function(e,t){t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var xt=Object.defineProperty;var an=Object.getOwnPropertyDescriptor;var on=Object.getOwnPropertyNames;var sn=Object.prototype.hasOwnProperty;var yr=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(d,o)=>(typeof require<"u"?require:d)[o]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw Error(\'Dynamic require of "\'+i+\'" is not supported\')});var Ct=(i,d)=>()=>(i&&(d=i(i=0)),d);var st=(i,d)=>()=>(d||i((d={exports:{}}).exports,d),d.exports),Dt=(i,d)=>{for(var o in d)xt(i,o,{get:d[o],enumerable:!0})},un=(i,d,o,g)=>{if(d&&typeof d=="object"||typeof d=="function")for(let l of on(d))!sn.call(i,l)&&l!==o&&xt(i,l,{get:()=>d[l],enumerable:!(g=an(d,l))||g.enumerable});return i};var it=i=>un(xt({},"__esModule",{value:!0}),i);var Ft={};Dt(Ft,{createReadStream:()=>wr,readFile:()=>fn,readFileSync:()=>ln});var fn,ln,wr,Ut=Ct(()=>{fn=void 0,ln=void 0,wr=void 0});var Rt={};Dt(Rt,{join:()=>cn});var cn,Lt=Ct(()=>{cn=void 0});var vr=st((Or,Pt)=>{"use strict";var br=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){var o=d,g,l;o.ready=new Promise((r,a)=>{g=r,l=a});var b=Object.assign({},o),y="./this.program",f=typeof window=="object",M=typeof importScripts=="function",D=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",P="",W,U,R;if(D){var N=(Ut(),it(Ft)),I=(Lt(),it(Rt));P=M?I.dirname(P)+"/":__dirname+"/",W=(r,a)=>(r=be(r)?new URL(r):I.normalize(r),N.readFileSync(r,a?void 0:"utf8")),R=r=>(r=W(r,!0),r.buffer||(r=new Uint8Array(r)),r),U=(r,a,s,c=!0)=>{r=be(r)?new URL(r):I.normalize(r),N.readFile(r,c?void 0:"utf8",(O,_)=>{O?s(O):a(c?_.buffer:_)})},!o.thisProgram&&1<process.argv.length&&(y=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),o.inspect=()=>"[Emscripten Module object]"}else(f||M)&&(M?P=self.location.href:typeof document<"u"&&document.currentScript&&(P=document.currentScript.src),i&&(P=i),P.indexOf("blob:")!==0?P=P.substr(0,P.replace(/[?#].*/,"").lastIndexOf("/")+1):P="",W=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.send(null),a.responseText},M&&(R=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),U=(r,a,s)=>{var c=new XMLHttpRequest;c.open("GET",r,!0),c.responseType="arraybuffer",c.onload=()=>{c.status==200||c.status==0&&c.response?a(c.response):s()},c.onerror=s,c.send(null)});var E=console.log.bind(console),F=console.error.bind(console);Object.assign(o,b),b=null,typeof WebAssembly!="object"&&le("no native wasm support detected");var k,we=!1,ue,ee,S,G,fe;function We(){var r=k.buffer;o.HEAP8=ue=new Int8Array(r),o.HEAP16=new Int16Array(r),o.HEAPU8=ee=new Uint8Array(r),o.HEAPU16=new Uint16Array(r),o.HEAP32=S=new Int32Array(r),o.HEAPU32=G=new Uint32Array(r),o.HEAPF32=new Float32Array(r),o.HEAPF64=fe=new Float64Array(r)}var He=[],te=[],V=[],de=0,L=null,re=null;function le(r){throw r="Aborted("+r+")",F(r),we=!0,r=new WebAssembly.RuntimeError(r+". Build with -sASSERTIONS for more info."),l(r),r}var he=r=>r.startsWith("data:application/octet-stream;base64,"),be=r=>r.startsWith("file://"),Q;if(Q="ort-wasm.wasm",!he(Q)){var ce=Q;Q=o.locateFile?o.locateFile(ce,P):P+ce}function Ee(r){if(R)return R(r);throw"both async and sync fetching of the wasm failed"}function Ce(r){if(f||M){if(typeof fetch=="function"&&!be(r))return fetch(r,{credentials:"same-origin"}).then(a=>{if(!a.ok)throw"failed to load wasm binary file at \'"+r+"\'";return a.arrayBuffer()}).catch(()=>Ee(r));if(U)return new Promise((a,s)=>{U(r,c=>a(new Uint8Array(c)),s)})}return Promise.resolve().then(()=>Ee(r))}function De(r,a,s){return Ce(r).then(c=>WebAssembly.instantiate(c,a)).then(c=>c).then(s,c=>{F(`failed to asynchronously prepare wasm: ${c}`),le(c)})}function Pe(r,a){var s=Q;return typeof WebAssembly.instantiateStreaming!="function"||he(s)||be(s)||D||typeof fetch!="function"?De(s,r,a):fetch(s,{credentials:"same-origin"}).then(c=>WebAssembly.instantiateStreaming(c,r).then(a,function(O){return F(`wasm streaming compile failed: ${O}`),F("falling back to ArrayBuffer instantiation"),De(s,r,a)}))}var Me,pe={882112:(r,a,s,c)=>{if(typeof o>"u"||!o.Ga)return 1;if(r=Oe(r>>>0),r.startsWith("./")&&(r=r.substring(2)),r=o.Ga.get(r),!r)return 2;if(a>>>=0,s>>>=0,a+s>r.byteLength)return 3;try{return ee.set(r.subarray(a,a+s),c>>>0>>>0),0}catch{return 4}}};function Se(r){this.Da=r-24,this.Fa=function(a){G[this.Da+4>>>2>>>0]=a},this.Ea=function(a){G[this.Da+8>>>2>>>0]=a},this.La=function(a,s){this.Ma(),this.Fa(a),this.Ea(s)},this.Ma=function(){G[this.Da+16>>>2>>>0]=0}}var Ae=0,ne=0,Z=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Fe=(r,a,s)=>{a>>>=0;var c=a+s;for(s=a;r[s]&&!(s>=c);)++s;if(16<s-a&&r.buffer&&Z)return Z.decode(r.subarray(a,s));for(c="";a<s;){var O=r[a++];if(O&128){var _=r[a++]&63;if((O&224)==192)c+=String.fromCharCode((O&31)<<6|_);else{var A=r[a++]&63;O=(O&240)==224?(O&15)<<12|_<<6|A:(O&7)<<18|_<<12|A<<6|r[a++]&63,65536>O?c+=String.fromCharCode(O):(O-=65536,c+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else c+=String.fromCharCode(O)}return c},Oe=(r,a)=>(r>>>=0)?Fe(ee,r,a):"",Te=r=>{for(var a=0,s=0;s<r.length;++s){var c=r.charCodeAt(s);127>=c?a++:2047>=c?a+=2:55296<=c&&57343>=c?(a+=4,++s):a+=3}return a},ze=(r,a,s,c)=>{if(s>>>=0,!(0<c))return 0;var O=s;c=s+c-1;for(var _=0;_<r.length;++_){var A=r.charCodeAt(_);if(55296<=A&&57343>=A){var $=r.charCodeAt(++_);A=65536+((A&1023)<<10)|$&1023}if(127>=A){if(s>=c)break;a[s++>>>0]=A}else{if(2047>=A){if(s+1>=c)break;a[s++>>>0]=192|A>>6}else{if(65535>=A){if(s+2>=c)break;a[s++>>>0]=224|A>>12}else{if(s+3>=c)break;a[s++>>>0]=240|A>>18,a[s++>>>0]=128|A>>12&63}a[s++>>>0]=128|A>>6&63}a[s++>>>0]=128|A&63}}return a[s>>>0]=0,s-O},Ie=r=>r%4===0&&(r%100!==0||r%400===0),Ze=[0,31,60,91,121,152,182,213,244,274,305,335],lt=[0,31,59,90,120,151,181,212,243,273,304,334],Ue=r=>{var a=Te(r)+1,s=me(a);return s&&ze(r,ee,s,a),s},Ye=[],Be={},Ge=()=>{if(!Ve){var r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"},a;for(a in Be)Be[a]===void 0?delete r[a]:r[a]=Be[a];var s=[];for(a in r)s.push(`${a}=${r[a]}`);Ve=s}return Ve},Ve,Ne=[null,[],[]],ct=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return s=>crypto.getRandomValues(s);if(D)try{var r=yr("crypto");if(r.randomFillSync)return s=>r.randomFillSync(s);var a=r.randomBytes;return s=>(s.set(a(s.byteLength)),s)}catch{}le("initRandomDevice")},Ke=r=>(Ke=ct())(r),ke=[31,29,31,30,31,30,31,31,30,31,30,31],dt=[31,28,31,30,31,30,31,31,30,31,30,31];function z(r){var a=Array(Te(r)+1);return ze(r,a,0,a.length),a}function et(r,a,s,c){function O(p,H,Y){for(p=typeof p=="number"?p.toString():p||"";p.length<H;)p=Y[0]+p;return p}function _(p,H){return O(p,H,"0")}function A(p,H){function Y(Je){return 0>Je?-1:0<Je?1:0}var ve;return(ve=Y(p.getFullYear()-H.getFullYear()))===0&&(ve=Y(p.getMonth()-H.getMonth()))===0&&(ve=Y(p.getDate()-H.getDate())),ve}function $(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function oe(p){var H=p.ya;for(p=new Date(new Date(p.za+1900,0,1).getTime());0<H;){var Y=p.getMonth(),ve=(Ie(p.getFullYear())?ke:dt)[Y];if(H>ve-p.getDate())H-=ve-p.getDate()+1,p.setDate(1),11>Y?p.setMonth(Y+1):(p.setMonth(0),p.setFullYear(p.getFullYear()+1));else{p.setDate(p.getDate()+H);break}}return Y=new Date(p.getFullYear()+1,0,4),H=$(new Date(p.getFullYear(),0,4)),Y=$(Y),0>=A(H,p)?0>=A(Y,p)?p.getFullYear()+1:p.getFullYear():p.getFullYear()-1}r>>>=0,a>>>=0,s>>>=0,c>>>=0;var se=G[c+40>>>2>>>0];c={Ja:S[c>>>2>>>0],Ia:S[c+4>>>2>>>0],Aa:S[c+8>>>2>>>0],Ca:S[c+12>>>2>>>0],Ba:S[c+16>>>2>>>0],za:S[c+20>>>2>>>0],xa:S[c+24>>>2>>>0],ya:S[c+28>>>2>>>0],Na:S[c+32>>>2>>>0],Ha:S[c+36>>>2>>>0],Ka:se?Oe(se):""},s=Oe(s),se={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ie in se)s=s.replace(new RegExp(ie,"g"),se[ie]);var at="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ot="January February March April May June July August September October November December".split(" ");se={"%a":p=>at[p.xa].substring(0,3),"%A":p=>at[p.xa],"%b":p=>ot[p.Ba].substring(0,3),"%B":p=>ot[p.Ba],"%C":p=>_((p.za+1900)/100|0,2),"%d":p=>_(p.Ca,2),"%e":p=>O(p.Ca,2," "),"%g":p=>oe(p).toString().substring(2),"%G":p=>oe(p),"%H":p=>_(p.Aa,2),"%I":p=>(p=p.Aa,p==0?p=12:12<p&&(p-=12),_(p,2)),"%j":p=>{for(var H=0,Y=0;Y<=p.Ba-1;H+=(Ie(p.za+1900)?ke:dt)[Y++]);return _(p.Ca+H,3)},"%m":p=>_(p.Ba+1,2),"%M":p=>_(p.Ia,2),"%n":()=>`\n`,"%p":p=>0<=p.Aa&&12>p.Aa?"AM":"PM","%S":p=>_(p.Ja,2),"%t":()=>"\t","%u":p=>p.xa||7,"%U":p=>_(Math.floor((p.ya+7-p.xa)/7),2),"%V":p=>{var H=Math.floor((p.ya+7-(p.xa+6)%7)/7);if(2>=(p.xa+371-p.ya-2)%7&&H++,H)H==53&&(Y=(p.xa+371-p.ya)%7,Y==4||Y==3&&Ie(p.za)||(H=1));else{H=52;var Y=(p.xa+7-p.ya-1)%7;(Y==4||Y==5&&Ie(p.za%400-1))&&H++}return _(H,2)},"%w":p=>p.xa,"%W":p=>_(Math.floor((p.ya+7-(p.xa+6)%7)/7),2),"%y":p=>(p.za+1900).toString().substring(2),"%Y":p=>p.za+1900,"%z":p=>{p=p.Ha;var H=0<=p;return p=Math.abs(p)/60,(H?"+":"-")+("0000"+(p/60*100+p%60)).slice(-4)},"%Z":p=>p.Ka,"%%":()=>"%"},s=s.replace(/%%/g,"\\0\\0");for(ie in se)s.includes(ie)&&(s=s.replace(new RegExp(ie,"g"),se[ie](c)));return s=s.replace(/\\0\\0/g,"%"),ie=z(s),ie.length>a?0:(ue.set(ie,r>>>0),ie.length-1)}var xe=[],ye,Re,pt=[],x=(r,a)=>{if(!Re){Re=new WeakMap;var s=ye.length;if(Re)for(var c=0;c<0+s;c++){var O=c,_=xe[O];_||(O>=xe.length&&(xe.length=O+1),xe[O]=_=ye.get(O)),(O=_)&&Re.set(O,c)}}if(s=Re.get(r)||0)return s;if(pt.length)s=pt.pop();else{try{ye.grow(1)}catch($){throw $ instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":$}s=ye.length-1}try{c=s,ye.set(c,r),xe[c]=ye.get(c)}catch($){if(!($ instanceof TypeError))throw $;if(typeof WebAssembly.Function=="function"){c=WebAssembly.Function,O={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},_={parameters:[],results:a[0]=="v"?[]:[O[a[0]]]};for(var A=1;A<a.length;++A)_.parameters.push(O[a[A]]);a=new c(_,r)}else{for(c=[1],O=a.slice(0,1),a=a.slice(1),_={i:127,p:127,j:126,f:125,d:124,e:111},c.push(96),A=a.length,128>A?c.push(A):c.push(A%128|128,A>>7),A=0;A<a.length;++A)c.push(_[a[A]]);O=="v"?c.push(0):c.push(1,_[O]),a=[0,97,115,109,1,0,0,0,1],O=c.length,128>O?a.push(O):a.push(O%128|128,O>>7),a.push.apply(a,c),a.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),a=new WebAssembly.Module(new Uint8Array(a)),a=new WebAssembly.Instance(a,{e:{f:r}}).exports.f}c=s,ye.set(c,a),xe[c]=ye.get(c)}return Re.set(r,s),s},qe={a:function(r,a,s){throw r>>>=0,new Se(r).La(a>>>0,s>>>0),Ae=r,ne++,Ae},e:function(){return 0},L:function(){},A:function(){},C:function(){},u:function(){return 0},J:function(){},E:function(){},I:function(){},k:function(){},B:function(){},y:function(){},K:function(){},z:function(){},l:()=>1,o:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getUTCSeconds(),S[s+4>>>2>>>0]=r.getUTCMinutes(),S[s+8>>>2>>>0]=r.getUTCHours(),S[s+12>>>2>>>0]=r.getUTCDate(),S[s+16>>>2>>>0]=r.getUTCMonth(),S[s+20>>>2>>>0]=r.getUTCFullYear()-1900,S[s+24>>>2>>>0]=r.getUTCDay(),S[s+28>>>2>>>0]=(r.getTime()-Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getSeconds(),S[s+4>>>2>>>0]=r.getMinutes(),S[s+8>>>2>>>0]=r.getHours(),S[s+12>>>2>>>0]=r.getDate(),S[s+16>>>2>>>0]=r.getMonth(),S[s+20>>>2>>>0]=r.getFullYear()-1900,S[s+24>>>2>>>0]=r.getDay(),S[s+28>>>2>>>0]=(Ie(r.getFullYear())?Ze:lt)[r.getMonth()]+r.getDate()-1|0,S[s+36>>>2>>>0]=-(60*r.getTimezoneOffset()),a=new Date(r.getFullYear(),6,1).getTimezoneOffset();var c=new Date(r.getFullYear(),0,1).getTimezoneOffset();S[s+32>>>2>>>0]=(a!=c&&r.getTimezoneOffset()==Math.min(c,a))|0},q:function(r){r>>>=0;var a=new Date(S[r+20>>>2>>>0]+1900,S[r+16>>>2>>>0],S[r+12>>>2>>>0],S[r+8>>>2>>>0],S[r+4>>>2>>>0],S[r>>>2>>>0],0),s=S[r+32>>>2>>>0],c=a.getTimezoneOffset(),O=new Date(a.getFullYear(),6,1).getTimezoneOffset(),_=new Date(a.getFullYear(),0,1).getTimezoneOffset(),A=Math.min(_,O);return 0>s?S[r+32>>>2>>>0]=+(O!=_&&A==c):0<s!=(A==c)&&(O=Math.max(_,O),a.setTime(a.getTime()+6e4*((0<s?A:O)-c))),S[r+24>>>2>>>0]=a.getDay(),S[r+28>>>2>>>0]=(Ie(a.getFullYear())?Ze:lt)[a.getMonth()]+a.getDate()-1|0,S[r>>>2>>>0]=a.getSeconds(),S[r+4>>>2>>>0]=a.getMinutes(),S[r+8>>>2>>>0]=a.getHours(),S[r+12>>>2>>>0]=a.getDate(),S[r+16>>>2>>>0]=a.getMonth(),S[r+20>>>2>>>0]=a.getYear(),r=a.getTime(),isNaN(r)?(S[Le()>>>2>>>0]=61,r=-1):r/=1e3,tt((Me=r,1<=+Math.abs(Me)?0<Me?+Math.floor(Me/4294967296)>>>0:~~+Math.ceil((Me-+(~~Me>>>0))/4294967296)>>>0:0)),r>>>0},m:function(){return-52},n:function(){},w:function(r,a,s){function c(oe){return(oe=oe.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?oe[1]:"GMT"}s>>>=0;var O=new Date().getFullYear(),_=new Date(O,0,1),A=new Date(O,6,1);O=_.getTimezoneOffset();var $=A.getTimezoneOffset();G[r>>>0>>>2>>>0]=60*Math.max(O,$),S[a>>>0>>>2>>>0]=+(O!=$),r=c(_),a=c(A),r=Ue(r),a=Ue(a),$<O?(G[s>>>2>>>0]=r,G[s+4>>>2>>>0]=a):(G[s>>>2>>>0]=a,G[s+4>>>2>>>0]=r)},d:()=>{le("")},D:function(r,a,s){r>>>=0,a>>>=0,s>>>=0,Ye.length=0;for(var c;c=ee[a++>>>0];){var O=c!=105;O&=c!=112,s+=O&&s%8?4:0,Ye.push(c==112?G[s>>>2>>>0]:c==105?S[s>>>2>>>0]:fe[s>>>3>>>0]),s+=O?8:4}return pe[r].apply(null,Ye)},g:()=>Date.now(),x:function(){return 4294901760},b:()=>performance.now(),H:function(r,a,s){return a>>>=0,ee.copyWithin(r>>>0>>>0,a>>>0,a+(s>>>0)>>>0)},v:function(r){r>>>=0;var a=ee.length;if(4294901760<r)return!1;for(var s=1;4>=s;s*=2){var c=a*(1+.2/s);c=Math.min(c,r+100663296);var O=Math;c=Math.max(r,c);e:{O=(O.min.call(O,4294901760,c+(65536-c%65536)%65536)-k.buffer.byteLength+65535)/65536;try{k.grow(O),We();var _=1;break e}catch{}_=void 0}if(_)return!0}return!1},F:function(r,a){r>>>=0,a>>>=0;var s=0;return Ge().forEach((c,O)=>{var _=a+s;for(O=G[r+4*O>>>2>>>0]=_,_=0;_<c.length;++_)ue[O++>>>0>>>0]=c.charCodeAt(_);ue[O>>>0>>>0]=0,s+=c.length+1}),0},G:function(r,a){r>>>=0,a>>>=0;var s=Ge();G[r>>>2>>>0]=s.length;var c=0;return s.forEach(O=>c+=O.length+1),G[a>>>2>>>0]=c,0},f:()=>52,j:function(){return 52},r:function(){return 70},i:function(r,a,s,c){a>>>=0,s>>>=0,c>>>=0;for(var O=0,_=0;_<s;_++){var A=G[a>>>2>>>0],$=G[a+4>>>2>>>0];a+=8;for(var oe=0;oe<$;oe++){var se=ee[A+oe>>>0],ie=Ne[r];se===0||se===10?((r===1?E:F)(Fe(ie,0)),ie.length=0):ie.push(se)}O+=$}return G[c>>>2>>>0]=O,0},s:function(r,a){return r>>>=0,Ke(ee.subarray(r>>>0,r+(a>>>0)>>>0)),0},t:et,c:function(r,a,s,c){return et(r>>>0,a>>>0,s>>>0,c>>>0)},h:function(r,a,s,c){let O=ye.length;r=new Uint8Array(ee.slice(r+a,r+s));try{var _=new WebAssembly.Module(r),A=new WebAssembly.Instance(_,{env:{memory:k}}),$;for($ in A.exports)x(A.exports[$]);return O<ye.length?O:c}catch(oe){return console.log(oe),c}}},C=function(){function r(s){return C=s.exports,C=ht(),k=C.M,We(),ye=C.sa,te.unshift(C.N),de--,de==0&&(L!==null&&(clearInterval(L),L=null),re&&(s=re,re=null,s())),C}var a={a:qe};if(de++,o.instantiateWasm)try{return o.instantiateWasm(a,r)}catch(s){F(`Module.instantiateWasm callback failed with error: ${s}`),l(s)}return Pe(a,function(s){r(s.instance)}).catch(l),{}}();o._OrtInit=(r,a)=>(o._OrtInit=C.O)(r,a),o._OrtGetLastError=(r,a)=>(o._OrtGetLastError=C.P)(r,a),o._OrtCreateSessionOptions=(r,a,s,c,O,_,A,$,oe,se)=>(o._OrtCreateSessionOptions=C.Q)(r,a,s,c,O,_,A,$,oe,se),o._OrtAppendExecutionProvider=(r,a)=>(o._OrtAppendExecutionProvider=C.R)(r,a),o._OrtAddFreeDimensionOverride=(r,a,s)=>(o._OrtAddFreeDimensionOverride=C.S)(r,a,s),o._OrtAddSessionConfigEntry=(r,a,s)=>(o._OrtAddSessionConfigEntry=C.T)(r,a,s),o._OrtReleaseSessionOptions=r=>(o._OrtReleaseSessionOptions=C.U)(r),o._OrtCreateSession=(r,a,s)=>(o._OrtCreateSession=C.V)(r,a,s),o._OrtReleaseSession=r=>(o._OrtReleaseSession=C.W)(r),o._OrtGetInputOutputCount=(r,a,s)=>(o._OrtGetInputOutputCount=C.X)(r,a,s),o._OrtGetInputName=(r,a)=>(o._OrtGetInputName=C.Y)(r,a),o._OrtGetOutputName=(r,a)=>(o._OrtGetOutputName=C.Z)(r,a),o._OrtFree=r=>(o._OrtFree=C._)(r),o._OrtCreateTensor=(r,a,s,c,O,_)=>(o._OrtCreateTensor=C.$)(r,a,s,c,O,_),o._OrtGetTensorData=(r,a,s,c,O)=>(o._OrtGetTensorData=C.aa)(r,a,s,c,O),o._OrtReleaseTensor=r=>(o._OrtReleaseTensor=C.ba)(r),o._OrtCreateRunOptions=(r,a,s,c)=>(o._OrtCreateRunOptions=C.ca)(r,a,s,c),o._OrtAddRunConfigEntry=(r,a,s)=>(o._OrtAddRunConfigEntry=C.da)(r,a,s),o._OrtReleaseRunOptions=r=>(o._OrtReleaseRunOptions=C.ea)(r),o._OrtCreateBinding=r=>(o._OrtCreateBinding=C.fa)(r),o._OrtBindInput=(r,a,s)=>(o._OrtBindInput=C.ga)(r,a,s),o._OrtBindOutput=(r,a,s,c)=>(o._OrtBindOutput=C.ha)(r,a,s,c),o._OrtClearBoundOutputs=r=>(o._OrtClearBoundOutputs=C.ia)(r),o._OrtReleaseBinding=r=>(o._OrtReleaseBinding=C.ja)(r),o._OrtRunWithBinding=(r,a,s,c,O)=>(o._OrtRunWithBinding=C.ka)(r,a,s,c,O),o._OrtRun=(r,a,s,c,O,_,A,$)=>(o._OrtRun=C.la)(r,a,s,c,O,_,A,$),o._OrtEndProfiling=r=>(o._OrtEndProfiling=C.ma)(r),o._OrtConfigure=(r,a)=>(o._OrtConfigure=C.na)(r,a),o._OrtAuth=(r,a)=>(o._OrtAuth=C.oa)(r,a);var Le=()=>(Le=C.pa)(),me=o._malloc=r=>(me=o._malloc=C.qa)(r);o._free=r=>(o._free=C.ra)(r);var tt=r=>(tt=C.ta)(r),mt=()=>(mt=C.ua)(),rt=r=>(rt=C.va)(r),gt=r=>(gt=C.wa)(r);o.___start_em_js=882613,o.___stop_em_js=883225;function ht(){var r=C;r=Object.assign({},r);var a=c=>()=>c()>>>0,s=c=>O=>c(O)>>>0;return r.pa=a(r.pa),r.qa=s(r.qa),r.ua=a(r.ua),r.wa=s(r.wa),r}o.stackAlloc=gt,o.stackSave=mt,o.stackRestore=rt,o.addFunction=x,o.UTF8ToString=Oe,o.stringToUTF8=(r,a,s)=>ze(r,ee,a,s),o.lengthBytesUTF8=Te;var $e;re=function r(){$e||nt(),$e||(re=r)};function nt(){if(!(0<de)){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;){var r=o.preRun.shift();He.unshift(r)}for(;0<He.length;)He.shift()(o);if(!(0<de||$e||($e=!0,o.calledRun=!0,we))){for(;0<te.length;)te.shift()(o);for(g(o);0<V.length;)V.shift()(o)}}}return nt(),d.ready}})();typeof Or=="object"&&typeof Pt=="object"?Pt.exports=br:typeof define=="function"&&define.amd&&define([],()=>br)});var _r=st(()=>{});var Er=st(()=>{});var Sr={};Dt(Sr,{cpus:()=>dn});var dn,Ar=Ct(()=>{dn=void 0});var xr=st((Mr,It)=>{"use strict";var Tr=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){function o(){return V.buffer!=le.buffer&&Ee(),le}function g(){return V.buffer!=le.buffer&&Ee(),he}function l(){return V.buffer!=le.buffer&&Ee(),be}function b(){return V.buffer!=le.buffer&&Ee(),Q}function y(){return V.buffer!=le.buffer&&Ee(),ce}var f=d,M,D;f.ready=new Promise((e,t)=>{M=e,D=t});var P=Object.assign({},f),W="./this.program",U=(e,t)=>{throw t},R=typeof window=="object",N=typeof importScripts=="function",I=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",E=f.ENVIRONMENT_IS_PTHREAD||!1,F="";function k(e){return f.locateFile?f.locateFile(e,F):F+e}var we,ue,ee;if(I){var S=(Ut(),it(Ft)),G=(Lt(),it(Rt));F=N?G.dirname(F)+"/":__dirname+"/",we=(t,n)=>(t=Oe(t)?new URL(t):G.normalize(t),S.readFileSync(t,n?void 0:"utf8")),ee=t=>(t=we(t,!0),t.buffer||(t=new Uint8Array(t)),t),ue=(t,n,u,h=!0)=>{t=Oe(t)?new URL(t):G.normalize(t),S.readFile(t,h?void 0:"utf8",(w,v)=>{w?u(w):n(h?v.buffer:v)})},!f.thisProgram&&1<process.argv.length&&(W=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),U=(t,n)=>{throw process.exitCode=t,n},f.inspect=()=>"[Emscripten Module object]";let e;try{e=_r()}catch(t){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),t}global.Worker=e.Worker}else(R||N)&&(N?F=self.location.href:typeof document<"u"&&document.currentScript&&(F=document.currentScript.src),typeof i<"u"&&i&&(F=i),F.indexOf("blob:")!==0?F=F.substr(0,F.replace(/[?#].*/,"").lastIndexOf("/")+1):F="",I||(we=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},N&&(ee=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),ue=(e,t,n)=>{var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=()=>{u.status==200||u.status==0&&u.response?t(u.response):n()},u.onerror=n,u.send(null)}));I&&typeof performance>"u"&&(global.performance=Er().performance);var fe=console.log.bind(console),We=console.error.bind(console);I&&(fe=(...e)=>S.writeSync(1,e.join(" ")+`\n`),We=(...e)=>S.writeSync(2,e.join(" ")+`\n`));var He=fe,te=We;Object.assign(f,P),P=null,typeof WebAssembly!="object"&&Z("no native wasm support detected");var V,de,L=!1,re,le,he,be,Q,ce;function Ee(){var e=V.buffer;f.HEAP8=le=new Int8Array(e),f.HEAP16=new Int16Array(e),f.HEAPU8=he=new Uint8Array(e),f.HEAPU16=new Uint16Array(e),f.HEAP32=be=new Int32Array(e),f.HEAPU32=Q=new Uint32Array(e),f.HEAPF32=new Float32Array(e),f.HEAPF64=ce=new Float64Array(e)}var Ce=16777216;if(E)V=f.wasmMemory;else if(f.wasmMemory)V=f.wasmMemory;else if(V=new WebAssembly.Memory({initial:Ce/65536,maximum:65536,shared:!0}),!(V.buffer instanceof SharedArrayBuffer))throw te("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),I&&te("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ee(),Ce=V.buffer.byteLength;var De=[],Pe=[],Me=[],pe=0,Se=null,Ae=null;function ne(){if(pe--,pe==0&&(Se!==null&&(clearInterval(Se),Se=null),Ae)){var e=Ae;Ae=null,e()}}function Z(e){throw e="Aborted("+e+")",te(e),L=!0,re=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),D(e),e}var Fe=e=>e.startsWith("data:application/octet-stream;base64,"),Oe=e=>e.startsWith("file://"),Te;Te="ort-wasm-threaded.wasm",Fe(Te)||(Te=k(Te));function ze(e){if(ee)return ee(e);throw"both async and sync fetching of the wasm failed"}function Ie(e){if(R||N){if(typeof fetch=="function"&&!Oe(e))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at \'"+e+"\'";return t.arrayBuffer()}).catch(()=>ze(e));if(ue)return new Promise((t,n)=>{ue(e,u=>t(new Uint8Array(u)),n)})}return Promise.resolve().then(()=>ze(e))}function Ze(e,t,n){return Ie(e).then(u=>WebAssembly.instantiate(u,t)).then(u=>u).then(n,u=>{te(`failed to asynchronously prepare wasm: ${u}`),Z(u)})}function lt(e,t){var n=Te;return typeof WebAssembly.instantiateStreaming!="function"||Fe(n)||Oe(n)||I||typeof fetch!="function"?Ze(n,e,t):fetch(n,{credentials:"same-origin"}).then(u=>WebAssembly.instantiateStreaming(u,e).then(t,function(h){return te(`wasm streaming compile failed: ${h}`),te("falling back to ArrayBuffer instantiation"),Ze(n,e,t)}))}var Ue,Ye={886500:(e,t,n,u)=>{if(typeof f>"u"||!f.hb)return 1;if(e=ke(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=f.hb.get(e),!e)return 2;if(t>>>=0,n>>>=0,u>>>=0,t+n>e.byteLength)return 3;try{return g().set(e.subarray(t,t+n),u>>>0),0}catch{return 4}}};function Be(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var Ge=e=>{e.terminate(),e.onmessage=()=>{}},Ve=e=>{x.Ta.length==0&&(Re(),x.bb(x.Ta[0]));var t=x.Ta.pop();if(!t)return 6;x.Ua.push(t),x.Qa[e.Sa]=t,t.Sa=e.Sa;var n={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return I&&t.unref(),t.postMessage(n,e.ub),0},Ne=0,ct=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ke=(e,t,n)=>{t>>>=0;var u=t+n;for(n=t;e[n]&&!(n>=u);)++n;if(16<n-t&&e.buffer&&ct)return ct.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(u="";t<n;){var h=e[t++];if(h&128){var w=e[t++]&63;if((h&224)==192)u+=String.fromCharCode((h&31)<<6|w);else{var v=e[t++]&63;h=(h&240)==224?(h&15)<<12|w<<6|v:(h&7)<<18|w<<12|v<<6|e[t++]&63,65536>h?u+=String.fromCharCode(h):(h-=65536,u+=String.fromCharCode(55296|h>>10,56320|h&1023))}}else u+=String.fromCharCode(h)}return u},ke=(e,t)=>(e>>>=0)?Ke(g(),e,t):"",dt=e=>{var t=Tt();return e=e(),wt(t),e};function z(e,t){var n=arguments.length-2,u=arguments;return dt(()=>{for(var h=Mt(8*n),w=h>>>3,v=0;v<n;v++){var B=u[2+v];y()[w+v>>>0]=B}return fr(e,n,h,t)})}function et(e){if(E)return z(0,1,e);re=e,0<Ne||(x.pb(),f.onExit?.(e),L=!0),U(e,new Be(e))}var xe=e=>{if(re=e,E)throw C(e),"unwind";et(e)};function ye(){for(var e=f.numThreads;e--;)Re();De.unshift(()=>{pe++,pt(()=>ne())})}function Re(){var e=k("ort-wasm-threaded.worker.js");e=new Worker(e),x.Ta.push(e)}function pt(e){E?e():Promise.all(x.Ta.map(x.bb)).then(e)}var x={Ta:[],Ua:[],gb:[],Qa:{},$a(){E?(x.receiveObjectTransfer=x.nb,x.threadInitTLS=x.fb,x.setExitStatus=x.eb):ye()},eb:e=>re=e,xb:["$terminateWorker"],pb:()=>{for(var e of x.Ua)Ge(e);for(e of x.Ta)Ge(e);x.Ta=[],x.Ua=[],x.Qa=[]},cb:e=>{var t=e.Sa;delete x.Qa[t],x.Ta.push(e),x.Ua.splice(x.Ua.indexOf(e),1),e.Sa=0,St(t)},nb(){},fb(){x.gb.forEach(e=>e())},bb:e=>new Promise(t=>{e.onmessage=w=>{w=w.data;var v=w.cmd;if(w.targetThread&&w.targetThread!=yt()){var B=x.Qa[w.targetThread];B?B.postMessage(w,w.transferList):te(`Internal error! Worker sent a message "${v}" to target pthread ${w.targetThread}, but that thread no longer exists!`)}else v==="checkMailbox"?ve():v==="spawnThread"?Ve(w):v==="cleanupThread"?x.cb(x.Qa[w.thread]):v==="killThread"?(w=w.thread,v=x.Qa[w],delete x.Qa[w],Ge(v),St(w),x.Ua.splice(x.Ua.indexOf(v),1),v.Sa=0):v==="cancelThread"?x.Qa[w.thread].postMessage({cmd:"cancel"}):v==="loaded"?(e.loaded=!0,I&&!e.Sa&&e.unref(),t(e)):v==="alert"?alert(`Thread ${w.threadId}: ${w.text}`):w.target==="setimmediate"?e.postMessage(w):v==="callHandler"?f[w.handler](...w.args):v&&te(`worker sent an unknown command ${v}`)},e.onerror=w=>{throw te(`worker sent an error! ${w.filename}:${w.lineno}: ${w.message}`),w},I&&(e.on("message",w=>e.onmessage({data:w})),e.on("error",w=>e.onerror(w)));var n=[],u=["onExit"],h;for(h of u)f.hasOwnProperty(h)&&n.push(h);e.postMessage({cmd:"load",handlers:n,urlOrBlob:f.mainScriptUrlOrBlob||i,wasmMemory:V,wasmModule:de})})};f.PThread=x;var qe=e=>{for(;0<e.length;)e.shift()(f)};f.establishStackSpace=()=>{var e=yt(),t=b()[e+52>>>2>>>0];e=b()[e+56>>>2>>>0],dr(t,t-e),wt(t)};function C(e){if(E)return z(1,0,e);xe(e)}var Le=[],me,tt=e=>{var t=Le[e];return t||(e>=Le.length&&(Le.length=e+1),Le[e]=t=me.get(e)),t};f.invokeEntryPoint=(e,t)=>{e=tt(e)(t),0<Ne?x.eb(e):At(e)};function mt(e){this.Za=e-24,this.kb=function(t){b()[this.Za+4>>>2>>>0]=t},this.jb=function(t){b()[this.Za+8>>>2>>>0]=t},this.$a=function(t,n){this.ib(),this.kb(t),this.jb(n)},this.ib=function(){b()[this.Za+16>>>2>>>0]=0}}var rt=0,gt=0;function ht(e,t,n,u){return E?z(2,1,e,t,n,u):$e(e,t,n,u)}function $e(e,t,n,u){if(e>>>=0,t>>>=0,n>>>=0,u>>>=0,typeof SharedArrayBuffer>"u")return te("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var h=[];return E&&h.length===0?ht(e,t,n,u):(e={ob:n,Sa:e,lb:u,ub:h},E?(e.wb="spawnThread",postMessage(e,h),0):Ve(e))}function nt(e,t,n){return E?z(3,1,e,t,n):0}function r(e,t){if(E)return z(4,1,e,t)}var a=e=>{for(var t=0,n=0;n<e.length;++n){var u=e.charCodeAt(n);127>=u?t++:2047>=u?t+=2:55296<=u&&57343>=u?(t+=4,++n):t+=3}return t},s=(e,t,n,u)=>{if(n>>>=0,!(0<u))return 0;var h=n;u=n+u-1;for(var w=0;w<e.length;++w){var v=e.charCodeAt(w);if(55296<=v&&57343>=v){var B=e.charCodeAt(++w);v=65536+((v&1023)<<10)|B&1023}if(127>=v){if(n>=u)break;t[n++>>>0]=v}else{if(2047>=v){if(n+1>=u)break;t[n++>>>0]=192|v>>6}else{if(65535>=v){if(n+2>=u)break;t[n++>>>0]=224|v>>12}else{if(n+3>=u)break;t[n++>>>0]=240|v>>18,t[n++>>>0]=128|v>>12&63}t[n++>>>0]=128|v>>6&63}t[n++>>>0]=128|v&63}}return t[n>>>0]=0,n-h},c=(e,t,n)=>s(e,g(),t,n);function O(e,t){if(E)return z(5,1,e,t)}function _(e,t,n){if(E)return z(6,1,e,t,n)}function A(e,t,n){return E?z(7,1,e,t,n):0}function $(e,t){if(E)return z(8,1,e,t)}function oe(e,t,n){if(E)return z(9,1,e,t,n)}function se(e,t,n,u){if(E)return z(10,1,e,t,n,u)}function ie(e,t,n,u){if(E)return z(11,1,e,t,n,u)}function at(e,t,n,u){if(E)return z(12,1,e,t,n,u)}function ot(e){if(E)return z(13,1,e)}function p(e,t){if(E)return z(14,1,e,t)}function H(e,t,n){if(E)return z(15,1,e,t,n)}function Y(e){e>>>=0,typeof Atomics.vb=="function"&&(Atomics.vb(l(),e>>>2,e).value.then(ve),e+=128,Atomics.store(l(),e>>>2,1))}f.__emscripten_thread_mailbox_await=Y;var ve=()=>{var e=yt();if(e&&(Y(e),e=lr,!L))try{if(e(),!(0<Ne))try{E?At(re):xe(re)}catch(t){t instanceof Be||t=="unwind"||U(1,t)}}catch(t){t instanceof Be||t=="unwind"||U(1,t)}};f.checkMailbox=ve;var Je=[],Xe=e=>e%4===0&&(e%100!==0||e%400===0),$t=[0,31,60,91,121,152,182,213,244,274,305,335],jt=[0,31,59,90,120,151,181,212,243,273,304,334];function zt(e,t,n,u,h,w,v,B){return E?z(16,1,e,t,n,u,h,w,v,B):-52}function Yt(e,t,n,u,h,w,v){if(E)return z(17,1,e,t,n,u,h,w,v)}var Gt=e=>{var t=a(e)+1,n=ir(t);return n&&c(e,n,t),n},vt=[],_t={},Vt=()=>{if(!Et){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:W||"./this.program"},t;for(t in _t)_t[t]===void 0?delete e[t]:e[t]=_t[t];var n=[];for(t in e)n.push(`${t}=${e[t]}`);Et=n}return Et},Et;function qt(e,t){if(E)return z(18,1,e,t);e>>>=0,t>>>=0;var n=0;return Vt().forEach((u,h)=>{var w=t+n;for(h=b()[e+4*h>>>2>>>0]=w,w=0;w<u.length;++w)o()[h++>>>0>>>0]=u.charCodeAt(w);o()[h>>>0>>>0]=0,n+=u.length+1}),0}function Jt(e,t){if(E)return z(19,1,e,t);e>>>=0,t>>>=0;var n=Vt();b()[e>>>2>>>0]=n.length;var u=0;return n.forEach(h=>u+=h.length+1),b()[t>>>2>>>0]=u,0}function Xt(e){return E?z(20,1,e):52}function Qt(e,t,n,u){return E?z(21,1,e,t,n,u):52}function Zt(e,t,n,u,h){return E?z(22,1,e,t,n,u,h):70}var Qr=[null,[],[]];function Kt(e,t,n,u){if(E)return z(23,1,e,t,n,u);t>>>=0,n>>>=0,u>>>=0;for(var h=0,w=0;w<n;w++){var v=b()[t>>>2>>>0],B=b()[t+4>>>2>>>0];t+=8;for(var _e=0;_e<B;_e++){var ae=g()[v+_e>>>0],ge=Qr[e];ae===0||ae===10?((e===1?He:te)(Ke(ge,0)),ge.length=0):ge.push(ae)}h+=B}return b()[u>>>2>>>0]=h,0}var Zr=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return n=>(n.set(crypto.getRandomValues(new Uint8Array(n.byteLength))),n);if(I)try{var e=yr("crypto");if(e.randomFillSync)return n=>e.randomFillSync(n);var t=e.randomBytes;return n=>(n.set(t(n.byteLength)),n)}catch{}Z("initRandomDevice")},er=e=>(er=Zr())(e),tr=[31,29,31,30,31,30,31,31,30,31,30,31],rr=[31,28,31,30,31,30,31,31,30,31,30,31];function Kr(e){var t=Array(a(e)+1);return s(e,t,0,t.length),t}var en=(e,t)=>{o().set(e,t>>>0)};function nr(e,t,n,u){function h(m,j,J){for(m=typeof m=="number"?m.toString():m||"";m.length<j;)m=J[0]+m;return m}function w(m,j){return h(m,j,"0")}function v(m,j){function J(hr){return 0>hr?-1:0<hr?1:0}var je;return(je=J(m.getFullYear()-j.getFullYear()))===0&&(je=J(m.getMonth()-j.getMonth()))===0&&(je=J(m.getDate()-j.getDate())),je}function B(m){switch(m.getDay()){case 0:return new Date(m.getFullYear()-1,11,29);case 1:return m;case 2:return new Date(m.getFullYear(),0,3);case 3:return new Date(m.getFullYear(),0,2);case 4:return new Date(m.getFullYear(),0,1);case 5:return new Date(m.getFullYear()-1,11,31);case 6:return new Date(m.getFullYear()-1,11,30)}}function _e(m){var j=m.Va;for(m=new Date(new Date(m.Wa+1900,0,1).getTime());0<j;){var J=m.getMonth(),je=(Xe(m.getFullYear())?tr:rr)[J];if(j>je-m.getDate())j-=je-m.getDate()+1,m.setDate(1),11>J?m.setMonth(J+1):(m.setMonth(0),m.setFullYear(m.getFullYear()+1));else{m.setDate(m.getDate()+j);break}}return J=new Date(m.getFullYear()+1,0,4),j=B(new Date(m.getFullYear(),0,4)),J=B(J),0>=v(j,m)?0>=v(J,m)?m.getFullYear()+1:m.getFullYear():m.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0,u>>>=0;var ae=b()[u+40>>>2>>>0];u={sb:l()[u>>>2>>>0],rb:l()[u+4>>>2>>>0],Xa:l()[u+8>>>2>>>0],ab:l()[u+12>>>2>>>0],Ya:l()[u+16>>>2>>>0],Wa:l()[u+20>>>2>>>0],Ra:l()[u+24>>>2>>>0],Va:l()[u+28>>>2>>>0],yb:l()[u+32>>>2>>>0],qb:l()[u+36>>>2>>>0],tb:ae?ke(ae):""},n=ke(n),ae={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ge in ae)n=n.replace(new RegExp(ge,"g"),ae[ge]);var mr="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),gr="January February March April May June July August September October November December".split(" ");ae={"%a":m=>mr[m.Ra].substring(0,3),"%A":m=>mr[m.Ra],"%b":m=>gr[m.Ya].substring(0,3),"%B":m=>gr[m.Ya],"%C":m=>w((m.Wa+1900)/100|0,2),"%d":m=>w(m.ab,2),"%e":m=>h(m.ab,2," "),"%g":m=>_e(m).toString().substring(2),"%G":m=>_e(m),"%H":m=>w(m.Xa,2),"%I":m=>(m=m.Xa,m==0?m=12:12<m&&(m-=12),w(m,2)),"%j":m=>{for(var j=0,J=0;J<=m.Ya-1;j+=(Xe(m.Wa+1900)?tr:rr)[J++]);return w(m.ab+j,3)},"%m":m=>w(m.Ya+1,2),"%M":m=>w(m.rb,2),"%n":()=>`\n`,"%p":m=>0<=m.Xa&&12>m.Xa?"AM":"PM","%S":m=>w(m.sb,2),"%t":()=>"\t","%u":m=>m.Ra||7,"%U":m=>w(Math.floor((m.Va+7-m.Ra)/7),2),"%V":m=>{var j=Math.floor((m.Va+7-(m.Ra+6)%7)/7);if(2>=(m.Ra+371-m.Va-2)%7&&j++,j)j==53&&(J=(m.Ra+371-m.Va)%7,J==4||J==3&&Xe(m.Wa)||(j=1));else{j=52;var J=(m.Ra+7-m.Va-1)%7;(J==4||J==5&&Xe(m.Wa%400-1))&&j++}return w(j,2)},"%w":m=>m.Ra,"%W":m=>w(Math.floor((m.Va+7-(m.Ra+6)%7)/7),2),"%y":m=>(m.Wa+1900).toString().substring(2),"%Y":m=>m.Wa+1900,"%z":m=>{m=m.qb;var j=0<=m;return m=Math.abs(m)/60,(j?"+":"-")+("0000"+(m/60*100+m%60)).slice(-4)},"%Z":m=>m.tb,"%%":()=>"%"},n=n.replace(/%%/g,"\\0\\0");for(ge in ae)n.includes(ge)&&(n=n.replace(new RegExp(ge,"g"),ae[ge](u)));return n=n.replace(/\\0\\0/g,"%"),ge=Kr(n),ge.length>t?0:(en(ge,e),ge.length-1)}var Qe,ar=[],or=(e,t)=>{if(!Qe){Qe=new WeakMap;var n=me.length;if(Qe)for(var u=0;u<0+n;u++){var h=tt(u);h&&Qe.set(h,u)}}if(n=Qe.get(e)||0)return n;if(ar.length)n=ar.pop();else{try{me.grow(1)}catch(B){throw B instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":B}n=me.length-1}try{u=n,me.set(u,e),Le[u]=me.get(u)}catch(B){if(!(B instanceof TypeError))throw B;if(typeof WebAssembly.Function=="function"){u=WebAssembly.Function,h={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var w={parameters:[],results:t[0]=="v"?[]:[h[t[0]]]},v=1;v<t.length;++v)w.parameters.push(h[t[v]]);t=new u(w,e)}else{for(u=[1],h=t.slice(0,1),t=t.slice(1),w={i:127,p:127,j:126,f:125,d:124,e:111},u.push(96),v=t.length,128>v?u.push(v):u.push(v%128|128,v>>7),v=0;v<t.length;++v)u.push(w[t[v]]);h=="v"?u.push(0):u.push(1,w[h]),t=[0,97,115,109,1,0,0,0,1],h=u.length,128>h?t.push(h):t.push(h%128|128,h>>7),t.push.apply(t,u),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}u=n,me.set(u,t),Le[u]=me.get(u)}return Qe.set(e,n),n};x.$a();var tn=[et,C,ht,nt,r,O,_,A,$,oe,se,ie,at,ot,p,H,zt,Yt,qt,Jt,Xt,Qt,Zt,Kt],rn={b:function(e,t,n){throw e>>>=0,new mt(e).$a(t>>>0,n>>>0),rt=e,gt++,rt},O:function(e){ur(e>>>0,!N,1,!R,131072,!1),x.fb()},m:function(e){e>>>=0,E?postMessage({cmd:"cleanupThread",thread:e}):x.cb(x.Qa[e])},J:$e,h:nt,U:r,F:O,H:_,y:A,S:$,L:oe,R:se,o:ie,G:at,D:ot,T:p,E:H,p:()=>1,B:function(e,t){e>>>=0,e==t>>>0?setTimeout(()=>ve()):E?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=x.Qa[e])&&e.postMessage({cmd:"checkMailbox"})},K:function(e,t,n,u){t>>>=0,Je.length=n,u=u>>>0>>>3;for(var h=0;h<n;h++)Je[h]=y()[u+h>>>0];return e=0>e?Ye[-e-1]:tn[e],x.mb=t,t=e.apply(null,Je),x.mb=0,t},M:Y,W:function(e){I&&x.Qa[e>>>0].ref()},s:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getUTCSeconds(),l()[n+4>>>2>>>0]=e.getUTCMinutes(),l()[n+8>>>2>>>0]=e.getUTCHours(),l()[n+12>>>2>>>0]=e.getUTCDate(),l()[n+16>>>2>>>0]=e.getUTCMonth(),l()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,l()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,l()[n+28>>>2>>>0]=e},t:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getSeconds(),l()[n+4>>>2>>>0]=e.getMinutes(),l()[n+8>>>2>>>0]=e.getHours(),l()[n+12>>>2>>>0]=e.getDate(),l()[n+16>>>2>>>0]=e.getMonth(),l()[n+20>>>2>>>0]=e.getFullYear()-1900,l()[n+24>>>2>>>0]=e.getDay(),t=(Xe(e.getFullYear())?$t:jt)[e.getMonth()]+e.getDate()-1|0,l()[n+28>>>2>>>0]=t,l()[n+36>>>2>>>0]=-(60*e.getTimezoneOffset()),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var u=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=(t!=u&&e.getTimezoneOffset()==Math.min(u,t))|0,l()[n+32>>>2>>>0]=e},u:function(e){e>>>=0;var t=new Date(l()[e+20>>>2>>>0]+1900,l()[e+16>>>2>>>0],l()[e+12>>>2>>>0],l()[e+8>>>2>>>0],l()[e+4>>>2>>>0],l()[e>>>2>>>0],0),n=l()[e+32>>>2>>>0],u=t.getTimezoneOffset(),h=new Date(t.getFullYear(),6,1).getTimezoneOffset(),w=new Date(t.getFullYear(),0,1).getTimezoneOffset(),v=Math.min(w,h);return 0>n?l()[e+32>>>2>>>0]=+(h!=w&&v==u):0<n!=(v==u)&&(h=Math.max(w,h),t.setTime(t.getTime()+6e4*((0<n?v:h)-u))),l()[e+24>>>2>>>0]=t.getDay(),n=(Xe(t.getFullYear())?$t:jt)[t.getMonth()]+t.getDate()-1|0,l()[e+28>>>2>>>0]=n,l()[e>>>2>>>0]=t.getSeconds(),l()[e+4>>>2>>>0]=t.getMinutes(),l()[e+8>>>2>>>0]=t.getHours(),l()[e+12>>>2>>>0]=t.getDate(),l()[e+16>>>2>>>0]=t.getMonth(),l()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(l()[sr()>>>2>>>0]=61,e=-1):e/=1e3,cr((Ue=e,1<=+Math.abs(Ue)?0<Ue?+Math.floor(Ue/4294967296)>>>0:~~+Math.ceil((Ue-+(~~Ue>>>0))/4294967296)>>>0:0)),e>>>0},q:zt,r:Yt,A:function(e,t,n){function u(ae){return(ae=ae.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ae[1]:"GMT"}e>>>=0,t>>>=0,n>>>=0;var h=new Date().getFullYear(),w=new Date(h,0,1),v=new Date(h,6,1);h=w.getTimezoneOffset();var B=v.getTimezoneOffset(),_e=Math.max(h,B);b()[e>>>2>>>0]=60*_e,l()[t>>>2>>>0]=+(h!=B),e=u(w),t=u(v),e=Gt(e),t=Gt(t),B<h?(b()[n>>>2>>>0]=e,b()[n+4>>>2>>>0]=t):(b()[n>>>2>>>0]=t,b()[n+4>>>2>>>0]=e)},c:()=>{Z("")},N:function(e,t,n){e>>>=0,t>>>=0,n>>>=0,vt.length=0;for(var u;u=g()[t++>>>0];){var h=u!=105;h&=u!=112,n+=h&&n%8?4:0,vt.push(u==112?b()[n>>>2>>>0]:u==105?l()[n>>>2>>>0]:y()[n>>>3>>>0]),n+=h?8:4}return Ye[e].apply(null,vt)},n:()=>{},i:()=>Date.now(),V:()=>{throw Ne+=1,"unwind"},C:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>I?(Ar(),it(Sr)).cpus().length:navigator.hardwareConcurrency,z:function(e){e>>>=0;var t=g().length;if(e<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var u=t*(1+.2/n);u=Math.min(u,e+100663296);var h=Math;u=Math.max(e,u);e:{h=(h.min.call(h,4294901760,u+(65536-u%65536)%65536)-V.buffer.byteLength+65535)/65536;try{V.grow(h),Ee();var w=1;break e}catch{}w=void 0}if(w)return!0}return!1},P:qt,Q:Jt,I:xe,g:Xt,l:Qt,v:Zt,k:Kt,w:function(e,t){return e>>>=0,t>>>=0,er(g().subarray(e>>>0,e+t>>>0)),0},a:V||f.wasmMemory,x:nr,d:function(e,t,n,u){return nr(e>>>0,t>>>0,n>>>0,u>>>0)},j:function(e,t,n,u){let h=me.length;e=new Uint8Array(g().slice(e+t,e+n));try{var w=new WebAssembly.Module(e),v=new WebAssembly.Instance(w,{env:{memory:V}}),B;for(B in v.exports)or(v.exports[B]);return h<me.length?h:u}catch(_e){return console.log(_e),u}}},T=function(){function e(n,u){return T=n.exports,T=nn(),x.gb.push(T.Da),me=T.Ea,Pe.unshift(T.X),de=u,ne(),T}var t={a:rn};if(pe++,f.instantiateWasm)try{return f.instantiateWasm(t,e)}catch(n){te(`Module.instantiateWasm callback failed with error: ${n}`),D(n)}return lt(t,function(n){e(n.instance,n.module)}).catch(D),{}}();f._OrtInit=(e,t)=>(f._OrtInit=T.Y)(e,t),f._OrtGetLastError=(e,t)=>(f._OrtGetLastError=T.Z)(e,t),f._OrtCreateSessionOptions=(e,t,n,u,h,w,v,B,_e,ae)=>(f._OrtCreateSessionOptions=T._)(e,t,n,u,h,w,v,B,_e,ae),f._OrtAppendExecutionProvider=(e,t)=>(f._OrtAppendExecutionProvider=T.$)(e,t),f._OrtAddFreeDimensionOverride=(e,t,n)=>(f._OrtAddFreeDimensionOverride=T.aa)(e,t,n),f._OrtAddSessionConfigEntry=(e,t,n)=>(f._OrtAddSessionConfigEntry=T.ba)(e,t,n),f._OrtReleaseSessionOptions=e=>(f._OrtReleaseSessionOptions=T.ca)(e),f._OrtCreateSession=(e,t,n)=>(f._OrtCreateSession=T.da)(e,t,n),f._OrtReleaseSession=e=>(f._OrtReleaseSession=T.ea)(e),f._OrtGetInputOutputCount=(e,t,n)=>(f._OrtGetInputOutputCount=T.fa)(e,t,n),f._OrtGetInputName=(e,t)=>(f._OrtGetInputName=T.ga)(e,t),f._OrtGetOutputName=(e,t)=>(f._OrtGetOutputName=T.ha)(e,t),f._OrtFree=e=>(f._OrtFree=T.ia)(e),f._OrtCreateTensor=(e,t,n,u,h,w)=>(f._OrtCreateTensor=T.ja)(e,t,n,u,h,w),f._OrtGetTensorData=(e,t,n,u,h)=>(f._OrtGetTensorData=T.ka)(e,t,n,u,h),f._OrtReleaseTensor=e=>(f._OrtReleaseTensor=T.la)(e),f._OrtCreateRunOptions=(e,t,n,u)=>(f._OrtCreateRunOptions=T.ma)(e,t,n,u),f._OrtAddRunConfigEntry=(e,t,n)=>(f._OrtAddRunConfigEntry=T.na)(e,t,n),f._OrtReleaseRunOptions=e=>(f._OrtReleaseRunOptions=T.oa)(e),f._OrtCreateBinding=e=>(f._OrtCreateBinding=T.pa)(e),f._OrtBindInput=(e,t,n)=>(f._OrtBindInput=T.qa)(e,t,n),f._OrtBindOutput=(e,t,n,u)=>(f._OrtBindOutput=T.ra)(e,t,n,u),f._OrtClearBoundOutputs=e=>(f._OrtClearBoundOutputs=T.sa)(e),f._OrtReleaseBinding=e=>(f._OrtReleaseBinding=T.ta)(e),f._OrtRunWithBinding=(e,t,n,u,h)=>(f._OrtRunWithBinding=T.ua)(e,t,n,u,h),f._OrtRun=(e,t,n,u,h,w,v,B)=>(f._OrtRun=T.va)(e,t,n,u,h,w,v,B),f._OrtEndProfiling=e=>(f._OrtEndProfiling=T.wa)(e),f._OrtConfigure=(e,t)=>(f._OrtConfigure=T.xa)(e,t),f._OrtAuth=(e,t)=>(f._OrtAuth=T.ya)(e,t);var sr=()=>(sr=T.za)(),yt=f._pthread_self=()=>(yt=f._pthread_self=T.Aa)(),ir=f._malloc=e=>(ir=f._malloc=T.Ba)(e);f._free=e=>(f._free=T.Ca)(e),f.__emscripten_tls_init=()=>(f.__emscripten_tls_init=T.Da)();var ur=f.__emscripten_thread_init=(e,t,n,u,h,w)=>(ur=f.__emscripten_thread_init=T.Fa)(e,t,n,u,h,w);f.__emscripten_thread_crashed=()=>(f.__emscripten_thread_crashed=T.Ga)();var fr=(e,t,n,u)=>(fr=T.Ha)(e,t,n,u),St=e=>(St=T.Ia)(e),At=f.__emscripten_thread_exit=e=>(At=f.__emscripten_thread_exit=T.Ja)(e),lr=()=>(lr=T.Ka)(),cr=e=>(cr=T.La)(e),dr=(e,t)=>(dr=T.Ma)(e,t),Tt=()=>(Tt=T.Na)(),wt=e=>(wt=T.Oa)(e),Mt=e=>(Mt=T.Pa)(e);f.___start_em_js=887001,f.___stop_em_js=887613;function nn(){var e=T;e=Object.assign({},e);var t=u=>()=>u()>>>0,n=u=>h=>u(h)>>>0;return e.za=t(e.za),e.Aa=t(e.Aa),e.Ba=n(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=n(e.Pa),e}f.wasmMemory=V,f.stackAlloc=Mt,f.stackSave=Tt,f.stackRestore=wt,f.keepRuntimeAlive=()=>0<Ne,f.addFunction=or,f.UTF8ToString=ke,f.stringToUTF8=c,f.lengthBytesUTF8=a,f.ExitStatus=Be,f.PThread=x;var bt;Ae=function e(){bt||pr(),bt||(Ae=e)};function pr(){if(!(0<pe))if(E)M(f),E||qe(Pe),startWorker(f);else{if(f.preRun)for(typeof f.preRun=="function"&&(f.preRun=[f.preRun]);f.preRun.length;)De.unshift(f.preRun.shift());qe(De),0<pe||bt||(bt=!0,f.calledRun=!0,L||(E||qe(Pe),M(f),E||qe(Me)))}}return pr(),d.ready}})();typeof Mr=="object"&&typeof It=="object"?It.exports=Tr:typeof define=="function"&&define.amd&&define([],()=>Tr)});var Cr=st((Cn,pn)=>{pn.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Fr;Fr=vr();var mn=xr(),Bt,Wt=!1,Ot=!1,Dr=!1,gn=i=>{if(i===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+i+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},hn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},yn=(i,d)=>i?d?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":d?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Ur=async i=>{if(Wt)return Promise.resolve();if(Ot)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Dr)throw new Error("previous call to \'initializeWebAssembly()\' failed.");Ot=!0;let d=i.initTimeout,o=i.numThreads,g=i.simd,l=gn(o),b=g&&hn(),y=i.wasmPaths,f=typeof y=="string"?y:void 0,M=yn(b,l),D=typeof y=="object"?y[M]:void 0,P=!1,W=[];if(d>0&&W.push(new Promise(U=>{setTimeout(()=>{P=!0,U()},d)})),W.push(new Promise((U,R)=>{let N=l?mn:Fr,I={locateFile:(E,F)=>l&&E.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Cr()],{type:"text/javascript"})):E.endsWith(".wasm")?D||(f??F)+M:F+E};if(l)if(I.numThreads=o,typeof Blob>"u")I.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let E=`var ortWasmThreaded=${N.toString()};`;I.mainScriptUrlOrBlob=new Blob([E],{type:"text/javascript"})}N(I).then(E=>{Ot=!1,Wt=!0,Bt=E,U()},E=>{Ot=!1,Dr=!0,R(E)})})),await Promise.race(W),P)throw new Error(`WebAssembly backend initializing failed due to timeout: ${d}ms`)},q=()=>{if(Wt&&Bt)return Bt;throw new Error("WebAssembly is not initialized yet.")};var K=(i,d)=>{let o=q(),g=o.lengthBytesUTF8(i)+1,l=o._malloc(g);return o.stringToUTF8(i,l,g),d.push(l),l},ut=(i,d,o,g)=>{if(typeof i=="object"&&i!==null){if(o.has(i))throw new Error("Circular reference in options");o.add(i)}Object.entries(i).forEach(([l,b])=>{let y=d?d+l:l;if(typeof b=="object")ut(b,y+".",o,g);else if(typeof b=="string"||typeof b=="number")g(y,b.toString());else if(typeof b=="boolean")g(y,b?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof b}`)})},X=i=>{let d=q(),o=d.stackSave();try{let g=d.stackAlloc(8);d._OrtGetLastError(g,g+4);let l=d.HEAP32[g/4],b=d.HEAPU32[g/4+1],y=b?d.UTF8ToString(b):"";throw new Error(`${i} ERROR_CODE: ${l}, ERROR_MESSAGE: ${y}`)}finally{d.stackRestore(o)}};var Rr=i=>{let d=q(),o=0,g=[],l=i||{};try{if(i?.logSeverityLevel===void 0)l.logSeverityLevel=2;else if(typeof i.logSeverityLevel!="number"||!Number.isInteger(i.logSeverityLevel)||i.logSeverityLevel<0||i.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${i.logSeverityLevel}`);if(i?.logVerbosityLevel===void 0)l.logVerbosityLevel=0;else if(typeof i.logVerbosityLevel!="number"||!Number.isInteger(i.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${i.logVerbosityLevel}`);i?.terminate===void 0&&(l.terminate=!1);let b=0;return i?.tag!==void 0&&(b=K(i.tag,g)),o=d._OrtCreateRunOptions(l.logSeverityLevel,l.logVerbosityLevel,!!l.terminate,b),o===0&&X("Can\'t create run options."),i?.extra!==void 0&&ut(i.extra,"",new WeakSet,(y,f)=>{let M=K(y,g),D=K(f,g);d._OrtAddRunConfigEntry(o,M,D)!==0&&X(`Can\'t set a run config entry: ${y} - ${f}.`)}),[o,g]}catch(b){throw o!==0&&d._OrtReleaseRunOptions(o),g.forEach(y=>d._free(y)),b}};var wn=i=>{switch(i){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${i}`)}},bn=i=>{switch(i){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${i}`)}},On=i=>{i.extra||(i.extra={}),i.extra.session||(i.extra.session={});let d=i.extra.session;d.use_ort_model_bytes_directly||(d.use_ort_model_bytes_directly="1"),i.executionProviders&&i.executionProviders.some(o=>(typeof o=="string"?o:o.name)==="webgpu")&&(i.enableMemPattern=!1)},vn=(i,d,o)=>{for(let g of d){let l=typeof g=="string"?g:g.name;switch(l){case"webnn":if(l="WEBNN",typeof g!="string"){let y=g;if(y?.deviceType){let f=K("deviceType",o),M=K(y.deviceType,o);q()._OrtAddSessionConfigEntry(i,f,M)!==0&&X(`Can\'t set a session config entry: \'deviceType\' - ${y.deviceType}.`)}if(y?.numThreads){let f=y.numThreads;(typeof f!="number"||!Number.isInteger(f)||f<0)&&(f=0);let M=K("numThreads",o),D=K(f.toString(),o);q()._OrtAddSessionConfigEntry(i,M,D)!==0&&X(`Can\'t set a session config entry: \'numThreads\' - ${y.numThreads}.`)}if(y?.powerPreference){let f=K("powerPreference",o),M=K(y.powerPreference,o);q()._OrtAddSessionConfigEntry(i,f,M)!==0&&X(`Can\'t set a session config entry: \'powerPreference\' - ${y.powerPreference}.`)}}break;case"webgpu":if(l="JS",typeof g!="string"){let y=g;if(y?.preferredLayout){if(y.preferredLayout!=="NCHW"&&y.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${y.preferredLayout}`);let f=K("preferredLayout",o),M=K(y.preferredLayout,o);q()._OrtAddSessionConfigEntry(i,f,M)!==0&&X(`Can\'t set a session config entry: \'preferredLayout\' - ${y.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${l}`)}let b=K(l,o);q()._OrtAppendExecutionProvider(i,b)!==0&&X(`Can\'t append execution provider: ${l}.`)}},Lr=i=>{let d=q(),o=0,g=[],l=i||{};On(l);try{let b=wn(l.graphOptimizationLevel??"all"),y=bn(l.executionMode??"sequential"),f=typeof l.logId=="string"?K(l.logId,g):0,M=l.logSeverityLevel??2;if(!Number.isInteger(M)||M<0||M>4)throw new Error(`log serverity level is not valid: ${M}`);let D=l.logVerbosityLevel??0;if(!Number.isInteger(D)||D<0||D>4)throw new Error(`log verbosity level is not valid: ${D}`);let P=typeof l.optimizedModelFilePath=="string"?K(l.optimizedModelFilePath,g):0;if(o=d._OrtCreateSessionOptions(b,!!l.enableCpuMemArena,!!l.enableMemPattern,y,!!l.enableProfiling,0,f,M,D,P),o===0&&X("Can\'t create session options."),l.executionProviders&&vn(o,l.executionProviders,g),l.freeDimensionOverrides)for(let[W,U]of Object.entries(l.freeDimensionOverrides)){if(typeof W!="string")throw new Error(`free dimension override name must be a string: ${W}`);if(typeof U!="number"||!Number.isInteger(U)||U<0)throw new Error(`free dimension override value must be a non-negative integer: ${U}`);let R=K(W,g);d._OrtAddFreeDimensionOverride(o,R,U)!==0&&X(`Can\'t set a free dimension override: ${W} - ${U}.`)}return l.extra!==void 0&&ut(l.extra,"",new WeakSet,(W,U)=>{let R=K(W,g),N=K(U,g);d._OrtAddSessionConfigEntry(o,R,N)!==0&&X(`Can\'t set a session config entry: ${W} - ${U}.`)}),[o,g]}catch(b){throw o!==0&&d._OrtReleaseSessionOptions(o),g.forEach(y=>d._free(y)),b}};var Ht=i=>{switch(i){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${i}`)}},Pr=i=>{switch(i){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${i}`)}},Nt=i=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][i],Ir=i=>{switch(i){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${i}`)}},Br=i=>{switch(i){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${i}`)}},Wr=i=>i==="float32"||i==="int32"||i==="int64"||i==="bool"||i==="float16"||i==="uint32",Hr=i=>{switch(i){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${i}`)}};var Nr=async i=>{if(typeof i=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(i))}catch(d){if(d.code==="ERR_FS_FILE_TOO_LARGE"){let o=(void 0)(i),g=[];for await(let l of o)g.push(l);return new Uint8Array(Buffer.concat(g))}throw d}else{let d=await fetch(i);if(!d.ok)throw new Error(`failed to load external data file: ${i}`);let o=d.headers.get("Content-Length"),g=o?parseInt(o,10):0;if(g<1073741824)return new Uint8Array(await d.arrayBuffer());{if(!d.body)throw new Error(`failed to load external data file: ${i}, no response body.`);let l=d.body.getReader(),b;try{b=new ArrayBuffer(g)}catch(f){if(f instanceof RangeError){let M=Math.ceil(g/65536);b=new WebAssembly.Memory({initial:M,maximum:M}).buffer}else throw f}let y=0;for(;;){let{done:f,value:M}=await l.read();if(f)break;let D=M.byteLength;new Uint8Array(b,y,D).set(M),y+=D}return new Uint8Array(b,0,g)}}else return i instanceof Blob?new Uint8Array(await i.arrayBuffer()):i instanceof Uint8Array?i:new Uint8Array(i)};var _n=(i,d)=>{q()._OrtInit(i,d)!==0&&X("Can\'t initialize onnxruntime.")},$r=async i=>{_n(i.wasm.numThreads,Br(i.logLevel))},jr=async(i,d)=>{},ft=new Map,En=i=>{let d=q(),o=d.stackSave();try{let g=d.stackAlloc(8);return d._OrtGetInputOutputCount(i,g,g+4)!==0&&X("Can\'t get session input/output count."),[d.HEAP32[g/4],d.HEAP32[g/4+1]]}finally{d.stackRestore(o)}},kt=i=>{let d=q(),o=d._malloc(i.byteLength);if(o===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${i.byteLength}.`);return d.HEAPU8.set(i,o),[o,i.byteLength]},zr=async(i,d)=>{let o,g,l=q();Array.isArray(i)?[o,g]=i:i.buffer===l.HEAPU8.buffer?[o,g]=[i.byteOffset,i.byteLength]:[o,g]=kt(i);let b=0,y=0,f=0,M=[],D=[],P=[];try{if([y,M]=Lr(d),d?.externalData&&l.mountExternalData){let F=[];for(let k of d.externalData){let we=typeof k=="string"?k:k.path;F.push(Nr(typeof k=="string"?k:k.data).then(ue=>{l.mountExternalData(we,ue)}))}await Promise.all(F)}b=l._OrtCreateSession(o,g,y),b===0&&X("Can\'t create a session.");let[W,U]=En(b),R=[],N=[],I=[];for(let F=0;F<W;F++){let k=l._OrtGetInputName(b,F);k===0&&X("Can\'t get an input name."),D.push(k),R.push(l.UTF8ToString(k))}for(let F=0;F<U;F++){let k=l._OrtGetOutputName(b,F);k===0&&X("Can\'t get an output name."),P.push(k);let we=l.UTF8ToString(k);N.push(we)}let E=null;return ft.set(b,[b,D,P,E]),[b,R,N]}catch(W){throw D.forEach(U=>l._OrtFree(U)),P.forEach(U=>l._OrtFree(U)),f!==0&&l._OrtReleaseBinding(f),b!==0&&l._OrtReleaseSession(b),W}finally{l._free(o),y!==0&&l._OrtReleaseSessionOptions(y),M.forEach(W=>l._free(W)),l.unmountExternalData?.()}},Yr=i=>{let d=q(),o=ft.get(i);if(!o)throw new Error(`cannot release session. invalid session id: ${i}`);let[g,l,b,y]=o;y&&d._OrtReleaseBinding(y.handle),d.jsepUnregisterBuffers?.(i),l.forEach(f=>d._OrtFree(f)),b.forEach(f=>d._OrtFree(f)),d._OrtReleaseSession(g),ft.delete(i)},kr=(i,d,o,g,l)=>{if(!i){d.push(0);return}let b=q(),y=i[0],f=i[1],M=i[3],D,P;if(y==="string"&&M==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(M==="gpu-buffer"){let R=i[2].gpuBuffer,N=Nt(Ht(y));P=f.reduce((I,E)=>I*E,1)*N,D=b.jsepRegisterBuffer(g,l,R,P)}else{let R=i[2];if(Array.isArray(R)){P=4*R.length,D=b._malloc(P),o.push(D);let N=D/4;for(let I=0;I<R.length;I++){if(typeof R[I]!="string")throw new TypeError(`tensor data at index ${I} is not a string`);b.HEAPU32[N++]=K(R[I],o)}}else P=R.byteLength,D=b._malloc(P),o.push(D),b.HEAPU8.set(new Uint8Array(R.buffer,R.byteOffset,P),D)}let W=b.stackSave(),U=b.stackAlloc(4*f.length);try{let R=U/4;f.forEach(I=>b.HEAP32[R++]=I);let N=b._OrtCreateTensor(Ht(y),D,P,U,f.length,Hr(M));N===0&&X(`Can\'t create tensor for input/output. session=${g}, index=${l}.`),d.push(N)}finally{b.stackRestore(W)}},Gr=i=>{let o=new TextEncoder().encode(i),g=q(),l=g._malloc(o.byteLength);g.HEAPU8.set(o,l);let b=g._OrtConfigure(l,o.byteLength);if(b===0)throw new Error("Can\'t get an configure key");let y=g.UTF8ToString(b);return g._OrtFree(b),y},Vr=i=>{let o=new TextEncoder().encode(i),g=q(),l=g._malloc(o.byteLength);g.HEAPU8.set(o,l);let b=g._OrtAuth(l,o.byteLength);if(b===0)throw new Error("Can\'t get an auth result");let y=g.UTF8ToString(b);return g._OrtFree(b),y},qr=async(i,d,o,g,l,b)=>{let y=q(),f=ft.get(i);if(!f)throw new Error(`cannot run inference. invalid session id: ${i}`);let[M,D,P,W]=f,U=d.length,R=g.length,N=0,I=[],E=[],F=[],k=[],we=y.stackSave(),ue=y.stackAlloc(U*4),ee=y.stackAlloc(U*4),S=y.stackAlloc(R*4),G=y.stackAlloc(R*4);try{[N,I]=Rr(b);for(let L=0;L<U;L++)kr(o[L],E,k,i,d[L]);for(let L=0;L<R;L++)kr(l[L],F,k,i,U+g[L]);let fe=ue/4,We=ee/4,He=S/4,te=G/4;for(let L=0;L<U;L++)y.HEAPU32[fe++]=E[L],y.HEAPU32[We++]=D[d[L]];for(let L=0;L<R;L++)y.HEAPU32[He++]=F[L],y.HEAPU32[te++]=P[g[L]];let V;V=await y._OrtRun(M,ee,ue,U,G,R,S,N),V!==0&&X("failed to call OrtRun().");let de=[];for(let L=0;L<R;L++){let re=y.HEAPU32[S/4+L];if(re===F[L]){de.push(l[L]);continue}let le=y.stackSave(),he=y.stackAlloc(4*4),be=!1,Q,ce=0;try{y._OrtGetTensorData(re,he,he+4,he+8,he+12)!==0&&X(`Can\'t access output tensor data on index ${L}.`);let Ce=he/4,De=y.HEAPU32[Ce++];ce=y.HEAPU32[Ce++];let Pe=y.HEAPU32[Ce++],Me=y.HEAPU32[Ce++],pe=[];for(let ne=0;ne<Me;ne++)pe.push(y.HEAPU32[Pe/4+ne]);y._OrtFree(Pe);let Se=pe.reduce((ne,Z)=>ne*Z,1);Q=Pr(De);let Ae=W?.outputPreferredLocations[g[L]];if(Q==="string"){if(Ae==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let ne=[],Z=ce/4;for(let Fe=0;Fe<Se;Fe++){let Oe=y.HEAPU32[Z++],Te=Fe===Se-1?void 0:y.HEAPU32[Z]-Oe;ne.push(y.UTF8ToString(Oe,Te))}de.push([Q,pe,ne,"cpu"])}else if(Ae==="gpu-buffer"&&Se>0){let ne=y.jsepGetBuffer(ce),Z=Nt(De);if(Z===void 0||!Wr(Q))throw new Error(`Unsupported data type: ${Q}`);be=!0,de.push([Q,pe,{gpuBuffer:ne,download:y.jsepCreateDownloader(ne,Se*Z,Q),dispose:()=>{y._OrtReleaseTensor(re)}},"gpu-buffer"])}else{let ne=Ir(Q),Z=new ne(Se);new Uint8Array(Z.buffer,Z.byteOffset,Z.byteLength).set(y.HEAPU8.subarray(ce,ce+Z.byteLength)),de.push([Q,pe,Z,"cpu"])}}finally{y.stackRestore(le),Q==="string"&&ce&&y._free(ce),be||y._OrtReleaseTensor(re)}}return W&&y._OrtClearBoundOutputs(W.handle),de}finally{y.stackRestore(we),E.forEach(fe=>y._OrtReleaseTensor(fe)),F.forEach(fe=>y._OrtReleaseTensor(fe)),k.forEach(fe=>y._free(fe)),N!==0&&y._OrtReleaseRunOptions(N),I.forEach(fe=>y._free(fe))}},Jr=i=>{let d=q(),o=ft.get(i);if(!o)throw new Error("invalid session id");let g=o[0],l=d._OrtEndProfiling(g);l===0&&X("Can\'t get an profile file name."),d._OrtFree(l)},Xr=i=>{let d=[];for(let o of i){let g=o[2];!Array.isArray(g)&&"buffer"in g&&d.push(g.buffer)}return d};self.onmessage=i=>{let{type:d,in:o}=i.data;try{switch(d){case"init-wasm":Ur(o.wasm).then(()=>{$r(o).then(()=>{postMessage({type:d})},g=>{postMessage({type:d,err:g})})},g=>{postMessage({type:d,err:g})});break;case"init-ep":{let{epName:g,env:l}=o;jr(l,g).then(()=>{postMessage({type:d})},b=>{postMessage({type:d,err:b})});break}case"copy-from":{let{buffer:g}=o,l=kt(g);postMessage({type:d,out:l});break}case"create":{let{model:g,options:l}=o;zr(g,l).then(b=>{postMessage({type:d,out:b})},b=>{postMessage({type:d,err:b})});break}case"release":Yr(o),postMessage({type:d});break;case"run":{let{sessionId:g,inputIndices:l,inputs:b,outputIndices:y,options:f}=o;qr(g,l,b,y,new Array(y.length).fill(null),f).then(M=>{M.some(D=>D[3]!=="cpu")?postMessage({type:d,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:d,out:M},Xr(M))},M=>{postMessage({type:d,err:M})});break}case"configure":try{let g=Gr(i.data.in);postMessage({type:"configure",out:g})}catch(g){postMessage({type:"configure",err:g})}break;case"auth":try{let g=Vr(i.data.in);postMessage({type:"auth",out:g})}catch(g){postMessage({type:"auth",err:g})}break;case"end-profiling":Jr(o),postMessage({type:d});break;default:}}catch(g){postMessage({type:d,err:g})}};})();\n'})),Yt,it,In,Mo,Go,ya,Ta,or,ir,Eg,Ro,cd,pd,dd,hd,md,bd,gd,yd,Td,xa=L((function(){var e;It(),ld(),Kr(),Yt=function(){return!!ee.wasm.proxy&&("undefined"===typeof document?"undefined":_typeof(document))<"u"},In=!1,Mo=!1,Go=!1,Ta=new Map,or=function(e,t){var n=Ta.get(e);n?n.push(t):Ta.set(e,[t])},ir=function(){if(In||!Mo||Go||!it)throw new Error("worker not ready")},Eg=function(e){switch(e.data.type){case"init-wasm":In=!1,e.data.err?(Go=!0,ya[1](e.data.err)):(Mo=!0,ya[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"run":case"end-profiling":var t=Ta.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out)}},Ro=("undefined"===typeof document?"undefined":_typeof(document))<"u"?null===(e=document)||void 0===e||null===(e=e.currentScript)||void 0===e?void 0:e.src:void 0,cd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Mo){e.next=21;break}if(!In){e.next=3;break}throw new Error("multiple calls to 'initWasm()' detected.");case 3:if(!Go){e.next=5;break}throw new Error("previous call to 'initWasm()' failed.");case 5:if(In=!0,!Yt()){e.next=7;break}return e.abrupt("return",(void 0===ee.wasm.wasmPaths&&Ro&&0!==Ro.indexOf("blob:")&&(ee.wasm.wasmPaths=Ro.substr(0,+Ro.lastIndexOf("/")+1)),new Promise((function(e,t){var n;null===(n=it)||void 0===n||n.terminate();var r=URL.createObjectURL(new Blob([fd()],{type:"text/javascript"}));(it=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=function(e){return t(e)},it.onmessage=Eg,URL.revokeObjectURL(r),ya=[e,t];var i={type:"init-wasm",in:ee};it.postMessage(i)}))));case 7:return e.prev=7,e.next=10,Vp(ee.wasm);case 10:return e.next=12,ed(ee);case 12:Mo=!0,e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(7),Go=!0,e.t0;case 18:return e.prev=18,In=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[7,15,18,21]])})));return function(){return e.apply(this,arguments)}}(),pd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yt()){e.next=2;break}return e.abrupt("return",(ir(),new Promise((function(e,n){or("init-ep",[e,n]);var r={type:"init-ep",in:{epName:t,env:ee}};it.postMessage(r)}))));case 2:return e.next=4,td(ee,t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),dd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yt()?(ir(),new Promise((function(e,n){or("copy-from",[e,n]);var r={type:"copy-from",in:{buffer:t}};it.postMessage(r,[t.buffer])}))):ga(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),hd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yt()){e.next=4;break}if(null===n||void 0===n||!n.preferredOutputLocation){e.next=3;break}throw new Error('session option "preferredOutputLocation" is not supported for proxy.');case 3:return e.abrupt("return",(ir(),new Promise((function(e,r){or("create",[e,r]);var i={type:"create",in:{model:t,options:n}},o=[];t instanceof Uint8Array&&o.push(t.buffer),it.postMessage(i,o)}))));case 4:return e.abrupt("return",rd(t,n));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),md=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yt()){e.next=2;break}return e.abrupt("return",(ir(),new Promise((function(e,n){or("release",[e,n]);var r={type:"release",in:t};it.postMessage(r)}))));case 2:nd(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yt()?(ir(),new Promise((function(e,n){or("configure",[e,n]);var r={type:"configure",in:t};it.postMessage(r)}))):od(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yt()?(ir(),new Promise((function(e,n){or("auth",[e,n]);var r={type:"auth",in:t};it.postMessage(r)}))):id(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yd=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i,o,a){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yt()){e.next=6;break}if(!r.some((function(e){return"cpu"!==e[3]}))){e.next=3;break}throw new Error("input tensor on GPU is not supported for proxy.");case 3:if(!o.some((function(e){return e}))){e.next=5;break}throw new Error("pre-allocated output tensor is not supported for proxy.");case 5:return e.abrupt("return",(ir(),new Promise((function(e,o){or("run",[e,o]);var s=r,u={type:"run",in:{sessionId:t,inputIndices:n,inputs:s,outputIndices:i,options:a}};it.postMessage(u,ud(s))}))));case 6:return e.abrupt("return",ad(t,n,r,i,o,a));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}(),Td=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yt()){e.next=2;break}return e.abrupt("return",(ir(),new Promise((function(e,n){or("end-profiling",[e,n]);var r={type:"end-profiling",in:t};it.postMessage(r)}))));case 2:sd(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),xd,Pg,Uo,wd=L((function(){It(),xa(),ma(),ba(),xd=function(e,t){switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error("invalid data location: ".concat(e.location," for ").concat(t()))}},Pg=function(e){switch(e[3]){case"cpu":return new Re(e[0],e[2],e[1]);case"gpu-buffer":var t=e[0];if(!No(t))throw new Error("not supported data type: ".concat(t," for deserializing GPU tensor"));var n=e[2],r=n.gpuBuffer,i=n.download,o=n.dispose;return Re.fromGpuBuffer(r,{dataType:t,dims:e[1],download:i,dispose:o});default:throw new Error("invalid data location: ".concat(e[3]))}},Uo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"fetchModelAndCopyToWasmMemory",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=dd,e.next=3,_n(t);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadModel",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(hr(),"string"!=typeof t){e.next=14;break}if(!(_typeof(process)<"u"&&process.versions&&process.versions.node)){e.next=8;break}return e.next=5,_n(t);case 5:e.t1=e.sent,e.next=11;break;case 8:return e.next=10,this.fetchModelAndCopyToWasmMemory(t);case 10:e.t1=e.sent;case 11:e.t0=e.t1,e.next=15;break;case 14:e.t0=t;case 15:return o=e.t0,e.next=18,hd(o,n);case 18:r=e.sent,i=_slicedToArray(r,3),this.sessionId=i[0],this.inputNames=i[1],this.outputNames=i[2],mr();case 24:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",md(this.sessionId));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bd(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"auth",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",gd(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u,c,l,h,f,d,p=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hr(),i=[],o=[],Object.entries(t).forEach((function(e){var t=e[0],n=e[1],r=p.inputNames.indexOf(t);if(-1===r)throw new Error("invalid input '".concat(t,"'"));i.push(n),o.push(r)})),a=[],s=[],Object.entries(n).forEach((function(e){var t=e[0],n=e[1],r=p.outputNames.indexOf(t);if(-1===r)throw new Error("invalid output '".concat(t,"'"));a.push(n),s.push(r)})),u=i.map((function(e,t){return xd(e,(function(){return'input "'.concat(p.inputNames[o[t]],'"')}))})),c=a.map((function(e,t){return e?xd(e,(function(){return'output "'.concat(p.outputNames[s[t]],'"')})):null})),e.next=9,yd(this.sessionId,o,u,s,c,r);case 9:for(l=e.sent,h={},f=0;f<l.length;f++)h[this.outputNames[s[f]]]=null!==(d=a[f])&&void 0!==d?d:Pg(l[f]);return e.abrupt("return",(mr(),h));case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"startProfiling",value:function(){}},{key:"endProfiling",value:function(){Td(this.sessionId)}}]),e}()})),Dg,zo,vd=L((function(){It(),xa(),wd(),Dg=function(){if(("number"!=typeof ee.wasm.initTimeout||ee.wasm.initTimeout<0)&&(ee.wasm.initTimeout=0),"boolean"!=typeof ee.wasm.simd&&(ee.wasm.simd=!0),"boolean"!=typeof ee.wasm.proxy&&(ee.wasm.proxy=!1),"boolean"!=typeof ee.wasm.trace&&(ee.wasm.trace=!1),"number"!=typeof ee.wasm.numThreads||!Number.isInteger(ee.wasm.numThreads)||ee.wasm.numThreads<=0){(("undefined"===typeof self?"undefined":_typeof(self))<"u"&&!self.crossOriginIsolated||_typeof(process)<"u"&&process.versions&&process.versions.node)&&(ee.wasm.numThreads=1);var e=("undefined"===typeof navigator?"undefined":_typeof(navigator))>"u"?(void 0)().length:navigator.hardwareConcurrency;ee.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},zo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Dg(),e.next=3,cd();case 3:return e.next=5,pd(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createInferenceSessionHandler",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Uo,e.next=3,r.loadModel(t,n);case 3:return e.abrupt("return",Promise.resolve(r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()})),_d={};kr(_d,{wasmBackend:function(){return Lg}});var Lg,Od=L((function(){vd(),Lg=new zo}));It(),It(),It();var Os="1.17.0",QO=Qo,e=(Pp(),fr(Ep)).onnxjsBackend;pr("webgl",e,-10);var _e222=(Od(),fr(_d)).wasmBackend;pr("cpu",_e222,10),pr("wasm",_e222,10),pr("webnn",_e222,9),Object.defineProperty(ee.versions,"web",{value:Os,enumerable:!0})}},__webpack_module_cache__={};function __nested_webpack_require_1427617__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__nested_webpack_require_1427617__),n.loaded=!0,n.exports}__nested_webpack_require_1427617__.m=__webpack_modules__,__nested_webpack_require_1427617__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __nested_webpack_require_1427617__.d(t,{a:t}),t},__nested_webpack_require_1427617__.d=function(e,t){for(var n in t)__nested_webpack_require_1427617__.o(t,n)&&!__nested_webpack_require_1427617__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__nested_webpack_require_1427617__.g=function(){if("object"==("undefined"===typeof globalThis?"undefined":_typeof(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==("undefined"===typeof window?"undefined":_typeof(window)))return window}}(),__nested_webpack_require_1427617__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__nested_webpack_require_1427617__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__nested_webpack_require_1427617__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},__nested_webpack_require_1427617__.b=document.baseURI||self.location.href;var __nested_webpack_exports__={};!function(e){__nested_webpack_require_1427617__.d(__nested_webpack_exports__,{O:function(){return jE}});var t={};__nested_webpack_require_1427617__.r(t),__nested_webpack_require_1427617__.d(t,{BaseTextureCache:function(){return Dt},BoundingBox:function(){return Pt},CanvasRenderTarget:function(){return Ft},DATA_URI:function(){return vt},EventEmitter:function(){return ve},ProgramCache:function(){return Rt},TextureCache:function(){return Bt},clearTextureCache:function(){return Lt},correctBlendMode:function(){return pt},createIndicesForQuads:function(){return wt},decomposeDataUri:function(){return zt},deprecation:function(){return _e},destroyTextureCache:function(){return Mt},detectVideoAlphaMode:function(){return Ee},determineCrossOrigin:function(){return Ht},earcut:function(){return we},getBufferType:function(){return bt},getCanvasBoundingBox:function(){return jt},getResolutionOfUrl:function(){return Vt},hex2rgb:function(){return ct},hex2string:function(){return lt},interleaveTypedArrays:function(){return _t},isMobile:function(){return me},isPow2:function(){return At},isWebGLSupported:function(){return Be},log2:function(){return Ct},nextPow2:function(){return It},path:function(){return Te},premultiplyBlendMode:function(){return dt},premultiplyRgba:function(){return yt},premultiplyTint:function(){return gt},premultiplyTintToRgba:function(){return mt},removeItems:function(){return kt},rgb2hex:function(){return ft},sayHello:function(){return Re},sign:function(){return St},skipHello:function(){return Pe},string2hex:function(){return ht},trimCanvas:function(){return Gt},uid:function(){return Et},url:function(){return Ie}});var n={};__nested_webpack_require_1427617__.r(n),__nested_webpack_require_1427617__.d(n,{ALPHA_MODES:function(){return V},AbstractMultiResource:function(){return Ki},AccessibilityManager:function(){return Ho},AlphaFilter:function(){return wo},AnimatedSprite:function(){return Qu},Application:function(){return Wo},ArrayResource:function(){return Xi},Assets:function(){return Ra},AssetsClass:function(){return Pa},Attribute:function(){return fn},BLEND_MODES:function(){return M},BUFFER_BITS:function(){return D},BUFFER_TYPE:function(){return q},BackgroundSystem:function(){return yr},BaseImageResource:function(){return xr},BasePrepare:function(){return Yu},BaseRenderTexture:function(){return br},BaseTexture:function(){return un},BatchDrawCall:function(){return cn},BatchGeometry:function(){return vn},BatchRenderer:function(){return fr},BatchShaderGenerator:function(){return ur},BatchSystem:function(){return gr},BatchTextureArray:function(){return cr},BitmapFont:function(){return bc},BitmapFontData:function(){return lc},BitmapText:function(){return Cc},BlobResource:function(){return Qa},BlurFilter:function(){return Io},BlurFilterPass:function(){return _o},Bounds:function(){return ao},BrowserAdapter:function(){return J},Buffer:function(){return hn},BufferResource:function(){return on},BufferSystem:function(){return Vi},CLEAR_MODES:function(){return W},COLOR_MASK_BITS:function(){return X},Cache:function(){return qo},CanvasResource:function(){return Zi},Circle:function(){return kn},Color:function(){return ut},ColorMatrixFilter:function(){return Ao},CompressedTextureResource:function(){return es},Container:function(){return fo},ContextSystem:function(){return vr},CountLimiter:function(){return Nu},CubeResource:function(){return Ji},DEG_TO_RAD:function(){return xn},DRAW_MODES:function(){return L},DisplacementFilter:function(){return Co},DisplayObject:function(){return so},ENV:function(){return R},Ellipse:function(){return Sn},EventBoundary:function(){return Lo},EventSystem:function(){return Uo},ExtensionType:function(){return Wt},Extract:function(){return Ds},FORMATS:function(){return F},FORMATS_TO_COMPONENTS:function(){return Cs},FXAAFilter:function(){return ko},FederatedDisplayObject:function(){return Go},FederatedEvent:function(){return Oo},FederatedMouseEvent:function(){return Po},FederatedPointerEvent:function(){return Ro},FederatedWheelEvent:function(){return Bo},FillStyle:function(){return iu},Filter:function(){return pr},FilterState:function(){return Pr},FilterSystem:function(){return Dr},Framebuffer:function(){return wr},FramebufferSystem:function(){return Fr},GC_MODES:function(){return $},GLFramebuffer:function(){return Mr},GLProgram:function(){return ai},GLTexture:function(){return Ei},GRAPHICS_CURVES:function(){return Hs},GenerateTextureSystem:function(){return ti},Geometry:function(){return mn},GeometrySystem:function(){return Ur},Graphics:function(){return uu},GraphicsData:function(){return Qs},GraphicsGeometry:function(){return ru},HTMLText:function(){return Pc},HTMLTextStyle:function(){return Ec},IGLUniformData:function(){return oi},INSTALLED:function(){return en},INTERNAL_FORMATS:function(){return Xa},INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:function(){return Za},ImageBitmapResource:function(){return Qi},ImageResource:function(){return _r},LINE_CAP:function(){return Gs},LINE_JOIN:function(){return js},LineStyle:function(){return ou},LoaderParserPriority:function(){return ea},MASK_TYPES:function(){return K},MIPMAP_MODES:function(){return H},MSAA_QUALITY:function(){return Z},MaskData:function(){return Hr},MaskSystem:function(){return Vr},Matrix:function(){return On},Mesh:function(){return pu},MeshBatchUvs:function(){return lu},MeshGeometry:function(){return yu},MeshMaterial:function(){return gu},MultisampleSystem:function(){return zi},NineSlicePlane:function(){return bu},NoiseFilter:function(){return So},ObjectRenderer:function(){return lr},ObjectRendererSystem:function(){return Wi},ObservablePoint:function(){return Un},PI_2:function(){return wn},PRECISION:function(){return Y},ParticleContainer:function(){return Iu},ParticleRenderer:function(){return Cu},PlaneGeometry:function(){return mu},PluginSystem:function(){return qr},Point:function(){return In},Polygon:function(){return Tn},Prepare:function(){return qu},Program:function(){return ir},ProjectionSystem:function(){return Jr},Quad:function(){return Er},QuadUv:function(){return Or},RAD_TO_DEG:function(){return bn},RENDERER_TYPE:function(){return B},Rectangle:function(){return Cn},RenderTexture:function(){return Sr},RenderTexturePool:function(){return Tr},RenderTextureSystem:function(){return ii},Renderer:function(){return Yi},ResizePlugin:function(){return $o},Resource:function(){return rn},RopeGeometry:function(){return vu},RoundedRectangle:function(){return En},Runner:function(){return nn},SAMPLER_TYPES:function(){return j},SCALE_MODES:function(){return G},SHAPES:function(){return _n},SVGResource:function(){return to},ScissorSystem:function(){return Xr},Shader:function(){return sr},ShaderSystem:function(){return _i},SimpleMesh:function(){return xu},SimplePlane:function(){return wu},SimpleRope:function(){return _u},Sprite:function(){return go},SpriteMaskFilter:function(){return zr},Spritesheet:function(){return ac},StartupSystem:function(){return Ii},State:function(){return Qt},StateSystem:function(){return Ci},StencilSystem:function(){return Zr},SystemManager:function(){return ki},TARGETS:function(){return N},TEXT_GRADIENT:function(){return ku},TYPES:function(){return U},TYPES_TO_BYTES_PER_COMPONENT:function(){return As},TYPES_TO_BYTES_PER_PIXEL:function(){return ks},TemporaryDisplayObject:function(){return uo},Text:function(){return Fu},TextFormat:function(){return hc},TextMetrics:function(){return Eu},TextStyle:function(){return Ru},Texture:function(){return kr},TextureGCSystem:function(){return Ti},TextureMatrix:function(){return Gr},TextureSystem:function(){return Oi},TextureUvs:function(){return Ir},Ticker:function(){return Li},TickerPlugin:function(){return Fi},TilingSprite:function(){return tc},TilingSpriteRenderer:function(){return ic},TimeLimiter:function(){return Ju},Transform:function(){return Gn},TransformFeedback:function(){return io},TransformFeedbackSystem:function(){return Pi},UPDATE_PRIORITY:function(){return Bi},UniformGroup:function(){return ar},VERSION:function(){return oo},VideoResource:function(){return ro},ViewSystem:function(){return Ri},ViewableBuffer:function(){return Xt},WRAP_MODES:function(){return z},XMLFormat:function(){return fc},XMLStringFormat:function(){return dc},accessibleTarget:function(){return zo},autoDetectFormat:function(){return yc},autoDetectRenderer:function(){return Ui},autoDetectResource:function(){return tn},cacheTextureArray:function(){return Ba},checkDataUrl:function(){return ta},checkExtension:function(){return Xo},checkMaxIfStatementsInShader:function(){return Jt},convertToList:function(){return Zo},copySearchParams:function(){return Ka},createStringVariations:function(){return Ea},createTexture:function(){return va},createUBOElements:function(){return gi},curves:function(){return zs},defaultFilterVertex:function(){return Gi},defaultVertex:function(){return ji},detectAvif:function(){return La},detectCompressedTextures:function(){return Ja},detectDefaults:function(){return Ua},detectMp4:function(){return Ha},detectOgv:function(){return Va},detectWebm:function(){return za},detectWebp:function(){return Fa},extensions:function(){return Kt},filters:function(){return To},generateProgram:function(){return hi},generateUniformBufferSync:function(){return vi},getFontFamilyName:function(){return ua},getTestContext:function(){return Kn},getUBOData:function(){return mi},graphicsUtils:function(){return cu},groupD8:function(){return Nn},isMobile:function(){return me},isSingleItem:function(){return Jo},loadBitmapFont:function(){return Sc},loadDDS:function(){return Es},loadImageBitmap:function(){return xa},loadJson:function(){return na},loadKTX:function(){return Os},loadSVG:function(){return Aa},loadTextures:function(){return Ia},loadTxt:function(){return ra},loadVideo:function(){return Sa},loadWebFont:function(){return la},parseDDS:function(){return ws},parseKTX:function(){return Ss},resolveCompressedTextureUrl:function(){return Ps},resolveTextureUrl:function(){return Wa},settings:function(){return Q},spritesheetAsset:function(){return cc},uniformParsers:function(){return Hn},unsafeEvalSupported:function(){return wi},utils:function(){return t}});var r=__nested_webpack_require_1427617__(1140),i=__nested_webpack_require_1427617__(9328);function o(e){return o="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},o(e)}function a(){a=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,a=Object.create(o.prototype),s=new R(r||[]);return i(a,"_invoke",{value:T(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",y="suspendedYield",g="executing",m="completed",v={};function w(){}function b(){}function x(){}var _={};h(_,u,(function(){return this}));var I=Object.getPrototypeOf,A=I&&I(I(B([])));A&&A!==n&&r.call(A,u)&&(_=A);var C=x.prototype=w.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,a,s,u){var c=d(e[i],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==o(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(h).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function T(t,n,r){var i=p;return function(o,a){if(i===g)throw new Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=E(s,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=g;var c=d(t,n,r);if("normal"===c.type){if(i=r.done?m:y,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=m,r.method="throw",r.arg=c.arg)}}}function E(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=d(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function B(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(o(t)+" is not iterable")}return b.prototype=x,i(C,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:b,configurable:!0}),b.displayName=h(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,h(e,l,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},k(S.prototype),h(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new S(f(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(C),h(C,l,"Generator"),h(C,u,(function(){return this})),h(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=B,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:B(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function s(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:String(t)}function l(e,t,n){return t=f(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}(e,h()?Reflect.construct(t,n||[],f(e).constructor):t.apply(e,n))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}var y,g,m,v=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},w=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},b=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=l(this,t),y.set(d(e),void 0),g.set(d(e),2),m.set(d(e),0),e.width=0,e.height=0,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(t,e),n=t,r=[{key:"setSkipCount",value:function(e){v(this,g,e,"f")}},{key:"set",value:function(e){var t=this;e instanceof MediaStream?v(this,y,e.getVideoTracks()[0],"f"):v(this,y,e,"f"),null!=w(this,y,"f").getSettings().width&&(this.width=w(this,y,"f").getSettings().width),null!=w(this,y,"f").getSettings().height&&(this.height=w(this,y,"f").getSettings().height),w(this,y,"f").onended&&(w(this,y,"f").onended=function(){return t.emit("ended",t)})}},{key:"stop",value:function(){w(this,y,"f")&&w(this,y,"f").stop()}},{key:"update",value:function(e,t){var n;if(w(this,y,"f")&&(v(this,m,(n=w(this,m,"f"),++n),"f"),!(w(this,m,"f")%w(this,g,"f")))){var r=!1;if(!e&&!t){var i=w(this,y,"f").getSettings();i.width,i.height}this.width!=e&&(r=!0,this.width=e),this.height!=t&&(r=!0,this.height=t),r&&this.emit("update",this)}}},{key:"getSettings",value:function(e){return w(this,y,"f"),e||(e={width:this.width,height:this.height,aspectRatio:this.width/this.height}),Object.assign(w(this,y,"f").getSettings(),e)}},{key:"getConstraints",value:function(e){return w(this,y,"f"),e||(e={width:this.width,height:this.height}),Object.assign(w(this,y,"f").getConstraints(),e)}},{key:"getCapabilities",value:function(e){return w(this,y,"f"),Object.assign(w(this,y,"f").getCapabilities(),e)}},{key:"applyConstraints",value:(i=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,u,"next",e)}function u(e){s(o,r,i,a,u,"throw",e)}a(void 0)}))}}(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w(this,y,"f")){e.next=2;break}return e.abrupt("return");case 2:w(this,y,"f").applyConstraints(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}],r&&u(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(i);function x(e){return x="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},x(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function A(e,t,n){return t&&I(e.prototype,t),n&&I(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function C(e){var t=function(e){if("object"!=x(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==x(t)?t:String(t)}y=new WeakMap,g=new WeakMap,m=new WeakMap;var k=function(){function e(){_(this,e),this.frame_count=30,this.frames=[1]}return A(e,[{key:"start",value:function(){this.t0=performance.now()}},{key:"finish",value:function(){var e=performance.now()-this.t0;this.frames.push(e),this.frames.length>this.frame_count&&this.frames.shift()}},{key:"getFrameFps",value:function(){var e=this.frames.reduce((function(e,t){return e+t}),0);return 0==e||isNaN(e)?1:Math.round(1e3/(e/this.frame_count))}},{key:"getFrameDuration",value:function(){return Math.round(1e6/this.getFrameFps())}},{key:"getFrameTime",value:function(){return Math.round(this.frames.reduce((function(e,t){return e+t}),0)/this.frame_count)}}]),e}(),S=function(){function e(){_(this,e),this.pattern="Output FPS: {{output_fps}}\nFrame Draw Time: {{frame_time}}ms\nInference Time: {{inference_time}}ms",this.stats=new Map}return A(e,[{key:"updateStats",value:function(e,t){return this.stats.set(e,t),!0}},{key:"getText",value:function(){var e=this.pattern;return this.stats.forEach((function(t,n){e=e.replaceAll("{{"+n+"}}",t.toString())})),e}}]),e}();function T(e){return T="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},T(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function O(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:String(t)}var P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=null,this.stream=null,this.videoTrack=null,this.audioTrack=null,this.transformFrame=null,this.updateVideoTrack=null,this.toCanvas=null,this.lastFrameTime=0,this.fpsLimit=30,this.timestamp=0,this.isRunning=!1,this.isPaused=!1,this.sdkOptions=t,this.outputCanvas=document.createElement("canvas"),this.outputCanvas.width=this.sdkOptions.width,this.outputCanvas.height=this.sdkOptions.height,this.bufferCanvas=document.createElement("canvas"),this.bufferCanvas.width=this.sdkOptions.width,this.bufferCanvas.height=this.sdkOptions.height,this.frameTimer=new k,this.frameTime=0,this.fps=0,this.enableFps=!1,this.frame_count=0,this.videoTrackWrapper=new b,this.videoTrackWrapper.on("update",this.onTrackUpdate,this)}var t,n;return t=e,n=[{key:"onTrackUpdate",value:function(){this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height),"function"==typeof this.changeInputResolutionFuncition&&this.changeInputResolutionFuncition()}},{key:"clearBuffers",value:function(){}},{key:"onChangeInputResolution",value:function(e){var t="function"==typeof e;this.changeInputResolutionFuncition=t?e:void 0}},{key:"onFrameDraw",value:function(e){var t="function"==typeof e;this.frameDrawFunction=t?e:void 0}},{key:"setOutputResolution",value:function(e,t){this.sdkOptions.setCustomSize(e,t)}},{key:"clearOutputResolution",value:function(){this.sdkOptions.customSize=!1,this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height)}},{key:"useEffectProcessor",value:function(e){this.effectProcessor=e}},{key:"pause",value:function(){this.isPaused=!0}},{key:"unpause",value:function(){this.isPaused=!1}},{key:"setRenderer",value:function(e){this.renderer=e}},{key:"destroy",value:function(){this.videoTrackWrapper.off("update",this.onTrackUpdate,this)}},{key:"setFpsLimit",value:function(e){var t;this.fpsLimit=e,null===(t=this.getInputVideoTrack())||void 0===t||t.applyConstraints({frameRate:this.fpsLimit})}},{key:"useStream",value:function(e){this.stream=e,this.useVideoTrack(this.stream.getVideoTracks()[0])}},{key:"useVideoTrack",value:function(e){this.videoTrack=e,this.videoTrackWrapper.set(this.videoTrack)}},{key:"getInputStream",value:function(){return this.stream?this.stream:null}},{key:"getInputVideoTrack",value:function(){return this.videoTrack?this.videoTrack:null}},{key:"showFps",value:function(){this.enableFps=!0}},{key:"hideFps",value:function(){this.enableFps=!1,this.renderer.hideStatistics()}},{key:"drawFps",value:function(){this.enableFps&&this.frame_count%30==0&&(this.renderer.updateStatistics("output_fps",this.frameTimer.getFrameFps()),this.renderer.drawStatistics())}},{key:"process",value:function(){this.transformFrame&&this.transformFrame()}},{key:"clearTransformCallback",value:function(){this.transformFrame=null}},{key:"transformCallback",value:function(e){this.transformFrame=e}},{key:"renderToCanvas",value:function(e){this.toCanvas=e}},{key:"getCanvas",value:function(){return this.outputCanvas}},{key:"getStream",value:function(){return this.stream}}],n&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),R=function(e){return e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e}(R||{}),B=function(e){return e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e}(B||{}),D=function(e){return e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e}(D||{}),M=function(e){return e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e}(M||{}),L=function(e){return e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e}(L||{}),F=function(e){return e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e}(F||{}),N=function(e){return e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e}(N||{}),U=function(e){return e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e}(U||{}),j=function(e){return e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e}(j||{}),G=function(e){return e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e}(G||{}),z=function(e){return e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e}(z||{}),H=function(e){return e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e}(H||{}),V=function(e){return e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e}(V||{}),W=function(e){return e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e}(W||{}),$=function(e){return e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e}($||{}),Y=function(e){return e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e}(Y||{}),K=function(e){return e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e}(K||{}),X=function(e){return e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e}(X||{}),Z=function(e){return e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e}(Z||{}),q=function(e){return e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e}(q||{}),J={createCanvas:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n},getCanvasRenderingContext2D:function(){return CanvasRenderingContext2D},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var e;return null!==(e=document.baseURI)&&void 0!==e?e:window.location.href},getFontFaceSet:function(){return document.fonts},fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)})),parseXML:function(e){return(new DOMParser).parseFromString(e,"text/xml")}},Q={ADAPTER:J,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},ee=/iPhone/i,te=/iPod/i,ne=/iPad/i,re=/\biOS-universal(?:.+)Mac\b/i,ie=/\bAndroid(?:.+)Mobile\b/i,oe=/Android/i,ae=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,se=/Silk/i,ue=/Windows Phone/i,ce=/\bWindows(?:.+)ARM\b/i,le=/BlackBerry/i,he=/BB10/i,fe=/Opera Mini/i,de=/\b(CriOS|Chrome)(?:.+)Mobile/i,pe=/Mobile(?:.+)Firefox\b/i,ye=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function ge(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=t.userAgent,r=n.split("[FBAN");void 0!==r[1]&&(n=r[0]),void 0!==(r=n.split("Twitter"))[1]&&(n=r[0]);var i=function(e){return function(t){return t.test(e)}}(n),o={apple:{phone:i(ee)&&!i(ue),ipod:i(te),tablet:!i(ee)&&(i(ne)||ye(t))&&!i(ue),universal:i(re),device:(i(ee)||i(te)||i(ne)||i(re)||ye(t))&&!i(ue)},amazon:{phone:i(ae),tablet:!i(ae)&&i(se),device:i(ae)||i(se)},android:{phone:!i(ue)&&i(ae)||!i(ue)&&i(ie),tablet:!i(ue)&&!i(ae)&&!i(ie)&&(i(se)||i(oe)),device:!i(ue)&&(i(ae)||i(se)||i(ie)||i(oe))||i(/\bokhttp\b/i)},windows:{phone:i(ue),tablet:i(ce),device:i(ue)||i(ce)},other:{blackberry:i(le),blackberry10:i(he),opera:i(fe),firefox:i(pe),chrome:i(de),device:i(le)||i(he)||i(fe)||i(pe)||i(de)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}var me=(null!==(e=ge.default)&&void 0!==e?e:ge)(globalThis.navigator);Q.RETINA_PREFIX=/@([0-9\.]+)x/,Q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ve=__nested_webpack_require_1427617__(4912),we=__nested_webpack_require_1427617__(1948),be=__nested_webpack_require_1427617__(4776),xe={};function _e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(!xe[t]){var r=(new Error).stack;_typeof(r)>"u"?console.warn("PixiJS Deprecation Warning: ","".concat(t,"\nDeprecated since v").concat(e)):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6","".concat(t,"\nDeprecated since v").concat(e)),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ","".concat(t,"\nDeprecated since v").concat(e)),console.warn(r))),xe[t]=!0}}var Ie={get parse(){return _e("7.3.0","utils.url.parse is deprecated, use native URL API instead."),be.K0},get format(){return _e("7.3.0","utils.url.format is deprecated, use native URL API instead."),be.E9},get resolve(){return _e("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),be.WI}};function Ae(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received ".concat(JSON.stringify(e)))}function Ce(e){return e.split("?")[0].split("#")[0]}var ke,Se,Te={toPosix:function(e){return e.replace(new RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")},isUrl:function(e){return/^https?:/.test(this.toPosix(e))},isDataUrl:function(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},isBlobUrl:function(e){return e.startsWith("blob:")},hasProtocol:function(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol:function(e){Ae(e),e=this.toPosix(e);var t=/^file:\/\/\//.exec(e);if(t)return t[0];var n=/^[^/:]+:\/{0,2}/.exec(e);return n?n[0]:""},toAbsolute:function(e,t,n){if(Ae(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;var r=Ce(this.toPosix(null!==t&&void 0!==t?t:Q.ADAPTER.getBaseUrl())),i=Ce(this.toPosix(null!==n&&void 0!==n?n:this.rootname(r)));return(e=this.toPosix(e)).startsWith("/")?Te.join(i,e.slice(1)):this.isAbsolute(e)?e:this.join(r,e)},normalize:function(e){if(Ae(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;var t="",n=(e=this.toPosix(e)).startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));var r=e.endsWith("/");return e=function(e){for(var t="",n=0,r=-1,i=0,o=-1,a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(47===o)break;o=47}if(47===o){if(r!==a-1&&1!==i)if(r!==a-1&&2===i){if(t.length<2||2!==n||46!==t.charCodeAt(t.length-1)||46!==t.charCodeAt(t.length-2))if(t.length>2){var s=t.lastIndexOf("/");if(s!==t.length-1){-1===s?(t="",n=0):n=(t=t.slice(0,s)).length-1-t.lastIndexOf("/"),r=a,i=0;continue}}else if(2===t.length||1===t.length){t="",n=0,r=a,i=0;continue}}else t.length>0?t+="/".concat(e.slice(r+1,a)):t=e.slice(r+1,a),n=a-r-1;r=a,i=0}else 46===o&&-1!==i?++i:i=-1}return t}(e),e.length>0&&r&&(e+="/"),n?"/".concat(e):t+e},isAbsolute:function(e){return Ae(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var n=t<0||arguments.length<=t?void 0:arguments[t];if(Ae(n),n.length>0)if(void 0===e)e=n;else{var r,i=null!==(r=t-1<0||arguments.length<=t-1?void 0:arguments[t-1])&&void 0!==r?r:"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+="/../".concat(n):e+="/".concat(n)}}return void 0===e?".":this.normalize(e)},dirname:function(e){if(Ae(e),0===e.length)return".";for(var t=(e=this.toPosix(e)).charCodeAt(0),n=47===t,r=-1,i=!0,o=this.getProtocol(e),a=e,s=(e=e.slice(o.length)).length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!i){r=s;break}}else i=!1;return-1===r?n?"/":this.isUrl(a)?o+e:o:n&&1===r?"//":o+e.slice(0,r)},rootname:function(e){Ae(e);var t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){var n=e.indexOf("/",t.length);(t=-1!==n?e.slice(0,n):e).endsWith("/")||(t+="/")}return t},basename:function(e,t){Ae(e),t&&Ae(t),e=Ce(this.toPosix(e));var n,r=0,i=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,s=-1;for(n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(47===u){if(!o){r=n+1;break}}else-1===s&&(o=!1,s=n+1),a>=0&&(u===t.charCodeAt(a)?-1==--a&&(i=n):(a=-1,i=s))}return r===i?i=s:-1===i&&(i=e.length),e.slice(r,i)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!o){r=n+1;break}}else-1===i&&(o=!1,i=n+1);return-1===i?"":e.slice(r,i)},extname:function(e){Ae(e);for(var t=-1,n=0,r=-1,i=!0,o=0,a=(e=Ce(this.toPosix(e))).length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===r&&(i=!1,r=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){n=a+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)},parse:function(e){Ae(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var n,r=(e=Ce(this.toPosix(e))).charCodeAt(0),i=this.isAbsolute(e);t.root=this.rootname(e),n=i||this.hasProtocol(e)?1:0;for(var o=-1,a=0,s=-1,u=!0,c=e.length-1,l=0;c>=n;--c)if(47!==(r=e.charCodeAt(c)))-1===s&&(u=!1,s=c+1),46===r?-1===o?o=c:1!==l&&(l=1):-1!==o&&(l=-1);else if(!u){a=c+1;break}return-1===o||-1===s||0===l||1===l&&o===s-1&&o===a+1?-1!==s&&(t.base=t.name=0===a&&i?e.slice(1,s):e.slice(a,s)):(0===a&&i?(t.name=e.slice(1,o),t.base=e.slice(1,s)):(t.name=e.slice(a,o),t.base=e.slice(a,s)),t.ext=e.slice(o,s)),t.dir=this.dirname(e),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Ee(){return Oe.apply(this,arguments)}function Oe(){return Oe=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(null!==(t=ke)&&void 0!==t||(ke=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,i,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.createElement("canvas").getContext("webgl")){e.next=3;break}return e.abrupt("return",V.UNPACK);case 3:return e.next=5,new Promise((function(e){var t=document.createElement("video");t.onloadeddata=function(){return e(t)},t.onerror=function(){return e(null)},t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load()}));case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return",V.UNPACK);case 8:return i=n.createTexture(),n.bindTexture(n.TEXTURE_2D,i),o=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,i,0),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),a=new Uint8Array(4),e.abrupt("return",(n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,a),n.deleteFramebuffer(o),n.deleteTexture(i),null!==(t=n.getExtension("WEBGL_lose_context"))&&void 0!==t&&t.loseContext(),a[0]<=a[3]?V.PMA:V.UNPACK));case 14:case"end":return e.stop()}}),e)})))()),ke));case 1:case"end":return e.stop()}}),e)}))),Oe.apply(this,arguments)}function Pe(){_e("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Re(){_e("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option')}function Be(){return _typeof(Se)>"u"&&(Se=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:Q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{var t;if(!Q.ADAPTER.getWebGLRenderingContext())return!1;var n=Q.ADAPTER.createCanvas(),r=n.getContext("webgl",e)||n.getContext("experimental-webgl",e),i=!(null===(t=r)||void 0===t||null===(t=t.getContextAttributes())||void 0===t||!t.stencil);if(r){var o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,i}catch(a){return!1}}()),Se}var De={grad:.9,turn:360,rad:360/(2*Math.PI)},Me=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},Le=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n+0},Fe=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e>t?e:t},Ne=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Ue=function(e){return{r:Fe(e.r,0,255),g:Fe(e.g,0,255),b:Fe(e.b,0,255),a:Fe(e.a)}},je=function(e){return{r:Le(e.r),g:Le(e.g),b:Le(e.b),a:Le(e.a,3)}},Ge=/^#([0-9a-f]{3,8})$/i,ze=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},He=function(e){var t=e.r,n=e.g,r=e.b,i=e.a,o=Math.max(t,n,r),a=o-Math.min(t,n,r),s=a?o===t?(n-r)/a:o===n?2+(r-t)/a:4+(t-n)/a:0;return{h:60*(s<0?s+6:s),s:o?a/o*100:0,v:o/255*100,a:i}},Ve=function(e){var t=e.h,n=e.s,r=e.v,i=e.a;t=t/360*6,n/=100,r/=100;var o=Math.floor(t),a=r*(1-n),s=r*(1-(t-o)*n),u=r*(1-(1-t+o)*n),c=o%6;return{r:255*[r,s,a,a,u,r][c],g:255*[u,r,r,s,a,a][c],b:255*[a,a,u,r,r,s][c],a:i}},We=function(e){return{h:Ne(e.h),s:Fe(e.s,0,100),l:Fe(e.l,0,100),a:Fe(e.a)}},$e=function(e){return{h:Le(e.h),s:Le(e.s),l:Le(e.l),a:Le(e.a,3)}},Ye=function(e){return Ve((n=(t=e).s,{h:t.h,s:(n*=((r=t.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:t.a}));var t,n,r},Ke=function(e){return{h:(t=He(e)).h,s:(i=(200-(n=t.s))*(r=t.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,n,r,i},Xe=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ze=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,qe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Je=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Qe={string:[[function(e){var t=Ge.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?Le(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?Le(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=qe.exec(e)||Je.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Ue({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=Xe.exec(e)||Ze.exec(e);if(!t)return null;var n,r,i=We({h:(n=t[1],r=t[2],void 0===r&&(r="deg"),Number(n)*(De[r]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return Ye(i)},"hsl"]],object:[[function(e){var t=e.r,n=e.g,r=e.b,i=e.a,o=void 0===i?1:i;return Me(t)&&Me(n)&&Me(r)?Ue({r:Number(t),g:Number(n),b:Number(r),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,n=e.s,r=e.l,i=e.a,o=void 0===i?1:i;if(!Me(t)||!Me(n)||!Me(r))return null;var a=We({h:Number(t),s:Number(n),l:Number(r),a:Number(o)});return Ye(a)},"hsl"],[function(e){var t=e.h,n=e.s,r=e.v,i=e.a,o=void 0===i?1:i;if(!Me(t)||!Me(n)||!Me(r))return null;var a=function(e){return{h:Ne(e.h),s:Fe(e.s,0,100),v:Fe(e.v,0,100),a:Fe(e.a)}}({h:Number(t),s:Number(n),v:Number(r),a:Number(o)});return Ve(a)},"hsv"]]},et=function(e,t){for(var n=0;n<t.length;n++){var r=t[n][0](e);if(r)return[r,t[n][1]]}return[null,void 0]},tt=function(e,t){var n=Ke(e);return{h:n.h,s:Fe(n.s+100*t,0,100),l:n.l,a:n.a}},nt=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},rt=function(e,t){var n=Ke(e);return{h:n.h,s:n.s,l:Fe(n.l+100*t,0,100),a:n.a}},it=function(){function e(e){this.parsed=function(e){return"string"==typeof e?et(e.trim(),Qe.string):"object"==_typeof(e)&&null!==e?et(e,Qe.object):[null,void 0]}(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return Le(nt(this.rgba),2)},e.prototype.isDark=function(){return nt(this.rgba)<.5},e.prototype.isLight=function(){return nt(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=je(this.rgba)).r,n=e.g,r=e.b,o=(i=e.a)<1?ze(Le(255*i)):"","#"+ze(t)+ze(n)+ze(r)+o;var e,t,n,r,i,o},e.prototype.toRgb=function(){return je(this.rgba)},e.prototype.toRgbString=function(){return t=(e=je(this.rgba)).r,n=e.g,r=e.b,(i=e.a)<1?"rgba("+t+", "+n+", "+r+", "+i+")":"rgb("+t+", "+n+", "+r+")";var e,t,n,r,i},e.prototype.toHsl=function(){return $e(Ke(this.rgba))},e.prototype.toHslString=function(){return t=(e=$e(Ke(this.rgba))).h,n=e.s,r=e.l,(i=e.a)<1?"hsla("+t+", "+n+"%, "+r+"%, "+i+")":"hsl("+t+", "+n+"%, "+r+"%)";var e,t,n,r,i},e.prototype.toHsv=function(){return e=He(this.rgba),{h:Le(e.h),s:Le(e.s),v:Le(e.v),a:Le(e.a,3)};var e},e.prototype.invert=function(){return ot({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),ot(tt(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),ot(tt(this.rgba,-e))},e.prototype.grayscale=function(){return ot(tt(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),ot(rt(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),ot(rt(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?ot({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):Le(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=Ke(this.rgba);return"number"==typeof e?ot({h:e,s:t.s,l:t.l,a:t.a}):Le(t.h)},e.prototype.isEqual=function(e){return this.toHex()===ot(e).toHex()},e}(),ot=function(e){return e instanceof it?e:new it(e)},at=[];!function(e){e.forEach((function(e){at.indexOf(e)<0&&(e(it,Qe),at.push(e))}))}([function(e,t){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var o={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,a,s=r[this.toHex()];if(s)return s;if(null==t?void 0:t.closest){var u=this.toRgb(),c=1/0,l="black";if(!o.length)for(var h in n)o[h]=new e(n[h]).toRgb();for(var f in n){var d=(i=u,a=o[f],Math.pow(i.r-a.r,2)+Math.pow(i.g-a.g,2)+Math.pow(i.b-a.b,2));d<c&&(c=d,l=f)}return l}},t.string.push([function(t){var r=t.toLowerCase(),i="transparent"===r?"#0000":n[r];return i?new e(i).toRgb():null},"name"])}]);var st=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16777215;_classCallCheck(this,e),this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}return _createClass(e,[{key:"red",get:function(){return this._components[0]}},{key:"green",get:function(){return this._components[1]}},{key:"blue",get:function(){return this._components[2]}},{key:"alpha",get:function(){return this._components[3]}},{key:"setValue",value:function(e){return this.value=e,this}},{key:"value",get:function(){return this._value},set:function(t){if(t instanceof e)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}},{key:"cloneSource",value:function(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"==_typeof(e)&&null!==e?_objectSpread({},e):e}},{key:"isSourceEqual",value:function(e,t){var n=_typeof(e);if(n!==_typeof(t))return!1;if("number"===n||"string"===n||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length&&e.every((function(e,n){return e===t[n]}));if(null!==e&&null!==t){var r=Object.keys(e),i=Object.keys(t);return r.length===i.length&&r.every((function(n){return e[n]===t[n]}))}return e===t}},{key:"toRgba",value:function(){var e=_slicedToArray(this._components,4);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},{key:"toRgb",value:function(){var e=_slicedToArray(this._components,3);return{r:e[0],g:e[1],b:e[2]}}},{key:"toRgbaString",value:function(){var e=_slicedToArray(this.toUint8RgbArray(),3),t=e[0],n=e[1],r=e[2];return"rgba(".concat(t,",").concat(n,",").concat(r,",").concat(this.alpha,")")}},{key:"toUint8RgbArray",value:function(e){var t,n=_slicedToArray(this._components,3),r=n[0],i=n[1],o=n[2];return(e=null!==(t=e)&&void 0!==t?t:[])[0]=Math.round(255*r),e[1]=Math.round(255*i),e[2]=Math.round(255*o),e}},{key:"toRgbArray",value:function(e){var t;e=null!==(t=e)&&void 0!==t?t:[];var n=_slicedToArray(this._components,3),r=n[0],i=n[1],o=n[2];return e[0]=r,e[1]=i,e[2]=o,e}},{key:"toNumber",value:function(){return this._int}},{key:"toLittleEndianNumber",value:function(){var e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}},{key:"multiply",value:function(t){var n=_slicedToArray(e.temp.setValue(t)._components,4),r=n[0],i=n[1],o=n[2],a=n[3];return this._components[0]*=r,this._components[1]*=i,this._components[2]*=o,this._components[3]*=a,this.refreshInt(),this._value=null,this}},{key:"premultiply",value:function(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}},{key:"toPremultiplied",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(1===e)return(255<<24)+this._int;if(0===e)return t?0:this._int;var n=this._int>>16&255,r=this._int>>8&255,i=255&this._int;return t&&(n=n*e+.5|0,r=r*e+.5|0,i=i*e+.5|0),(255*e<<24)+(n<<16)+(r<<8)+i}},{key:"toHex",value:function(){var e=this._int.toString(16);return"#".concat("000000".substring(0,6-e.length)+e)}},{key:"toHexa",value:function(){var e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}},{key:"setAlpha",value:function(e){return this._components[3]=this._clamp(e),this}},{key:"round",value:function(e){var t=_slicedToArray(this._components,3),n=t[0],r=t[1],i=t[2];return this._components[0]=Math.round(n*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}},{key:"toArray",value:function(e){var t;e=null!==(t=e)&&void 0!==t?t:[];var n=_slicedToArray(this._components,4),r=n[0],i=n[1],o=n[2],a=n[3];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e}},{key:"normalize",value:function(t){var n,r,i,o,a,s,u,c;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215)a=(t>>16&255)/255,s=(t>>8&255)/255,u=(255&t)/255,c=1;else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)a=(n=_slicedToArray(t=this._clamp(t),4))[0],s=n[1],u=n[2],c=void 0===(r=n[3])?1:r;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)a=(i=_slicedToArray(t=this._clamp(t,0,255),4))[0],s=i[1],u=i[2],c=void 0===(o=i[3])?255:o,a/=255,s/=255,u/=255,c/=255;else if("string"==typeof t||"object"==_typeof(t)){var l;if("string"==typeof t){var h=e.HEX_PATTERN.exec(t);h&&(t="#".concat(h[2]))}var f=ot(t);f.isValid()&&(a=(l=f.rgba).r,s=l.g,u=l.b,c=l.a,a/=255,s/=255,u/=255)}if(void 0===a)throw new Error("Unable to convert color ".concat(t));this._components[0]=a,this._components[1]=s,this._components[2]=u,this._components[3]=c,this.refreshInt()}},{key:"refreshInt",value:function(){this._clamp(this._components);var e=_slicedToArray(this._components,3),t=e[0],n=e[1],r=e[2];this._int=(255*t<<16)+(255*n<<8)+(255*r|0)}},{key:"_clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return"number"==typeof e?Math.min(Math.max(e,t),n):(e.forEach((function(r,i){e[i]=Math.min(Math.max(r,t),n)})),e)}}]),e}();st.shared=new st,st.temp=new st,st.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var ut=st;function ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return _e("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),ut.shared.setValue(e).toRgbArray(t)}function lt(e){return _e("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),ut.shared.setValue(e).toHex()}function ht(e){return _e("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),ut.shared.setValue(e).toNumber()}function ft(e){return _e("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),ut.shared.setValue(e).toNumber()}var dt=function(){for(var e=[],t=[],n=0;n<32;n++)e[n]=n,t[n]=n;e[M.NORMAL_NPM]=M.NORMAL,e[M.ADD_NPM]=M.ADD,e[M.SCREEN_NPM]=M.SCREEN,t[M.NORMAL]=M.NORMAL_NPM,t[M.ADD]=M.ADD_NPM,t[M.SCREEN]=M.SCREEN_NPM;var r=[];return r.push(t),r.push(e),r}();function pt(e,t){return dt[t?1:0][e]}function yt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return _e("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),ut.shared.setValue(e).premultiply(t,r).toArray(null!==n&&void 0!==n?n:new Float32Array(4))}function gt(e,t){return _e("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),ut.shared.setValue(e).toPremultiplied(t)}function mt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return _e("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),ut.shared.setValue(e).premultiply(t,r).toArray(null!==n&&void 0!==n?n:new Float32Array(4))}var vt=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function wt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=6*e;if((t=t||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got ".concat(t.length," and expected ").concat(n));for(var r=0,i=0;r<n;r+=6,i+=4)t[r+0]=i+0,t[r+1]=i+1,t[r+2]=i+2,t[r+3]=i+0,t[r+4]=i+2,t[r+5]=i+3;return t}function bt(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var xt={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function _t(e,t){for(var n=0,r=0,i={},o=0;o<e.length;o++)r+=t[o],n+=e[o].length;for(var a=new ArrayBuffer(4*n),s=null,u=0,c=0;c<e.length;c++){var l=t[c],h=e[c],f=bt(h);i[f]||(i[f]=new xt[f](a)),s=i[f];for(var d=0;d<h.length;d++)s[(d/l|0)*r+u+d%l]=h[d];u+=l}return new Float32Array(a)}function It(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,1+(e|=e>>>16)}function At(e){return!(e&e-1||!e)}function Ct(e){var t=(e>65535?1:0)<<4,n=((e>>>=t)>255?1:0)<<3;return t|=n,t|=n=((e>>>=n)>15?1:0)<<2,(t|=n=((e>>>=n)>3?1:0)<<1)|(e>>>=n)>>1}function kt(e,t,n){var r,i=e.length;if(!(t>=i||0===n)){var o=i-(n=t+n>i?i-t:n);for(r=t;r<o;++r)e[r]=e[r+n];e.length=o}}function St(e){return 0===e?0:e<0?-1:1}var Tt=0;function Et(){return++Tt}var Ot=function(){function e(t,n,r,i){_classCallCheck(this,e),this.left=t,this.top=n,this.right=r,this.bottom=i}return _createClass(e,[{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"isEmpty",value:function(){return this.left===this.right||this.top===this.bottom}}]),e}();Ot.EMPTY=new Ot(0,0,0,0);var Pt=Ot,Rt={},Bt=Object.create(null),Dt=Object.create(null);function Mt(){var e;for(e in Bt)Bt[e].destroy();for(e in Dt)Dt[e].destroy()}function Lt(){var e;for(e in Bt)delete Bt[e];for(e in Dt)delete Dt[e]}var Ft=function(){function e(t,n,r){_classCallCheck(this,e),this._canvas=Q.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||Q.RESOLUTION,this.resize(t,n)}return _createClass(e,[{key:"clear",value:function(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}},{key:"resize",value:function(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}},{key:"destroy",value:function(){this._context=null,this._canvas=null}},{key:"width",get:function(){return this._checkDestroyed(),this._canvas.width},set:function(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}},{key:"height",get:function(){return this._checkDestroyed(),this._canvas.height},set:function(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}},{key:"canvas",get:function(){return this._checkDestroyed(),this._canvas}},{key:"context",get:function(){return this._checkDestroyed(),this._context}},{key:"_checkDestroyed",value:function(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}]),e}();function Nt(e,t,n){for(var r=0,i=4*n*t;r<t;++r,i+=4)if(0!==e[i+3])return!1;return!0}function Ut(e,t,n,r,i){for(var o=4*t,a=r,s=r*o+4*n;a<=i;++a,s+=o)if(0!==e[s+3])return!1;return!0}function jt(e){var t=e.width,n=e.height,r=e.getContext("2d",{willReadFrequently:!0});if(null===r)throw new TypeError("Failed to get canvas 2D context");for(var i=r.getImageData(0,0,t,n).data,o=0,a=0,s=t-1,u=n-1;a<n&&Nt(i,t,a);)++a;if(a===n)return Pt.EMPTY;for(;Nt(i,t,u);)--u;for(;Ut(i,t,o,a,u);)++o;for(;Ut(i,t,s,a,u);)--s;return++s,++u,new Pt(o,a,s,u)}function Gt(e){var t=jt(e),n=t.width,r=t.height,i=null;if(!t.isEmpty()){var o=e.getContext("2d");if(null===o)throw new TypeError("Failed to get canvas 2D context");i=o.getImageData(t.left,t.top,n,r)}return{width:n,height:r,data:i}}function zt(e){var t=vt.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function Ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis.location;if(e.startsWith("data:"))return"";t=t||globalThis.location;var n=new URL(e,document.baseURI);return n.hostname!==t.hostname||n.port!==t.port||n.protocol!==t.protocol?"anonymous":""}function Vt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=null===(t=Q.RETINA_PREFIX)||void 0===t?void 0:t.exec(e);return r?parseFloat(r[1]):n}var Wt=function(e){return e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e}(Wt||{}),$t=function(e){if("function"==typeof e||"object"==_typeof(e)&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e=_objectSpread(_objectSpread({},"object"!=_typeof(e.extension)?{type:e.extension}:e.extension),{},{ref:e})}if("object"!=_typeof(e))throw new Error("Invalid extension type");return"string"==typeof(e=_objectSpread({},e)).type&&(e.type=[e.type]),e},Yt=function(e,t){var n;return null!==(n=$t(e).priority)&&void 0!==n?n:t},Kt={_addHandlers:{},_removeHandlers:{},_queue:{},remove:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map($t).forEach((function(t){t.type.forEach((function(n){var r,i;return null===(r=(i=e._removeHandlers)[n])||void 0===r?void 0:r.call(i,t)}))})),this},add:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map($t).forEach((function(t){t.type.forEach((function(n){var r,i,o=e._addHandlers,a=e._queue;o[n]?null===(r=o[n])||void 0===r||r.call(o,t):(a[n]=a[n]||[],null===(i=a[n])||void 0===i||i.push(t))}))})),this},handle:function(e,t,n){var r,i=this._addHandlers,o=this._removeHandlers;if(i[e]||o[e])throw new Error("Extension type ".concat(e," already has a handler"));i[e]=t,o[e]=n;var a=this._queue;return a[e]&&(null!==(r=a[e])&&void 0!==r&&r.forEach((function(e){return t(e)})),delete a[e]),this},handleByMap:function(e,t){return this.handle(e,(function(e){e.name&&(t[e.name]=e.ref)}),(function(e){e.name&&delete t[e.name]}))},handleByList:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return this.handle(e,(function(e){t.includes(e.ref)||(t.push(e.ref),t.sort((function(e,t){return Yt(t,n)-Yt(e,n)})))}),(function(e){var n=t.indexOf(e.ref);-1!==n&&t.splice(n,1)}))}},Xt=function(){function e(t){_classCallCheck(this,e),"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return _createClass(e,[{key:"int8View",get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}},{key:"uint8View",get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}},{key:"int16View",get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}},{key:"uint16View",get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}},{key:"int32View",get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}},{key:"view",value:function(e){return this["".concat(e,"View")]}},{key:"destroy",value:function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}}],[{key:"sizeOf",value:function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error("".concat(e," isn't a valid view type"))}}}]),e}(),Zt=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function qt(e){for(var t="",n=0;n<e;++n)n>0&&(t+="\nelse "),n<e-1&&(t+="if(test == ".concat(n,".0){}"));return t}function Jt(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=t.createShader(t.FRAGMENT_SHADER);;){var r=Zt.replace(/%forloop%/gi,qt(e));if(t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))break;e=e/2|0}return e}var Qt=function(){function e(){_classCallCheck(this,e),this.data=0,this.blendMode=M.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return _createClass(e,[{key:"blend",get:function(){return!!(1&this.data)},set:function(e){!!(1&this.data)!==e&&(this.data^=1)}},{key:"offsets",get:function(){return!!(2&this.data)},set:function(e){!!(2&this.data)!==e&&(this.data^=2)}},{key:"culling",get:function(){return!!(4&this.data)},set:function(e){!!(4&this.data)!==e&&(this.data^=4)}},{key:"depthTest",get:function(){return!!(8&this.data)},set:function(e){!!(8&this.data)!==e&&(this.data^=8)}},{key:"depthMask",get:function(){return!!(32&this.data)},set:function(e){!!(32&this.data)!==e&&(this.data^=32)}},{key:"clockwiseFrontFace",get:function(){return!!(16&this.data)},set:function(e){!!(16&this.data)!==e&&(this.data^=16)}},{key:"blendMode",get:function(){return this._blendMode},set:function(e){this.blend=e!==M.NONE,this._blendMode=e}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e}}],[{key:"for2d",value:function(){var t=new e;return t.depthTest=!1,t.blend=!0,t}}]),e}();Qt.prototype.toString=function(){return"[@pixi/core:State blendMode=".concat(this.blendMode," clockwiseFrontFace=").concat(this.clockwiseFrontFace," culling=").concat(this.culling," depthMask=").concat(this.depthMask," polygonOffset=").concat(this.polygonOffset,"]")};var en=[];function tn(e,t){if(!e)return null;var n="";if("string"==typeof e){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);r&&(n=r[1].toLowerCase())}for(var i=en.length-1;i>=0;--i){var o=en[i];if(o.test&&o.test(e,n))return new o(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var nn=function(){function e(t){_classCallCheck(this,e),this.items=[],this._name=t,this._aliasCount=0}return _createClass(e,[{key:"emit",value:function(e,t,n,r,i,o,a,s){if(arguments.length>8)throw new Error("max arguments reached");var u=this.name,c=this.items;this._aliasCount++;for(var l=0,h=c.length;l<h;l++)c[l][u](e,t,n,r,i,o,a,s);return c===this.items&&this._aliasCount--,this}},{key:"ensureNonAliasedItems",value:function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}},{key:"add",value:function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}},{key:"remove",value:function(e){var t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}},{key:"contains",value:function(e){return this.items.includes(e)}},{key:"removeAll",value:function(){return this.ensureNonAliasedItems(),this.items.length=0,this}},{key:"destroy",value:function(){this.removeAll(),this.items.length=0,this._name=""}},{key:"empty",get:function(){return 0===this.items.length}},{key:"name",get:function(){return this._name}}]),e}();Object.defineProperties(nn.prototype,{dispatch:{value:nn.prototype.emit},run:{value:nn.prototype.emit}});var rn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,e),this._width=t,this._height=n,this.destroyed=!1,this.internal=!1,this.onResize=new nn("setRealSize"),this.onUpdate=new nn("update"),this.onError=new nn("onError")}return _createClass(e,[{key:"bind",value:function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}},{key:"unbind",value:function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}},{key:"resize",value:function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}},{key:"valid",get:function(){return!!this._width&&!!this._height}},{key:"update",value:function(){this.destroyed||this.onUpdate.emit()}},{key:"load",value:function(){return Promise.resolve(this)}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"style",value:function(e,t,n){return!1}},{key:"dispose",value:function(){}},{key:"destroy",value:function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}}],[{key:"test",value:function(e,t){return!1}}]),e}(),on=function(e){function t(e,n){var r,i;_classCallCheck(this,t);var o=n||{},a=o.width,s=o.height;if(!a||!s)throw new Error("BufferResource width or height invalid");return(i=_callSuper(this,t,[a,s])).data=e,i.unpackAlignment=null!==(r=n.unpackAlignment)&&void 0!==r?r:4,i}return _inherits(t,e),_createClass(t,[{key:"upload",value:function(e,t,n){var r=e.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===V.UNPACK);var i=t.realWidth,o=t.realHeight;return n.width===i&&n.height===o?r.texSubImage2D(t.target,0,0,0,i,o,t.format,n.type,this.data):(n.width=i,n.height=o,r.texImage2D(t.target,0,n.internalFormat,i,o,0,t.format,n.type,this.data)),!0}},{key:"dispose",value:function(){this.data=null}}],[{key:"test",value:function(e){return null===e||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}]),t}(rn),an={scaleMode:G.NEAREST,alphaMode:V.NPM},sn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,t),e=_callSuper(this,t);var i=r=Object.assign({},t.defaultOptions,r),o=i.alphaMode,a=i.mipmap,s=i.anisotropicLevel,u=i.scaleMode,c=i.width,l=i.height,h=i.wrapMode,f=i.format,d=i.type,p=i.target,y=i.resolution,g=i.resourceOptions;return n&&!(n instanceof rn)&&((n=tn(n,g)).internal=!0),e.resolution=y||Q.RESOLUTION,e.width=Math.round((c||0)*e.resolution)/e.resolution,e.height=Math.round((l||0)*e.resolution)/e.resolution,e._mipmap=a,e.anisotropicLevel=s,e._wrapMode=h,e._scaleMode=u,e.format=f,e.type=d,e.target=p,e.alphaMode=o,e.uid=Et(),e.touched=0,e.isPowerOfTwo=!1,e._refreshPOT(),e._glTextures={},e.dirtyId=0,e.dirtyStyleId=0,e.cacheId=null,e.valid=c>0&&l>0,e.textureCacheIds=[],e.destroyed=!1,e.resource=null,e._batchEnabled=0,e._batchLocation=0,e.parentTextureArray=null,e.setResource(n),e}return _inherits(t,e),_createClass(t,[{key:"realWidth",get:function(){return Math.round(this.width*this.resolution)}},{key:"realHeight",get:function(){return Math.round(this.height*this.resolution)}},{key:"mipmap",get:function(){return this._mipmap},set:function(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}},{key:"scaleMode",get:function(){return this._scaleMode},set:function(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}},{key:"wrapMode",get:function(){return this._wrapMode},set:function(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}},{key:"setStyle",value:function(e,t){var n;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,n=!0),n&&this.dirtyStyleId++,this}},{key:"setSize",value:function(e,t,n){return n=n||this.resolution,this.setRealSize(e*n,t*n,n)}},{key:"setRealSize",value:function(e,t,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}},{key:"_refreshPOT",value:function(){this.isPowerOfTwo=At(this.realWidth)&&At(this.realHeight)}},{key:"setResolution",value:function(e){var t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT()),this}},{key:"setResource",value:function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}},{key:"update",value:function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}},{key:"onError",value:function(e){this.emit("error",this,e)}},{key:"destroy",value:function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Dt[this.cacheId],delete Bt[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}},{key:"dispose",value:function(){this.emit("dispose",this)}},{key:"castToBaseTexture",value:function(){return this}}],[{key:"from",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Q.STRICT_TEXTURE_CACHE,i="string"==typeof e,o=null;if(i)o=e;else{if(!e._pixiId){var a=(null===n||void 0===n?void 0:n.pixiIdPrefix)||"pixiid";e._pixiId="".concat(a,"_").concat(Et())}o=e._pixiId}var s=Dt[o];if(i&&r&&!s)throw new Error('The cacheId "'.concat(o,'" does not exist in BaseTextureCache.'));return s||((s=new t(e,n)).cacheId=o,t.addToCache(s,o)),s}},{key:"fromBuffer",value:function(e,n,r,i){e=e||new Float32Array(n*r*4);var o,a,s=new on(e,_objectSpread({width:n,height:r},null===i||void 0===i?void 0:i.resourceOptions));return e instanceof Float32Array?(o=F.RGBA,a=U.FLOAT):e instanceof Int32Array?(o=F.RGBA_INTEGER,a=U.INT):e instanceof Uint32Array?(o=F.RGBA_INTEGER,a=U.UNSIGNED_INT):e instanceof Int16Array?(o=F.RGBA_INTEGER,a=U.SHORT):e instanceof Uint16Array?(o=F.RGBA_INTEGER,a=U.UNSIGNED_SHORT):e instanceof Int8Array?(o=F.RGBA,a=U.BYTE):(o=F.RGBA,a=U.UNSIGNED_BYTE),s.internal=!0,new t(s,Object.assign({},an,{type:a,format:o},i))}},{key:"addToCache",value:function(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Dt[t]&&Dt[t]!==e&&console.warn("BaseTexture added to the cache with an id [".concat(t,"] that already had an entry")),Dt[t]=e)}},{key:"removeFromCache",value:function(e){if("string"==typeof e){var t=Dt[e];if(t){var n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete Dt[e],t}}else if(null!==e&&void 0!==e&&e.textureCacheIds){for(var r=0;r<e.textureCacheIds.length;++r)delete Dt[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}}]),t}(ve);sn.defaultOptions={mipmap:H.POW2,anisotropicLevel:0,scaleMode:G.LINEAR,wrapMode:z.CLAMP,alphaMode:V.UNPACK,target:N.TEXTURE_2D,format:F.RGBA,type:U.UNSIGNED_BYTE},sn._globalBatch=0;var un=sn,cn=_createClass((function e(){_classCallCheck(this,e),this.texArray=null,this.blend=0,this.type=L.TRIANGLES,this.start=0,this.size=0,this.data=null})),ln=0,hn=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=n,this.id=ln++,this.disposeRunner=new nn("disposeBuffer")}return _createClass(e,[{key:"update",value:function(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}},{key:"dispose",value:function(){this.disposeRunner.emit(this,!1)}},{key:"destroy",value:function(){this.dispose(),this.data=null}},{key:"index",get:function(){return this.type===q.ELEMENT_ARRAY_BUFFER},set:function(e){this.type=e?q.ELEMENT_ARRAY_BUFFER:q.ARRAY_BUFFER}}],[{key:"from",value:function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)}}]),e}(),fn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U.FLOAT,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;_classCallCheck(this,e),this.buffer=t,this.size=n,this.normalized=r,this.type=i,this.stride=o,this.start=a,this.instance=s,this.divisor=u}return _createClass(e,[{key:"destroy",value:function(){this.buffer=null}}],[{key:"from",value:function(t,n,r,i,o){return new e(t,n,r,i,o)}}]),e}(),dn={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array},pn={5126:4,5123:2,5121:1},yn=0,gn={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},mn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.buffers=t,this.indexBuffer=null,this.attributes=n,this.glVertexArrayObjects={},this.id=yn++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new nn("disposeGeometry"),this.refCount=0}return _createClass(e,[{key:"addAttribute",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof hn||(t instanceof Array&&(t=new Float32Array(t)),t=new hn(t));var u=e.split("|");if(u.length>1){for(var c=0;c<u.length;c++)this.addAttribute(u[c],t,n,r,i);return this}var l=this.buffers.indexOf(t);return-1===l&&(this.buffers.push(t),l=this.buffers.length-1),this.attributes[e]=new fn(l,n,r,i,o,a,s),this.instanced=this.instanced||s,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"getBuffer",value:function(e){return this.buffers[this.getAttribute(e).buffer]}},{key:"addIndex",value:function(e){return e instanceof hn||(e instanceof Array&&(e=new Uint16Array(e)),e=new hn(e)),e.type=q.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}},{key:"getIndex",value:function(){return this.indexBuffer}},{key:"interleave",value:function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],n=[],r=new hn;for(e in this.attributes){var i=this.attributes[e],o=this.buffers[i.buffer];t.push(o.data),n.push(i.size*pn[i.type]/4),i.buffer=0}for(r.data=function(e,t){for(var n=0,r=0,i={},o=0;o<e.length;o++)r+=t[o],n+=e[o].length;for(var a=new ArrayBuffer(4*n),s=null,u=0,c=0;c<e.length;c++){var l=t[c],h=e[c],f=bt(h);i[f]||(i[f]=new dn[f](a)),s=i[f];for(var d=0;d<h.length;d++)s[(d/l|0)*r+u+d%l]=h[d];u+=l}return new Float32Array(a)}(t,n),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}},{key:"getSize",value:function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}},{key:"dispose",value:function(){this.disposeRunner.emit(this,!1)}},{key:"destroy",value:function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}},{key:"clone",value:function(){for(var t=new e,n=0;n<this.buffers.length;n++)t.buffers[n]=new hn(this.buffers[n].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new fn(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=q.ELEMENT_ARRAY_BUFFER),t}}],[{key:"merge",value:function(t){for(var n,r=new e,i=[],o=[],a=[],s=0;s<t.length;s++){n=t[s];for(var u=0;u<n.buffers.length;u++)o[u]=o[u]||0,o[u]+=n.buffers[u].data.length,a[u]=0}for(var c=0;c<n.buffers.length;c++)i[c]=new(gn[bt(n.buffers[c].data)])(o[c]),r.buffers[c]=new hn(i[c]);for(var l=0;l<t.length;l++){n=t[l];for(var h=0;h<n.buffers.length;h++)i[h].set(n.buffers[h].data,a[h]),a[h]+=n.buffers[h].data.length}if(r.attributes=n.attributes,n.indexBuffer){r.indexBuffer=r.buffers[n.buffers.indexOf(n.indexBuffer)],r.indexBuffer.type=q.ELEMENT_ARRAY_BUFFER;for(var f=0,d=0,p=0,y=0,g=0;g<n.buffers.length;g++)if(n.buffers[g]!==n.indexBuffer){y=g;break}for(var m in n.attributes){var v=n.attributes[m];(0|v.buffer)===y&&(d+=v.size*pn[v.type]/4)}for(var w=0;w<t.length;w++){for(var b=t[w].indexBuffer.data,x=0;x<b.length;x++)r.indexBuffer.data[x+p]+=f;f+=t[w].buffers[y].data.length/d,p+=b.length}}return r}}]),e}(),vn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,t),(e=_callSuper(this,t))._buffer=new hn(null,n,!1),e._indexBuffer=new hn(null,n,!0),e.addAttribute("aVertexPosition",e._buffer,2,!1,U.FLOAT).addAttribute("aTextureCoord",e._buffer,2,!1,U.FLOAT).addAttribute("aColor",e._buffer,4,!0,U.UNSIGNED_BYTE).addAttribute("aTextureId",e._buffer,1,!0,U.FLOAT).addIndex(e._indexBuffer),e}return _inherits(t,e),_createClass(t)}(mn),wn=2*Math.PI,bn=180/Math.PI,xn=Math.PI/180,_n=function(e){return e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e}(_n||{}),In=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,e),this.x=0,this.y=0,this.x=t,this.y=n}return _createClass(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"copyFrom",value:function(e){return this.set(e.x,e.y),this}},{key:"copyTo",value:function(e){return e.set(this.x,this.y),e}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.x=e,this.y=t,this}}]),e}();In.prototype.toString=function(){return"[@pixi/math:Point x=".concat(this.x," y=").concat(this.y,"]")};var An=[new In,new In,new In,new In],Cn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,e),this.x=Number(t),this.y=Number(n),this.width=Number(r),this.height=Number(i),this.type=_n.RECT}return _createClass(e,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"copyFrom",value:function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}},{key:"copyTo",value:function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}},{key:"contains",value:function(e,t){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}},{key:"intersects",value:function(e,t){if(!t){var n=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=n)return!1;var r=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>r}var i=this.left,o=this.right,a=this.top,s=this.bottom;if(o<=i||s<=a)return!1;var u=An[0].set(e.left,e.top),c=An[1].set(e.left,e.bottom),l=An[2].set(e.right,e.top),h=An[3].set(e.right,e.bottom);if(l.x<=u.x||c.y<=u.y)return!1;var f=Math.sign(t.a*t.d-t.b*t.c);if(0===f||(t.apply(u,u),t.apply(c,c),t.apply(l,l),t.apply(h,h),Math.max(u.x,c.x,l.x,h.x)<=i||Math.min(u.x,c.x,l.x,h.x)>=o||Math.max(u.y,c.y,l.y,h.y)<=a||Math.min(u.y,c.y,l.y,h.y)>=s))return!1;var d=f*(c.y-u.y),p=f*(u.x-c.x),y=d*i+p*a,g=d*o+p*a,m=d*i+p*s,v=d*o+p*s;if(Math.max(y,g,m,v)<=d*u.x+p*u.y||Math.min(y,g,m,v)>=d*h.x+p*h.y)return!1;var w=f*(u.y-l.y),b=f*(l.x-u.x),x=w*i+b*a,_=w*o+b*a,I=w*i+b*s,A=w*o+b*s;return!(Math.max(x,_,I,A)<=w*u.x+b*u.y||Math.min(x,_,I,A)>=w*h.x+b*h.y)}},{key:"pad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}},{key:"fit",value:function(e){var t=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(n-t,0),this.y=r,this.height=Math.max(i-r,0),this}},{key:"ceil",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001,n=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=n-this.x,this.height=r-this.y,this}},{key:"enlarge",value:function(e){var t=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=n-t,this.y=r,this.height=i-r,this}}],[{key:"EMPTY",get:function(){return new e(0,0,0,0)}}]),e}();Cn.prototype.toString=function(){return"[@pixi/math:Rectangle x=".concat(this.x," y=").concat(this.y," width=").concat(this.width," height=").concat(this.height,"]")};var kn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,e),this.x=t,this.y=n,this.radius=r,this.type=_n.CIRC}return _createClass(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.radius)}},{key:"contains",value:function(e,t){if(this.radius<=0)return!1;var n=this.radius*this.radius,r=this.x-e,i=this.y-t;return(r*=r)+(i*=i)<=n}},{key:"getBounds",value:function(){return new Cn(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),e}();kn.prototype.toString=function(){return"[@pixi/math:Circle x=".concat(this.x," y=").concat(this.y," radius=").concat(this.radius,"]")};var Sn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,e),this.x=t,this.y=n,this.width=r,this.height=i,this.type=_n.ELIP}return _createClass(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"contains",value:function(e,t){if(this.width<=0||this.height<=0)return!1;var n=(e-this.x)/this.width,r=(t-this.y)/this.height;return(n*=n)+(r*=r)<=1}},{key:"getBounds",value:function(){return new Cn(this.x-this.width,this.y-this.height,this.width,this.height)}}]),e}();Sn.prototype.toString=function(){return"[@pixi/math:Ellipse x=".concat(this.x," y=").concat(this.y," width=").concat(this.width," height=").concat(this.height,"]")};var Tn=function(){function e(){_classCallCheck(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Array.isArray(n[0])?n[0]:n;if("number"!=typeof i[0]){for(var o=[],a=0,s=i.length;a<s;a++)o.push(i[a].x,i[a].y);i=o}this.points=i,this.type=_n.POLY,this.closeStroke=!0}return _createClass(e,[{key:"clone",value:function(){var t=new e(this.points.slice());return t.closeStroke=this.closeStroke,t}},{key:"contains",value:function(e,t){for(var n=!1,r=this.points.length/2,i=0,o=r-1;i<r;o=i++){var a=this.points[2*i],s=this.points[2*i+1],u=this.points[2*o],c=this.points[2*o+1];s>t!=c>t&&e<(t-s)/(c-s)*(u-a)+a&&(n=!n)}return n}}]),e}();Tn.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke=".concat(this.closeStroke,"points=").concat(this.points.reduce((function(e,t){return"".concat(e,", ").concat(t)}),""),"]")};var En=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;_classCallCheck(this,e),this.x=t,this.y=n,this.width=r,this.height=i,this.radius=o,this.type=_n.RREC}return _createClass(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height,this.radius)}},{key:"contains",value:function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+n&&t<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;var r=e-(this.x+n),i=t-(this.y+n),o=n*n;if(r*r+i*i<=o||(r=e-(this.x+this.width-n))*r+i*i<=o||r*r+(i=t-(this.y+this.height-n))*i<=o||(r=e-(this.x+n))*r+i*i<=o)return!0}return!1}}]),e}();En.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x=".concat(this.x," y=").concat(this.y,"width=").concat(this.width," height=").concat(this.height," radius=").concat(this.radius,"]")};var On=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;_classCallCheck(this,e),this.array=null,this.a=t,this.b=n,this.c=r,this.d=i,this.tx=o,this.ty=a}return _createClass(e,[{key:"fromArray",value:function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}},{key:"set",value:function(e,t,n,r,i,o){return this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=o,this}},{key:"toArray",value:function(e,t){this.array||(this.array=new Float32Array(9));var n=t||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}},{key:"apply",value:function(e,t){t=t||new In;var n=e.x,r=e.y;return t.x=this.a*n+this.c*r+this.tx,t.y=this.b*n+this.d*r+this.ty,t}},{key:"applyInverse",value:function(e,t){t=t||new In;var n=1/(this.a*this.d+this.c*-this.b),r=e.x,i=e.y;return t.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,t.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,t}},{key:"translate",value:function(e,t){return this.tx+=e,this.ty+=t,this}},{key:"scale",value:function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.a,i=this.c,o=this.tx;return this.a=r*t-this.b*n,this.b=r*n+this.b*t,this.c=i*t-this.d*n,this.d=i*n+this.d*t,this.tx=o*t-this.ty*n,this.ty=o*n+this.ty*t,this}},{key:"append",value:function(e){var t=this.a,n=this.b,r=this.c,i=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*n+e.b*i,this.c=e.c*t+e.d*r,this.d=e.c*n+e.d*i,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*n+e.ty*i+this.ty,this}},{key:"setTransform",value:function(e,t,n,r,i,o,a,s,u){return this.a=Math.cos(a+u)*i,this.b=Math.sin(a+u)*i,this.c=-Math.sin(a-s)*o,this.d=Math.cos(a-s)*o,this.tx=e-(n*this.a+r*this.c),this.ty=t-(n*this.b+r*this.d),this}},{key:"prepend",value:function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var n=this.a,r=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}},{key:"decompose",value:function(e){var t=this.a,n=this.b,r=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-r,i),s=Math.atan2(n,t),u=Math.abs(a+s);return u<1e-5||Math.abs(wn-u)<1e-5?(e.rotation=s,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=s),e.scale.x=Math.sqrt(t*t+n*n),e.scale.y=Math.sqrt(r*r+i*i),e.position.x=this.tx+(o.x*t+o.y*r),e.position.y=this.ty+(o.x*n+o.y*i),e}},{key:"invert",value:function(){var e=this.a,t=this.b,n=this.c,r=this.d,i=this.tx,o=e*r-t*n;return this.a=r/o,this.b=-t/o,this.c=-n/o,this.d=e/o,this.tx=(n*this.ty-r*i)/o,this.ty=-(e*this.ty-t*i)/o,this}},{key:"identity",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}},{key:"clone",value:function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}},{key:"copyTo",value:function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}},{key:"copyFrom",value:function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}}],[{key:"IDENTITY",get:function(){return new e}},{key:"TEMP_MATRIX",get:function(){return new e}}]),e}();On.prototype.toString=function(){return"[@pixi/math:Matrix a=".concat(this.a," b=").concat(this.b," c=").concat(this.c," d=").concat(this.d," tx=").concat(this.tx," ty=").concat(this.ty,"]")};var Pn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Rn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Bn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Dn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Mn=[],Ln=[],Fn=Math.sign;!function(){for(var e=0;e<16;e++){var t=[];Mn.push(t);for(var n=0;n<16;n++)for(var r=Fn(Pn[e]*Pn[n]+Bn[e]*Rn[n]),i=Fn(Rn[e]*Pn[n]+Dn[e]*Rn[n]),o=Fn(Pn[e]*Bn[n]+Bn[e]*Dn[n]),a=Fn(Rn[e]*Bn[n]+Dn[e]*Dn[n]),s=0;s<16;s++)if(Pn[s]===r&&Rn[s]===i&&Bn[s]===o&&Dn[s]===a){t.push(s);break}}for(var u=0;u<16;u++){var c=new On;c.set(Pn[u],Rn[u],Bn[u],Dn[u],0,0),Ln.push(c)}}();var Nn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return Pn[e]},uY:function(e){return Rn[e]},vX:function(e){return Bn[e]},vY:function(e){return Dn[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return Mn[e][t]},sub:function(e,t){return Mn[e][Nn.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?Nn.S:Nn.N:2*Math.abs(t)<=Math.abs(e)?e>0?Nn.E:Nn.W:t>0?e>0?Nn.SE:Nn.SW:e>0?Nn.NE:Nn.NW},matrixAppendRotationInv:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=Ln[Nn.inv(t)];i.tx=n,i.ty=r,e.append(i)}},Un=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,e),this._x=r,this._y=i,this.cb=t,this.scope=n}return _createClass(e,[{key:"clone",value:function(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cb,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scope,this._x,this._y)}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}},{key:"copyFrom",value:function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}},{key:"copyTo",value:function(e){return e.set(this._x,this._y),e}},{key:"equals",value:function(e){return e.x===this._x&&e.y===this._y}},{key:"x",get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}]),e}();Un.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=".concat(this.x," y=").concat(this.y," scope=").concat(this.scope,"]")};var jn=function(){function e(){_classCallCheck(this,e),this.worldTransform=new On,this.localTransform=new On,this.position=new Un(this.onChange,this,0,0),this.scale=new Un(this.onChange,this,1,1),this.pivot=new Un(this.onChange,this,0,0),this.skew=new Un(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return _createClass(e,[{key:"onChange",value:function(){this._localID++}},{key:"updateSkew",value:function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}},{key:"updateLocalTransform",value:function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}},{key:"updateTransform",value:function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var n=e.worldTransform,r=this.worldTransform;r.a=t.a*n.a+t.b*n.c,r.b=t.a*n.b+t.b*n.d,r.c=t.c*n.a+t.d*n.c,r.d=t.c*n.b+t.d*n.d,r.tx=t.tx*n.a+t.ty*n.c+n.tx,r.ty=t.tx*n.b+t.ty*n.d+n.ty,this._parentID=e._worldID,this._worldID++}}},{key:"setFromMatrix",value:function(e){e.decompose(this),this._localID++}},{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}}]),e}();jn.IDENTITY=new jn;var Gn=jn;Gn.prototype.toString=function(){return"[@pixi/math:Transform position=(".concat(this.position.x,", ").concat(this.position.y,") rotation=").concat(this.rotation," scale=(").concat(this.scale.x,", ").concat(this.scale.y,") skew=(").concat(this.skew.x,", ").concat(this.skew.y,") ]")};var zn,Hn=[{test:function(e){return"float"===e.type&&1===e.size&&!e.isArray},code:function(e){return'\n            if(uv["'.concat(e,'"] !== ud["').concat(e,'"].value)\n            {\n                ud["').concat(e,'"].value = uv["').concat(e,'"]\n                gl.uniform1f(ud["').concat(e,'"].location, uv["').concat(e,'"])\n            }\n            ')}},{test:function(e,t){return!("sampler2D"!==e.type&&"samplerCube"!==e.type&&"sampler2DArray"!==e.type||1!==e.size||e.isArray||null!=t&&void 0===t.castToBaseTexture)},code:function(e){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'.concat(e,'"], t);\n\n            if(ud["').concat(e,'"].value !== t)\n            {\n                ud["').concat(e,'"].value = t;\n                gl.uniform1i(ud["').concat(e,'"].location, t);\n; // eslint-disable-line max-len\n            }')}},{test:function(e,t){return"mat3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.a},code:function(e){return'\n            gl.uniformMatrix3fv(ud["'.concat(e,'"].location, false, uv["').concat(e,'"].toArray(true));\n            ')},codeUbo:function(e){return"\n                var ".concat(e,"_matrix = uv.").concat(e,".toArray(true);\n\n                data[offset] = ").concat(e,"_matrix[0];\n                data[offset+1] = ").concat(e,"_matrix[1];\n                data[offset+2] = ").concat(e,"_matrix[2];\n        \n                data[offset + 4] = ").concat(e,"_matrix[3];\n                data[offset + 5] = ").concat(e,"_matrix[4];\n                data[offset + 6] = ").concat(e,"_matrix[5];\n        \n                data[offset + 8] = ").concat(e,"_matrix[6];\n                data[offset + 9] = ").concat(e,"_matrix[7];\n                data[offset + 10] = ").concat(e,"_matrix[8];\n            ")}},{test:function(e,t){return"vec2"===e.type&&1===e.size&&!e.isArray&&void 0!==t.x},code:function(e){return'\n                cv = ud["'.concat(e,'"].value;\n                v = uv["').concat(e,'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["').concat(e,'"].location, v.x, v.y);\n                }')},codeUbo:function(e){return"\n                v = uv.".concat(e,";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            ")}},{test:function(e){return"vec2"===e.type&&1===e.size&&!e.isArray},code:function(e){return'\n                cv = ud["'.concat(e,'"].value;\n                v = uv["').concat(e,'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["').concat(e,'"].location, v[0], v[1]);\n                }\n            ')}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.width},code:function(e){return'\n                cv = ud["'.concat(e,'"].value;\n                v = uv["').concat(e,'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["').concat(e,'"].location, v.x, v.y, v.width, v.height)\n                }')},codeUbo:function(e){return"\n                    v = uv.".concat(e,";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                ")}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red},code:function(e){return'\n                cv = ud["'.concat(e,'"].value;\n                v = uv["').concat(e,'"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["').concat(e,'"].location, v.red, v.green, v.blue, v.alpha)\n                }')},codeUbo:function(e){return"\n                    v = uv.".concat(e,";\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                ")}},{test:function(e,t){return"vec3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red},code:function(e){return'\n                cv = ud["'.concat(e,'"].value;\n                v = uv["').concat(e,'"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["').concat(e,'"].location, v.red, v.green, v.blue)\n                }')},codeUbo:function(e){return"\n                    v = uv.".concat(e,";\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                ")}},{test:function(e){return"vec4"===e.type&&1===e.size&&!e.isArray},code:function(e){return'\n                cv = ud["'.concat(e,'"].value;\n                v = uv["').concat(e,'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["').concat(e,'"].location, v[0], v[1], v[2], v[3])\n                }')}}],Vn={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},Wn={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},$n={},Yn=$n;function Kn(){var e;if(Yn===$n||null!==(e=Yn)&&void 0!==e&&e.isContextLost()){var t,n=Q.ADAPTER.createCanvas();Q.PREFER_ENV>=R.WEBGL2&&(t=n.getContext("webgl2",{})),t||((t=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Yn=t}return Yn}var Xn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Zn(e){return Xn[e]}var qn=null,Jn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Qn(e,t){if(!qn){var n=Object.keys(Jn);qn={};for(var r=0;r<n.length;++r){var i=n[r];qn[e[i]]=Jn[i]}}return qn[t]}function er(e,t,n){if("precision"!==e.substring(0,9)){var r=t;return t===Y.HIGH&&n!==Y.HIGH&&(r=Y.MEDIUM),"precision ".concat(r," float;\n").concat(e)}return n!==Y.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var tr=0,nr={},rr=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pixi-shader",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};_classCallCheck(this,e),this.extra={},this.id=tr++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=n||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),nr[r]?(nr[r]++,r+="-".concat(nr[r])):nr[r]=1,this.vertexSrc="#define SHADER_NAME ".concat(r,"\n").concat(this.vertexSrc),this.fragmentSrc="#define SHADER_NAME ".concat(r,"\n").concat(this.fragmentSrc),this.vertexSrc=er(this.vertexSrc,e.defaultVertexPrecision,Y.HIGH),this.fragmentSrc=er(this.fragmentSrc,e.defaultFragmentPrecision,function(){if(!zn){zn=Y.MEDIUM;var e=Kn();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);t&&(zn=t.precision?Y.HIGH:Y.MEDIUM)}}return zn}())),this.glPrograms={},this.syncUniforms=null}return _createClass(e,null,[{key:"defaultVertexSrc",get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}},{key:"defaultFragmentSrc",get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}},{key:"from",value:function(t,n,r){var i=t+n,o=Rt[i];return o||(Rt[i]=o=new e(t,n,r)),o}}]),e}();rr.defaultVertexPrecision=Y.HIGH,rr.defaultFragmentPrecision=me.apple.device?Y.HIGH:Y.MEDIUM;var ir=rr,or=0,ar=function(){function e(t,n,r){_classCallCheck(this,e),this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=or++,this.static=!!n,this.ubo=!!r,t instanceof hn?(this.buffer=t,this.buffer.type=q.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new hn(new Float32Array(1)),this.buffer.type=q.UNIFORM_BUFFER,this.autoManage=!0))}return _createClass(e,[{key:"update",value:function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}},{key:"add",value:function(t,n,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new e(n,r)}}],[{key:"from",value:function(t,n,r){return new e(t,n,r)}},{key:"uboFrom",value:function(t,n){return new e(t,null===n||void 0===n||n,!0)}}]),e}(),sr=function(){function e(t,n){_classCallCheck(this,e),this.uniformBindCount=0,this.program=t,this.uniformGroup=n?n instanceof ar?n:new ar(n):new ar({}),this.disposeRunner=new nn("disposeShader")}return _createClass(e,[{key:"checkUniformExists",value:function(e,t){if(t.uniforms[e])return!0;for(var n in t.uniforms){var r=t.uniforms[n];if(!0===r.group&&this.checkUniformExists(e,r))return!0}return!1}},{key:"destroy",value:function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}},{key:"uniforms",get:function(){return this.uniformGroup.uniforms}}],[{key:"from",value:function(t,n,r){return new e(ir.from(t,n),r)}}]),e}(),ur=function(){function e(t,n){if(_classCallCheck(this,e),this.vertexSrc=t,this.fragTemplate=n,this.programCache={},this.defaultGroupCache={},!n.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!n.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}return _createClass(e,[{key:"generateShader",value:function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),n=0;n<e;n++)t[n]=n;this.defaultGroupCache[e]=ar.from({uSamplers:t},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,"".concat(e))).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new ir(this.vertexSrc,r)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new On,default:this.defaultGroupCache[e]};return new sr(this.programCache[e],i)}},{key:"generateSampleSrc",value:function(e){var t="";t+="\n",t+="\n";for(var n=0;n<e;n++)n>0&&(t+="\nelse "),n<e-1&&(t+="if(vTextureId < ".concat(n,".5)")),t+="\n{",t+="\n\tcolor = texture2D(uSamplers[".concat(n,"], vTextureCoord);"),t+="\n}";return t+="\n",t+="\n"}}]),e}(),cr=function(){function e(){_classCallCheck(this,e),this.elements=[],this.ids=[],this.count=0}return _createClass(e,[{key:"clear",value:function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}]),e}(),lr=function(){function e(t){_classCallCheck(this,e),this.renderer=t}return _createClass(e,[{key:"flush",value:function(){}},{key:"destroy",value:function(){this.renderer=null}},{key:"start",value:function(){}},{key:"stop",value:function(){this.flush()}},{key:"render",value:function(e){}}]),e}(),hr=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).setShaderGenerator(),n.geometryClass=vn,n.vertexSize=6,n.state=Qt.for2d(),n.size=4*t.defaultBatchSize,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.maxTextures=1,n.renderer.on("prerender",n.onPrerender,_assertThisInitialized(n)),e.runners.contextChange.add(_assertThisInitialized(n)),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return _inherits(t,e),_createClass(t,[{key:"MAX_TEXTURES",get:function(){return _e("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}},{key:"setShaderGenerator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.vertex,r=void 0===n?t.defaultVertexSrc:n,i=e.fragment,o=void 0===i?t.defaultFragmentTemplate:i;this.shaderGenerator=new ur(r,o)}},{key:"contextChange",value:function(){var e=this.renderer.gl;Q.PREFER_ENV===R.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),t.defaultMaxTextures),this.maxTextures=Jt(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(var n=0;n<this._packedGeometryPoolSize;n++)this._packedGeometries[n]=new this.geometryClass;this.initFlushBuffers()}},{key:"initFlushBuffers",value:function(){for(var e=t._drawCallPool,n=t._textureArrayPool,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;e.length<r;)e.push(new cn);for(;n.length<i;)n.push(new cr);for(var o=0;o<this.maxTextures;o++)this._tempBoundTextures[o]=null}},{key:"onPrerender",value:function(){this._flushId=0}},{key:"render",value:function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}},{key:"buildTexturesAndDrawCalls",value:function(){var e=this._bufferedTextures,n=this.maxTextures,r=t._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count,s=++un._globalBatch,u=0,c=r[0],l=0;i.copyBoundTextures(o,n);for(var h=0;h<this._bufferSize;++h){var f=e[h];e[h]=null,f._batchEnabled!==s&&(c.count>=n&&(i.boundArray(c,o,s,n),this.buildDrawCalls(c,l,h),l=h,c=r[++u],++s),f._batchEnabled=s,f.touched=a,c.elements[c.count++]=f)}c.count>0&&(i.boundArray(c,o,s,n),this.buildDrawCalls(c,l,this._bufferSize),++u,++s);for(var d=0;d<o.length;d++)o[d]=null;un._globalBatch=s}},{key:"buildDrawCalls",value:function(e,n,r){var i=this._bufferedElements,o=this._attributeBuffer,a=this._indexBuffer,s=this.vertexSize,u=t._drawCallPool,c=this._dcIndex,l=this._aIndex,h=this._iIndex,f=u[c];f.start=this._iIndex,f.texArray=e;for(var d=n;d<r;++d){var p=i[d],y=p._texture.baseTexture,g=dt[y.alphaMode?1:0][p.blendMode];i[d]=null,n<d&&f.blend!==g&&(f.size=h-f.start,n=d,(f=u[++c]).texArray=e,f.start=h),this.packInterleavedGeometry(p,o,a,l,h),l+=p.vertexData.length/2*s,h+=p.indices.length,f.blend=g}n<r&&(f.size=h-f.start,++c),this._dcIndex=c,this._aIndex=l,this._iIndex=h}},{key:"bindAndClearTexArray",value:function(e){for(var t=this.renderer.texture,n=0;n<e.count;n++)t.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}},{key:"updateGeometry",value:function(){var e=this._packedGeometries,n=this._attributeBuffer,r=this._indexBuffer;t.canUploadSameBuffer?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}},{key:"drawBatches",value:function(){for(var e=this._dcIndex,n=this.renderer,r=n.gl,i=n.state,o=t._drawCallPool,a=null,s=0;s<e;s++){var u=o[s],c=u.texArray,l=u.type,h=u.size,f=u.start,d=u.blend;a!==c&&(a=c,this.bindAndClearTexArray(c)),this.state.blendMode=d,i.set(this.state),r.drawElements(l,h,r.UNSIGNED_SHORT,2*f)}}},{key:"flush",value:function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}},{key:"start",value:function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),t.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}},{key:"stop",value:function(){this.flush()}},{key:"destroy",value:function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getAttributeBuffer",value:function(e){var t=It(Math.ceil(e/8)),n=Ct(t),r=8*t;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new Xt(r*this.vertexSize*4)),i}},{key:"getIndexBuffer",value:function(e){var t=It(Math.ceil(e/12)),n=Ct(t),r=12*t;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i}},{key:"packInterleavedGeometry",value:function(e,t,n,r,i){for(var o=t.uint32View,a=t.float32View,s=r/this.vertexSize,u=e.uvs,c=e.indices,l=e.vertexData,h=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),d=ut.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0),p=0;p<l.length;p+=2)a[r++]=l[p],a[r++]=l[p+1],a[r++]=u[p],a[r++]=u[p+1],o[r++]=d,a[r++]=h;for(var y=0;y<c.length;y++)n[i++]=s+c[y]}}],[{key:"defaultMaxTextures",get:function(){var e;return this._defaultMaxTextures=null!==(e=this._defaultMaxTextures)&&void 0!==e?e:function(){var e=!0,t=Q.ADAPTER.getNavigator();if(me.tablet||me.phone){if(me.apple.device){var n=t.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(me.android.device){var r=t.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(e=!1)}}return e?32:4}(),this._defaultMaxTextures},set:function(e){this._defaultMaxTextures=e}},{key:"canUploadSameBuffer",get:function(){var e;return this._canUploadSameBuffer=null!==(e=this._canUploadSameBuffer)&&void 0!==e?e:!me.apple.device,this._canUploadSameBuffer},set:function(e){this._canUploadSameBuffer=e}},{key:"defaultVertexSrc",get:function(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}},{key:"defaultFragmentTemplate",get:function(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}}]),t}(lr);hr.defaultBatchSize=4096,hr.extension={name:"batch",type:Wt.RendererPlugin},hr._drawCallPool=[],hr._textureArrayPool=[];var fr=hr;Kt.add(fr);var dr=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[ir.from(e||t.defaultVertexSrc,n||t.defaultFragmentSrc),r])).padding=0,i.resolution=t.defaultResolution,i.multisample=t.defaultMultisample,i.enabled=!0,i.autoFit=!0,i.state=new Qt,i}return _inherits(t,e),_createClass(t,[{key:"apply",value:function(e,t,n,r,i){e.applyFilter(this,t,n,r)}},{key:"blendMode",get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._resolution=e}}],[{key:"defaultVertexSrc",get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}},{key:"defaultFragmentSrc",get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}}]),t}(sr);dr.defaultResolution=1,dr.defaultMultisample=Z.NONE;var pr=dr,yr=function(){function e(){_classCallCheck(this,e),this.clearBeforeRender=!0,this._backgroundColor=new ut(0),this.alpha=1}return _createClass(e,[{key:"init",value:function(e){this.clearBeforeRender=e.clearBeforeRender;var t=e.backgroundColor,n=e.background,r=e.backgroundAlpha,i=null!==n&&void 0!==n?n:t;void 0!==i&&(this.color=i),this.alpha=r}},{key:"color",get:function(){return this._backgroundColor.value},set:function(e){this._backgroundColor.setValue(e)}},{key:"alpha",get:function(){return this._backgroundColor.alpha},set:function(e){this._backgroundColor.setAlpha(e)}},{key:"backgroundColor",get:function(){return this._backgroundColor}},{key:"destroy",value:function(){}}]),e}();yr.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},yr.extension={type:[Wt.RendererSystem,Wt.CanvasRendererSystem],name:"background"},Kt.add(yr);var gr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.emptyRenderer=new lr(t),this.currentRenderer=this.emptyRenderer}return _createClass(e,[{key:"setObjectRenderer",value:function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}},{key:"flush",value:function(){this.setObjectRenderer(this.emptyRenderer)}},{key:"reset",value:function(){this.setObjectRenderer(this.emptyRenderer)}},{key:"copyBoundTextures",value:function(e,t){for(var n=this.renderer.texture.boundTextures,r=t-1;r>=0;--r)e[r]=n[r]||null,e[r]&&(e[r]._batchLocation=r)}},{key:"boundArray",value:function(e,t,n,r){for(var i=e.elements,o=e.ids,a=e.count,s=0,u=0;u<a;u++){var c=i[u],l=c._batchLocation;if(l>=0&&l<r&&t[l]===c)o[u]=l;else for(;s<r;){var h=t[s];if(!h||h._batchEnabled!==n||h._batchLocation!==s){o[u]=s,c._batchLocation=s,t[s]=c;break}s++}}}},{key:"destroy",value:function(){this.renderer=null}}]),e}();gr.extension={type:Wt.RendererSystem,name:"batch"},Kt.add(gr);var mr=0,vr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}return _createClass(e,[{key:"isLost",get:function(){return!this.gl||this.gl.isContextLost()}},{key:"contextChange",value:function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=mr++}},{key:"init",value:function(e){if(e.context)this.initFromContext(e.context);else{var t=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}},{key:"initFromContext",value:function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=mr++,this.renderer.runners.contextChange.emit(e);var t=this.renderer.view;void 0!==t.addEventListener&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}},{key:"initFromOptions",value:function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)}},{key:"createContext",value:function(e,t){var n;if(Q.PREFER_ENV>=R.WEBGL2&&(n=e.getContext("webgl2",t)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}},{key:"getExtensions",value:function(){var e=this.gl,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}},{key:"handleContextLost",value:function(e){var t=this;e.preventDefault(),setTimeout((function(){t.gl.isContextLost()&&t.extensions.loseContext&&t.extensions.loseContext.restoreContext()}),0)}},{key:"handleContextRestored",value:function(){this.renderer.runners.contextChange.emit(this.gl)}},{key:"destroy",value:function(){var e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}},{key:"postrender",value:function(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}},{key:"validateContext",value:function(e){var t=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var r=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}]),e}();vr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},vr.extension={type:Wt.RendererSystem,name:"context"},Kt.add(vr);var wr=function(){function e(t,n){if(_classCallCheck(this,e),this.width=Math.round(t),this.height=Math.round(n),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new nn("disposeFramebuffer"),this.multisample=Z.NONE}return _createClass(e,[{key:"colorTexture",get:function(){return this.colorTextures[0]}},{key:"addColorTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return this.colorTextures[e]=t||new un(null,{scaleMode:G.NEAREST,resolution:1,mipmap:H.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}},{key:"addDepthTexture",value:function(e){return this.depthTexture=e||new un(null,{scaleMode:G.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:H.OFF,format:F.DEPTH_COMPONENT,type:U.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}},{key:"enableDepth",value:function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}},{key:"enableStencil",value:function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}},{key:"resize",value:function(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var r=this.colorTextures[n],i=r.resolution;r.setSize(e/i,t/i)}if(this.depthTexture){var o=this.depthTexture.resolution;this.depthTexture.setSize(e/o,t/o)}}}},{key:"dispose",value:function(){this.disposeRunner.emit(this,!1)}},{key:"destroyDepthTexture",value:function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}]),e}(),br=function(e){function t(){var e,n,r,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),"number"==typeof o&&(o={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),o.width=null!==(e=o.width)&&void 0!==e?e:100,o.height=null!==(n=o.height)&&void 0!==n?n:100,null!==(r=o.multisample)&&void 0!==r||(o.multisample=Z.NONE),(i=_callSuper(this,t,[null,o])).mipmap=H.OFF,i.valid=!0,i._clear=new ut([0,0,0,0]),i.framebuffer=new wr(i.realWidth,i.realHeight).addColorTexture(0,_assertThisInitialized(i)),i.framebuffer.multisample=o.multisample,i.maskStack=[],i.filterStack=[{}],i}return _inherits(t,e),_createClass(t,[{key:"clearColor",get:function(){return this._clear.value},set:function(e){this._clear.setValue(e)}},{key:"clear",get:function(){return this._clear}},{key:"multisample",get:function(){return this.framebuffer.multisample},set:function(e){this.framebuffer.multisample=e}},{key:"resize",value:function(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}},{key:"dispose",value:function(){this.framebuffer.dispose(),_get(_getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}]),t}(un),xr=function(e){function t(e){var n;_classCallCheck(this,t);var r=e;return(n=_callSuper(this,t,[r.naturalWidth||r.videoWidth||r.displayWidth||r.width,r.naturalHeight||r.videoHeight||r.displayHeight||r.height])).source=e,n.noSubImage=!1,n}return _inherits(t,e),_createClass(t,[{key:"upload",value:function(e,t,n,r){var i=e.gl,o=t.realWidth,a=t.realHeight;if(r=r||this.source,("undefined"===typeof HTMLImageElement?"undefined":_typeof(HTMLImageElement))<"u"&&r instanceof HTMLImageElement){if(!r.complete||0===r.naturalWidth)return!1}else if(("undefined"===typeof HTMLVideoElement?"undefined":_typeof(HTMLVideoElement))<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===V.UNPACK),this.noSubImage||t.target!==i.TEXTURE_2D||n.width!==o||n.height!==a?(n.width=o,n.height=a,i.texImage2D(t.target,0,n.internalFormat,t.format,n.type,r)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,n.type,r),!0}},{key:"update",value:function(){if(!this.destroyed){var e=this.source,n=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(n,r),_get(_getPrototypeOf(t.prototype),"update",this).call(this)}}},{key:"dispose",value:function(){this.source=null}}],[{key:"crossOrigin",value:function(e,t,n){void 0!==n||t.startsWith("data:")?!1!==n&&(e.crossOrigin="string"==typeof n?n:"anonymous"):e.crossOrigin=Ht(t)}}]),t}(rn),_r=function(e){function t(e,n){var r,i;if(_classCallCheck(this,t),n=n||{},"string"==typeof e){var o=new Image;xr.crossOrigin(o,e,n.crossorigin),o.src=e,e=o}return i=_callSuper(this,t,[e]),!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(null!==(r=n.createBitmap)&&void 0!==r?r:Q.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,i.bitmap=null,i._load=null,!1!==n.autoLoad&&i.load(),i}return _inherits(t,e),_createClass(t,[{key:"load",value:function(e){var t=this;return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((function(e,n){var r=t.source;t.url=r.src;var i=function(){t.destroyed||(r.onload=null,r.onerror=null,t.update(),t._load=null,t.createBitmap?e(t.process()):e(t))};r.complete&&r.src?i():(r.onload=i,r.onerror=function(e){n(e),t.onError.emit(e)})}))),this._load}},{key:"process",value:function(){var e=this,t=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var n=globalThis.createImageBitmap,r=!t.crossOrigin||"anonymous"===t.crossOrigin;return this._process=fetch(t.src,{mode:r?"cors":"no-cors"}).then((function(e){return e.blob()})).then((function(r){return n(r,0,0,t.width,t.height,{premultiplyAlpha:null===e.alphaMode||e.alphaMode===V.UNPACK?"premultiply":"none"})})).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process}},{key:"upload",value:function(e,n,r){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return _get(_getPrototypeOf(t.prototype),"upload",this).call(this,e,n,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(_get(_getPrototypeOf(t.prototype),"upload",this).call(this,e,n,r,this.bitmap),!this.preserveBitmap){var i=!0,o=n._glTextures;for(var a in o){var s=o[a];if(s!==r&&s.dirtyId!==n.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}},{key:"dispose",value:function(){this.source.onload=null,this.source.onerror=null,_get(_getPrototypeOf(t.prototype),"dispose",this).call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}}],[{key:"test",value:function(e){return("undefined"===typeof HTMLImageElement?"undefined":_typeof(HTMLImageElement))<"u"&&("string"==typeof e||e instanceof HTMLImageElement)}}]),t}(xr),Ir=function(){function e(){_classCallCheck(this,e),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return _createClass(e,[{key:"set",value:function(e,t,n){var r=t.width,i=t.height;if(n){var o=e.width/2/r,a=e.height/2/i,s=e.x/r+o,u=e.y/i+a;n=Nn.add(n,Nn.NW),this.x0=s+o*Nn.uX(n),this.y0=u+a*Nn.uY(n),n=Nn.add(n,2),this.x1=s+o*Nn.uX(n),this.y1=u+a*Nn.uY(n),n=Nn.add(n,2),this.x2=s+o*Nn.uX(n),this.y2=u+a*Nn.uY(n),n=Nn.add(n,2),this.x3=s+o*Nn.uX(n),this.y3=u+a*Nn.uY(n)}else this.x0=e.x/r,this.y0=e.y/i,this.x1=(e.x+e.width)/r,this.y1=e.y/i,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/i,this.x3=e.x/r,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}]),e}();Ir.prototype.toString=function(){return"[@pixi/core:TextureUvs x0=".concat(this.x0," y0=").concat(this.y0," x1=").concat(this.x1," y1=").concat(this.y1," x2=").concat(this.x2," y2=").concat(this.y2," x3=").concat(this.x3," y3=").concat(this.y3,"]")};var Ar=new Ir;function Cr(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}var kr=function(e){function t(e,n,r,i,o,a,s){var u;if(_classCallCheck(this,t),(u=_callSuper(this,t)).noFrame=!1,n||(u.noFrame=!0,n=new Cn(0,0,1,1)),e instanceof t&&(e=e.baseTexture),u.baseTexture=e,u._frame=n,u.trim=i,u.valid=!1,u.destroyed=!1,u._uvs=Ar,u.uvMatrix=null,u.orig=r||n,u._rotate=Number(o||0),!0===o)u._rotate=2;else if(u._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return u.defaultAnchor=a?new In(a.x,a.y):new In(0,0),u.defaultBorders=s,u._updateID=0,u.textureCacheIds=[],e.valid?u.noFrame?e.valid&&u.onBaseTextureUpdated(e):u.frame=n:e.once("loaded",u.onBaseTextureUpdated,_assertThisInitialized(u)),u.noFrame&&e.on("update",u.onBaseTextureUpdated,_assertThisInitialized(u)),_possibleConstructorReturn(u)}return _inherits(t,e),_createClass(t,[{key:"update",value:function(){this.baseTexture.resource&&this.baseTexture.resource.update()}},{key:"onBaseTextureUpdated",value:function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}},{key:"destroy",value:function(e){if(this.baseTexture){if(e){var n=this.baseTexture.resource;null!==n&&void 0!==n&&n.url&&Bt[n.url]&&t.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}},{key:"clone",value:function(){var e,n=this._frame.clone(),r=this._frame===this.orig?n:this.orig.clone(),i=new t(this.baseTexture,!this.noFrame&&n,r,null===(e=this.trim)||void 0===e?void 0:e.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=n),i}},{key:"updateUvs",value:function(){this._uvs===Ar&&(this._uvs=new Ir),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}},{key:"resolution",get:function(){return this.baseTexture.resolution}},{key:"frame",get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,n=e.y,r=e.width,i=e.height,o=t+r>this.baseTexture.width,a=n+i>this.baseTexture.height;if(o||a){var s=o&&a?"and":"or",u="X: ".concat(t," + ").concat(r," = ").concat(t+r," > ").concat(this.baseTexture.width),c="Y: ".concat(n," + ").concat(i," = ").concat(n+i," > ").concat(this.baseTexture.height);throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: ".concat(u," ").concat(s," ").concat(c))}this.valid=r&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}},{key:"castToBaseTexture",value:function(){return this.baseTexture}}],[{key:"from",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Q.STRICT_TEXTURE_CACHE,i="string"==typeof e,o=null;if(i)o=e;else if(e instanceof un){if(!e.cacheId){var a=(null===n||void 0===n?void 0:n.pixiIdPrefix)||"pixiid";e.cacheId="".concat(a,"-").concat(Et()),un.addToCache(e,e.cacheId)}o=e.cacheId}else{if(!e._pixiId){var s=(null===n||void 0===n?void 0:n.pixiIdPrefix)||"pixiid";e._pixiId="".concat(s,"_").concat(Et())}o=e._pixiId}var u=Bt[o];if(i&&r&&!u)throw new Error('The cacheId "'.concat(o,'" does not exist in TextureCache.'));return u||e instanceof un?!u&&e instanceof un&&(u=new t(e),t.addToCache(u,o)):(n.resolution||(n.resolution=Vt(e)),(u=new t(new un(e,n))).baseTexture.cacheId=o,un.addToCache(u.baseTexture,o),t.addToCache(u,o)),u}},{key:"fromURL",value:function(e,n){var r=Object.assign({autoLoad:!1},null===n||void 0===n?void 0:n.resourceOptions),i=t.from(e,Object.assign({resourceOptions:r},n),!1),o=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):o.load().then((function(){return Promise.resolve(i)}))}},{key:"fromBuffer",value:function(e,n,r,i){return new t(un.fromBuffer(e,n,r,i))}},{key:"fromLoader",value:function(e,n,r,i){var o=new un(e,Object.assign({scaleMode:un.defaultOptions.scaleMode,resolution:Vt(n)},i)),a=o.resource;a instanceof _r&&(a.url=n);var s=new t(o);return r||(r=n),un.addToCache(s.baseTexture,r),t.addToCache(s,r),r!==n&&(un.addToCache(s.baseTexture,n),t.addToCache(s,n)),s.baseTexture.valid?Promise.resolve(s):new Promise((function(e){s.baseTexture.once("loaded",(function(){return e(s)}))}))}},{key:"addToCache",value:function(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Bt[t]&&Bt[t]!==e&&console.warn("Texture added to the cache with an id [".concat(t,"] that already had an entry")),Bt[t]=e)}},{key:"removeFromCache",value:function(e){if("string"==typeof e){var t=Bt[e];if(t){var n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete Bt[e],t}}else if(null!==e&&void 0!==e&&e.textureCacheIds){for(var r=0;r<e.textureCacheIds.length;++r)Bt[e.textureCacheIds[r]]===e&&delete Bt[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}},{key:"EMPTY",get:function(){return t._EMPTY||(t._EMPTY=new t(new un),Cr(t._EMPTY),Cr(t._EMPTY.baseTexture)),t._EMPTY}},{key:"WHITE",get:function(){if(!t._WHITE){var e=Q.ADAPTER.createCanvas(16,16),n=e.getContext("2d");e.width=16,e.height=16,n.fillStyle="white",n.fillRect(0,0,16,16),t._WHITE=new t(un.from(e)),Cr(t._WHITE),Cr(t._WHITE.baseTexture)}return t._WHITE}}]),t}(ve),Sr=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).valid=!0,r.filterFrame=null,r.filterPoolKey=null,r.updateUvs(),r}return _inherits(t,e),_createClass(t,[{key:"framebuffer",get:function(){return this.baseTexture.framebuffer}},{key:"multisample",get:function(){return this.framebuffer.multisample},set:function(e){this.framebuffer.multisample=e}},{key:"resize",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.baseTexture.resolution,i=Math.round(e*r)/r,o=Math.round(t*r)/r;this.valid=i>0&&o>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(i,o),this.updateUvs()}},{key:"setResolution",value:function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}}],[{key:"create",value:function(e){return new t(new br(e))}}]),t}(kr),Tr=function(){function e(t){_classCallCheck(this,e),this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return _createClass(e,[{key:"createTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Z.NONE,r=new br(Object.assign({width:e,height:t,resolution:1,multisample:n},this.textureOptions));return new Sr(r)}},{key:"getOptimalTexture",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Z.NONE;e=Math.max(Math.ceil(e*r-1e-6),1),t=Math.max(Math.ceil(t*r-1e-6),1),this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight?n=i>1?-i:-1:(n=((65535&(e=It(e)))<<16|65535&(t=It(t)))>>>0,i>1&&(n+=4294967296*i)),this.texturePool[n]||(this.texturePool[n]=[]);var o=this.texturePool[n].pop();return o||(o=this.createTexture(e,t,i)),o.filterPoolKey=n,o.setResolution(r),o}},{key:"getFilterTexture",value:function(e,t,n){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution,n||Z.NONE);return r.filterFrame=e.filterFrame,r}},{key:"returnTexture",value:function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}},{key:"returnFilterTexture",value:function(e){this.returnTexture(e)}},{key:"clear",value:function(e){if(e=!1!==e)for(var t in this.texturePool){var n=this.texturePool[t];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}}},{key:"setScreenSize",value:function(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){for(var t in this.enableFullScreen=e.width>0&&e.height>0,this.texturePool)if(Number(t)<0){var n=this.texturePool[t];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}]),e}();Tr.SCREEN_KEY=-1;var Er=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return _inherits(t,e),_createClass(t)}(mn),Or=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new hn(e.vertices),e.uvBuffer=new hn(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return _inherits(t,e),_createClass(t,[{key:"map",value:function(e,t){var n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+t.width/e.width,this.uvs[3]=r,this.uvs[4]=n+t.width/e.width,this.uvs[5]=r+t.height/e.height,this.uvs[6]=n,this.uvs[7]=r+t.height/e.height,n=t.x,r=t.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+t.width,this.vertices[3]=r,this.vertices[4]=n+t.width,this.vertices[5]=r+t.height,this.vertices[6]=n,this.vertices[7]=r+t.height,this.invalidate(),this}},{key:"invalidate",value:function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}]),t}(mn),Pr=function(){function e(){_classCallCheck(this,e),this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Z.NONE,this.sourceFrame=new Cn,this.destinationFrame=new Cn,this.bindingSourceFrame=new Cn,this.bindingDestinationFrame=new Cn,this.filters=[],this.transform=null}return _createClass(e,[{key:"clear",value:function(){this.target=null,this.filters=null,this.renderTexture=null}}]),e}(),Rr=[new In,new In,new In,new In],Br=new On,Dr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Tr,this.statePool=[],this.quad=new Er,this.quadUv=new Or,this.tempRect=new Cn,this.activeState={},this.globalUniforms=new ar({outputFrame:new Cn,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return _createClass(e,[{key:"init",value:function(){this.texturePool.setScreenSize(this.renderer.view)}},{key:"push",value:function(e,t){var n,r,i,o,a=this.renderer,s=this.defaultFilterStack,u=this.statePool.pop()||new Pr,c=a.renderTexture;if(c.current){var l=c.current;i=l.resolution,o=l.multisample}else i=a.resolution,o=a.multisample;for(var h=t[0].resolution||i,f=null!==(n=t[0].multisample)&&void 0!==n?n:o,d=t[0].padding,p=t[0].autoFit,y=null===(r=t[0].legacy)||void 0===r||r,g=1;g<t.length;g++){var m,v,w=t[g];h=Math.min(h,w.resolution||i),f=Math.min(f,null!==(m=w.multisample)&&void 0!==m?m:o),d=this.useMaxPadding?Math.max(d,w.padding):d+w.padding,p=p&&w.autoFit,y=y||null===(v=w.legacy)||void 0===v||v}1===s.length&&(this.defaultFilterStack[0].renderTexture=c.current),s.push(u),u.resolution=h,u.multisample=f,u.legacy=y,u.target=e,u.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),u.sourceFrame.pad(d);var b=this.tempRect.copyFrom(c.sourceFrame);a.projection.transform&&this.transformAABB(Br.copyFrom(a.projection.transform).invert(),b),p?(u.sourceFrame.fit(b),(u.sourceFrame.width<=0||u.sourceFrame.height<=0)&&(u.sourceFrame.width=0,u.sourceFrame.height=0)):u.sourceFrame.intersects(b)||(u.sourceFrame.width=0,u.sourceFrame.height=0),this.roundFrame(u.sourceFrame,c.current?c.current.resolution:a.resolution,c.sourceFrame,c.destinationFrame,a.projection.transform),u.renderTexture=this.getOptimalFilterTexture(u.sourceFrame.width,u.sourceFrame.height,h,f),u.filters=t,u.destinationFrame.width=u.renderTexture.width,u.destinationFrame.height=u.renderTexture.height;var x=this.tempRect;x.x=0,x.y=0,x.width=u.sourceFrame.width,x.height=u.sourceFrame.height,u.renderTexture.filterFrame=u.sourceFrame,u.bindingSourceFrame.copyFrom(c.sourceFrame),u.bindingDestinationFrame.copyFrom(c.destinationFrame),u.transform=a.projection.transform,a.projection.transform=null,c.bind(u.renderTexture,u.sourceFrame,x),a.framebuffer.clear(0,0,0,0)}},{key:"pop",value:function(){var e=this.defaultFilterStack,t=e.pop(),n=t.filters;this.activeState=t;var r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;var i=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=Math.round(i[0]*t.resolution),o[1]=Math.round(i[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*i[2]-.5*o[2],a[3]=t.sourceFrame.height*i[3]-.5*o[3],t.legacy){var s=r.filterArea;s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=t.sourceFrame.x,s[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var u=e[e.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,t.renderTexture,u.renderTexture,W.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var c=t.renderTexture,l=this.getOptimalFilterTexture(c.width,c.height,t.resolution);l.filterFrame=c.filterFrame;var h=0;for(h=0;h<n.length-1;++h){1===h&&t.multisample>1&&((l=this.getOptimalFilterTexture(c.width,c.height,t.resolution)).filterFrame=c.filterFrame),n[h].apply(this,c,l,W.CLEAR,t);var f=c;c=l,l=f}n[h].apply(this,c,u.renderTexture,W.BLEND,t),h>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(l)}t.clear(),this.statePool.push(t)}},{key:"bindAndClear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.CLEAR,n=this.renderer,r=n.renderTexture,i=n.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,null!==e&&void 0!==e&&e.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,r.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var a=1&i.stateId||this.forceClear;(t===W.CLEAR||t===W.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)}},{key:"applyFilter",value:function(e,t,n,r){var i=this.renderer;i.state.set(e.state),this.bindAndClear(n,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(L.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(L.TRIANGLE_STRIP))}},{key:"calculateSpriteMatrix",value:function(e,t){var n=this.activeState,r=n.sourceFrame,i=n.destinationFrame,o=t._texture.orig,a=e.set(i.width,0,0,i.height,r.x,r.y),s=t.worldTransform.copyTo(On.TEMP_MATRIX);return s.invert(),a.prepend(s),a.scale(1/o.width,1/o.height),a.translate(t.anchor.x,t.anchor.y),a}},{key:"destroy",value:function(){this.renderer=null,this.texturePool.clear(!1)}},{key:"getOptimalFilterTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Z.NONE;return this.texturePool.getOptimalTexture(e,t,n,r)}},{key:"getFilterTexture",value:function(e,t,n){if("number"==typeof e){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,n||Z.NONE);return i.filterFrame=e.filterFrame,i}},{key:"returnFilterTexture",value:function(e){this.texturePool.returnTexture(e)}},{key:"emptyPool",value:function(){this.texturePool.clear(!0)}},{key:"resize",value:function(){this.texturePool.setScreenSize(this.renderer.view)}},{key:"transformAABB",value:function(e,t){var n=Rr[0],r=Rr[1],i=Rr[2],o=Rr[3];n.set(t.left,t.top),r.set(t.left,t.bottom),i.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(n,n),e.apply(r,r),e.apply(i,i),e.apply(o,o);var a=Math.min(n.x,r.x,i.x,o.x),s=Math.min(n.y,r.y,i.y,o.y),u=Math.max(n.x,r.x,i.x,o.x),c=Math.max(n.y,r.y,i.y,o.y);t.x=a,t.y=s,t.width=u-a,t.height=c-s}},{key:"roundFrame",value:function(e,t,n,r,i){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(i){var o=i,a=o.a,s=o.b,u=o.c,c=o.d;if((Math.abs(s)>1e-4||Math.abs(u)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(c)>1e-4))return}(i=i?Br.copyFrom(i):Br.identity()).translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(i,e),e.ceil(t),this.transformAABB(i.invert(),e)}}}]),e}();Dr.extension={type:Wt.RendererSystem,name:"filter"},Kt.add(Dr);var Mr=_createClass((function e(t){_classCallCheck(this,e),this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Z.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0})),Lr=new Cn,Fr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new wr(10,10),this.msaaSamples=null}return _createClass(e,[{key:"contextChange",value:function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Cn,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;Q.PREFER_ENV===R.WEBGL_LEGACY&&(t=null,n=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}},{key:"bind",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.gl;if(e){var i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,i.mipLevel=n),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat!==e.dirtyFormat?(i.dirtyFormat=e.dirtyFormat,i.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var o=0;o<e.colorTextures.length;o++){var a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){var s=t.width>>n,u=t.height>>n,c=s/t.width;this.setViewport(t.x*c,t.y*c,s,u)}else{var l=e.width>>n,h=e.height>>n;this.setViewport(0,0,l,h)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}},{key:"setViewport",value:function(e,t,n,r){var i=this.viewport;e=Math.round(e),t=Math.round(t),n=Math.round(n),r=Math.round(r),(i.width!==n||i.height!==r||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=n,i.height=r,this.gl.viewport(e,t,n,r))}},{key:"size",get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}},{key:"clear",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:D.COLOR|D.DEPTH,o=this.gl;o.clearColor(e,t,n,r),o.clear(i)}},{key:"initFramebuffer",value:function(e){var t=this.gl,n=new Mr(t.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}},{key:"resizeFramebuffer",value:function(e){var t,n=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),t=1===this.renderer.context.webGLVersion?n.DEPTH_STENCIL:e.depth&&e.stencil?n.DEPTH24_STENCIL8:e.depth?n.DEPTH_COMPONENT24:n.STENCIL_INDEX8,r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,t,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,t,e.width,e.height));var i=e.colorTextures,o=i.length;n.drawBuffers||(o=Math.min(o,1));for(var a=0;a<o;a++){var s=i[a],u=s.parentTextureArray||s;this.renderer.texture.bind(u,0),0===a&&r.msaaBuffer&&(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}},{key:"updateFramebuffer",value:function(e,t){var n=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures,o=i.length;n.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer():r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));for(var a,s,u=[],c=0;c<o;c++){var l=i[c],h=l.parentTextureArray||l;this.renderer.texture.bind(h,0),0===c&&r.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+c,l.target,h._glTextures[this.CONTEXT_UID].texture,t),u.push(n.COLOR_ATTACHMENT0+c))}if(u.length>1&&n.drawBuffers(u),e.depthTexture&&this.writeDepthTexture){var f=e.depthTexture;this.renderer.texture.bind(f,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,f._glTextures[this.CONTEXT_UID].texture,t)}!e.stencil&&!e.depth||e.depthTexture&&this.writeDepthTexture?r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null):(r.stencil=r.stencil||n.createRenderbuffer(),1===this.renderer.context.webGLVersion?(a=n.DEPTH_STENCIL_ATTACHMENT,s=n.DEPTH_STENCIL):e.depth&&e.stencil?(a=n.DEPTH_STENCIL_ATTACHMENT,s=n.DEPTH24_STENCIL8):e.depth?(a=n.DEPTH_ATTACHMENT,s=n.DEPTH_COMPONENT24):(a=n.STENCIL_ATTACHMENT,s=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,s,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,s,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,a,n.RENDERBUFFER,r.stencil))}},{key:"canMultisampleFramebuffer",value:function(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture}},{key:"detectSamples",value:function(e){var t=this.msaaSamples,n=Z.NONE;if(e<=1||null===t)return n;for(var r=0;r<t.length;r++)if(t[r]<=e){n=t[r];break}return 1===n&&(n=Z.NONE),n}},{key:"blit",value:function(e,t,n){var r=this.current,i=this.renderer,o=this.gl,a=this.CONTEXT_UID;if(2===i.context.webGLVersion&&r){var s=r.glFramebuffers[a];if(s){if(!e){if(!s.msaaBuffer)return;var u=r.colorTextures[0];if(!u)return;s.blitFramebuffer||(s.blitFramebuffer=new wr(r.width,r.height),s.blitFramebuffer.addColorTexture(0,u)),(e=s.blitFramebuffer).colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==r.width||e.height!==r.height)&&(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}t||((t=Lr).width=r.width,t.height=r.height),n||(n=t);var c=t.width===n.width&&t.height===n.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,s.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}}}},{key:"disposeFramebuffer",value:function(e,t){var n=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(n){delete e.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,t)}}},{key:"disposeAll",value:function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<t.length;n++)this.disposeFramebuffer(t[n],e)}},{key:"forceStencil",value:function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(!(!t||t.stencil&&e.stencil)){e.stencil=!0;var n,r,i=e.width,o=e.height,a=this.gl,s=t.stencil=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,s),1===this.renderer.context.webGLVersion?(n=a.DEPTH_STENCIL_ATTACHMENT,r=a.DEPTH_STENCIL):e.depth?(n=a.DEPTH_STENCIL_ATTACHMENT,r=a.DEPTH24_STENCIL8):(n=a.STENCIL_ATTACHMENT,r=a.STENCIL_INDEX8),t.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,t.multisample,r,i,o):a.renderbufferStorage(a.RENDERBUFFER,r,i,o),a.framebufferRenderbuffer(a.FRAMEBUFFER,n,a.RENDERBUFFER,s)}}}},{key:"reset",value:function(){this.current=this.unknownFramebuffer,this.viewport=new Cn}},{key:"destroy",value:function(){this.renderer=null}}]),e}();Fr.extension={type:Wt.RendererSystem,name:"framebuffer"},Kt.add(Fr);var Nr={5126:4,5123:2,5121:1},Ur=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return _createClass(e,[{key:"contextChange",value:function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;Q.PREFER_ENV===R.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=function(){return n.createVertexArrayOES()},e.bindVertexArray=function(e){return n.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return n.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==t.webGLVersion){var r=e.getExtension("ANGLE_instanced_arrays");r?(e.vertexAttribDivisor=function(e,t){return r.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,n,i,o){return r.drawElementsInstancedANGLE(e,t,n,i,o)},e.drawArraysInstanced=function(e,t,n,i){return r.drawArraysInstancedANGLE(e,t,n,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex}},{key:"bind",value:function(e,t){t=t||this.renderer.shader.shader;var n=this.gl,r=e.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);var o=r[t.program.id]||this.initGeometryVao(e,t,i);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()}},{key:"reset",value:function(){this.unbind()}},{key:"updateBuffers",value:function(){for(var e=this._activeGeometry,t=this.renderer.buffer,n=0;n<e.buffers.length;n++){var r=e.buffers[n];t.update(r)}}},{key:"checkCompatibility",value:function(e,t){var n=e.attributes,r=t.attributeData;for(var i in r)if(!n[i])throw new Error('shader and geometry incompatible, geometry missing the "'.concat(i,'" attribute'))}},{key:"getSignature",value:function(e,t){var n=e.attributes,r=t.attributeData,i=["g",e.id];for(var o in n)r[o]&&i.push(o,r[o].location);return i.join("-")}},{key:"initGeometryVao",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[i]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);var s=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID],c=u[s];if(c)return u[a.id]=c,c;var l=e.buffers,h=e.attributes,f={},d={};for(var p in l)f[p]=0,d[p]=0;for(var y in h)!h[y].size&&a.attributeData[y]?h[y].size=a.attributeData[y].size:h[y].size||console.warn("PIXI Geometry attribute '".concat(y,"' size cannot be determined (likely the bound shader does not have the attribute)")),f[h[y].buffer]+=h[y].size*Nr[h[y].type];for(var g in h){var m=h[g],v=m.size;void 0===m.stride&&(f[m.buffer]===v*Nr[m.type]?m.stride=0:m.stride=f[m.buffer]),void 0===m.start&&(m.start=d[m.buffer],d[m.buffer]+=v*Nr[m.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(var w=0;w<l.length;w++){var b=l[w];o.bind(b),n&&b._glBuffers[i].refCount++}return this.activateVao(e,a),u[a.id]=c,u[s]=c,r.bindVertexArray(null),o.unbind(q.ARRAY_BUFFER),c}},{key:"disposeGeometry",value:function(e,t){var n;if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,o=e.buffers,a=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(e.disposeRunner.remove(this),r){if(a)for(var s=0;s<o.length;s++){var u=o[s]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,0===u.refCount&&!t&&a.dispose(o[s],t))}if(!t)for(var c in r)if("g"===c[0]){var l=r[c];this._activeVao===l&&this.unbind(),i.deleteVertexArray(l)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}}},{key:"disposeAll",value:function(e){for(var t=Object.keys(this.managedGeometries),n=0;n<t.length;n++)this.disposeGeometry(this.managedGeometries[t[n]],e)}},{key:"activateVao",value:function(e,t){var n=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);var s=null;for(var u in a){var c=a[u],l=o[c.buffer],h=l._glBuffers[r];if(t.attributeData[u]){s!==h&&(i.bind(l),s=h);var f=t.attributeData[u].location;if(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(f,c.divisor)}}}}},{key:"draw",value:function(e,t,n,r){var i=this.gl,o=this._activeGeometry;if(o.indexBuffer){var a=o.indexBuffer.data.BYTES_PER_ELEMENT,s=2===a?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(e,t||o.indexBuffer.data.length,s,(n||0)*a,r||1):i.drawElements(e,t||o.indexBuffer.data.length,s,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?i.drawArraysInstanced(e,n,t||o.getSize(),r||1):i.drawArrays(e,n,t||o.getSize());return this}},{key:"unbind",value:function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}},{key:"destroy",value:function(){this.renderer=null}}]),e}();Ur.extension={type:Wt.RendererSystem,name:"geometry"},Kt.add(Ur);var jr=new On,Gr=function(){function e(t,n){_classCallCheck(this,e),this._texture=t,this.mapCoord=new On,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=_typeof(n)>"u"?.5:n,this.isSimple=!1}return _createClass(e,[{key:"texture",get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1}},{key:"multiplyUvs",value:function(e,t){void 0===t&&(t=e);for(var n=this.mapCoord,r=0;r<e.length;r+=2){var i=e[r],o=e[r+1];t[r]=i*n.a+o*n.c+n.tx,t[r+1]=i*n.b+o*n.d+n.ty}return t}},{key:"update",value:function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var n=t._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var r=t.orig,i=t.trim;i&&(jr.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(jr));var o=t.baseTexture,a=this.uClampFrame,s=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+s+u)/o.width,a[1]=(t._frame.y+s+u)/o.height,a[2]=(t._frame.x+t._frame.width-s+u)/o.width,a[3]=(t._frame.y+t._frame.height-s+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&0===t.rotate,!0}}]),e}(),zr=function(e){function t(e,n,r){var i;_classCallCheck(this,t);var o=null;return"string"!=typeof e&&void 0===n&&void 0===r&&(o=e,e=void 0,n=void 0,r=void 0),(i=_callSuper(this,t,[e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",n||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",r])).maskSprite=o,i.maskMatrix=new On,i}return _inherits(t,e),_createClass(t,[{key:"maskSprite",get:function(){return this._maskSprite},set:function(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}},{key:"apply",value:function(e,t,n,r){var i=this._maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Gr(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,n,r))}}]),t}(pr),Hr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,e),this.type=K.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=pr.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return _createClass(e,[{key:"filter",get:function(){return this._filters?this._filters[0]:null},set:function(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}},{key:"reset",value:function(){this.pooled&&(this.maskObject=null,this.type=K.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}},{key:"copyCountersOrReset",value:function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}]),e}(),Vr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return _createClass(e,[{key:"setMaskStack",value:function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}},{key:"push",value:function(e,t){var n=t;if(!n.isMaskData){var r=this.maskDataPool.pop()||new Hr;r.pooled=!0,r.maskObject=t,n=r}var i=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==K.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case K.SCISSOR:this.renderer.scissor.push(n);break;case K.STENCIL:this.renderer.stencil.push(n);break;case K.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case K.COLOR:this.pushColorMask(n)}n.type===K.SPRITE&&this.maskStack.push(n)}},{key:"pop",value:function(e){var t=this.maskStack.pop();if(t&&t._target===e){if(t.enabled)switch(t.type){case K.SCISSOR:this.renderer.scissor.pop(t);break;case K.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case K.SPRITE:this.popSpriteMask(t);break;case K.COLOR:this.popColorMask(t)}if(t.reset(),t.pooled&&this.maskDataPool.push(t),0!==this.maskStack.length){var n=this.maskStack[this.maskStack.length-1];n.type===K.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}},{key:"detect",value:function(e){var t=e.maskObject;t?t.isSprite?e.type=K.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=K.SCISSOR:e.type=K.STENCIL:e.type=K.COLOR}},{key:"pushSpriteMask",value:function(e){var t=e.maskObject,n=e._target,r=e._filters;r||((r=this.alphaMaskPool[this.alphaMaskIndex])||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new zr])),r[0].resolution=e.resolution,r[0].multisample=e.multisample,r[0].maskSprite=t;var i=n.filterArea;n.filterArea=t.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=i,e._filters||this.alphaMaskIndex++}},{key:"popSpriteMask",value:function(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}},{key:"pushColorMask",value:function(e){var t=e._colorMask,n=e._colorMask=t&e.colorMask;n!==t&&this.renderer.gl.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))}},{key:"popColorMask",value:function(e){var t=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==t&&this.renderer.gl.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))}},{key:"destroy",value:function(){this.renderer=null}}]),e}();Vr.extension={type:Wt.RendererSystem,name:"mask"},Kt.add(Vr);var Wr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.maskStack=[],this.glConst=0}return _createClass(e,[{key:"getStackLength",value:function(){return this.maskStack.length}},{key:"setMaskStack",value:function(e){var t=this.renderer.gl,n=this.getStackLength();this.maskStack=e;var r=this.getStackLength();r!==n&&(0===r?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}},{key:"_useCurrent",value:function(){}},{key:"destroy",value:function(){this.renderer=null,this.maskStack=null}}]),e}(),$r=new On,Yr=[],Kr=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).glConst=Q.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,n}return _inherits(t,e),_createClass(t,[{key:"getStackLength",value:function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}},{key:"calcScissorRect",value:function(e){var t;if(!e._scissorRectLocal){var n=e._scissorRect,r=e.maskObject,i=this.renderer,o=i.renderTexture,a=r.getBounds(!0,null!==(t=Yr.pop())&&void 0!==t?t:new Cn);this.roundFrameToPixels(a,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),n&&a.fit(n),e._scissorRectLocal=a}}},{key:"testScissor",value:function(e){var n=e.maskObject;if(!n.isFastRect||!n.isFastRect()||t.isMatrixRotated(n.worldTransform)||t.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);var r=e._scissorRectLocal;return r.width>0&&r.height>0}},{key:"roundFrameToPixels",value:function(e,n,r,i,o){t.isMatrixRotated(o)||((o=o?$r.copyFrom(o):$r.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(o,e),e.fit(i),e.x=Math.round(e.x*n),e.y=Math.round(e.y*n),e.width=Math.round(e.width*n),e.height=Math.round(e.height*n))}},{key:"push",value:function(e){e._scissorRectLocal||this.calcScissorRect(e);var t=this.renderer.gl;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}},{key:"pop",value:function(e){var t=this.renderer.gl;e&&Yr.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}},{key:"_useCurrent",value:function(){var e,t=this.maskStack[this.maskStack.length-1]._scissorRect;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}}],[{key:"isMatrixRotated",value:function(e){if(!e)return!1;var t=e.a,n=e.b,r=e.c,i=e.d;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}}]),t}(Wr);Kr.extension={type:Wt.RendererSystem,name:"scissor"};var Xr=Kr;Kt.add(Xr);var Zr=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).glConst=Q.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,n}return _inherits(t,e),_createClass(t,[{key:"getStackLength",value:function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}},{key:"push",value:function(e){var t=e.maskObject,n=this.renderer.gl,r=e._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;var i=e._colorMask;0!==i&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==i&&(e._colorMask=i,n.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))),this._useCurrent()}},{key:"pop",value:function(e){var t=this.renderer.gl;if(0===this.getStackLength())t.disable(t.STENCIL_TEST);else{var n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,r=n?n._colorMask:15;0!==r&&(n._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==r&&(n._colorMask=r,t.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))),this._useCurrent()}}},{key:"_useCurrent",value:function(){var e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}]),t}(Wr);Zr.extension={type:Wt.RendererSystem,name:"stencil"},Kt.add(Zr);var qr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:function(){return _e("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get:function(){return _e("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get:function(){return _e("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}return _createClass(e,[{key:"init",value:function(){var e=this.rendererPlugins;for(var t in e)this.plugins[t]=new e[t](this.renderer)}},{key:"destroy",value:function(){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}]),e}();qr.extension={type:[Wt.RendererSystem,Wt.CanvasRendererSystem],name:"_plugin"},Kt.add(qr);var Jr=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new On,this.transform=null}return _createClass(e,[{key:"update",value:function(e,t,n,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}},{key:"calculateProjection",value:function(e,t,n,r){var i=this.projectionMatrix,o=r?-1:1;i.identity(),i.a=1/t.width*2,i.d=o*(1/t.height*2),i.tx=-1-t.x*i.a,i.ty=-o-t.y*i.d}},{key:"setTransform",value:function(e){}},{key:"destroy",value:function(){this.renderer=null}}]),e}();Jr.extension={type:Wt.RendererSystem,name:"projection"},Kt.add(Jr);var Qr=new Gn,ei=new Cn,ti=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this._tempMatrix=new On}return _createClass(e,[{key:"generateTexture",value:function(e,t){var n,r=t||{},i=r.region,o=_objectWithoutProperties(r,_excluded),a=(null===i||void 0===i?void 0:i.copyTo(ei))||e.getLocalBounds(ei,!0),s=o.resolution||this.renderer.resolution;a.width=Math.max(a.width,1/s),a.height=Math.max(a.height,1/s),o.width=a.width,o.height=a.height,o.resolution=s,null!==(n=o.multisample)&&void 0!==n||(o.multisample=this.renderer.multisample);var u=Sr.create(o);this._tempMatrix.tx=-a.x,this._tempMatrix.ty=-a.y;var c=e.transform;return e.transform=Qr,this.renderer.render(e,{renderTexture:u,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=c,u}},{key:"destroy",value:function(){}}]),e}();ti.extension={type:[Wt.RendererSystem,Wt.CanvasRendererSystem],name:"textureGenerator"},Kt.add(ti);var ni=new Cn,ri=new Cn,ii=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Cn,this.destinationFrame=new Cn,this.viewportFrame=new Cn}return _createClass(e,[{key:"contextChange",value:function(){var e,t=null===(e=this.renderer)||void 0===e?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}},{key:"bind",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,a=this.renderer;this.current=r,r?(n=(e=r.baseTexture).resolution,i||(ni.width=r.frame.width,ni.height=r.frame.height,i=ni),o||(ri.x=r.frame.x,ri.y=r.frame.y,ri.width=i.width,ri.height=i.height,o=ri),t=e.framebuffer):(n=a.resolution,i||(ni.width=a._view.screen.width,ni.height=a._view.screen.height,i=ni),o||((o=ni).width=i.width,o.height=i.height));var s=this.viewportFrame;s.x=o.x*n,s.y=o.y*n,s.width=o.width*n,s.height=o.height*n,r||(s.y=a.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(t,s),this.renderer.projection.update(o,i,n,!t),r?this.renderer.mask.setMaskStack(e.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(i),this.destinationFrame.copyFrom(o)}},{key:"clear",value:function(e,t){var n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=ut.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);var i=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=i.width!==o.width||i.height!==o.height;if(a){var s=this.viewportFrame,u=s.x,c=s.y,l=s.width,h=s.height;u=Math.round(u),c=Math.round(c),l=Math.round(l),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(u,c,l,h)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,t),a&&this.renderer.scissor.pop()}},{key:"resize",value:function(){this.bind(null)}},{key:"reset",value:function(){this.bind(null)}},{key:"destroy",value:function(){this.renderer=null}}]),e}();ii.extension={type:Wt.RendererSystem,name:"renderTexture"},Kt.add(ii);var oi=_createClass((function e(){_classCallCheck(this,e)})),ai=function(){function e(t,n){_classCallCheck(this,e),this.program=t,this.uniformData=n,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return _createClass(e,[{key:"destroy",value:function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}]),e}();function si(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function ui(e){for(var t=new Array(e),n=0;n<t.length;n++)t[n]=!1;return t}function ci(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return ui(2*t);case"bvec3":return ui(3*t);case"bvec4":return ui(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function li(e,t){var n,r=e.getShaderSource(t).split("\n").map((function(e,t){return"".concat(t,": ").concat(e)})),i=e.getShaderInfoLog(t),o=i.split("\n"),a={},s=o.map((function(e){return parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(e){return!(!e||a[e])&&(a[e]=!0,!0)})),u=[""];s.forEach((function(e){r[e-1]="%c".concat(r[e-1],"%c"),u.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var c=r.join("\n");u[0]=c,console.error(i),console.groupCollapsed("click to view full shader code"),(n=console).warn.apply(n,u),console.groupEnd()}function hi(e,t){var n,r=si(e,e.VERTEX_SHADER,t.vertexSrc),i=si(e,e.FRAGMENT_SHADER,t.fragmentSrc),o=e.createProgram();e.attachShader(o,r),e.attachShader(o,i);var a=null===(n=t.extra)||void 0===n?void 0:n.transformFeedbackVaryings;if(a&&("function"!=typeof e.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(o,a.names,"separate"===a.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||function(e,t,n,r){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(n,e.COMPILE_STATUS)||li(e,n),e.getShaderParameter(r,e.COMPILE_STATUS)||li(e,r),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}(e,o,r,i),t.attributeData=function(e,t){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=t.getActiveAttrib(e,i);if(!o.name.startsWith("gl_")){var a=Qn(t,o.type),s={type:a,name:o.name,size:Zn(a),location:t.getAttribLocation(e,o.name)};n[o.name]=s}}return n}(o,e),t.uniformData=function(e,t){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;i++){var o=t.getActiveUniform(e,i),a=o.name.replace(/\[.*?\]$/,""),s=!!o.name.match(/\[.*?\]$/),u=Qn(t,o.type);n[a]={name:a,index:i,type:u,size:o.size,isArray:s,value:ci(u,o.size)}}return n}(o,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){var s=Object.keys(t.attributeData);s.sort((function(e,t){return e>t?1:-1}));for(var u=0;u<s.length;u++)t.attributeData[s[u]].location=u,e.bindAttribLocation(o,u,s[u]);e.linkProgram(o)}e.deleteShader(r),e.deleteShader(i);var c={};for(var l in t.uniformData){var h=t.uniformData[l];c[l]={location:e.getUniformLocation(o,l),value:ci(h.type,h.size)}}return new ai(o,c)}function fi(e,t,n,r,i){n.buffer.update(i)}var di,pi={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},yi={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function gi(e){for(var t=e.map((function(e){return{data:e,offset:0,dataLen:0,dirty:0}})),n=0,r=0,i=0,o=0;o<t.length;o++){var a=t[o];if(n=yi[a.data.type],a.data.size>1&&(n=Math.max(n,16)*a.data.size),a.dataLen=n,r%n!=0&&r<16){var s=r%n%16;r+=s,i+=s}r+n>16?(i=16*Math.ceil(i/16),a.offset=i,i+=n,r=n):(a.offset=i,r+=n,i+=n)}return{uboElements:t,size:i=16*Math.ceil(i/16)}}function mi(e,t){var n=[];for(var r in e)t[r]&&n.push(t[r]);return n.sort((function(e,t){return e.index-t.index})),n}function vi(e,t){if(!e.autoManage)return{size:0,syncFunc:fi};for(var n=gi(mi(e.uniforms,t)),r=n.uboElements,i=n.size,o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],a=0;a<r.length;a++){for(var s=r[a],u=e.uniforms[s.data.name],c=s.data.name,l=!1,h=0;h<Hn.length;h++){var f=Hn[h];if(f.codeUbo&&f.test(s.data,u)){o.push("offset = ".concat(s.offset/4,";"),Hn[h].codeUbo(s.data.name,u)),l=!0;break}}if(!l)if(s.data.size>1){var d=Zn(s.data.type),p=Math.max(yi[s.data.type]/16,1),y=d/p,g=(4-y%4)%4;o.push("\n                cv = ud.".concat(c,".value;\n                v = uv.").concat(c,";\n                offset = ").concat(s.offset/4,";\n\n                t = 0;\n\n                for(var i=0; i < ").concat(s.data.size*p,"; i++)\n                {\n                    for(var j = 0; j < ").concat(y,"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ").concat(g,";\n                }\n\n                "))}else{var m=pi[s.data.type];o.push("\n                cv = ud.".concat(c,".value;\n                v = uv.").concat(c,";\n                offset = ").concat(s.offset/4,";\n                ").concat(m,";\n                "))}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))}}function wi(){if("boolean"==typeof di)return di;try{di=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch(e){di=!1}return di}var bi=0,xi={textureCount:0,uboCount:0},_i=function(){function e(t){_classCallCheck(this,e),this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=bi++}return _createClass(e,[{key:"systemCheck",value:function(){if(!wi())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}},{key:"contextChange",value:function(e){this.gl=e,this.reset()}},{key:"bind",value:function(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;var n=e.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),t||(xi.textureCount=0,xi.uboCount=0,this.syncUniformGroup(e.uniformGroup,xi)),r}},{key:"setUniforms",value:function(e){var t=this.shader.program,n=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(n.uniformData,e,this.renderer)}},{key:"syncUniformGroup",value:function(e,t){var n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,t))}},{key:"syncUniforms",value:function(e,t,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,n)}},{key:"createSyncGroups",value:function(e){var t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=function(e,t){var n=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var r in e.uniforms){var i=t[r];if(i){for(var o=e.uniforms[r],a=!1,s=0;s<Hn.length;s++)if(Hn[s].test(i,o)){n.push(Hn[s].code(r,o)),a=!0;break}if(!a){var u=(1!==i.size||i.isArray?Wn:Vn)[i.type].replace("location",'ud["'.concat(r,'"].location'));n.push('\n            cu = ud["'.concat(r,'"];\n            cv = cu.value;\n            v = uv["').concat(r,'"];\n            ').concat(u,";"))}}else{var c;!0===(null===(c=e.uniforms[r])||void 0===c?void 0:c.group)&&(e.uniforms[r].ubo?n.push("\n                        renderer.shader.syncUniformBufferGroup(uv.".concat(r,", '").concat(r,"');\n                    ")):n.push("\n                        renderer.shader.syncUniformGroup(uv.".concat(r,", syncData);\n                    ")))}}return new Function("ud","uv","renderer","syncData",n.join("\n"))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}},{key:"syncUniformBufferGroup",value:function(e,t){var n=this.getGlProgram();if(!e.static||0!==e.dirtyId||!n.uniformGroups[e.id]){e.dirtyId=0;var r=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,t);e.buffer.update(),r(n.uniformData,e.uniforms,this.renderer,xi,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[t])}},{key:"createSyncBufferGroup",value:function(e,t,n){var r=this.renderer.gl;this.renderer.buffer.bind(e.buffer);var i=this.gl.getUniformBlockIndex(t.program,n);t.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(e,this.shader.program.uniformData,"ubo"),a=this._uboCache[o];if(a||(a=this._uboCache[o]=vi(e,this.shader.program.uniformData)),e.autoManage){var s=new Float32Array(a.size/4);e.buffer.update(s)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}},{key:"getSignature",value:function(e,t,n){var r=e.uniforms,i=["".concat(n,"-")];for(var o in r)i.push(o),t[o]&&i.push(t[o].type);return i.join("-")}},{key:"getGlProgram",value:function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}},{key:"generateProgram",value:function(e){var t=this.gl,n=e.program,r=hi(t,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r}},{key:"reset",value:function(){this.program=null,this.shader=null}},{key:"disposeShader",value:function(e){this.shader===e&&(this.shader=null)}},{key:"destroy",value:function(){this.renderer=null,this.destroyed=!0}}]),e}();_i.extension={type:Wt.RendererSystem,name:"shader"},Kt.add(_i);var Ii=function(){function e(t){_classCallCheck(this,e),this.renderer=t}return _createClass(e,[{key:"run",value:function(e){var t=this.renderer;t.runners.init.emit(t.options),e.hello&&console.log("PixiJS 7.4.0 - ".concat(t.rendererLogId," - https://pixijs.com")),t.resize(t.screen.width,t.screen.height)}},{key:"destroy",value:function(){}}]),e}();Ii.defaultOptions={hello:!1},Ii.extension={type:[Wt.RendererSystem,Wt.CanvasRendererSystem],name:"startup"},Kt.add(Ii);var Ai=function(){function e(){_classCallCheck(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=M.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Qt,this.defaultState.blend=!0}return _createClass(e,[{key:"contextChange",value:function(e){this.gl=e,this.blendModes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[M.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.ADD]=[e.ONE,e.ONE],t[M.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.NONE]=[0,0],t[M.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[M.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[M.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[M.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[M.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[M.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[M.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[M.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[M.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[M.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[M.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()}},{key:"set",value:function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,n=0;t;)1&t&&this.map[n].call(this,!!(e.data&1<<n)),t>>=1,n++;this.stateId=e.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,e)}},{key:"forceState",value:function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(var n=0;n<this.checks.length;n++)this.checks[n](this,e);this.stateId=e.data}},{key:"setBlend",value:function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}},{key:"setOffset",value:function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}},{key:"setDepthTest",value:function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}},{key:"setDepthMask",value:function(e){this.gl.depthMask(e)}},{key:"setCullFace",value:function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}},{key:"setFrontFace",value:function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}},{key:"setBlendMode",value:function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],n=this.gl;2===t.length?n.blendFunc(t[0],t[1]):n.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,n.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}}},{key:"setPolygonOffset",value:function(e,t){this.gl.polygonOffset(e,t)}},{key:"reset",value:function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}},{key:"updateCheck",value:function(e,t){var n=this.checks.indexOf(e);t&&-1===n?this.checks.push(e):!t&&-1!==n&&this.checks.splice(n,1)}},{key:"destroy",value:function(){this.gl=null}}],[{key:"checkBlendMode",value:function(e,t){e.setBlendMode(t.blendMode)}},{key:"checkPolygonOffset",value:function(e,t){e.setPolygonOffset(1,t.polygonOffset)}}]),e}();Ai.extension={type:Wt.RendererSystem,name:"state"};var Ci=Ai;Kt.add(Ci);var ki=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).runners={},e._systemsHash={},e}return _inherits(t,e),_createClass(t,[{key:"setup",value:function(e){var t;this.addRunners.apply(this,_toConsumableArray(e.runners));var n,r=(null!==(t=e.priority)&&void 0!==t?t:[]).filter((function(t){return e.systems[t]})),i=_createForOfIteratorHelper([].concat(_toConsumableArray(r),_toConsumableArray(Object.keys(e.systems).filter((function(e){return!r.includes(e)})))));try{for(i.s();!(n=i.n()).done;){var o=n.value;this.addSystem(e.systems[o],o)}}catch(a){i.e(a)}finally{i.f()}}},{key:"addRunners",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e.runners[t]=new nn(t)}))}},{key:"addSystem",value:function(e,t){var n=new e(this);if(this[t])throw new Error('Whoops! The name "'.concat(t,'" is already in use'));for(var r in this[t]=n,this._systemsHash[t]=n,this.runners)this.runners[r].add(n);return this}},{key:"emitWithCustomOptions",value:function(e,t){var n=this,r=Object.keys(this._systemsHash);e.items.forEach((function(i){var o=r.find((function(e){return n._systemsHash[e]===i}));i[e.name](t[o])}))}},{key:"destroy",value:function(){Object.values(this.runners).forEach((function(e){e.destroy()})),this._systemsHash={}}}]),t}(ve),Si=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=e.defaultMaxIdle,this.checkCountMax=e.defaultCheckCountMax,this.mode=e.defaultMode}return _createClass(e,[{key:"postrender",value:function(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==$.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}},{key:"run",value:function(){for(var e=this.renderer.texture,t=e.managedTextures,n=!1,r=0;r<t.length;r++){var i=t[r];i.resource&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[r]=null,n=!0)}if(n){for(var o=0,a=0;a<t.length;a++)null!==t[a]&&(t[o++]=t[a]);t.length=o}}},{key:"unload",value:function(e){var t=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&t.destroyTexture(n);for(var r=e.children.length-1;r>=0;r--)this.unload(e.children[r])}},{key:"destroy",value:function(){this.renderer=null}}]),e}();Si.defaultMode=$.AUTO,Si.defaultMaxIdle=3600,Si.defaultCheckCountMax=600,Si.extension={type:Wt.RendererSystem,name:"textureGC"};var Ti=Si;Kt.add(Ti);var Ei=_createClass((function e(t){_classCallCheck(this,e),this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=U.UNSIGNED_BYTE,this.internalFormat=F.RGBA,this.samplerType=0})),Oi=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new un,this.hasIntegerTextures=!1}return _createClass(e,[{key:"contextChange",value:function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(e,t,n){return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n={},U.UNSIGNED_BYTE,(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t={},F.RGBA,e.RGBA8),F.RGB,e.RGB8),F.RG,e.RG8),F.RED,e.R8),F.RGBA_INTEGER,e.RGBA8UI),F.RGB_INTEGER,e.RGB8UI),F.RG_INTEGER,e.RG8UI),F.RED_INTEGER,e.R8UI),F.ALPHA,e.ALPHA),F.LUMINANCE,e.LUMINANCE),_defineProperty(t,F.LUMINANCE_ALPHA,e.LUMINANCE_ALPHA))),U.BYTE,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA,e.RGBA8_SNORM),F.RGB,e.RGB8_SNORM),F.RG,e.RG8_SNORM),F.RED,e.R8_SNORM),F.RGBA_INTEGER,e.RGBA8I),F.RGB_INTEGER,e.RGB8I),F.RG_INTEGER,e.RG8I),F.RED_INTEGER,e.R8I)),U.UNSIGNED_SHORT,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA_INTEGER,e.RGBA16UI),F.RGB_INTEGER,e.RGB16UI),F.RG_INTEGER,e.RG16UI),F.RED_INTEGER,e.R16UI),F.DEPTH_COMPONENT,e.DEPTH_COMPONENT16)),U.SHORT,_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA_INTEGER,e.RGBA16I),F.RGB_INTEGER,e.RGB16I),F.RG_INTEGER,e.RG16I),F.RED_INTEGER,e.R16I)),U.UNSIGNED_INT,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA_INTEGER,e.RGBA32UI),F.RGB_INTEGER,e.RGB32UI),F.RG_INTEGER,e.RG32UI),F.RED_INTEGER,e.R32UI),F.DEPTH_COMPONENT,e.DEPTH_COMPONENT24)),U.INT,_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA_INTEGER,e.RGBA32I),F.RGB_INTEGER,e.RGB32I),F.RG_INTEGER,e.RG32I),F.RED_INTEGER,e.R32I)),U.FLOAT,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA,e.RGBA32F),F.RGB,e.RGB32F),F.RG,e.RG32F),F.RED,e.R32F),F.DEPTH_COMPONENT,e.DEPTH_COMPONENT32F)),U.HALF_FLOAT,_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA,e.RGBA16F),F.RGB,e.RGB16F),F.RG,e.RG16F),F.RED,e.R16F)),U.UNSIGNED_SHORT_5_6_5,_defineProperty({},F.RGB,e.RGB565)),U.UNSIGNED_SHORT_4_4_4_4,_defineProperty({},F.RGBA,e.RGBA4)),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,U.UNSIGNED_SHORT_5_5_5_1,_defineProperty({},F.RGBA,e.RGB5_A1)),U.UNSIGNED_INT_2_10_10_10_REV,_defineProperty(_defineProperty({},F.RGBA,e.RGB10_A2),F.RGBA_INTEGER,e.RGB10_A2UI)),U.UNSIGNED_INT_10F_11F_11F_REV,_defineProperty({},F.RGB,e.R11F_G11F_B10F)),U.UNSIGNED_INT_5_9_9_9_REV,_defineProperty({},F.RGB,e.RGB9_E5)),U.UNSIGNED_INT_24_8,_defineProperty({},F.DEPTH_STENCIL,e.DEPTH24_STENCIL8)),U.FLOAT_32_UNSIGNED_INT_24_8_REV,_defineProperty({},F.DEPTH_STENCIL,e.DEPTH32F_STENCIL8))):_defineProperty(_defineProperty(_defineProperty(_defineProperty({},U.UNSIGNED_BYTE,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA,e.RGBA),F.RGB,e.RGB),F.ALPHA,e.ALPHA),F.LUMINANCE,e.LUMINANCE),F.LUMINANCE_ALPHA,e.LUMINANCE_ALPHA)),U.UNSIGNED_SHORT_5_6_5,_defineProperty({},F.RGB,e.RGB)),U.UNSIGNED_SHORT_4_4_4_4,_defineProperty({},F.RGBA,e.RGBA)),U.UNSIGNED_SHORT_5_5_5_1,_defineProperty({},F.RGBA,e.RGBA))}(e),this.samplerTypes=function(e,t){return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t={},e.RGB,j.FLOAT),e.RGBA,j.FLOAT),e.ALPHA,j.FLOAT),e.LUMINANCE,j.FLOAT),e.LUMINANCE_ALPHA,j.FLOAT),e.R8,j.FLOAT),e.R8_SNORM,j.FLOAT),e.RG8,j.FLOAT),e.RG8_SNORM,j.FLOAT),e.RGB8,j.FLOAT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t,e.RGB8_SNORM,j.FLOAT),e.RGB565,j.FLOAT),e.RGBA4,j.FLOAT),e.RGB5_A1,j.FLOAT),e.RGBA8,j.FLOAT),e.RGBA8_SNORM,j.FLOAT),e.RGB10_A2,j.FLOAT),e.RGB10_A2UI,j.FLOAT),e.SRGB8,j.FLOAT),e.SRGB8_ALPHA8,j.FLOAT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t,e.R16F,j.FLOAT),e.RG16F,j.FLOAT),e.RGB16F,j.FLOAT),e.RGBA16F,j.FLOAT),e.R32F,j.FLOAT),e.RG32F,j.FLOAT),e.RGB32F,j.FLOAT),e.RGBA32F,j.FLOAT),e.R11F_G11F_B10F,j.FLOAT),e.RGB9_E5,j.FLOAT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t,e.R8I,j.INT),e.R8UI,j.UINT),e.R16I,j.INT),e.R16UI,j.UINT),e.R32I,j.INT),e.R32UI,j.UINT),e.RG8I,j.INT),e.RG8UI,j.UINT),e.RG16I,j.INT),e.RG16UI,j.UINT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t,e.RG32I,j.INT),e.RG32UI,j.UINT),e.RGB8I,j.INT),e.RGB8UI,j.UINT),e.RGB16I,j.INT),e.RGB16UI,j.UINT),e.RGB32I,j.INT),e.RGB32UI,j.UINT),e.RGBA8I,j.INT),e.RGBA8UI,j.UINT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t,e.RGBA16I,j.INT),e.RGBA16UI,j.UINT),e.RGBA32I,j.INT),e.RGBA32UI,j.UINT),e.DEPTH_COMPONENT16,j.FLOAT),e.DEPTH_COMPONENT24,j.FLOAT),e.DEPTH_COMPONENT32F,j.FLOAT),e.DEPTH_STENCIL,j.FLOAT),e.DEPTH24_STENCIL8,j.FLOAT),e.DEPTH32F_STENCIL8,j.FLOAT)):_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},e.RGB,j.FLOAT),e.RGBA,j.FLOAT),e.ALPHA,j.FLOAT),e.LUMINANCE,j.FLOAT),e.LUMINANCE_ALPHA,j.FLOAT),e.DEPTH_STENCIL,j.FLOAT)}(e);var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var n=0;n<t;n++)this.boundTextures[n]=null;this.emptyTextures={};var r=new Ei(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Ei(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(var i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(var o=0;o<this.boundTextures.length;o++)this.bind(null,o)}},{key:"bind",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.gl;if(null!==(n=e=null===(t=e)||void 0===t?void 0:t.castToBaseTexture())&&void 0!==n&&n.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;var o=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(e.target,o.texture)),o.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(e)):o.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}},{key:"reset",value:function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}},{key:"unbind",value:function(e){var t=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(var i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(t.activeTexture(t.TEXTURE0+i),this.currentLocation=i),t.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}},{key:"ensureSamplerType",value:function(e){var t=this.boundTextures,n=this.hasIntegerTextures,r=this.CONTEXT_UID;if(n)for(var i=e-1;i>=0;--i){var o=t[i];o&&o._glTextures[r].samplerType!==j.FLOAT&&this.renderer.texture.unbind(o)}}},{key:"initTexture",value:function(e){var t=new Ei(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}},{key:"initTextureType",value:function(e,t){var n,r,i;t.internalFormat=null!==(n=null===(r=this.internalFormats[e.type])||void 0===r?void 0:r[e.format])&&void 0!==n?n:e.format,t.samplerType=null!==(i=this.samplerTypes[t.internalFormat])&&void 0!==i?i:j.FLOAT,2===this.webGLVersion&&e.type===U.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}},{key:"updateTexture",value:function(e){var t,n=e._glTextures[this.CONTEXT_UID];if(n){var r=this.renderer;if(this.initTextureType(e,n),null!==(t=e.resource)&&void 0!==t&&t.upload(r,e,n))n.samplerType!==j.FLOAT&&(this.hasIntegerTextures=!0);else{var i=e.realWidth,o=e.realHeight,a=r.gl;(n.width!==i||n.height!==o||n.dirtyId<0)&&(n.width=i,n.height=o,a.texImage2D(e.target,0,n.internalFormat,i,o,0,e.format,n.type,null))}e.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(e),n.dirtyId=e.dirtyId}}},{key:"destroyTexture",value:function(e,t){var n=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var r=this.managedTextures.indexOf(e);-1!==r&&kt(this.managedTextures,r,1)}}},{key:"updateTextureStyle",value:function(e){var t,n=e._glTextures[this.CONTEXT_UID];n&&(e.mipmap!==H.POW2&&2===this.webGLVersion||e.isPowerOfTwo?n.mipmap=e.mipmap>=1:n.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?n.wrapMode=e.wrapMode:n.wrapMode=z.CLAMP,null!==(t=e.resource)&&void 0!==t&&t.style(this.renderer,e,n)||this.setStyle(e,n),n.dirtyStyleId=e.dirtyStyleId)}},{key:"setStyle",value:function(e,t){var n=this.gl;if(t.mipmap&&e.mipmap!==H.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,t.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===G.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===G.LINEAR){var i=Math.min(e.anisotropicLevel,n.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===G.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===G.LINEAR?n.LINEAR:n.NEAREST)}},{key:"destroy",value:function(){this.renderer=null}}]),e}();Oi.extension={type:Wt.RendererSystem,name:"texture"},Kt.add(Oi);var Pi=function(){function e(t){_classCallCheck(this,e),this.renderer=t}return _createClass(e,[{key:"contextChange",value:function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}},{key:"bind",value:function(e){var t=this.gl,n=this.CONTEXT_UID,r=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,r)}},{key:"unbind",value:function(){var e=this.gl;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}},{key:"beginTransformFeedback",value:function(e,t){var n=this.gl,r=this.renderer;t&&r.shader.bind(t),n.beginTransformFeedback(e)}},{key:"endTransformFeedback",value:function(){this.gl.endTransformFeedback()}},{key:"createGLTransformFeedback",value:function(e){var t=this.gl,n=this.renderer,r=this.CONTEXT_UID,i=t.createTransformFeedback();e._glTransformFeedbacks[r]=i,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,i);for(var o=0;o<e.buffers.length;o++){var a=e.buffers[o];a&&(n.buffer.update(a),a._glBuffers[r].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),i}},{key:"disposeTransformFeedback",value:function(e,t){var n=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);var i=this.renderer.buffer;if(i)for(var o=0;o<e.buffers.length;o++){var a=e.buffers[o];if(a){var s=a._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0===s.refCount&&!t&&i.dispose(a,t))}}n&&(t||r.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}},{key:"destroy",value:function(){this.renderer=null}}]),e}();Pi.extension={type:Wt.RendererSystem,name:"transformFeedback"},Kt.add(Pi);var Ri=function(){function e(t){_classCallCheck(this,e),this.renderer=t}return _createClass(e,[{key:"init",value:function(e){this.screen=new Cn(0,0,e.width,e.height),this.element=e.view||Q.ADAPTER.createCanvas(),this.resolution=e.resolution||Q.RESOLUTION,this.autoDensity=!!e.autoDensity}},{key:"resizeView",value:function(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);var n=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.element.style.width="".concat(n,"px"),this.element.style.height="".concat(r,"px")),this.renderer.emit("resize",n,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}},{key:"destroy",value:function(e){var t;e&&null!==(t=this.element.parentNode)&&void 0!==t&&t.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}]),e}();Ri.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Ri.extension={type:[Wt.RendererSystem,Wt.CanvasRendererSystem],name:"_view"},Kt.add(Ri),Q.PREFER_ENV=R.WEBGL2,Q.STRICT_TEXTURE_CACHE=!1,Q.RENDER_OPTIONS=_objectSpread(_objectSpread(_objectSpread(_objectSpread({},vr.defaultOptions),yr.defaultOptions),Ri.defaultOptions),Ii.defaultOptions),Object.defineProperties(Q,{WRAP_MODE:{get:function(){return un.defaultOptions.wrapMode},set:function(e){_e("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),un.defaultOptions.wrapMode=e}},SCALE_MODE:{get:function(){return un.defaultOptions.scaleMode},set:function(e){_e("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),un.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get:function(){return un.defaultOptions.mipmap},set:function(e){_e("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),un.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get:function(){return un.defaultOptions.anisotropicLevel},set:function(e){_e("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),un.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get:function(){return _e("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),pr.defaultResolution},set:function(e){pr.defaultResolution=e}},FILTER_MULTISAMPLE:{get:function(){return _e("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),pr.defaultMultisample},set:function(e){pr.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get:function(){return fr.defaultMaxTextures},set:function(e){_e("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),fr.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get:function(){return fr.defaultBatchSize},set:function(e){_e("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),fr.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get:function(){return fr.canUploadSameBuffer},set:function(e){_e("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),fr.canUploadSameBuffer=e}},GC_MODE:{get:function(){return Ti.defaultMode},set:function(e){_e("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Ti.defaultMode=e}},GC_MAX_IDLE:{get:function(){return Ti.defaultMaxIdle},set:function(e){_e("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Ti.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get:function(){return Ti.defaultCheckCountMax},set:function(e){_e("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Ti.defaultCheckCountMax=e}},PRECISION_VERTEX:{get:function(){return ir.defaultVertexPrecision},set:function(e){_e("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ir.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get:function(){return ir.defaultFragmentPrecision},set:function(e){_e("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ir.defaultFragmentPrecision=e}}});var Bi=function(e){return e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e}(Bi||{}),Di=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=n,this.priority=r,this.once=i}return _createClass(e,[{key:"match",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.fn===e&&this.context===t}},{key:"emit",value:function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}},{key:"connect",value:function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t}}]),e}(),Mi=function(){function e(){var t=this;_classCallCheck(this,e),this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Di(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return _createClass(e,[{key:"_requestIfNeeded",value:function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}},{key:"_cancelIfNeeded",value:function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}},{key:"_startIfPossible",value:function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bi.NORMAL;return this._addListener(new Di(e,t,n))}},{key:"addOnce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bi.NORMAL;return this._addListener(new Di(e,t,n,!0))}},{key:"_addListener",value:function(e){var t=this._head.next,n=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(n);break}n=t,t=t.next}e.previous||e.connect(n)}else e.connect(n);return this._startIfPossible(),this}},{key:"remove",value:function(e,t){for(var n=this._head.next;n;)n=n.match(e,t)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this}},{key:"count",get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e}},{key:"start",value:function(){this.started||(this.started=!0,this._requestIfNeeded())}},{key:"stop",value:function(){this.started&&(this.started=!1,this._cancelIfNeeded())}},{key:"destroy",value:function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}},{key:"update",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();if(n>this.lastTime){if((t=this.elapsedMS=n-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var r=n-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=n-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*e.targetFPMS;for(var i=this._head,o=i.next;o;)o=o.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=n}},{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var n=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,n)/1e3,e.targetFPMS);this._maxElapsedMS=1/r}},{key:"maxFPS",get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(0===e)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}}],[{key:"shared",get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared}},{key:"system",get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system}}]),e}();Mi.targetFPMS=.06;var Li=Mi;Object.defineProperties(Q,{TARGET_FPMS:{get:function(){return Li.targetFPMS},set:function(e){_e("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Li.targetFPMS=e}}});var Fi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"init",value:function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Bi.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Li.shared:new Li,e.autoStart&&this.start()}},{key:"destroy",value:function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}}}]),e}();Fi.extension=Wt.Application,Kt.add(Fi);var Ni=[];function Ui(e){var t,n=_createForOfIteratorHelper(Ni);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.test(e))return new r(e)}}catch(i){n.e(i)}finally{n.f()}throw new Error("Unable to auto-detect a suitable renderer.")}Kt.handleByList(Wt.Renderer,Ni);var ji="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",Gi="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",zi=function(){function e(t){_classCallCheck(this,e),this.renderer=t}return _createClass(e,[{key:"contextChange",value:function(e){var t;if(1===this.renderer.context.webGLVersion){var n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{var r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}t>=Z.HIGH?this.multisample=Z.HIGH:t>=Z.MEDIUM?this.multisample=Z.MEDIUM:t>=Z.LOW?this.multisample=Z.LOW:this.multisample=Z.NONE}},{key:"destroy",value:function(){}}]),e}();zi.extension={type:Wt.RendererSystem,name:"_multisample"},Kt.add(zi);var Hi=_createClass((function e(t){_classCallCheck(this,e),this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0})),Vi=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return _createClass(e,[{key:"destroy",value:function(){this.renderer=null}},{key:"contextChange",value:function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}},{key:"bind",value:function(e){var t=this.gl,n=this.CONTEXT_UID,r=e._glBuffers[n]||this.createGLBuffer(e);t.bindBuffer(e.type,r.buffer)}},{key:"unbind",value:function(e){this.gl.bindBuffer(e,null)}},{key:"bindBufferBase",value:function(e,t){var n=this.gl,r=this.CONTEXT_UID;if(this.boundBufferBases[t]!==e){var i=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[t]=e,n.bindBufferBase(n.UNIFORM_BUFFER,t,i.buffer)}}},{key:"bindBufferRange",value:function(e,t,n){var r=this.gl,i=this.CONTEXT_UID;n=n||0;var o=e._glBuffers[i]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,t||0,o.buffer,256*n,256)}},{key:"update",value:function(e){var t=this.gl,n=this.CONTEXT_UID,r=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,t.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{var i=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,i)}}},{key:"dispose",value:function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var n=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),n&&(t||r.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}}},{key:"disposeAll",value:function(e){for(var t=Object.keys(this.managedBuffers),n=0;n<t.length;n++)this.dispose(this.managedBuffers[t[n]],e)}},{key:"createGLBuffer",value:function(e){var t=this.CONTEXT_UID,n=this.gl;return e._glBuffers[t]=new Hi(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}]),e}();Vi.extension={type:Wt.RendererSystem,name:"buffer"},Kt.add(Vi);var Wi=function(){function e(t){_classCallCheck(this,e),this.renderer=t}return _createClass(e,[{key:"render",value:function(e,t){var n,r,i,o,a=this.renderer;if(t&&(n=t.renderTexture,r=t.clear,i=t.transform,o=t.skipUpdateTransform),this.renderingToScreen=!n,a.runners.prerender.emit(),a.emit("prerender"),a.projection.transform=i,!a.context.isLost){var s;if(n||(this.lastObjectRendered=e),!o){var u=e.enableTempParent();e.updateTransform(),e.disableTempParent(u)}a.renderTexture.bind(n),a.batch.currentRenderer.start(),(null!==(s=r)&&void 0!==s?s:a.background.clearBeforeRender)&&a.renderTexture.clear(),e.render(a),a.batch.currentRenderer.flush(),n&&(t.blit&&a.framebuffer.blit(),n.baseTexture.update()),a.runners.postrender.emit(),a.projection.transform=null,a.emit("postrender")}}},{key:"destroy",value:function(){this.renderer=null,this.lastObjectRendered=null}}]),e}();Wi.extension={type:Wt.RendererSystem,name:"objectRenderer"},Kt.add(Wi);var $i=function(e){function t(e){var n;_classCallCheck(this,t),(n=_callSuper(this,t)).type=B.WEBGL,e=Object.assign({},Q.RENDER_OPTIONS,e),n.gl=null,n.CONTEXT_UID=0,n.globalUniforms=new ar({projectionMatrix:new On},!0);var r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:t.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};return n.setup(r),"useContextAlpha"in e&&(_e("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&"notMultiplied"!==e.useContextAlpha,e.backgroundAlpha=!1===e.useContextAlpha?1:e.backgroundAlpha),n._plugin.rendererPlugins=t.__plugins,n.options=e,n.startup.run(n.options),n}return _inherits(t,e),_createClass(t,[{key:"render",value:function(e,t){this.objectRenderer.render(e,t)}},{key:"resize",value:function(e,t){this._view.resizeView(e,t)}},{key:"reset",value:function(){return this.runners.reset.emit(),this}},{key:"clear",value:function(){this.renderTexture.bind(),this.renderTexture.clear()}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"plugins",get:function(){return this._plugin.plugins}},{key:"multisample",get:function(){return this._multisample.multisample}},{key:"width",get:function(){return this._view.element.width}},{key:"height",get:function(){return this._view.element.height}},{key:"resolution",get:function(){return this._view.resolution},set:function(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}},{key:"autoDensity",get:function(){return this._view.autoDensity}},{key:"view",get:function(){return this._view.element}},{key:"screen",get:function(){return this._view.screen}},{key:"lastObjectRendered",get:function(){return this.objectRenderer.lastObjectRendered}},{key:"renderingToScreen",get:function(){return this.objectRenderer.renderingToScreen}},{key:"rendererLogId",get:function(){return"WebGL ".concat(this.context.webGLVersion)}},{key:"clearBeforeRender",get:function(){return _e("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}},{key:"useContextAlpha",get:function(){return _e("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}},{key:"preserveDrawingBuffer",get:function(){return _e("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}},{key:"backgroundColor",get:function(){return _e("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color},set:function(e){_e("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}},{key:"backgroundAlpha",get:function(){return _e("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha},set:function(e){_e("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}},{key:"powerPreference",get:function(){return _e("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}},{key:"generateTexture",value:function(e,t){return this.textureGenerator.generateTexture(e,t)}}],[{key:"test",value:function(e){return!(null!==e&&void 0!==e&&e.forceCanvas)&&Be()}}]),t}(ki);$i.extension={type:Wt.Renderer,priority:1},$i.__plugins={},$i.__systems={};var Yi=$i;Kt.handleByMap(Wt.RendererPlugin,Yi.__plugins),Kt.handleByMap(Wt.RendererSystem,Yi.__systems),Kt.add(Yi);var Ki=function(e){function t(e,n){var r;_classCallCheck(this,t);var i=n||{};(r=_callSuper(this,t,[i.width,i.height])).items=[],r.itemDirtyIds=[];for(var o=0;o<e;o++){var a=new un;r.items.push(a),r.itemDirtyIds.push(-2)}return r.length=e,r._load=null,r.baseTexture=null,r}return _inherits(t,e),_createClass(t,[{key:"initFromArray",value:function(e,t){for(var n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof rn?this.addResourceAt(e[n],n):this.addResourceAt(tn(e[n],t),n))}},{key:"dispose",value:function(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}},{key:"addResourceAt",value:function(e,t){if(!this.items[t])throw new Error("Index ".concat(t," is out of bounds"));return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}},{key:"bind",value:function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");_get(_getPrototypeOf(t.prototype),"bind",this).call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)}},{key:"unbind",value:function(e){_get(_getPrototypeOf(t.prototype),"unbind",this).call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)}},{key:"load",value:function(){var e=this;if(this._load)return this._load;var t=this.items.map((function(e){return e.resource})).filter((function(e){return e})).map((function(e){return e.load()}));return this._load=Promise.all(t).then((function(){var t=e.items[0],n=t.realWidth,r=t.realHeight;return e.resize(n,r),e.update(),Promise.resolve(e)})),this._load}}]),t}(rn),Xi=function(e){function t(e,n){var r;_classCallCheck(this,t);var i,o,a=n||{},s=a.width,u=a.height;return Array.isArray(e)?(i=e,o=e.length):o=e,r=_callSuper(this,t,[o,{width:s,height:u}]),i&&r.initFromArray(i,n),r}return _inherits(t,e),_createClass(t,[{key:"addBaseTextureAt",value:function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this}},{key:"bind",value:function(e){_get(_getPrototypeOf(t.prototype),"bind",this).call(this,e),e.target=N.TEXTURE_2D_ARRAY}},{key:"upload",value:function(e,t,n){var r=this.length,i=this.itemDirtyIds,o=this.items,a=e.gl;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,t.format,n.type,null);for(var s=0;s<r;s++){var u=o[s];i[s]<u.dirtyId&&(i[s]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,s,u.resource.width,u.resource.height,1,t.format,n.type,u.resource.source))}return!0}}]),t}(Ki),Zi=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,null,[{key:"test",value:function(e){var t=globalThis.OffscreenCanvas;return!!(t&&e instanceof t)||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}]),t}(xr),qi=function(e){function t(e,n){var r;_classCallCheck(this,t);var i=n||{},o=i.width,a=i.height,s=i.autoLoad,u=i.linkBaseTexture;if(e&&e.length!==t.SIDES)throw new Error("Invalid length. Got ".concat(e.length,", expected 6"));r=_callSuper(this,t,[6,{width:o,height:a}]);for(var c=0;c<t.SIDES;c++)r.items[c].target=N.TEXTURE_CUBE_MAP_POSITIVE_X+c;return r.linkBaseTexture=!1!==u,e&&r.initFromArray(e,n),!1!==s&&r.load(),r}return _inherits(t,e),_createClass(t,[{key:"bind",value:function(e){_get(_getPrototypeOf(t.prototype),"bind",this).call(this,e),e.target=N.TEXTURE_CUBE_MAP}},{key:"addBaseTextureAt",value:function(e,t,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[t])throw new Error("Index ".concat(t," is out of bounds"));if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=N.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}},{key:"upload",value:function(e,n,r){for(var i=this.itemDirtyIds,o=0;o<t.SIDES;o++){var a=this.items[o];(i[o]<a.dirtyId||r.dirtyId<n.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(e,a,r),i[o]=a.dirtyId):i[o]<-1&&(e.gl.texImage2D(a.target,0,r.internalFormat,n.realWidth,n.realHeight,0,n.format,r.type,null),i[o]=-1))}return!0}}],[{key:"test",value:function(e){return Array.isArray(e)&&e.length===t.SIDES}}]),t}(Ki);qi.SIDES=6;var Ji=qi,Qi=function(e){function t(e,n){var r,i,o,a,s,u;return _classCallCheck(this,t),n=n||{},"string"==typeof e?(a=t.EMPTY,s=e,u=!0):(a=e,s=null,u=!1),(o=_callSuper(this,t,[a])).url=s,o.crossOrigin=null===(r=n.crossOrigin)||void 0===r||r,o.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,o.ownsImageBitmap=null!==(i=n.ownsImageBitmap)&&void 0!==i?i:u,o._load=null,!1!==n.autoLoad&&o.load(),o}return _inherits(t,e),_createClass(t,[{key:"load",value:function(){var e=this;return this._load||(this._load=new Promise(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,r){var i,o,a;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.url){t.next=27;break}return t.prev=1,t.next=4,Q.ADAPTER.fetch(e.url,{mode:e.crossOrigin?"cors":"no-cors"});case 4:if(i=t.sent,!e.destroyed){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,i.blob();case 9:if(o=t.sent,!e.destroyed){t.next=12;break}return t.abrupt("return");case 12:return t.next=14,createImageBitmap(o,{premultiplyAlpha:null===e.alphaMode||e.alphaMode===V.UNPACK?"premultiply":"none"});case 14:if(a=t.sent,!e.destroyed){t.next=17;break}return t.abrupt("return",void a.close());case 17:e.source=a,e.update(),n(e),t.next=25;break;case 20:if(t.prev=20,t.t0=t.catch(1),!e.destroyed){t.next=24;break}return t.abrupt("return");case 24:r(t.t0),e.onError.emit(t.t0);case 25:t.next=28;break;case 27:n(e);case 28:case"end":return t.stop()}}),t,null,[[1,20]])})));return function(e,n){return t.apply(this,arguments)}}())),this._load}},{key:"upload",value:function(e,n,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),_get(_getPrototypeOf(t.prototype),"upload",this).call(this,e,n,r)):(this.load(),!1)}},{key:"dispose",value:function(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),_get(_getPrototypeOf(t.prototype),"dispose",this).call(this),this._load=null}}],[{key:"test",value:function(e){return!!globalThis.createImageBitmap&&("undefined"===typeof ImageBitmap?"undefined":_typeof(ImageBitmap))<"u"&&("string"==typeof e||e instanceof ImageBitmap)}},{key:"EMPTY",get:function(){var e;return t._EMPTY=null!==(e=t._EMPTY)&&void 0!==e?e:Q.ADAPTER.createCanvas(0,0),t._EMPTY}}]),t}(xr),eo=function(e){function t(e,n){var r;return _classCallCheck(this,t),n=n||{},(r=_callSuper(this,t,[Q.ADAPTER.createCanvas()]))._width=0,r._height=0,r.svg=e,r.scale=n.scale||1,r._overrideWidth=n.width,r._overrideHeight=n.height,r._resolve=null,r._crossorigin=n.crossorigin,r._load=null,!1!==n.autoLoad&&r.load(),r}return _inherits(t,e),_createClass(t,[{key:"load",value:function(){var e=this;return this._load||(this._load=new Promise((function(n){if(e._resolve=function(){e.update(),n(e)},t.SVG_XML.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,".concat(btoa(unescape(encodeURIComponent(e.svg))))}e._loadSvg()}))),this._load}},{key:"_loadSvg",value:function(){var e=this,t=new Image;xr.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(n){e._resolve&&(t.onerror=null,e.onError.emit(n))},t.onload=function(){if(e._resolve){var n=t.width,r=t.height;if(!n||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=n*e.scale,o=r*e.scale;(e._overrideWidth||e._overrideHeight)&&(i=e._overrideWidth||e._overrideHeight/r*n,o=e._overrideHeight||e._overrideWidth/n*r),i=Math.round(i),o=Math.round(o);var a=e.source;a.width=i,a.height=o,a._pixiId="canvas_".concat(Et()),a.getContext("2d").drawImage(t,0,0,n,r,0,0,i,o),e._resolve(),e._resolve=null}}}},{key:"dispose",value:function(){_get(_getPrototypeOf(t.prototype),"dispose",this).call(this),this._resolve=null,this._crossorigin=null}}],[{key:"getSize",value:function(e){var n=t.SVG_SIZE.exec(e),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r}},{key:"test",value:function(e,n){return"svg"===n||"string"==typeof e&&e.startsWith("data:image/svg+xml")||"string"==typeof e&&t.SVG_XML.test(e)}}]),t}(xr);eo.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,eo.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var to=eo,no=function(e){function t(e,n){var r;if(_classCallCheck(this,t),n=n||{},!(e instanceof HTMLVideoElement)){var i=document.createElement("video");!1!==n.autoLoad&&i.setAttribute("preload","auto"),!1!==n.playsinline&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),!0===n.muted&&(i.setAttribute("muted",""),i.muted=!0),!0===n.loop&&i.setAttribute("loop",""),!1!==n.autoPlay&&i.setAttribute("autoplay",""),"string"==typeof e&&(e=[e]);var o=e[0].src||e[0];xr.crossOrigin(i,o,n.crossorigin);for(var a=0;a<e.length;++a){var s=document.createElement("source"),u=e[a],c=u.src,l=u.mime;if((c=c||e[a]).startsWith("data:"))l=c.slice(5,c.indexOf(";"));else if(!c.startsWith("blob:")){var h=c.split("?").shift().toLowerCase(),f=h.slice(h.lastIndexOf(".")+1);l=l||t.MIME_TYPES[f]||"video/".concat(f)}s.src=c,l&&(s.type=l),i.appendChild(s)}e=i}return(r=_callSuper(this,t,[e])).noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=n.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=!1!==n.autoPlay,r._videoFrameRequestCallback=r._videoFrameRequestCallback.bind(_assertThisInitialized(r)),r._videoFrameRequestCallbackHandle=null,r._load=null,r._resolve=null,r._reject=null,r._onCanPlay=r._onCanPlay.bind(_assertThisInitialized(r)),r._onError=r._onError.bind(_assertThisInitialized(r)),r._onPlayStart=r._onPlayStart.bind(_assertThisInitialized(r)),r._onPlayStop=r._onPlayStop.bind(_assertThisInitialized(r)),r._onSeeked=r._onSeeked.bind(_assertThisInitialized(r)),!1!==n.autoLoad&&r.load(),r}return _inherits(t,e),_createClass(t,[{key:"update",value:function(){if(!this.destroyed){if(this._updateFPS){var e=Li.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(_get(_getPrototypeOf(t.prototype),"update",this).call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}},{key:"_videoFrameRequestCallback",value:function(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}},{key:"load",value:function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n,r){e.valid?n(e):(e._resolve=n,e._reject=r,t.load())})),this._load}},{key:"_onError",value:function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}},{key:"_isSourcePlaying",value:function(){var e=this.source;return!e.paused&&!e.ended}},{key:"_isSourceReady",value:function(){return this.source.readyState>2}},{key:"_onPlayStart",value:function(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}},{key:"_onPlayStop",value:function(){this._configureAutoUpdate()}},{key:"_onSeeked",value:function(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}},{key:"_onCanPlay",value:function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}},{key:"dispose",value:function(){this._configureAutoUpdate();var e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),_get(_getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}},{key:"updateFPS",get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}},{key:"_configureAutoUpdate",value:function(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Li.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Li.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Li.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}}],[{key:"test",value:function(e,n){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.includes(n)}}]),t}(xr);no.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],no.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};var ro=no;en.push(Qi,_r,Zi,ro,function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,null,[{key:"test",value:function(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}]),t}(xr),to,on,Ji,Xi);var io=function(){function e(){_classCallCheck(this,e),this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new nn("disposeTransformFeedback")}return _createClass(e,[{key:"bindBuffer",value:function(e,t){this.buffers[e]=t}},{key:"destroy",value:function(){this.disposeRunner.emit(this,!1)}}]),e}(),oo="7.4.0",ao=function(){function e(){_classCallCheck(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return _createClass(e,[{key:"isEmpty",value:function(){return this.minX>this.maxX||this.minY>this.maxY}},{key:"clear",value:function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}},{key:"getRectangle",value:function(e){return this.minX>this.maxX||this.minY>this.maxY?Cn.EMPTY:((e=e||new Cn(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}},{key:"addPoint",value:function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}},{key:"addPointMatrix",value:function(e,t){var n=e.a,r=e.b,i=e.c,o=e.d,a=e.tx,s=e.ty,u=n*t.x+i*t.y+a,c=r*t.x+o*t.y+s;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}},{key:"addQuad",value:function(e){var t=this.minX,n=this.minY,r=this.maxX,i=this.maxY,o=e[0],a=e[1];t=o<t?o:t,n=a<n?a:n,r=o>r?o:r,i=a>i?a:i,t=(o=e[2])<t?o:t,n=(a=e[3])<n?a:n,r=o>r?o:r,i=a>i?a:i,t=(o=e[4])<t?o:t,n=(a=e[5])<n?a:n,r=o>r?o:r,i=a>i?a:i,t=(o=e[6])<t?o:t,n=(a=e[7])<n?a:n,r=o>r?o:r,i=a>i?a:i,this.minX=t,this.minY=n,this.maxX=r,this.maxY=i}},{key:"addFrame",value:function(e,t,n,r,i){this.addFrameMatrix(e.worldTransform,t,n,r,i)}},{key:"addFrameMatrix",value:function(e,t,n,r,i){var o=e.a,a=e.b,s=e.c,u=e.d,c=e.tx,l=e.ty,h=this.minX,f=this.minY,d=this.maxX,p=this.maxY,y=o*t+s*n+c,g=a*t+u*n+l;h=y<h?y:h,f=g<f?g:f,d=y>d?y:d,p=g>p?g:p,h=(y=o*r+s*n+c)<h?y:h,f=(g=a*r+u*n+l)<f?g:f,d=y>d?y:d,p=g>p?g:p,h=(y=o*t+s*i+c)<h?y:h,f=(g=a*t+u*i+l)<f?g:f,d=y>d?y:d,p=g>p?g:p,h=(y=o*r+s*i+c)<h?y:h,f=(g=a*r+u*i+l)<f?g:f,d=y>d?y:d,p=g>p?g:p,this.minX=h,this.minY=f,this.maxX=d,this.maxY=p}},{key:"addVertexData",value:function(e,t,n){for(var r=this.minX,i=this.minY,o=this.maxX,a=this.maxY,s=t;s<n;s+=2){var u=e[s],c=e[s+1];r=u<r?u:r,i=c<i?c:i,o=u>o?u:o,a=c>a?c:a}this.minX=r,this.minY=i,this.maxX=o,this.maxY=a}},{key:"addVertices",value:function(e,t,n,r){this.addVerticesMatrix(e.worldTransform,t,n,r)}},{key:"addVerticesMatrix",value:function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:i,a=e.a,s=e.b,u=e.c,c=e.d,l=e.tx,h=e.ty,f=this.minX,d=this.minY,p=this.maxX,y=this.maxY,g=n;g<r;g+=2){var m=t[g],v=t[g+1],w=a*m+u*v+l,b=c*v+s*m+h;f=Math.min(f,w-i),p=Math.max(p,w+i),d=Math.min(d,b-o),y=Math.max(y,b+o)}this.minX=f,this.minY=d,this.maxX=p,this.maxY=y}},{key:"addBounds",value:function(e){var t=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>i?e.maxY:i}},{key:"addBoundsMask",value:function(e,t){var n=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(n<=i&&r<=o){var a=this.minX,s=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=r<s?r:s,this.maxX=i>u?i:u,this.maxY=o>c?o:c}}},{key:"addBoundsMatrix",value:function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}},{key:"addBoundsArea",value:function(e,t){var n=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(n<=i&&r<=o){var a=this.minX,s=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=r<s?r:s,this.maxX=i>u?i:u,this.maxY=o>c?o:c}}},{key:"pad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}},{key:"addFramePad",value:function(e,t,n,r,i,o){e-=i,t-=o,n+=i,r+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r}}]),e}(),so=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).tempDisplayObjectParent=null,e.transform=new Gn,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new ao,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return _inherits(t,e),_createClass(t,[{key:"destroyed",get:function(){return this._destroyed}},{key:"_recursivePostUpdateTransform",value:function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}},{key:"updateTransform",value:function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}},{key:"getBounds",value:function(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new Cn),t=this._boundsRect),this._bounds.getRectangle(t)}},{key:"getLocalBounds",value:function(e){var t;e||(this._localBoundsRect||(this._localBoundsRect=new Cn),e=this._localBoundsRect),this._localBounds||(this._localBounds=new ao);var n=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=null!==(t=null===r||void 0===r?void 0:r.worldAlpha)&&void 0!==t?t:1,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,o=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,e);return this.parent=r,this.transform=n,this._bounds=i,this._bounds.updateID+=this._boundsID-o,a}},{key:"toGlobal",value:function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}},{key:"toLocal",value:function(e,t,n,r){return t&&(e=t.toGlobal(e,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}},{key:"setParent",value:function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}},{key:"removeFromParent",value:function(){var e;null===(e=this.parent)||void 0===e||e.removeChild(this)}},{key:"setTransform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=e,this.position.y=t,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=o,this.skew.y=a,this.pivot.x=s,this.pivot.y=u,this}},{key:"destroy",value:function(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}},{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new uo),this.tempDisplayObjectParent}},{key:"enableTempParent",value:function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e}},{key:"disableTempParent",value:function(e){this.parent=e}},{key:"x",get:function(){return this.position.x},set:function(e){this.transform.position.x=e}},{key:"y",get:function(){return this.position.y},set:function(e){this.transform.position.y=e}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)}},{key:"scale",get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)}},{key:"skew",get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e}},{key:"angle",get:function(){return this.transform.rotation*bn},set:function(e){this.transform.rotation=e*xn}},{key:"zIndex",get:function(){return this._zIndex},set:function(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}},{key:"worldVisible",get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}},{key:"mask",get:function(){return this._mask},set:function(e){if(this._mask!==e){if(this._mask){var t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,0===t._maskRefCount&&(t.renderable=!0,t.isMask=!1))}if(this._mask=e,this._mask){var n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(0===n._maskRefCount&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}}}}],[{key:"mixin",value:function(e){for(var n=Object.keys(e),r=0;r<n.length;++r){var i=n[r];Object.defineProperty(t.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}}]),t}(ve),uo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).sortDirty=null,e}return _inherits(t,e),_createClass(t)}(so);so.prototype.displayObjectUpdateTransform=so.prototype.updateTransform;var co=new On;function lo(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}var ho=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).children=[],e.sortableChildren=t.defaultSortableChildren,e.sortDirty=!1,e}return _inherits(t,e),_createClass(t,[{key:"onChildrenChange",value:function(e){}},{key:"addChild",value:function(){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.addChild(e<0||arguments.length<=e?void 0:arguments[e]);else{var t=arguments.length<=0?void 0:arguments[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return arguments.length<=0?void 0:arguments[0]}},{key:"addChildAt",value:function(e,t){if(t<0||t>this.children.length)throw new Error("".concat(e,"addChildAt: The index ").concat(t," supplied is out of bounds ").concat(this.children.length));return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}},{key:"swapChildren",value:function(e,t){if(e!==t){var n=this.getChildIndex(e),r=this.getChildIndex(t);this.children[n]=t,this.children[r]=e,this.onChildrenChange(n<r?n:r)}}},{key:"getChildIndex",value:function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t}},{key:"setChildIndex",value:function(e,t){if(t<0||t>=this.children.length)throw new Error("The index ".concat(t," supplied is out of bounds ").concat(this.children.length));var n=this.getChildIndex(e);kt(this.children,n,1),this.children.splice(t,0,e),this.onChildrenChange(t)}},{key:"getChildAt",value:function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index (".concat(e,") does not exist."));return this.children[e]}},{key:"removeChild",value:function(){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.removeChild(e<0||arguments.length<=e?void 0:arguments[e]);else{var t=arguments.length<=0?void 0:arguments[0],n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,kt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return arguments.length<=0?void 0:arguments[0]}},{key:"removeChildAt",value:function(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,kt(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}},{key:"removeChildren",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.children.length,r=t,i=n-r;if(i>0&&i<=n){e=this.children.splice(r,i);for(var o=0;o<e.length;++o)e[o].parent=null,e[o].transform&&(e[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<e.length;++a)e[a].emit("removed",this),this.emit("childRemoved",e[a],this,a);return e}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}},{key:"sortChildren",value:function(){for(var e=!1,t=0,n=this.children.length;t<n;++t){var r=this.children[t];r._lastSortedIndex=t,!e&&0!==r.zIndex&&(e=!0)}e&&this.children.length>1&&this.children.sort(lo),this.sortDirty=!1}},{key:"updateTransform",value:function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,t=this.children.length;e<t;++e){var n=this.children[e];n.visible&&n.updateTransform()}}},{key:"calculateBounds",value:function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var t=this.children[e];if(t.visible&&t.renderable)if(t.calculateBounds(),t._mask){var n=t._mask.isMaskData?t._mask.maskObject:t._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(t._bounds,n._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}},{key:"getLocalBounds",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=_get(_getPrototypeOf(t.prototype),"getLocalBounds",this).call(this,e);if(!n)for(var i=0,o=this.children.length;i<o;++i){var a=this.children[i];a.visible&&a.updateTransform()}return r}},{key:"_calculateBounds",value:function(){}},{key:"_renderWithCulling",value:function(e){var n=e.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==t.prototype._render&&(r=this.getBounds(!0));var o=e.projection.transform;if(o&&(i?(i=co.copyFrom(i)).prepend(o):i=o),r&&n.intersects(r,i))this._render(e);else if(this.cullArea)return;for(var a=0,s=this.children.length;a<s;++a){var u=this.children[a],c=u.cullable;u.cullable=c||!this.cullArea,u.render(e),u.cullable=c}}}},{key:"render",value:function(e){var t;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||null!==(t=this.filters)&&void 0!==t&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(var n=0,r=this.children.length;n<r;++n)this.children[n].render(e)}}},{key:"renderAdvanced",value:function(e){var t,n,r,i=this.filters,o=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var a=0;a<i.length;a++)i[a].enabled&&this._enabledFilters.push(i[a])}var s=i&&(null===(t=this._enabledFilters)||void 0===t?void 0:t.length)||o&&(!o.isMaskData||o.enabled&&(o.autoDetect||o.type!==K.NONE));if(s&&e.batch.flush(),i&&null!==(n=this._enabledFilters)&&void 0!==n&&n.length&&e.filter.push(this,this._enabledFilters),o&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(var u=0,c=this.children.length;u<c;++u)this.children[u].render(e)}s&&e.batch.flush(),o&&e.mask.pop(this),i&&(null===(r=this._enabledFilters)||void 0===r?void 0:r.length)&&e.filter.pop()}},{key:"_render",value:function(e){}},{key:"destroy",value:function(e){_get(_getPrototypeOf(t.prototype),"destroy",this).call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:null===e||void 0===e?void 0:e.children,r=this.removeChildren(0,this.children.length);if(n)for(var i=0;i<r.length;++i)r[i].destroy(e)}},{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e}}]),t}(so);ho.defaultSortableChildren=!1;var fo=ho;fo.prototype.containerUpdateTransform=fo.prototype.updateTransform,Object.defineProperties(Q,{SORTABLE_CHILDREN:{get:function(){return fo.defaultSortableChildren},set:function(e){_e("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),fo.defaultSortableChildren=e}}});var po=new In,yo=new Uint16Array([0,1,2,0,2,3]),go=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t))._anchor=new Un(n._onAnchorUpdate,_assertThisInitialized(n),e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tintColor=new ut(16777215),n._tintRGB=null,n.tint=16777215,n.blendMode=M.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||kr.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=yo,n.pluginName="batch",n.isSprite=!0,n._roundPixels=Q.ROUND_PIXELS,n}return _inherits(t,e),_createClass(t,[{key:"_onTextureUpdate",value:function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=St(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=St(this.scale.y)*this._height/this._texture.orig.height)}},{key:"_onAnchorUpdate",value:function(){this._transformID=-1,this._transformTrimmedID=-1}},{key:"calculateVertices",value:function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var t=this.transform.worldTransform,n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,u=this.vertexData,c=e.trim,l=e.orig,h=this._anchor,f=0,d=0,p=0,y=0;if(c?(f=(d=c.x-h._x*l.width)+c.width,p=(y=c.y-h._y*l.height)+c.height):(f=(d=-h._x*l.width)+l.width,p=(y=-h._y*l.height)+l.height),u[0]=n*d+i*y+a,u[1]=o*y+r*d+s,u[2]=n*f+i*y+a,u[3]=o*y+r*f+s,u[4]=n*f+i*p+a,u[5]=o*p+r*f+s,u[6]=n*d+i*p+a,u[7]=o*p+r*d+s,this._roundPixels)for(var g=Q.RESOLUTION,m=0;m<u.length;++m)u[m]=Math.round(u[m]*g)/g}}},{key:"calculateTrimmedVertices",value:function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,n=e.orig,r=this._anchor,i=this.transform.worldTransform,o=i.a,a=i.b,s=i.c,u=i.d,c=i.tx,l=i.ty,h=-r._x*n.width,f=h+n.width,d=-r._y*n.height,p=d+n.height;if(t[0]=o*h+s*d+c,t[1]=u*d+a*h+l,t[2]=o*f+s*d+c,t[3]=u*d+a*f+l,t[4]=o*f+s*p+c,t[5]=u*p+a*f+l,t[6]=o*h+s*p+c,t[7]=u*p+a*h+l,this._roundPixels)for(var y=Q.RESOLUTION,g=0;g<t.length;++g)t[g]=Math.round(t[g]*y)/y}},{key:"_render",value:function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}},{key:"_calculateBounds",value:function(){var e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}},{key:"getLocalBounds",value:function(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new ao),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Cn),e=this._localBoundsRect),this._localBounds.getRectangle(e)):_get(_getPrototypeOf(t.prototype),"getLocalBounds",this).call(this,e)}},{key:"containsPoint",value:function(e){this.worldTransform.applyInverse(e,po);var t=this._texture.orig.width,n=this._texture.orig.height,r=-t*this.anchor.x,i=0;return po.x>=r&&po.x<r+t&&(i=-n*this.anchor.y,po.y>=i&&po.y<i+n)}},{key:"destroy",value:function(e){if(_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:null===e||void 0===e?void 0:e.texture){var n="boolean"==typeof e?e:null===e||void 0===e?void 0:e.baseTexture;this._texture.destroy(!!n)}this._texture=null}},{key:"roundPixels",get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}},{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var t=St(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var t=St(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}},{key:"anchor",get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)}},{key:"tint",get:function(){return this._tintColor.value},set:function(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}},{key:"tintValue",get:function(){return this._tintColor.toNumber()}},{key:"texture",get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||kr.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}],[{key:"from",value:function(e,n){return new t(e instanceof kr?e:kr.from(e,n))}}]),t}(fo),mo=new On;so.prototype._cacheAsBitmap=!1,so.prototype._cacheData=null,so.prototype._cacheAsBitmapResolution=null,so.prototype._cacheAsBitmapMultisample=null;var vo=_createClass((function e(){_classCallCheck(this,e),this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}));Object.defineProperties(so.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(e){var t;this._cacheAsBitmap!==e&&(this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new vo),(t=this._cacheData).originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((t=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea))}}}),so.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},so.prototype._initCachedDisplayObject=function(e){var t,n,r;if(null===(t=this._cacheData)||void 0===t||!t.sprite){var i=this.alpha;this.alpha=1,e.batch.flush();var o=this.getLocalBounds(new Cn,!0);if(null!==(n=this.filters)&&void 0!==n&&n.length){var a=this.filters[0].padding;o.pad(a)}var s=this.cacheAsBitmapResolution||e.resolution;o.ceil(s),o.width=Math.max(o.width,1/s),o.height=Math.max(o.height,1/s);var u=e.renderTexture.current,c=e.renderTexture.sourceFrame.clone(),l=e.renderTexture.destinationFrame.clone(),h=e.projection.transform,f=Sr.create({width:o.width,height:o.height,resolution:s,multisample:null!==(r=this.cacheAsBitmapMultisample)&&void 0!==r?r:e.multisample}),d="cacheAsBitmap_".concat(Et());this._cacheData.textureCacheId=d,un.addToCache(f.baseTexture,d),kr.addToCache(f,d);var p=this.transform.localTransform.copyTo(mo).invert().translate(-o.x,-o.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:f,clear:!0,transform:p,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=h,e.renderTexture.bind(u,c,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var y=new go(f);y.transform.worldTransform=this.transform.worldTransform,y.anchor.x=-o.x/o.width,y.anchor.y=-o.y/o.height,y.alpha=i,y._bounds=this._bounds,this._cacheData.sprite=y,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=y.containsPoint.bind(y)}},so.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},so.prototype._initCachedDisplayObjectCanvas=function(e){var t;if(null===(t=this._cacheData)||void 0===t||!t.sprite){var n=this.getLocalBounds(new Cn,!0),r=this.alpha;this.alpha=1;var i=e.canvasContext.activeContext,o=e._projTransform,a=this.cacheAsBitmapResolution||e.resolution;n.ceil(a),n.width=Math.max(n.width,1/a),n.height=Math.max(n.height,1/a);var s=Sr.create({width:n.width,height:n.height,resolution:a}),u="cacheAsBitmap_".concat(Et());this._cacheData.textureCacheId=u,un.addToCache(s.baseTexture,u),kr.addToCache(s,u);var c=mo;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=n.x,c.ty-=n.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:s,clear:!0,transform:c,skipUpdateTransform:!1}),e.canvasContext.activeContext=i,e._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var l=new go(s);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-n.x/n.width,l.anchor.y=-n.y/n.height,l.alpha=r,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},so.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},so.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},so.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,un.removeFromCache(this._cacheData.textureCacheId),kr.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},so.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},so.prototype.name=null,fo.prototype.getChildByName=function(e,t){for(var n=0,r=this.children.length;n<r;n++)if(this.children[n].name===e)return this.children[n];if(t)for(var i=0,o=this.children.length;i<o;i++){var a=this.children[i];if(a.getChildByName){var s=a.getChildByName(e,!0);if(s)return s}}return null},so.prototype.getGlobalPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new In,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};var wo=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return _classCallCheck(this,t),(e=_callSuper(this,t,[ji,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}])).alpha=n,e}return _inherits(t,e),_createClass(t,[{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),t}(pr),bo={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},xo=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n"),_o=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pr.defaultResolution,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5;_classCallCheck(this,t);var s=function(e,t){var n,r=Math.ceil(e/2),i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";n=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var a=0;a<e;a++){var s=n.replace("%index%",a.toString());o+=s=s.replace("%sampleIndex%",a-(r-1)+".0"),o+="\n"}return i=(i=i.replace("%blur%",o)).replace("%size%",e.toString())}(a,e),u=function(e){for(var t,n=bo[e],r=n.length,i=xo,o="",a=0;a<e;a++){var s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",a.toString());t=a,a>=r&&(t=e-a-1),o+=s=s.replace("%value%",n[t].toString()),o+="\n"}return i=(i=i.replace("%blur%",o)).replace("%size%",e.toString())}(a);return(n=_callSuper(this,t,[s,u])).horizontal=e,n.resolution=o,n._quality=0,n.quality=i,n.blur=r,n}return _inherits(t,e),_createClass(t,[{key:"apply",value:function(e,t,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/t.width):this.uniforms.strength=1/n.height*(n.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,n,r);else{var i=e.getFilterTexture(),o=e.renderer,a=t,s=i;this.state.blend=!1,e.applyFilter(this,a,s,W.CLEAR);for(var u=1;u<this.passes-1;u++){e.bindAndClear(a,W.BLIT),this.uniforms.uSampler=s;var c=s;s=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,s,n,r),e.returnFilterTexture(i)}}},{key:"blur",get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}]),t}(pr),Io=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pr.defaultResolution,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;return _classCallCheck(this,t),(e=_callSuper(this,t))._repeatEdgePixels=!1,e.blurXFilter=new _o(!0,n,r,i,o),e.blurYFilter=new _o(!1,n,r,i,o),e.resolution=i,e.quality=r,e.blur=n,e.repeatEdgePixels=!1,e}return _inherits(t,e),_createClass(t,[{key:"apply",value:function(e,t,n,r){var i=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(i&&o){var a=e.getFilterTexture();this.blurXFilter.apply(e,t,a,W.CLEAR),this.blurYFilter.apply(e,a,n,r),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,t,n,r):this.blurXFilter.apply(e,t,n,r)}},{key:"updatePadding",value:function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blur",get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()}},{key:"blendMode",get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e}},{key:"repeatEdgePixels",get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()}}]),t}(pr),Ao=function(e){function t(){var e;_classCallCheck(this,t);var n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=_callSuper(this,t,[Gi,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n])).alpha=1,e}return _inherits(t,e),_createClass(t,[{key:"_loadMatrix",value:function(e){var t=e;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(t,this.uniforms.m,e),t=this._colorMatrix(t)),this.uniforms.m=t}},{key:"_multiply",value:function(e,t,n){return e[0]=t[0]*n[0]+t[1]*n[5]+t[2]*n[10]+t[3]*n[15],e[1]=t[0]*n[1]+t[1]*n[6]+t[2]*n[11]+t[3]*n[16],e[2]=t[0]*n[2]+t[1]*n[7]+t[2]*n[12]+t[3]*n[17],e[3]=t[0]*n[3]+t[1]*n[8]+t[2]*n[13]+t[3]*n[18],e[4]=t[0]*n[4]+t[1]*n[9]+t[2]*n[14]+t[3]*n[19]+t[4],e[5]=t[5]*n[0]+t[6]*n[5]+t[7]*n[10]+t[8]*n[15],e[6]=t[5]*n[1]+t[6]*n[6]+t[7]*n[11]+t[8]*n[16],e[7]=t[5]*n[2]+t[6]*n[7]+t[7]*n[12]+t[8]*n[17],e[8]=t[5]*n[3]+t[6]*n[8]+t[7]*n[13]+t[8]*n[18],e[9]=t[5]*n[4]+t[6]*n[9]+t[7]*n[14]+t[8]*n[19]+t[9],e[10]=t[10]*n[0]+t[11]*n[5]+t[12]*n[10]+t[13]*n[15],e[11]=t[10]*n[1]+t[11]*n[6]+t[12]*n[11]+t[13]*n[16],e[12]=t[10]*n[2]+t[11]*n[7]+t[12]*n[12]+t[13]*n[17],e[13]=t[10]*n[3]+t[11]*n[8]+t[12]*n[13]+t[13]*n[18],e[14]=t[10]*n[4]+t[11]*n[9]+t[12]*n[14]+t[13]*n[19]+t[14],e[15]=t[15]*n[0]+t[16]*n[5]+t[17]*n[10]+t[18]*n[15],e[16]=t[15]*n[1]+t[16]*n[6]+t[17]*n[11]+t[18]*n[16],e[17]=t[15]*n[2]+t[16]*n[7]+t[17]*n[12]+t[18]*n[17],e[18]=t[15]*n[3]+t[16]*n[8]+t[17]*n[13]+t[18]*n[18],e[19]=t[15]*n[4]+t[16]*n[9]+t[17]*n[14]+t[18]*n[19]+t[19],e}},{key:"_colorMatrix",value:function(e){var t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}},{key:"brightness",value:function(e,t){var n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,t)}},{key:"tint",value:function(e,t){var n=_slicedToArray(ut.shared.setValue(e).toArray(),3),r=[n[0],0,0,0,0,0,n[1],0,0,0,0,0,n[2],0,0,0,0,0,1,0];this._loadMatrix(r,t)}},{key:"greyscale",value:function(e,t){var n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,t)}},{key:"blackAndWhite",value:function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}},{key:"hue",value:function(e,t){e=(e||0)/180*Math.PI;var n=Math.cos(e),r=Math.sin(e),i=1/3,o=(0,Math.sqrt)(i),a=[n+(1-n)*i,i*(1-n)-o*r,i*(1-n)+o*r,0,0,i*(1-n)+o*r,n+i*(1-n),i*(1-n)-o*r,0,0,i*(1-n)-o*r,i*(1-n)+o*r,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(a,t)}},{key:"contrast",value:function(e,t){var n=(e||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,t)}},{key:"saturate",value:function(){var e=arguments.length>1?arguments[1]:void 0,t=2*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/3+1,n=-.5*(t-1),r=[t,n,n,0,0,n,t,n,0,0,n,n,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}},{key:"desaturate",value:function(){this.saturate(-1)}},{key:"negative",value:function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}},{key:"sepia",value:function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}},{key:"technicolor",value:function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}},{key:"polaroid",value:function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}},{key:"toBGR",value:function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}},{key:"kodachrome",value:function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}},{key:"browni",value:function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}},{key:"vintage",value:function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}},{key:"colorTone",value:function(e,t,n,r,i){e=e||.2,t=t||.15,n=n||16770432,r=r||3375104;var o=ut.shared,a=_slicedToArray(o.setValue(n).toArray(),3),s=a[0],u=a[1],c=a[2],l=_slicedToArray(o.setValue(r).toArray(),3),h=l[0],f=l[1],d=l[2],p=[.3,.59,.11,0,0,s,u,c,e,0,h,f,d,t,0,s-h,u-f,c-d,0,0];this._loadMatrix(p,i)}},{key:"night",value:function(e,t){var n=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(n,t)}},{key:"predator",value:function(e,t){var n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,t)}},{key:"lsd",value:function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}},{key:"reset",value:function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}},{key:"matrix",get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),t}(pr);Ao.prototype.grayscale=Ao.prototype.greyscale;var Co=function(e){function t(e,n){var r;_classCallCheck(this,t);var i=new On;return e.renderable=!1,(r=_callSuper(this,t,["attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}])).maskSprite=e,r.maskMatrix=i,null==n&&(n=20),r.scale=new In(n,n),r}return _inherits(t,e),_createClass(t,[{key:"apply",value:function(e,t,n,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),a=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/a,this.uniforms.rotation[3]=i.d/a),e.applyFilter(this,t,n,r)}},{key:"map",get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e}}]),t}(pr),ko=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,["\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'])}return _inherits(t,e),_createClass(t)}(pr),So=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random();return _classCallCheck(this,t),(e=_callSuper(this,t,[Gi,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}])).noise=n,e.seed=r,e}return _inherits(t,e),_createClass(t,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e}}]),t}(pr),To={AlphaFilter:wo,BlurFilter:Io,BlurFilterPass:_o,ColorMatrixFilter:Ao,DisplacementFilter:Co,FXAAFilter:ko,NoiseFilter:So};Object.entries(To).forEach((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];Object.defineProperty(To,n,{get:function(){return _e("7.1.0","filters.".concat(n," has moved to ").concat(n)),r}})}));var Eo=new(function(){function e(){_classCallCheck(this,e),this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}return _createClass(e,[{key:"init",value:function(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}},{key:"pauseUpdate",get:function(){return this._pauseUpdate},set:function(e){this._pauseUpdate=e}},{key:"addTickerListener",value:function(){this.tickerAdded||!this.domElement||(Li.system.add(this.tickerUpdate,this,Bi.INTERACTION),this.tickerAdded=!0)}},{key:"removeTickerListener",value:function(){this.tickerAdded&&(Li.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}},{key:"pointerMoved",value:function(){this._didMove=!0}},{key:"update",value:function(){if(this.domElement&&!this._pauseUpdate)if(this._didMove)this._didMove=!1;else{var e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}}},{key:"tickerUpdate",value:function(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}]),e}()),Oo=function(){function e(t){_classCallCheck(this,e),this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=e.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new In,this.page=new In,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return _createClass(e,[{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"data",get:function(){return this}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"initEvent",value:function(e,t,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}},{key:"initUIEvent",value:function(e,t,n,r,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),e}(),Po=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).client=new In,e.movement=new In,e.offset=new In,e.global=new In,e.screen=new In,e}return _inherits(t,e),_createClass(t,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"x",get:function(){return this.clientX}},{key:"y",get:function(){return this.clientY}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getLocalPosition",value:function(e,t,n){return e.worldTransform.applyInverse(n||this.global,t)}},{key:"getModifierState",value:function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}},{key:"initMouseEvent",value:function(e,t,n,r,i,o,a,s,u,c,l,h,f,d,p){throw new Error("Method not implemented.")}}]),t}(Oo),Ro=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).width=0,e.height=0,e.isPrimary=!1,e}return _inherits(t,e),_createClass(t,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}}]),t}(Po),Bo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).DOM_DELTA_PIXEL=0,e.DOM_DELTA_LINE=1,e.DOM_DELTA_PAGE=2,e}return _inherits(t,e),_createClass(t)}(Po);Bo.DOM_DELTA_PIXEL=0,Bo.DOM_DELTA_LINE=1,Bo.DOM_DELTA_PAGE=2;var Do=new In,Mo=new In,Lo=function(){function e(t){_classCallCheck(this,e),this.dispatch=new ve,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}return _createClass(e,[{key:"addEventMapping",value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((function(e,t){return e.priority-t.priority}))}},{key:"dispatchEvent",value:function(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}},{key:"mapEvent",value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var n=0,r=t.length;n<r;n++)t[n].fn(e);else console.warn("[EventBoundary]: Event mapping not defined for ".concat(e.type))}}},{key:"hitTest",value:function(e,t){Eo.pauseUpdate=!0;var n=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,Do.set(e,t),this.hitTestFn,this.hitPruneFn);return n&&n[0]}},{key:"propagate",value:function(e,t){if(e.target){var n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var r=0,i=n.length-1;r<i;r++)if(e.currentTarget=n[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(var o=n.length-2;o>=0;o--)if(e.currentTarget=n[o],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}}},{key:"all",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._allInteractiveElements;if(0!==r.length){e.eventPhase=e.BUBBLING_PHASE;for(var i=Array.isArray(t)?t:[t],o=function(t){i.forEach((function(i){e.currentTarget=r[t],n.notifyTarget(e,i)}))},a=r.length-1;a>=0;a--)o(a)}}},{key:"propagationPath",value:function(e){for(var t=[e],n=0;n<2048&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}},{key:"hitTestMoveRecursive",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=!1;if(this._interactivePrune(e))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(Eo.pauseUpdate=!1),e.interactiveChildren&&e.children)for(var s=e.children,u=s.length-1;u>=0;u--){var c=s[u],l=this.hitTestMoveRecursive(c,this._isInteractive(t)?t:c.eventMode,n,r,i,o||i(e,n));if(l){if(l.length>0&&!l[l.length-1].parent)continue;var h=e.isInteractive();(l.length>0||h)&&(h&&this._allInteractiveElements.push(e),l.push(e)),0===this._hitElements.length&&(this._hitElements=l),a=!0}}var f=this._isInteractive(t),d=e.isInteractive();return f&&d&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:f&&!i(e,n)&&r(e,n)?d?[e]:[]:null}},{key:"hitTestRecursive",value:function(e,t,n,r,i){if(this._interactivePrune(e)||i(e,n))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(Eo.pauseUpdate=!1),e.interactiveChildren&&e.children)for(var o=e.children,a=o.length-1;a>=0;a--){var s=o[a],u=this.hitTestRecursive(s,this._isInteractive(t)?t:s.eventMode,n,r,i);if(u){if(u.length>0&&!u[u.length-1].parent)continue;var c=e.isInteractive();return(u.length>0||c)&&u.push(e),u}}var l=this._isInteractive(t),h=e.isInteractive();return l&&r(e,n)?h?[e]:[]:null}},{key:"_isInteractive",value:function(e){return"static"===e||"dynamic"===e}},{key:"_interactivePrune",value:function(e){return!(e&&!e.isMask&&e.visible&&e.renderable&&"none"!==e.eventMode&&("passive"!==e.eventMode||e.interactiveChildren)&&!e.isMask)}},{key:"hitPruneFn",value:function(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,Mo),!e.hitArea.contains(Mo.x,Mo.y)))return!0;if(e._mask){var n,r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&(null===(n=r.containsPoint)||void 0===n||!n.call(r,t)))return!0}return!1}},{key:"hitTestFn",value:function(e,t){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(t))}},{key:"notifyTarget",value:function(e,t){var n,r,i,o="on".concat(t=null!==(n=t)&&void 0!==n?n:e.type);null===(r=(i=e.currentTarget)[o])||void 0===r||r.call(i,e);var a=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,a),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}},{key:"mapPointerDown",value:function(e){if(e instanceof Ro){var t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){var n=2===t.button;this.dispatchEvent(t,n?"rightdown":"mousedown")}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerMove",value:function(e){var t,n,r;if(e instanceof Ro){this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;var i=this.createPointerEvent(e);this._isPointerMoveEvent=!1;var o="mouse"===i.pointerType||"pen"===i.pointerType,a=this.trackingData(e.pointerId),s=this.findMountedTarget(a.overTargets);if((null===(t=a.overTargets)||void 0===t?void 0:t.length)>0&&s!==i.target){var u="mousemove"===e.type?"mouseout":"pointerout",c=this.createPointerEvent(e,u,s);if(this.dispatchEvent(c,"pointerout"),o&&this.dispatchEvent(c,"mouseout"),!i.composedPath().includes(s)){var l=this.createPointerEvent(e,"pointerleave",s);for(l.eventPhase=l.AT_TARGET;l.target&&!i.composedPath().includes(l.target);)l.currentTarget=l.target,this.notifyTarget(l),o&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;this.freeEvent(l)}this.freeEvent(c)}if(s!==i.target){var h="mousemove"===e.type?"mouseover":"pointerover",f=this.clonePointerEvent(i,h);this.dispatchEvent(f,"pointerover"),o&&this.dispatchEvent(f,"mouseover");for(var d=null===s||void 0===s?void 0:s.parent;d&&d!==this.rootTarget.parent&&d!==i.target;)d=d.parent;if(!d||d===this.rootTarget.parent){var p=this.clonePointerEvent(i,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==s&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),o&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(f)}var y=[],g=null===(n=this.enableGlobalMoveEvents)||void 0===n||n;this.moveOnAll?y.push("pointermove"):this.dispatchEvent(i,"pointermove"),g&&y.push("globalpointermove"),"touch"===i.pointerType&&(this.moveOnAll?y.splice(1,0,"touchmove"):this.dispatchEvent(i,"touchmove"),g&&y.push("globaltouchmove")),o&&(this.moveOnAll?y.splice(1,0,"mousemove"):this.dispatchEvent(i,"mousemove"),g&&y.push("globalmousemove"),this.cursor=null===(r=i.target)||void 0===r?void 0:r.cursor),y.length>0&&this.all(i,y),this._allInteractiveElements.length=0,this._hitElements.length=0,a.overTargets=i.composedPath(),this.freeEvent(i)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerOver",value:function(e){var t;if(e instanceof Ro){var n=this.trackingData(e.pointerId),r=this.createPointerEvent(e),i="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=null===(t=r.target)||void 0===t?void 0:t.cursor);var o=this.clonePointerEvent(r,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;n.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(o)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerOut",value:function(e){if(e instanceof Ro){var t=this.trackingData(e.pointerId);if(t.overTargets){var n="mouse"===e.pointerType||"pen"===e.pointerType,r=this.findMountedTarget(t.overTargets),i=this.createPointerEvent(e,"pointerout",r);this.dispatchEvent(i),n&&this.dispatchEvent(i,"mouseout");var o=this.createPointerEvent(e,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(i),this.freeEvent(o)}this.cursor=null}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerUp",value:function(e){if(e instanceof Ro){var t=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var r=2===n.button;this.dispatchEvent(n,r?"rightup":"mouseup")}var i=this.trackingData(e.pointerId),o=this.findMountedTarget(i.pressTargetsByButton[e.button]),a=o;if(o&&!n.composedPath().includes(o)){for(var s=o;s&&!n.composedPath().includes(s);){if(n.currentTarget=s,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;this.notifyTarget(n,u?"rightupoutside":"mouseupoutside")}s=s.parent}delete i.pressTargetsByButton[e.button],a=s}if(a){var c=this.clonePointerEvent(n,"click");c.target=a,c.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:c.target,timeStamp:t});var l=i.clicksByButton[e.button];if(l.target===c.target&&t-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=c.target,l.timeStamp=t,c.detail=l.clickCount,"mouse"===c.pointerType){var h=2===c.button;this.dispatchEvent(c,h?"rightclick":"click")}else"touch"===c.pointerType&&this.dispatchEvent(c,"tap");this.dispatchEvent(c,"pointertap"),this.freeEvent(c)}this.freeEvent(n)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerUpOutside",value:function(e){if(e instanceof Ro){var t=this.trackingData(e.pointerId),n=this.findMountedTarget(t.pressTargetsByButton[e.button]),r=this.createPointerEvent(e);if(n){for(var i=n;i;)r.currentTarget=i,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):("mouse"===r.pointerType||"pen"===r.pointerType)&&this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(r)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapWheel",value:function(e){if(e instanceof Bo){var t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}else console.warn("EventBoundary cannot map a non-wheel event as a wheel event")}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var t=e[0],n=1;n<e.length&&e[n].parent===t;n++)t=e[n];return t}},{key:"createPointerEvent",value:function(e,t,n){var r,i=this.allocateEvent(Ro);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=null!==(r=null!==n&&void 0!==n?n:this.hitTest(i.global.x,i.global.y))&&void 0!==r?r:this._hitElements[0],"string"==typeof t&&(i.type=t),i}},{key:"createWheelEvent",value:function(e){var t=this.allocateEvent(Bo);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}},{key:"clonePointerEvent",value:function(e,t){var n=this.allocateEvent(Ro);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=null!==t&&void 0!==t?t:n.type,n}},{key:"copyWheelData",value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}},{key:"copyPointerData",value:function(e,t){e instanceof Ro&&t instanceof Ro&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}},{key:"copyMouseData",value:function(e,t){e instanceof Po&&t instanceof Po&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}},{key:"copyData",value:function(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}},{key:"notifyListeners",value:function(e,t){var n=e.currentTarget._events[t];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(t,n.fn,void 0,!0),n.fn.call(n.context,e);else for(var r=0,i=n.length;r<i&&!e.propagationImmediatelyStopped;r++)n[r].once&&e.currentTarget.removeListener(t,n[r].fn,void 0,!0),n[r].fn.call(n[r].context,e)}}]),e}(),Fo={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},No=function(){function e(t){var n=this;_classCallCheck(this,e),this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new Lo(null),Eo.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ro(null),this.rootWheelEvent=new Bo(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy(_objectSpread({},e.defaultEventFeatures),{set:function(e,t,r){return"globalMove"===t&&(n.rootBoundary.enableGlobalMoveEvents=r),e[t]=r,!0}}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}return _createClass(e,[{key:"init",value:function(t){var n,r,i=this.renderer,o=i.view,a=i.resolution;this.setTargetElement(o),this.resolution=a,e._defaultEventMode=null!==(n=t.eventMode)&&void 0!==n?n:"auto",Object.assign(this.features,null!==(r=t.eventFeatures)&&void 0!==r?r:{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}},{key:"resolutionChange",value:function(e){this.resolution=e}},{key:"destroy",value:function(){this.setTargetElement(null),this.renderer=null}},{key:"setCursor",value:function(e){e=e||"default";var t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor!==e){this.currentCursor=e;var n=this.cursorStyles[e];if(n)switch(_typeof(n)){case"string":t&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":t&&Object.assign(this.domElement.style,n)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}}},{key:"pointer",get:function(){return this.rootPointerEvent}},{key:"onPointerDown",value:function(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var n=0,r=t.length;n<r;n++){var i=t[n],o=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onPointerMove",value:function(e){if(this.features.move){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Eo.pointerMoved();for(var t=this.normalizeToPointerData(e),n=0,r=t.length;n<r;n++){var i=this.bootstrapEvent(this.rootPointerEvent,t[n]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onPointerUp",value:function(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);for(var n=t!==this.domElement?"outside":"",r=this.normalizeToPointerData(e),i=0,o=r.length;i<o;i++){var a=this.bootstrapEvent(this.rootPointerEvent,r[i]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onPointerOverOut",value:function(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;for(var t=this.normalizeToPointerData(e),n=0,r=t.length;n<r;n++){var i=this.bootstrapEvent(this.rootPointerEvent,t[n]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onWheel",value:function(e){if(this.features.wheel){var t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}}},{key:"setTargetElement",value:function(e){this.removeEvents(),this.domElement=e,Eo.domElement=e,this.addEvents()}},{key:"addEvents",value:function(){if(!this.eventsAdded&&this.domElement){Eo.addTickerListener();var e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}}},{key:"removeEvents",value:function(){if(this.eventsAdded&&this.domElement){Eo.removeTickerListener();var e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}}},{key:"mapPositionToPoint",value:function(e,t,n){var r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;e.x=(t-r.left)*(this.domElement.width/r.width)*i,e.y=(n-r.top)*(this.domElement.height/r.height)*i}},{key:"normalizeToPointerData",value:function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var n=0,r=e.changedTouches.length;n<r;n++){var i=e.changedTouches[n];_typeof(i.button)>"u"&&(i.button=0),_typeof(i.buttons)>"u"&&(i.buttons=1),_typeof(i.isPrimary)>"u"&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),_typeof(i.width)>"u"&&(i.width=i.radiusX||1),_typeof(i.height)>"u"&&(i.height=i.radiusY||1),_typeof(i.tiltX)>"u"&&(i.tiltX=0),_typeof(i.tiltY)>"u"&&(i.tiltY=0),_typeof(i.pointerType)>"u"&&(i.pointerType="touch"),_typeof(i.pointerId)>"u"&&(i.pointerId=i.identifier||0),_typeof(i.pressure)>"u"&&(i.pressure=i.force||.5),_typeof(i.twist)>"u"&&(i.twist=0),_typeof(i.tangentialPressure)>"u"&&(i.tangentialPressure=0),_typeof(i.layerX)>"u"&&(i.layerX=i.offsetX=i.clientX),_typeof(i.layerY)>"u"&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=e.type,t.push(i)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&!(this.supportsPointerEvents&&e instanceof globalThis.PointerEvent)){var o=e;_typeof(o.isPrimary)>"u"&&(o.isPrimary=!0),_typeof(o.width)>"u"&&(o.width=1),_typeof(o.height)>"u"&&(o.height=1),_typeof(o.tiltX)>"u"&&(o.tiltX=0),_typeof(o.tiltY)>"u"&&(o.tiltY=0),_typeof(o.pointerType)>"u"&&(o.pointerType="mouse"),_typeof(o.pointerId)>"u"&&(o.pointerId=1),_typeof(o.pressure)>"u"&&(o.pressure=.5),_typeof(o.twist)>"u"&&(o.twist=0),_typeof(o.tangentialPressure)>"u"&&(o.tangentialPressure=0),o.isNormalized=!0,t.push(o)}else t.push(e);return t}},{key:"normalizeWheelEvent",value:function(e){var t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}},{key:"bootstrapEvent",value:function(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Fo[e.type]||e.type),e}},{key:"transferMouseData",value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}}],[{key:"defaultEventMode",get:function(){return this._defaultEventMode}}]),e}();No.extension={name:"events",type:[Wt.RendererSystem,Wt.CanvasRendererSystem]},No.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};var Uo=No;function jo(e){return"dynamic"===e||"static"===e}Kt.add(Uo);var Go={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){var e;return null!==(e=this._internalInteractive)&&void 0!==e?e:jo(Uo.defaultEventMode)},set interactive(e){_e("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){var e;return null!==(e=this._internalEventMode)&&void 0!==e?e:Uo.defaultEventMode},set eventMode(e){this._internalInteractive=jo(e),this._internalEventMode=e},isInteractive:function(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener:function(e,t,n){var r="boolean"==typeof n&&n||"object"==_typeof(n)&&n.capture,i="object"==_typeof(n)?n.signal:void 0,o="object"==_typeof(n)&&!0===n.once,a="function"==typeof t?void 0:t;e=r?"".concat(e,"capture"):e;var s="function"==typeof t?t:t.handleEvent,u=this;i&&i.addEventListener("abort",(function(){u.off(e,s,a)})),o?u.once(e,s,a):u.on(e,s,a)},removeEventListener:function(e,t,n){var r="function"==typeof t?void 0:t;e="boolean"==typeof n&&n||"object"==_typeof(n)&&n.capture?"".concat(e,"capture"):e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,r)},dispatchEvent:function(e){if(!(e instanceof Oo))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};so.mixin(Go);var zo={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};so.mixin(zo);var Ho=function(){function e(t){_classCallCheck(this,e),this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(me.tablet||me.phone)&&this.createTouchHook();var n=document.createElement("div");n.style.width="100px",n.style.height="100px",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex=2..toString(),this.div=n,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return _createClass(e,[{key:"isActive",get:function(){return this._isActive}},{key:"isMobileAccessibility",get:function(){return this._isMobileAccessibility}},{key:"createTouchHook",value:function(){var e=this,t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",(function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t}},{key:"destroyTouchHook",value:function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}},{key:"activate",value:function(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(e=this.renderer.view.parentNode)||void 0===e||e.appendChild(this.div))}},{key:"deactivate",value:function(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(e=this.div.parentNode)||void 0===e||e.removeChild(this.div))}},{key:"updateAccessibleObjects",value:function(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);var t=e.children;if(t)for(var n=0;n<t.length;n++)this.updateAccessibleObjects(t[n])}}},{key:"update",value:function(){var e=performance.now();if(!(me.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),n=t.x,r=t.y,i=t.width,o=t.height,a=this.renderer,s=a.width,u=a.height,c=a.resolution,l=i/s*c,h=o/u*c,f=this.div;f.style.left="".concat(n,"px"),f.style.top="".concat(r,"px"),f.style.width="".concat(s,"px"),f.style.height="".concat(u,"px");for(var d=0;d<this.children.length;d++){var p=this.children[d];if(p.renderId!==this.renderId)p._accessibleActive=!1,kt(this.children,d,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,d--;else{f=p._accessibleDiv;var y=p.hitArea,g=p.worldTransform;p.hitArea?(f.style.left=(g.tx+y.x*g.a)*l+"px",f.style.top=(g.ty+y.y*g.d)*h+"px",f.style.width=y.width*g.a*l+"px",f.style.height=y.height*g.d*h+"px"):(y=p.getBounds(),this.capHitArea(y),f.style.left=y.x*l+"px",f.style.top=y.y*h+"px",f.style.width=y.width*l+"px",f.style.height=y.height*h+"px",f.title!==p.accessibleTitle&&null!==p.accessibleTitle&&(f.title=p.accessibleTitle),f.getAttribute("aria-label")!==p.accessibleHint&&null!==p.accessibleHint&&f.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==f.title||p.tabIndex!==f.tabIndex)&&(f.title=p.accessibleTitle,f.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(f))}}this.renderId++}}},{key:"updateDebugHTML",value:function(e){e.innerHTML="type: ".concat(e.type,"</br> title : ").concat(e.title,"</br> tabIndex: ").concat(e.tabIndex)}},{key:"capHitArea",value:function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var t=this.renderer,n=t.width,r=t.height;e.x+e.width>n&&(e.width=n-e.x),e.y+e.height>r&&(e.height=r-e.y)}},{key:"addChild",value:function(e){var t=this.pool.pop();t||((t=document.createElement("button")).style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=2..toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:(!e.accessibleHint||null===e.accessibleHint)&&(t.title="displayObject ".concat(e.tabIndex)),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}},{key:"_dispatchEvent",value:function(e,t){var n=e.target.displayObject,r=this.renderer.events.rootBoundary,i=Object.assign(new Oo(r),{target:n});r.rootTarget=this.renderer.lastObjectRendered,t.forEach((function(e){return r.dispatchEvent(i,e)}))}},{key:"_onClick",value:function(e){this._dispatchEvent(e,["click","pointertap","tap"])}},{key:"_onFocus",value:function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}},{key:"_onFocusOut",value:function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}},{key:"_onKeyDown",value:function(e){9===e.keyCode&&this.activate()}},{key:"_onMouseMove",value:function(e){0===e.movementX&&0===e.movementY||this.deactivate()}},{key:"destroy",value:function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}]),e}();Ho.extension={name:"accessibility",type:[Wt.RendererPlugin,Wt.CanvasRendererPlugin]},Kt.add(Ho);var Vo=function(){function e(t){var n=this;_classCallCheck(this,e),this.stage=new fo,t=Object.assign({forceCanvas:!1},t),this.renderer=Ui(t),e._plugins.forEach((function(e){e.init.call(n,t)}))}return _createClass(e,[{key:"render",value:function(){this.renderer.render(this.stage)}},{key:"view",get:function(){var e;return null===(e=this.renderer)||void 0===e?void 0:e.view}},{key:"screen",get:function(){var e;return null===(e=this.renderer)||void 0===e?void 0:e.screen}},{key:"destroy",value:function(t,n){var r=this,i=e._plugins.slice(0);i.reverse(),i.forEach((function(e){e.destroy.call(r)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(t),this.renderer=null}}]),e}();Vo._plugins=[];var Wo=Vo;Kt.handleByList(Wt.Application,Wo._plugins);var $o=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"init",value:function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t.cancelResize(),t._resizeId=requestAnimationFrame((function(){return t.resize()})))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){var e,n;if(t.cancelResize(),t._resizeTo===globalThis.window)e=globalThis.innerWidth,n=globalThis.innerHeight;else{var r=t._resizeTo;e=r.clientWidth,n=r.clientHeight}t.renderer.resize(e,n),t.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}},{key:"destroy",value:function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}]),e}();$o.extension=Wt.Application,Kt.add($o);var Yo={loader:Wt.LoadParser,resolver:Wt.ResolveParser,cache:Wt.CacheParser,detection:Wt.DetectionParser};Kt.handle(Wt.Asset,(function(e){var t=e.ref;Object.entries(Yo).filter((function(e){var n=_slicedToArray(e,1)[0];return!!t[n]})).forEach((function(e){var n,r=_slicedToArray(e,2),i=r[0],o=r[1];return Kt.add(Object.assign(t[i],{extension:null!==(n=t[i].extension)&&void 0!==n?n:o}))}))}),(function(e){var t=e.ref;Object.keys(Yo).filter((function(e){return!!t[e]})).forEach((function(e){return Kt.remove(t[e])}))}));var Ko=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_classCallCheck(this,e),this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=n}return _createClass(e,[{key:"add",value:function(e){var t=this;e.forEach((function(e){t._assetList.push(e)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}},{key:"_next",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._assetList.length||!this._isActive){e.next=8;break}for(this._isLoading=!0,t=[],n=Math.min(this._assetList.length,this._maxConcurrent),r=0;r<n;r++)t.push(this._assetList.pop());return e.next=6,this._loader.load(t);case 6:this._isLoading=!1,this._next();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"active",get:function(){return this._isActive},set:function(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}]),e}();function Xo(e,t){var n=e.split("?")[0],r=Te.extname(n).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}var Zo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Array.isArray(e)||(e=[e]),t?e.map((function(e){return"string"==typeof e||n?t(e):e})):e},qo=new(function(){function e(){_classCallCheck(this,e),this._parsers=[],this._cache=new Map,this._cacheMap=new Map}return _createClass(e,[{key:"reset",value:function(){this._cacheMap.clear(),this._cache.clear()}},{key:"has",value:function(e){return this._cache.has(e)}},{key:"get",value:function(e){var t=this._cache.get(e);return t||console.warn("[Assets] Asset id ".concat(e," was not found in the Cache")),t}},{key:"set",value:function(e,t){for(var n,r=this,i=Zo(e),o=0;o<this.parsers.length;o++){var a=this.parsers[o];if(a.test(t)){n=a.getCacheableAssets(i,t);break}}n||(n={},i.forEach((function(e){n[e]=t})));var s=Object.keys(n),u={cacheKeys:s,keys:i};if(i.forEach((function(e){r._cacheMap.set(e,u)})),s.forEach((function(e){r._cache.has(e)&&r._cache.get(e)!==t&&console.warn("[Cache] already has key:",e),r._cache.set(e,n[e])})),t instanceof kr){var c=t;i.forEach((function(e){c.baseTexture!==kr.EMPTY.baseTexture&&un.addToCache(c.baseTexture,e),kr.addToCache(c,e)}))}}},{key:"remove",value:function(e){var t=this;if(this._cacheMap.has(e)){var n=this._cacheMap.get(e);n.cacheKeys.forEach((function(e){t._cache.delete(e)})),n.keys.forEach((function(e){t._cacheMap.delete(e)}))}else console.warn("[Assets] Asset id ".concat(e," was not found in the Cache"))}},{key:"parsers",get:function(){return this._parsers}}]),e}()),Jo=function(e){return!Array.isArray(e)},Qo=function(){function e(){var t=this;_classCallCheck(this,e),this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:function(e,n,r){return t._parsersValidated=!1,e[n]=r,!0}}),this.promiseCache={}}return _createClass(e,[{key:"reset",value:function(){this._parsersValidated=!1,this.promiseCache={}}},{key:"_getLoadPromiseAndParser",value:function(e,t){var n=this,r={promise:null,parser:null};return r.promise=_asyncToGenerator(_regeneratorRuntime().mark((function i(){var o,a,s,u,c,l,h,f;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=null,a=null,t.loadParser&&((a=n._parserHash[t.loadParser])||console.warn('[Assets] specified load parser "'.concat(t.loadParser,'" not found while loading ').concat(e))),a){i.next=13;break}s=0;case 3:if(!(s<n.parsers.length)){i.next=11;break}if(!(c=n.parsers[s]).load||null===(u=c.test)||void 0===u||!u.call(c,e,t,n)){i.next=8;break}return a=c,i.abrupt("break",11);case 8:s++,i.next=3;break;case 11:if(a){i.next=13;break}return i.abrupt("return",(console.warn("[Assets] ".concat(e," could not be loaded as we don't know how to parse it, ensure the correct parser has been added")),null));case 13:return i.next=15,a.load(e,t,n);case 15:o=i.sent,r.parser=a,l=0;case 18:if(!(l<n.parsers.length)){i.next=37;break}if(f=n.parsers[l],i.t0=f.parse&&f.parse,!i.t0){i.next=25;break}return i.next=24,null===(h=f.testParse)||void 0===h?void 0:h.call(f,o,t,n);case 24:i.t0=i.sent;case 25:if(i.t1=i.t0,!i.t1){i.next=34;break}return i.next=29,f.parse(o,t,n);case 29:if(i.t2=i.sent,i.t2){i.next=32;break}i.t2=o;case 32:o=i.t2,r.parser=f;case 34:l++,i.next=18;break;case 37:return i.abrupt("return",o);case 38:case"end":return i.stop()}}),i)})))(),r}},{key:"load",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a,s,u,c=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._parsersValidated||this._validateParsers(),r=0,i={},o=Jo(t),a=Zo(t,(function(e){return{alias:[e],src:e}})),s=a.length,u=a.map(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Te.toAbsolute(t.src),i[t.src]){e.next=13;break}return e.prev=2,c.promiseCache[o]||(c.promiseCache[o]=c._getLoadPromiseAndParser(o,t)),e.next=6,c.promiseCache[o].promise;case 6:i[t.src]=e.sent,n&&n(++r/s),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(2),delete c.promiseCache[o],delete i[t.src],new Error("[Loader.load] Failed to load ".concat(o,".\n").concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(u);case 5:return e.abrupt("return",o?i[a[0].src]:i);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unload",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Zo(t,(function(e){return{alias:[e],src:e}})).map(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,o,a,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Te.toAbsolute(t.src),!(i=r.promiseCache[n])){e.next=6;break}return e.next=4,i.promise;case 4:s=e.sent,delete r.promiseCache[n],null===(o=i.parser)||void 0===o||null===(a=o.unload)||void 0===a||a.call(o,s,t,r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_validateParsers",value:function(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((function(e){return e.name})).reduce((function(e,t){return e[t.name]&&console.warn('[Assets] loadParser name conflict "'.concat(t.name,'"')),_objectSpread(_objectSpread({},e),{},_defineProperty({},t.name,t))}),{})}}]),e}(),ea=function(e){return e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e}(ea||{});function ta(e,t){if(Array.isArray(t)){var n,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(e.startsWith("data:".concat(i)))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}return e.startsWith("data:".concat(t))}var na={extension:{type:Wt.LoadParser,priority:ea.Low},name:"loadJson",test:function(e){return ta(e,"application/json")||Xo(e,".json")},load:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.ADAPTER.fetch(t);case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(na);var ra={name:"loadTxt",extension:{type:Wt.LoadParser,priority:ea.Low},test:function(e){return ta(e,"text/plain")||Xo(e,".txt")},load:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.ADAPTER.fetch(t);case 2:return e.next=4,e.sent.text();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(ra);var ia=["normal","bold","100","200","300","400","500","600","700","800","900"],oa=[".ttf",".otf",".woff",".woff2"],aa=["font/ttf","font/otf","font/woff","font/woff2"],sa=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function ua(e){var t,n=Te.extname(e),r=Te.basename(e,n).replace(/(-|_)/g," ").toLowerCase().split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),i=r.length>0,o=_createForOfIteratorHelper(r);try{for(o.s();!(t=o.n()).done;){if(!t.value.match(sa)){i=!1;break}}}catch(s){o.e(s)}finally{o.f()}var a=r.join(" ");return i||(a='"'.concat(a.replace(/[\\"]/g,"\\$&"),'"')),a}var ca=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,la={extension:{type:Wt.LoadParser,priority:ea.Low},name:"loadWebFont",test:function(e){return ta(e,aa)||Xo(e,oa)},load:function(e,t){return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var r,i,o,a,s,u,c,l,h,f,d,p,y,g;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=Q.ADAPTER.getFontFaceSet())){n.next=14;break}c=[],l=null!==(i=null===(o=t.data)||void 0===o?void 0:o.family)&&void 0!==i?i:ua(e),h=null!==(a=null===(s=t.data)||void 0===s||null===(s=s.weights)||void 0===s?void 0:s.filter((function(e){return ia.includes(e)})))&&void 0!==a?a:["normal"],f=null!==(u=t.data)&&void 0!==u?u:{},d=0;case 4:if(!(d<h.length)){n.next=13;break}return p=h[d],y=new FontFace(l,"url(".concat((g=e,ca.test(g)?g:encodeURI(g)),")"),_objectSpread(_objectSpread({},f),{},{weight:p})),n.next=8,y.load();case 8:r.add(y),c.push(y);case 10:d++,n.next=4;break;case 13:return n.abrupt("return",1===c.length?c[0]:c);case 14:return n.abrupt("return",(console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null));case 15:case"end":return n.stop()}}),n)})))()},unload:function(e){(Array.isArray(e)?e:[e]).forEach((function(e){return Q.ADAPTER.getFontFaceSet().delete(e)}))}};Kt.add(la);var ha=null,fa=function(e){function t(){return _classCallCheck(this,t),ha||(ha=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n  async function checkImageBitmap() {\n    try {\n      if (typeof createImageBitmap != "function")\n        return !1;\n      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);\n      return imageBitmap.width === 1 && imageBitmap.height === 1;\n    } catch {\n      return !1;\n    }\n  }\n  checkImageBitmap().then((result) => {\n    self.postMessage(result);\n  });\n})();\n'],{type:"application/javascript"}))),_callSuper(this,t,[ha])}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Worker));fa.revokeObjectURL=function(){ha&&(URL.revokeObjectURL(ha),ha=null)};var da=null,pa=function(e){function t(){return _classCallCheck(this,t),da||(da=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  async function loadImageBitmap(url) {\n    const response = await fetch(url);\n    if (!response.ok)\n      throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n    const imageBlob = await response.blob();\n    return await createImageBitmap(imageBlob);\n  }\n  self.onmessage = async (event) => {\n    try {\n      const imageBitmap = await loadImageBitmap(event.data.data[0]);\n      self.postMessage({\n        data: imageBitmap,\n        uuid: event.data.uuid,\n        id: event.data.id\n      }, [imageBitmap]);\n    } catch (e) {\n      self.postMessage({\n        error: e,\n        uuid: event.data.uuid,\n        id: event.data.id\n      });\n    }\n  };\n})();\n'],{type:"application/javascript"}))),_callSuper(this,t,[da])}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Worker));pa.revokeObjectURL=function(){da&&(URL.revokeObjectURL(da),da=null)};var ya,ga=0,ma=new(function(){function e(){_classCallCheck(this,e),this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}return _createClass(e,[{key:"isImageBitmapSupported",value:function(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((function(e){var t=new fa;t.addEventListener("message",(function(n){t.terminate(),fa.revokeObjectURL(),e(n.data)}))}))),this._isImageBitmapSupported}},{key:"loadImageBitmap",value:function(e){return this._run("loadImageBitmap",[e])}},{key:"_initWorkers",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._initialized||(this._initialized=!0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWorker",value:function(){var e=this;void 0===ya&&(ya=navigator.hardwareConcurrency||4);var t=this.workerPool.pop();return!t&&this._createdWorkers<ya&&(this._createdWorkers++,(t=new pa).addEventListener("message",(function(t){e.complete(t.data),e.returnWorker(t.target),e.next()}))),t}},{key:"returnWorker",value:function(e){this.workerPool.push(e)}},{key:"complete",value:function(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}},{key:"_run",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initWorkers();case 2:return r=new Promise((function(e,r){i.queue.push({id:t,arguments:n,resolve:e,reject:r})})),e.abrupt("return",(this.next(),r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"next",value:function(){if(this.queue.length){var e=this.getWorker();if(e){var t=this.queue.pop(),n=t.id;this.resolveHash[ga]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:ga++,id:n})}}}}]),e}());function va(e,t,n){e.resource.internal=!0;var r=new kr(e),i=function(){delete t.promiseCache[n],qo.has(n)&&qo.remove(n)};return r.baseTexture.once("destroyed",(function(){n in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())})),r.once("destroyed",(function(){e.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())})),r}var wa=[".jpeg",".jpg",".png",".webp",".avif"],ba=["image/jpeg","image/png","image/webp","image/avif"];function xa(e){return _a.apply(this,arguments)}function _a(){return _a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.ADAPTER.fetch(t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("[loadImageBitmap] Failed to fetch ".concat(t,": ").concat(n.status," ").concat(n.statusText));case 5:return e.next=7,n.blob();case 7:return r=e.sent,e.next=10,createImageBitmap(r);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)}))),_a.apply(this,arguments)}var Ia={name:"loadTextures",extension:{type:Wt.LoadParser,priority:ea.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:function(e){return ta(e,ba)||Xo(e,wa)},load:function(e,t,n){var r=this;return _asyncToGenerator(_regeneratorRuntime().mark((function i(){var o,a,s,u,c,l;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(s=globalThis.createImageBitmap&&r.config.preferCreateImageBitmap)){i.next=19;break}if(i.t1=r.config.preferWorkers,!i.t1){i.next=7;break}return i.next=6,ma.isImageBitmapSupported();case 6:i.t1=i.sent;case 7:if(!i.t1){i.next=13;break}return i.next=10,ma.loadImageBitmap(e);case 10:i.t2=i.sent,i.next=16;break;case 13:return i.next=15,xa(e);case 15:i.t2=i.sent;case 16:i.t0=i.t2,i.next=22;break;case 19:return i.next=21,new Promise((function(t,n){var i=new Image;i.crossOrigin=r.config.crossOrigin,i.src=e,i.complete?t(i):(i.onload=function(){return t(i)},i.onerror=function(e){return n(e)})}));case 21:i.t0=i.sent;case 22:return u=i.t0,c=_objectSpread({},t.data),null!==(o=c.resolution)&&void 0!==o||(c.resolution=Vt(e)),s&&void 0===(null===(a=c.resourceOptions)||void 0===a?void 0:a.ownsImageBitmap)&&(c.resourceOptions=_objectSpread({},c.resourceOptions),c.resourceOptions.ownsImageBitmap=!0),l=new un(u,c),i.abrupt("return",(l.resource.src=e,va(l,n,e)));case 27:case"end":return i.stop()}}),i)})))()},unload:function(e){e.destroy(!0)}};Kt.add(Ia);var Aa={extension:{type:Wt.LoadParser,priority:ea.High},name:"loadSVG",test:function(e){return ta(e,"image/svg+xml")||Xo(e,".svg")},testParse:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",to.test(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),parse:function(e,t,n){return _asyncToGenerator(_regeneratorRuntime().mark((function r(){var i,o,a;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=new to(e,null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.resourceOptions),r.next=3,o.load();case 3:return a=new un(o,_objectSpread({resolution:Vt(e)},null===t||void 0===t?void 0:t.data)),r.abrupt("return",(a.resource.src=t.src,va(a,n,t.src)));case 5:case"end":return r.stop()}}),r)})))()},load:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.ADAPTER.fetch(t);case 2:return e.abrupt("return",e.sent.text());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),unload:Ia.unload};Kt.add(Aa);var Ca=[".mp4",".m4v",".webm",".ogv"],ka=["video/mp4","video/webm","video/ogg"],Sa={name:"loadVideo",extension:{type:Wt.LoadParser,priority:ea.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test:function(e){return ta(e,ka)||Xo(e,Ca)},load:function(e,t,n){var r=this;return _asyncToGenerator(_regeneratorRuntime().mark((function i(){var o,a,s,u,c,l,h;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Q.ADAPTER.fetch(e);case 2:return i.next=4,i.sent.blob();case 4:return a=i.sent,s=URL.createObjectURL(a),i.prev=6,c=_objectSpread(_objectSpread({autoPlay:r.config.defaultAutoPlay,updateFPS:r.config.defaultUpdateFPS,loop:r.config.defaultLoop,muted:r.config.defaultMuted,playsinline:r.config.defaultPlaysinline},null===t||void 0===t||null===(u=t.data)||void 0===u?void 0:u.resourceOptions),{},{autoLoad:!0}),l=new ro(s,c),i.next=10,l.load();case 10:return i.t0=un,i.t1=l,i.t2=_objectSpread,i.next=15,Ee();case 15:i.t3=i.sent,i.t4=Vt(e),i.t5={alphaMode:i.t3,resolution:i.t4},i.t6=null===t||void 0===t?void 0:t.data,i.t7=(0,i.t2)(i.t5,i.t6),(h=new i.t0(i.t1,i.t7)).resource.src=e,(o=va(h,n,e)).baseTexture.once("destroyed",(function(){URL.revokeObjectURL(s)})),i.next=27;break;case 24:throw i.prev=24,i.t8=i.catch(6),URL.revokeObjectURL(s),i.t8;case 27:return i.abrupt("return",o);case 28:case"end":return i.stop()}}),i,null,[[6,24]])})))()},unload:function(e){e.destroy(!0)}};function Ta(e,t,n,r,i){for(var o=t[n],a=0;a<o.length;a++){var s=o[a];n<t.length-1?Ta(e.replace(r[n],s),t,n+1,r,i):i.push(e.replace(r[n],s))}}function Ea(e){var t=e.match(/\{(.*?)\}/g),n=[];if(t){var r=[];t.forEach((function(e){var t=e.substring(1,e.length-1).split(",");r.push(t)})),Ta(e,r,0,t,n)}else n.push(e);return n}Kt.add(Sa);var Oa=function(){function e(){var t=this;_classCallCheck(this,e),this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:function(e,n){return"".concat(e).concat(t._bundleIdConnector).concat(n)},extractAssetIdFromBundle:function(e,n){return n.replace("".concat(e).concat(t._bundleIdConnector),"")}},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}return _createClass(e,[{key:"setBundleIdentifier",value:function(e){var t,n,r;if(this._bundleIdConnector=null!==(t=e.connector)&&void 0!==t?t:this._bundleIdConnector,this._createBundleAssetId=null!==(n=e.createBundleAssetId)&&void 0!==n?n:this._createBundleAssetId,this._extractAssetIdFromBundle=null!==(r=e.extractAssetIdFromBundle)&&void 0!==r?r:this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}},{key:"prefer",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}},{key:"basePath",get:function(){return this._basePath},set:function(e){this._basePath=e}},{key:"rootPath",get:function(){return this._rootPath},set:function(e){this._rootPath=e}},{key:"parsers",get:function(){return this._parsers}},{key:"reset",value:function(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}},{key:"setDefaultSearchParams",value:function(e){if("string"==typeof e)this._defaultSearchParams=e;else{var t=e;this._defaultSearchParams=Object.keys(t).map((function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t[e]))})).join("&")}}},{key:"getAlias",value:function(e){var t=e.alias,n=e.name,r=e.src,i=e.srcs;return Zo(t||n||r||i,(function(e){var t;return"string"==typeof e?e:Array.isArray(e)?e.map((function(e){var t,n;return null!==(t=null!==(n=null===e||void 0===e?void 0:e.src)&&void 0!==n?n:null===e||void 0===e?void 0:e.srcs)&&void 0!==t?t:e})):null!==e&&void 0!==e&&e.src||null!==e&&void 0!==e&&e.srcs?null!==(t=e.src)&&void 0!==t?t:e.srcs:e}),!0)}},{key:"addManifest",value:function(e){var t=this;this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach((function(e){t.addBundle(e.name,e.assets)}))}},{key:"addBundle",value:function(e,t){var n=this,r=[];Array.isArray(t)?t.forEach((function(t){var i,o,a,s=null!==(i=t.src)&&void 0!==i?i:t.srcs,u=null!==(o=t.alias)&&void 0!==o?o:t.name;if("string"==typeof u){var c=n._createBundleAssetId(e,u);r.push(c),a=[u,c]}else{var l=u.map((function(t){return n._createBundleAssetId(e,t)}));r.push.apply(r,_toConsumableArray(l)),a=[].concat(_toConsumableArray(u),_toConsumableArray(l))}n.add(_objectSpread(_objectSpread({},t),{},{alias:a,src:s}))})):Object.keys(t).forEach((function(i){var o=[i,n._createBundleAssetId(e,i)];if("string"==typeof t[i])n.add({alias:o,src:t[i]});else if(Array.isArray(t[i]))n.add({alias:o,src:t[i]});else{var a,s=t[i],u=null!==(a=s.src)&&void 0!==a?a:s.srcs;n.add(_objectSpread(_objectSpread({},s),{},{alias:o,src:Array.isArray(u)?u:[u]}))}r.push.apply(r,o)})),this._bundles[e]=r}},{key:"add",value:function(e,t,n,r,i){var o,a=this,s=[];"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]?(_e("7.2.0","Assets.add now uses an object instead of individual parameters.\nPlease use Assets.add({ alias, src, data, format, loadParser }) instead."),s.push({alias:e,src:t,data:n,format:r,loadParser:i})):Array.isArray(e)?s.push.apply(s,_toConsumableArray(e)):s.push(e),o=function(e){a.hasKey(e)&&console.warn("[Resolver] already has key: ".concat(e," overwriting"))},Zo(s).forEach((function(e){var t=e.src,n=e.srcs,r=e.data,i=e.format,s=e.loadParser,u=Zo(t||n).map((function(e){return"string"==typeof e?Ea(e):Array.isArray(e)?e:[e]})),c=a.getAlias(e);Array.isArray(c)?c.forEach(o):o(c);var l=[];u.forEach((function(e){e.forEach((function(e){var t,n,o,u={};if("object"!=_typeof(e)){u.src=e;for(var h=0;h<a._parsers.length;h++){var f=a._parsers[h];if(f.test(e)){u=f.parse(e);break}}}else r=null!==(t=e.data)&&void 0!==t?t:r,i=null!==(n=e.format)&&void 0!==n?n:i,s=null!==(o=e.loadParser)&&void 0!==o?o:s,u=_objectSpread(_objectSpread({},u),e);if(!c)throw new Error("[Resolver] alias is undefined for this asset: ".concat(u.src));u=a.buildResolvedAsset(u,{aliases:c,data:r,format:i,loadParser:s}),l.push(u)}))})),c.forEach((function(e){a._assetMap[e]=l}))}))}},{key:"resolveBundle",value:function(e){var t=this,n=Jo(e);e=Zo(e);var r={};return e.forEach((function(e){var n=t._bundles[e];if(n){var i=t.resolve(n),o={};for(var a in i){var s=i[a];o[t._extractAssetIdFromBundle(e,a)]=s}r[e]=o}})),n?r[e[0]]:r}},{key:"resolveUrl",value:function(e){var t=this.resolve(e);if("string"!=typeof e){var n={};for(var r in t)n[r]=t[r].src;return n}return t.src}},{key:"resolve",value:function(e){var t=this,n=Jo(e);e=Zo(e);var r={};return e.forEach((function(e){if(!t._resolverHash[e])if(t._assetMap[e]){var n,i=t._assetMap[e],o=i[0],a=t._getPreferredOrder(i);null!==a&&void 0!==a&&a.priority.forEach((function(e){a.params[e].forEach((function(t){var n=i.filter((function(n){return!!n[e]&&n[e]===t}));n.length&&(i=n)}))})),t._resolverHash[e]=null!==(n=i[0])&&void 0!==n?n:o}else t._resolverHash[e]=t.buildResolvedAsset({alias:[e],src:e},{});r[e]=t._resolverHash[e]})),n?r[e[0]]:r}},{key:"hasKey",value:function(e){return!!this._assetMap[e]}},{key:"hasBundle",value:function(e){return!!this._bundles[e]}},{key:"_getPreferredOrder",value:function(e){for(var t,n=this,r=function(){var t=e[0],r=n._preferredOrder.find((function(e){return e.params.format.includes(t.format)}));if(r)return{v:r}},i=0;i<e.length;i++)if(t=r())return t.v;return this._preferredOrder[0]}},{key:"_appendDefaultSearchParams",value:function(e){return this._defaultSearchParams?"".concat(e).concat(/\?/.test(e)?"&":"?").concat(this._defaultSearchParams):e}},{key:"buildResolvedAsset",value:function(e,t){var n,r=t.aliases,i=t.data,o=t.loadParser,a=t.format;return(this._basePath||this._rootPath)&&(e.src=Te.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=null!==(n=null!==r&&void 0!==r?r:e.alias)&&void 0!==n?n:[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data=_objectSpread(_objectSpread({},i||{}),e.data),e.loadParser=null!==o&&void 0!==o?o:e.loadParser,e.format=null!==a&&void 0!==a?a:Te.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}]),e}(),Pa=function(){function e(){_classCallCheck(this,e),this._detections=[],this._initialized=!1,this.resolver=new Oa,this.loader=new Qo,this.cache=qo,this._backgroundLoader=new Ko(this.loader),this._backgroundLoader.active=!0,this.reset()}return _createClass(e,[{key:"init",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,i,o,a,s,u,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>0&&void 0!==c[0]?c[0]:{},!this._initialized){e.next=3;break}return e.abrupt("return",void console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?"));case 3:if(this._initialized=!0,i.defaultSearchParams&&this.resolver.setDefaultSearchParams(i.defaultSearchParams),i.basePath&&(this.resolver.basePath=i.basePath),i.bundleIdentifier&&this.resolver.setBundleIdentifier(i.bundleIdentifier),!i.manifest){e.next=11;break}if(o=i.manifest,e.t0="string"==typeof o,!e.t0){e.next=10;break}return e.next=9,this.load(o);case 9:o=e.sent;case 10:this.resolver.addManifest(o);case 11:return a=null!==(t=null===(n=i.texturePreference)||void 0===n?void 0:n.resolution)&&void 0!==t?t:1,s="number"==typeof a?[a]:a,e.next=15,this._detectFormats({preferredFormats:null===(r=i.texturePreference)||void 0===r?void 0:r.format,skipDetections:i.skipDetections,detections:this._detections});case 15:u=e.sent,this.resolver.prefer({params:{format:u,resolution:s}}),i.preferences&&this.setPreferences(i.preferences);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(e,t,n,r,i){this.resolver.add(e,t,n,r,i)}},{key:"load",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a,s=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._initialized,e.t0){e.next=4;break}return e.next=4,this.init();case 4:return r=Jo(t),i=Zo(t).map((function(e){if("string"!=typeof e){var t=s.resolver.getAlias(e);return t.some((function(e){return!s.resolver.hasKey(e)}))&&s.add(e),Array.isArray(t)?t[0]:t}return s.resolver.hasKey(e)||s.add({alias:e,src:e}),e})),o=this.resolver.resolve(i),e.next=9,this._mapLoadToResolve(o,n);case 9:return a=e.sent,e.abrupt("return",r?a[i[0]]:a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addBundle",value:function(e,t){this.resolver.addBundle(e,t)}},{key:"loadBundle",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a,s,u,c,l,h=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._initialized,e.t0){e.next=4;break}return e.next=4,this.init();case 4:return r=!1,"string"==typeof t&&(r=!0,t=[t]),i=this.resolver.resolveBundle(t),o={},a=Object.keys(i),s=0,u=0,c=function(){null===n||void 0===n||n(++s/u)},l=a.map((function(e){var t=i[e];return u+=Object.keys(t).length,h._mapLoadToResolve(t,c).then((function(t){o[e]=t}))})),e.next=11,Promise.all(l);case 11:return e.abrupt("return",r?o[t[0]]:o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"backgroundLoad",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._initialized,e.t0){e.next=4;break}return e.next=4,this.init();case 4:"string"==typeof t&&(t=[t]),n=this.resolver.resolve(t),this._backgroundLoader.add(Object.values(n));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"backgroundLoadBundle",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._initialized,e.t0){e.next=4;break}return e.next=4,this.init();case 4:"string"==typeof t&&(t=[t]),n=this.resolver.resolveBundle(t),Object.values(n).forEach((function(e){r._backgroundLoader.add(Object.values(e))}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}},{key:"get",value:function(e){if("string"==typeof e)return qo.get(e);for(var t={},n=0;n<e.length;n++)t[n]=qo.get(e[n]);return t}},{key:"_mapLoadToResolve",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.values(t),i=Object.keys(t),this._backgroundLoader.active=!1,e.next=4,this.loader.load(r,n);case 4:return o=e.sent,this._backgroundLoader.active=!0,a={},e.abrupt("return",(r.forEach((function(e,t){var n=o[e.src],r=[e.src];e.alias&&r.push.apply(r,_toConsumableArray(e.alias)),a[i[t]]=n,qo.set(r,n)})),a));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unload",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._initialized,e.t0){e.next=4;break}return e.next=4,this.init();case 4:return n=Zo(t).map((function(e){return"string"!=typeof e?e.src:e})),r=this.resolver.resolve(n),e.next=7,this._unloadFromResolved(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unloadBundle",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._initialized,e.t0){e.next=4;break}return e.next=4,this.init();case 4:return t=Zo(t),n=this.resolver.resolveBundle(t),r=Object.keys(n).map((function(e){return i._unloadFromResolved(n[e])})),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_unloadFromResolved",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Object.values(t)).forEach((function(e){qo.remove(e.src)})),e.next=4,this.loader.unload(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_detectFormats",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t.preferredFormats&&(n=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]),r=_createForOfIteratorHelper(t.detections),e.prev=3,r.s();case 5:if((i=r.n()).done){e.next=25;break}if(o=i.value,e.t0=t.skipDetections,e.t0){e.next=12;break}return e.next=11,o.test();case 11:e.t0=e.sent;case 12:if(!e.t0){e.next=18;break}return e.next=15,o.add(n);case 15:n=e.sent,e.next=23;break;case 18:if(e.t1=t.skipDetections,e.t1){e.next=23;break}return e.next=22,o.remove(n);case 22:n=e.sent;case 23:e.next=5;break;case 25:e.next=30;break;case 27:e.prev=27,e.t2=e.catch(3),r.e(e.t2);case 30:return e.prev=30,r.f(),e.finish(30);case 33:return e.abrupt("return",(n=n.filter((function(e,t){return n.indexOf(e)===t})),n));case 34:case"end":return e.stop()}}),e,null,[[3,27,30,33]])})));return function(t){return e.apply(this,arguments)}}()},{key:"detections",get:function(){return this._detections}},{key:"preferWorkers",get:function(){return Ia.config.preferWorkers},set:function(e){_e("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}},{key:"setPreferences",value:function(e){this.loader.parsers.forEach((function(t){t.config&&Object.keys(t.config).filter((function(t){return t in e})).forEach((function(n){t.config[n]=e[n]}))}))}}]),e}(),Ra=new Pa;Kt.handleByList(Wt.LoadParser,Ra.loader.parsers).handleByList(Wt.ResolveParser,Ra.resolver.parsers).handleByList(Wt.CacheParser,Ra.cache.parsers).handleByList(Wt.DetectionParser,Ra.detections);var Ba={extension:Wt.CacheParser,test:function(e){return Array.isArray(e)&&e.every((function(e){return e instanceof kr}))},getCacheableAssets:function(e,t){var n={};return e.forEach((function(e){t.forEach((function(t,r){n[e+(0===r?"":r+1)]=t}))})),n}};function Da(e){return Ma.apply(this,arguments)}function Ma(){return Ma=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("Image"in globalThis)){e.next=2;break}return e.abrupt("return",new Promise((function(e){var n=new Image;n.onload=function(){e(!0)},n.onerror=function(){e(!1)},n.src=t})));case 2:if(!("createImageBitmap"in globalThis)||!("fetch"in globalThis)){e.next=17;break}return e.prev=3,e.next=6,fetch(t);case 6:return e.next=8,e.sent.blob();case 8:return n=e.sent,e.next=11,createImageBitmap(n);case 11:e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(3),e.abrupt("return",!1);case 16:return e.abrupt("return",!0);case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[3,13]])}))),Ma.apply(this,arguments)}Kt.add(Ba);var La={extension:{type:Wt.DetectionParser,priority:1},test:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Da("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),add:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(_toConsumableArray(t),["avif"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter((function(e){return"avif"!==e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(La);var Fa={extension:{type:Wt.DetectionParser,priority:0},test:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Da("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),add:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(_toConsumableArray(t),["webp"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter((function(e){return"webp"!==e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(Fa);var Na=["png","jpg","jpeg"],Ua={extension:{type:Wt.DetectionParser,priority:-1},test:function(){return Promise.resolve(!0)},add:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(_toConsumableArray(t),Na));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter((function(e){return!Na.includes(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(Ua);var ja="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ga(e){return!ja&&""!==document.createElement("video").canPlayType(e)}var za={extension:{type:Wt.DetectionParser,priority:0},test:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ga("video/webm"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),add:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(_toConsumableArray(t),["webm"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter((function(e){return"webm"!==e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(za);var Ha={extension:{type:Wt.DetectionParser,priority:0},test:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ga("video/mp4"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),add:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(_toConsumableArray(t),["mp4","m4v"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter((function(e){return"mp4"!==e&&"m4v"!==e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(Ha);var Va={extension:{type:Wt.DetectionParser,priority:0},test:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ga("video/ogg"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),add:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(_toConsumableArray(t),["ogv"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter((function(e){return"ogv"!==e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(Va);var Wa={extension:Wt.ResolveParser,test:Ia.test,parse:function(e){var t,n;return{resolution:parseFloat(null!==(t=null===(n=Q.RETINA_PREFIX.exec(e))||void 0===n?void 0:n[1])&&void 0!==t?t:"1"),format:Te.extname(e).slice(1),src:e}}};Kt.add(Wa);var $a,Ya,Ka=function(e,t){var n=t.split("?")[1];return n&&(e+="?".concat(n)),e},Xa=function(e){return e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e}(Xa||{}),Za={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};function qa(){Ya={s3tc:$a.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:$a.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:$a.getExtension("WEBGL_compressed_texture_etc"),etc1:$a.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:$a.getExtension("WEBGL_compressed_texture_pvrtc")||$a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:$a.getExtension("WEBGL_compressed_texture_atc"),astc:$a.getExtension("WEBGL_compressed_texture_astc"),bptc:$a.getExtension("EXT_texture_compression_bptc")}}var Ja={extension:{type:Wt.DetectionParser,priority:2},test:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Q.ADAPTER.createCanvas().getContext("webgl"),e.abrupt("return",t?($a=t,!0):(console.warn("WebGL not available for compressed textures."),!1));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),add:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in Ya||qa(),n=[],Ya)Ya[r]&&n.push(r);return e.abrupt("return",[].concat(n,_toConsumableArray(t)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(Ya||qa(),t.filter((function(e){return!(e in Ya)}))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};Kt.add(Ja);var Qa=function(e){function t(e){var n,r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:1,height:1,autoLoad:!0};return _classCallCheck(this,t),"string"==typeof e?(r=e,i=new Uint8Array):(r=null,i=e),(n=_callSuper(this,t,[i,o])).origin=r,n.buffer=i?new Xt(i):null,n._load=null,n.loaded=!1,null!==n.origin&&!1!==o.autoLoad&&n.load(),null===n.origin&&n.buffer&&(n._load=Promise.resolve(_assertThisInitialized(n)),n.loaded=!0,n.onBlobLoaded(n.buffer.rawBinaryData)),n}return _inherits(t,e),_createClass(t,[{key:"onBlobLoaded",value:function(e){}},{key:"load",value:function(){var e=this;return this._load||(this._load=fetch(this.origin).then((function(e){return e.blob()})).then((function(e){return e.arrayBuffer()})).then((function(t){return e.data=new Uint32Array(t),e.buffer=new Xt(t),e.loaded=!0,e.onBlobLoaded(t),e.update(),e}))),this._load}}]),t}(on),es=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).format=n.format,r.levels=n.levels||1,r._width=n.width,r._height=n.height,r._extension=t._formatToExtension(r.format),(n.levelBuffers||r.buffer)&&(r._levelBuffers=n.levelBuffers||t._createLevelBuffers(e instanceof Uint8Array?e:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return _inherits(t,e),_createClass(t,[{key:"upload",value:function(e,t,n){var r=e.gl;if(!e.context.extensions[this._extension])throw new Error("".concat(this._extension," textures are not supported on the current machine"));if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(var i=0,o=this.levels;i<o;i++){var a=this._levelBuffers[i],s=a.levelID,u=a.levelWidth,c=a.levelHeight,l=a.levelBuffer;r.compressedTexImage2D(r.TEXTURE_2D,s,this.format,u,c,0,l)}return!0}},{key:"onBlobLoaded",value:function(){this._levelBuffers=t._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}}],[{key:"_formatToExtension",value:function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(36196===e)return"etc1";if(35986===e||35987===e||34798===e)return"atc";if(e>=36492&&e<=36495)return"bptc";if(37808===e)return"astc";throw new Error("Invalid (compressed) texture format given: ".concat(e))}},{key:"_createLevelBuffers",value:function(e,t,n,r,i,o,a){for(var s=new Array(n),u=e.byteOffset,c=o,l=a,h=c+r-1&~(r-1),f=l+i-1&~(i-1),d=h*f*Za[t],p=0;p<n;p++)s[p]={levelID:p,levelWidth:n>1?c:h,levelHeight:n>1?l:f,levelBuffer:new Uint8Array(e.buffer,u,d)},u+=d,d=(h=(c=c>>1||1)+r-1&~(r-1))*(f=(l=l>>1||1)+i-1&~(i-1))*Za[t];return s}}]),t}(Qa),ts=4,ns=124,rs=32,is=20,os=542327876,as={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},ss={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},us={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},cs=1,ls=2,hs=4,fs=64,ds=512,ps=131072,ys=808540228,gs=4,ms={827611204:Xa.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:Xa.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:Xa.COMPRESSED_RGBA_S3TC_DXT5_EXT},vs={70:Xa.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Xa.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Xa.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Xa.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Xa.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Xa.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Xa.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Xa.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Xa.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Xa.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Xa.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Xa.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Xa.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function ws(e){var t=new Uint32Array(e);if(t[0]!==os)throw new Error("Invalid DDS file magic word");var n=new Uint32Array(e,0,ns/Uint32Array.BYTES_PER_ELEMENT),r=n[as.HEIGHT],i=n[as.WIDTH],o=n[as.MIPMAP_COUNT],a=new Uint32Array(e,as.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,rs/Uint32Array.BYTES_PER_ELEMENT),s=a[cs];if(s&hs){var u=a[ss.FOURCC];if(u!==ys){var c=ms[u],l=new Uint8Array(e,ts+ns);return[new es(l,{format:c,width:i,height:r,levels:o})]}var h=ts+ns,f=new Uint32Array(t.buffer,h,is/Uint32Array.BYTES_PER_ELEMENT),d=f[us.DXGI_FORMAT],p=f[us.RESOURCE_DIMENSION],y=f[us.MISC_FLAG],g=f[us.ARRAY_SIZE],m=vs[d];if(void 0===m)throw new Error("DDSParser cannot parse texture data with DXGI format ".concat(d));if(y===gs)throw new Error("DDSParser does not support cubemap textures");if(6===p)throw new Error("DDSParser does not supported 3D texture data");var v=new Array,w=ts+ns+is;if(1===g)v.push(new Uint8Array(e,w));else{for(var b=Za[m],x=0,_=i,I=r,A=0;A<o;A++)x+=Math.max(1,_+3&-4)*Math.max(1,I+3&-4)*b,_>>>=1,I>>>=1;for(var C=w,k=0;k<g;k++)v.push(new Uint8Array(e,C,x)),C+=x}return v.map((function(e){return new es(e,{format:m,width:i,height:r,levels:o})}))}throw s&fs?new Error("DDSParser does not support uncompressed texture data."):s&ds?new Error("DDSParser does not supported YUV uncompressed texture data."):s&ps?new Error("DDSParser does not support single-channel (lumninance) texture data!"):s&ls?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var bs=[171,75,84,88,32,49,49,187,13,10,26,10],xs=67305985,_s={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Is=64,As=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},U.UNSIGNED_BYTE,1),U.UNSIGNED_SHORT,2),U.INT,4),U.UNSIGNED_INT,4),U.FLOAT,4),U.HALF_FLOAT,8),Cs=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},F.RGBA,4),F.RGB,3),F.RG,2),F.RED,1),F.LUMINANCE,1),F.LUMINANCE_ALPHA,2),F.ALPHA,1),ks=_defineProperty(_defineProperty(_defineProperty({},U.UNSIGNED_SHORT_4_4_4_4,2),U.UNSIGNED_SHORT_5_5_5_1,2),U.UNSIGNED_SHORT_5_6_5,2);function Ss(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new DataView(t);if(!function(e,t){for(var n=0;n<bs.length;n++)if(t.getUint8(n)!==bs[n])return console.error("".concat(e," is not a valid *.ktx file!")),!1;return!0}(e,r))return null;var i=r.getUint32(_s.ENDIANNESS,!0)===xs,o=r.getUint32(_s.GL_TYPE,i),a=r.getUint32(_s.GL_FORMAT,i),s=r.getUint32(_s.GL_INTERNAL_FORMAT,i),u=r.getUint32(_s.PIXEL_WIDTH,i),c=r.getUint32(_s.PIXEL_HEIGHT,i)||1,l=r.getUint32(_s.PIXEL_DEPTH,i)||1,h=r.getUint32(_s.NUMBER_OF_ARRAY_ELEMENTS,i)||1,f=r.getUint32(_s.NUMBER_OF_FACES,i),d=r.getUint32(_s.NUMBER_OF_MIPMAP_LEVELS,i),p=r.getUint32(_s.BYTES_OF_KEY_VALUE_DATA,i);if(0===c||1!==l)throw new Error("Only 2D textures are supported");if(1!==f)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==h)throw new Error("WebGL does not support array textures");var y,g=u+3&-4,m=c+3&-4,v=new Array(h),w=u*c;if(0===o&&(w=g*m),void 0===(y=0!==o?As[o]?As[o]*Cs[a]:ks[o]:Za[s]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var b=n?function(e,t,n){for(var r=new Map,i=0;i<t;){var o=e.getUint32(Is+i,n),a=Is+i+4,s=3-(o+3)%4;if(0===o||o>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var u=0;u<o&&0!==e.getUint8(a+u);u++);if(-1===u){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var c=(new TextDecoder).decode(new Uint8Array(e.buffer,a,u)),l=new DataView(e.buffer,a+u+1,o-u-1);r.set(c,l),i+=4+o+s}return r}(r,p,i):null,x=w*y,_=u,I=c,A=g,C=m,k=Is+p,S=0;S<d;S++){for(var T=r.getUint32(k,i),E=k+4,O=0;O<h;O++){var P=v[O];P||(P=v[O]=new Array(d)),P[S]={levelID:S,levelWidth:d>1||0!==o?_:A,levelHeight:d>1||0!==o?I:C,levelBuffer:new Uint8Array(t,E,x)},E+=x}k=(k+=T+4)%4!=0?k+4-k%4:k,x=(A=(_=_>>1||1)+4-1&-4)*(C=(I=I>>1||1)+4-1&-4)*y}return 0!==o?{uncompressed:v.map((function(e){var t=e[0].levelBuffer,n=!1;return o===U.FLOAT?t=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):o===U.UNSIGNED_INT?(n=!0,t=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):o===U.INT&&(n=!0,t=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new on(t,{width:e[0].levelWidth,height:e[0].levelHeight}),type:o,format:n?Ts(a):a}})),kvData:b}:{compressed:v.map((function(e){return new es(null,{format:s,width:u,height:c,levels:d,levelBuffers:e})})),kvData:b}}function Ts(e){switch(e){case F.RGBA:return F.RGBA_INTEGER;case F.RGB:return F.RGB_INTEGER;case F.RG:return F.RG_INTEGER;case F.RED:return F.RED_INTEGER;default:return e}}var Es={extension:{type:Wt.LoadParser,priority:ea.High},name:"loadDDS",test:function(e){return Xo(e,".dds")},load:function(e,t,n){return _asyncToGenerator(_regeneratorRuntime().mark((function r(){var i;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=ws,r.next=3,Q.ADAPTER.fetch(e);case 3:return r.next=5,r.sent.arrayBuffer();case 5:return r.t1=r.sent,i=(0,r.t0)(r.t1).map((function(r){return va(new un(r,_objectSpread({mipmap:H.OFF,alphaMode:V.NO_PREMULTIPLIED_ALPHA,resolution:Vt(e)},t.data)),n,e)})),r.abrupt("return",1===i.length?i[0]:i);case 8:case"end":return r.stop()}}),r)})))()},unload:function(e){Array.isArray(e)?e.forEach((function(e){return e.destroy(!0)})):e.destroy(!0)}};Kt.add(Es);var Os={extension:{type:Wt.LoadParser,priority:ea.High},name:"loadKTX",test:function(e){return Xo(e,".ktx")},load:function(e,t,n){return _asyncToGenerator(_regeneratorRuntime().mark((function r(){var i,o,a,s,u,c,l,h;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Q.ADAPTER.fetch(e);case 2:return r.next=4,r.sent.arrayBuffer();case 4:return i=r.sent,o=Ss(e,i),a=o.compressed,s=o.uncompressed,u=o.kvData,c=null!==a&&void 0!==a?a:s,l=_objectSpread({mipmap:H.OFF,alphaMode:V.NO_PREMULTIPLIED_ALPHA,resolution:Vt(e)},t.data),h=c.map((function(t){var r;c===s&&Object.assign(l,{type:t.type,format:t.format});var i=null!==(r=t.resource)&&void 0!==r?r:t,o=new un(i,l);return o.ktxKeyValueData=u,va(o,n,e)})),r.abrupt("return",1===h.length?h[0]:h);case 13:case"end":return r.stop()}}),r)})))()},unload:function(e){Array.isArray(e)?e.forEach((function(e){return e.destroy(!0)})):e.destroy(!0)}};Kt.add(Os);var Ps={extension:Wt.ResolveParser,test:function(e){var t=Te.extname(e).slice(1);return["basis","ktx","dds"].includes(t)},parse:function(e){var t,n,r=Te.extname(e).slice(1);if("ktx"===r){var i,o,a=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx",".bptc.ktx"];if(a.some((function(t){return e.endsWith(t)})))return{resolution:parseFloat(null!==(i=null===(o=Q.RETINA_PREFIX.exec(e))||void 0===o?void 0:o[1])&&void 0!==i?i:"1"),format:a.find((function(t){return e.endsWith(t)})),src:e}}return{resolution:parseFloat(null!==(t=null===(n=Q.RETINA_PREFIX.exec(e))||void 0===n?void 0:n[1])&&void 0!==t?t:"1"),format:r,src:e}}};Kt.add(Ps);var Rs=new Cn,Bs=function(){function e(t){_classCallCheck(this,e),this.renderer=t,this._rendererPremultipliedAlpha=!1}return _createClass(e,[{key:"contextChange",value:function(){var e,t=null===(e=this.renderer)||void 0===e?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}},{key:"image",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i){var o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new Image,e.next=3,this.base64(t,n,r,i);case 3:return o.src=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"base64",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i){var o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(o=this.canvas(t,i)).toBlob){e.next=3;break}return e.abrupt("return",new Promise((function(e,t){o.toBlob((function(n){if(n){var r=new FileReader;r.onload=function(){return e(r.result)},r.onerror=t,r.readAsDataURL(n)}else t(new Error("ICanvas.toBlob failed!"))}),n,r)})));case 3:if(void 0===o.toDataURL){e.next=5;break}return e.abrupt("return",o.toDataURL(n,r));case 5:if(void 0===o.convertToBlob){e.next=10;break}return e.next=8,o.convertToBlob({type:n,quality:r});case 8:return a=e.sent,e.abrupt("return",new Promise((function(e,t){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=t,n.readAsDataURL(a)})));case 10:throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented");case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"canvas",value:function(t,n){var r=this._rawPixels(t,n),i=r.pixels,o=r.width,a=r.height,s=r.flipY,u=r.premultipliedAlpha;s&&e._flipY(i,o,a),u&&e._unpremultiplyAlpha(i);var c=new Ft(o,a,1),l=new ImageData(new Uint8ClampedArray(i.buffer),o,a);return c.context.putImageData(l,0,0),c.canvas}},{key:"pixels",value:function(t,n){var r=this._rawPixels(t,n),i=r.pixels,o=r.width,a=r.height,s=r.flipY,u=r.premultipliedAlpha;return s&&e._flipY(i,o,a),u&&e._unpremultiplyAlpha(i),i}},{key:"_rawPixels",value:function(e,t){var n,r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");var i,o,a=!1,s=!1,u=!1;e&&(e instanceof Sr?o=e:(o=r.generateTexture(e,{region:t,resolution:r.resolution,multisample:r.multisample}),u=!0,t&&(Rs.width=t.width,Rs.height=t.height,t=Rs)));var c,l=r.gl;if(o){if(i=o.baseTexture.resolution,t=null!==(c=t)&&void 0!==c?c:o.frame,a=!1,s=o.baseTexture.alphaMode>0&&o.baseTexture.format===F.RGBA,!u){r.renderTexture.bind(o);var h=o.framebuffer.glFramebuffers[r.CONTEXT_UID];h.blitFramebuffer&&r.framebuffer.bind(h.blitFramebuffer)}}else i=r.resolution,t||((t=Rs).width=r.width/i,t.height=r.height/i),a=!0,s=this._rendererPremultipliedAlpha,r.renderTexture.bind();var f=Math.max(Math.round(t.width*i),1),d=Math.max(Math.round(t.height*i),1),p=new Uint8Array(4*f*d);return l.readPixels(Math.round(t.x*i),Math.round(t.y*i),f,d,l.RGBA,l.UNSIGNED_BYTE,p),u&&null!==(n=o)&&void 0!==n&&n.destroy(!0),{pixels:p,width:f,height:d,flipY:a,premultipliedAlpha:s}}},{key:"destroy",value:function(){this.renderer=null}}],[{key:"_flipY",value:function(e,t,n){for(var r=t<<2,i=n>>1,o=new Uint8Array(r),a=0;a<i;a++){var s=a*r,u=(n-a-1)*r;o.set(e.subarray(s,s+r)),e.copyWithin(s,u,u+r),e.set(o,u)}}},{key:"_unpremultiplyAlpha",value:function(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));for(var t=e.length,n=0;n<t;n+=4){var r=e[n+3];if(0!==r){var i=255.001/r;e[n]=e[n]*i+.5,e[n+1]=e[n+1]*i+.5,e[n+2]=e[n+2]*i+.5}}}}]),e}();Bs.extension={name:"extract",type:Wt.RendererSystem};var Ds=Bs;Kt.add(Ds);var Ms={build:function(e){var t,n,r,i,o,a,s=e.points;if(e.type===_n.CIRC){var u=e.shape;t=u.x,n=u.y,o=a=u.radius,r=i=0}else if(e.type===_n.ELIP){var c=e.shape;t=c.x,n=c.y,o=c.width,a=c.height,r=i=0}else{var l=e.shape,h=l.width/2,f=l.height/2;t=l.x+h,n=l.y+f,r=h-(o=a=Math.max(0,Math.min(l.radius,Math.min(h,f)))),i=f-a}if(o>=0&&a>=0&&r>=0&&i>=0){var d=Math.ceil(2.3*Math.sqrt(o+a)),p=8*d+(r?4:0)+(i?4:0);if(s.length=p,0!==p){if(0===d)return s.length=8,s[0]=s[6]=t+r,s[1]=s[3]=n+i,s[2]=s[4]=t-r,void(s[5]=s[7]=n-i);var y=0,g=4*d+(r?2:0)+2,m=g,v=p,w=r+o,b=i,x=t+w,_=t-w,I=n+b;if(s[y++]=x,s[y++]=I,s[--g]=I,s[--g]=_,i){var A=n-b;s[m++]=_,s[m++]=A,s[--v]=A,s[--v]=x}for(var C=1;C<d;C++){var k=Math.PI/2*(C/d),S=r+Math.cos(k)*o,T=i+Math.sin(k)*a,E=t+S,O=t-S,P=n+T,R=n-T;s[y++]=E,s[y++]=P,s[--g]=P,s[--g]=O,s[m++]=O,s[m++]=R,s[--v]=R,s[--v]=E}var B=i+a,D=t+r,M=t-r,L=n+B,F=n-B;s[y++]=D,s[y++]=L,s[--v]=F,s[--v]=D,r&&(s[y++]=M,s[y++]=L,s[--v]=F,s[--v]=M)}}else s.length=0},triangulate:function(e,t){var n=e.points,r=t.points,i=t.indices;if(0!==n.length){var o,a,s=r.length/2,u=s;if(e.type!==_n.RREC){var c=e.shape;o=c.x,a=c.y}else{var l=e.shape;o=l.x+l.width/2,a=l.y+l.height/2}var h=e.matrix;r.push(e.matrix?h.a*o+h.c*a+h.tx:o,e.matrix?h.b*o+h.d*a+h.ty:a),s++,r.push(n[0],n[1]);for(var f=2;f<n.length;f+=2)r.push(n[f],n[f+1]),i.push(s++,u,s);i.push(u+1,u,s)}}};function Ls(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.length;if(!(n<6)){for(var r=0,i=0,o=e[n-2],a=e[n-1];i<n;i+=2){var s=e[i],u=e[i+1];r+=(s-o)*(u+a),o=s,a=u}if(!t&&r>0||t&&r<=0)for(var c=n/2,l=c+c%2;l<n;l+=2){var h,f,d=n-l-2,p=n-l-1,y=l,g=l+1;h=[e[y],e[d]],e[d]=h[0],e[y]=h[1],f=[e[g],e[p]],e[p]=f[0],e[g]=f[1]}}}var Fs={build:function(e){e.points=e.shape.points.slice()},triangulate:function(e,t){var n=e.points,r=e.holes,i=t.points,o=t.indices;if(n.length>=6){Ls(n,!1);for(var a=[],s=0;s<r.length;s++){var u=r[s];Ls(u.points,!0),a.push(n.length/2),n=n.concat(u.points)}var c=we(n,a,2);if(!c)return;for(var l=i.length/2,h=0;h<c.length;h+=3)o.push(c[h]+l),o.push(c[h+1]+l),o.push(c[h+2]+l);for(var f=0;f<n.length;f++)i.push(n[f])}}},Ns={build:function(e){var t=e.shape,n=t.x,r=t.y,i=t.width,o=t.height,a=e.points;a.length=0,i>=0&&o>=0&&a.push(n,r,n+i,r,n+i,r+o,n,r+o)},triangulate:function(e,t){var n=e.points,r=t.points;if(0!==n.length){var i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}}},Us={build:function(e){Ms.build(e)},triangulate:function(e,t){Ms.triangulate(e,t)}},js=function(e){return e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e}(js||{}),Gs=function(e){return e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e}(Gs||{}),zs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(!this.adaptive||!e||isNaN(e))return t;var n=Math.ceil(e/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},Hs=zs,Vs=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"curveTo",value:function(e,t,n,r,i,o){var a=o[o.length-2],s=o[o.length-1]-t,u=a-e,c=r-t,l=n-e,h=Math.abs(s*l-u*c);if(h<1e-8||0===i)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;var f=s*s+u*u,d=c*c+l*l,p=s*c+u*l,y=i*Math.sqrt(f)/h,g=i*Math.sqrt(d)/h,m=y*p/f,v=g*p/d,w=y*l+g*u,b=y*c+g*s,x=u*(g+m),_=s*(g+m),I=l*(y+v),A=c*(y+v);return{cx:w+e,cy:b+t,radius:i,startAngle:Math.atan2(_-b,x-w),endAngle:Math.atan2(A-b,I-w),anticlockwise:u*c>l*s}}},{key:"arc",value:function(e,t,n,r,i,o,a,s,u){for(var c=a-o,l=zs._segmentsCount(Math.abs(c)*i,40*Math.ceil(Math.abs(c)/wn)),h=c/(2*l),f=2*h,d=Math.cos(h),p=Math.sin(h),y=l-1,g=y%1/y,m=0;m<=y;++m){var v=h+o+f*(m+g*m),w=Math.cos(v),b=-Math.sin(v);u.push((d*w+p*b)*i+n,(d*-b+p*w)*i+r)}}}]),e}(),Ws=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"curveLength",value:function(e,t,n,r,i,o,a,s){for(var u=0,c=0,l=0,h=0,f=0,d=0,p=0,y=0,g=0,m=0,v=0,w=e,b=t,x=1;x<=10;++x)m=w-(y=(p=(d=(f=1-(c=x/10))*f)*f)*e+3*d*c*n+3*f*(l=c*c)*i+(h=l*c)*a),v=b-(g=p*t+3*d*c*r+3*f*l*o+h*s),w=y,b=g,u+=Math.sqrt(m*m+v*v);return u}},{key:"curveTo",value:function(t,n,r,i,o,a,s){var u=s[s.length-2],c=s[s.length-1];s.length-=2;var l=zs._segmentsCount(e.curveLength(u,c,t,n,r,i,o,a)),h=0,f=0,d=0,p=0,y=0;s.push(u,c);for(var g=1,m=0;g<=l;++g)d=(f=(h=1-(m=g/l))*h)*h,y=(p=m*m)*m,s.push(d*u+3*f*m*t+3*h*p*r+y*o,d*c+3*f*m*n+3*h*p*i+y*a)}}]),e}();function $s(e,t,n,r,i,o,a,s){var u,c;a?(u=r,c=-n):(u=-r,c=n);var l=e-n*i+u,h=t-r*i+c,f=e+n*o+u,d=t+r*o+c;return s.push(l,h,f,d),2}function Ys(e,t,n,r,i,o,a,s){var u=n-e,c=r-t,l=Math.atan2(u,c),h=Math.atan2(i-e,o-t);s&&l<h?l+=2*Math.PI:!s&&l>h&&(h+=2*Math.PI);var f=l,d=h-l,p=Math.abs(d),y=Math.sqrt(u*u+c*c),g=1+(15*p*Math.sqrt(y)/Math.PI|0),m=d/g;if(f+=m,s){a.push(e,t,n,r);for(var v=1,w=f;v<g;v++,w+=m)a.push(e,t,e+Math.sin(w)*y,t+Math.cos(w)*y);a.push(e,t,i,o)}else{a.push(n,r,e,t);for(var b=1,x=f;b<g;b++,x+=m)a.push(e+Math.sin(x)*y,t+Math.cos(x)*y,e,t);a.push(i,o,e,t)}return 2*g}function Ks(e,t){e.lineStyle.native?function(e,t){var n=0,r=e.shape,i=e.points||r.points,o=r.type!==_n.POLY||r.closeStroke;if(0!==i.length){var a=t.points,s=t.indices,u=i.length/2,c=a.length/2,l=c;for(a.push(i[0],i[1]),n=1;n<u;n++)a.push(i[2*n],i[2*n+1]),s.push(l,l+1),l++;o&&s.push(l,c)}}(e,t):function(e,t){var n=e.shape,r=e.points||n.points.slice(),i=t.closePointEps;if(0!==r.length){var o=e.lineStyle,a=new In(r[0],r[1]),s=new In(r[r.length-2],r[r.length-1]),u=n.type!==_n.POLY||n.closeStroke,c=Math.abs(a.x-s.x)<i&&Math.abs(a.y-s.y)<i;if(u){r=r.slice(),c&&(r.pop(),r.pop(),s.set(r[r.length-2],r[r.length-1]));var l=.5*(a.x+s.x),h=.5*(s.y+a.y);r.unshift(l,h),r.push(l,h)}var f=t.points,d=r.length/2,p=r.length,y=f.length/2,g=o.width/2,m=g*g,v=o.miterLimit*o.miterLimit,w=r[0],b=r[1],x=r[2],_=r[3],I=0,A=0,C=-(b-_),k=w-x,S=0,T=0,E=Math.sqrt(C*C+k*k);C/=E,k/=E,C*=g,k*=g;var O=o.alignment,P=2*(1-O),R=2*O;u||(o.cap===Gs.ROUND?p+=Ys(w-C*(P-R)*.5,b-k*(P-R)*.5,w-C*P,b-k*P,w+C*R,b+k*R,f,!0)+2:o.cap===Gs.SQUARE&&(p+=$s(w,b,C,k,P,R,!0,f))),f.push(w-C*P,b-k*P,w+C*R,b+k*R);for(var B=1;B<d-1;++B){w=r[2*(B-1)],b=r[2*(B-1)+1],x=r[2*B],_=r[2*B+1],I=r[2*(B+1)],A=r[2*(B+1)+1],C=-(b-_),k=w-x,C/=E=Math.sqrt(C*C+k*k),k/=E,C*=g,k*=g,S=-(_-A),T=x-I,S/=E=Math.sqrt(S*S+T*T),T/=E,S*=g,T*=g;var D=x-w,M=b-_,L=x-I,F=A-_,N=D*L+M*F,U=M*L-F*D,j=U<0;if(Math.abs(U)<.001*Math.abs(N))f.push(x-C*P,_-k*P,x+C*R,_+k*R),N>=0&&(o.join===js.ROUND?p+=Ys(x,_,x-C*P,_-k*P,x-S*P,_-T*P,f,!1)+4:p+=2,f.push(x-S*R,_-T*R,x+S*P,_+T*P));else{var G=(-C+w)*(-k+_)-(-C+x)*(-k+b),z=(-S+I)*(-T+_)-(-S+x)*(-T+A),H=(D*z-L*G)/U,V=(F*G-M*z)/U,W=(H-x)*(H-x)+(V-_)*(V-_),$=x+(H-x)*P,Y=_+(V-_)*P,K=x-(H-x)*R,X=_-(V-_)*R,Z=j?P:R,q=W<=Math.min(D*D+M*M,L*L+F*F)+Z*Z*m,J=o.join;if(J===js.MITER&&W/m>v&&(J=js.BEVEL),q)switch(J){case js.MITER:f.push($,Y,K,X);break;case js.BEVEL:j?f.push($,Y,x+C*R,_+k*R,$,Y,x+S*R,_+T*R):f.push(x-C*P,_-k*P,K,X,x-S*P,_-T*P,K,X),p+=2;break;case js.ROUND:j?(f.push($,Y,x+C*R,_+k*R),p+=Ys(x,_,x+C*R,_+k*R,x+S*R,_+T*R,f,!0)+4,f.push($,Y,x+S*R,_+T*R)):(f.push(x-C*P,_-k*P,K,X),p+=Ys(x,_,x-C*P,_-k*P,x-S*P,_-T*P,f,!1)+4,f.push(x-S*P,_-T*P,K,X))}else{switch(f.push(x-C*P,_-k*P,x+C*R,_+k*R),J){case js.MITER:j?f.push(K,X,K,X):f.push($,Y,$,Y),p+=2;break;case js.ROUND:p+=j?Ys(x,_,x+C*R,_+k*R,x+S*R,_+T*R,f,!0)+2:Ys(x,_,x-C*P,_-k*P,x-S*P,_-T*P,f,!1)+2}f.push(x-S*P,_-T*P,x+S*R,_+T*R),p+=2}}}w=r[2*(d-2)],b=r[2*(d-2)+1],x=r[2*(d-1)],C=-(b-(_=r[2*(d-1)+1])),k=w-x,C/=E=Math.sqrt(C*C+k*k),k/=E,C*=g,k*=g,f.push(x-C*P,_-k*P,x+C*R,_+k*R),u||(o.cap===Gs.ROUND?p+=Ys(x-C*(P-R)*.5,_-k*(P-R)*.5,x-C*P,_-k*P,x+C*R,_+k*R,f,!1)+2:o.cap===Gs.SQUARE&&(p+=$s(x,_,C,k,P,R,!1,f)));for(var Q=t.indices,ee=zs.epsilon*zs.epsilon,te=y;te<p+y-2;++te)w=f[2*te],b=f[2*te+1],x=f[2*(te+1)],_=f[2*(te+1)+1],I=f[2*(te+2)],A=f[2*(te+2)+1],!(Math.abs(w*(_-A)+x*(A-b)+I*(b-_))<ee)&&Q.push(te,te+1,te+2)}}(e,t)}var Xs=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"curveLength",value:function(e,t,n,r,i,o){var a=e-2*n+i,s=t-2*r+o,u=2*n-2*e,c=2*r-2*t,l=4*(a*a+s*s),h=4*(a*u+s*c),f=u*u+c*c,d=2*Math.sqrt(l+h+f),p=Math.sqrt(l),y=2*l*p,g=2*Math.sqrt(f),m=h/p;return(y*d+p*h*(d-g)+(4*f*l-h*h)*Math.log((2*p+m+d)/(m+g)))/(4*y)}},{key:"curveTo",value:function(t,n,r,i,o){for(var a=o[o.length-2],s=o[o.length-1],u=zs._segmentsCount(e.curveLength(a,s,t,n,r,i)),c=0,l=0,h=1;h<=u;++h){var f=h/u;c=a+(t-a)*f,l=s+(n-s)*f,o.push(c+(t+(r-t)*f-c)*f,l+(n+(i-n)*f-l)*f)}}}]),e}(),Zs=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_n.POLY,Fs),_n.CIRC,Ms),_n.ELIP,Ms),_n.RECT,Ns),_n.RREC,Us),qs=[],Js=[],Qs=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=n,this.matrix=i,this.type=t.type}return _createClass(e,[{key:"clone",value:function(){return new e(this.shape,this.fillStyle,this.lineStyle,this.matrix)}},{key:"destroy",value:function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}]),e}(),eu=function(){function e(){_classCallCheck(this,e),this.reset()}return _createClass(e,[{key:"begin",value:function(e,t,n){this.reset(),this.style=e,this.start=t,this.attribStart=n}},{key:"end",value:function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}},{key:"reset",value:function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}]),e}(),tu=new In,nu=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new ao,e.boundsDirty=-1,e}return _inherits(t,e),_createClass(t,[{key:"bounds",get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}},{key:"invalidate",value:function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Js.push(this.drawCalls[e]);this.drawCalls.length=0;for(var t=0;t<this.batches.length;t++){var n=this.batches[t];n.reset(),qs.push(n)}this.batches.length=0}},{key:"clear",value:function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}},{key:"drawShape",value:function(e){var t=new Qs(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);return this.graphicsData.push(t),this.dirty++,this}},{key:"drawHole",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.graphicsData.length)return null;var n=new Qs(e,null,null,t),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this}},{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}},{key:"containsPoint",value:function(e){for(var t=this.graphicsData,n=0;n<t.length;++n){var r=t[n];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,tu):tu.copyFrom(e),r.shape.contains(tu.x,tu.y))){var i=!1;if(r.holes)for(var o=0;o<r.holes.length;o++)if(r.holes[o].shape.contains(tu.x,tu.y)){i=!0;break}if(!i)return!0}}return!1}},{key:"updateBatches",value:function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,t=this.graphicsData,n=null,r=null;this.batches.length>0&&(r=(n=this.batches[this.batches.length-1]).style);for(var i=this.shapeIndex;i<t.length;i++){this.shapeIndex++;var o=t[i],a=o.fillStyle,s=o.lineStyle;Zs[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(a.visible||s.visible)&&this.processHoles(o.holes);for(var u=0;u<2;u++){var c=0===u?a:s;if(c.visible){var l=c.texture.baseTexture,h=this.indices.length,f=this.points.length/2;l.wrapMode=z.REPEAT,0===u?this.processFill(o):this.processLine(o);var d=this.points.length/2-f;0!==d&&(n&&!this._compareStyles(r,c)&&(n.end(h,f),n=null),n||((n=qs.pop()||new eu).begin(c,h,f),this.batches.push(n),r=c),this.addUvs(this.points,e,c.texture,f,d,c.matrix))}}}var p=this.indices.length,y=this.points.length/2;if(n&&n.end(p,y),0!==this.batches.length){var g=y>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&g===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=g?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0}},{key:"_compareStyles",value:function(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}},{key:"validateBatching",value:function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,t=this.graphicsData.length;e<t;e++){var n=this.graphicsData[e],r=n.fillStyle,i=n.lineStyle;if(r&&!r.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}},{key:"packBatches",value:function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,t=0,n=e.length;t<n;t++)for(var r=e[t],i=0;i<r.size;i++){var o=r.start+i;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}}},{key:"isBatchable",value:function(){if(this.points.length>131070)return!1;for(var e=this.batches,n=0;n<e.length;n++)if(e[n].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE}},{key:"buildDrawCalls",value:function(){for(var e=++un._globalBatch,t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Js.push(this.drawCalls[t]);this.drawCalls.length=0;var n=this.colors,r=this.textureIds,i=Js.pop();i||((i=new cn).texArray=new cr),i.texArray.count=0,i.start=0,i.size=0,i.type=L.TRIANGLES;var o=0,a=null,s=0,u=!1,c=L.TRIANGLES,l=0;this.drawCalls.push(i);for(var h=0;h<this.batches.length;h++){var f=this.batches[h],d=f.style,p=d.texture.baseTexture;u!==!!d.native&&(c=(u=!!d.native)?L.LINES:L.TRIANGLES,a=null,o=8,e++),a!==p&&(a=p,p._batchEnabled!==e&&(8===o&&(e++,o=0,i.size>0&&((i=Js.pop())||((i=new cn).texArray=new cr),this.drawCalls.push(i)),i.start=l,i.size=0,i.texArray.count=0,i.type=c),p.touched=1,p._batchEnabled=e,p._batchLocation=o,p.wrapMode=z.REPEAT,i.texArray.elements[i.texArray.count++]=p,o++)),i.size+=f.size,l+=f.size,s=p._batchLocation,this.addColors(n,d.color,d.alpha,f.attribSize,f.attribStart),this.addTextureIds(r,s,f.attribSize,f.attribStart)}un._globalBatch=e,this.packAttributes()}},{key:"packAttributes",value:function(){for(var e=this.points,t=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*e.length*4),o=new Float32Array(i),a=new Uint32Array(i),s=0,u=0;u<e.length/2;u++)o[s++]=e[2*u],o[s++]=e[2*u+1],o[s++]=t[2*u],o[s++]=t[2*u+1],a[s++]=n[u],o[s++]=r[u];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}},{key:"processFill",value:function(e){e.holes.length?Fs.triangulate(e,this):Zs[e.type].triangulate(e,this)}},{key:"processLine",value:function(e){Ks(e,this);for(var t=0;t<e.holes.length;t++)Ks(e.holes[t],this)}},{key:"processHoles",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];Zs[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}},{key:"calculateBounds",value:function(){var e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}},{key:"transformPoints",value:function(e,t){for(var n=0;n<e.length/2;n++){var r=e[2*n],i=e[2*n+1];e[2*n]=t.a*r+t.c*i+t.tx,e[2*n+1]=t.b*r+t.d*i+t.ty}}},{key:"addColors",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=ut.shared.setValue(t).toLittleEndianNumber(),a=ut.shared.setValue(o).toPremultiplied(n);e.length=Math.max(e.length,i+r);for(var s=0;s<r;s++)e[i+s]=a}},{key:"addTextureIds",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.length=Math.max(e.length,r+n);for(var i=0;i<n;i++)e[r+i]=t}},{key:"addUvs",value:function(e,t,n,r,i){for(var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=0,s=t.length,u=n.frame;a<i;){var c=e[2*(r+a)],l=e[2*(r+a)+1];if(o){var h=o.a*c+o.c*l+o.tx;l=o.b*c+o.d*l+o.ty,c=h}a++,t.push(c/u.width,l/u.height)}var f=n.baseTexture;(u.width<f.width||u.height<f.height)&&this.adjustUvs(t,n,s,i)}},{key:"adjustUvs",value:function(e,t,n,r){for(var i=t.baseTexture,o=1e-6,a=n+2*r,s=t.frame,u=s.width/i.width,c=s.height/i.height,l=s.x/s.width,h=s.y/s.height,f=Math.floor(e[n]+o),d=Math.floor(e[n+1]+o),p=n+2;p<a;p+=2)f=Math.min(f,Math.floor(e[p]+o)),d=Math.min(d,Math.floor(e[p+1]+o));l-=f,h-=d;for(var y=n;y<a;y+=2)e[y]=(e[y]+l)*u,e[y+1]=(e[y+1]+h)*c}}]),t}(vn);nu.BATCHABLE_SIZE=100;var ru=nu,iu=function(){function e(){_classCallCheck(this,e),this.color=16777215,this.alpha=1,this.texture=kr.WHITE,this.matrix=null,this.visible=!1,this.reset()}return _createClass(e,[{key:"clone",value:function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}},{key:"reset",value:function(){this.color=16777215,this.alpha=1,this.texture=kr.WHITE,this.matrix=null,this.visible=!1}},{key:"destroy",value:function(){this.texture=null,this.matrix=null}}]),e}(),ou=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).width=0,e.alignment=.5,e.native=!1,e.cap=Gs.BUTT,e.join=js.MITER,e.miterLimit=10,e}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}},{key:"reset",value:function(){_get(_getPrototypeOf(t.prototype),"reset",this).call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Gs.BUTT,this.join=js.MITER,this.miterLimit=10}}]),t}(iu),au={},su=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return _classCallCheck(this,t),(e=_callSuper(this,t)).shader=null,e.pluginName="batch",e.currentPath=null,e.batches=[],e.batchTint=-1,e.batchDirty=-1,e.vertexData=null,e._fillStyle=new iu,e._lineStyle=new ou,e._matrix=null,e._holeMode=!1,e.state=Qt.for2d(),e._geometry=n||new ru,e._geometry.refCount++,e._transformID=-1,e._tintColor=new ut(16777215),e.blendMode=M.NORMAL,e}return _inherits(t,e),_createClass(t,[{key:"geometry",get:function(){return this._geometry}},{key:"clone",value:function(){return this.finishPoly(),new t(this._geometry)}},{key:"blendMode",get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e}},{key:"tint",get:function(){return this._tintColor.value},set:function(e){this._tintColor.setValue(e)}},{key:"fill",get:function(){return this._fillStyle}},{key:"line",get:function(){return this._lineStyle}},{key:"lineStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return"number"==typeof e&&(e={width:e,color:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,alpha:arguments.length>2?arguments[2]:void 0,alignment:arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,native:arguments.length>4&&void 0!==arguments[4]&&arguments[4]}),this.lineTextureStyle(e)}},{key:"lineTextureStyle",value:function(e){var t,n={width:0,texture:kr.WHITE,color:null!==(t=e)&&void 0!==t&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Gs.BUTT,join:js.MITER,miterLimit:10};e=Object.assign(n,e),this.normalizeColor(e),this.currentPath&&this.startPoly();var r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}},{key:"startPoly",value:function(){if(this.currentPath){var e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Tn,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Tn,this.currentPath.closeStroke=!1}},{key:"finishPoly",value:function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}},{key:"moveTo",value:function(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}},{key:"lineTo",value:function(e,t){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return(r!==e||i!==t)&&n.push(e,t),this}},{key:"_initCurve",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}},{key:"quadraticCurveTo",value:function(e,t,n,r){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),Xs.curveTo(e,t,n,r,i),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,o){return this._initCurve(),Ws.curveTo(e,t,n,r,i,o,this.currentPath.points),this}},{key:"arcTo",value:function(e,t,n,r,i){this._initCurve(e,t);var o=this.currentPath.points,a=Vs.curveTo(e,t,n,r,i,o);if(a){var s=a.cx,u=a.cy,c=a.radius,l=a.startAngle,h=a.endAngle,f=a.anticlockwise;this.arc(s,u,c,l,h,f)}return this}},{key:"arc",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(r===i)return this;if(!o&&i<=r?i+=wn:o&&r<=i&&(r+=wn),i-r==0)return this;var a=e+Math.cos(r)*n,s=t+Math.sin(r)*n,u=this._geometry.closePointEps,c=this.currentPath?this.currentPath.points:null;if(c){var l=Math.abs(c[c.length-2]-a),h=Math.abs(c[c.length-1]-s);l<u&&h<u||c.push(a,s)}else this.moveTo(a,s),c=this.currentPath.points;return Vs.arc(a,s,e,t,n,r,i,o,c),this}},{key:"beginFill",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return this.beginTextureFill({texture:kr.WHITE,color:e,alpha:t})}},{key:"normalizeColor",value:function(e){var t,n,r=ut.shared.setValue(null!==(t=e.color)&&void 0!==t?t:0);e.color=r.toNumber(),null!==(n=e.alpha)&&void 0!==n||(e.alpha=r.alpha)}},{key:"beginTextureFill",value:function(e){var t={texture:kr.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();var n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}},{key:"endFill",value:function(){return this.finishPoly(),this._fillStyle.reset(),this}},{key:"drawRect",value:function(e,t,n,r){return this.drawShape(new Cn(e,t,n,r))}},{key:"drawRoundedRect",value:function(e,t,n,r,i){return this.drawShape(new En(e,t,n,r,i))}},{key:"drawCircle",value:function(e,t,n){return this.drawShape(new kn(e,t,n))}},{key:"drawEllipse",value:function(e,t,n,r){return this.drawShape(new Sn(e,t,n,r))}},{key:"drawPolygon",value:function(){for(var e,t=!0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r[0];o.points?(t=o.closeStroke,e=o.points):e=Array.isArray(r[0])?r[0]:r;var a=new Tn(e);return a.closeStroke=t,this.drawShape(a),this}},{key:"drawShape",value:function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}},{key:"clear",value:function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}},{key:"isFastRect",value:function(){var e=this._geometry.graphicsData;return!(1!==e.length||e[0].shape.type!==_n.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)}},{key:"_render",value:function(e){this.finishPoly();var t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}},{key:"_populateBatches",value:function(){var e=this._geometry,t=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(var r=0;r<n;r++){var i=e.batches[r],o=i.style.color,a=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),s=new Float32Array(e.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),u={vertexData:a,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,2*i.start,i.size),uvs:s,_batchRGB:ut.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=u}}},{key:"_renderBatched",value:function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var t=0,n=this.batches.length;t<n;t++){var r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}},{key:"_renderDirect",value:function(e){var t=this._resolveDirectShader(e),n=this._geometry,r=this.worldAlpha,i=t.uniforms,o=n.drawCalls;i.translationMatrix=this.transform.worldTransform,ut.shared.setValue(this._tintColor).premultiply(r).toArray(i.tint),e.shader.bind(t),e.geometry.bind(n,t),e.state.set(this.state);for(var a=0,s=o.length;a<s;a++)this._renderDrawCallDirect(e,n.drawCalls[a])}},{key:"_renderDrawCallDirect",value:function(e,t){for(var n=t.texArray,r=t.type,i=t.size,o=t.start,a=n.count,s=0;s<a;s++)e.texture.bind(n.elements[s],s);e.geometry.draw(r,i,o)}},{key:"_resolveDirectShader",value:function(e){var t=this.shader,n=this.pluginName;if(!t){if(!au[n]){for(var r=e.plugins[n].maxTextures,i=new Int32Array(r),o=0;o<r;o++)i[o]=o;var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new On,default:ar.from({uSamplers:i},!0)},s=e.plugins[n]._shader.program;au[n]=new sr(s,a)}t=au[n]}return t}},{key:"_calculateBounds",value:function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var t=e.bounds,n=t.minX,r=t.minY,i=t.maxX,o=t.maxY;this._bounds.addFrame(this.transform,n,r,i,o)}}},{key:"containsPoint",value:function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)}},{key:"calculateTints",value:function(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(var e=0;e<this.batches.length;e++){var t=this.batches[e];t._tintRGB=ut.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}},{key:"calculateVertices",value:function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var t=this.transform.worldTransform,n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,u=this._geometry.points,c=this.vertexData,l=0,h=0;h<u.length;h+=2){var f=u[h],d=u[h+1];c[l++]=n*f+i*d+a,c[l++]=o*d+r*f+s}}}},{key:"closePath",value:function(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}},{key:"setMatrix",value:function(e){return this._matrix=e,this}},{key:"beginHole",value:function(){return this.finishPoly(),this._holeMode=!0,this}},{key:"endHole",value:function(){return this.finishPoly(),this._holeMode=!1,this}},{key:"destroy",value:function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e)}}]),t}(fo);su.curves=zs,su._TEMP_POINT=new In;var uu=su,cu={buildPoly:Fs,buildCircle:Ms,buildRectangle:Ns,buildRoundedRectangle:Us,buildLine:Ks,ArcUtils:Vs,BezierUtils:Ws,QuadraticUtils:Xs,BatchPart:eu,FILL_COMMANDS:Zs,BATCH_POOL:qs,DRAW_CALL_POOL:Js},lu=function(){function e(t,n){_classCallCheck(this,e),this.uvBuffer=t,this.uvMatrix=n,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return _createClass(e,[{key:"update",value:function(e){if(e||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}}]),e}(),hu=new In,fu=new Tn,du=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L.TRIANGLES;return _classCallCheck(this,t),(i=_callSuper(this,t)).geometry=e,i.shader=n,i.state=r||Qt.for2d(),i.drawMode=o,i.start=0,i.size=0,i.uvs=null,i.indices=null,i.vertexData=new Float32Array(1),i.vertexDirty=-1,i._transformID=-1,i._roundPixels=Q.ROUND_PIXELS,i.batchUvs=null,i}return _inherits(t,e),_createClass(t,[{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}},{key:"uvBuffer",get:function(){return this.geometry.buffers[1]}},{key:"verticesBuffer",get:function(){return this.geometry.buffers[0]}},{key:"material",get:function(){return this.shader},set:function(e){this.shader=e}},{key:"blendMode",get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e}},{key:"roundPixels",get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}},{key:"tint",get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(e){this.shader.tint=e}},{key:"tintValue",get:function(){return this.shader.tintValue}},{key:"texture",get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(e){this.shader.texture=e}},{key:"_render",value:function(e){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===L.TRIANGLES&&n.length<2*t.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)}},{key:"_renderDefault",value:function(e){var t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}},{key:"_renderToBatch",value:function(e){var t=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;var r=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[r]),e.plugins[r].render(this)}},{key:"calculateVertices",value:function(){var e=this.geometry.buffers[0],t=e.data,n=e._updateID;if(n!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));for(var r=this.transform.worldTransform,i=r.a,o=r.b,a=r.c,s=r.d,u=r.tx,c=r.ty,l=this.vertexData,h=0;h<l.length/2;h++){var f=t[2*h],d=t[2*h+1];l[2*h]=i*f+a*d+u,l[2*h+1]=o*f+s*d+c}if(this._roundPixels)for(var p=Q.RESOLUTION,y=0;y<l.length;++y)l[y]=Math.round(l[y]*p)/p;this.vertexDirty=n}}},{key:"calculateUvs",value:function(){var e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new lu(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}},{key:"_calculateBounds",value:function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}},{key:"containsPoint",value:function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,hu);for(var t=this.geometry.getBuffer("aVertexPosition").data,n=fu.points,r=this.geometry.getIndex().data,i=r.length,o=4===this.drawMode?3:1,a=0;a+2<i;a+=o){var s=2*r[a],u=2*r[a+1],c=2*r[a+2];if(n[0]=t[s],n[1]=t[s+1],n[2]=t[u],n[3]=t[u+1],n[4]=t[c],n[5]=t[c+1],fu.contains(hu.x,hu.y))return!0}return!1}},{key:"destroy",value:function(e){_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}}]),t}(fo);du.BATCHABLE_SIZE=100;var pu=du,yu=function(e){function t(e,n,r){var i;_classCallCheck(this,t),i=_callSuper(this,t);var o=new hn(e),a=new hn(n,!0),s=new hn(r,!0,!0);return i.addAttribute("aVertexPosition",o,2,!1,U.FLOAT).addAttribute("aTextureCoord",a,2,!1,U.FLOAT).addIndex(s),i._updateId=-1,i}return _inherits(t,e),_createClass(t,[{key:"vertexDirtyId",get:function(){return this.buffers[0]._updateID}}]),t}(mn),gu=function(e){function t(e,n){var r;_classCallCheck(this,t);var i={uSampler:e,alpha:1,uTextureMatrix:On.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(i,n.uniforms),(r=_callSuper(this,t,[n.program||ir.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i]))._colorDirty=!1,r.uvMatrix=new Gr(e),r.batchable=void 0===n.program,r.pluginName=n.pluginName,r._tintColor=new ut(n.tint),r._tintRGB=r._tintColor.toLittleEndianNumber(),r._colorDirty=!0,r.alpha=n.alpha,r}return _inherits(t,e),_createClass(t,[{key:"texture",get:function(){return this.uniforms.uSampler},set:function(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}},{key:"alpha",get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}},{key:"tint",get:function(){return this._tintColor.value},set:function(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}},{key:"tintValue",get:function(){return this._tintColor.toNumber()}},{key:"update",value:function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture.alphaMode;ut.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}]),t}(sr),mu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return _classCallCheck(this,t),(e=_callSuper(this,t)).segWidth=i,e.segHeight=o,e.width=n,e.height=r,e.build(),e}return _inherits(t,e),_createClass(t,[{key:"build",value:function(){for(var e=this.segWidth*this.segHeight,t=[],n=[],r=[],i=this.segWidth-1,o=this.segHeight-1,a=this.width/i,s=this.height/o,u=0;u<e;u++){var c=u%this.segWidth,l=u/this.segWidth|0;t.push(c*a,l*s),n.push(c/i,l/o)}for(var h=i*o,f=0;f<h;f++){var d=f%i,p=f/i|0,y=p*this.segWidth+d,g=p*this.segWidth+d+1,m=(p+1)*this.segWidth+d,v=(p+1)*this.segWidth+d+1;r.push(y,g,m,g,v,m)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}]),t}(yu),vu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _classCallCheck(this,t),(e=_callSuper(this,t,[new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1))])).points=r,e._width=n,e.textureScale=i,e.build(),e}return _inherits(t,e),_createClass(t,[{key:"width",get:function(){return this._width}},{key:"build",value:function(){var e=this.points;if(e){var t=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(e.length<1)){t.data.length/4!==e.length&&(t.data=new Float32Array(4*e.length),n.data=new Float32Array(4*e.length),r.data=new Uint16Array(6*(e.length-1)));var i=n.data,o=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var a=0,s=e[0],u=this._width*this.textureScale,c=e.length,l=0;l<c;l++){var h=4*l;if(this.textureScale>0){var f=s.x-e[l].x,d=s.y-e[l].y,p=Math.sqrt(f*f+d*d);s=e[l],a+=p/u}else a=l/(c-1);i[h]=a,i[h+1]=0,i[h+2]=a,i[h+3]=1}for(var y=0,g=0;g<c-1;g++){var m=2*g;o[y++]=m,o[y++]=m+1,o[y++]=m+2,o[y++]=m+2,o[y++]=m+1,o[y++]=m+3}n.update(),r.update(),this.updateVertices()}}}},{key:"updateVertices",value:function(){var e=this.points;if(!(e.length<1)){for(var t,n=e[0],r=0,i=0,o=this.buffers[0].data,a=e.length,s=this.textureScale>0?this.textureScale*this._width/2:this._width/2,u=0;u<a;u++){var c=e[u],l=4*u;i=-((t=u<e.length-1?e[u+1]:c).x-n.x),r=t.y-n.y;var h=10*(1-u/(a-1));h>1&&(h=1);var f=Math.sqrt(r*r+i*i);f<1e-6?(r=0,i=0):(r/=f,i/=f,r*=s,i*=s),o[l]=c.x+r,o[l+1]=c.y+i,o[l+2]=c.x-r,o[l+3]=c.y-i,n=c}this.buffers[0].update()}}},{key:"update",value:function(){this.textureScale>0?this.build():this.updateVertices()}}]),t}(yu),wu=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[new mu(e.width,e.height,n,r),new gu(kr.WHITE)])).texture=e,i.autoResize=!0,i}return _inherits(t,e),_createClass(t,[{key:"textureUpdated",value:function(){this._textureID=this.shader.texture._updateID;var e=this.geometry,t=this.shader.texture,n=t.width,r=t.height;this.autoResize&&(e.width!==n||e.height!==r)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())}},{key:"texture",get:function(){return this.shader.texture},set:function(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))}},{key:"_render",value:function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),_get(_getPrototypeOf(t.prototype),"_render",this).call(this,e)}},{key:"destroy",value:function(e){this.shader.texture.off("update",this.textureUpdated,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e)}}]),t}(pu),bu=function(e){function t(e,n,r,i,o){var a,s,u,c,l,h,f,d,p;return _classCallCheck(this,t),(p=_callSuper(this,t,[kr.WHITE,4,4]))._origWidth=e.orig.width,p._origHeight=e.orig.height,p._width=p._origWidth,p._height=p._origHeight,p._leftWidth=null!==(a=null!==n&&void 0!==n?n:null===(s=e.defaultBorders)||void 0===s?void 0:s.left)&&void 0!==a?a:10,p._rightWidth=null!==(u=null!==i&&void 0!==i?i:null===(c=e.defaultBorders)||void 0===c?void 0:c.right)&&void 0!==u?u:10,p._topHeight=null!==(l=null!==r&&void 0!==r?r:null===(h=e.defaultBorders)||void 0===h?void 0:h.top)&&void 0!==l?l:10,p._bottomHeight=null!==(f=null!==o&&void 0!==o?o:null===(d=e.defaultBorders)||void 0===d?void 0:d.bottom)&&void 0!==f?f:10,p.texture=e,p}return _inherits(t,e),_createClass(t,[{key:"textureUpdated",value:function(){this._textureID=this.shader.texture._updateID,this._refresh()}},{key:"vertices",get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e}},{key:"updateHorizontalVertices",value:function(){var e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height}},{key:"updateVerticalVertices",value:function(){var e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width}},{key:"_getMinScale",value:function(){var e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,n=this._topHeight+this._bottomHeight,r=this._height>n?1:this._height/n;return Math.min(t,r)}},{key:"width",get:function(){return this._width},set:function(e){this._width=e,this._refresh()}},{key:"height",get:function(){return this._height},set:function(e){this._height=e,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()}},{key:"_refresh",value:function(){var e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var n=1/this._origWidth,r=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=n*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-n*this._rightWidth,t[9]=t[11]=t[13]=t[15]=r*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}]),t}(wu),xu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kr.EMPTY,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;_classCallCheck(this,t);var s=new yu(r,i,o);return s.getBuffer("aVertexPosition").static=!1,(e=_callSuper(this,t,[s,new gu(n),null,a])).autoUpdate=!0,e}return _inherits(t,e),_createClass(t,[{key:"vertices",get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e}},{key:"_render",value:function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),_get(_getPrototypeOf(t.prototype),"_render",this).call(this,e)}}]),t}(pu),_u=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,t);var o=new vu(e.height,n,i),a=new gu(e);return i>0&&(e.baseTexture.wrapMode=z.REPEAT),(r=_callSuper(this,t,[o,a])).autoUpdate=!0,r}return _inherits(t,e),_createClass(t,[{key:"_render",value:function(e){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),_get(_getPrototypeOf(t.prototype),"_render",this).call(this,e)}}]),t}(pu),Iu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return _classCallCheck(this,t),i>16384&&(i=16384),(e=_callSuper(this,t))._properties=[!1,!0,!1,!1,!1],e._maxSize=n,e._batchSize=i,e._buffers=null,e._bufferUpdateIDs=[],e._updateID=0,e.interactiveChildren=!1,e.blendMode=M.NORMAL,e.autoResize=o,e.roundPixels=!0,e.baseTexture=null,e.setProperties(r),e._tintColor=new ut(0),e.tintRgb=new Float32Array(3),e.tint=16777215,e}return _inherits(t,e),_createClass(t,[{key:"setProperties",value:function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])}},{key:"updateTransform",value:function(){this.displayObjectUpdateTransform()}},{key:"tint",get:function(){return this._tintColor.value},set:function(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb)}},{key:"render",value:function(e){var t=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return t.onChildrenChange(0)}))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))}},{key:"onChildrenChange",value:function(e){for(var t=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID}},{key:"dispose",value:function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}}},{key:"destroy",value:function(e){_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}]),t}(fo),Au=function(){function e(t,n,r){_classCallCheck(this,e),this.geometry=new mn,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var o=t[i];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||U.FLOAT,offset:o.offset},n[i]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return _createClass(e,[{key:"initBuffers",value:function(){var e=this.geometry,t=0;this.indexBuffer=new hn(wt(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){var r=this.dynamicProperties[n];r.offset=t,t+=r.size,this.dynamicStride+=r.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new hn(this.dynamicData,!1,!1);var o=0;this.staticStride=0;for(var a=0;a<this.staticProperties.length;++a){var s=this.staticProperties[a];s.offset=o,o+=s.size,this.staticStride+=s.size}var u=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(u),this.staticDataUint32=new Uint32Array(u),this.staticBuffer=new hn(this.staticData,!0,!1);for(var c=0;c<this.dynamicProperties.length;++c){var l=this.dynamicProperties[c];e.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===U.UNSIGNED_BYTE,l.type,4*this.dynamicStride,4*l.offset)}for(var h=0;h<this.staticProperties.length;++h){var f=this.staticProperties[h];e.addAttribute(f.attributeName,this.staticBuffer,0,f.type===U.UNSIGNED_BYTE,f.type,4*this.staticStride,4*f.offset)}}},{key:"uploadDynamic",value:function(e,t,n){for(var r=0;r<this.dynamicProperties.length;r++){var i=this.dynamicProperties[r];i.uploadFunction(e,t,n,i.type===U.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++}},{key:"uploadStatic",value:function(e,t,n){for(var r=0;r<this.staticProperties.length;r++){var i=this.staticProperties[r];i.uploadFunction(e,t,n,i.type===U.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++}},{key:"destroy",value:function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}]),e}(),Cu=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).shader=null,n.properties=null,n.tempMatrix=new On,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:U.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=sr.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),n.state=Qt.for2d(),n}return _inherits(t,e),_createClass(t,[{key:"render",value:function(e){var t=e.children,n=e._maxSize,r=e._batchSize,i=this.renderer,o=t.length;if(0!==o){o>n&&!e.autoResize&&(o=n);var a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));var s=t[0]._texture.baseTexture,u=s.alphaMode>0;this.state.blendMode=pt(e.blendMode,u),i.state.set(this.state);var c=i.gl,l=e.worldTransform.copyTo(this.tempMatrix);l.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=ut.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var h=!1,f=0,d=0;f<o;f+=r,d+=1){var p=o-f;p>r&&(p=r),d>=a.length&&a.push(this._generateOneMoreBuffer(e));var y=a[d];y.uploadDynamic(t,f,p);var g=e._bufferUpdateIDs[d]||0;(h=h||y._updateID<g)&&(y._updateID=e._updateID,y.uploadStatic(t,f,p)),i.geometry.bind(y.geometry),c.drawElements(c.TRIANGLES,6*p,c.UNSIGNED_SHORT,0)}}}},{key:"generateBuffers",value:function(e){for(var t=[],n=e._maxSize,r=e._batchSize,i=e._properties,o=0;o<n;o+=r)t.push(new Au(this.properties,i,r));return t}},{key:"_generateOneMoreBuffer",value:function(e){var t=e._batchSize,n=e._properties;return new Au(this.properties,n,t)}},{key:"uploadVertices",value:function(e,t,n,r,i,o){for(var a=0,s=0,u=0,c=0,l=0;l<n;++l){var h=e[t+l],f=h._texture,d=h.scale.x,p=h.scale.y,y=f.trim,g=f.orig;y?(a=(s=y.x-h.anchor.x*g.width)+y.width,u=(c=y.y-h.anchor.y*g.height)+y.height):(a=g.width*(1-h.anchor.x),s=g.width*-h.anchor.x,u=g.height*(1-h.anchor.y),c=g.height*-h.anchor.y),r[o]=s*d,r[o+1]=c*p,r[o+i]=a*d,r[o+i+1]=c*p,r[o+2*i]=a*d,r[o+2*i+1]=u*p,r[o+3*i]=s*d,r[o+3*i+1]=u*p,o+=4*i}}},{key:"uploadPosition",value:function(e,t,n,r,i,o){for(var a=0;a<n;a++){var s=e[t+a].position;r[o]=s.x,r[o+1]=s.y,r[o+i]=s.x,r[o+i+1]=s.y,r[o+2*i]=s.x,r[o+2*i+1]=s.y,r[o+3*i]=s.x,r[o+3*i+1]=s.y,o+=4*i}}},{key:"uploadRotation",value:function(e,t,n,r,i,o){for(var a=0;a<n;a++){var s=e[t+a].rotation;r[o]=s,r[o+i]=s,r[o+2*i]=s,r[o+3*i]=s,o+=4*i}}},{key:"uploadUvs",value:function(e,t,n,r,i,o){for(var a=0;a<n;++a){var s=e[t+a]._texture._uvs;s?(r[o]=s.x0,r[o+1]=s.y0,r[o+i]=s.x1,r[o+i+1]=s.y1,r[o+2*i]=s.x2,r[o+2*i+1]=s.y2,r[o+3*i]=s.x3,r[o+3*i+1]=s.y3,o+=4*i):(r[o]=0,r[o+1]=0,r[o+i]=0,r[o+i+1]=0,r[o+2*i]=0,r[o+2*i+1]=0,r[o+3*i]=0,r[o+3*i+1]=0,o+=4*i)}}},{key:"uploadTint",value:function(e,t,n,r,i,o){for(var a=0;a<n;++a){var s=e[t+a],u=ut.shared.setValue(s._tintRGB).toPremultiplied(s.alpha,s.texture.baseTexture.alphaMode>0);r[o]=u,r[o+i]=u,r[o+2*i]=u,r[o+3*i]=u,o+=4*i}}},{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}]),t}(lr);Cu.extension={name:"particle",type:Wt.RendererPlugin},Kt.add(Cu);var ku=function(e){return e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e}(ku||{}),Su={willReadFrequently:!0},Tu=function(){function e(t,n,r,i,o,a,s,u,c){_classCallCheck(this,e),this.text=t,this.style=n,this.width=r,this.height=i,this.lines=o,this.lineWidths=a,this.lineHeight=s,this.maxLineWidth=u,this.fontProperties=c}return _createClass(e,null,[{key:"experimentalLetterSpacingSupported",get:function(){var t=e._experimentalLetterSpacingSupported;if(void 0!==t){var n=Q.ADAPTER.getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported="letterSpacing"in n||"textLetterSpacing"in n}return t}},{key:"measureText",value:function(t,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e._canvas;r=null!==(i=r)&&void 0!==i?i:n.wordWrap;var a=n.toFontString(),s=e.measureFont(a);0===s.fontSize&&(s.fontSize=n.fontSize,s.ascent=n.fontSize);var u=o.getContext("2d",Su);u.font=a;for(var c=(r?e.wordWrap(t,n,o):t).split(/(?:\r\n|\r|\n)/),l=new Array(c.length),h=0,f=0;f<c.length;f++){var d=e._measureText(c[f],n.letterSpacing,u);l[f]=d,h=Math.max(h,d)}var p=h+n.strokeThickness;n.dropShadow&&(p+=n.dropShadowDistance);var y=n.lineHeight||s.fontSize+n.strokeThickness,g=Math.max(y,s.fontSize+2*n.strokeThickness)+n.leading+(c.length-1)*(y+n.leading);return n.dropShadow&&(g+=n.dropShadowDistance),new e(t,n,p,g,c,l,y+n.leading,h,s)}},{key:"_measureText",value:function(t,n,r){var i=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(r.letterSpacing="".concat(n,"px"),r.textLetterSpacing="".concat(n,"px"),i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));var o=r.measureText(t).width;return o>0&&(i?o-=n:o+=(e.graphemeSegmenter(t).length-1)*n),o}},{key:"wordWrap",value:function(t,n){for(var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e._canvas).getContext("2d",Su),i=0,o="",a="",s=Object.create(null),u=n.letterSpacing,c=n.whiteSpace,l=e.collapseSpaces(c),h=e.collapseNewlines(c),f=!l,d=n.wordWrapWidth+u,p=e.tokenize(t),y=0;y<p.length;y++){var g=p[y];if(e.isNewline(g)){if(!h){a+=e.addLine(o),f=!l,o="",i=0;continue}g=" "}if(l){var m=e.isBreakingSpace(g),v=e.isBreakingSpace(o[o.length-1]);if(m&&v)continue}var w=e.getFromCache(g,u,s,r);if(w>d)if(""!==o&&(a+=e.addLine(o),o="",i=0),e.canBreakWords(g,n.breakWords))for(var b=e.wordWrapSplit(g),x=0;x<b.length;x++){for(var _=b[x],I=_,A=1;b[x+A];){var C=b[x+A];if(e.canBreakChars(I,C,g,x,n.breakWords))break;_+=C,I=C,A++}x+=A-1;var k=e.getFromCache(_,u,s,r);k+i>d&&(a+=e.addLine(o),f=!1,o="",i=0),o+=_,i+=k}else{o.length>0&&(a+=e.addLine(o),o="",i=0);var S=y===p.length-1;a+=e.addLine(g,!S),f=!1,o="",i=0}else w+i>d&&(f=!1,a+=e.addLine(o),o="",i=0),(o.length>0||!e.isBreakingSpace(g)||f)&&(o+=g,i+=w)}return a+=e.addLine(o,!1)}},{key:"addLine",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=e.trimRight(t),n?"".concat(t,"\n"):t}},{key:"getFromCache",value:function(t,n,r,i){var o=r[t];return"number"!=typeof o&&(o=e._measureText(t,n,i)+n,r[t]=o),o}},{key:"collapseSpaces",value:function(e){return"normal"===e||"pre-line"===e}},{key:"collapseNewlines",value:function(e){return"normal"===e}},{key:"trimRight",value:function(t){if("string"!=typeof t)return"";for(var n=t.length-1;n>=0;n--){var r=t[n];if(!e.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}},{key:"isNewline",value:function(t){return"string"==typeof t&&e._newlines.includes(t.charCodeAt(0))}},{key:"isBreakingSpace",value:function(t,n){return"string"==typeof t&&e._breakingSpaces.includes(t.charCodeAt(0))}},{key:"tokenize",value:function(t){var n=[],r="";if("string"!=typeof t)return n;for(var i=0;i<t.length;i++){var o=t[i],a=t[i+1];e.isBreakingSpace(o,a)||e.isNewline(o)?(""!==r&&(n.push(r),r=""),n.push(o)):r+=o}return""!==r&&n.push(r),n}},{key:"canBreakWords",value:function(e,t){return t}},{key:"canBreakChars",value:function(e,t,n,r,i){return!0}},{key:"wordWrapSplit",value:function(t){return e.graphemeSegmenter(t)}},{key:"measureFont",value:function(t){if(e._fonts[t])return e._fonts[t];var n={ascent:0,descent:0,fontSize:0},r=e._canvas,i=e._context;i.font=t;var o=e.METRICS_STRING+e.BASELINE_SYMBOL,a=Math.ceil(i.measureText(o).width),s=Math.ceil(i.measureText(e.BASELINE_SYMBOL).width),u=Math.ceil(e.HEIGHT_MULTIPLIER*s);if(s=s*e.BASELINE_MULTIPLIER|0,0===a||0===u)return e._fonts[t]=n,n;r.width=a,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);var c=i.getImageData(0,0,a,u).data,l=c.length,h=4*a,f=0,d=0,p=!1;for(f=0;f<s;++f){for(var y=0;y<h;y+=4)if(255!==c[d+y]){p=!0;break}if(p)break;d+=h}for(n.ascent=s-f,d=l-h,p=!1,f=u;f>s;--f){for(var g=0;g<h;g+=4)if(255!==c[d+g]){p=!0;break}if(p)break;d-=h}return n.descent=f-s,n.fontSize=n.ascent+n.descent,e._fonts[t]=n,n}},{key:"clearMetrics",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t?delete e._fonts[t]:e._fonts={}}},{key:"_canvas",get:function(){if(!e.__canvas){var t;try{var n,r=new OffscreenCanvas(0,0);if(null!==(n=r.getContext("2d",Su))&&void 0!==n&&n.measureText)return e.__canvas=r,r;t=Q.ADAPTER.createCanvas()}catch(i){t=Q.ADAPTER.createCanvas()}t.width=t.height=10,e.__canvas=t}return e.__canvas}},{key:"_context",get:function(){return e.__context||(e.__context=e._canvas.getContext("2d",Su)),e.__context}}]),e}();Tu.METRICS_STRING="|\xc9q\xc5",Tu.BASELINE_SYMBOL="M",Tu.BASELINE_MULTIPLIER=1.4,Tu.HEIGHT_MULTIPLIER=2,Tu.graphemeSegmenter=function(e){if("function"==typeof(null===(e=Intl)||void 0===e?void 0:e.Segmenter)){var t=new Intl.Segmenter;return function(e){return _toConsumableArray(t.segment(e)).map((function(e){return e.segment}))}}return function(e){return _toConsumableArray(e)}}(),Tu.experimentalLetterSpacing=!1,Tu._fonts={},Tu._newlines=[10,13],Tu._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Eu=Tu,Ou=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Pu=function(){function e(t){_classCallCheck(this,e),this.styleID=0,this.reset(),Du(this,t,t)}return _createClass(e,[{key:"clone",value:function(){var t={};return Du(t,this,e.defaultStyle),new e(t)}},{key:"reset",value:function(){Du(this,e.defaultStyle,e.defaultStyle)}},{key:"align",get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(e){var t=Bu(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(e){var t=Bu(e);this._fill!==t&&(this._fill=t,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0})(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(e){var t=Bu(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}},{key:"toFontString",value:function(){var e="number"==typeof this.fontSize?"".concat(this.fontSize,"px"):this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var n=t.length-1;n>=0;n--){var r=t[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!Ou.includes(r)&&(r='"'.concat(r,'"')),t[n]=r}return"".concat(this.fontStyle," ").concat(this.fontVariant," ").concat(this.fontWeight," ").concat(e," ").concat(t.join(","))}}]),e}();Pu.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:ku.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};var Ru=Pu;function Bu(e){var t=ut.shared,n=function(e){var n=t.setValue(e);return 1===n.alpha?n.toHex():n.toRgbaString()};return Array.isArray(e)?e.map(n):n(e)}function Du(e,t,n){for(var r in n)Array.isArray(t[r])?e[r]=t[r].slice():e[r]=t[r]}var Mu={texture:!0,children:!1,baseTexture:!0},Lu=function(e){function t(e,n,r){var i,o;_classCallCheck(this,t);var a=!1;r||(r=Q.ADAPTER.createCanvas(),a=!0),r.width=3,r.height=3;var s=kr.from(r);return s.orig=new Cn,s.trim=new Cn,(o=_callSuper(this,t,[s]))._ownCanvas=a,o.canvas=r,o.context=r.getContext("2d",{willReadFrequently:!0}),o._resolution=null!==(i=t.defaultResolution)&&void 0!==i?i:Q.RESOLUTION,o._autoResolution=t.defaultAutoResolution,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=e,o.style=n,o.localStyleID=-1,o}return _inherits(t,e),_createClass(t,[{key:"updateText",value:function(e){var t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),this.dirty||!e){this._font=this._style.toFontString();var n,r,i=this.context,o=Eu.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=o.width,s=o.height,u=o.lines,c=o.lineHeight,l=o.lineWidths,h=o.maxLineWidth,f=o.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+2*t.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+2*t.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=t.strokeThickness,i.textBaseline=t.textBaseline,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit;for(var d=t.dropShadow?2:1,p=0;p<d;++p){var y=t.dropShadow&&0===p,g=y?Math.ceil(Math.max(1,s)+2*t.padding):0,m=g*this._resolution;if(y){i.fillStyle="black",i.strokeStyle="black";var v=t.dropShadowColor,w=t.dropShadowBlur*this._resolution,b=t.dropShadowDistance*this._resolution;i.shadowColor=ut.shared.setValue(v).setAlpha(t.dropShadowAlpha).toRgbaString(),i.shadowBlur=w,i.shadowOffsetX=Math.cos(t.dropShadowAngle)*b,i.shadowOffsetY=Math.sin(t.dropShadowAngle)*b+m}else i.fillStyle=this._generateFillStyle(t,u,o),i.strokeStyle=t.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;var x=(c-f.fontSize)/2;c-f.fontSize<0&&(x=0);for(var _=0;_<u.length;_++)n=t.strokeThickness/2,r=t.strokeThickness/2+_*c+f.ascent+x,"right"===t.align?n+=h-l[_]:"center"===t.align&&(n+=(h-l[_])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(u[_],n+t.padding,r+t.padding-g,!0),t.fill&&this.drawLetterSpacing(u[_],n+t.padding,r+t.padding-g)}this.updateTexture()}}},{key:"drawLetterSpacing",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this._style.letterSpacing,o=!1;if(Eu.experimentalLetterSpacingSupported&&(Eu.experimentalLetterSpacing?(this.context.letterSpacing="".concat(i,"px"),this.context.textLetterSpacing="".concat(i,"px"),o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===i||o)r?this.context.strokeText(e,t,n):this.context.fillText(e,t,n);else for(var a=t,s=Eu.graphemeSegmenter(e),u=this.context.measureText(e).width,c=0,l=0;l<s.length;++l){var h=s[l];r?this.context.strokeText(h,a,n):this.context.fillText(h,a,n);for(var f="",d=l+1;d<s.length;++d)f+=s[d];a+=u-(c=this.context.measureText(f).width)+i,u=c}}},{key:"updateTexture",value:function(){var e=this.canvas;if(this._style.trim){var t=Gt(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}var n=this._texture,r=this._style,i=r.trim?0:r.padding,o=n.baseTexture;n.trim.width=n._frame.width=e.width/this._resolution,n.trim.height=n._frame.height=e.height/this._resolution,n.trim.x=-i,n.trim.y=-i,n.orig.width=n._frame.width-2*i,n.orig.height=n._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),n.updateUvs(),this.dirty=!1}},{key:"_render",value:function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),_get(_getPrototypeOf(t.prototype),"_render",this).call(this,e)}},{key:"updateTransform",value:function(){this.updateText(!0),_get(_getPrototypeOf(t.prototype),"updateTransform",this).call(this)}},{key:"getBounds",value:function(e,n){return this.updateText(!0),-1===this._textureID&&(e=!1),_get(_getPrototypeOf(t.prototype),"getBounds",this).call(this,e,n)}},{key:"getLocalBounds",value:function(e){return this.updateText(!0),_get(_getPrototypeOf(t.prototype),"getLocalBounds",this).call(this,e)}},{key:"_calculateBounds",value:function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}},{key:"_generateFillStyle",value:function(e,t,n){var r,i=e.fill;if(!Array.isArray(i))return i;if(1===i.length)return i[0];var o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,s=this.canvas.width/this._resolution-o-2*a,u=this.canvas.height/this._resolution-o-2*a,c=i.slice(),l=e.fillGradientStops.slice();if(!l.length)for(var h=c.length+1,f=1;f<h;++f)l.push(f/h);if(c.unshift(i[0]),l.unshift(0),c.push(i[i.length-1]),l.push(1),e.fillGradientType===ku.LINEAR_VERTICAL){r=this.context.createLinearGradient(s/2,a,s/2,u+a);for(var d=n.fontProperties.fontSize+e.strokeThickness,p=0;p<t.length;p++){var y=n.lineHeight*(p-1)+d,g=n.lineHeight*p,m=g;p>0&&y>g&&(m=(g+y)/2);var v=g+d,w=n.lineHeight*(p+1),b=v;p+1<t.length&&w<v&&(b=(v+w)/2);for(var x=(b-m)/u,_=0;_<c.length;_++){var I;I="number"==typeof l[_]?l[_]:_/c.length;var A=Math.min(1,Math.max(0,m/u+I*x));A=Number(A.toFixed(5)),r.addColorStop(A,c[_])}}}else{r=this.context.createLinearGradient(a,u/2,s+a,u/2);for(var C=c.length+1,k=1,S=0;S<c.length;S++){var T;T="number"==typeof l[S]?l[S]:k/C,r.addColorStop(T,c[S]),k++}}return r}},{key:"destroy",value:function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Mu,e),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}},{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var t=St(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var t=St(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}},{key:"style",get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof Ru?e:new Ru(e),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(e){var t;e=String(null!==(t=e)&&void 0!==t?t:""),this._text!==e&&(this._text=e,this.dirty=!0)}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}}],[{key:"experimentalLetterSpacing",get:function(){return Eu.experimentalLetterSpacing},set:function(e){_e("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Eu.experimentalLetterSpacing=e}}]),t}(go);Lu.defaultAutoResolution=!0;var Fu=Lu,Nu=function(){function e(t){_classCallCheck(this,e),this.maxItemsPerFrame=t,this.itemsLeft=0}return _createClass(e,[{key:"beginFrame",value:function(){this.itemsLeft=this.maxItemsPerFrame}},{key:"allowedToUpload",value:function(){return this.itemsLeft-- >0}}]),e}();function Uu(e,t){var n,r=!1;if(null!==e&&void 0!==e&&null!==(n=e._textures)&&void 0!==n&&n.length)for(var i=0;i<e._textures.length;i++)if(e._textures[i]instanceof kr){var o=e._textures[i].baseTexture;t.includes(o)||(t.push(o),r=!0)}return r}function ju(e,t){if(e.baseTexture instanceof un){var n=e.baseTexture;return t.includes(n)||t.push(n),!0}return!1}function Gu(e,t){if(e._texture&&e._texture instanceof kr){var n=e._texture.baseTexture;return t.includes(n)||t.push(n),!0}return!1}function zu(e,t){return t instanceof Fu&&(t.updateText(!0),!0)}function Hu(e,t){if(t instanceof Ru){var n=t.toFontString();return Eu.measureFont(n),!0}return!1}function Vu(e,t){if(e instanceof Fu){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);var n=e._texture.baseTexture;return t.includes(n)||t.push(n),!0}return!1}function Wu(e,t){return e instanceof Ru&&(t.includes(e)||t.push(e),!0)}var $u=function(){function e(t){var n=this;_classCallCheck(this,e),this.limiter=new Nu(e.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){n.queue&&n.prepareItems()},this.registerFindHook(Vu),this.registerFindHook(Wu),this.registerFindHook(Uu),this.registerFindHook(ju),this.registerFindHook(Gu),this.registerUploadHook(zu),this.registerUploadHook(Hu)}return _createClass(e,[{key:"upload",value:function(e){var t=this;return new Promise((function(n){e&&t.add(e),t.queue.length?(t.completes.push(n),t.ticking||(t.ticking=!0,Li.system.addOnce(t.tick,t,Bi.UTILITY))):n()}))}},{key:"tick",value:function(){setTimeout(this.delayedTick,0)}},{key:"prepareItems",value:function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed)for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)Li.system.addOnce(this.tick,this,Bi.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);this.completes.length=0;for(var o=0,a=i.length;o<a;o++)i[o]()}}},{key:"registerFindHook",value:function(e){return e&&this.addHooks.push(e),this}},{key:"registerUploadHook",value:function(e){return e&&this.uploadHooks.push(e),this}},{key:"add",value:function(e){for(var t=0,n=this.addHooks.length;t<n&&!this.addHooks[t](e,this.queue);t++);if(e instanceof fo)for(var r=e.children.length-1;r>=0;r--)this.add(e.children[r]);return this}},{key:"destroy",value:function(){this.ticking&&Li.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}}]),e}();$u.uploadsPerFrame=4;var Yu=$u;function Ku(e,t){return t instanceof un&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function Xu(e,t){if(!(t instanceof uu))return!1;var n=t.geometry;t.finishPoly(),n.updateBatches();for(var r=n.batches,i=0;i<r.length;i++){var o=r[i].style.texture;o&&Ku(e,o.baseTexture)}return n.batchable||e.geometry.bind(n,t._resolveDirectShader(e)),!0}function Zu(e,t){return e instanceof uu&&(t.push(e),!0)}Object.defineProperties(Q,{UPLOADS_PER_FRAME:{get:function(){return Yu.uploadsPerFrame},set:function(e){_e("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Yu.uploadsPerFrame=e}}});var qu=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).uploadHookHelper=n.renderer,n.registerFindHook(Zu),n.registerUploadHook(Ku),n.registerUploadHook(Xu),n}return _inherits(t,e),_createClass(t)}(Yu);qu.extension={name:"prepare",type:Wt.RendererSystem},Kt.add(qu);var Ju=function(){function e(t){_classCallCheck(this,e),this.maxMilliseconds=t,this.frameStart=0}return _createClass(e,[{key:"beginFrame",value:function(){this.frameStart=Date.now()}},{key:"allowedToUpload",value:function(){return Date.now()-this.frameStart<this.maxMilliseconds}}]),e}(),Qu=function(e){function t(e){var n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return _classCallCheck(this,t),(n=_callSuper(this,t,[e[0]instanceof kr?e[0]:e[0].texture]))._textures=null,n._durations=null,n._autoUpdate=r,n._isConnectedToTicker=!1,n.animationSpeed=1,n.loop=!0,n.updateAnchor=!1,n.onComplete=null,n.onFrameChange=null,n.onLoop=null,n._currentTime=0,n._playing=!1,n._previousFrame=null,n.textures=e,n}return _inherits(t,e),_createClass(t,[{key:"stop",value:function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Li.shared.remove(this.update,this),this._isConnectedToTicker=!1))}},{key:"play",value:function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Li.shared.add(this.update,this,Bi.HIGH),this._isConnectedToTicker=!0))}},{key:"gotoAndStop",value:function(e){this.stop(),this.currentFrame=e}},{key:"gotoAndPlay",value:function(e){this.currentFrame=e,this.play()}},{key:"update",value:function(e){if(this._playing){var t=this.animationSpeed*e,n=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=t/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}}},{key:"updateTexture",value:function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}},{key:"destroy",value:function(e){this.stop(),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}},{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(e){if(e[0]instanceof kr)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},set:function(e){if(e<0||e>this.totalFrames-1)throw new Error("[AnimatedSprite]: Invalid frame index value ".concat(e,", expected to be between 0 and totalFrames ").concat(this.totalFrames,"."));var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()}},{key:"playing",get:function(){return this._playing}},{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Li.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Li.shared.add(this.update,this),this._isConnectedToTicker=!0))}}],[{key:"fromFrames",value:function(e){for(var n=[],r=0;r<e.length;++r)n.push(kr.from(e[r]));return new t(n)}},{key:"fromImages",value:function(e){for(var n=[],r=0;r<e.length;++r)n.push(kr.from(e[r]));return new t(n)}}]),t}(go),ec=new In,tc=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).tileTransform=new Gn,n._width=r,n._height=i,n.uvMatrix=n.texture.uvMatrix||new Gr(e),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return _inherits(t,e),_createClass(t,[{key:"clampMargin",get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)}},{key:"_onTextureUpdate",value:function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}},{key:"_render",value:function(e){var t=this._texture;!t||!t.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))}},{key:"_calculateBounds",value:function(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,n,r)}},{key:"getLocalBounds",value:function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Cn),e=this._localBoundsRect),this._bounds.getRectangle(e)):_get(_getPrototypeOf(t.prototype),"getLocalBounds",this).call(this,e)}},{key:"containsPoint",value:function(e){this.worldTransform.applyInverse(e,ec);var t=this._width,n=this._height,r=-t*this.anchor._x;if(ec.x>=r&&ec.x<r+t){var i=-n*this.anchor._y;if(ec.y>=i&&ec.y<i+n)return!0}return!1}},{key:"destroy",value:function(e){_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e),this.tileTransform=null,this.uvMatrix=null}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}],[{key:"from",value:function(e,n){return new t(e instanceof kr?e:kr.from(e,n),n.width,n.height)}}]),t}(go),nc="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",rc=new On,ic=function(e){function t(e){var n;return _classCallCheck(this,t),n=_callSuper(this,t,[e]),e.runners.contextChange.add(_assertThisInitialized(n)),n.quad=new Or,n.state=Qt.for2d(),n}return _inherits(t,e),_createClass(t,[{key:"contextChange",value:function(){var e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=sr.from(nc,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",t),this.shader=e.context.webGLVersion>1?sr.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",t):sr.from(nc,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",t)}},{key:"render",value:function(e){var t=this.renderer,n=this.quad,r=n.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y);var i=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;(r=n.uvs)[0]=r[6]=-i,r[1]=r[3]=-o,r[2]=r[4]=1-i,r[5]=r[7]=1-o,n.invalidate();var a=e._texture,s=a.baseTexture,u=s.alphaMode>0,c=e.tileTransform.localTransform,l=e.uvMatrix,h=s.isPowerOfTwo&&a.frame.width===s.width&&a.frame.height===s.height;h&&(s._glTextures[t.CONTEXT_UID]?h=s.wrapMode!==z.CLAMP:s.wrapMode===z.CLAMP&&(s.wrapMode=z.REPEAT));var f=h?this.simpleShader:this.shader,d=a.width,p=a.height,y=e._width,g=e._height;rc.set(c.a*d/y,c.b*d/g,c.c*p/y,c.d*p/g,c.tx/y,c.ty/g),rc.invert(),h?rc.prepend(l.mapCoord):(f.uniforms.uMapCoord=l.mapCoord.toArray(!0),f.uniforms.uClampFrame=l.uClampFrame,f.uniforms.uClampOffset=l.uClampOffset),f.uniforms.uTransform=rc.toArray(!0),f.uniforms.uColor=ut.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,t.shader.bind(f),t.geometry.bind(n),this.state.blendMode=pt(e.blendMode,u),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}]),t}(lr);ic.extension={name:"tilingSprite",type:Wt.RendererPlugin},Kt.add(ic);var oc=function(){function e(t,n,r){_classCallCheck(this,e),this.linkedSheets=[],(t instanceof un||t instanceof kr)&&(t={texture:t,data:n,resolutionFilename:r});var i=t,o=i.texture,a=i.data,s=i.resolutionFilename,u=void 0===s?null:s,c=i.cachePrefix,l=void 0===c?"":c;this.cachePrefix=l,this._texture=o instanceof kr?o:null,this.baseTexture=o instanceof un?o:this._texture.baseTexture,this.textures={},this.animations={},this.data=a;var h=this.baseTexture.resource;this.resolution=this._updateResolution(u||(h?h.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return _createClass(e,[{key:"_updateResolution",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.data.meta.scale,n=Vt(e,null);return null===n&&(n="number"==typeof t?t:parseFloat(null!==t&&void 0!==t?t:"1")),1!==n&&this.baseTexture.setResolution(n),n}},{key:"parse",value:function(){var t=this;return new Promise((function(n){t._callback=n,t._batchIndex=0,t._frameKeys.length<=e.BATCH_SIZE?(t._processFrames(0),t._processAnimations(),t._parseComplete()):t._nextBatch()}))}},{key:"_processFrames",value:function(t){for(var n=t,r=e.BATCH_SIZE;n-t<r&&n<this._frameKeys.length;){var i=this._frameKeys[n],o=this._frames[i],a=o.frame;if(a){var s,u=null,c=!1!==o.trimmed&&o.sourceSize?o.sourceSize:o.frame,l=new Cn(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s=o.rotated?new Cn(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):new Cn(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),!1!==o.trimmed&&o.spriteSourceSize&&(u=new Cn(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new kr(this.baseTexture,s,l,u,o.rotated?2:0,o.anchor,o.borders),kr.addToCache(this.textures[i],this.cachePrefix+i.toString())}n++}}},{key:"_processAnimations",value:function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var n=0;n<e[t].length;n++){var r=e[t][n];this.animations[t].push(this.textures[r])}}}},{key:"_parseComplete",value:function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}},{key:"_nextBatch",value:function(){var t=this;this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout((function(){t._batchIndex*e.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())}),0)}},{key:"destroy",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null!==(e=this._texture)&&void 0!==e&&e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}}]),e}();oc.BATCH_SIZE=1e3;var ac=oc,sc=["jpg","png","jpeg","avif","webp"];function uc(e,t,n){var r={};if(e.forEach((function(e){r[e]=t})),Object.keys(t.textures).forEach((function(e){r["".concat(t.cachePrefix).concat(e)]=t.textures[e]})),!n){var i=Te.dirname(e[0]);t.linkedSheets.forEach((function(e,n){Object.assign(r,uc(["".concat(i,"/").concat(t.data.meta.related_multi_packs[n])],e,!0))}))}return r}var cc={extension:Wt.Asset,cache:{test:function(e){return e instanceof ac},getCacheableAssets:function(e,t){return uc(e,t,!1)}},resolver:{test:function(e){var t=e.split("?")[0].split("."),n=t.pop(),r=t.pop();return"json"===n&&sc.includes(r)},parse:function(e){var t,n,r=e.split(".");return{resolution:parseFloat(null!==(t=null===(n=Q.RETINA_PREFIX.exec(e))||void 0===n?void 0:n[1])&&void 0!==t?t:"1"),format:r[r.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:Wt.LoadParser,priority:ea.Normal},testParse:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",".json"===Te.extname(n.src).toLowerCase()&&!!t.frames);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),parse:function(e,t,n){return _asyncToGenerator(_regeneratorRuntime().mark((function r(){var i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b,x;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=null!==(i=null===t||void 0===t?void 0:t.data)&&void 0!==i?i:{},s=a.texture,u=a.imageFilename,c=a.cachePrefix,(h=Te.dirname(t.src))&&h.lastIndexOf("/")!==h.length-1&&(h+="/"),!s||!s.baseTexture){r.next=6;break}l=s,r.next=11;break;case 6:return f=Ka(h+(null!==u&&void 0!==u?u:e.meta.image),t.src),r.next=9,n.load([f]);case 9:r.t0=f,l=r.sent[r.t0];case 11:return d=new ac({texture:l.baseTexture,data:e,resolutionFilename:t.src,cachePrefix:c}),r.next=14,d.parse();case 14:if(p=null===e||void 0===e||null===(o=e.meta)||void 0===o?void 0:o.related_multi_packs,!Array.isArray(p)){r.next=40;break}y=[],g=_createForOfIteratorHelper(p),r.prev=18,g.s();case 20:if((m=g.n()).done){r.next=28;break}if("string"==typeof(w=m.value)){r.next=24;break}return r.abrupt("continue",26);case 24:b=h+w,(null===(v=t.data)||void 0===v?void 0:v.ignoreMultiPack)||(b=Ka(b,t.src),y.push(n.load({src:b,data:{ignoreMultiPack:!0}})));case 26:r.next=20;break;case 28:r.next=33;break;case 30:r.prev=30,r.t1=r.catch(18),g.e(r.t1);case 33:return r.prev=33,g.f(),r.finish(33);case 36:return r.next=38,Promise.all(y);case 38:x=r.sent,d.linkedSheets=x,x.forEach((function(e){e.linkedSheets=[d].concat(d.linkedSheets.filter((function(t){return t!==e})))}));case 40:return r.abrupt("return",d);case 41:case"end":return r.stop()}}),r,null,[[18,30,33,36]])})))()},unload:function(e){e.destroy(!0)}}};Kt.add(cc);var lc=_createClass((function e(){_classCallCheck(this,e),this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]})),hc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"test",value:function(e){return"string"==typeof e&&e.startsWith("info face=")}},{key:"parse",value:function(e){var t=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in t){var i=t[r].match(/^[a-z]+/gm)[0],o=t[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var s in o){var u=o[s].split("="),c=u[0],l=u[1].replace(/"/gm,""),h=parseFloat(l),f=isNaN(h)?l:h;a[c]=f}n[i].push(a)}var d=new lc;return n.info.forEach((function(e){return d.info.push({face:e.face,size:parseInt(e.size,10)})})),n.common.forEach((function(e){return d.common.push({lineHeight:parseInt(e.lineHeight,10)})})),n.page.forEach((function(e){return d.page.push({id:parseInt(e.id,10),file:e.file})})),n.char.forEach((function(e){return d.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)})})),n.kerning.forEach((function(e){return d.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)})})),n.distanceField.forEach((function(e){return d.distanceField.push({distanceRange:parseInt(e.distanceRange,10),fieldType:e.fieldType})})),d}}]),e}(),fc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"test",value:function(e){var t=e;return"string"!=typeof e&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")}},{key:"parse",value:function(e){for(var t=new lc,n=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),i=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),s=e.getElementsByTagName("distanceField"),u=0;u<n.length;u++)t.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(var c=0;c<r.length;c++)t.common.push({lineHeight:parseInt(r[c].getAttribute("lineHeight"),10)});for(var l=0;l<i.length;l++)t.page.push({id:parseInt(i[l].getAttribute("id"),10)||0,file:i[l].getAttribute("file")});for(var h=0;h<o.length;h++){var f=o[h];t.char.push({id:parseInt(f.getAttribute("id"),10),page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xoffset:parseInt(f.getAttribute("xoffset"),10),yoffset:parseInt(f.getAttribute("yoffset"),10),xadvance:parseInt(f.getAttribute("xadvance"),10)})}for(var d=0;d<a.length;d++)t.kerning.push({first:parseInt(a[d].getAttribute("first"),10),second:parseInt(a[d].getAttribute("second"),10),amount:parseInt(a[d].getAttribute("amount"),10)});for(var p=0;p<s.length;p++)t.distanceField.push({fieldType:s[p].getAttribute("fieldType"),distanceRange:parseInt(s[p].getAttribute("distanceRange"),10)});return t}}]),e}(),dc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"test",value:function(e){return!("string"!=typeof e||!e.includes("<font>"))&&fc.test(Q.ADAPTER.parseXML(e))}},{key:"parse",value:function(e){return fc.parse(Q.ADAPTER.parseXML(e))}}]),e}(),pc=[hc,fc,dc];function yc(e){for(var t=0;t<pc.length;t++)if(pc[t].test(e))return pc[t];return null}function gc(e,t,n,r,i,o,a){var s=n.text,u=n.fontProperties;t.translate(r,i),t.scale(o,o);var c=a.strokeThickness/2,l=-a.strokeThickness/2;if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=function(e,t,n,r,i,o){var a,s=n.fill;if(!Array.isArray(s))return s;if(1===s.length)return s[0];var u=n.dropShadow?n.dropShadowDistance:0,c=n.padding||0,l=e.width/r-u-2*c,h=e.height/r-u-2*c,f=s.slice(),d=n.fillGradientStops.slice();if(!d.length)for(var p=f.length+1,y=1;y<p;++y)d.push(y/p);if(f.unshift(s[0]),d.unshift(0),f.push(s[s.length-1]),d.push(1),n.fillGradientType===ku.LINEAR_VERTICAL){a=t.createLinearGradient(l/2,c,l/2,h+c);for(var g=0,m=(o.fontProperties.fontSize+n.strokeThickness)/h,v=0;v<i.length;v++)for(var w=o.lineHeight*v,b=0;b<f.length;b++){var x=w/h+("number"==typeof d[b]?d[b]:b/f.length)*m,_=Math.max(g,x);_=Math.min(_,1),a.addColorStop(_,f[b]),g=_}}else{a=t.createLinearGradient(c,h/2,l+c,h/2);for(var I=f.length+1,A=1,C=0;C<f.length;C++){var k;k="number"==typeof d[C]?d[C]:A/I,a.addColorStop(k,f[C]),A++}}return a}(e,t,a,o,[s],n),t.strokeStyle=a.stroke,a.dropShadow){var h=a.dropShadowColor,f=a.dropShadowBlur*o,d=a.dropShadowDistance*o;t.shadowColor=ut.shared.setValue(h).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=f,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*d,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*d}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(s,c,l+n.lineHeight-u.descent),a.fill&&t.fillText(s,c,l+n.lineHeight-u.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function mc(e){return Array.from?Array.from(e):e.split("")}function vc(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}var wc=function(){function e(t,n,r){var i,o;_classCallCheck(this,e);var a=_slicedToArray(t.info,1)[0],s=_slicedToArray(t.common,1)[0],u=_slicedToArray(t.page,1)[0],c=_slicedToArray(t.distanceField,1)[0],l=Vt(u.file),h={};this._ownsTextures=r,this.font=a.face,this.size=a.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=h;for(var f=0;f<t.page.length;f++){var d=t.page[f],p=d.id,y=d.file;h[p]=n instanceof Array?n[f]:n[y],(null===c||void 0===c?void 0:c.fieldType)&&"none"!==c.fieldType&&(h[p].baseTexture.alphaMode=V.NO_PREMULTIPLIED_ALPHA,h[p].baseTexture.mipmap=H.OFF)}for(var g=0;g<t.char.length;g++){var m=t.char[g],v=m.id,w=m.page,b=t.char[g],x=b.x,_=b.y,I=b.width,A=b.height,C=b.xoffset,k=b.yoffset,S=b.xadvance;_/=l,I/=l,A/=l,C/=l,k/=l,S/=l;var T=new Cn((x/=l)+h[w].frame.x/l,_+h[w].frame.y/l,I,A);this.chars[v]={xOffset:C,yOffset:k,xAdvance:S,kerning:{},texture:new kr(h[w].baseTexture,T),page:w}}for(var E=0;E<t.kerning.length;E++){var O=t.kerning[E],P=O.first,R=O.second,B=O.amount;P/=l,R/=l,B/=l,this.chars[R]&&(this.chars[R].kerning[P]=B)}this.distanceFieldRange=null===c||void 0===c?void 0:c.distanceRange,this.distanceFieldType=null!==(i=null===c||void 0===c||null===(o=c.fieldType)||void 0===o?void 0:o.toLowerCase())&&void 0!==i?i:"none"}return _createClass(e,[{key:"destroy",value:function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}}],[{key:"install",value:function(t,n,r){var i;if(t instanceof lc)i=t;else{var o=yc(t);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(t)}n instanceof kr&&(n=[n]);var a=new e(i,n,r);return e.available[a.font]=a,a}},{key:"uninstall",value:function(t){var n=e.available[t];if(!n)throw new Error("No font found named '".concat(t,"'"));n.destroy(),delete e.available[t]}},{key:"from",value:function(t,n,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},e.defaultOptions,r),o=i.chars,a=i.padding,s=i.resolution,u=i.textureWidth,c=i.textureHeight,l=_objectWithoutProperties(i,_excluded2),h=function(e){"string"==typeof e&&(e=[e]);for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got ".concat(i.length,"."));var o=i[0].charCodeAt(0),a=i[1].charCodeAt(0);if(a<o)throw new Error("[BitmapFont]: Invalid character range.");for(var s=o,u=a;s<=u;s++)t.push(String.fromCharCode(s))}else t.push.apply(t,_toConsumableArray(mc(i)))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}(o),f=n instanceof Ru?n:new Ru(n),d=u,p=new lc;p.info[0]={face:f.fontFamily,size:f.fontSize},p.common[0]={lineHeight:f.fontSize};for(var y,g,m,v=0,w=0,b=0,x=[],_=[],I=0;I<h.length;I++){y||((y=Q.ADAPTER.createCanvas()).width=u,y.height=c,g=y.getContext("2d"),m=new un(y,_objectSpread({resolution:s},l)),x.push(m),_.push(new kr(m)),p.page.push({id:_.length-1,file:""}));var A=h[I],C=Eu.measureText(A,f,!1,y),k=C.width,S=Math.ceil(C.height),T=Math.ceil(("italic"===f.fontStyle?2:1)*k);if(w>=c-S*s){if(0===w)throw new Error("[BitmapFont] textureHeight ".concat(c,"px is too small (fontFamily: '").concat(f.fontFamily,"', fontSize: ").concat(f.fontSize,"px, char: '").concat(A,"')"));--I,y=null,g=null,m=null,w=0,v=0,b=0}else if(b=Math.max(S+C.fontProperties.descent,b),T*s+v>=d){if(0===v)throw new Error("[BitmapFont] textureWidth ".concat(u,"px is too small (fontFamily: '").concat(f.fontFamily,"', fontSize: ").concat(f.fontSize,"px, char: '").concat(A,"')"));--I,w+=b*s,w=Math.ceil(w),v=0,b=0}else{gc(y,g,C,v,w,s,f);var E=vc(C.text);p.char.push({id:E,page:_.length-1,x:v/s,y:w/s,width:T,height:S,xoffset:0,yoffset:0,xadvance:k-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0)}),v+=(T+2*a)*s,v=Math.ceil(v)}}if(null===r||void 0===r||!r.skipKerning)for(var O=0,P=h.length;O<P;O++)for(var R=h[O],B=0;B<P;B++){var D=h[B],M=g.measureText(R).width,L=g.measureText(D).width,F=g.measureText(R+D).width-(M+L);F&&p.kerning.push({first:vc(R),second:vc(D),amount:F})}var N=new e(p,_,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=N,N}}]),e}();wc.ALPHA=[["a","z"],["A","Z"]," "],wc.NUMERIC=[["0","9"]],wc.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],wc.ASCII=[[" ","~"]],wc.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:wc.ALPHANUMERIC},wc.available={};var bc=wc,xc=[],_c=[],Ic=[],Ac=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),n=_callSuper(this,t);var i=Object.assign({},t.styleDefaults,r),o=i.align,a=i.tint,s=i.maxWidth,u=i.letterSpacing,c=i.fontName,l=i.fontSize;if(!bc.available[c])throw new Error('Missing BitmapFont "'.concat(c,'"'));return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=o,n._tintColor=new ut(a),n._font=void 0,n._fontName=c,n._fontSize=l,n.text=e,n._maxWidth=s,n._maxLineHeight=0,n._letterSpacing=u,n._anchor=new Un((function(){n.dirty=!0}),_assertThisInitialized(n),0,0),n._roundPixels=Q.ROUND_PIXELS,n.dirty=!0,n._resolution=Q.RESOLUTION,n._autoResolution=!0,n._textureCache={},n}return _inherits(t,e),_createClass(t,[{key:"updateText",value:function(){for(var e=bc.available[this._fontName],t=this.fontSize,n=t/e.size,r=new In,i=[],o=[],a=[],s=mc(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),u=this._maxWidth*e.size/t,c="none"===e.distanceFieldType?xc:_c,l=null,h=0,f=0,d=0,p=-1,y=0,g=0,m=0,v=0,w=0;w<s.length;w++){var b=s[w],x=vc(b);if(/(?:\s)/.test(b)&&(p=w,y=h,v++),"\r"!==b&&"\n"!==b){var _=e.chars[x];if(_){l&&_.kerning[l]&&(r.x+=_.kerning[l]);var I=Ic.pop()||{texture:kr.EMPTY,line:0,charCode:0,prevSpaces:0,position:new In};I.texture=_.texture,I.line=d,I.charCode=x,I.position.x=Math.round(r.x+_.xOffset+this._letterSpacing/2),I.position.y=Math.round(r.y+_.yOffset),I.prevSpaces=v,i.push(I),h=I.position.x+Math.max(_.xAdvance-_.xOffset,_.texture.orig.width),r.x+=_.xAdvance+this._letterSpacing,m=Math.max(m,_.yOffset+_.texture.height),l=x,-1!==p&&u>0&&r.x>u&&(kt(i,1+p-++g,1+w-p),w=p,p=-1,o.push(y),a.push(i.length>0?i[i.length-1].prevSpaces:0),f=Math.max(f,y),d++,r.x=0,r.y+=e.lineHeight,l=null,v=0)}}else o.push(h),a.push(-1),f=Math.max(f,h),++d,++g,r.x=0,r.y+=e.lineHeight,l=null,v=0}var A=s[s.length-1];"\r"!==A&&"\n"!==A&&(/(?:\s)/.test(A)&&(h=y),o.push(h),f=Math.max(f,h),a.push(-1));for(var C=[],k=0;k<=d;k++){var S=0;"right"===this._align?S=f-o[k]:"center"===this._align?S=(f-o[k])/2:"justify"===this._align&&(S=a[k]<0?0:(f-o[k])/a[k]),C.push(S)}var T=i.length,E={},O=[],P=this._activePagesMeshData;c.push.apply(c,_toConsumableArray(P));for(var R=0;R<T;R++){var B=i[R].texture,D=B.baseTexture.uid;if(!E[D]){var L=c.pop();if(!L){var F=new yu,N=void 0,U=void 0;"none"===e.distanceFieldType?(N=new gu(kr.EMPTY),U=M.NORMAL):(N=new gu(kr.EMPTY,{program:ir.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),U=M.NORMAL_NPM);var j=new pu(F,N);j.blendMode=U,L={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:j,vertices:null,uvs:null,indices:null}}L.index=0,L.indexCount=0,L.vertexCount=0,L.uvsCount=0,L.total=0;var G=this._textureCache;G[D]=G[D]||new kr(B.baseTexture),L.mesh.texture=G[D],L.mesh.tint=this._tintColor.value,O.push(L),E[D]=L}E[D].total++}for(var z=0;z<P.length;z++)O.includes(P[z])||this.removeChild(P[z].mesh);for(var H=0;H<O.length;H++)O[H].mesh.parent!==this&&this.addChild(O[H].mesh);for(var V in this._activePagesMeshData=O,E){var W,$=E[V],Y=$.total;if(!((null===(W=$.indices)||void 0===W?void 0:W.length)>6*Y)||$.vertices.length<2*pu.BATCHABLE_SIZE)$.vertices=new Float32Array(8*Y),$.uvs=new Float32Array(8*Y),$.indices=new Uint16Array(6*Y);else for(var K=$.total,X=$.vertices,Z=4*K*2;Z<X.length;Z++)X[Z]=0;$.mesh.size=6*Y}for(var q=0;q<T;q++){var J=i[q],Q=J.position.x+C[J.line]*("justify"===this._align?J.prevSpaces:1);this._roundPixels&&(Q=Math.round(Q));var ee=Q*n,te=J.position.y*n,ne=J.texture,re=E[ne.baseTexture.uid],ie=ne.frame,oe=ne._uvs,ae=re.index++;re.indices[6*ae+0]=0+4*ae,re.indices[6*ae+1]=1+4*ae,re.indices[6*ae+2]=2+4*ae,re.indices[6*ae+3]=0+4*ae,re.indices[6*ae+4]=2+4*ae,re.indices[6*ae+5]=3+4*ae,re.vertices[8*ae+0]=ee,re.vertices[8*ae+1]=te,re.vertices[8*ae+2]=ee+ie.width*n,re.vertices[8*ae+3]=te,re.vertices[8*ae+4]=ee+ie.width*n,re.vertices[8*ae+5]=te+ie.height*n,re.vertices[8*ae+6]=ee,re.vertices[8*ae+7]=te+ie.height*n,re.uvs[8*ae+0]=oe.x0,re.uvs[8*ae+1]=oe.y0,re.uvs[8*ae+2]=oe.x1,re.uvs[8*ae+3]=oe.y1,re.uvs[8*ae+4]=oe.x2,re.uvs[8*ae+5]=oe.y2,re.uvs[8*ae+6]=oe.x3,re.uvs[8*ae+7]=oe.y3}for(var se in this._textWidth=f*n,this._textHeight=(r.y+e.lineHeight)*n,E){var ue=E[se];if(0!==this.anchor.x||0!==this.anchor.y)for(var ce=0,le=this._textWidth*this.anchor.x,he=this._textHeight*this.anchor.y,fe=0;fe<ue.total;fe++)ue.vertices[ce++]-=le,ue.vertices[ce++]-=he,ue.vertices[ce++]-=le,ue.vertices[ce++]-=he,ue.vertices[ce++]-=le,ue.vertices[ce++]-=he,ue.vertices[ce++]-=le,ue.vertices[ce++]-=he;this._maxLineHeight=m*n;var de=ue.mesh.geometry.getBuffer("aVertexPosition"),pe=ue.mesh.geometry.getBuffer("aTextureCoord"),ye=ue.mesh.geometry.getIndex();de.data=ue.vertices,pe.data=ue.uvs,ye.data=ue.indices,de.update(),pe.update(),ye.update()}for(var ge=0;ge<i.length;ge++)Ic.push(i[ge]);this._font=e,this.dirty=!1}},{key:"updateTransform",value:function(){this.validate(),this.containerUpdateTransform()}},{key:"_render",value:function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var n=bc.available[this._fontName],r=n.distanceFieldRange,i=n.distanceFieldType,o=n.size;if("none"!==i){var a,s=this.worldTransform,u=s.a,c=s.b,l=s.c,h=s.d,f=Math.sqrt(u*u+c*c),d=Math.sqrt(l*l+h*h),p=(Math.abs(f)+Math.abs(d))/2,y=this.fontSize/o,g=e._view.resolution,m=_createForOfIteratorHelper(this._activePagesMeshData);try{for(m.s();!(a=m.n()).done;){a.value.mesh.shader.uniforms.uFWidth=p*r*y*g}}catch(v){m.e(v)}finally{m.f()}}_get(_getPrototypeOf(t.prototype),"_render",this).call(this,e)}},{key:"getLocalBounds",value:function(){return this.validate(),_get(_getPrototypeOf(t.prototype),"getLocalBounds",this).call(this)}},{key:"validate",value:function(){var e=bc.available[this._fontName];if(!e)throw new Error('Missing BitmapFont "'.concat(this._fontName,'"'));this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}},{key:"tint",get:function(){return this._tintColor.value},set:function(e){if(this.tint!==e){this._tintColor.setValue(e);for(var t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}},{key:"align",get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)}},{key:"fontName",get:function(){return this._fontName},set:function(e){if(!bc.available[e])throw new Error('Missing BitmapFont "'.concat(e,'"'));this._fontName!==e&&(this._fontName=e,this.dirty=!0)}},{key:"fontSize",get:function(){var e;return null!==(e=this._fontSize)&&void 0!==e?e:bc.available[this._fontName].size},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}},{key:"anchor",get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}},{key:"text",get:function(){return this._text},set:function(e){var t;e=String(null!==(t=e)&&void 0!==t?t:""),this._text!==e&&(this._text=e,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}},{key:"roundPixels",get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}},{key:"destroy",value:function(e){var n=this._textureCache,r="none"===bc.available[this._fontName].distanceFieldType?xc:_c;r.push.apply(r,_toConsumableArray(this._activePagesMeshData));var i,o=_createForOfIteratorHelper(this._activePagesMeshData);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.removeChild(a.mesh)}}catch(u){o.e(u)}finally{o.f()}for(var s in this._activePagesMeshData=[],r.filter((function(e){return n[e.mesh.texture.baseTexture.uid]})).forEach((function(e){e.mesh.texture=kr.EMPTY})),n)n[s].destroy(),delete n[s];this._font=null,this._tintColor=null,this._textureCache=null,_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e)}}]),t}(fo);Ac.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var Cc=Ac,kc=[".xml",".fnt"],Sc={extension:{type:Wt.LoadParser,priority:ea.Normal},name:"loadBitmapFont",test:function(e){return kc.includes(Te.extname(e).toLowerCase())},testParse:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",hc.test(t)||dc.test(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),parse:function(e,t,n){return _asyncToGenerator(_regeneratorRuntime().mark((function r(){var i,o,a,s,u,c,l,h,f;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(i=hc.test(e)?hc.parse(e):dc.parse(e),o=t.src,a=i.page,s=[],u=0;u<a.length;++u)c=a[u].file,l=Te.join(Te.dirname(o),c),l=Ka(l,o),s.push(l);return r.next=4,n.load(s);case 4:return h=r.sent,f=s.map((function(e){return h[e]})),r.abrupt("return",bc.install(i,f,!0));case 7:case"end":return r.stop()}}),r)})))()},load:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.ADAPTER.fetch(t);case 2:return e.abrupt("return",e.sent.text());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),unload:function(e){e.destroy()}};Kt.add(Sc);var Tc=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments))._fonts=[],e._overrides=[],e._stylesheet="",e.fontsDirty=!1,e}return _inherits(t,e),_createClass(t,[{key:"cleanFonts",value:function(){this._fonts.length>0&&(this._fonts.forEach((function(e){URL.revokeObjectURL(e.src),e.refs--,0===e.refs&&(e.fontFace&&document.fonts.delete(e.fontFace),delete t.availableFonts[e.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}},{key:"loadFont",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.availableFonts;if(i[e]){var o=i[e];return this._fonts.push(o),o.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return Q.ADAPTER.fetch(e).then((function(e){return e.blob()})).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=URL.createObjectURL(t),i=new FileReader;i.onload=function(){return e([r,i.result])},i.onerror=n,i.readAsDataURL(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(o){var a,s,u,c,l;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=_slicedToArray(o,2),s=a[0],u=a[1],c=Object.assign({family:Te.basename(e,Te.extname(e)),weight:"normal",style:"normal",display:"auto",src:s,dataSrc:u,refs:1,originalUrl:e,fontFace:null},r),i[e]=c,n._fonts.push(c),n.styleID++,l=new FontFace(c.family,"url(".concat(c.src,")"),{weight:c.weight,style:c.style,display:c.display}),c.fontFace=l,t.next=7,l.load();case 7:return document.fonts.add(l),t.next=10,document.fonts.ready;case 10:n.styleID++,n.fontsDirty=!0;case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"addOverride",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r.filter((function(e){return!t._overrides.includes(e)}));o.length>0&&((e=this._overrides).push.apply(e,_toConsumableArray(o)),this.styleID++)}},{key:"removeOverride",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.filter((function(t){return e._overrides.includes(t)}));i.length>0&&(this._overrides=this._overrides.filter((function(e){return!i.includes(e)})),this.styleID++)}},{key:"toCSS",value:function(e){return["transform: scale(".concat(e,")"),"transform-origin: top left","display: inline-block","color: ".concat(this.normalizeColor(this.fill)),"font-size: ".concat(this.fontSize,"px"),"font-family: ".concat(this.fontFamily),"font-weight: ".concat(this.fontWeight),"font-style: ".concat(this.fontStyle),"font-variant: ".concat(this.fontVariant),"letter-spacing: ".concat(this.letterSpacing,"px"),"text-align: ".concat(this.align),"padding: ".concat(this.padding,"px"),"white-space: ".concat(this.whiteSpace)].concat(_toConsumableArray(this.lineHeight?["line-height: ".concat(this.lineHeight,"px")]:[]),_toConsumableArray(this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),"max-width: ".concat(this.wordWrapWidth,"px")]:[]),_toConsumableArray(this.strokeThickness?["-webkit-text-stroke-width: ".concat(this.strokeThickness,"px"),"-webkit-text-stroke-color: ".concat(this.normalizeColor(this.stroke)),"text-stroke-width: ".concat(this.strokeThickness,"px"),"text-stroke-color: ".concat(this.normalizeColor(this.stroke)),"paint-order: stroke"]:[]),_toConsumableArray(this.dropShadow?[this.dropShadowToCSS()]:[]),_toConsumableArray(this._overrides)).join(";")}},{key:"toGlobalCSS",value:function(){return this._fonts.reduce((function(e,t){return"".concat(e,'\n            @font-face {\n                font-family: "').concat(t.family,"\";\n                src: url('").concat(t.dataSrc,"');\n                font-weight: ").concat(t.weight,";\n                font-style: ").concat(t.style,";\n                font-display: ").concat(t.display,";\n            }")}),this._stylesheet)}},{key:"stylesheet",get:function(){return this._stylesheet},set:function(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}},{key:"normalizeColor",value:function(e){return Array.isArray(e)&&(e=ft(e)),"number"==typeof e?lt(e):e}},{key:"dropShadowToCSS",value:function(){var e=this.normalizeColor(this.dropShadowColor),t=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(255*t|0).toString(16).padStart(2,"0"));var i="".concat(n,"px ").concat(r,"px");return this.dropShadowBlur>0?"text-shadow: ".concat(i," ").concat(this.dropShadowBlur,"px ").concat(e):"text-shadow: ".concat(i," ").concat(e)}},{key:"reset",value:function(){Object.assign(this,t.defaultOptions)}},{key:"onBeforeDraw",value:function(){var e=this.fontsDirty;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise((function(e){return setTimeout(e,100)})):Promise.resolve()}},{key:"isSafari",get:function(){var e=Q.ADAPTER.getNavigator().userAgent;return/^((?!chrome|android).)*safari/i.test(e)}},{key:"fillGradientStops",get:function(){return _get(_getPrototypeOf(t.prototype),"fillGradientStops",this)},set:function(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}},{key:"fillGradientType",get:function(){return _get(_getPrototypeOf(t.prototype),"fillGradientType",this)},set:function(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}},{key:"miterLimit",get:function(){return _get(_getPrototypeOf(t.prototype),"miterLimit",this)},set:function(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}},{key:"trim",get:function(){return _get(_getPrototypeOf(t.prototype),"trim",this)},set:function(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}},{key:"textBaseline",get:function(){return _get(_getPrototypeOf(t.prototype),"textBaseline",this)},set:function(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}},{key:"leading",get:function(){return _get(_getPrototypeOf(t.prototype),"leading",this)},set:function(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}},{key:"lineJoin",get:function(){return _get(_getPrototypeOf(t.prototype),"lineJoin",this)},set:function(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}}],[{key:"from",value:function(e){return new t(Object.keys(t.defaultOptions).reduce((function(t,n){return _objectSpread(_objectSpread({},t),{},_defineProperty({},n,e[n]))}),{}))}}]),t}(Ru);Tc.availableFonts={},Tc.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var Ec=Tc,Oc=function(e){function t(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),(n=_callSuper(this,t,[kr.EMPTY]))._text=null,n._style=null,n._autoResolution=!0,n.localStyleID=-1,n.dirty=!1,n._updateID=0,n.ownsStyle=!1;var o=new Image,a=kr.from(o,{scaleMode:Q.SCALE_MODE,resourceOptions:{autoLoad:!1}});a.orig=new Cn,a.trim=new Cn,n.texture=a;var s="http://www.w3.org/2000/svg",u="http://www.w3.org/1999/xhtml",c=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),h=document.createElementNS(u,"div"),f=document.createElementNS(u,"style");return l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",c.appendChild(l),n.maxWidth=t.defaultMaxWidth,n.maxHeight=t.defaultMaxHeight,n._domElement=h,n._styleElement=f,n._svgRoot=c,n._foreignObject=l,n._foreignObject.appendChild(f),n._foreignObject.appendChild(h),n._image=o,n._loadImage=new Image,n._autoResolution=t.defaultAutoResolution,n._resolution=null!==(e=t.defaultResolution)&&void 0!==e?e:Q.RESOLUTION,n.text=r,n.style=i,n}return _inherits(t,e),_createClass(t,[{key:"measureText",value:function(e){var t,n,r=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e),i=r.text,o=r.style,a=r.resolution;Object.assign(this._domElement,{innerHTML:i,style:o.toCSS(a)}),this._styleElement.textContent=o.toGlobalCSS(),document.body.appendChild(this._svgRoot);var s=this._domElement.getBoundingClientRect();this._svgRoot.remove();var u=s.width,c=s.height;(u>this.maxWidth||c>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");var l=Math.min(this.maxWidth,Math.ceil(u)),h=Math.min(this.maxHeight,Math.ceil(c));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",h.toString()),i!==this._text&&(this._domElement.innerHTML=this._text),o!==this._style&&(Object.assign(this._domElement,{style:null===(t=this._style)||void 0===t?void 0:t.toCSS(a)}),this._styleElement.textContent=null===(n=this._style)||void 0===n?void 0:n.toGlobalCSS()),{width:l+2*o.padding,height:h+2*o.padding}}},{key:"updateText",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,i,o,a,s,u,c=this,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(l.length>0&&void 0!==l[0])||l[0],n=this.style,r=this._image,i=this._loadImage,this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!t){e.next=4;break}return e.abrupt("return");case 4:return o=this.measureText(),a=o.width,s=o.height,r.width=i.width=Math.ceil(Math.max(1,a)),r.height=i.height=Math.ceil(Math.max(1,s)),this._updateID++,u=this._updateID,e.next=9,new Promise((function(e){i.onload=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=u<c._updateID,t.t0){t.next=8;break}return t.next=4,n.onBeforeDraw();case 4:r.src=i.src,i.onload=null,i.src="",c.updateTexture();case 8:e();case 9:case"end":return t.stop()}}),t)})));var t=(new XMLSerializer).serializeToString(c._svgRoot);i.src="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(t))}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"source",get:function(){return this._image}},{key:"updateTexture",value:function(){var e=this.style,t=this.texture,n=this._image,r=this.resolution,i=e.padding,o=t.baseTexture;t.trim.width=t._frame.width=n.width/r,t.trim.height=t._frame.height=n.height/r,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-2*i,t.orig.height=t._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(n.width,n.height,r),this.dirty=!1}},{key:"_render",value:function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),_get(_getPrototypeOf(t.prototype),"_render",this).call(this,e)}},{key:"_renderCanvas",value:function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),_get(_getPrototypeOf(t.prototype),"_renderCanvas",this).call(this,e)}},{key:"getLocalBounds",value:function(e){return this.updateText(!0),_get(_getPrototypeOf(t.prototype),"getLocalBounds",this).call(this,e)}},{key:"_calculateBounds",value:function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}},{key:"_onStyleChange",value:function(){this.dirty=!0}},{key:"destroy",value:function(e){var n,r,i,o,a;"boolean"==typeof e&&(e={children:e}),e=Object.assign({},t.defaultDestroyOptions,e),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this,e);var s=null;this.ownsStyle&&null!==(n=this._style)&&void 0!==n&&n.cleanFonts(),this._style=s,null!==(r=this._svgRoot)&&void 0!==r&&r.remove(),this._svgRoot=s,null!==(i=this._domElement)&&void 0!==i&&i.remove(),this._domElement=s,null!==(o=this._foreignObject)&&void 0!==o&&o.remove(),this._foreignObject=s,null!==(a=this._styleElement)&&void 0!==a&&a.remove(),this._styleElement=s,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=s,this._image.src="",this._image=s}},{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution},set:function(e){this.updateText(!0);var t=St(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution},set:function(e){this.updateText(!0);var t=St(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}},{key:"style",get:function(){return this._style},set:function(e){this._style!==e&&((e=e||{})instanceof Ec?(this.ownsStyle=!1,this._style=e):e instanceof Ru?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ec.from(e)):(this.ownsStyle=!0,this._style=new Ec(e)),this.localStyleID=-1,this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(e){e=String(""===e||null==e?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}},{key:"sanitiseText",value:function(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}}]),t}(go);Oc.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Oc.defaultMaxWidth=2024,Oc.defaultMaxHeight=2024,Oc.defaultAutoResolution=!0;var Pc=Oc,Rc=__nested_webpack_require_1427617__(3444),Bc=function(){var e=null;return function(){if(null!==e)return e;var t=new Blob(['(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'],{type:"application/javascript; charset=utf-8"}),n=URL.createObjectURL(t);return e=function(e){var t=new Map([[0,function(){}]]),n=new Map([[0,function(){}]]),r=new Map,i=new Worker(e);return i.addEventListener("message",(function(e){var i,o=e.data;if(void 0!==(i=o).method&&"call"===i.method){var a=o.params,s=a.timerId,u=a.timerType;if("interval"===u){var c=t.get(s);if("number"==typeof c){var l=r.get(c);if(void 0===l||l.timerId!==s||l.timerType!==u)throw new Error("The timer is in an undefined state.")}else{if(void 0===c)throw new Error("The timer is in an undefined state.");c()}}else if("timeout"===u){var h=n.get(s);if("number"==typeof h){var f=r.get(h);if(void 0===f||f.timerId!==s||f.timerType!==u)throw new Error("The timer is in an undefined state.")}else{if(void 0===h)throw new Error("The timer is in an undefined state.");h(),n.delete(s)}}}else{if(!function(e){return null===e.error&&"number"==typeof e.id}(o)){var d=o.error.message;throw new Error(d)}var p=o.id,y=r.get(p);if(void 0===y)throw new Error("The timer is in an undefined state.");var g=y.timerId,m=y.timerType;r.delete(p),"interval"===m?t.delete(g):n.delete(g)}})),{clearInterval:function(e){var n=(0,Rc.generateUniqueNumber)(r);r.set(n,{timerId:e,timerType:"interval"}),t.set(e,n),i.postMessage({id:n,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var t=(0,Rc.generateUniqueNumber)(r);r.set(t,{timerId:e,timerType:"timeout"}),n.set(e,t),i.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(0,Rc.generateUniqueNumber)(t);return t.set(r,(function(){e(),"function"==typeof t.get(r)&&i.postMessage({id:null,method:"set",params:{delay:n,now:performance.now(),timerId:r,timerType:"interval"}})})),i.postMessage({id:null,method:"set",params:{delay:n,now:performance.now(),timerId:r,timerType:"interval"}}),r},setTimeout:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(0,Rc.generateUniqueNumber)(n);return n.set(r,e),i.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:r,timerType:"timeout"}}),r}}}(n),setTimeout((function(){return URL.revokeObjectURL(n)})),e}}(),Dc=function(e){return Bc().clearTimeout(e)},Mc=function(){var e;return(e=Bc()).setTimeout.apply(e,arguments)};function Lc(e){return Lc="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Lc(e)}function Fc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Nc(r.key),r)}}function Nc(e){var t=function(e){if("object"!=Lc(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Lc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Lc(t)?t:String(t)}function Uc(e,t){if(t&&("object"===Lc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jc=function(){return!!e})()}function Gc(e){return Gc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gc(e)}function zc(e,t){return zc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zc(e,t)}var Hc=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=Gc(t),Uc(e,jc()?Reflect.construct(t,n||[],Gc(e).constructor):t.apply(e,n))}(this,t)).shouldBeDestroed=!0,e?(n.texture=e instanceof kr?e:kr.from(e),n):(n.texture=new kr(new un),Uc(n))}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zc(e,t)}(t,e),n=t,r=[{key:"get",value:function(){return this.texture}},{key:"update",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return this.texture.update(),void this.emit("update",this);this.texture&&this.shouldBeDestroed&&this.texture.destroy(!0),this.texture=e instanceof kr?e:kr.from(e),this.shouldBeDestroed=t,this.emit("replace",this)}},{key:"destroy",value:function(){this.texture&&this.texture.destroy(!0),this.removeAllListeners()}}],r&&Fc(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(i);function Vc(e){return Vc="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Vc(e)}function Wc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$c(r.key),r)}}function $c(e){var t=function(e){if("object"!=Vc(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Vc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Vc(t)?t:String(t)}function Yc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Yc=function(){return!!e})()}function Kc(e){return Kc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kc(e)}function Xc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zc(e,t){return Zc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zc(e,t)}var qc=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=Kc(t),function(e,t){if(t&&("object"===Vc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Xc(e)}(e,Yc()?Reflect.construct(t,n||[],Kc(e).constructor):t.apply(e,n))}(this,t)).active="origin",r.textures=new Map,r.buffers=new Map,e instanceof Hc?(r.frame=new go(e.get()),r.textures.set("origin",e.get()),e.on("replace",r.onReplace,Xc(r))):(r.frame=new go(e),r.textures.set("origin",e)),r.frame.width=n.width,r.frame.height=n.height,r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zc(e,t)}(t,e),n=t,r=[{key:"onReplace",value:function(e){this.textures.set("origin",e.get()),"origin"==this.active&&(this.frame.texture=e.get())}},{key:"addTexture",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.textures.has(e)&&(r&&(null===(n=this.textures.get(e))||void 0===n||n.destroy(!0)),this.textures.delete(e)),this.textures.set(e,t),!0}},{key:"getTexture",value:function(e){if(this.textures.has(e))return this.textures.get(e);throw new Error("There is no such texture")}},{key:"addBuffer",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.buffers.has(e)&&(n&&(null===(t=this.buffers.get(e))||void 0===t||t.destroy(!0)),this.buffers.delete(e)),this.buffers.set(e,Sr.create({width:this.frame.width,height:this.frame.height})),!0}},{key:"getBuffer",value:function(e){if(this.buffers.has(e))return this.buffers.get(e);throw new Error("There is no such buffer")}},{key:"resize",value:function(e,t){this.frame.width=e,this.frame.height=t,this.buffers.forEach((function(n,r){n.resize(e,t)}))}},{key:"activateBuffer",value:function(e){this.buffers.has(e)&&(this.frame.texture=this.buffers.get(e),this.active=e)}},{key:"activateTexture",value:function(e){this.textures.has(e)&&(this.frame.texture=this.textures.get(e),this.active=e)}}],r&&Wc(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(i);function Jc(e){return Jc="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Jc(e)}function Qc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,el(r.key),r)}}function el(e){var t=function(e){if("object"!=Jc(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Jc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jc(t)?t:String(t)}qc.defaultOptions={width:100,height:100};var tl=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state="pending",this.fate="unresolved",this.promise=new Promise((function(e,n){t._resolve=e,t._reject=n})),this.promise.then((function(){return t.state="fulfilled"}),(function(){return t.state="rejected"}))}var t,n;return t=e,(n=[{key:"resolve",value:function(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._resolve(e)}},{key:"reject",value:function(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._reject(e)}},{key:"isResolved",value:function(){return"resolved"===this.fate}},{key:"isPending",value:function(){return"pending"===this.state}},{key:"isFulfilled",value:function(){return"fulfilled"===this.state}},{key:"isRejected",value:function(){return"rejected"===this.state}}])&&Qc(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function nl(e){return nl="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},nl(e)}function rl(){rl=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==nl(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(nl(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function il(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function ol(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){il(o,r,i,a,s,"next",e)}function s(e){il(o,r,i,a,s,"throw",e)}a(void 0)}))}}function al(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,sl(r.key),r)}}function sl(e){var t=function(e){if("object"!=nl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=nl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nl(t)?t:String(t)}function ul(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ul=function(){return!!e})()}function cl(){return cl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ll(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},cl.apply(this,arguments)}function ll(e){return ll=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ll(e)}function hl(e,t){return hl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hl(e,t)}var fl=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=ll(t),function(e,t){if(t&&("object"===nl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ul()?Reflect.construct(t,n||[],ll(e).constructor):t.apply(e,n))}(this,t,[e])).inprocess=!1,n.duration=30,n.textures=[],n.inputVideo=document.createElement("video"),n.duration=1e3/n.fpsLimit,n}var n,i,o,a,s,u,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hl(e,t)}(t,e),n=t,i=[{key:"onTrackUpdate",value:function(){cl(ll(t.prototype),"onTrackUpdate",this).call(this),this.videoFrame&&this.videoFrame.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"setFpsLimit",value:function(e){this.fpsLimit=e,this.duration=1e3/this.fpsLimit}},{key:"setRenderer",value:function(e){this.renderer=e}},{key:"destroy",value:function(){this.stopTimers()}},{key:"clearBuffers",value:function(){this.effectProcessor.clearBuffers()}},{key:"stopTimers",value:function(){try{this.gatherFramesTimeout&&(Dc(this.gatherFramesTimeout),this.gatherFramesTimeout=0),this.handleFramesTimeout&&(Dc(this.handleFramesTimeout),this.handleFramesTimeout=0),this.gatherFramesInterval&&(e=this.gatherFramesInterval,Bc().clearInterval(e),this.gatherFramesInterval=0)}catch(e){}var e}},{key:"startTimers",value:function(){var e=this;this.gatherFramesInterval=function(){var e;return(e=Bc()).setInterval.apply(e,arguments)}((function(){e.gatherByTimers()}),this.duration),this.gatherByCallback(),this.handleFrames()}},{key:"gatherByCallback",value:(c=ol(rl().mark((function e(){return rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"gatherByTimers",value:(u=ol(rl().mark((function e(){return rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.hidden&&this.gatherFrames();case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"gatherFrames",value:(s=ol(rl().mark((function e(){var t,n;return rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.textures.length>3&&(null==(t=this.textures.shift())||t.destroy(!0)),this.videoTexture&&(this.videoTexture.update(),n=Sr.create({width:this.sdkOptions.width,height:this.sdkOptions.height}),this.renderer.renderTo(this.videoFrame.frame,n),this.textures.push(n));case 2:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"nextTick",value:(a=ol(rl().mark((function e(){var t,n;return rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.frameDrawFunction)||void 0===t||t.call(this),this.frame_count++,this.videoTrackWrapper.update(this.inputVideo.videoWidth,this.inputVideo.videoHeight),this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=8,this.effectProcessor.process();case 8:this.drawFps(),this.toCanvas&&(null===(n=this.toCanvas.getContext("2d"))||void 0===n||n.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height));case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"handleFrames",value:(o=ol(rl().mark((function e(){var t,n,r,i=this;return rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.textures.length){e.next=2;break}return e.abrupt("return",this.handleFramesTimeout=Mc((function(){i.handleFrames()}),10));case 2:if(n=performance.now(),this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=10;break}return this.textures=[],this.renderer.addToEffects(this.videoFrame.frame),this.renderer.render(),this.renderer.removeFromEffects(this.videoFrame.frame),this.toCanvas&&(null===(t=this.toCanvas.getContext("2d"))||void 0===t||t.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height)),e.abrupt("return",this.handleFramesTimeout=Mc((function(){i.handleFrames()}),Math.max(0,this.duration-(performance.now()-n))));case 10:if(r=this.textures.shift(),this.effectProcessor.nextFrame(new Hc(r)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=15;break}return e.next=15,this.onProcessPromise.promise;case 15:return this.onProcessPromise=new tl,this.nextTick().then((function(){i.onProcessPromise.resolve()})),e.abrupt("return",this.handleFramesTimeout=Mc((function(){i.handleFrames()}),0));case 18:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"process",value:function(){var e=this;if(this.stopTimers(),this.getInputVideoTrack()){var t=this.getInputVideoStream();t&&(this.inputVideo.srcObject=t,this.inputVideo.muted=!0,this.inputVideo.setAttribute("playsinline",!0),this.inputVideo.playsInline=!0,this.inputVideo.play().then((function(){e.videoTexture=new Hc(e.inputVideo),e.videoFrame=new qc(e.videoTexture,{width:e.sdkOptions.width,height:e.sdkOptions.height})}))),this.startTimers()}else r.ie.notify({message:"there is no videoTrack to process",emitter:r.E7.SRTEAM_PROCESSOR})}},{key:"getInputVideoStream",value:function(){return this.stream?this.stream:null}},{key:"getStream",value:function(){var e=this;return this.outputStream||(this.outputStream=this.renderer.renderer.view.captureStream(30),this.outputStream.getVideoTracks()[0].getSettings=function(){return e.videoTrackWrapper.getSettings()},this.outputStream.getVideoTracks()[0].getConstraints=function(){return e.videoTrackWrapper.getConstraints()},this.outputStream.getVideoTracks()[0].getCapabilities=function(){return e.videoTrackWrapper.getCapabilities()},this.outputStream.getVideoTracks()[0].applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t)},this.stream&&this.stream.getAudioTracks().forEach((function(t,n){e.outputStream.addTrack(t)}))),this.outputStream}}],i&&al(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(P);function dl(e){return dl="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},dl(e)}function pl(){pl=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==dl(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(dl(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function yl(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function gl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ml(r.key),r)}}function ml(e){var t=function(e){if("object"!=dl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=dl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==dl(t)?t:String(t)}function vl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(vl=function(){return!!e})()}function wl(){return wl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bl(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},wl.apply(this,arguments)}function bl(e){return bl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bl(e)}function xl(e,t){return xl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xl(e,t)}var _l=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=bl(t),function(e,t){if(t&&("object"===dl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vl()?Reflect.construct(t,n||[],bl(e).constructor):t.apply(e,n))}(this,t,[e])).timing=performance.now(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xl(e,t)}(t,e),n=t,r=[{key:"gatherByCallback",value:(i=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){yl(o,r,i,a,s,"next",e)}function s(e){yl(o,r,i,a,s,"throw",e)}a(void 0)}))}}(pl().mark((function e(){var t=this;return pl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.requestAnimationFrameID=window.requestAnimationFrame((function(){return t.gatherByCallback()}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"stopTimers",value:function(){if(wl(bl(t.prototype),"stopTimers",this).call(this),this.requestAnimationFrameID)try{cancelAnimationFrame(this.requestAnimationFrameID),this.requestAnimationFrameID=0}catch(e){}}}],r&&gl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(fl);function Il(e){return Il="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Il(e)}function Al(){Al=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Il(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Il(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Cl(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function kl(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Cl(o,r,i,a,s,"next",e)}function s(e){Cl(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Sl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tl(r.key),r)}}function Tl(e){var t=function(e){if("object"!=Il(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Il(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Il(t)?t:String(t)}function El(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(El=function(){return!!e})()}function Ol(e){return Ol=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ol(e)}function Pl(e,t){return Pl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pl(e,t)}var Rl=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=Ol(t),function(e,t){if(t&&("object"===Il(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,El()?Reflect.construct(t,n||[],Ol(e).constructor):t.apply(e,n))}(this,t,[e])).frameTimes=[],n.aborter=new AbortController,n}var n,i,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pl(e,t)}(t,e),n=t,i=[{key:"clearBuffers",value:function(){this.effectProcessor.clearBuffers()}},{key:"destroy",value:function(){this.outputStream&&this.outputStream.getTracks().forEach((function(e){e.stop()})),this.aborter.abort("stream_processor is destroyed")}},{key:"nextTick",value:(a=kl(Al().mark((function e(t,n){var i,o,a,s,u,c,l;return Al().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(i=this.frameDrawFunction)||void 0===i||i.call(this),this.videoTrackWrapper.update(t.displayWidth,t.displayHeight),this.frame_count++,this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=8,this.effectProcessor.process();case 8:this.drawFps();try{c=this.renderer.getVideoFrameSettings(),l=this.renderer.getVideoFrameData(),u=new VideoFrame(l,Object.assign({duration:this.frameTimer.getFrameDuration(),timestamp:t.timestamp},c)),t.close();try{n.enqueue(u)}catch(e){r.ie.notify({message:null!==(o=e.message)&&void 0!==o?o:e,emitter:r.E7.SRTEAM_PROCESSOR,cause:e}),u.close()}this.toCanvas&&(null===(a=this.toCanvas.getContext("2d"))||void 0===a||a.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height))}catch(e){r.ie.notify({message:null!==(s=e.message)&&void 0!==s?s:e,emitter:r.E7.SRTEAM_PROCESSOR,cause:e}),t.close()}case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"handleFrames",value:(o=kl(Al().mark((function e(t,n){var r,i=this;return Al().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=3;break}try{n.enqueue(t),this.toCanvas&&(null===(r=this.toCanvas.getContext("2d"))||void 0===r||r.drawImage(t,0,0,this.toCanvas.width,this.toCanvas.height))}catch(e){t.close()}return e.abrupt("return");case 3:if(this.effectProcessor.nextFrame(new Hc(t)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=7;break}return e.next=7,this.onProcessPromise.promise;case 7:this.onProcessPromise=new tl,this.nextTick(t,n).then((function(){i.onProcessPromise.resolve()}));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"process",value:function(){var e=this,t=this.getInputVideoTrack();if(t){this.outputVideoTrack=new MediaStreamTrackGenerator({kind:"video"}),this.outputVideoTrack.getSettings=function(){return e.videoTrackWrapper.getSettings()},this.outputVideoTrack.getConstraints=function(){return e.videoTrackWrapper.getConstraints()},this.outputVideoTrack.getCapabilities=function(){return e.videoTrackWrapper.getCapabilities()},this.outputVideoTrack.applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t)},this.outputStream&&this.outputStream.getTracks().forEach((function(e){e.stop()})),this.outputStream=new MediaStream([this.outputVideoTrack]),this.stream&&this.stream.getAudioTracks().forEach((function(t,n){e.outputStream.addTrack(t)})),this.trackProcessor=new MediaStreamTrackProcessor({track:t,maxBufferSize:4}),this.timestamp=performance.now();var n=this,i=new TransformStream({transform:function(e,t){return kl(Al().mark((function r(){return Al().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.handleFrames(e,t);case 2:case"end":return r.stop()}}),r)})))()}});this.trackProcessor.readable.pipeThrough(i,{signal:this.aborter.signal}).pipeTo(this.outputVideoTrack.writable).catch((function(e){var t;r.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:r.E7.SRTEAM_PROCESSOR,cause:e})}))}else r.ie.notify({message:"there is no videoTrack to process",emitter:r.E7.SRTEAM_PROCESSOR})}},{key:"getStream",value:function(){return this.outputStream}}],i&&Sl(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(P);function Bl(e){return Bl="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Bl(e)}function Dl(){Dl=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Bl(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Bl(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Ml(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fl(r.key),r)}}function Fl(e){var t=function(e){if("object"!=Bl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Bl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Bl(t)?t:String(t)}function Nl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Nl=function(){return!!e})()}function Ul(){return Ul="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jl(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Ul.apply(this,arguments)}function jl(e){return jl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jl(e)}function Gl(e,t){return Gl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gl(e,t)}var zl=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=jl(t),function(e,t){if(t&&("object"===Bl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Nl()?Reflect.construct(t,n||[],jl(e).constructor):t.apply(e,n))}(this,t,[e])).timing=performance.now(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gl(e,t)}(t,e),n=t,r=[{key:"gatherByCallback",value:(i=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ml(o,r,i,a,s,"next",e)}function s(e){Ml(o,r,i,a,s,"throw",e)}a(void 0)}))}}(Dl().mark((function e(){var t=this;return Dl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.gatherFramesTimeout=setTimeout((function(){t.inputVideo.requestVideoFrameCallback((function(){return t.gatherByCallback()}))}),0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"stopTimers",value:function(){if(Ul(jl(t.prototype),"stopTimers",this).call(this),this.requestVideoFrameID)try{this.inputVideo.cancelVideoFrameCallback(this.requestVideoFrameID),this.requestVideoFrameID=0}catch(e){}}}],r&&Ll(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(fl);function Hl(e){return Hl="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Hl(e)}function Vl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Wl(r.key),r)}}function Wl(e){var t=function(e){if("object"!=Hl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Hl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Hl(t)?t:String(t)}var $l,Yl,Kl,Xl,Zl,ql,Jl,Ql,eh,th,nh,rh,ih,oh,ah,sh,uh,ch,lh,hh,fh,dh,ph,yh,gh,mh,vh,wh,bh,xh,_h,Ih={transform:Rl,videocallback:zl,animationcallback:_l},Ah=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"getStreamProcessor",value:function(e,t){return new Ih[e](t)}}],null&&Vl(t.prototype,null),n&&Vl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ch=__nested_webpack_require_1427617__(1472),kh=__nested_webpack_require_1427617__(6512),Sh=__nested_webpack_require_1427617__(3296).Sn,Th=Object.defineProperty,Eh=Object.getOwnPropertyDescriptor,Oh=Object.getOwnPropertyNames,Ph=Object.prototype.hasOwnProperty,Rh=function(e){return _typeof(__webpack_require__(2805))<"u"?__webpack_require__(2805):("undefined"===typeof Proxy?"undefined":_typeof(Proxy))<"u"?new Proxy(e,{get:function(e,t){return(_typeof(__webpack_require__(2805))<"u"?__webpack_require__(2805):e)[t]}}):e}((function(e){if(_typeof(__webpack_require__(2805))<"u")return __webpack_require__(2805).apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')})),Bh=function(e,t){return function(){return e&&(t=e(e=0)),t}},Dh=function(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports}},Mh=function(e,t){for(var n in t)Th(e,n,{get:t[n],enumerable:!0})},Lh=function(e){return function(e,t,n,r){if(t&&"object"==_typeof(t)||"function"==typeof t){var i,o=_createForOfIteratorHelper(Oh(t));try{var a=function(){var n=i.value;!Ph.call(e,n)&&undefined!==n&&Th(e,n,{get:function(){return t[n]},enumerable:!(r=Eh(t,n))||r.enumerable})};for(o.s();!(i=o.n()).done;)a()}catch(s){o.e(s)}finally{o.f()}}return e}(Th({},"__esModule",{value:!0}),e)},Fh=Bh((function(){$l=new Map,Yl=[],Kl=function(e,t,n){if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");var r=$l.get(e);if(void 0===r)$l.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error('cannot register backend "'.concat(e,'" using priority ').concat(n))}if(n>=0){var i=Yl.indexOf(e);-1!==i&&Yl.splice(i,1);for(var o=0;o<Yl.length;o++)if($l.get(Yl[o]).priority<=n)return void Yl.splice(o,0,e);Yl.push(e)}},Xl=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o,a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0===t.length?Yl:t,r=[],i=_createForOfIteratorHelper(n),e.prev=2,i.s();case 4:if((o=i.n()).done){e.next=29;break}if(a=o.value,!(s=$l.get(a))){e.next=27;break}if(!s.initialized){e.next=10;break}return e.abrupt("return",s.backend);case 10:if(!s.aborted){e.next=12;break}return e.abrupt("continue",27);case 12:return u=!!s.initPromise,e.prev=13,u||(s.initPromise=s.backend.init(a)),e.next=17,s.initPromise;case 17:return s.initialized=!0,e.abrupt("return",s.backend);case 21:e.prev=21,e.t0=e.catch(13),u||r.push({name:a,err:e.t0}),s.aborted=!0;case 24:return e.prev=24,delete s.initPromise,e.finish(24);case 27:e.next=4;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(2),i.e(e.t1);case 34:return e.prev=34,i.f(),e.finish(34);case 37:throw new Error("no available backend found. ERR: ".concat(r.map((function(e){return"[".concat(e.name,"] ").concat(e.err)})).join(", ")));case 38:case"end":return e.stop()}}),e,null,[[2,31,34,37],[13,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()})),Nh=Bh((function(){Fh()})),Uh=Bh((function(){Zl="1.17.0"})),jh=Bh((function(){Uh(),ql="warning",Jl={wasm:{},webgl:{},webgpu:{},versions:{common:Zl},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error("Unsupported logging level: ".concat(e));ql=e}},get logLevel(){return ql}},Object.defineProperty(Jl,"logLevel",{enumerable:!0})})),Gh=Bh((function(){jh(),Ql=Jl})),zh=Bh((function(){eh=function(e,t){var n=("undefined"===typeof document?"undefined":_typeof(document))<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];var r=n.getContext("2d");if(null!=r){var i,o;void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);var a,s,u=void 0!==(null===t||void 0===t?void 0:t.format)?t.format:"RGB",c=null===t||void 0===t?void 0:t.norm;void 0===c||void 0===c.mean?a=[255,255,255,255]:"number"==typeof c.mean?a=[c.mean,c.mean,c.mean,c.mean]:(a=[c.mean[0],c.mean[1],c.mean[2],0],void 0!==c.mean[3]&&(a[3]=c.mean[3])),void 0===c||void 0===c.bias?s=[0,0,0,0]:"number"==typeof c.bias?s=[c.bias,c.bias,c.bias,c.bias]:(s=[c.bias[0],c.bias[1],c.bias[2],0],void 0!==c.bias[3]&&(s[3]=c.bias[3]));var l=o*i,h=0,f=l,d=2*l,p=-1;"RGBA"===u?(h=0,f=l,d=2*l,p=3*l):"RGB"===u?(h=0,f=l,d=2*l):"RBG"===u&&(h=0,d=l,f=2*l);for(var y=0;y<o;y++)for(var g=0;g<i;g++){var m=(e.data[h++]-s[0])*a[0],v=(e.data[f++]-s[1])*a[1],w=(e.data[d++]-s[2])*a[2],b=-1===p?255:(e.data[p++]-s[3])*a[3];r.fillStyle="rgba("+m+","+v+","+w+","+b+")",r.fillRect(g,y,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},th=function(e,t){var n,r,i,o,a=("undefined"===typeof document?"undefined":_typeof(document))<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==a)throw new Error("Can not access image data");void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(r=e.dims[2],i=e.dims[1],o=e.dims[3]):(r=e.dims[3],i=e.dims[2],o=e.dims[1]);var s,u,c=void 0!==t&&void 0!==t.format?t.format:"RGB",l=null===t||void 0===t?void 0:t.norm;void 0===l||void 0===l.mean?s=[255,255,255,255]:"number"==typeof l.mean?s=[l.mean,l.mean,l.mean,l.mean]:(s=[l.mean[0],l.mean[1],l.mean[2],255],void 0!==l.mean[3]&&(s[3]=l.mean[3])),void 0===l||void 0===l.bias?u=[0,0,0,0]:"number"==typeof l.bias?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(u[3]=l.bias[3]));var h=i*r;if(void 0!==t&&(void 0!==t.format&&4===o&&"RGBA"!==t.format||3===o&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");var f=0,d=1,p=2,y=3,g=0,m=h,v=2*h,w=-1;"RGBA"===c?(g=0,m=h,v=2*h,w=3*h):"RGB"===c?(g=0,m=h,v=2*h):"RBG"===c&&(g=0,v=h,m=2*h),n=a.createImageData(r,i);for(var b=0;b<i*r;f+=4,d+=4,p+=4,y+=4,b++)n.data[f]=(e.data[g++]-u[0])*s[0],n.data[d]=(e.data[m++]-u[1])*s[1],n.data[p]=(e.data[v++]-u[2])*s[2],n.data[y]=-1===w?255:(e.data[w++]-u[3])*s[3];return n}})),Hh=Bh((function(){$h(),nh=function(e,t){var n,r,i;if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");var o,a,s=t.height,u=t.width,c=null!==(n=t.norm)&&void 0!==n?n:{mean:255,bias:0};o="number"==typeof c.mean?[c.mean,c.mean,c.mean,c.mean]:[c.mean[0],c.mean[1],c.mean[2],null!==(r=c.mean[3])&&void 0!==r?r:255],a="number"==typeof c.bias?[c.bias,c.bias,c.bias,c.bias]:[c.bias[0],c.bias[1],c.bias[2],null!==(i=c.bias[3])&&void 0!==i?i:0];var l=void 0!==t.format?t.format:"RGBA",h=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",f=s*u,d="RGBA"===h?new Float32Array(4*f):new Float32Array(3*f),p=4,y=0,g=1,m=2,v=3,w=0,b=f,x=2*f,_=-1;"RGB"===l&&(p=3,y=0,g=1,m=2,v=-1),"RGBA"===h?_=3*f:"RBG"===h?(w=0,x=f,b=2*f):"BGR"===h&&(x=0,b=f,w=2*f);for(var I=0;I<f;I++,y+=p,m+=p,g+=p,v+=p)d[w++]=(e[y]+a[0])/o[0],d[b++]=(e[g]+a[1])/o[1],d[x++]=(e[m]+a[2])/o[2],-1!==_&&-1!==v&&(d[_++]=(e[v]+a[3])/o[3]);return new dh("float32",d,"RGBA"===h?[1,4,s,u]:[1,3,s,u])},rh=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=("undefined"===typeof HTMLImageElement?"undefined":_typeof(HTMLImageElement))<"u"&&t instanceof HTMLImageElement,o=("undefined"===typeof ImageData?"undefined":_typeof(ImageData))<"u"&&t instanceof ImageData,a=("undefined"===typeof ImageBitmap?"undefined":_typeof(ImageBitmap))<"u"&&t instanceof ImageBitmap,s="string"==typeof t,u=null!==n&&void 0!==n?n:{},c=function(){if(("undefined"===typeof document?"undefined":_typeof(document))<"u")return document.createElement("canvas");if(("undefined"===typeof OffscreenCanvas?"undefined":_typeof(OffscreenCanvas))<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=function(e){return e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null},!i){e.next=18;break}if((h=c()).width=t.width,h.height=t.height,null!=(f=l(h))){e.next=7;break}throw new Error("Can not access image data");case 7:if(d=t.height,p=t.width,void 0!==n&&void 0!==n.resizedHeight&&void 0!==n.resizedWidth&&(d=n.resizedHeight,p=n.resizedWidth),void 0===n){e.next=14;break}if(u=n,void 0===n.tensorFormat){e.next=11;break}throw new Error("Image input config format must be RGBA for HTMLImageElement");case 11:u.tensorFormat="RGBA",u.height=d,u.width=p,e.next=15;break;case 14:u.tensorFormat="RGBA",u.height=d,u.width=p;case 15:f.drawImage(t,0,0),r=f.getImageData(0,0,p,d).data,e.next=42;break;case 18:if(o){e.next=32;break}if(!a){e.next=29;break}if(void 0!==n){e.next=22;break}throw new Error("Please provide image config with format for Imagebitmap");case 22:if((y=c()).width=t.width,y.height=t.height,null==(g=l(y))){e.next=28;break}return m=t.height,v=t.width,e.abrupt("return",(g.drawImage(t,0,0,v,m),r=g.getImageData(0,0,v,m).data,u.height=m,u.width=v,nh(r,u)));case 28:throw new Error("Can not access image data");case 29:if(!s){e.next=31;break}return e.abrupt("return",new Promise((function(e,n){var r=c(),i=l(r);if(!t||!i)return n();var o=new Image;o.crossOrigin="Anonymous",o.src=t,o.onload=function(){r.width=o.width,r.height=o.height,i.drawImage(o,0,0,r.width,r.height);var t=i.getImageData(0,0,r.width,r.height);u.height=r.height,u.width=r.width,e(nh(t.data,u))}})));case 31:throw new Error("Input data provided is not supported - aborted tensor creation");case 32:if(void 0!==n&&void 0!==n.resizedWidth&&void 0!==n.resizedHeight?(w=n.resizedHeight,b=n.resizedWidth):(w=t.height,b=t.width),void 0!==n&&(u=n),u.format="RGBA",u.height=w,u.width=b,void 0===n){e.next=41;break}if((x=c()).width=b,x.height=w,null!=(_=l(x))){e.next=38;break}throw new Error("Can not access image data");case 38:_.putImageData(t,0,0),r=_.getImageData(0,0,b,w).data,e.next=42;break;case 41:r=t.data;case 42:if(void 0===r){e.next=44;break}return e.abrupt("return",nh(r,u));case 44:throw new Error("Input data provided is not supported - aborted tensor creation");case 45:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ih=function(e,t){var n=t.width,r=t.height,i=t.download,o=t.dispose;return new dh({location:"texture",type:"float32",texture:e,dims:[1,r,n,4],download:i,dispose:o})},oh=function(e,t){var n=t.dataType,r=t.dims,i=t.download,o=t.dispose;return new dh({location:"gpu-buffer",type:null!==n&&void 0!==n?n:"float32",gpuBuffer:e,dims:r,download:i,dispose:o})},ah=function(e,t,n){return new dh({location:"cpu-pinned",type:e,data:t,dims:null!==n&&void 0!==n?n:[t.length]})}})),Vh=Bh((function(){sh=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),uh=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ch=!1,lh=function(){if(!ch){ch=!0;var e=("undefined"===typeof BigInt64Array?"undefined":_typeof(BigInt64Array))<"u"&&"function"==typeof BigInt64Array.from,t=("undefined"===typeof BigUint64Array?"undefined":_typeof(BigUint64Array))<"u"&&"function"==typeof BigUint64Array.from;e&&(sh.set("int64",BigInt64Array),uh.set(BigInt64Array,"int64")),t&&(sh.set("uint64",BigUint64Array),uh.set(BigUint64Array,"uint64"))}}})),Wh=Bh((function(){$h(),hh=function(e){for(var t=1,n=0;n<e.length;n++){var r=e[n];if("number"!=typeof r||!Number.isSafeInteger(r))throw new TypeError("dims[".concat(n,"] must be an integer, got: ").concat(r));if(r<0)throw new RangeError("dims[".concat(n,"] must be a non-negative integer, got: ").concat(r));t*=r}return t},fh=function(e,t){switch(e.location){case"cpu":return new dh(e.type,e.data,t);case"cpu-pinned":return new dh({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new dh({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new dh({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error("tensorReshape: tensor location ".concat(e.location," is not supported"))}}})),$h=Bh((function(){zh(),Hh(),Vh(),Wh(),dh=function(){function e(t,n,r){var i,o;if(_classCallCheck(this,e),lh(),"object"==_typeof(t)&&"location"in t)switch(this.dataLocation=t.location,i=t.type,o=t.dims,t.location){case"cpu-pinned":var a=sh.get(i);if(!a)throw new TypeError('unsupported type "'.concat(i,'" to create tensor from pinned buffer'));if(!(t.data instanceof a))throw new TypeError("buffer should be of type ".concat(a.name));this.cpuData=t.data;break;case"texture":if("float32"!==i)throw new TypeError('unsupported type "'.concat(i,'" to create tensor from texture'));this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break;case"gpu-buffer":if("float32"!==i&&"float16"!==i&&"int32"!==i&&"int64"!==i&&"uint32"!==i&&"bool"!==i)throw new TypeError('unsupported type "'.concat(i,'" to create tensor from gpu buffer'));this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break;default:throw new Error("Tensor constructor: unsupported location '".concat(this.dataLocation,"'"))}else{var s,u;if("string"==typeof t)if(i=t,u=r,"string"===t){if(!Array.isArray(n))throw new TypeError("A string tensor's data must be a string array.");s=n}else{var c=sh.get(t);if(void 0===c)throw new TypeError("Unsupported tensor type: ".concat(t,"."));if(Array.isArray(n)){if("float16"===t)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");s="uint64"===t||"int64"===t?c.from(n,BigInt):c.from(n)}else{if(!(n instanceof c))throw new TypeError("A ".concat(i," tensor's data must be type of ").concat(c));s=n}}else if(u=n,Array.isArray(t)){if(0===t.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");var l=_typeof(t[0]);if("string"===l)i="string",s=t;else{if("boolean"!==l)throw new TypeError("Invalid element type of data array: ".concat(l,"."));i="bool",s=Uint8Array.from(t)}}else{var h=uh.get(t.constructor);if(void 0===h)throw new TypeError("Unsupported type for tensor data: ".concat(t.constructor,"."));i=h,s=t}if(void 0===u)u=[s.length];else if(!Array.isArray(u))throw new TypeError("A tensor's dims must be a number array");o=u,this.cpuData=s,this.dataLocation="cpu"}var f=hh(o);if(this.cpuData&&f!==this.cpuData.length)throw new Error("Tensor's size(".concat(f,") does not match data length(").concat(this.cpuData.length,")."));this.type=i,this.dims=o,this.size=f}return _createClass(e,[{key:"toDataURL",value:function(e){return eh(this,e)}},{key:"toImageData",value:function(e){return th(this,e)}},{key:"data",get:function(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}},{key:"location",get:function(){return this.dataLocation}},{key:"texture",get:function(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}},{key:"gpuBuffer",get:function(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}},{key:"getData",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=(this.ensureValid(),this.dataLocation),e.next="cpu"===e.t0||"cpu-pinned"===e.t0?3:"texture"===e.t0||"gpu-buffer"===e.t0?4:17;break;case 3:return e.abrupt("return",this.data);case 4:if(this.downloader){e.next=6;break}throw new Error("The current tensor is not created with a specified data downloader.");case 6:if(!this.isDownloading){e.next=8;break}throw new Error("The current tensor is being downloaded.");case 8:return e.prev=8,this.isDownloading=!0,e.next=12,this.downloader();case 12:return n=e.sent,e.abrupt("return",(this.downloader=void 0,this.dataLocation="cpu",this.cpuData=n,t&&this.disposer&&(this.disposer(),this.disposer=void 0),n));case 14:return e.prev=14,this.isDownloading=!1,e.finish(14);case 17:throw new Error("cannot get data from location: ".concat(this.dataLocation));case 18:case"end":return e.stop()}}),e,this,[[8,,14,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}},{key:"ensureValid",value:function(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}},{key:"reshape",value:function(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return fh(this,e)}}],[{key:"fromImage",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rh(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fromTexture",value:function(e,t){return ih(e,t)}},{key:"fromGpuBuffer",value:function(e,t){return oh(e,t)}},{key:"fromPinnedBuffer",value:function(e,t,n){return ah(e,t,n)}}]),e}()})),Yh=Bh((function(){$h(),ph=dh})),Kh=Bh((function(){jh(),yh=function(e,t){Jl.wasm.trace&&console.timeStamp("".concat(e,"::ORT::").concat(t))},gh=function(e,t){for(var n,r=(null===(n=(new Error).stack)||void 0===n?void 0:n.split(/\r\n|\r|\n/g))||[],i=!1,o=0;o<r.length;o++){if(i&&!r[o].includes("TRACE_FUNC")){var a="FUNC_".concat(e,"::").concat(r[o].trim().split(" ")[1]);return t&&(a+="::".concat(t)),void yh("CPU",a)}r[o].includes("TRACE_FUNC")&&(i=!0)}},mh=function(e){Jl.wasm.trace&&gh("BEGIN",e)},vh=function(e){Jl.wasm.trace&&gh("END",e)}})),Xh=Bh((function(){Fh(),Yh(),Kh(),wh=function(){function e(t){_classCallCheck(this,e),this.handler=t}return _createClass(e,[{key:"run",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_,I,A,C;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mh(),i={},o={},!("object"!=_typeof(t)||null===t||t instanceof ph||Array.isArray(t))){e.next=4;break}throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");case 4:if(a=!0,"object"!=_typeof(n)){e.next=57;break}if(null!==n){e.next=8;break}throw new TypeError("Unexpected argument[1]: cannot be null.");case 8:if(!(n instanceof ph)){e.next=10;break}throw new TypeError("'fetches' cannot be a Tensor");case 10:if(!Array.isArray(n)){e.next=42;break}if(0!==n.length){e.next=13;break}throw new TypeError("'fetches' cannot be an empty array.");case 13:a=!1,s=_createForOfIteratorHelper(n),e.prev=15,s.s();case 17:if((u=s.n()).done){e.next=26;break}if("string"==typeof(c=u.value)){e.next=21;break}throw new TypeError("'fetches' must be a string array or an object.");case 21:if(-1!==this.outputNames.indexOf(c)){e.next=23;break}throw new RangeError("'fetches' contains invalid output name: ".concat(c,"."));case 23:i[c]=null;case 24:e.next=17;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(15),s.e(e.t0);case 31:return e.prev=31,s.f(),e.finish(31);case 34:if("object"!=_typeof(r)||null===r){e.next=38;break}o=r,e.next=40;break;case 38:if(!(_typeof(r)<"u")){e.next=40;break}throw new TypeError("'options' must be an object.");case 40:e.next=55;break;case 42:l=!1,h=Object.getOwnPropertyNames(n),f=_createForOfIteratorHelper(this.outputNames);try{for(f.s();!(d=f.n()).done;)p=d.value,-1!==h.indexOf(p)&&(null===(y=n[p])||y instanceof ph)&&(l=!0,a=!1,i[p]=y)}catch(k){f.e(k)}finally{f.f()}if(!l){e.next=54;break}if("object"!=_typeof(r)||null===r){e.next=50;break}o=r,e.next=52;break;case 50:if(!(_typeof(r)<"u")){e.next=52;break}throw new TypeError("'options' must be an object.");case 52:e.next=55;break;case 54:o=n;case 55:e.next=59;break;case 57:if(!(_typeof(n)<"u")){e.next=59;break}throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");case 59:g=_createForOfIteratorHelper(this.inputNames),e.prev=60,g.s();case 62:if((m=g.n()).done){e.next=68;break}if(v=m.value,!(_typeof(t[v])>"u")){e.next=66;break}throw new Error("input '".concat(v,"' is missing in 'feeds'."));case 66:e.next=62;break;case 68:e.next=73;break;case 70:e.prev=70,e.t1=e.catch(60),g.e(e.t1);case 73:return e.prev=73,g.f(),e.finish(73);case 76:if(a){w=_createForOfIteratorHelper(this.outputNames);try{for(w.s();!(b=w.n()).done;)x=b.value,i[x]=null}catch(k){w.e(k)}finally{w.f()}}return e.next=79,this.handler.run(t,i,o);case 79:for(A in _=e.sent,I={},_)Object.hasOwnProperty.call(_,A)&&(C=_[A],I[A]=C instanceof ph?C:new ph(C.type,C.data,C.dims));return e.abrupt("return",(vh(),I));case 83:case"end":return e.stop()}}),e,this,[[15,28,31,34],[60,70,73,76]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.handler.dispose());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.configure(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"auth",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.auth(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startProfiling",value:function(){this.handler.startProfiling()}},{key:"endProfiling",value:function(){this.handler.endProfiling()}},{key:"inputNames",get:function(){return this.handler.inputNames}},{key:"outputNames",get:function(){return this.handler.outputNames}}],[{key:"create",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,r,i,o){var a,s,u,c,l,h,f;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(mh(),s={},"string"!=typeof n){t.next=11;break}if(a=n,"object"!=_typeof(r)||null===r){t.next=7;break}s=r,t.next=9;break;case 7:if(!(_typeof(r)<"u")){t.next=9;break}throw new TypeError("'options' must be an object.");case 9:t.next=52;break;case 11:if(!(n instanceof Uint8Array)){t.next=20;break}if(a=n,"object"!=_typeof(r)||null===r){t.next=16;break}s=r,t.next=18;break;case 16:if(!(_typeof(r)<"u")){t.next=18;break}throw new TypeError("'options' must be an object.");case 18:t.next=52;break;case 20:if(n instanceof ArrayBuffer||("undefined"===typeof SharedArrayBuffer?"undefined":_typeof(SharedArrayBuffer))<"u"&&n instanceof SharedArrayBuffer){t.next=22;break}throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");case 22:if(u=n,c=0,l=n.byteLength,"object"!=_typeof(r)||null===r){t.next=27;break}s=r,t.next=51;break;case 27:if("number"!=typeof r){t.next=49;break}if(c=r,Number.isSafeInteger(c)){t.next=30;break}throw new RangeError("'byteOffset' must be an integer.");case 30:if(!(c<0||c>=u.byteLength)){t.next=32;break}throw new RangeError("'byteOffset' is out of range [0, ".concat(u.byteLength,")."));case 32:if(l=n.byteLength-c,"number"!=typeof i){t.next=45;break}if(l=i,Number.isSafeInteger(l)){t.next=35;break}throw new RangeError("'byteLength' must be an integer.");case 35:if(!(l<=0||c+l>u.byteLength)){t.next=37;break}throw new RangeError("'byteLength' is out of range (0, ".concat(u.byteLength-c,"]."));case 37:if("object"!=_typeof(o)||null===o){t.next=41;break}s=o,t.next=43;break;case 41:if(!(_typeof(o)<"u")){t.next=43;break}throw new TypeError("'options' must be an object.");case 43:t.next=47;break;case 45:if(!(_typeof(i)<"u")){t.next=47;break}throw new TypeError("'byteLength' must be a number.");case 47:t.next=51;break;case 49:if(!(_typeof(r)<"u")){t.next=51;break}throw new TypeError("'options' must be an object.");case 51:a=new Uint8Array(u,c,l);case 52:return h=(s.executionProviders||[]).map((function(e){return"string"==typeof e?e:e.name})),t.next=55,Xl(h);case 55:return t.next=57,t.sent.createInferenceSessionHandler(a,s);case 57:return f=t.sent,t.abrupt("return",(vh(),new e(f)));case 59:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()}]),e}()})),Zh=Bh((function(){Xh(),bh=wh})),qh=Bh((function(){})),Jh=Bh((function(){Fh(),Yh(),xh=function(){function e(t,n,r){_classCallCheck(this,e),this.handler=t,this.hasOptimizerModel=n,this.hasEvalModel=r}return _createClass(e,[{key:"trainingInputNames",get:function(){return this.handler.inputNames}},{key:"trainingOutputNames",get:function(){return this.handler.outputNames}},{key:"evalInputNames",get:function(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}},{key:"evalOutputNames",get:function(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}},{key:"typeNarrowingForRunStep",value:function(e,t,n,r,i){var o={},a={};if("object"!=_typeof(n)||null===n||n instanceof ph||Array.isArray(n))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");var s=!0;if("object"==_typeof(r)){if(null===r)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof ph)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(0===r.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;var u,c=_createForOfIteratorHelper(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;if("string"!=typeof l)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(l))throw new RangeError("'fetches' contains invalid output name: ".concat(l,"."));o[l]=null}}catch(_){c.e(_)}finally{c.f()}if("object"==_typeof(i)&&null!==i)a=i;else if(_typeof(i)<"u")throw new TypeError("'options' must be an object.")}else{var h,f=!1,d=Object.getOwnPropertyNames(r),p=_createForOfIteratorHelper(t);try{for(p.s();!(h=p.n()).done;){var y=h.value;if(-1!==d.indexOf(y)){var g=r[y];(null===g||g instanceof ph)&&(f=!0,s=!1,o[y]=g)}}}catch(_){p.e(_)}finally{p.f()}if(f){if("object"==_typeof(i)&&null!==i)a=i;else if(_typeof(i)<"u")throw new TypeError("'options' must be an object.")}else a=r}}else if(_typeof(r)<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");var m,v=_createForOfIteratorHelper(e);try{for(v.s();!(m=v.n()).done;){var w=m.value;if(_typeof(n[w])>"u")throw new Error("input '".concat(w,"' is missing in 'feeds'."))}}catch(_){v.e(_)}finally{v.f()}if(s){var b,x=_createForOfIteratorHelper(t);try{for(x.s();!(b=x.n()).done;){o[b.value]=null}}catch(_){x.e(_)}finally{x.f()}}return[o,a]}},{key:"convertHandlerReturnTypeToMapOfTensors",value:function(e){var t={};for(var n in e)if(Object.hasOwnProperty.call(e,n)){var r=e[n];t[n]=r instanceof ph?r:new ph(r.type,r.data,r.dims)}return t}},{key:"lazyResetGrad",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.lazyResetGrad();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"runTrainStep",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,t,n,r),o=_slicedToArray(i,2),a=o[0],s=o[1],e.next=6,this.handler.runTrainStep(t,a,s);case 6:return u=e.sent,e.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(u));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"runOptimizerStep",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasOptimizerModel){e.next=2;break}throw new Error("This TrainingSession has no OptimizerModel loaded.");case 2:return e.next=4,this.handler.runOptimizerStep(t||{});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"runEvalStep",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasEvalModel){e.next=9;break}return i=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,t,n,r),o=_slicedToArray(i,2),a=o[0],s=o[1],e.next=7,this.handler.runEvalStep(t,a,s);case 7:return u=e.sent,e.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(u));case 9:throw new Error("This TrainingSession has no EvalModel loaded.");case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getParametersSize",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.abrupt("return",this.handler.getParametersSize(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadParametersBuffer",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.getParametersSize(n);case 3:if(r=e.sent,t.length===4*r){e.next=6;break}throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");case 6:return e.abrupt("return",this.handler.loadParametersBuffer(t,n));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getContiguousParameters",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.abrupt("return",this.handler.getContiguousParameters(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.handler.dispose());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"create",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,r){var i,o,a,s,u,c;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.evalModel||"",o=n.optimizerModel||"",s=((a=r||{}).executionProviders||[]).map((function(e){return"string"==typeof e?e:e.name})),t.next=6,Xl(s);case 6:if(!(u=t.sent).createTrainingSessionHandler){t.next=12;break}return t.next=10,u.createTrainingSessionHandler(n.checkpointState,n.trainModel,i,o,a);case 10:return c=t.sent,t.abrupt("return",new e(c,!!n.optimizerModel,!!n.evalModel));case 12:throw new Error("Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.");case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}()})),Qh=Bh((function(){Jh(),_h=xh}));Mh({},{InferenceSession:function(){return bh},TRACE:function(){return yh},TRACE_FUNC_BEGIN:function(){return mh},TRACE_FUNC_END:function(){return vh},Tensor:function(){return ph},TrainingSession:function(){return _h},env:function(){return Ql},registerBackend:function(){return Kl}});var ef=Bh((function(){Nh(),Gh(),Zh(),Yh(),Kh(),qh(),Qh()})),tf={};Mh(tf,{createReadStream:function(){return of},readFile:function(){return nf},readFileSync:function(){return rf}});var nf,rf,of,af=Bh((function(){nf=void 0,rf=void 0,of=void 0})),sf={};Mh(sf,{join:function(){return uf}});var uf,cf=Bh((function(){uf=void 0})),lf=Dh((function(e,t){var n=function(){var e=("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return _typeof(__filename)<"u"&&(e=e||__filename),function(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r;i.ready=new Promise((function(e,r){t=e,n=r})),i.mountExternalData=function(e,t){(i.Ka||(i.Ka=new Map)).set(e,t)},i.unmountExternalData=function(){delete i.Ka},i.jsepInit=function(e,t,n,r,o,a,s,u){i.gb=e,i.Wa=t,i.Ya=n,i.Qa=r,i.Xa=o,i.Ba=a,i.Za=s,i.$a=u,t=function(e,t,n){return function(){for(var r,i,o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var u=de,c=null===(r=t)||void 0===r?void 0:r();a=e.apply(void 0,_toConsumableArray(a));var l=null===(i=t)||void 0===i?void 0:i();return c!==l&&(e=l,n(c),t=n=null),de!=u?new Promise((function(e,t){we={resolve:e,reject:t}})):a}},n=function(t){return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var r,o,a,s,u=arguments;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!i.Ja){n.next=3;break}throw Error("Session already started");case 3:return r=i.Ja={ab:u.length<=0?void 0:u[0],errors:[]},n.next=6,t.apply(void 0,u);case 6:if(o=n.sent,i.Ja===r){n.next=9;break}throw Error("Session mismatch");case 9:if(e.flush(),!(0<(a=r.errors).length)){n.next=17;break}return n.next=14,Promise.all(a);case 14:if(s=(s=n.sent).filter((function(e){return e})),!(0<s.length)){n.next=17;break}throw Error(s.join("\n"));case 17:return n.abrupt("return",o);case 18:return n.prev=18,i.Ja=null,n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[0,,18,21]])})))},i._OrtRun=n(t(i._OrtRun,(function(){return i._OrtRun}),(function(e){return i._OrtRun=e}))),i._OrtRunWithBinding=n(t(i._OrtRunWithBinding,(function(){return i._OrtRunWithBinding}),(function(e){return i._OrtRunWithBinding=e}))),i._OrtBindInput=t(i._OrtBindInput,(function(){return i._OrtBindInput}),(function(e){return i._OrtBindInput=e})),i.jsepRegisterBuffer=function(t,n,r,i){return e.registerBuffer(t,n,r,i)},i.jsepUnregisterBuffers=function(t){e.unregisterBuffers(t)},i.jsepGetBuffer=function(t){return e.getBuffer(t)},i.jsepCreateDownloader=function(t,n,r){return e.createDownloader(t,n,r)}};var o,a,s,u=Object.assign({},i),c="./this.program",l=function(e,t){throw t},h="object"==("undefined"===typeof window?"undefined":_typeof(window)),f="function"==typeof importScripts,d="object"==_typeof(kh)&&"object"==_typeof(kh.versions)&&"string"==typeof kh.versions.node,p="";if(d){var y=(af(),Lh(tf)),g=(cf(),Lh(sf));p=f?g.dirname(p)+"/":__dirname+"/",o=function(e,t){return e=N(e)?new URL(e):g.normalize(e),y.readFileSync(e,t?void 0:"utf8")},s=function(e){return(e=o(e,!0)).buffer||(e=new Uint8Array(e)),e},a=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e=N(e)?new URL(e):g.normalize(e),y.readFile(e,r?void 0:"utf8",(function(e,i){e?n(e):t(r?i.buffer:i)}))},!i.thisProgram&&1<kh.argv.length&&(c=kh.argv[1].replace(/\\/g,"/")),kh.argv.slice(2),l=function(e,t){throw kh.exitCode=e,t},i.inspect=function(){return"[Emscripten Module object]"}}else(h||f)&&(f?p=self.location.href:("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript&&(p=document.currentScript.src),e&&(p=e),p=0!==p.indexOf("blob:")?p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},f&&(s=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var m=console.log.bind(console),v=console.error.bind(console);Object.assign(i,u),u=null,"object"!=("undefined"===typeof WebAssembly?"undefined":_typeof(WebAssembly))&&M("no native wasm support detected");var w,b,x,_,I,A,C,k,S=!1;function T(){var e=w.buffer;i.HEAP8=x=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=_=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=I=new Int32Array(e),i.HEAPU32=A=new Uint32Array(e),i.HEAPF32=C=new Float32Array(e),i.HEAPF64=k=new Float64Array(e)}var E=[],O=[],P=[],R=0,B=null,D=null;function M(e){throw v(e="Aborted("+e+")"),S=!0,b=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var L,F=function(e){return e.startsWith("data:application/octet-stream;base64,")},N=function(e){return e.startsWith("file://")};if(!F(L="ort-wasm-simd.wasm")){var U=L;L=i.locateFile?i.locateFile(U,p):p+U}function j(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function G(e,t,n){return function(e){if(h||f){if("function"==typeof fetch&&!N(e))return fetch(e,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((function(){return j(e)}));if(a)return new Promise((function(t,n){a(e,(function(e){return t(new Uint8Array(e))}),n)}))}return Promise.resolve().then((function(){return j(e)}))}(e).then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(n,(function(e){v("failed to asynchronously prepare wasm: ".concat(e)),M(e)}))}var z,H={898080:function(e,t,n,r){if(_typeof(i)>"u"||!i.Ka)return 1;if((e=X(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ka.get(e)))return 2;if((t>>>=0)+(n>>>=0)>e.byteLength)return 3;try{return _.set(e.subarray(t,t+n),r>>>0>>>0),0}catch(o){return 4}},898581:function(e){return i.Wa(e)},898614:function(e){return i.Ya(e)},898646:function(e,t,n){i.Qa(e,t,n,!0)},898685:function(e,t,n){i.Qa(e,t,n)},898718:function(e){i.Ba("Abs",e,void 0)},898769:function(e){i.Ba("Neg",e,void 0)},898820:function(e){i.Ba("Floor",e,void 0)},898873:function(e){i.Ba("Ceil",e,void 0)},898925:function(e){i.Ba("Reciprocal",e,void 0)},898983:function(e){i.Ba("Sqrt",e,void 0)},899035:function(e){i.Ba("Exp",e,void 0)},899086:function(e){i.Ba("Erf",e,void 0)},899137:function(e){i.Ba("Sigmoid",e,void 0)},899192:function(e){i.Ba("Log",e,void 0)},899243:function(e){i.Ba("Sin",e,void 0)},899294:function(e){i.Ba("Cos",e,void 0)},899345:function(e){i.Ba("Tan",e,void 0)},899396:function(e){i.Ba("Asin",e,void 0)},899448:function(e){i.Ba("Acos",e,void 0)},899500:function(e){i.Ba("Atan",e,void 0)},899552:function(e){i.Ba("Sinh",e,void 0)},899604:function(e){i.Ba("Cosh",e,void 0)},899656:function(e){i.Ba("Asinh",e,void 0)},899709:function(e){i.Ba("Acosh",e,void 0)},899762:function(e){i.Ba("Atanh",e,void 0)},899815:function(e){i.Ba("Tanh",e,void 0)},899867:function(e){i.Ba("Not",e,void 0)},899918:function(e,t,n){i.Ba("Clip",e,{min:t,max:n})},899987:function(e){i.Ba("Clip",e,void 0)},900039:function(e,t){i.Ba("Elu",e,{alpha:t})},900097:function(e){i.Ba("Relu",e,void 0)},900149:function(e,t){i.Ba("LeakyRelu",e,{alpha:t})},900213:function(e,t){i.Ba("ThresholdedRelu",e,{alpha:t})},900283:function(e,t){i.Ba("Cast",e,{to:t})},900341:function(e){i.Ba("Add",e,void 0)},900392:function(e){i.Ba("Sub",e,void 0)},900443:function(e){i.Ba("Mul",e,void 0)},900494:function(e){i.Ba("Div",e,void 0)},900545:function(e){i.Ba("Pow",e,void 0)},900596:function(e){i.Ba("Equal",e,void 0)},900649:function(e){i.Ba("Greater",e,void 0)},900704:function(e){i.Ba("GreaterOrEqual",e,void 0)},900766:function(e){i.Ba("Less",e,void 0)},900818:function(e){i.Ba("LessOrEqual",e,void 0)},900877:function(e,t,n,r,o){i.Ba("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},901036:function(e,t,n,r,o){i.Ba("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},901194:function(e,t,n,r,o){i.Ba("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},901352:function(e,t,n,r,o){i.Ba("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},901511:function(e,t,n,r,o){i.Ba("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},901669:function(e,t,n,r,o){i.Ba("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},901826:function(e,t,n,r,o){i.Ba("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},901983:function(e,t,n,r,o){i.Ba("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},902144:function(e,t,n,r,o){i.Ba("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},902308:function(e,t,n,r,o){i.Ba("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},902472:function(e){i.Ba("Where",e,void 0)},902525:function(e,t,n){i.Ba("Transpose",e,{perm:t?Array.from(I.subarray(t>>>0,n>>>0)):[]})},902633:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p,y){i.Ba("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:r,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:function(){return!!x[l>>>0]},outputPadding:h?Array.from(I.subarray(h>>>0,f>>>0)):[],outputShape:d?Array.from(I.subarray(d>>>0,p>>>0)):[],activation:X(y)})},903035:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p){i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(I.subarray(n>>>0,2+(n>>>0)>>>0)),group:r,kernelShape:Array.from(I.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(I.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(I.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:function(){return!!x[c>>>0]},outputPadding:l?Array.from(I.subarray(l>>>0,h>>>0)):[],outputShape:f?Array.from(I.subarray(f>>>0,d>>>0)):[],activation:X(p)})},903600:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p,y){i.Ba("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:r,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:function(){return!!x[l>>>0]},outputPadding:h?Array.from(I.subarray(h>>>0,f>>>0)):[],outputShape:d?Array.from(I.subarray(d>>>0,p>>>0)):[],activation:X(y)})},904002:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p){i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(I.subarray(n>>>0,2+(n>>>0)>>>0)),group:r,kernelShape:Array.from(I.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(I.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(I.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:function(){return!!x[c>>>0]},outputPadding:l?Array.from(I.subarray(l>>>0,h>>>0)):[],outputShape:f?Array.from(I.subarray(f>>>0,d>>>0)):[],activation:X(p)})},904567:function(e,t){i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},904658:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p,y,g){i.Ba("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:[a,s],kernel_shape:[u,c],pads:[l,h,f,d],strides:[p,y]})},904942:function(e,t){i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},905033:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p,y,g){i.Ba("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:[a,s],kernel_shape:[u,c],pads:[l,h,f,d],strides:[p,y]})},905317:function(e,t){i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},905404:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p,y,g){i.Ba("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:[a,s],kernel_shape:[u,c],pads:[l,h,f,d],strides:[p,y]})},905684:function(e,t){i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},905771:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p,y,g){i.Ba("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:[a,s],kernel_shape:[u,c],pads:[l,h,f,d],strides:[p,y]})},906051:function(e,t,n,r,o){i.Ba("Gemm",e,{alpha:t,beta:n,transA:r,transB:o})},906155:function(e){i.Ba("MatMul",e,void 0)},906209:function(e,t,n,r){i.Ba("ArgMax",e,{keepDims:!!t,selectLastIndex:!!n,axis:r})},906317:function(e,t,n,r){i.Ba("ArgMin",e,{keepDims:!!t,selectLastIndex:!!n,axis:r})},906425:function(e,t){i.Ba("Softmax",e,{axis:t})},906488:function(e,t){i.Ba("Concat",e,{axis:t})},906548:function(e,t,n,r,o){i.Ba("Split",e,{axis:t,numOutputs:n,splitSizes:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},906688:function(e){i.Ba("Expand",e,void 0)},906742:function(e,t){i.Ba("Gather",e,{axis:Number(t)})},906813:function(e,t){i.Ba("GatherElements",e,{axis:Number(t)})},906892:function(e,t,n,r,o,a,s,u,c,l,h){i.Ba("Resize",e,{antialias:t,axes:n?Array.from(I.subarray(n>>>0,r>>>0)):[],coordinateTransformMode:X(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:X(c),mode:X(l),nearestMode:X(h)})},907238:function(e,t,n,r,o,a,s){i.Ba("Slice",e,{starts:t?Array.from(I.subarray(t>>>0,n>>>0)):[],ends:r?Array.from(I.subarray(r>>>0,o>>>0)):[],axes:a?Array.from(I.subarray(a>>>0,s>>>0)):[]})},907454:function(e){i.Ba("Tile",e,void 0)},907506:function(e,t,n){i.Ba("LayerNormalization",e,{axis:Number(t),epsilon:Number(n)})},907613:function(e,t,n){i.Ba("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},907727:function(e,t,n){i.Ba("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},907841:function(e){i.Ba("Range",e,void 0)},907894:function(e,t){i.Ba("Einsum",e,{equation:X(t)})},907975:function(e,t,n,r,o){i.Ba("Pad",e,{mode:t,value:n,pads:r?Array.from(I.subarray(r>>>0,o>>>0)):[]})},908102:function(e,t,n,r,o,a){i.Ba("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!o,trainingMode:!!r,format:a?"NHWC":"NCHW"})},908271:function(e,t,n,r,o,a){i.Ba("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!o,trainingMode:!!r,format:a?"NHWC":"NCHW"})},908440:function(e,t,n){i.Ba("CumSum",e,{exclusive:Number(t),reverse:Number(n)})},908537:function(e,t,n,r,o,a,s,u,c){i.Ba("Attention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:r,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(I.subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!c})},908809:function(e){i.Ba("Gelu",e,void 0)},908861:function(e,t,n,r,o,a){i.Ba("MultiHeadAttention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:r,scale:o,doRotary:a})},909020:function(e){i.Ba("BiasAdd",e,void 0)},909075:function(e){i.Ba("BiasSplitGelu",e,void 0)},909136:function(e,t){i.Ba("SkipLayerNormalization",e,{epsilon:t})},909217:function(e,t,n,r,o,a,s,u,c,l,h,f,d){i.Ba("Conv",e,{format:c?"NHWC":"NCHW",auto_pad:t,dilations:[n],group:r,kernel_shape:[o],pads:a?Array.from(I.subarray(a>>>0,s>>>0)):[],strides:[u],w_is_const:function(){return!!x[l>>>0]},activation:X(h),activation_params:f?Array.from(C.subarray(f>>>0,d>>>0)):[]})},909587:function(e,t,n,r,o,a,s,u,c,l,h,f,d,p,y,g){i.Ba("Conv",e,{format:f?"NHWC":"NCHW",auto_pad:t,dilations:[n,r],group:o,kernel_shape:[a,s],pads:u?Array.from(I.subarray(u>>>0,c>>>0)):[],strides:[l,h],w_is_const:function(){return!!x[d>>>0]},activation:X(p),activation_params:y?Array.from(C.subarray(y>>>0,g>>>0)):[]})},909978:function(e){i.Za(e)},910012:function(e,t){return i.$a(e,t,i.Ja.ab,i.Ja.errors)}};function V(e){this.name="ExitStatus",this.message="Program terminated with exit(".concat(e,")"),this.status=e}function W(e){this.Na=e-24,this.Ua=function(e){A[this.Na+4>>>2>>>0]=e},this.Ta=function(e){A[this.Na+8>>>2>>>0]=e},this.Ra=function(e,t){this.Sa(),this.Ua(e),this.Ta(t)},this.Sa=function(){A[this.Na+16>>>2>>>0]=0}}var $,Y=("undefined"===typeof TextDecoder?"undefined":_typeof(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,K=function(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&Y)return Y.decode(e.subarray(t,n));for(r="";t<n;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}return r},X=function(e,t){return(e>>>=0)?K(_,e,t):""},Z=function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t},q=function(e,t,n,r){if(!(0<r))return 0;var i=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(n>=r)break;t[n++>>>0]=a}else{if(2047>=a){if(n+1>=r)break;t[n++>>>0]=192|a>>6}else{if(65535>=a){if(n+2>=r)break;t[n++>>>0]=224|a>>12}else{if(n+3>=r)break;t[n++>>>0]=240|a>>18,t[n++>>>0]=128|a>>12&63}t[n++>>>0]=128|a>>6&63}t[n++>>>0]=128|63&a}}return t[n>>>0]=0,n-i},J=function(e){return e%4==0&&(e%100!=0||e%400==0)},Q=[0,31,60,91,121,152,182,213,244,274,305,335],ee=[0,31,59,90,120,151,181,212,243,273,304,334],te=function(e){var t=Z(e)+1,n=Oe(t);return n&&q(e,_,n,t),n},ne=[],re=function(e,t){ne.length=0;for(var n;n=_[e++>>>0];){var r=105!=n;t+=(r&=112!=n)&&t%8?4:0,ne.push(112==n?A[t>>>2>>>0]:105==n?I[t>>>2>>>0]:k[t>>>3>>>0]),t+=r?8:4}return ne},ie={},oe=function(){if(!$){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"===typeof navigator?"undefined":_typeof(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:c||"./this.program"};for(e in ie)void 0===ie[e]?delete t[e]:t[e]=ie[e];var n=[];for(e in t)n.push("".concat(e,"=").concat(t[e]));$=n}return $},ae=[null,[],[]],se=function(e){return(se=function(){if("object"==("undefined"===typeof crypto?"undefined":_typeof(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return crypto.getRandomValues(e)};if(d)try{var e=Rh("crypto");if(e.randomFillSync)return function(t){return e.randomFillSync(t)};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e}}catch(n){}M("initRandomDevice")}())(e)},ue=[31,29,31,30,31,30,31,31,30,31,30,31],ce=[31,28,31,30,31,30,31,31,30,31,30,31];function le(e,t,n,r){function i(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function o(e,t){return i(e,t,"0")}function a(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.Ha;for(e=new Date(new Date(e.Ia+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(J(e.getFullYear())?ue:ce)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),n=s(n),0>=a(t,e)?0>=a(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0;var c=A[40+(r>>>=0)>>>2>>>0];for(var l in r={eb:I[r>>>2>>>0],cb:I[r+4>>>2>>>0],La:I[r+8>>>2>>>0],Pa:I[r+12>>>2>>>0],Ma:I[r+16>>>2>>>0],Ia:I[r+20>>>2>>>0],Ga:I[r+24>>>2>>>0],Ha:I[r+28>>>2>>>0],hb:I[r+32>>>2>>>0],bb:I[r+36>>>2>>>0],fb:c?X(c):""},n=X(n),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),c[l]);var h="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f="January February March April May June July August September October November December".split(" ");for(l in c={"%a":function(e){return h[e.Ga].substring(0,3)},"%A":function(e){return h[e.Ga]},"%b":function(e){return f[e.Ma].substring(0,3)},"%B":function(e){return f[e.Ma]},"%C":function(e){return o((e.Ia+1900)/100|0,2)},"%d":function(e){return o(e.Pa,2)},"%e":function(e){return i(e.Pa,2," ")},"%g":function(e){return u(e).toString().substring(2)},"%G":function(e){return u(e)},"%H":function(e){return o(e.La,2)},"%I":function(e){return 0==(e=e.La)?e=12:12<e&&(e-=12),o(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.Ma-1;t+=(J(e.Ia+1900)?ue:ce)[n++]);return o(e.Pa+t,3)},"%m":function(e){return o(e.Ma+1,2)},"%M":function(e){return o(e.cb,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.La&&12>e.La?"AM":"PM"},"%S":function(e){return o(e.eb,2)},"%t":function(){return"\t"},"%u":function(e){return e.Ga||7},"%U":function(e){return o(Math.floor((e.Ha+7-e.Ga)/7),2)},"%V":function(e){var t=Math.floor((e.Ha+7-(e.Ga+6)%7)/7);if(2>=(e.Ga+371-e.Ha-2)%7&&t++,t)53==t&&(4==(n=(e.Ga+371-e.Ha)%7)||3==n&&J(e.Ia)||(t=1));else{t=52;var n=(e.Ga+7-e.Ha-1)%7;(4==n||5==n&&J(e.Ia%400-1))&&t++}return o(t,2)},"%w":function(e){return e.Ga},"%W":function(e){return o(Math.floor((e.Ha+7-(e.Ga+6)%7)/7),2)},"%y":function(e){return(e.Ia+1900).toString().substring(2)},"%Y":function(e){return e.Ia+1900},"%z":function(e){return(0<=(e=e.bb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4)},"%Z":function(e){return e.fb},"%%":function(){return"%"}},n=n.replace(/%%/g,"\0\0"),c)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),c[l](r)));return l=function(e){var t=Array(Z(e)+1);return q(e,t,0,t.length),t}(n=n.replace(/\0\0/g,"%")),l.length>t?0:(x.set(l,e>>>0),l.length-1)}var he=function(e){try{e()}catch(e){M(e)}},fe=0,de=null,pe=0,ye=[],ge={},me={},ve=0,we=null,be=[];var xe,_e,Ie=[],Ae=[],Ce=function(e,t){if(!_e){_e=new WeakMap;var n=xe.length;if(_e)for(var r=0;r<0+n;r++){var i=r,o=Ie[i];o||(i>=Ie.length&&(Ie.length=i+1),Ie[i]=o=xe.get(i)),(i=o)&&_e.set(i,r)}}if(n=_e.get(e)||0)return n;if(Ae.length)n=Ae.pop();else{try{xe.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}n=xe.length-1}try{r=n,xe.set(r,e),Ie[r]=xe.get(r)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){r=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new r(o,e)}else{for(r=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},r.push(96),128>(a=t.length)?r.push(a):r.push(a%128|128,a>>7),a=0;a<t.length;++a)r.push(o[t[a]]);"v"==i?r.push(0):r.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=r.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,r),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}r=n,xe.set(r,t),Ie[r]=xe.get(r)}return _e.set(e,n),n},ke={n:function(e,t,n){return function(e){return function(e){if(!S){if(0===fe){var t=!1,n=!1;e((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!S&&(pe=e,t=!0,n)){fe=2,he((function(){return Ne(de)})),("undefined"===typeof Browser?"undefined":_typeof(Browser))<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),e=!1;try{var r=(0,Se[me[I[de+8>>>2>>>0]]])()}catch(t){r=t,e=!0}var i=!1;if(!de){var o=we;o&&(we=null,(e?o.reject:o.resolve)(r),i=!0)}if(e&&!i)throw r}})),n=!0,t||(fe=1,de=function(){var e=Oe(65548),t=e+12;A[e>>>2>>>0]=t,A[e+4>>>2>>>0]=t+65536,t=ye[0];var n=ge[t];return void 0===n&&(n=ve++,ge[t]=n,me[n]=t),I[e+8>>>2>>>0]=n,e}(),("undefined"===typeof Browser?"undefined":_typeof(Browser))<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),he((function(){return Le(de)})))}else 2===fe?(fe=0,he(Ue),Pe(de),de=null,be.forEach((function(e){if(!S)try{e();try{var t;b=b=e=b,null!==(t=i.onExit)&&void 0!==t&&t.call(i,e),S=!0,l(e,new V(e))}catch(e){e instanceof V||"unwind"==e||l(1,e)}}catch(e){e instanceof V||"unwind"==e||l(1,e)}}))):M("invalid state: ".concat(fe));return pe}}((function(t){e().then(t)}))}(_asyncToGenerator(_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.Xa(e,t,n);case 2:case"end":return r.stop()}}),r)}))))},a:function(e,t,n){throw new W(e>>>=0).Ra(t>>>0,n>>>0),e},g:function(){return 0},M:function(){},C:function(){},E:function(){},v:function(){return 0},K:function(){},F:function(){},J:function(){},m:function(){},D:function(){},A:function(){},L:function(){},B:function(){},N:function(){return 1},q:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),I[n>>>2>>>0]=e.getUTCSeconds(),I[n+4>>>2>>>0]=e.getUTCMinutes(),I[n+8>>>2>>>0]=e.getUTCHours(),I[n+12>>>2>>>0]=e.getUTCDate(),I[n+16>>>2>>>0]=e.getUTCMonth(),I[n+20>>>2>>>0]=e.getUTCFullYear()-1900,I[n+24>>>2>>>0]=e.getUTCDay(),I[n+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},r:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),I[n>>>2>>>0]=e.getSeconds(),I[n+4>>>2>>>0]=e.getMinutes(),I[n+8>>>2>>>0]=e.getHours(),I[n+12>>>2>>>0]=e.getDate(),I[n+16>>>2>>>0]=e.getMonth(),I[n+20>>>2>>>0]=e.getFullYear()-1900,I[n+24>>>2>>>0]=e.getDay(),I[n+28>>>2>>>0]=(J(e.getFullYear())?Q:ee)[e.getMonth()]+e.getDate()-1|0,I[n+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var r=new Date(e.getFullYear(),0,1).getTimezoneOffset();I[n+32>>>2>>>0]=0|(t!=r&&e.getTimezoneOffset()==Math.min(r,t))},s:function(e){e>>>=0;var t=new Date(I[e+20>>>2>>>0]+1900,I[e+16>>>2>>>0],I[e+12>>>2>>>0],I[e+8>>>2>>>0],I[e+4>>>2>>>0],I[e>>>2>>>0],0),n=I[e+32>>>2>>>0],r=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>n?I[e+32>>>2>>>0]=+(i!=o&&a==r):0<n!=(a==r)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<n?a:i)-r))),I[e+24>>>2>>>0]=t.getDay(),I[e+28>>>2>>>0]=(J(t.getFullYear())?Q:ee)[t.getMonth()]+t.getDate()-1|0,I[e>>>2>>>0]=t.getSeconds(),I[e+4>>>2>>>0]=t.getMinutes(),I[e+8>>>2>>>0]=t.getHours(),I[e+12>>>2>>>0]=t.getDate(),I[e+16>>>2>>>0]=t.getMonth(),I[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(I[Ee()>>>2>>>0]=61,e=-1):e/=1e3,Re((z=e,1<=+Math.abs(z)?0<z?+Math.floor(z/4294967296)>>>0:~~+Math.ceil((z-+(~~z>>>0))/4294967296)>>>0:0)),e>>>0},o:function(){return-52},p:function(){},y:function(e,t,n){function r(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}n>>>=0;var i=(new Date).getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();A[e>>>0>>>2>>>0]=60*Math.max(i,s),I[t>>>0>>>2>>>0]=+(i!=s),e=r(o),t=r(a),e=te(e),t=te(t),s<i?(A[n>>>2>>>0]=e,A[n+4>>>2>>>0]=t):(A[n>>>2>>>0]=t,A[n+4>>>2>>>0]=e)},e:function(){M("")},b:function(e,t,n){return e>>>=0,t=re(t>>>0,n>>>0),H[e].apply(null,t)},j:function(e,t,n){return e>>>=0,t=re(t>>>0,n>>>0),H[e].apply(null,t)},h:function(){return Date.now()},z:function(){return 4294901760},c:function(){return performance.now()},I:function(e,t,n){return t>>>=0,_.copyWithin(e>>>0>>>0,t>>>0,t+(n>>>0)>>>0)},w:function(e){e>>>=0;var t=_.length;if(4294901760<e)return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var i=Math;r=Math.max(e,r);e:{i=(i.min.call(i,4294901760,r+(65536-r%65536)%65536)-w.buffer.byteLength+65535)/65536;try{w.grow(i),T();var o=1;break e}catch(a){}o=void 0}if(o)return!0}return!1},G:function(e,t){e>>>=0,t>>>=0;var n=0;return oe().forEach((function(r,i){var o=t+n;for(i=A[e+4*i>>>2>>>0]=o,o=0;o<r.length;++o)x[i++>>>0>>>0]=r.charCodeAt(o);x[i>>>0>>>0]=0,n+=r.length+1})),0},H:function(e,t){e>>>=0,t>>>=0;var n=oe();A[e>>>2>>>0]=n.length;var r=0;return n.forEach((function(e){return r+=e.length+1})),A[t>>>2>>>0]=r,0},f:function(){return 52},l:function(){return 52},t:function(){return 70},k:function(e,t,n,r){t>>>=0,n>>>=0,r>>>=0;for(var i=0,o=0;o<n;o++){var a=A[t>>>2>>>0],s=A[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var c=_[a+u>>>0],l=ae[e];0===c||10===c?((1===e?m:v)(K(l,0)),l.length=0):l.push(c)}i+=s}return A[r>>>2>>>0]=i,0},u:function(e,t){return e>>>=0,se(_.subarray(e>>>0,e+(t>>>0)>>>0)),0},x:le,d:function(e,t,n,r){return le(e>>>0,t>>>0,n>>>0,r>>>0)},i:function(e,t,n,r){var i=xe.length;e=new Uint8Array(_.slice(e+t,e+n));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:w}});for(o in s.exports)Ce(s.exports[o]);return i<xe.length?i:r}catch(e){return console.log(e),r}}},Se=function(){function e(e){return Se=e.exports,Se=function(){for(var e=Se,t={},n=function(){var e=_slicedToArray(i[r],2),n=e[0],o=e[1];t[n]="function"==typeof o?function(){ye.push(n);try{return o.apply(null,arguments)}finally{S||(ye.pop(),de&&1===fe&&0===ye.length&&(fe=0,he(Fe),("undefined"===typeof Fibers?"undefined":_typeof(Fibers))<"u"&&Fibers.ib()))}}:o},r=0,i=Object.entries(e);r<i.length;r++)n();return t}(),Se=function(){var e=Se,t=function(e){return function(){return e()>>>0}},n=function(e){return function(t){return e(t)>>>0}};return(e=Object.assign({},e)).ta=t(e.ta),e.ua=n(e.ua),e.ya=t(e.ya),e.Aa=n(e.Aa),e}(),w=Se.O,T(),xe=Se.wa,O.unshift(Se.P),0==--R&&(null!==B&&(clearInterval(B),B=null),D&&(e=D,D=null,e())),Se}var t={a:ke};if(R++,i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(e){v("Module.instantiateWasm callback failed with error: ".concat(e)),n(e)}return function(e,t){var n=L;return"function"!=typeof WebAssembly.instantiateStreaming||F(n)||N(n)||d||"function"!=typeof fetch?G(n,e,t):fetch(n,{credentials:"same-origin"}).then((function(r){return WebAssembly.instantiateStreaming(r,e).then(t,(function(r){return v("wasm streaming compile failed: ".concat(r)),v("falling back to ArrayBuffer instantiation"),G(n,e,t)}))}))}(t,(function(t){e(t.instance)})).catch(n),{}}();i._OrtInit=function(e,t){return(i._OrtInit=Se.Q)(e,t)},i._OrtGetLastError=function(e,t){return(i._OrtGetLastError=Se.R)(e,t)},i._OrtCreateSessionOptions=function(e,t,n,r,o,a,s,u,c,l){return(i._OrtCreateSessionOptions=Se.S)(e,t,n,r,o,a,s,u,c,l)},i._OrtAppendExecutionProvider=function(e,t){return(i._OrtAppendExecutionProvider=Se.T)(e,t)},i._OrtAddFreeDimensionOverride=function(e,t,n){return(i._OrtAddFreeDimensionOverride=Se.U)(e,t,n)},i._OrtAddSessionConfigEntry=function(e,t,n){return(i._OrtAddSessionConfigEntry=Se.V)(e,t,n)},i._OrtReleaseSessionOptions=function(e){return(i._OrtReleaseSessionOptions=Se.W)(e)},i._OrtCreateSession=function(e,t,n){return(i._OrtCreateSession=Se.X)(e,t,n)},i._OrtReleaseSession=function(e){return(i._OrtReleaseSession=Se.Y)(e)},i._OrtGetInputOutputCount=function(e,t,n){return(i._OrtGetInputOutputCount=Se.Z)(e,t,n)},i._OrtGetInputName=function(e,t){return(i._OrtGetInputName=Se._)(e,t)},i._OrtGetOutputName=function(e,t){return(i._OrtGetOutputName=Se.$)(e,t)},i._OrtFree=function(e){return(i._OrtFree=Se.aa)(e)},i._OrtCreateTensor=function(e,t,n,r,o,a){return(i._OrtCreateTensor=Se.ba)(e,t,n,r,o,a)},i._OrtGetTensorData=function(e,t,n,r,o){return(i._OrtGetTensorData=Se.ca)(e,t,n,r,o)},i._OrtReleaseTensor=function(e){return(i._OrtReleaseTensor=Se.da)(e)},i._OrtCreateRunOptions=function(e,t,n,r){return(i._OrtCreateRunOptions=Se.ea)(e,t,n,r)},i._OrtAddRunConfigEntry=function(e,t,n){return(i._OrtAddRunConfigEntry=Se.fa)(e,t,n)},i._OrtReleaseRunOptions=function(e){return(i._OrtReleaseRunOptions=Se.ga)(e)},i._OrtCreateBinding=function(e){return(i._OrtCreateBinding=Se.ha)(e)},i._OrtBindInput=function(e,t,n){return(i._OrtBindInput=Se.ia)(e,t,n)},i._OrtBindOutput=function(e,t,n,r){return(i._OrtBindOutput=Se.ja)(e,t,n,r)},i._OrtClearBoundOutputs=function(e){return(i._OrtClearBoundOutputs=Se.ka)(e)},i._OrtReleaseBinding=function(e){return(i._OrtReleaseBinding=Se.la)(e)},i._OrtRunWithBinding=function(e,t,n,r,o){return(i._OrtRunWithBinding=Se.ma)(e,t,n,r,o)},i._OrtRun=function(e,t,n,r,o,a,s,u){return(i._OrtRun=Se.na)(e,t,n,r,o,a,s,u)},i._OrtEndProfiling=function(e){return(i._OrtEndProfiling=Se.oa)(e)},i._OrtConfigure=function(e,t){return(i._OrtConfigure=Se.pa)(e,t)},i._OrtAuth=function(e,t){return(i._OrtAuth=Se.qa)(e,t)},i._JsepOutput=function(e,t,n){return(i._JsepOutput=Se.ra)(e,t,n)},i._JsepGetNodeName=function(e){return(i._JsepGetNodeName=Se.sa)(e)};var Te,Ee=function(){return(Ee=Se.ta)()},Oe=i._malloc=function(e){return(Oe=i._malloc=Se.ua)(e)},Pe=i._free=function(e){return(Pe=i._free=Se.va)(e)},Re=function(e){return(Re=Se.xa)(e)},Be=function(){return(Be=Se.ya)()},De=function(e){return(De=Se.za)(e)},Me=function(e){return(Me=Se.Aa)(e)},Le=function(e){return(Le=Se.Ca)(e)},Fe=function(){return(Fe=Se.Da)()},Ne=function(e){return(Ne=Se.Ea)(e)},Ue=function(){return(Ue=Se.Fa)()};function je(){if(!(0<R)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();E.unshift(e)}for(;0<E.length;)E.shift()(i);if(!(0<R||Te||(Te=!0,i.calledRun=!0,S))){for(;0<O.length;)O.shift()(i);for(t(i);0<P.length;)P.shift()(i)}}}return i.___start_em_js=910124,i.___stop_em_js=910897,i.stackAlloc=Me,i.stackSave=Be,i.stackRestore=De,i.addFunction=Ce,i.UTF8ToString=X,i.stringToUTF8=function(e,t,n){return q(e,_,t,n)},i.lengthBytesUTF8=Z,D=function e(){Te||je(),Te||(D=e)},je(),r.ready}}();"object"==_typeof(e)&&"object"==_typeof(t)?t.exports=n:void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return n}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__=[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)})),hf=Dh((function(){})),ff=Dh((function(){})),df={};Mh(df,{cpus:function(){return pf}});var pf,yf,gf,mf,vf,wf,bf,xf,_f,If,Af,Cf,kf,Sf,Tf,Ef,Of,Pf,Rf,Bf,Df,Mf,Lf,Ff,Nf,Uf,jf,Gf,zf,Hf,Vf,Wf,$f,Yf,Kf,Xf,Zf,qf,Jf,Qf,ed,td,nd,rd,id,od,ad,sd,ud,cd,ld,hd,fd,dd,pd,yd,gd,md,vd,wd,bd,xd,_d,Id,Ad,Cd,kd,Sd,Td,Ed,Od,Pd,Rd,Bd,Dd,Md,Ld,Fd,Nd,Ud,jd,Gd,zd,Hd,Vd,Wd,$d,Yd,Kd,Xd,Zd,qd,Jd,Qd,ep,tp,np,rp,ip,op,ap,sp,up,cp,lp,hp,fp,dp,pp,yp,gp,mp,vp,wp,bp,xp,_p,Ip,Ap,Cp,kp,Sp,Tp,Ep,Op,Pp,Rp,Bp,Dp,Mp,Lp,Fp,Np,Up,jp,Gp,zp,Hp,Vp,Wp,$p,Yp,Kp,Xp,Zp,qp,Jp,Qp,ey,ty,ny,ry,iy,oy,ay,sy,uy,cy,ly,hy,fy,dy,py,yy,gy,my,vy,wy,by,xy,_y,Iy,Ay,Cy,ky,Sy,Ty,Ey,Oy,Py,Ry,By,Dy,My,Ly,Fy,Ny,Uy,jy,Gy,zy,Hy,Vy,Wy,$y,Yy,Ky,Xy,Zy,qy,Jy,Qy,eg,tg,ng,rg,ig,og,ag,sg,ug,cg,lg,hg,fg,dg,pg,yg,gg,mg,vg,wg,bg,xg,_g,Ig,Ag,Cg,kg,Sg,Tg,Eg,Og,Pg,Rg,Bg,Dg,Mg,Lg,Fg,Ng,Ug,jg,Gg,zg,Hg,Vg,Wg,$g,Yg,Kg,Xg,Zg,qg,Jg,Qg,em,tm,nm,rm,im,om,am,sm,um,cm,lm,hm,fm,dm,pm,ym,gm,mm,vm,wm,bm,xm,_m,Im,Am,Cm,km,Sm,Tm,Em,Om,Pm,Rm,Bm,Dm,Mm,Lm,Fm,Nm,Um,jm,Gm,zm,Hm,Vm,Wm,$m,Ym,Km,Xm,Zm,qm,Jm,Qm,ev,tv,nv,rv,iv,ov,av,sv,uv,cv,lv,hv,fv,dv,pv,yv,gv,mv,vv,wv,bv,xv,_v,Iv,Av,Cv,kv,Sv,Tv,Ev,Ov,Pv,Rv,Bv,Dv,Mv,Lv,Fv,Nv,Uv,jv,Gv,zv,Hv,Vv,Wv,$v,Yv,Kv,Xv,Zv,qv,Jv,Qv,ew,tw,nw,rw,iw,ow=Bh((function(){pf=void 0})),aw=Dh((function(e,t){var n=function(){var e=("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return _typeof(__filename)<"u"&&(e=e||__filename),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function n(){return O.buffer!=B.buffer&&j(),B}function r(){return O.buffer!=B.buffer&&j(),D}function i(){return O.buffer!=B.buffer&&j(),M}function o(){return O.buffer!=B.buffer&&j(),L}function a(){return O.buffer!=B.buffer&&j(),F}function s(){return O.buffer!=B.buffer&&j(),N}var u,c,l=t;l.ready=new Promise((function(e,t){u=e,c=t})),l.mountExternalData=function(e,t){(l.ib||(l.ib=new Map)).set(e,t)},l.unmountExternalData=function(){delete l.ib},l.jsepInit=function(e,t,n,r,i,o,a,s){l.Rb=e,l.Bb=t,l.Db=n,l.pb=r,l.Cb=i,l.Ua=o,l.Eb=a,l.Fb=s,t=function(e,t,n){return function(){for(var r,i,o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var u=ht,c=null===(r=t)||void 0===r?void 0:r();a=e.apply(void 0,_toConsumableArray(a));var l=null===(i=t)||void 0===i?void 0:i();return c!==l&&(e=l,n(c),t=n=null),ht!=u?new Promise((function(e,t){mt={resolve:e,reject:t}})):a}},n=function(t){return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var r,i,o,a,s=arguments;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!l.hb){n.next=3;break}throw Error("Session already started");case 3:return r=l.hb={Hb:s.length<=0?void 0:s[0],errors:[]},n.next=6,t.apply(void 0,s);case 6:if(i=n.sent,l.hb===r){n.next=9;break}throw Error("Session mismatch");case 9:if(e.flush(),!(0<(o=r.errors).length)){n.next=17;break}return n.next=14,Promise.all(o);case 14:if(a=(a=n.sent).filter((function(e){return e})),!(0<a.length)){n.next=17;break}throw Error(a.join("\n"));case 17:return n.abrupt("return",i);case 18:return n.prev=18,l.hb=null,n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[0,,18,21]])})))},l._OrtRun=n(t(l._OrtRun,(function(){return l._OrtRun}),(function(e){return l._OrtRun=e}))),l._OrtRunWithBinding=n(t(l._OrtRunWithBinding,(function(){return l._OrtRunWithBinding}),(function(e){return l._OrtRunWithBinding=e}))),l._OrtBindInput=t(l._OrtBindInput,(function(){return l._OrtBindInput}),(function(e){return l._OrtBindInput=e})),l.jsepRegisterBuffer=function(t,n,r,i){return e.registerBuffer(t,n,r,i)},l.jsepUnregisterBuffers=function(t){e.unregisterBuffers(t)},l.jsepGetBuffer=function(t){return e.getBuffer(t)},l.jsepCreateDownloader=function(t,n,r){return e.createDownloader(t,n,r)}};var h,f,d,p=Object.assign({},l),y="./this.program",g=function(e,t){throw t},m="object"==("undefined"===typeof window?"undefined":_typeof(window)),v="function"==typeof importScripts,w="object"==_typeof(kh)&&"object"==_typeof(kh.versions)&&"string"==typeof kh.versions.node,b=l.ENVIRONMENT_IS_PTHREAD||!1,x="";function _(e){return l.locateFile?l.locateFile(e,x):x+e}if(w){var I,A=(af(),Lh(tf)),C=(cf(),Lh(sf));x=v?C.dirname(x)+"/":__dirname+"/",h=function(e,t){return e=J(e)?new URL(e):C.normalize(e),A.readFileSync(e,t?void 0:"utf8")},d=function(e){return(e=h(e,!0)).buffer||(e=new Uint8Array(e)),e},f=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e=J(e)?new URL(e):C.normalize(e),A.readFile(e,r?void 0:"utf8",(function(e,i){e?n(e):t(r?i.buffer:i)}))},!l.thisProgram&&1<kh.argv.length&&(y=kh.argv[1].replace(/\\/g,"/")),kh.argv.slice(2),g=function(e,t){throw kh.exitCode=e,t},l.inspect=function(){return"[Emscripten Module object]"};try{I=hf()}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}__webpack_require__.g.Worker=I.Worker}else(m||v)&&(v?x=self.location.href:("undefined"===typeof document?"undefined":_typeof(document))<"u"&&document.currentScript&&(x=document.currentScript.src),_typeof(e)<"u"&&e&&(x=e),x=0!==x.indexOf("blob:")?x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1):"",w||(h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},v&&(d=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)}));w&&("undefined"===typeof performance?"undefined":_typeof(performance))>"u"&&(__webpack_require__.g.performance=ff().performance);var k=console.log.bind(console),S=console.error.bind(console);w&&(k=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return A.writeSync(1,t.join(" ")+"\n")},S=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return A.writeSync(2,t.join(" ")+"\n")});var T=k,E=S;Object.assign(l,p),p=null,"object"!=("undefined"===typeof WebAssembly?"undefined":_typeof(WebAssembly))&&X("no native wasm support detected");var O,P,R,B,D,M,L,F,N,U=!1;function j(){var e=O.buffer;l.HEAP8=B=new Int8Array(e),l.HEAP16=new Int16Array(e),l.HEAPU8=D=new Uint8Array(e),l.HEAPU16=new Uint16Array(e),l.HEAP32=M=new Int32Array(e),l.HEAPU32=L=new Uint32Array(e),l.HEAPF32=F=new Float32Array(e),l.HEAPF64=N=new Float64Array(e)}var G=16777216;if(b)O=l.wasmMemory;else if(l.wasmMemory)O=l.wasmMemory;else if(!((O=new WebAssembly.Memory({initial:G/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw E("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),w&&E("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");j(),G=O.buffer.byteLength;var z=[],H=[],V=[],W=0,$=null,Y=null;function K(){if(0==--W&&(null!==$&&(clearInterval($),$=null),Y)){var e=Y;Y=null,e()}}function X(e){throw E(e="Aborted("+e+")"),U=!0,R=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),c(e),e}var Z,q=function(e){return e.startsWith("data:application/octet-stream;base64,")},J=function(e){return e.startsWith("file://")};function Q(e){if(d)return d(e);throw"both async and sync fetching of the wasm failed"}function ee(e,t,n){return function(e){if(m||v){if("function"==typeof fetch&&!J(e))return fetch(e,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((function(){return Q(e)}));if(f)return new Promise((function(t,n){f(e,(function(e){return t(new Uint8Array(e))}),n)}))}return Promise.resolve().then((function(){return Q(e)}))}(e).then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(n,(function(e){E("failed to asynchronously prepare wasm: ".concat(e)),X(e)}))}q(Z="ort-wasm-simd-threaded.wasm")||(Z=_(Z));var te,ne={902596:function(e,t,n,i){if(_typeof(l)>"u"||!l.ib)return 1;if((e=ce(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=l.ib.get(e)))return 2;if(i>>>=0,(t>>>=0)+(n>>>=0)>e.byteLength)return 3;try{return r().set(e.subarray(t,t+n),i>>>0),0}catch(o){return 4}},903097:function(e){return l.Bb(e)},903130:function(e){return l.Db(e)},903162:function(e,t,n){l.pb(e,t,n,!0)},903201:function(e,t,n){l.pb(e,t,n)},903234:function(e){l.Ua("Abs",e,void 0)},903285:function(e){l.Ua("Neg",e,void 0)},903336:function(e){l.Ua("Floor",e,void 0)},903389:function(e){l.Ua("Ceil",e,void 0)},903441:function(e){l.Ua("Reciprocal",e,void 0)},903499:function(e){l.Ua("Sqrt",e,void 0)},903551:function(e){l.Ua("Exp",e,void 0)},903602:function(e){l.Ua("Erf",e,void 0)},903653:function(e){l.Ua("Sigmoid",e,void 0)},903708:function(e){l.Ua("Log",e,void 0)},903759:function(e){l.Ua("Sin",e,void 0)},903810:function(e){l.Ua("Cos",e,void 0)},903861:function(e){l.Ua("Tan",e,void 0)},903912:function(e){l.Ua("Asin",e,void 0)},903964:function(e){l.Ua("Acos",e,void 0)},904016:function(e){l.Ua("Atan",e,void 0)},904068:function(e){l.Ua("Sinh",e,void 0)},904120:function(e){l.Ua("Cosh",e,void 0)},904172:function(e){l.Ua("Asinh",e,void 0)},904225:function(e){l.Ua("Acosh",e,void 0)},904278:function(e){l.Ua("Atanh",e,void 0)},904331:function(e){l.Ua("Tanh",e,void 0)},904383:function(e){l.Ua("Not",e,void 0)},904434:function(e,t,n){l.Ua("Clip",e,{min:t,max:n})},904503:function(e){l.Ua("Clip",e,void 0)},904555:function(e,t){l.Ua("Elu",e,{alpha:t})},904613:function(e){l.Ua("Relu",e,void 0)},904665:function(e,t){l.Ua("LeakyRelu",e,{alpha:t})},904729:function(e,t){l.Ua("ThresholdedRelu",e,{alpha:t})},904799:function(e,t){l.Ua("Cast",e,{to:t})},904857:function(e){l.Ua("Add",e,void 0)},904908:function(e){l.Ua("Sub",e,void 0)},904959:function(e){l.Ua("Mul",e,void 0)},905010:function(e){l.Ua("Div",e,void 0)},905061:function(e){l.Ua("Pow",e,void 0)},905112:function(e){l.Ua("Equal",e,void 0)},905165:function(e){l.Ua("Greater",e,void 0)},905220:function(e){l.Ua("GreaterOrEqual",e,void 0)},905282:function(e){l.Ua("Less",e,void 0)},905334:function(e){l.Ua("LessOrEqual",e,void 0)},905393:function(e,t,n,r,o){l.Ua("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},905552:function(e,t,n,r,o){l.Ua("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},905710:function(e,t,n,r,o){l.Ua("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},905868:function(e,t,n,r,o){l.Ua("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},906027:function(e,t,n,r,o){l.Ua("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},906185:function(e,t,n,r,o){l.Ua("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},906342:function(e,t,n,r,o){l.Ua("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},906499:function(e,t,n,r,o){l.Ua("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},906660:function(e,t,n,r,o){l.Ua("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},906824:function(e,t,n,r,o){l.Ua("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},906988:function(e){l.Ua("Where",e,void 0)},907041:function(e,t,n){l.Ua("Transpose",e,{perm:t?Array.from(i().subarray(t>>>0,n>>>0)):[]})},907149:function(e,t,r,o,a,s,u,c,h,f,d,p,y,g,m){l.Ua("ConvTranspose",e,{format:h?"NHWC":"NCHW",autoPad:t,dilations:[r],group:o,kernel_shape:[a],pads:[s,u],strides:[c],wIsConst:function(){return!!n()[f>>>0]},outputPadding:d?Array.from(i().subarray(d>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,g>>>0)):[],activation:ce(m)})},907551:function(e,t,r,o,a,s,u,c,h,f,d,p,y,g){l.Ua("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:Array.from(i().subarray(r>>>0,2+(r>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:function(){return!!n()[h>>>0]},outputPadding:f?Array.from(i().subarray(f>>>0,d>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ce(g)})},908116:function(e,t,r,o,a,s,u,c,h,f,d,p,y,g,m){l.Ua("ConvTranspose",e,{format:h?"NHWC":"NCHW",autoPad:t,dilations:[r],group:o,kernel_shape:[a],pads:[s,u],strides:[c],wIsConst:function(){return!!n()[f>>>0]},outputPadding:d?Array.from(i().subarray(d>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,g>>>0)):[],activation:ce(m)})},908518:function(e,t,r,o,a,s,u,c,h,f,d,p,y,g){l.Ua("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:Array.from(i().subarray(r>>>0,2+(r>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:function(){return!!n()[h>>>0]},outputPadding:f?Array.from(i().subarray(f>>>0,d>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ce(g)})},909083:function(e,t){l.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},909174:function(e,t,n,r,i,o,a,s,u,c,h,f,d,p,y,g){l.Ua("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[c,h,f,d],strides:[p,y]})},909458:function(e,t){l.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},909549:function(e,t,n,r,i,o,a,s,u,c,h,f,d,p,y,g){l.Ua("AveragePool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[c,h,f,d],strides:[p,y]})},909833:function(e,t){l.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},909920:function(e,t,n,r,i,o,a,s,u,c,h,f,d,p,y,g){l.Ua("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[c,h,f,d],strides:[p,y]})},910200:function(e,t){l.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},910287:function(e,t,n,r,i,o,a,s,u,c,h,f,d,p,y,g){l.Ua("MaxPool",e,{format:g?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[c,h,f,d],strides:[p,y]})},910567:function(e,t,n,r,i){l.Ua("Gemm",e,{alpha:t,beta:n,transA:r,transB:i})},910671:function(e){l.Ua("MatMul",e,void 0)},910725:function(e,t,n,r){l.Ua("ArgMax",e,{keepDims:!!t,selectLastIndex:!!n,axis:r})},910833:function(e,t,n,r){l.Ua("ArgMin",e,{keepDims:!!t,selectLastIndex:!!n,axis:r})},910941:function(e,t){l.Ua("Softmax",e,{axis:t})},911004:function(e,t){l.Ua("Concat",e,{axis:t})},911064:function(e,t,n,r,o){l.Ua("Split",e,{axis:t,numOutputs:n,splitSizes:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},911204:function(e){l.Ua("Expand",e,void 0)},911258:function(e,t){l.Ua("Gather",e,{axis:Number(t)})},911329:function(e,t){l.Ua("GatherElements",e,{axis:Number(t)})},911408:function(e,t,n,r,o,a,s,u,c,h,f){l.Ua("Resize",e,{antialias:t,axes:n?Array.from(i().subarray(n>>>0,r>>>0)):[],coordinateTransformMode:ce(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:ce(c),mode:ce(h),nearestMode:ce(f)})},911754:function(e,t,n,r,o,a,s){l.Ua("Slice",e,{starts:t?Array.from(i().subarray(t>>>0,n>>>0)):[],ends:r?Array.from(i().subarray(r>>>0,o>>>0)):[],axes:a?Array.from(i().subarray(a>>>0,s>>>0)):[]})},911970:function(e){l.Ua("Tile",e,void 0)},912022:function(e,t,n){l.Ua("LayerNormalization",e,{axis:Number(t),epsilon:Number(n)})},912129:function(e,t,n){l.Ua("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},912243:function(e,t,n){l.Ua("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},912357:function(e){l.Ua("Range",e,void 0)},912410:function(e,t){l.Ua("Einsum",e,{equation:ce(t)})},912491:function(e,t,n,r,o){l.Ua("Pad",e,{mode:t,value:n,pads:r?Array.from(i().subarray(r>>>0,o>>>0)):[]})},912618:function(e,t,n,r,i,o){l.Ua("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!i,trainingMode:!!r,format:o?"NHWC":"NCHW"})},912787:function(e,t,n,r,i,o){l.Ua("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!i,trainingMode:!!r,format:o?"NHWC":"NCHW"})},912956:function(e,t,n){l.Ua("CumSum",e,{exclusive:Number(t),reverse:Number(n)})},913053:function(e,t,n,r,o,a,s,u,c){l.Ua("Attention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:r,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(i().subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!c})},913325:function(e){l.Ua("Gelu",e,void 0)},913377:function(e,t,n,r,i,o){l.Ua("MultiHeadAttention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:r,scale:i,doRotary:o})},913536:function(e){l.Ua("BiasAdd",e,void 0)},913591:function(e){l.Ua("BiasSplitGelu",e,void 0)},913652:function(e,t){l.Ua("SkipLayerNormalization",e,{epsilon:t})},913733:function(e,t,r,o,s,u,c,h,f,d,p,y,g){l.Ua("Conv",e,{format:f?"NHWC":"NCHW",auto_pad:t,dilations:[r],group:o,kernel_shape:[s],pads:u?Array.from(i().subarray(u>>>0,c>>>0)):[],strides:[h],w_is_const:function(){return!!n()[d>>>0]},activation:ce(p),activation_params:y?Array.from(a().subarray(y>>>0,g>>>0)):[]})},914103:function(e,t,r,o,s,u,c,h,f,d,p,y,g,m,v,w){l.Ua("Conv",e,{format:y?"NHWC":"NCHW",auto_pad:t,dilations:[r,o],group:s,kernel_shape:[u,c],pads:h?Array.from(i().subarray(h>>>0,f>>>0)):[],strides:[d,p],w_is_const:function(){return!!n()[g>>>0]},activation:ce(m),activation_params:v?Array.from(a().subarray(v>>>0,w>>>0)):[]})},914494:function(e){l.Eb(e)},914528:function(e,t){return l.Fb(e,t,l.hb.Hb,l.hb.errors)}};function re(e){this.name="ExitStatus",this.message="Program terminated with exit(".concat(e,")"),this.status=e}var ie=function(e){e.terminate(),e.onmessage=function(){}},oe=function(e){0==ye.cb.length&&(pe(),ye.qb(ye.cb[0]));var t=ye.cb.pop();if(!t)return 6;ye.eb.push(t),ye.$a[e.bb]=t,t.bb=e.bb;var n={cmd:"run",start_routine:e.Ib,arg:e.xb,pthread_ptr:e.bb};return w&&t.unref(),t.postMessage(n,e.Ob),0},ae=0,se=("undefined"===typeof TextDecoder?"undefined":_typeof(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,ue=function(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&se)return se.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(r="";t<n;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}return r},ce=function(e,t){return(e>>>=0)?ue(r(),e,t):""};function le(e,t){var n=arguments.length-2,r=arguments;return function(e){var t=Ut();return e=e(),jt(t),e}((function(){for(var i=Gt(8*n),o=i>>>3,a=0;a<n;a++){var u=r[2+a];s()[o+a>>>0]=u}return Bt(e,n,i,t)}))}function he(e){var t;if(b)return le(0,1,e);R=e,0<ae||(ye.Jb(),null!==(t=l.onExit)&&void 0!==t&&t.call(l,e),U=!0),g(e,new re(e))}var fe=function(e){if(R=e,b)throw me(e),"unwind";he(e)},de=function(e){e instanceof re||"unwind"==e||g(1,e)};function pe(){var e=_("ort-wasm-simd-threaded.worker.js");e=new Worker(e),ye.cb.push(e)}var ye={cb:[],eb:[],ub:[],$a:{},mb:function(){b?(ye.receiveObjectTransfer=ye.Gb,ye.threadInitTLS=ye.tb,ye.setExitStatus=ye.sb):function(){for(var e=l.numThreads;e--;)pe();z.unshift((function(){W++,function(e){b?e():Promise.all(ye.cb.map(ye.qb)).then(e)}((function(){return K()}))}))}()},sb:function(e){return R=e},Sb:["$terminateWorker"],Jb:function(){var e,t=_createForOfIteratorHelper(ye.eb);try{for(t.s();!(e=t.n()).done;){var n=e.value;ie(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=_createForOfIteratorHelper(ye.cb);try{for(i.s();!(r=i.n()).done;)n=r.value,ie(n)}catch(o){i.e(o)}finally{i.f()}ye.cb=[],ye.eb=[],ye.$a=[]},rb:function(e){var t=e.bb;delete ye.$a[t],ye.cb.push(e),ye.eb.splice(ye.eb.indexOf(e),1),e.bb=0,Dt(t)},Gb:function(){},tb:function(){ye.ub.forEach((function(e){return e()}))},qb:function(t){return new Promise((function(n){t.onmessage=function(e){var r=(e=e.data).cmd;if(e.targetThread&&e.targetThread!=Tt()){var i=ye.$a[e.targetThread];i?i.postMessage(e,e.transferList):E('Internal error! Worker sent a message "'.concat(r,'" to target pthread ').concat(e.targetThread,", but that thread no longer exists!"))}else"checkMailbox"===r?Ue():"spawnThread"===r?oe(e):"cleanupThread"===r?ye.rb(ye.$a[e.thread]):"killThread"===r?(e=e.thread,r=ye.$a[e],delete ye.$a[e],ie(r),Dt(e),ye.eb.splice(ye.eb.indexOf(r),1),r.bb=0):"cancelThread"===r?ye.$a[e.thread].postMessage({cmd:"cancel"}):"loaded"===r?(t.loaded=!0,w&&!t.bb&&t.unref(),n(t)):"alert"===r?alert("Thread ".concat(e.threadId,": ").concat(e.text)):"setimmediate"===e.target?t.postMessage(e):"callHandler"===r?l[e.handler].apply(l,_toConsumableArray(e.args)):r&&E("worker sent an unknown command ".concat(r))},t.onerror=function(e){throw E("worker sent an error! ".concat(e.filename,":").concat(e.lineno,": ").concat(e.message)),e},w&&(t.on("message",(function(e){return t.onmessage({data:e})})),t.on("error",(function(e){return t.onerror(e)})));for(var r,i=[],o=0,a=["onExit"];o<a.length;o++)r=a[o],l.hasOwnProperty(r)&&i.push(r);t.postMessage({cmd:"load",handlers:i,urlOrBlob:l.mainScriptUrlOrBlob||e,wasmMemory:O,wasmModule:P})}))}};l.PThread=ye;var ge=function(e){for(;0<e.length;)e.shift()(l)};function me(e){if(b)return le(1,0,e);fe(e)}function ve(e){this.lb=e-24,this.yb=function(e){o()[this.lb+4>>>2>>>0]=e},this.wb=function(e){o()[this.lb+8>>>2>>>0]=e},this.mb=function(e,t){this.vb(),this.yb(e),this.wb(t)},this.vb=function(){o()[this.lb+16>>>2>>>0]=0}}function we(e,t,n,r){return b?le(2,1,e,t,n,r):be(e,t,n,r)}function be(e,t,n,r){if(e>>>=0,t>>>=0,n>>>=0,r>>>=0,("undefined"===typeof SharedArrayBuffer?"undefined":_typeof(SharedArrayBuffer))>"u")return E("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return b&&0===i.length?we(e,t,n,r):(e={Ib:n,bb:e,xb:r,Ob:i},b?(e.Qb="spawnThread",postMessage(e,i),0):oe(e))}function xe(e,t,n){return b?le(3,1,e,t,n):0}function _e(e,t){if(b)return le(4,1,e,t)}l.establishStackSpace=function(){var e=Tt(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],Nt(t,t-e),jt(t)},l.invokeEntryPoint=function(e,t){e=zt.apply(null,[e,t]),0<ae?ye.sb(e):Mt(e)};var Ie=function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t},Ae=function(e,t,n,r){if(!(0<r))return 0;var i=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(n>=r)break;t[n++>>>0]=a}else{if(2047>=a){if(n+1>=r)break;t[n++>>>0]=192|a>>6}else{if(65535>=a){if(n+2>=r)break;t[n++>>>0]=224|a>>12}else{if(n+3>=r)break;t[n++>>>0]=240|a>>18,t[n++>>>0]=128|a>>12&63}t[n++>>>0]=128|a>>6&63}t[n++>>>0]=128|63&a}}return t[n>>>0]=0,n-i},Ce=function(e,t,n){return Ae(e,r(),t,n)};function ke(e,t){if(b)return le(5,1,e,t)}function Se(e,t,n){if(b)return le(6,1,e,t,n)}function Te(e,t,n){return b?le(7,1,e,t,n):0}function Ee(e,t){if(b)return le(8,1,e,t)}function Oe(e,t,n){if(b)return le(9,1,e,t,n)}function Pe(e,t,n,r){if(b)return le(10,1,e,t,n,r)}function Re(e,t,n,r){if(b)return le(11,1,e,t,n,r)}function Be(e,t,n,r){if(b)return le(12,1,e,t,n,r)}function De(e){if(b)return le(13,1,e)}function Me(e,t){if(b)return le(14,1,e,t)}function Le(e,t,n){if(b)return le(15,1,e,t,n)}var Fe=function(){if(!(0<ae))try{b?Mt(R):fe(R)}catch(e){de(e)}};function Ne(e){e>>>=0,"function"==typeof Atomics.Pb&&(Atomics.Pb(i(),e>>>2,e).value.then(Ue),e+=128,Atomics.store(i(),e>>>2,1))}l.__emscripten_thread_mailbox_await=Ne;var Ue=function(){var e=Tt();if(e&&(Ne(e),!U))try{Lt(),Fe()}catch(e){de(e)}};l.checkMailbox=Ue;var je=[],Ge=function(e){return e%4==0&&(e%100!=0||e%400==0)},ze=[0,31,60,91,121,152,182,213,244,274,305,335],He=[0,31,59,90,120,151,181,212,243,273,304,334];function Ve(e,t,n,r,i,o,a,s){return b?le(16,1,e,t,n,r,i,o,a,s):-52}function We(e,t,n,r,i,o,a){if(b)return le(17,1,e,t,n,r,i,o,a)}var $e,Ye=function(e){var t=Ie(e)+1,n=Et(t);return n&&Ce(e,n,t),n},Ke=[],Xe=function(e,t){Ke.length=0;for(var n;n=r()[e++>>>0];){var a=105!=n;t+=(a&=112!=n)&&t%8?4:0,Ke.push(112==n?o()[t>>>2>>>0]:105==n?i()[t>>>2>>>0]:s()[t>>>3>>>0]),t+=a?8:4}return Ke},Ze={},qe=function(){if(!$e){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"===typeof navigator?"undefined":_typeof(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(e in Ze)void 0===Ze[e]?delete t[e]:t[e]=Ze[e];var n=[];for(e in t)n.push("".concat(e,"=").concat(t[e]));$e=n}return $e};function Je(e,t){if(b)return le(18,1,e,t);e>>>=0,t>>>=0;var r=0;return qe().forEach((function(i,a){var s=t+r;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)n()[a++>>>0>>>0]=i.charCodeAt(s);n()[a>>>0>>>0]=0,r+=i.length+1})),0}function Qe(e,t){if(b)return le(19,1,e,t);e>>>=0,t>>>=0;var n=qe();o()[e>>>2>>>0]=n.length;var r=0;return n.forEach((function(e){return r+=e.length+1})),o()[t>>>2>>>0]=r,0}function et(e){return b?le(20,1,e):52}function tt(e,t,n,r){return b?le(21,1,e,t,n,r):52}function nt(e,t,n,r,i){return b?le(22,1,e,t,n,r,i):70}var rt=[null,[],[]];function it(e,t,n,i){if(b)return le(23,1,e,t,n,i);t>>>=0,n>>>=0,i>>>=0;for(var a=0,s=0;s<n;s++){var u=o()[t>>>2>>>0],c=o()[t+4>>>2>>>0];t+=8;for(var l=0;l<c;l++){var h=r()[u+l>>>0],f=rt[e];0===h||10===h?((1===e?T:E)(ue(f,0)),f.length=0):f.push(h)}a+=c}return o()[i>>>2>>>0]=a,0}var ot=function(e){return(ot=function(){if("object"==("undefined"===typeof crypto?"undefined":_typeof(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e};if(w)try{var e=Rh("crypto");if(e.randomFillSync)return function(t){return e.randomFillSync(t)};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e}}catch(n){}X("initRandomDevice")}())(e)},at=[31,29,31,30,31,30,31,31,30,31,30,31],st=[31,28,31,30,31,30,31,31,30,31,30,31];function ut(e,t,r,a){function s(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function u(e,t){return s(e,t,"0")}function c(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function l(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function h(e){var t=e.fb;for(e=new Date(new Date(e.gb+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(Ge(e.getFullYear())?at:st)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=l(new Date(e.getFullYear(),0,4)),n=l(n),0>=c(t,e)?0>=c(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0,a>>>=0;var f=o()[a+40>>>2>>>0];for(var d in a={Mb:i()[a>>>2>>>0],Lb:i()[a+4>>>2>>>0],jb:i()[a+8>>>2>>>0],ob:i()[a+12>>>2>>>0],kb:i()[a+16>>>2>>>0],gb:i()[a+20>>>2>>>0],ab:i()[a+24>>>2>>>0],fb:i()[a+28>>>2>>>0],Tb:i()[a+32>>>2>>>0],Kb:i()[a+36>>>2>>>0],Nb:f?ce(f):""},r=ce(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(d,"g"),f[d]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(d in f={"%a":function(e){return p[e.ab].substring(0,3)},"%A":function(e){return p[e.ab]},"%b":function(e){return y[e.kb].substring(0,3)},"%B":function(e){return y[e.kb]},"%C":function(e){return u((e.gb+1900)/100|0,2)},"%d":function(e){return u(e.ob,2)},"%e":function(e){return s(e.ob,2," ")},"%g":function(e){return h(e).toString().substring(2)},"%G":function(e){return h(e)},"%H":function(e){return u(e.jb,2)},"%I":function(e){return 0==(e=e.jb)?e=12:12<e&&(e-=12),u(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.kb-1;t+=(Ge(e.gb+1900)?at:st)[n++]);return u(e.ob+t,3)},"%m":function(e){return u(e.kb+1,2)},"%M":function(e){return u(e.Lb,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.jb&&12>e.jb?"AM":"PM"},"%S":function(e){return u(e.Mb,2)},"%t":function(){return"\t"},"%u":function(e){return e.ab||7},"%U":function(e){return u(Math.floor((e.fb+7-e.ab)/7),2)},"%V":function(e){var t=Math.floor((e.fb+7-(e.ab+6)%7)/7);if(2>=(e.ab+371-e.fb-2)%7&&t++,t)53==t&&(4==(n=(e.ab+371-e.fb)%7)||3==n&&Ge(e.gb)||(t=1));else{t=52;var n=(e.ab+7-e.fb-1)%7;(4==n||5==n&&Ge(e.gb%400-1))&&t++}return u(t,2)},"%w":function(e){return e.ab},"%W":function(e){return u(Math.floor((e.fb+7-(e.ab+6)%7)/7),2)},"%y":function(e){return(e.gb+1900).toString().substring(2)},"%Y":function(e){return e.gb+1900},"%z":function(e){return(0<=(e=e.Kb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4)},"%Z":function(e){return e.Nb},"%%":function(){return"%"}},r=r.replace(/%%/g,"\0\0"),f)r.includes(d)&&(r=r.replace(new RegExp(d,"g"),f[d](a)));return d=function(e){var t=Array(Ie(e)+1);return Ae(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),d.length>t?0:(function(e,t){n().set(e,t>>>0)}(d,e),d.length-1)}var ct=function(e){try{e()}catch(e){X(e)}},lt=0,ht=null,ft=0,dt=[],pt={},yt={},gt=0,mt=null,vt=[];var wt,bt,xt=[],_t=[],It=function(e,t){if(!bt){bt=new WeakMap;var n=wt.length;if(bt)for(var r=0;r<0+n;r++){var i=r,o=xt[i];o||(i>=xt.length&&(xt.length=i+1),xt[i]=o=wt.get(i)),(i=o)&&bt.set(i,r)}}if(n=bt.get(e)||0)return n;if(_t.length)n=_t.pop();else{try{wt.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}n=wt.length-1}try{r=n,wt.set(r,e),xt[r]=wt.get(r)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){r=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new r(o,e)}else{for(r=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},r.push(96),128>(a=t.length)?r.push(a):r.push(a%128|128,a>>7),a=0;a<t.length;++a)r.push(o[t[a]]);"v"==i?r.push(0):r.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=r.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,r),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}r=n,wt.set(r,t),xt[r]=wt.get(r)}return bt.set(e,n),n};ye.mb();var At=[he,me,we,xe,_e,ke,Se,Te,Ee,Oe,Pe,Re,Be,De,Me,Le,Ve,We,Je,Qe,et,tt,nt,it],Ct={r:function(e,t,n){return function(e){return function(e){if(!U){if(0===lt){var t=!1,n=!1;e((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!U&&(ft=e,t=!0,n)){lt=2,ct((function(){return Wt(ht)})),("undefined"===typeof Browser?"undefined":_typeof(Browser))<"u"&&Browser.nb.Ab&&Browser.nb.resume(),e=!1;try{var r=function(){var e=i()[ht+8>>>2>>>0];return e=kt[yt[e]],--ae,e()}()}catch(t){r=t,e=!0}var o=!1;if(!ht){var a=mt;a&&(mt=null,(e?a.reject:a.resolve)(r),o=!0)}if(e&&!o)throw r}})),n=!0,t||(lt=1,ht=function(){var e=Et(65548),t=e+12;o()[e>>>2>>>0]=t,o()[e+4>>>2>>>0]=t+65536,t=dt[0];var n=pt[t];return void 0===n&&(n=gt++,pt[t]=n,yt[n]=t),t=n,i()[e+8>>>2>>>0]=t,e}(),("undefined"===typeof Browser?"undefined":_typeof(Browser))<"u"&&Browser.nb.Ab&&Browser.nb.pause(),ct((function(){return Ht(ht)})))}else 2===lt?(lt=0,ct($t),Ot(ht),ht=null,vt.forEach((function(e){if(!U)try{e(),Fe()}catch(e){de(e)}}))):X("invalid state: ".concat(lt));return ft}}((function(t){e().then(t)}))}(_asyncToGenerator(_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.Cb(e,t,n);case 2:case"end":return r.stop()}}),r)}))))},b:function(e,t,n){throw new ve(e>>>=0).mb(t>>>0,n>>>0),e},P:function(e){Pt(e>>>0,!v,1,!m,131072,!1),ye.tb()},n:function(e){e>>>=0,b?postMessage({cmd:"cleanupThread",thread:e}):ye.rb(ye.$a[e])},L:be,i:xe,V:_e,H:ke,J:Se,z:Te,T:Ee,N:Oe,S:Pe,p:Re,I:Be,F:De,U:Me,G:Le,Y:function(){return 1},D:function(e,t){(e>>>=0)==t>>>0?setTimeout((function(){return Ue()})):b?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=ye.$a[e])&&e.postMessage({cmd:"checkMailbox"})},M:function(e,t,n,r){t>>>=0,je.length=n,r=r>>>0>>>3;for(var i=0;i<n;i++)je[i]=s()[r+i>>>0];return e=0>e?ne[-e-1]:At[e],ye.zb=t,t=e.apply(null,je),ye.zb=0,t},O:Ne,X:function(e){w&&ye.$a[e>>>0].ref()},u:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),i()[n>>>2>>>0]=e.getUTCSeconds(),i()[n+4>>>2>>>0]=e.getUTCMinutes(),i()[n+8>>>2>>>0]=e.getUTCHours(),i()[n+12>>>2>>>0]=e.getUTCDate(),i()[n+16>>>2>>>0]=e.getUTCMonth(),i()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[n+28>>>2>>>0]=e},v:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),i()[n>>>2>>>0]=e.getSeconds(),i()[n+4>>>2>>>0]=e.getMinutes(),i()[n+8>>>2>>>0]=e.getHours(),i()[n+12>>>2>>>0]=e.getDate(),i()[n+16>>>2>>>0]=e.getMonth(),i()[n+20>>>2>>>0]=e.getFullYear()-1900,i()[n+24>>>2>>>0]=e.getDay(),t=(Ge(e.getFullYear())?ze:He)[e.getMonth()]+e.getDate()-1|0,i()[n+28>>>2>>>0]=t,i()[n+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var r=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=r&&e.getTimezoneOffset()==Math.min(r,t)),i()[n+32>>>2>>>0]=e},w:function(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),n=i()[e+32>>>2>>>0],r=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>n?i()[e+32>>>2>>>0]=+(o!=a&&s==r):0<n!=(s==r)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<n?s:o)-r))),i()[e+24>>>2>>>0]=t.getDay(),n=(Ge(t.getFullYear())?ze:He)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=n,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[St()>>>2>>>0]=61,e=-1):e/=1e3,Ft((te=e,1<=+Math.abs(te)?0<te?+Math.floor(te/4294967296)>>>0:~~+Math.ceil((te-+(~~te>>>0))/4294967296)>>>0:0)),e>>>0},s:Ve,t:We,C:function(e,t,n){function r(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}e>>>=0,t>>>=0,n>>>=0;var a=(new Date).getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var c=u.getTimezoneOffset(),l=Math.max(a,c);o()[e>>>2>>>0]=60*l,i()[t>>>2>>>0]=+(a!=c),e=r(s),t=r(u),e=Ye(e),t=Ye(t),c<a?(o()[n>>>2>>>0]=e,o()[n+4>>>2>>>0]=t):(o()[n>>>2>>>0]=t,o()[n+4>>>2>>>0]=e)},d:function(){X("")},c:function(e,t,n){return e>>>=0,t=Xe(t>>>0,n>>>0),ne[e].apply(null,t)},k:function(e,t,n){return e>>>=0,t=Xe(t>>>0,n>>>0),ne[e].apply(null,t)},o:function(){},q:function(){return Date.now()},W:function(){throw ae+=1,"unwind"},E:function(){return 4294901760},f:function(){return performance.timeOrigin+performance.now()},g:function(){return w?(ow(),Lh(df)).cpus().length:navigator.hardwareConcurrency},A:function(e){e>>>=0;var t=r().length;if(e<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var i=t*(1+.2/n);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-O.buffer.byteLength+65535)/65536;try{O.grow(o),j();var a=1;break e}catch(s){}a=void 0}if(a)return!0}return!1},Q:Je,R:Qe,K:fe,h:et,m:tt,x:nt,l:it,y:function(e,t){return e>>>=0,t>>>=0,ot(r().subarray(e>>>0,e+t>>>0)),0},a:O||l.wasmMemory,B:ut,e:function(e,t,n,r){return ut(e>>>0,t>>>0,n>>>0,r>>>0)},j:function(e,t,n,i){var o=wt.length;e=new Uint8Array(r().slice(e+t,e+n));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:O}});for(a in u.exports)It(u.exports[a]);return o<wt.length?o:i}catch(e){return console.log(e),i}}},kt=function(){function e(e,t){return kt=e.exports,kt=function(){for(var e=kt,t={},n=function(){var e=_slicedToArray(i[r],2),n=e[0],o=e[1];t[n]="function"==typeof o?function(){dt.push(n);try{return o.apply(null,arguments)}finally{U||(dt.pop(),ht&&1===lt&&0===dt.length&&(lt=0,ae+=1,ct(Vt),("undefined"===typeof Fibers?"undefined":_typeof(Fibers))<"u"&&Fibers.Ub()))}}:o},r=0,i=Object.entries(e);r<i.length;r++)n();return t}(),kt=function(){var e=kt,t=function(e){return function(){return e()>>>0}},n=function(e){return function(t){return e(t)>>>0}};return(e=Object.assign({},e)).Da=t(e.Da),e.Ea=t(e.Ea),e.Fa=n(e.Fa),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Ra=t(e.Ra),e.Ta=n(e.Ta),e}(),ye.ub.push(kt.Ha),wt=kt.Ia,H.unshift(kt.Z),P=t,K(),kt}var t={a:Ct};if(W++,l.instantiateWasm)try{return l.instantiateWasm(t,e)}catch(e){E("Module.instantiateWasm callback failed with error: ".concat(e)),c(e)}return function(e,t){var n=Z;return"function"!=typeof WebAssembly.instantiateStreaming||q(n)||J(n)||w||"function"!=typeof fetch?ee(n,e,t):fetch(n,{credentials:"same-origin"}).then((function(r){return WebAssembly.instantiateStreaming(r,e).then(t,(function(r){return E("wasm streaming compile failed: ".concat(r)),E("falling back to ArrayBuffer instantiation"),ee(n,e,t)}))}))}(t,(function(t){e(t.instance,t.module)})).catch(c),{}}();l._OrtInit=function(e,t){return(l._OrtInit=kt._)(e,t)},l._OrtGetLastError=function(e,t){return(l._OrtGetLastError=kt.$)(e,t)},l._OrtCreateSessionOptions=function(e,t,n,r,i,o,a,s,u,c){return(l._OrtCreateSessionOptions=kt.aa)(e,t,n,r,i,o,a,s,u,c)},l._OrtAppendExecutionProvider=function(e,t){return(l._OrtAppendExecutionProvider=kt.ba)(e,t)},l._OrtAddFreeDimensionOverride=function(e,t,n){return(l._OrtAddFreeDimensionOverride=kt.ca)(e,t,n)},l._OrtAddSessionConfigEntry=function(e,t,n){return(l._OrtAddSessionConfigEntry=kt.da)(e,t,n)},l._OrtReleaseSessionOptions=function(e){return(l._OrtReleaseSessionOptions=kt.ea)(e)},l._OrtCreateSession=function(e,t,n){return(l._OrtCreateSession=kt.fa)(e,t,n)},l._OrtReleaseSession=function(e){return(l._OrtReleaseSession=kt.ga)(e)},l._OrtGetInputOutputCount=function(e,t,n){return(l._OrtGetInputOutputCount=kt.ha)(e,t,n)},l._OrtGetInputName=function(e,t){return(l._OrtGetInputName=kt.ia)(e,t)},l._OrtGetOutputName=function(e,t){return(l._OrtGetOutputName=kt.ja)(e,t)},l._OrtFree=function(e){return(l._OrtFree=kt.ka)(e)},l._OrtCreateTensor=function(e,t,n,r,i,o){return(l._OrtCreateTensor=kt.la)(e,t,n,r,i,o)},l._OrtGetTensorData=function(e,t,n,r,i){return(l._OrtGetTensorData=kt.ma)(e,t,n,r,i)},l._OrtReleaseTensor=function(e){return(l._OrtReleaseTensor=kt.na)(e)},l._OrtCreateRunOptions=function(e,t,n,r){return(l._OrtCreateRunOptions=kt.oa)(e,t,n,r)},l._OrtAddRunConfigEntry=function(e,t,n){return(l._OrtAddRunConfigEntry=kt.pa)(e,t,n)},l._OrtReleaseRunOptions=function(e){return(l._OrtReleaseRunOptions=kt.qa)(e)},l._OrtCreateBinding=function(e){return(l._OrtCreateBinding=kt.ra)(e)},l._OrtBindInput=function(e,t,n){return(l._OrtBindInput=kt.sa)(e,t,n)},l._OrtBindOutput=function(e,t,n,r){return(l._OrtBindOutput=kt.ta)(e,t,n,r)},l._OrtClearBoundOutputs=function(e){return(l._OrtClearBoundOutputs=kt.ua)(e)},l._OrtReleaseBinding=function(e){return(l._OrtReleaseBinding=kt.va)(e)},l._OrtRunWithBinding=function(e,t,n,r,i){return(l._OrtRunWithBinding=kt.wa)(e,t,n,r,i)},l._OrtRun=function(e,t,n,r,i,o,a,s){return(l._OrtRun=kt.xa)(e,t,n,r,i,o,a,s)},l._OrtEndProfiling=function(e){return(l._OrtEndProfiling=kt.ya)(e)},l._OrtConfigure=function(e,t){return(l._OrtConfigure=kt.za)(e,t)},l._OrtAuth=function(e,t){return(l._OrtAuth=kt.Aa)(e,t)},l._JsepOutput=function(e,t,n){return(l._JsepOutput=kt.Ba)(e,t,n)},l._JsepGetNodeName=function(e){return(l._JsepGetNodeName=kt.Ca)(e)};var St=function(){return(St=kt.Da)()},Tt=l._pthread_self=function(){return(Tt=l._pthread_self=kt.Ea)()},Et=l._malloc=function(e){return(Et=l._malloc=kt.Fa)(e)},Ot=l._free=function(e){return(Ot=l._free=kt.Ga)(e)};l.__emscripten_tls_init=function(){return(l.__emscripten_tls_init=kt.Ha)()};var Pt=l.__emscripten_thread_init=function(e,t,n,r,i,o){return(Pt=l.__emscripten_thread_init=kt.Ja)(e,t,n,r,i,o)};l.__emscripten_thread_crashed=function(){return(l.__emscripten_thread_crashed=kt.Ka)()};var Rt,Bt=function(e,t,n,r){return(Bt=kt.La)(e,t,n,r)},Dt=function(e){return(Dt=kt.Ma)(e)},Mt=l.__emscripten_thread_exit=function(e){return(Mt=l.__emscripten_thread_exit=kt.Na)(e)},Lt=function(){return(Lt=kt.Oa)()},Ft=function(e){return(Ft=kt.Pa)(e)},Nt=function(e,t){return(Nt=kt.Qa)(e,t)},Ut=function(){return(Ut=kt.Ra)()},jt=function(e){return(jt=kt.Sa)(e)},Gt=function(e){return(Gt=kt.Ta)(e)},zt=l.dynCall_ii=function(e,t){return(zt=l.dynCall_ii=kt.Va)(e,t)},Ht=function(e){return(Ht=kt.Wa)(e)},Vt=function(){return(Vt=kt.Xa)()},Wt=function(e){return(Wt=kt.Ya)(e)},$t=function(){return($t=kt.Za)()};function Yt(){if(!(0<W))if(b)u(l),b||ge(H),startWorker(l);else{if(l.preRun)for("function"==typeof l.preRun&&(l.preRun=[l.preRun]);l.preRun.length;)z.unshift(l.preRun.shift());ge(z),0<W||Rt||(Rt=!0,l.calledRun=!0,U||(b||ge(H),u(l),b||ge(V)))}}return l.___start_em_js=914640,l.___stop_em_js=915413,l.wasmMemory=O,l.stackAlloc=Gt,l.stackSave=Ut,l.stackRestore=jt,l.keepRuntimeAlive=function(){return 0<ae},l.addFunction=It,l.UTF8ToString=ce,l.stringToUTF8=Ce,l.lengthBytesUTF8=Ie,l.ExitStatus=re,l.PThread=ye,Y=function e(){Rt||Yt(),Rt||(Y=e)},Yt(),t.ready}}();"object"==_typeof(e)&&"object"==_typeof(t)?t.exports=n:void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return n}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__=[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)})),sw=Dh((function(e,t){t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n'})),uw=Bh((function(){yf=lf(),gf=aw(),vf=!1,wf=!1,bf=!1,xf=function(e){if(1===e)return!1;if(("undefined"===typeof SharedArrayBuffer?"undefined":_typeof(SharedArrayBuffer))>"u")return("undefined"===typeof self?"undefined":_typeof(self))<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;_typeof(kh)<"u"&&kh.versions&&kh.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return("undefined"===typeof MessageChannel?"undefined":_typeof(MessageChannel))<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(t){return!1}},_f=function(){try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(e){return!1}},If=function(e,t){return e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm"},Af=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o,a,s,u,c,l,h,f;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!vf){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(!wf){e.next=4;break}throw new Error("multiple calls to 'initializeWebAssembly()' detected.");case 4:if(!bf){e.next=6;break}throw new Error("previous call to 'initializeWebAssembly()' failed.");case 6:return wf=!0,n=t.initTimeout,r=t.numThreads,i=t.simd,o=xf(r),a=i&&_f(),s=t.wasmPaths,u="string"==typeof s?s:void 0,c=If(a,o),l="object"==_typeof(s)?s[c]:void 0,h=!1,f=[],n>0&&f.push(new Promise((function(e){setTimeout((function(){h=!0,e()}),n)}))),f.push(new Promise((function(e,t){var n=o?gf:yf,i={locateFile:function(e,t){if(o&&e.endsWith(".worker.js")&&("undefined"===typeof Blob?"undefined":_typeof(Blob))<"u")return URL.createObjectURL(new Blob([sw()],{type:"text/javascript"}));if(e.endsWith(".wasm")){if(l)return l;var n=null!==u&&void 0!==u?u:t;return"ort-wasm-simd.wasm"===c?n+"ort-wasm-simd.jsep.wasm":"ort-wasm-simd-threaded.wasm"===c?n+"ort-wasm-simd-threaded.jsep.wasm":n+c}return t+e}};if(o)if(i.numThreads=r,("undefined"===typeof Blob?"undefined":_typeof(Blob))>"u")i.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{var a="var ortWasmThreaded=".concat(n.toString(),";");i.mainScriptUrlOrBlob=new Blob([a],{type:"text/javascript"})}n(i).then((function(t){wf=!1,vf=!0,mf=t,e()}),(function(e){wf=!1,bf=!0,t(e)}))}))),e.next=12,Promise.race(f);case 12:if(!h){e.next=14;break}throw new Error("WebAssembly backend initializing failed due to timeout: ".concat(n,"ms"));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Cf=function(){if(vf&&mf)return mf;throw new Error("WebAssembly is not initialized yet.")}})),cw=Bh((function(){uw(),kf=function(e,t){var n=Cf(),r=n.lengthBytesUTF8(e)+1,i=n._malloc(r);return n.stringToUTF8(e,i,r),t.push(i),i},Sf=function(e,t,n,r){if("object"==_typeof(e)&&null!==e){if(n.has(e))throw new Error("Circular reference in options");n.add(e)}Object.entries(e).forEach((function(e){var i=_slicedToArray(e,2),o=i[0],a=i[1],s=t?t+o:o;if("object"==_typeof(a))Sf(a,s+".",n,r);else if("string"==typeof a||"number"==typeof a)r(s,a.toString());else{if("boolean"!=typeof a)throw new Error("Can't handle extra config type: "+_typeof(a));r(s,a?"1":"0")}}))},Tf=function(e){var t=Cf(),n=t.stackSave();try{var r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);var i=t.HEAP32[r/4],o=t.HEAPU32[r/4+1],a=o?t.UTF8ToString(o):"";throw new Error("".concat(e," ERROR_CODE: ").concat(i,", ERROR_MESSAGE: ").concat(a))}finally{t.stackRestore(n)}}})),lw=Bh((function(){uw(),cw(),Ef=function(e){var t=Cf(),n=0,r=[],i=e||{};try{if(void 0===(null===e||void 0===e?void 0:e.logSeverityLevel))i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error("log serverity level is not valid: ".concat(e.logSeverityLevel));if(void 0===(null===e||void 0===e?void 0:e.logVerbosityLevel))i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error("log verbosity level is not valid: ".concat(e.logVerbosityLevel));void 0===(null===e||void 0===e?void 0:e.terminate)&&(i.terminate=!1);var o=0;return void 0!==(null===e||void 0===e?void 0:e.tag)&&(o=kf(e.tag,r)),0===(n=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o))&&Tf("Can't create run options."),void 0!==(null===e||void 0===e?void 0:e.extra)&&Sf(e.extra,"",new WeakSet,(function(e,i){var o=kf(e,r),a=kf(i,r);0!==t._OrtAddRunConfigEntry(n,o,a)&&Tf("Can't set a run config entry: ".concat(e," - ").concat(i,"."))})),[n,r]}catch(e){throw 0!==n&&t._OrtReleaseRunOptions(n),r.forEach((function(e){return t._free(e)})),e}}})),hw=Bh((function(){uw(),cw(),Of=function(e){switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error("unsupported graph optimization level: ".concat(e))}},Pf=function(e){switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error("unsupported execution mode: ".concat(e))}},Rf=function(e){e.extra||(e.extra={}),e.extra.session||(e.extra.session={});var t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((function(e){return"webgpu"===("string"==typeof e?e:e.name)}))&&(e.enableMemPattern=!1)},Bf=function(e,t,n){var r,i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a="string"==typeof o?o:o.name;switch(a){case"webnn":if(a="WEBNN","string"!=typeof o){var s=o;if(null!==s&&void 0!==s&&s.deviceType){var u=kf("deviceType",n),c=kf(s.deviceType,n);0!==Cf()._OrtAddSessionConfigEntry(e,u,c)&&Tf("Can't set a session config entry: 'deviceType' - ".concat(s.deviceType,"."))}if(null!==s&&void 0!==s&&s.numThreads){var l=s.numThreads;("number"!=typeof l||!Number.isInteger(l)||l<0)&&(l=0);var h=kf("numThreads",n),f=kf(l.toString(),n);0!==Cf()._OrtAddSessionConfigEntry(e,h,f)&&Tf("Can't set a session config entry: 'numThreads' - ".concat(s.numThreads,"."))}if(null!==s&&void 0!==s&&s.powerPreference){var d=kf("powerPreference",n),p=kf(s.powerPreference,n);0!==Cf()._OrtAddSessionConfigEntry(e,d,p)&&Tf("Can't set a session config entry: 'powerPreference' - ".concat(s.powerPreference,"."))}}break;case"webgpu":if(a="JS","string"!=typeof o){var y=o;if(null!==y&&void 0!==y&&y.preferredLayout){if("NCHW"!==y.preferredLayout&&"NHWC"!==y.preferredLayout)throw new Error("preferredLayout must be either 'NCHW' or 'NHWC': ".concat(y.preferredLayout));var g=kf("preferredLayout",n),m=kf(y.preferredLayout,n);0!==Cf()._OrtAddSessionConfigEntry(e,g,m)&&Tf("Can't set a session config entry: 'preferredLayout' - ".concat(y.preferredLayout,"."))}}break;case"wasm":case"cpu":continue;default:throw new Error("not supported execution provider: ".concat(a))}var v=kf(a,n);0!==Cf()._OrtAppendExecutionProvider(e,v)&&Tf("Can't append execution provider: ".concat(a,"."))}}catch(w){i.e(w)}finally{i.f()}},Df=function(e){var t=Cf(),n=0,r=[],i=e||{};Rf(i);try{var o,a,s,u,c=Of(null!==(o=i.graphOptimizationLevel)&&void 0!==o?o:"all"),l=Pf(null!==(a=i.executionMode)&&void 0!==a?a:"sequential"),h="string"==typeof i.logId?kf(i.logId,r):0,f=null!==(s=i.logSeverityLevel)&&void 0!==s?s:2;if(!Number.isInteger(f)||f<0||f>4)throw new Error("log serverity level is not valid: ".concat(f));var d=null!==(u=i.logVerbosityLevel)&&void 0!==u?u:0;if(!Number.isInteger(d)||d<0||d>4)throw new Error("log verbosity level is not valid: ".concat(d));var p="string"==typeof i.optimizedModelFilePath?kf(i.optimizedModelFilePath,r):0;if(0===(n=t._OrtCreateSessionOptions(c,!!i.enableCpuMemArena,!!i.enableMemPattern,l,!!i.enableProfiling,0,h,f,d,p))&&Tf("Can't create session options."),i.executionProviders&&Bf(n,i.executionProviders,r),i.freeDimensionOverrides)for(var y=0,g=Object.entries(i.freeDimensionOverrides);y<g.length;y++){var m=_slicedToArray(g[y],2),v=m[0],w=m[1];if("string"!=typeof v)throw new Error("free dimension override name must be a string: ".concat(v));if("number"!=typeof w||!Number.isInteger(w)||w<0)throw new Error("free dimension override value must be a non-negative integer: ".concat(w));var b=kf(v,r);0!==t._OrtAddFreeDimensionOverride(n,b,w)&&Tf("Can't set a free dimension override: ".concat(v," - ").concat(w,"."))}return void 0!==i.extra&&Sf(i.extra,"",new WeakSet,(function(e,i){var o=kf(e,r),a=kf(i,r);0!==t._OrtAddSessionConfigEntry(n,o,a)&&Tf("Can't set a session config entry: ".concat(e," - ").concat(i,"."))})),[n,r]}catch(e){throw 0!==n&&t._OrtReleaseSessionOptions(n),r.forEach((function(e){return t._free(e)})),e}}})),fw=Bh((function(){Mf=function(e){switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error("unsupported data type: ".concat(e))}},Lf=function(e){switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error("unsupported data type: ".concat(e))}},Ff=function(e){return[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e]},Nf=function(e){switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error("unsupported type: ".concat(e))}},Uf=function(e){switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error("unsupported logging level: ".concat(e))}},jf=function(e){return"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e},Gf=function(e){switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error("unsupported data location: ".concat(e))}}})),dw=Bh((function(){zf=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=11;break}if(!(t instanceof Blob)){e.next=9;break}return e.t1=Uint8Array,e.next=5,t.arrayBuffer();case 5:e.t2=e.sent,e.t0=new e.t1(e.t2),e.next=10;break;case 9:e.t0=t instanceof Uint8Array?t:new Uint8Array(t);case 10:return e.abrupt("return",e.t0);case 11:if(_typeof(kh)<"u"&&kh.versions&&kh.versions.node){e.next=50;break}return e.next=14,fetch(t);case 14:if((n=e.sent).ok){e.next=17;break}throw new Error("failed to load external data file: ".concat(t));case 17:if(r=n.headers.get("Content-Length"),!((i=r?parseInt(r,10):0)<1073741824)){e.next=24;break}return e.t3=Uint8Array,e.next=22,n.arrayBuffer();case 22:return e.t4=e.sent,e.abrupt("return",new e.t3(e.t4));case 24:if(n.body){e.next=26;break}throw new Error("failed to load external data file: ".concat(t,", no response body."));case 26:a=n.body.getReader(),e.prev=27,o=new ArrayBuffer(i),e.next=37;break;case 31:if(e.prev=31,e.t5=e.catch(27),e.t5 instanceof RangeError){e.next=35;break}throw e.t5;case 35:s=Math.ceil(i/65536),o=new WebAssembly.Memory({initial:s,maximum:s}).buffer;case 37:u=0;case 38:return e.next=40,a.read();case 40:if(c=e.sent,l=c.done,h=c.value,!l){e.next=45;break}return e.abrupt("break",49);case 45:f=h.byteLength,new Uint8Array(o,u,f).set(h),u+=f;case 47:e.next=38;break;case 49:return e.abrupt("return",new Uint8Array(o,0,i));case 50:return e.prev=50,e.t6=Uint8Array,e.next=54,(void 0)(t);case 54:return e.t7=e.sent,e.abrupt("return",new e.t6(e.t7));case 58:if(e.prev=58,e.t8=e.catch(50),"ERR_FS_FILE_TOO_LARGE"!==e.t8.code){e.next=91;break}d=(void 0)(t),p=[],y=!1,g=!1,e.prev=64,v=_asyncIterator(d);case 66:return e.next=68,v.next();case 68:if(!(y=!(w=e.sent).done)){e.next=74;break}b=w.value,p.push(b);case 71:y=!1,e.next=66;break;case 74:e.next=80;break;case 76:e.prev=76,e.t9=e.catch(64),g=!0,m=e.t9;case 80:if(e.prev=80,e.prev=81,!y||null==v.return){e.next=85;break}return e.next=85,v.return();case 85:if(e.prev=85,!g){e.next=88;break}throw m;case 88:return e.finish(85);case 89:return e.finish(80);case 90:return e.abrupt("return",new Uint8Array(Sh.concat(p)));case 91:throw e.t8;case 92:case"end":return e.stop()}}),e,null,[[27,31],[50,58],[64,76,80,90],[81,,85,89]])})));return function(t){return e.apply(this,arguments)}}()})),pw=Bh((function(){fw(),Hf=["V","I","W","E","F"],Vf=function(e,t){console.log("[".concat(Hf[e],",").concat((new Date).toISOString(),"]").concat(t))},Yf=function(e,t){Wf=e,$f=t},Kf=function(e,t){var n=Uf(e);n>=Uf(Wf)&&Vf(n,"function"==typeof t?t():t)},Xf=function(){$f&&Kf.apply(void 0,arguments)}})),yw=Bh((function(){fw(),Zf=function(e,t){return new(Nf(t))(e)}})),gw=Bh((function(){})),mw=Bh((function(){pw(),gw(),qf=function(e){return 16*Math.ceil(e/16)},Jf=1,Qf=function(){return Jf++},ed=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i){var o,a,s,u,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=qf(r),a=t.device.createBuffer({size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),e.prev=1,s=t.getCommandEncoder(),t.endComputePass(),s.copyBufferToBuffer(n,0,a,0,o),t.flush(),e.next=8,a.mapAsync(GPUMapMode.READ);case 8:if(u=a.getMappedRange(),!i){e.next=12;break}return c=i(),e.abrupt("return",(c.set(new Uint8Array(u,0,r)),c));case 12:return e.abrupt("return",new Uint8Array(u.slice(0,r)));case 13:return e.prev=13,a.destroy(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,,13,16]])})));return function(t,n,r,i){return e.apply(this,arguments)}}(),td=function(){function e(t){_classCallCheck(this,e),this.backend=t,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map}return _createClass(e,[{key:"upload",value:function(e,t){var n=t.buffer,r=t.byteOffset,i=t.byteLength,o=qf(i),a=this.storageCache.get(e);if(!a)throw new Error("gpu data for uploading does not exist");if(a.originalSize!==i)throw new Error("inconsistent data size. gpu data size=".concat(a.originalSize,", data size=").concat(i));var s=this.backend.device.createBuffer({mappedAtCreation:!0,size:o,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),u=s.getMappedRange();new Uint8Array(u).set(new Uint8Array(n,r,i)),s.unmap();var c=this.backend.getCommandEncoder();this.backend.endComputePass(),c.copyBufferToBuffer(s,0,a.gpuData.buffer,0,o),Xf("verbose",(function(){return"[WebGPU] GpuDataManager.upload(id=".concat(e,")")})),this.buffersForUploadingPending.push(s)}},{key:"memcpy",value:function(e,t){var n=this.storageCache.get(e);if(!n)throw new Error("source gpu data for memcpy does not exist");var r=this.storageCache.get(t);if(!r)throw new Error("destination gpu data for memcpy does not exist");if(n.originalSize!==r.originalSize)throw new Error("inconsistent source and destination gpu data size");var i=qf(n.originalSize),o=this.backend.getCommandEncoder();this.backend.endComputePass(),o.copyBufferToBuffer(n.gpuData.buffer,0,r.gpuData.buffer,0,i)}},{key:"registerExternalBuffer",value:function(e,t,n){var r;if(n){if(void 0===(r=this.externalBuffers.get(n)))throw new Error("previous buffer is not registered");if(e===n)return Xf("verbose",(function(){return"[WebGPU] GpuDataManager.registerExternalBuffer(size=".concat(t,") => id=").concat(r,", buffer is the same, skip.")})),r;this.externalBuffers.delete(n)}else r=Qf();return this.storageCache.set(r,{gpuData:{id:r,type:0,buffer:e},originalSize:t}),this.externalBuffers.set(e,r),Xf("verbose",(function(){return"[WebGPU] GpuDataManager.registerExternalBuffer(size=".concat(t,") => id=").concat(r,", registered.")})),r}},{key:"unregisterExternalBuffer",value:function(e){var t=this.externalBuffers.get(e);void 0!==t&&(this.storageCache.delete(t),this.externalBuffers.delete(e),Xf("verbose",(function(){return"[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=".concat(t)})))}},{key:"create",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST,r=qf(e),i=(n&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,o=(n&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||o){var a=i?this.freeBuffers:this.freeUniformBuffers,s=a.get(r);s||(s=[],a.set(r,s)),t=s.length>0?s.pop():this.backend.device.createBuffer({size:r,usage:n})}else t=this.backend.device.createBuffer({size:r,usage:n});var u={id:Qf(),type:0,buffer:t};return this.storageCache.set(u.id,{gpuData:u,originalSize:e}),Xf("verbose",(function(){return"[WebGPU] GpuDataManager.create(size=".concat(e,") => id=").concat(u.id)})),u}},{key:"get",value:function(e){var t;return null===(t=this.storageCache.get(e))||void 0===t?void 0:t.gpuData}},{key:"release",value:function(e){var t=this.storageCache.get(e);if(!t)throw new Error("releasing data does not exist");return Xf("verbose",(function(){return"[WebGPU] GpuDataManager.release(id=".concat(e,"), gpuDataId=").concat(t.gpuData.id)})),this.storageCache.delete(e),this.buffersPending.push(t.gpuData.buffer),t.originalSize}},{key:"download",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.storageCache.get(t)){e.next=3;break}throw new Error("data does not exist");case 3:return e.next=5,ed(this.backend,r.gpuData.buffer,r.originalSize,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refreshPendingBuffers",value:function(){var e,t=_createForOfIteratorHelper(this.buffersForUploadingPending);try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(o){t.e(o)}finally{t.f()}this.buffersForUploadingPending=[];var n,r=_createForOfIteratorHelper(this.buffersPending);try{for(r.s();!(n=r.n()).done;){var i=n.value;(i.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(i.size).push(i):(i.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(i.size).push(i):i.destroy()}}catch(o){r.e(o)}finally{r.f()}this.buffersPending=[]}},{key:"dispose",value:function(){this.freeBuffers.forEach((function(e){e.forEach((function(e){e.destroy()}))})),this.freeUniformBuffers.forEach((function(e){e.forEach((function(e){e.destroy()}))})),this.storageCache.forEach((function(e){e.gpuData.buffer.destroy()})),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map}}]),e}(),nd=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _construct(td,t)}})),vw=Bh((function(){rd=function(){function e(t){_classCallCheck(this,e),Object.assign(this,t)}return _createClass(e,[{key:"cacheKey",get:function(){var e=this;return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map((function(t){return"".concat(e[t])})).join(";")),this.key}}]),e}(),id=function(e){return new rd(e)}})),ww=Bh((function(){od=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"calcMatMulShape",value:function(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}}]),e}(),ad=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"calcShape",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.length,i=t.length;if(0===r)return t;if(0===i)return e;var o=Math.max(e.length,t.length),a=new Array(o);if(n){if(r<2||i<2)return;var s=od.calcMatMulShape([e[r-2],e[r-1]],[t[i-2],t[i-1]]);if(void 0===s)return;var u=_slicedToArray(s,2);a[o-2]=u[0],a[o-1]=u[1]}for(var c=n?3:1;c<=o;c++){var l=r-c<0?1:e[r-c],h=i-c<0?1:t[i-c];if(l!==h&&l>1&&h>1)return;a[o-c]=Math.max(l,h)}return a}},{key:"isValidBroadcast",value:function(e,t){var n=e.length,r=t.length;if(n>r)return!1;for(var i=1;i<=n;i++)if(1!==e[n-i]&&e[n-i]!==t[r-i])return!1;return!0}}]),e}(),sd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"size",value:function(t){return e.getSizeFromDimensionRange(t,0,t.length)}},{key:"sizeFromDimension",value:function(t,n){if(n<0||n>t.length)throw new Error("invalid dimension of ".concat(n," for sizeFromDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,n,t.length)}},{key:"sizeToDimension",value:function(t,n){if(n<0||n>t.length)throw new Error("invalid dimension of ".concat(n," for sizeToDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,0,n)}},{key:"getSizeFromDimensionRange",value:function(e,t,n){for(var r=1,i=t;i<n;i++){if(e[i]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");r*=e[i]}return r}},{key:"computeStrides",value:function(e){var t=e.length;if(0===t)return[];if(1===t)return[1];var n=new Array(t);n[t-1]=1,n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}},{key:"normalizeAxis",value:function(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}},{key:"normalizeAxes",value:function(e,t){var n=this;return e.map((function(r){return n.normalizeAxis(r,null!==t&&void 0!==t?t:e.length)}))}},{key:"sortBasedOnPerm",value:function(e,t){return t?t.map((function(t){return e[t]})):e.slice().reverse()}},{key:"padShape",value:function(e,t){var n=e.length;return e.map((function(e,r){return e+t[r]+t[r+n]}))}},{key:"areEqual",value:function(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}}]),e}(),ud=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"adjustPoolAttributes",value:function(e,t,n,r,i,o){if(!e&&n.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(var a=0;a<t.length-2;a++)a>=n.length?n.push(t[a+2]):n[a]=t[a+2];for(var s=0;s<n.length;s++)if(s<r.length){if(r[s]<0)throw new Error("strides should be greater than or equal to 1")}else r.push(1);for(var u=0;u<n.length;u++)if(u<i.length){if(i[u]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(var c=0;c<2*n.length;c++)if(c<o.length){if(o[c]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(var l=0;l<n.length;l++){if(n[l]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[l]>=n[l]||o[l+n.length]>=n[l])throw new Error("pads should be smaller than kernel")}}},{key:"adjustPadsBasedOnAutoPad",value:function(t,n,r,i,o,a,s){if(s){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(var u=0;u<t.length-2;u++)e.adjustPadAndReturnShape(t[u+(a?1:2)],n[u],r[u],i[u],o,u,u+t.length-2,s)}}},{key:"computePoolOutputShape",value:function(t,n,r,i,o,a,s){if(n.length<=0)throw new Error("input shape must be of size greater than 0");var u=[n[0],n[1]];return e.computeShapeHelper(t,n,u,r,i,o,a,s),u}},{key:"computeConvOutputShape",value:function(t,n,r,i,o,a,s){if(t.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");var u=[t[0],n[0]];return e.computeShapeHelper(!1,t,u,r,i,o,a,s),u}},{key:"computeShapeHelper",value:function(t,n,r,i,o,a,s,u){if(t)for(var c=0;c<n.length-2;c++)r.push(1);else for(var l=0;l<n.length-2;l++)r.push(e.adjustPadAndReturnShape(n[l+2],i[l],o[l],a[l],s,l,l+n.length-2,u))}},{key:"adjustPadAndReturnShape",value:function(e,t,n,r,i,o,a,s){var u=n*(r-1)+1;if(!s||"NOTSET"===s)return Math.floor((e+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==n)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");var c=((e+t-1)/t-1)*t+r-e;return i[o]=Math.floor("SAME_LOWER"===s?(c+1)/2:c/2),i[a]=c-i[o],Math.floor((e+c-r)/t+1);default:throw new Error("Unsupported AutoPad type")}}}]),e}(),cd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getShapeOfGemmResult",value:function(e,t,n,r,i){if(2!==e.length||2!==n.length)throw new Error("shape need to be of size 2");var o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);var u=-1;if(r?(s=n[0],u=1):(s=n[1],u=0),n[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!ad.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]}}]),e}(),ld=-34028234663852886e22,hd=34028234663852886e22})),bw=Bh((function(){fw(),ww(),fd=function(e,t){if(3===t)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?"vec".concat(t,"<f16>"):"f16";case 1:return t>1?"vec".concat(t,"<f32>"):"f32";case 6:return t>1?"vec".concat(t,"<i32>"):"i32";case 12:return t>1?"vec".concat(t,"<u32>"):"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(4!==t)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error("Unknown data type: ".concat(e))}},dd=function(e){var t=fd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1);return"string"==typeof t?t:t[0]},pd=function(e){var t=fd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1);return"string"==typeof t?t:t[1]},yd=function(e){return 0===e.length?[]:[{type:"uint32",data:e},{type:"uint32",data:sd.computeStrides(e)}]},gd=function(e){return e%4==0?4:e%2==0?2:1},md=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"f32",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return t&&1!==t?"vec".concat(t,"<").concat(e,">(").concat(n,")"):"".concat(e,"(").concat(n,")")},vd=function(e,t,n){return"f32"===e?n:1===t?"f32(".concat(n,")"):"vec".concat(t,"f(").concat(n,")")},wd=function(e,t){return 4===t?"(".concat(e,".x + ").concat(e,".y + ").concat(e,".z + ").concat(e,".w)"):2===t?"(".concat(e,".x + ").concat(e,".y)"):3===t?"(".concat(e,".x + ").concat(e,".y + ").concat(e,".z)"):e},bd=function(e,t,n){return e.startsWith("uniforms.")&&n>4?"string"==typeof t?"".concat(e,"[(").concat(t,") / 4][(").concat(t,") % 4]"):"".concat(e,"[").concat(Math.floor(t/4),"][").concat(t%4,"]"):n>1?"".concat(e,"[").concat(t,"]"):e},xd=function(e,t,n,r,i){for(var o="number"==typeof n,a=o?n:n.length,s=_toConsumableArray(new Array(a).keys()),u=a<2?"u32":a<=4?"vec".concat(a,"<u32>"):"array<u32, ".concat(a,">"),c=fd(t,i),l="string"==typeof c?c:c[1],h="string"==typeof c?c:c[0],f={indices:u,value:l,storage:h,tensor:t},d=function(e){return"string"==typeof e?e:"".concat(e,"u")},p={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},y=o?"uniforms.":"",g="".concat(y).concat(e,"_shape"),m="".concat(y).concat(e,"_strides"),v="",w=0;w<a-1;w++)v+="\n    let dim".concat(w," = current / ").concat(bd(m,w,a),";\n    let rest").concat(w," = current % ").concat(bd(m,w,a),";\n    indices[").concat(w,"] = dim").concat(w,";\n    current = rest").concat(w,";\n    ");v+="indices[".concat(a-1,"] = current;");var b=a<2?"":"\n  fn o2i_".concat(e,"(offset: u32) -> ").concat(f.indices," {\n    var indices: ").concat(f.indices,";\n    var current = offset;\n    ").concat(v,"\n    return indices;\n  }"),x=[];if(a>=2)for(var _=a-1;_>=0;_--)x.push("".concat(bd(m,_,a)," * (indices[").concat(_,"])"));var I=a<2?"":"\n  fn i2o_".concat(e,"(indices: ").concat(f.indices,") -> u32 {\n    return ").concat(x.join("+"),";\n  }"),A=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===a?"0u":"".concat(f.indices,"(").concat(t.map(d).join(","),")")},C=function(e,t){return"".concat(a<2?e:bd(e,t,a))},k={},S=function(t,n){return function(){if(f.storage===f.value)return"".concat(e,"[").concat(t,"]=").concat(n,";");if("vec2<u32>"===f.storage&&"i32"===f.value)return"".concat(e,"[").concat(t,"]=vec2<u32>(u32(").concat(n,"), select(0u, 0xFFFFFFFFu, ").concat(n," < 0));");if("vec2<u32>"===f.storage&&"u32"===f.value)return"".concat(e,"[").concat(t,"]=vec2<u32>(u32(").concat(n,"), 0u);");if("u32"===f.storage&&"vec4<bool>"===f.value)return"".concat(e,"[").concat(t,"]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(").concat(n,"));");throw new Error("not supported combination of storage type ".concat(f.storage," and value type ").concat(f.value," yet"))}()},T=function(t){return function(){if(f.storage===f.value)return"".concat(e,"[").concat(t,"]");if("vec2<u32>"===f.storage&&"i32"===f.value)return"i32(".concat(e,"[").concat(t,"].x)");if("vec2<u32>"===f.storage&&"u32"===f.value)return"u32(".concat(e,"[").concat(t,"].x)");if("u32"===f.storage&&"vec4<bool>"===f.value)return"vec4<bool>(bool(".concat(e,"[").concat(t,"] & 0xFFu), bool(").concat(e,"[").concat(t,"] & 0xFF00u), bool(").concat(e,"[").concat(t,"] & 0xFF0000u), bool(").concat(e,"[").concat(t,"] & 0xFF000000u))");throw new Error("not supported combination of storage type ".concat(f.storage," and value type ").concat(f.value," yet"))}()},E=a<2?"":"\n  fn get_".concat(e,"ByIndices(indices: ").concat(f.indices,") -> ").concat(l," {\n    return ").concat(T("i2o_".concat(e,"(indices)")),";\n  }"),O=a<2?"":function(){var t=s.map((function(e){return"d".concat(e,": u32")})).join(", "),n=s.map((function(e){return"d".concat(e)})).join(", ");return"\n  fn get_".concat(e,"(").concat(t,") -> ").concat(l," {\n    return get_").concat(e,"ByIndices(").concat(A(n),");\n  }")}(),P=a<2?"":"\n  fn set_".concat(e,"ByIndices(indices: ").concat(f.indices,", value: ").concat(l,") {\n    ").concat(S("i2o_".concat(e,"(indices)"),"value"),"\n  }"),R=a<2?"":function(){var t=s.map((function(e){return"d".concat(e,": u32")})).join(", "),n=s.map((function(e){return"d".concat(e)})).join(", ");return"\n  fn set_".concat(e,"(").concat(t,", value: ").concat(l,") {\n    set_").concat(e,"ByIndices(").concat(A(n),", value);\n  }")}();return{impl:function(){var e=[],t=!1;return p.offsetToIndices&&(e.push(b),t=!0),p.indicesToOffset&&(e.push(I),t=!0),p.broadcastedIndicesToOffset&&(Object.values(k).forEach((function(t){return e.push(t)})),t=!0),p.set&&(e.push(R),t=!0),p.setByIndices&&(e.push(P),t=!0),p.get&&(e.push(O),t=!0),p.getByIndices&&(e.push(E),t=!0),!o&&t&&e.unshift("const ".concat(g," = ").concat(f.indices,"(").concat(n.join(","),");"),"const ".concat(m," = ").concat(f.indices,"(").concat(sd.computeStrides(n).join(","),");")),e.join("\n")},type:f,offsetToIndices:function(t){return p.offsetToIndices=!0,a<2?t:"o2i_".concat(e,"(").concat(t,")")},indicesToOffset:function(t){return p.indicesToOffset=!0,a<2?t:"i2o_".concat(e,"(").concat(t,")")},broadcastedIndicesToOffset:function(t,n){p.broadcastedIndicesToOffset=!0;var r="".concat(n.name,"broadcastedIndicesTo").concat(e,"Offset");if(r in k)return"".concat(r,"(").concat(t,")");for(var i=[],o=a-1;o>=0;o--){var s=n.indicesGet("outputIndices",o+n.rank-a);i.push("".concat(C(m,o)," * (").concat(s," % ").concat(C(g,o),")"))}return k[r]="fn ".concat(r,"(outputIndices: ").concat(n.type.indices,") -> u32 {\n             return ").concat(i.length>0?i.join("+"):"0u",";\n           }"),"".concat(r,"(").concat(t,")")},indices:A,indicesGet:C,indicesSet:function(e,t,n){return a<2?"".concat(e,"=").concat(n,";"):"".concat(bd(e,t,a),"=").concat(n,";")},set:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length!==a+1)throw new Error("indices length must be ".concat(a));var i=n[a];if("string"!=typeof i)throw new Error("value must be string");var o=n.slice(0,a).map(d).join(",");return 0===a?S("0u",i):1===a?S(o[0],i):(p.set=!0,p.setByIndices=!0,p.indicesToOffset=!0,"set_".concat(e,"(").concat(o,", ").concat(i,")"))},setByOffset:S,setByIndices:function(t,n){return a<2?S(t,n):(p.setByIndices=!0,p.indicesToOffset=!0,"set_".concat(e,"ByIndices(").concat(t,", ").concat(n,");"))},get:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length!==a)throw new Error("indices length must be ".concat(a));var i=n.map(d).join(",");return 0===a?T("0u"):1===a?T(i[0]):(p.get=!0,p.getByIndices=!0,p.indicesToOffset=!0,"get_".concat(e,"(").concat(i,")"))},getByOffset:T,getByIndices:function(t){return a<2?T(t):(p.getByIndices=!0,p.indicesToOffset=!0,"get_".concat(e,"ByIndices(").concat(t,")"))},usage:r,name:e,strides:m,shape:g,rank:a}},_d=function(e,t,n){return xd(e,t,n,"input",arguments.length>3&&void 0!==arguments[3]?arguments[3]:1)},Id=function(e,t,n){return xd(e,t,n,"output",arguments.length>3&&void 0!==arguments[3]?arguments[3]:1)},Ad=function(e,t,n){return xd(e,t,n,"internal",arguments.length>3&&void 0!==arguments[3]?arguments[3]:1)},Cd=function(){function e(t){_classCallCheck(this,e),this.normalizedDispatchGroup=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}return _createClass(e,[{key:"guardAgainstOutOfBoundsWorkgroupSizes",value:function(e){return"if (global_idx >= ".concat("number"==typeof e?"".concat(e,"u"):e,") { return; }")}},{key:"mainStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64,t="number"==typeof e?e:e[0],n="number"==typeof e?1:e[1],r="number"==typeof e?1:e[2],i=1===this.normalizedDispatchGroup[1]&&1===this.normalizedDispatchGroup[2];return"@compute @workgroup_size(".concat(t,", ").concat(n,", ").concat(r,")\n  fn main(").concat(i?"@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>":"@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>",") {\n    ").concat(i?"let global_idx = global_id.x; let local_idx = local_id.x;":"let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ".concat(t*n*r,"u + local_idx;"),"\n  ")}},{key:"appendVariableUniforms",value:function(e){0!==e.rank&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}},{key:"declareVariable",value:function(e,t){if("internal"===e.usage)throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);var n="input"===e.usage?"read":"read_write",r=e.type.storage;return"@group(0) @binding(".concat(t,") var<storage, ").concat(n,"> ").concat(e.name,": array<").concat(r,">;")}},{key:"declareVariables",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t){return e.declareVariable(t,e.variableIndex++)})).join("\n")}},{key:"registerInternalVariable",value:function(e){if("internal"!==e.usage)throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}},{key:"registerInternalVariables",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.registerInternalVariable(t)})),this}},{key:"registerUniform",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.uniforms.push({name:e,type:t,length:n}),this}},{key:"registerUniforms",value:function(e){return this.uniforms=this.uniforms.concat(e),this}},{key:"uniformDeclaration",value:function(){if(0===this.uniforms.length)return"";var e,t=[],n=_createForOfIteratorHelper(this.uniforms);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.name,o=r.type,a=r.length;if(a&&a>4)t.push("".concat(i,":array<vec4<").concat(o,">, ").concat(Math.ceil(a/4),">"));else{var s=null==a||1===a?o:"vec".concat(a,"<").concat(o,">");t.push("".concat(i,":").concat(s))}}}catch(u){n.e(u)}finally{n.f()}return"\n      struct Uniforms { ".concat(t.join(", ")," };\n      @group(0) @binding(").concat(this.variableIndex,") var<uniform> uniforms: Uniforms;")}},{key:"additionalImplementations",get:function(){return this.uniformDeclaration()+this.variables.map((function(e){return e.impl()})).join("\n")+this.internalVariables.map((function(e){return e.impl()})).join("\n")}}]),e}(),kd=function(e){return new Cd(e)},Sd=function(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var o=n-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&r.unshift(o)}return r},Td=function(e){return!0}})),xw=Bh((function(){ww(),vw(),bw(),Ed=function(e){if(!e||1!==e.length)throw new Error("Transpose requires 1 input.")},Od=function(e,t){return t&&t.length!==e?_toConsumableArray(new Array(e).keys()).reverse():t},Pd=function(e,t){return sd.sortBasedOnPerm(e,Od(e.length,t))},Rd=function(e,t,n,r){var i=[];i.push("fn perm(i: ".concat(r.type.indices,") -> ").concat(n.type.indices," {\n    var a: ").concat(n.type.indices,";"));for(var o=0;o<t;++o)i.push(n.indicesSet("a",e[o],"i[".concat(o,"]")));return i.push("return a;}"),i.join("\n")},Bd=function(e,t){var n=e.dataType,r=e.dims.length,i=Od(r,t),o=Td(r),a=Pd(e.dims,i),s=o?a.length:a,u=o?r:e.dims,c=Id("output",n,s),l=_d("a",n,u);return{name:"Transpose",shaderCache:{hint:"".concat(t),inputDependencies:o?["rank"]:["dims"]},getRunData:function(e){var t=sd.size(a);return{outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:o?[{type:"uint32",data:t}].concat(_toConsumableArray(yd(e[0].dims)),_toConsumableArray(yd(a))):[{type:"uint32",data:t}]}},getShaderSource:function(e){return"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(l,c),"\n\n  ").concat(Rd(i,r,l,c),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n    let indices = ").concat(c.offsetToIndices("global_idx"),";\n    let aIndices = perm(indices);\n\n    ").concat(c.setByOffset("global_idx",l.getByIndices("aIndices")),"\n  }")}}},Dd=function(e,t){Ed(e.inputs),e.compute(Bd(e.inputs[0],t.perm))},Md=function(e){return id({perm:e.perm})}})),_w=Bh((function(){ww(),bw(),Iw(),xw(),Ld={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Fd={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},Nd={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Ud={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},jd=function(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n},Gd=function(e,t){for(var n=[],r=e.length,i=0;i<r;i++)-1===t.indexOf(i)&&n.push(e[i]);return[n,t.map((function(t){return e[t]}))]},zd=function(e,t){for(var n=e.length+t.length,r=[],i=0,o=0;o<n;o++)-1===t.indexOf(o)?r.push(e[i++]):r.push(1);return r},Hd=function(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0},Vd=function(e,t){var n=[];if(!Hd(e,t)){for(var r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);e.forEach((function(e){return n.push(e)}))}return n},Wd=function(e,t,n,r,i,o,a){var s=n[0].dims,u=sd.size(o),c=sd.size(a),l=_d("_A",n[0].dataType,s),h=Id("output",i,o),f="\n          var<workgroup> aBestValues : array<".concat(h.type.storage,", 32>;\n       ");return{name:e,shaderCache:t,getShaderSource:function(e){return"\n        ".concat(e.registerUniform("reduceSize","u32").declareVariables(l,h),"\n        ").concat(f,"\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ").concat(e.mainStart(32),"\n\n          let outputIndex = global_idx / 32;\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ").concat(h.type.storage,"(").concat(Nd[r],");\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + 32) {\n           let candidate = ").concat(h.type.storage,"(").concat(l.getByOffset("offset + k"),");\n           bestValue = ").concat(Ld[r],";\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, 32u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ").concat(Fd[r],";\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ").concat(h.setByOffset("outputIndex",""+("mean"===r?"bestValue / ".concat(h.type.storage,"(uniforms.reduceSize)"):"".concat(Ud[r]))),";\n         }\n        }")},getRunData:function(){return{outputs:[{dims:o,dataType:i}],dispatchGroup:{x:u},programUniforms:[{type:"uint32",data:c}]}}}},$d=function(e,t,n,r){var i=1===e.inputs.length?n:ap(e.inputs,n),o=i.axes;0===o.length&&!i.noopWithEmptyAxes&&(o=e.inputs[0].dims.map((function(e,t){return t})));var a=sd.normalizeAxes(o,e.inputs[0].dims.length),s=a,u=e.inputs[0],c=Vd(s,e.inputs[0].dims.length);c.length>0&&(u=e.compute(Bd(e.inputs[0],c),{inputs:[0],outputs:[-1]})[0],s=jd(s.length,u.dims.length));var l=_slicedToArray(Gd(u.dims,s),2),h=l[0],f=l[1],d=h;i.keepDims&&(d=zd(h,a)),e.compute(Wd(t,{hint:i.cacheKey,inputDependencies:["type"]},[u],r,e.inputs[0].dataType,d,f),{inputs:[u]})},Yd=function(e,t){$d(e,"ReduceMeanShared",t,"mean")},Kd=function(e,t){$d(e,"ReduceL1Shared",t,"l1")},Xd=function(e,t){$d(e,"ReduceL2Shared",t,"l2")},Zd=function(e,t){$d(e,"ReduceLogSumExpShared",t,"logSumExp")},qd=function(e,t){$d(e,"ReduceMaxShared",t,"max")},Jd=function(e,t){$d(e,"ReduceMinShared",t,"min")},Qd=function(e,t){$d(e,"ReduceProdShared",t,"prod")},ep=function(e,t){$d(e,"ReduceSumShared",t,"sum")},tp=function(e,t){$d(e,"ReduceSumSquareShared",t,"sumSquare")},np=function(e,t){$d(e,"ReduceLogSumShared",t,"logSum")}})),Iw=Bh((function(){ww(),vw(),bw(),_w(),rp=function(e){if(!e||0===e.length||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(2===e.length&&1!==e[1].dims.length)throw new Error("Invalid axes input dims.")},ip=function(e){return["","","var value = ".concat(e.getByIndices("input_indices"),";"),""]},op=function(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=[],c=n[0].dims,l=c.length,h=sd.normalizeAxes(i,l),f=!s&&0===h.length;c.forEach((function(e,t){f||h.indexOf(t)>=0?a&&u.push(1):u.push(e)}));var d=u.length,p=sd.size(u);return{name:e,shaderCache:t,getShaderSource:function(e){for(var t=[],i=_d("_A",n[0].dataType,l),s=Id("output",o,d),u=r(i,s,h),p=u[2],y=0,g=0;y<l;y++)f||h.indexOf(y)>=0?(a&&g++,p="for(var j".concat(y,": u32 = 0; j").concat(y," < ").concat(c[y],"; j").concat(y,"++) {\n                  ").concat(u[2].includes("last_index")?"let last_index = j".concat(y,";"):"","\n                  ").concat(i.indicesSet("input_indices",y,"j".concat(y)),"\n                  ").concat(p,"\n                }")):(t.push("".concat(i.indicesSet("input_indices",y,s.indicesGet("output_indices",g)),";")),g++);return"\n\n        ".concat(e.registerUniform("output_size","u32").declareVariables(i,s),"\n\n        ").concat(e.mainStart(),"\n          ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n          var input_indices: ").concat(i.type.indices,";\n          let output_indices = ").concat(s.offsetToIndices("global_idx"),";\n\n          ").concat(t.join("\n"),"\n          ").concat(u[0],"       // init ops for reduce max/min\n          ").concat(u[1],"\n          ").concat(p,"\n          ").concat(u[3],"\n          ").concat(4===u.length?s.setByOffset("global_idx","value"):u.slice(4).join("\n"),"\n        }")},getRunData:function(){return{outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:"uint32",data:p}].concat(_toConsumableArray(yd(c)),_toConsumableArray(yd(u)))}}}},ap=function(e,t){var n=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach((function(e){return n.push(Number(e))})),id({axes:n,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},sp=function(e,t,n,r){var i=e.inputs,o=1===i.length?n:ap(i,n);e.compute(op(t,{hint:o.cacheKey,inputDependencies:["rank"]},[i[0]],o.noopWithEmptyAxes&&0===o.axes.length?ip:r,o.axes,i[0].dataType,o.keepDims,o.noopWithEmptyAxes),{inputs:[0]})},up=function(e,t){rp(e.inputs),sp(e,"ReduceLogSum",t,(function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += ".concat(e.getByIndices("input_indices"),";"),"value = log(value);"]}))},cp=function(e,t){rp(e.inputs),sp(e,"ReduceL1",t,(function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += abs(".concat(e.getByIndices("input_indices"),");"),""]}))},lp=function(e,t){rp(e.inputs),sp(e,"ReduceL2",t,(function(e,t){return["var t = ".concat(t.type.value,"(0); var value = ").concat(t.type.value,"(0);"),"","t = ".concat(e.getByIndices("input_indices"),"; value += (t * t);"),"value = sqrt(value);"]}))},hp=function(e,t){rp(e.inputs),sp(e,"ReduceLogSumExp",t,(function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += exp(".concat(e.getByIndices("input_indices"),");"),"value = log(value);"]}))},fp=function(e,t){rp(e.inputs),sp(e,"ReduceMax",t,(function(e,t,n){for(var r=[],i=0;i<e.rank;i++)(n.indexOf(i)>=0||0===n.length)&&r.push(e.indicesSet("input_indices",i,0));return["".concat(r.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";"),"value = max(value, ".concat(e.getByIndices("input_indices"),");"),""]}))},dp=function(e,t){rp(e.inputs),sp(e,"ReduceMean",t,(function(t,n,r){for(var i=1,o=0;o<t.rank;o++)(r.indexOf(o)>=0||0===r.length)&&(i*=e.inputs[0].dims[o]);return["var sum = f32(0);","","sum += f32(".concat(t.getByIndices("input_indices"),");"),"let value = ".concat(n.type.value,"(sum / ").concat(i,");")]}))},pp=function(e,t){rp(e.inputs),sp(e,"ReduceMin",t,(function(e,t,n){for(var r=[],i=0;i<e.rank;i++)(n.indexOf(i)>=0||0===n.length)&&r.push("input_indices[".concat(i,"] = 0;"));return["".concat(r.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";"),"value = min(value, ".concat(e.getByIndices("input_indices"),");"),""]}))},yp=function(e,t){rp(e.inputs),sp(e,"ReduceProd",t,(function(e,t){return["var value = ".concat(t.type.storage,"(1);"),"","value *= ".concat(e.getByIndices("input_indices"),";"),""]}))},gp=function(e,t){rp(e.inputs),sp(e,"ReduceSum",t,(function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += ".concat(e.getByIndices("input_indices"),";"),""]}))},mp=function(e,t){rp(e.inputs),sp(e,"ReduceSumSquare",t,(function(e,t){return["var t = ".concat(t.type.value,"(0); var value = ").concat(t.type.value,"(0);"),"","t = ".concat(e.getByIndices("input_indices"),"; value += t * t;"),""]}))},vp=function(e,t,n){if(0===t.length)return n;for(var r=1,i=1,o=0;o<t.length;o++)-1===t.indexOf(o)?r*=e[o]:i*=e[o];return i<32&&r>1024},wp=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?dp(e,t):Yd(e,t)},bp=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?cp(e,t):Kd(e,t)},xp=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?lp(e,t):Xd(e,t)},_p=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?hp(e,t):Zd(e,t)},Ip=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?fp(e,t):qd(e,t)},Ap=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?pp(e,t):Jd(e,t)},Cp=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?yp(e,t):Qd(e,t)},kp=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?gp(e,t):ep(e,t)},Sp=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?mp(e,t):tp(e,t)},Tp=function(e,t){vp(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?up(e,t):np(e,t)}})),Aw=Bh((function(){fw(),vw(),Iw(),Ep=function(e){if(!e||0===e.length||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(1!==e[0].dataType)throw new Error("Invalid input type.")},Op=function(e,t){Ep(e.inputs),e.compute(op("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],(function(e,n,r){for(var i=[],o=0;o<e.rank;o++)(r.indexOf(o)>=0||0===r.length)&&i.push("input_indices[".concat(o,"] = 0;"));return["".concat(i.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";\nvar best_index : i32 = 0;"),"if (".concat(e.getByIndices("input_indices")," ").concat(t.selectLastIndex>0?"<=":"<"," value) {\n         value = ").concat(e.getByIndices("input_indices"),";\n         best_index = i32(last_index);\n       }"),"",n.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},Pp=function(e,t){Ep(e.inputs),e.compute(op("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],(function(e,n,r){for(var i=[],o=0;o<e.rank;o++)(r.indexOf(o)>=0||0===r.length)&&i.push("input_indices[".concat(o,"] = 0;"));return["".concat(i.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";\nvar best_index : i32 = 0;"),"if (".concat(e.getByIndices("input_indices")," ").concat(t.selectLastIndex>0?">=":">"," value) {\n         value = ").concat(e.getByIndices("input_indices"),";\n         best_index = i32(last_index);\n       }"),"",n.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},Rp=function(e){return id(e)}})),Cw=Bh((function(){fw(),gw(),bw(),Bp=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5];if(a&&s)throw new Error("Attention cannot have both past and relative_position_bias");if(3!==n.dims.length)throw new Error('Input "input" must have 3 dimensions');var u=n.dims[0],c=n.dims[1],l=n.dims[2];if(1!==i.dims.length)throw new Error('Input "bias" is expected to have 1 dimensions');if(2!==r.dims.length)throw new Error('Input "weights" is expected to have 2 dimensions');if(r.dims[0]!==l)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==r.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');var h=i.dims[0]/3,f=h,d=f;if(t.qkvHiddenSizes.length>0){if(3!==t.qkvHiddenSizes.length)throw new Error("qkv_hidden_sizes attribute should have 3 elements");var p,y=_createForOfIteratorHelper(t.qkvHiddenSizes);try{for(y.s();!(p=y.n()).done;){if(p.value%t.numHeads!=0)throw new Error("qkv_hidden_sizes should be divisible by num_heads")}}catch(w){y.e(w)}finally{y.f()}h=t.qkvHiddenSizes[0],f=t.qkvHiddenSizes[1],d=t.qkvHiddenSizes[2]}var g=c;if(h!==f)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==h+f+d)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');var m=0;if(a){if(f!==d)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(5!==a.dims.length)throw new Error('Input "past" must have 5 dimensions');if(2!==a.dims[0])throw new Error('Input "past" first dimension must be 2');if(a.dims[1]!==u)throw new Error('Input "past" second dimension must be batch_size');if(a.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(a.dims[4]!==f/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(m=a.dims[3])}var v=g+m;if(o)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");if(s)throw new Error("relativePositionBias is not supported");return{batchSize:u,sequenceLength:c,pastSequenceLength:m,kvSequenceLength:g,totalSequenceLength:v,maxSequenceLength:-1,inputHiddenSize:l,hiddenSize:h,vHiddenSize:d,headSize:Math.floor(h/t.numHeads),vHeadSize:Math.floor(d/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:0,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Dp=function(e,t,n,r){var i=gd(r),o=64,a=r/i;a<o?o=1:a/8<64&&(o=Math.ceil(a/8));var s=Math.ceil(r/i/o),u=[{type:Lf(t.dataType),data:1/r},{type:"uint32",data:a},{type:"uint32",data:s}],c=dd(t.dataType,i);e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:"".concat(o,";").concat(c,";").concat(i)},getShaderSource:function(e){var n=Id("x",t.dataType,t.dims,i),r="thread_max_vector";2===i?r="max(thread_max_vector.x, thread_max_vector.y)":4===i&&(r="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");var a=pd(t.dataType),s=[{name:"d_inv",type:a},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return"\n  var<workgroup> wgMax: array<f32, ".concat(o,">;\n  var<workgroup> wgSum: array<f32, ").concat(o,">;\n  ").concat(e.registerUniforms(s).declareVariables(n),"\n  ").concat(e.mainStart([o,1,1]),"\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ").concat(md("f32",i,"-3.402823e+38f"),";\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(").concat(vd(a,i,"x[offset + i]"),", thread_max_vector);\n    }\n    wgMax[local_idx] = ").concat(r,";\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ").concat(o,"; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ").concat(md("f32",i,"0"),";\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(").concat(vd(a,i,"x[offset + i]")," - maxValue);\n    }\n    wgSum[local_idx] = ").concat(wd("sumVector",i),";\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ").concat(o,"; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ").concat(md("f32",i,"uniforms.d_inv"),";\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ").concat(vd(a,i,"x[offset + i]"),";\n        x[offset + i] = ").concat(n.type.value,"(exp(f32input - maxValue) / sum);\n      }\n    }\n  }")},getRunData:function(){return{outputs:[],dispatchGroup:{x:n},programUniforms:u}}},{inputs:[t],outputs:[]})},Mp=function(e,t,n,r,i,o){var a=[i.batchSize,i.numHeads,i.sequenceLength,i.kvSequenceLength+i.pastSequenceLength],s=0===o.scale?1/Math.sqrt(i.headSize):o.scale,u=gd(i.headSize),c=i.headSize/u,l={x:Math.ceil(i.totalSequenceLength/12),y:Math.ceil(i.sequenceLength/12),z:i.batchSize*i.numHeads},h=Lf(t.dataType),f=[{type:"uint32",data:i.sequenceLength},{type:"uint32",data:c},{type:"uint32",data:i.totalSequenceLength},{type:"uint32",data:i.kvSequenceLength},{type:h,data:s}],d=[t,n],p=e.compute({name:"AttentionProbs",shaderCache:{hint:"".concat(u),inputDependencies:["type","type"]},getRunData:function(){return{outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:l,programUniforms:f}},getShaderSource:function(e){var r=_d("q",t.dataType,t.dims,u),i=_d("key",n.dataType,n.dims,u),o=Id("output",t.dataType,a),s=dd(t.dataType),c=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:s}];return"\n  const beta: ".concat(s," = 1.0;\n  const TILE_SIZE = 12u;\n\n  var<workgroup> tileQ: array<").concat(r.type.storage,", 144>;\n  var<workgroup> tileK: array<").concat(r.type.storage,", 144>;\n  ").concat(e.registerUniforms(c).declareVariables(r,i,o),"\n  ").concat(e.mainStart([12,12,1]),"\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ").concat(md(s,u),";\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ").concat(wd("value",u)," * uniforms.alpha;\n    }\n  }")}},{inputs:d,outputs:[-1]})[0];return Dp(e,p,i.batchSize*i.numHeads*i.sequenceLength,i.totalSequenceLength),p},Lp=function(e,t,n,r){var i=[r.batchSize,r.sequenceLength,r.vHiddenSize],o={x:Math.ceil(r.vHeadSize/12),y:Math.ceil(r.sequenceLength/12),z:r.batchSize*r.numHeads},a=[{type:"uint32",data:r.sequenceLength},{type:"uint32",data:r.totalSequenceLength},{type:"uint32",data:r.vHeadSize},{type:"uint32",data:r.numHeads},{type:"uint32",data:r.vHiddenSize}];return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:function(){return{outputs:[{dims:i,dataType:t.dataType,gpuDataType:0}],dispatchGroup:o,programUniforms:a}},getShaderSource:function(e){var r=_d("probs",t.dataType,t.dims),o=_d("v",n.dataType,n.dims),a=Id("output",t.dataType,i);return"\n  const TILE_SIZE = 12u;\n  var<workgroup> tileQ: array<".concat(r.type.value,", 144>;\n  var<workgroup> tileK: array<").concat(r.type.value,", 144>;\n  ").concat(e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}]).declareVariables(r,o,a),"\n  ").concat(e.mainStart([12,12,1]),"\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ").concat(r.type.storage,"(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }")}},{inputs:[t,n],outputs:[0]})[0]},Fp=function(e,t,n,r,i,o,a,s,u,c,l){var h=Mp(e,t,n,0,c,l);Lp(e,h,r,c)},Np=function(e,t){var n=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],r=t.sequenceLength,i=t.inputHiddenSize,o=t.headSize,a={x:Math.ceil(t.headSize/12),y:Math.ceil(t.sequenceLength/12),z:t.batchSize*t.numHeads},s=[e.inputs[0],e.inputs[1],e.inputs[2]],u=[{type:"uint32",data:r},{type:"uint32",data:i},{type:"uint32",data:o},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}];return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:function(){return{outputs:[{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:a,programUniforms:u}},getShaderSource:function(e){var t=Id("output_q",s[0].dataType,n),r=Id("output_k",s[0].dataType,n),i=Id("output_v",s[0].dataType,n),o=_d("input",s[0].dataType,s[0].dims),a=_d("weight",s[1].dataType,s[1].dims),u=_d("bias",s[2].dataType,s[2].dims),c=o.type.storage;return"\n  const TILE_SIZE = 12u;\n  var<workgroup> tileInput: array<".concat(c,", 144>;\n  var<workgroup> tileWeightQ: array<").concat(c,", 144>;\n  var<workgroup> tileWeightK: array<").concat(c,", 144>;\n  var<workgroup> tileWeightV: array<").concat(c,", 144>;\n  ").concat(e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}]).declareVariables(o,a,u,t,r,i),"\n  ").concat(e.mainStart([12,12,1]),"\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ").concat(c,"(0);\n    var valueK = ").concat(c,"(0);\n    var valueV = ").concat(c,"(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }")}},{inputs:s,outputs:[-1,-1,-1]})},Up=function(e,t){var n=Bp(e.inputs,t),r=_slicedToArray(Np(e,n),3),i=r[0],o=r[1],a=r[2];return Fp(e,i,o,a,e.inputs[4],void 0,void 0,void 0,e.inputs[5],n,t)}})),kw=Bh((function(){ef(),ww(),vw(),bw(),jp=function(e,t){if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs");var n=function(e,t,n){var r=t.length;if(r!==e.length)throw new Error("".concat(n,": num dimensions != ").concat(r));t.forEach((function(t,r){if(t!==e[r])throw new Error("".concat(n,": dim[").concat(r,"] do not match"))}))};if(e[0].dims.length>1){var r="NHWC"===t.format?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);n(e[1].dims,r,"Invalid input scale"),n(e[2].dims,r,"Invalid input B"),n(e[3].dims,r,"Invalid input mean"),n(e[4].dims,r,"Invalid input var")}else n(e[1].dims,[1],"Invalid input scale"),n(e[2].dims,[1],"Invalid input B"),n(e[3].dims,[1],"Invalid input mean"),n(e[4].dims,[1],"Invalid input var")},Gp=function(e,t){var n=t.epsilon,r=t.spatial,i=t.format,o=e[0].dims,a=r?gd(o[o.length-1]):1,s="NHWC"===i&&o.length>1?a:1,u=sd.size(o)/a,c=Td(o.length)&&r,l=c?o.length:o,h=_d("x",e[0].dataType,e[0].dims,a),f=_d("scale",e[1].dataType,e[1].dims,s),d=_d("bias",e[2].dataType,e[2].dims,s),p=_d("inputMean",e[3].dataType,e[3].dims,s),y=_d("inputVar",e[4].dataType,e[4].dims,s),g=Id("y",e[0].dataType,l,a);return{name:"BatchNormalization",shaderCache:{hint:"".concat(t.epsilon,"_").concat(t.format,"_").concat(r,"_").concat(a),inputDependencies:c?["rank","type","type","type","type"]:void 0},getShaderSource:function(e){return"\n  const epsilon = ".concat(n,";\n  ").concat(e.registerUniform("outputSize","u32").declareVariables(h,f,d,p,y,g),"\n  ").concat(e.mainStart(),"\n  ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n    var outputIndices = ").concat(g.offsetToIndices("global_idx * ".concat(a)),";\n    ").concat(function(){var e="";if(r)e="let cOffset = ".concat(1===o.length?"0u":"NHWC"===i?"outputIndices[".concat(o.length-1,"] / ").concat(a):"outputIndices[1]",";");else if("NCHW"===i)e="\n            ".concat(g.indicesSet("outputIndices","0","0"),"\n            let cOffset = ").concat(g.indicesToOffset("outputIndices"),";");else{e="var cIndices = ".concat(f.type.indices,"(0);\n                       cIndices[0] = outputIndices[").concat(o.length-1,"];");for(var t=1;t<f.rank;t++)e+="cIndices[".concat(t,"] = outputIndices[").concat(t,"];");e+="let cOffset = ".concat(f.indicesToOffset("cIndices"),";")}return e}(),"\n    let scale = ").concat(f.getByOffset("cOffset"),";\n    let bias = ").concat(d.getByOffset("cOffset"),";\n    let inputMean = ").concat(p.getByOffset("cOffset"),";\n    let inputVar = ").concat(y.getByOffset("cOffset"),";\n    let x = ").concat(h.getByOffset("global_idx"),";\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ").concat(g.setByOffset("global_idx","value"),"\n  }")},getRunData:function(){return{outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c?[{type:"uint32",data:u}].concat(_toConsumableArray(yd(o))):[{type:"uint32",data:u}]}}}},zp=function(e){return id(e)},Hp=function(e,t){var n=e.inputs,r=e.outputCount,i=zp(_objectSpread(_objectSpread({},t),{},{outputCount:r}));if(Ql.webgpu.validateInputContent&&jp(n,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(Gp(n,i))}})),Sw=Bh((function(){ww(),bw(),Vp=function(e){if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Wp=function(e){var t=e[0].dims,n=e[0].dims[2],r=sd.size(t)/4,i=e[0].dataType,o=_d("input",i,t,4),a=_d("bias",i,[n],4),s=_d("residual",i,t,4),u=Id("output",i,t,4);return{name:"BiasAdd",getRunData:function(){return{outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(r/64)}}},getShaderSource:function(e){return"\n  const channels = ".concat(n,"u / 4;\n  ").concat(e.declareVariables(o,a,s,u),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(r),"\n    let value = ").concat(o.getByOffset("global_idx"),"\n      + ").concat(a.getByOffset("global_idx % channels")," + ").concat(s.getByOffset("global_idx"),";\n    ").concat(u.setByOffset("global_idx","value"),"\n  }")}}},$p=function(e){Vp(e.inputs),e.compute(Wp(e.inputs))}})),Tw=Bh((function(){fw(),ww(),vw(),bw(),Yp=function(e,t,n,r,i,o){var a,s=Math.ceil(t/4);a="string"==typeof i?"".concat(i,"(a)"):i("a");var u=_d("inputData",n,[s],4),c=Id("outputData",r,[s],4);return"\n      ".concat(e.registerUniform("vec_size","u32").declareVariables(u,c),"\n\n  ").concat(null!==o&&void 0!==o?o:"","\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n\n    let a = ").concat(u.getByOffset("global_idx"),";\n    ").concat(c.setByOffset("global_idx",a),"\n  }")},Kp=function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.dataType;return{name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:function(t){return Yp(t,sd.size(e.dims),e.dataType,o,n,r)},getRunData:function(t){return{outputs:[{dims:e.dims,dataType:o}],dispatchGroup:{x:Math.ceil(sd.size(t[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(sd.size(e.dims)/4)}]}}}},Xp=function(e){e.compute(Kp(e.inputs[0],"Abs","abs"))},Zp=function(e){e.compute(Kp(e.inputs[0],"Acos","acos"))},qp=function(e){e.compute(Kp(e.inputs[0],"Acosh","acosh"))},Jp=function(e){e.compute(Kp(e.inputs[0],"Asin","asin"))},Qp=function(e){e.compute(Kp(e.inputs[0],"Asinh","asinh"))},ey=function(e){e.compute(Kp(e.inputs[0],"Atan","atan"))},ty=function(e){e.compute(Kp(e.inputs[0],"Atanh","atanh"))},ny=function(e){return id(e)},ry=function(e,t){var n;switch(t.to){case 10:n="vec4<f16>";break;case 1:n="vec4<f32>";break;case 12:n="vec4<u32>";break;case 6:n="vec4<i32>";break;case 9:n="vec4<bool>";break;default:throw new RangeError("not supported type (specified in attribute 'to' from 'Cast' operator): ".concat(t.to))}e.compute(Kp(e.inputs[0],"Cast",n,void 0,t.cacheKey,t.to))},iy=function(e){var t=e.length>=2&&0!==e[1].data?e[1].getFloat32Array()[0]:ld,n=e.length>=3&&0!==e[2].data?e[2].getFloat32Array()[0]:hd;return id({min:t,max:n})},oy=function(e,t){var n=1===e.inputs.length?t:iy(e.inputs),r=pd(e.inputs[0].dataType);e.compute(Kp(e.inputs[0],"Clip",(function(e){return"clamp(".concat(e,", clip_min_, clip_max_)")}),"\n    const clip_min_: vec4<".concat(r,"> = vec4(").concat(r,"(").concat(n.min,"));\n    const clip_max_: vec4<").concat(r,"> = vec4(").concat(r,"(").concat(n.max,"));\n"),n.cacheKey),{inputs:[0]})},ay=function(e){e.compute(Kp(e.inputs[0],"Ceil","ceil"))},sy=function(e){e.compute(Kp(e.inputs[0],"Cos","cos"))},uy=function(e){e.compute(Kp(e.inputs[0],"Cosh","cosh"))},cy=function(e){return id(e)},ly=function(e,t){var n=pd(e.inputs[0].dataType);e.compute(Kp(e.inputs[0],"Elu",(function(e){return"elu_vf32(".concat(e,")")}),"\n  const elu_alpha_ = ".concat(n,"(").concat(t.alpha,");\n\n  fn elu_f32(a: ").concat(n,") -> ").concat(n," {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<").concat(n,">) -> vec4<").concat(n,"> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }"),t.cacheKey))},hy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"f32";return"\nconst r0: ".concat(t," = 0.3275911;\nconst r1: ").concat(t," = 0.254829592;\nconst r2: ").concat(t," = -0.284496736;\nconst r3: ").concat(t," = 1.421413741;\nconst r4: ").concat(t," = -1.453152027;\nconst r5: ").concat(t," = 1.061405429;\n\nfn erf_vf32(v: ").concat(e,") -> ").concat(e," {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}")},fy=function(e){var t=pd(e.inputs[0].dataType);e.compute(Kp(e.inputs[0],"Erf",(function(e){return"erf_vf32(".concat(e,")")}),hy("vec4<".concat(t,">"),t)))},dy=function(e){e.compute(Kp(e.inputs[0],"Exp","exp"))},py=function(e){e.compute(Kp(e.inputs[0],"Floor","floor"))},yy=function(e){var t=pd(e.inputs[0].dataType);e.compute(Kp(e.inputs[0],"Gelu",(function(e){return"0.5 * ".concat(e," * (1.0 + erf_vf32(").concat(e," * 0.7071067811865475))")}),hy("vec4<".concat(t,">"),t)))},gy=function(e,t){var n=pd(e.inputs[0].dataType);e.compute(Kp(e.inputs[0],"LeakyRelu",(function(e){return"select(leaky_relu_alpha_ * ".concat(e,", ").concat(e,", ").concat(e," >= vec4<").concat(n,">(0.0))")}),"const leaky_relu_alpha_ = ".concat(n,"(").concat(t.alpha,");"),t.cacheKey))},my=function(e){e.compute(Kp(e.inputs[0],"Not",(function(e){return"!".concat(e)})))},vy=function(e){e.compute(Kp(e.inputs[0],"Neg",(function(e){return"-".concat(e)})))},wy=function(e){e.compute(Kp(e.inputs[0],"Reciprocal",(function(e){return"1.0/".concat(e)})))},by=function(e){var t=pd(e.inputs[0].dataType);e.compute(Kp(e.inputs[0],"Relu",(function(e){return"select(vec4<".concat(t,">(0.0), ").concat(e,", ").concat(e," > vec4<").concat(t,">(0.0))")})))},xy=function(e){e.compute(Kp(e.inputs[0],"Sigmoid",(function(e){return"(1.0 / (1.0 + exp(-".concat(e,")))")})))},_y=function(e){e.compute(Kp(e.inputs[0],"Sin","sin"))},Iy=function(e){e.compute(Kp(e.inputs[0],"Sinh","sinh"))},Ay=function(e){e.compute(Kp(e.inputs[0],"Sqrt","sqrt"))},Cy=function(e){e.compute(Kp(e.inputs[0],"Tan","tan"))},ky=function(e){e.compute(Kp(e.inputs[0],"Tanh","tanh"))},Sy=function(e,t){var n=pd(e.inputs[0].dataType);return e.compute(Kp(e.inputs[0],"ThresholdedRelu",(function(e){return"select(vec4<".concat(n,">(0.0), ").concat(e,", ").concat(e," > thresholded_relu_alpha_)")}),"const thresholded_relu_alpha_ = vec4<".concat(n,">(").concat(t.alpha,");"),t.cacheKey)),0},Ty=function(e){e.compute(Kp(e.inputs[0],"Log","log"))}})),Ew=Bh((function(){ww(),bw(),Tw(),Ey=function(e){if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Oy=function(e){var t=e[0].dims.slice();t[2]=t[2]/2;var n=_d("input",e[0].dataType,e[0].dims,4),r=_d("bias",e[0].dataType,[e[0].dims[2]],4),i=Id("output",e[0].dataType,t,4),o=sd.size(t)/4,a=dd(e[0].dataType);return{name:"BiasSplitGelu",getRunData:function(){return{outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}},getShaderSource:function(t){return"\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ".concat(e[0].dims[2]/4/2,"u;\n\n  ").concat(t.declareVariables(n,r,i),"\n\n  ").concat(hy("vec4<".concat(a,">"),a),"\n\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes(o),"\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ").concat(i.setByOffset("global_idx","valueLeft * geluRight"),"\n  }")}}},Py=function(e){Ey(e.inputs),e.compute(Oy(e.inputs))}})),Ow=Bh((function(){fw(),ww(),bw(),Ry=function(e,t,n,r,i,o,a,s,u,c,l,h,f){var d,p;"string"==typeof s?d=p=function(e,t){return"".concat(s,"((").concat(e,"),(").concat(t,"))")}:"function"==typeof s?d=p=s:(d=s.scalar,p=s.vector);var y,g=h?t.length:t,m=h?n.length:n,v=h?r.length:r,w=Id("outputData",l,v,4),b=_d("aData",u,g,4),x=_d("bData",c,m,4);if(i)if(o){var _=1===sd.size(t),I=1===sd.size(n),A=t.length>0&&t[t.length-1]%4==0,C=n.length>0&&n[n.length-1]%4==0;y=_||I?w.setByOffset("global_idx",p(_?"".concat(b.type.value,"(").concat(b.getByOffset("0"),".x)"):b.getByOffset("global_idx"),I?"".concat(x.type.value,"(").concat(x.getByOffset("0"),".x)"):x.getByOffset("global_idx"))):"\n            let outputIndices = ".concat(w.offsetToIndices("global_idx * 4u"),";\n            let offsetA = ").concat(b.broadcastedIndicesToOffset("outputIndices",w),";\n            let offsetB = ").concat(x.broadcastedIndicesToOffset("outputIndices",w),";\n            ").concat(w.setByOffset("global_idx",p(a||A?b.getByOffset("offsetA / 4u"):"".concat(b.type.value,"(").concat(b.getByOffset("offsetA / 4u"),"[offsetA % 4u])"),a||C?x.getByOffset("offsetB / 4u"):"".concat(x.type.value,"(").concat(x.getByOffset("offsetB / 4u"),"[offsetB % 4u])"))),"\n          ")}else y=w.setByOffset("global_idx",p(b.getByOffset("global_idx"),x.getByOffset("global_idx")));else{if(!o)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");var k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="aData[indexA".concat(t,"][componentA").concat(t,"]"),i="bData[indexB".concat(t,"][componentB").concat(t,"]");return"\n            let outputIndices".concat(t," = ").concat(w.offsetToIndices("global_idx * 4u + ".concat(t,"u")),";\n            let offsetA").concat(t," = ").concat(b.broadcastedIndicesToOffset("outputIndices".concat(t),w),";\n            let offsetB").concat(t," = ").concat(x.broadcastedIndicesToOffset("outputIndices".concat(t),w),";\n            let indexA").concat(t," = offsetA").concat(t," / 4u;\n            let indexB").concat(t," = offsetB").concat(t," / 4u;\n            let componentA").concat(t," = offsetA").concat(t," % 4u;\n            let componentB").concat(t," = offsetB").concat(t," % 4u;\n            ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(d(r,i),");\n          ")};y=9===l?"\n            var data = vec4<u32>(0);\n            ".concat(k("data",0,"u32"),"\n            ").concat(k("data",1,"u32"),"\n            ").concat(k("data",2,"u32"),"\n            ").concat(k("data",3,"u32"),"\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));"):"\n            ".concat(k("outputData[global_idx]",0),"\n            ").concat(k("outputData[global_idx]",1),"\n            ").concat(k("outputData[global_idx]",2),"\n            ").concat(k("outputData[global_idx]",3),"\n          ")}return"\n        ".concat(e.registerUniform("vec_size","u32").declareVariables(b,x,w),"\n\n        ").concat(null!==f&&void 0!==f?f:"","\n\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n        ").concat(y,"\n      }")},By=function(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:n.dataType,s=!sd.areEqual(n.dims,r.dims),u=n.dims,c=sd.size(n.dims),l=!1,h=!1,f=[s];if(s){var d=ad.calcShape(n.dims,r.dims,!1);if(!d)throw new Error("Can't perform binary op on the given tensors");u=d,c=sd.size(u);var p=1===sd.size(n.dims),y=1===sd.size(r.dims),g=n.dims.length>0&&n.dims[n.dims.length-1]%4==0,m=r.dims.length>0&&r.dims[r.dims.length-1]%4==0;f.push(p),f.push(y),f.push(g),f.push(m);for(var v=1,w=1;w<u.length;w++){var b,x,_=null!==(b=n.dims[n.dims.length-w])&&void 0!==b?b:1;if(_!==(null!==(x=r.dims[r.dims.length-w])&&void 0!==x?x:1))break;v*=_}v%4==0?(h=!0,l=!0):(p||y||g||m)&&(l=!0)}else l=!0;f.push(l);var I=Td(n.dims.length)&&Td(r.dims.length)&&Td(u.length);return{name:e,shaderCache:{hint:t+f.map((function(e){return e.toString()})).join("_"),inputDependencies:I?["rank","rank"]:["dims","dims"]},getShaderSource:function(e){return Ry(e,n.dims,r.dims,u,l,s,h,i,n.dataType,r.dataType,a,I,o)},getRunData:function(){return{outputs:[{dims:u,dataType:a}],dispatchGroup:{x:Math.ceil(c/64/4)},programUniforms:I?[{type:"uint32",data:Math.ceil(sd.size(u)/4)}].concat(_toConsumableArray(yd(n.dims)),_toConsumableArray(yd(r.dims)),_toConsumableArray(yd(u))):[{type:"uint32",data:Math.ceil(sd.size(u)/4)}]}}}},Dy=function(e,t,n,r,i,o){e.compute(By(t,null!==i&&void 0!==i?i:"",e.inputs[0],e.inputs[1],n,r,o))},My=function(e){Dy(e,"Add",(function(e,t){return"".concat(e,"+").concat(t)}))},Ly=function(e){Dy(e,"Div",(function(e,t){return"".concat(e,"/").concat(t)}))},Fy=function(e){Dy(e,"Equal",{scalar:function(e,t){return"u32(".concat(e,"==").concat(t,")")},vector:function(e,t){return"vec4<u32>(".concat(e,"==").concat(t,")")}},void 0,void 0,9)},Ny=function(e){Dy(e,"Mul",(function(e,t){return"".concat(e,"*").concat(t)}))},Uy=function(e){var t=_d("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;Dy(e,"Pow",{scalar:function(e,t){return"pow_custom(".concat(e,",").concat(t,")")},vector:function(e,t){return"pow_vector_custom(".concat(e,",").concat(t,")")}},"\n    fn pow_custom(a : ".concat(t,", b : ").concat(t,") -> ").concat(t," {\n      if (b == ").concat(t,"(0.0)) {\n        return ").concat(t,"(1.0);\n      } else if (a < ").concat(t,"(0.0) && f32(b) != floor(f32(b))) {\n        return ").concat(t,"(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ").concat(t,"(1.0), round(f32(abs(b) % ").concat(t,"(2.0))) != 1.0) * ").concat(t,"(").concat("i32"===t?"round":"","(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<").concat(t,">, b : vec4<").concat(t,">) -> vec4<").concat(t,"> {\n      // TODO: implement vectorized pow\n      return vec4<").concat(t,">(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      "))},jy=function(e){Dy(e,"Sub",(function(e,t){return"".concat(e,"-").concat(t)}))},Gy=function(e){Dy(e,"Greater",{scalar:function(e,t){return"u32(".concat(e,">").concat(t,")")},vector:function(e,t){return"vec4<u32>(".concat(e,">").concat(t,")")}},void 0,void 0,9)},zy=function(e){Dy(e,"Less",{scalar:function(e,t){return"u32(".concat(e,"<").concat(t,")")},vector:function(e,t){return"vec4<u32>(".concat(e,"<").concat(t,")")}},void 0,void 0,9)},Hy=function(e){Dy(e,"GreaterOrEqual",{scalar:function(e,t){return"u32(".concat(e,">=").concat(t,")")},vector:function(e,t){return"vec4<u32>(".concat(e,">=").concat(t,")")}},void 0,void 0,9)},Vy=function(e){Dy(e,"LessOrEqual",{scalar:function(e,t){return"u32(".concat(e,"<=").concat(t,")")},vector:function(e,t){return"vec4<u32>(".concat(e,"<=").concat(t,")")}},void 0,void 0,9)}})),Pw=Bh((function(){ww(),vw(),bw(),Wy=function(e){if(!e||e.length<1)throw new Error("too few inputs");var t,n=e[0].dataType,r=e[0].dims.length,i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(o.dataType!==n)throw new Error("input tensors should be one type");if(o.dims.length!==r)throw new Error("input tensors should have the same shape")}}catch(a){i.e(a)}finally{i.f()}},$y=function(e,t){return"\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ".concat(e,"u>(").concat(t,");\n    for (var i: u32 = 0u; i < ").concat(e,"; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ").concat(e,"u;\n  }")},Yy=function(e,t){for(var n=e.length,r=[],i=0;i<n;++i){var o=t.setByOffset("global_idx",e[i].getByIndices("indices"));1===n?r.push(o):0===i?r.push("if (inputIndex == ".concat(i,"u) { ").concat(o," }")):i===n-1?r.push("else { ".concat(o," }")):r.push("else if (inputIndex == ".concat(i,") { ").concat(o," }"))}return r.join("\n")},Ky=function(e,t){var n=e[0].dims.slice();if(t>=n.length||t<-1*n.length)throw new Error("axis specified for concat doesn't match input dimensionality");for(var r=t<0?n.length+t:t,i=n.slice(0),o=1;o<e.length;o++)for(var a=e[o].dims.slice(),s=0;s<n.length;s++)if(s===r)i[r]+=a[s];else if(n[s]!==a[s])throw new Error("non concat dimensions must match");for(var u=sd.size(i),c=new Array(e.length),l=new Array(e.length),h=e[0].dataType,f=0,d=[],p=[],y=[],g=[{type:"uint32",data:u}],m=0;m<e.length;++m)f+=e[m].dims[r],c[m]=f,y.push(Td(e[m].dims.length)),p.push(y[m]?e[m].dims.length:e[m].dims),l[m]=_d("input".concat(m),h,p[m]),d.push(y[m]?"rank":"dims"),g.push({type:"uint32",data:c[m]});for(var v=0;v<e.length;++v)y[v]&&g.push.apply(g,_toConsumableArray(yd(e[v].dims)));var w=Td(i.length);w&&g.push.apply(g,_toConsumableArray(yd(i)));var b=w?i.length:i,x=Id("output",h,b),_=x.indicesGet("indices",r),I=Array.from(Array(c.length).keys()).map((function(e){return"uniforms.sizeInConcatAxis".concat(e)})).join(",");return{name:"Concat",shaderCache:{hint:"".concat(t),inputDependencies:d},getRunData:function(){return{outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:g}},getShaderSource:function(t){return"\n\n  ".concat(function(){t.registerUniform("outputSize","u32");for(var n=0;n<e.length;n++)t.registerUniform("sizeInConcatAxis".concat(n),"u32");return t.declareVariables.apply(t,l.concat([x]))}(),"\n\n  ").concat($y(c.length,I),"\n\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n    var indices = ").concat(x.offsetToIndices("global_idx"),";\n\n    let inputIndex = calculateInputIndex(").concat(_,");\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ").concat(c.length,"u>(").concat(I,");\n      ").concat(_," -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ").concat(Yy(l,x),"\n  }")}}},Xy=function(e,t){Wy(e.inputs),e.compute(Ky(e.inputs,t.axis))},Zy=function(e){return id({axis:e.axis})}})),Rw=Bh((function(){ww(),qy=function(e,t){switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:"value = max(value, ".concat(t,"(0.0));")};case"Sigmoid":return{activationFunction:"",applyActivation:"value = (".concat(t,"(1.0) / (").concat(t,"(1.0) + exp(-value)));")};case"Clip":return{activationFunction:"const clip_min_=".concat(t,"(").concat(e.clipMin,");const clip_max_=").concat(t,"(").concat(e.clipMax,");"),applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},Jy=function(e){var t=(null===e||void 0===e?void 0:e.activation)||"";if("Clip"===t){var n=_slicedToArray((null===e||void 0===e?void 0:e.activation_params)||[ld,hd],2),r=n[0],i=n[1];return{activation:t,clipMax:i,clipMin:r,activationCacheKey:"".concat(t,":").concat(r,",").concat(i)}}return{activation:t,activationCacheKey:t}}})),Bw=Bh((function(){Qy=function(e,t){switch(e){case 1:return t;case 2:return"vec2<".concat(t,">");case 3:return"vec3<".concat(t,">");case 4:return"vec4<".concat(t,">");default:throw new Error("".concat(e,"-component is not supported."))}},eg=function(e){return"\n      ".concat(e?"value = value + getBiasByOutputCoords(coords);":"","\n      ")}})),Dw=Bh((function(){tg=function(e){return"\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(".concat(e,".x), i32(").concat(e,".y), i32(").concat(e,".z), 1));\n}\n")}})),Mw=Bh((function(){ww(),bw(),Rw(),Bw(),ng=function(e,t){return e?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol".concat(t?", batchIndices":"",");\n        "):"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol".concat(t?", batchIndices":"",");\n        ")},rg=function(e,t){return e?"\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ".concat(3===t?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];","\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ").concat(3===t?"":"acc[i] = BCached3 * ACached3[i] + acc[i];","\n        }"):"\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ".concat(3===t?"":"acc[i] = BCached3 * ACached.w + acc[i];","\n        }")},ig=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"f32",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:32,u=t[1]*e[1],c=t[0]*e[0],l=i?u:o,h=i?o:u,f=l/t[0],d=o/t[1];if((!i||4!==f||4!==e[1])&&(i||3!==f&&4!==f)||l%t[0]!=0||o%t[1]!=0||4!==e[0])throw new Error("If transposeA ".concat(i," is true, innerElementSize ").concat(f," and workPerThread[1] ").concat(e[1]," must be 4.\n      Otherwise, innerElementSize ").concat(f," must be 3 or 4.\n  tileAWidth ").concat(l," must be divisible by workgroupSize[0]").concat(t[0],". tileInner ").concat(o," must be divisible by workgroupSize[1] ").concat(t[1],". colPerThread ").concat(e[0]," must be 4."));return"\nvar<workgroup> mm_Asub: array<array<vec".concat(f,"<").concat(n,">, ").concat(l/f,">, ").concat(h,">;\nvar<workgroup> mm_Bsub: array<array<vec4<").concat(n,">, ").concat(c/e[0],">, ").concat(o,">;\n\nconst rowPerThread = ").concat(e[1],";\nconst colPerThread = ").concat(e[0],";\nconst innerElementSize = ").concat(f,";\nconst tileInner = ").concat(o,";\n\n@compute @workgroup_size(").concat(t[0],", ").concat(t[1],", ").concat(t[2],")\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ").concat(a?"0":"i32(globalId.z)",";\n  ").concat(r?"let batchIndices = ".concat(r.offsetToIndices("u32(batch)"),";"):"","\n  let globalRowStart = i32(workgroupId.y) * ").concat(u,";\n\n  let numTiles = ").concat(a?"".concat(Math.ceil(s/o)):"(uniforms.dimInner - 1) / tileInner + 1",";\n  var kStart = ").concat(a?"i32(globalId.z) * ".concat(s):"0",";\n\n  var acc: array<vec4<").concat(n,">, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ").concat(d,";\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ").concat(ng(i,r),"\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ").concat(d,"; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol").concat(r?", batchIndices":"",");\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ").concat(3===f?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];","\n\n          ").concat(rg(i,f),"\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}")},og=function(e,t){return e?"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol".concat(t?", batchIndices":"",");\n            "):"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol".concat(t?", batchIndices":"",");\n            ")},ag=function(e){return e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];"},sg=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"f32",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:32,u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=e[1]*t[1],l=e[0]*t[0],h=i?c:o,f=i?o:c;if(f%t[1]!=0||h%t[0]!=0||o%t[1]!=0)throw new Error("tileAHight ".concat(f," must be divisible by workgroupSize[1]").concat(t[1],", tileAWidth ").concat(h," must be divisible by workgroupSize[0]").concat(t[0],", tileInner ").concat(o," must be divisible by workgroupSize[1]").concat(t[1]));var d=f/t[1],p=h/t[0],y=o/t[1],g=u?"\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ".concat(c,";\n    let globalColStart = i32(workgroupId.x) * ").concat(l,";\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ").concat(f,"; inputRow = inputRow + ").concat(t[1],") {\n        for (var inputCol = localCol; inputCol < ").concat(h,"; inputCol = inputCol + ").concat(t[0],") {\n          ").concat(og(i,r),"\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ").concat(o,"; inputRow = inputRow + ").concat(t[1],") {\n            for (var inputCol = localCol; inputCol < ").concat(l,"; inputCol = inputCol + ").concat(t[0],") {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol").concat(r?", batchIndices":"",");\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<").concat(n,", colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ").concat(t[0],"];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ").concat(i?"mm_Asub[k][localRow + innerRow * ".concat(t[1],"];"):"mm_Asub[localRow + innerRow * ".concat(t[1],"][k];"),"\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ").concat(t[1],";\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ").concat(t[0],";\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    "):"\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ".concat(c,";\n\nlet tileRowA = i32(localId.y) * ").concat(d,";\nlet tileColA = i32(localId.x) * ").concat(p,";\nlet tileRowB = i32(localId.y) * ").concat(y,";\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ").concat(d,"; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ").concat(p,"; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ").concat(og(i,r),"\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ").concat(y,"; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol").concat(r?", batchIndices":"",");\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<").concat(n,", colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ").concat(ag(i),"\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n");return"\n  var<workgroup> mm_Asub : array<array<".concat(n,", ").concat(h,">, ").concat(f,">;\n  var<workgroup> mm_Bsub : array<array<").concat(n,", ").concat(l,">, ").concat(o,">;\n  const rowPerThread = ").concat(e[1],";\n  const colPerThread = ").concat(e[0],";\n  const tileInner = ").concat(o,";\n\n@compute @workgroup_size(").concat(t[0],", ").concat(t[1],", ").concat(t[2],")\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ").concat(a?"0":"i32(globalId.z)",";\n    ").concat(r?"let batchIndices = ".concat(r.offsetToIndices("u32(batch)"),";"):"","\n    let numTiles = ").concat(a?"".concat(Math.ceil(s/o)):"(uniforms.dimInner - 1) / tileInner + 1",";\n    var kStart = ").concat(a?"i32(globalId.z) * ".concat(s):"0",";\n\n    var acc : array<array<").concat(n,", colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ").concat(g,"\n  }\n")},ug=function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=_slicedToArray(i,3),s=a[0],u=a[1],c=a[2],l=_slicedToArray(r,4),h=l[0],f=l[1],d=l[2],p=l[3],y=Sd(s,c),g=Sd(u,c),m=dd(r[0].type.tensor);return"\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ".concat(h.type.indices,") -> ").concat(Qy(e,m)," {\n      var value = ").concat(Qy(e,m),"(0.0);\n      let col = colIn * ").concat(e,";\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ").concat(function(){for(var e=f.rank,t=h.rank,n="var aIndices: ".concat(f.type.indices,";"),r=e-2-1,i=t-1;r>=0;r--,i--)n+="\naIndices[".concat(r,"] = ").concat(t>1?"batchIndices[".concat(i,"]"):"batchIndices",";");return y.forEach((function(e){n+="\naIndices[".concat(e,"] = 0;")})),n+="\naIndices[".concat(e-2,"] = u32(row);\n                   aIndices[").concat(e-1,"] = u32(colIn);")}(),"\n        value = ").concat(f.getByIndices("aIndices"),";\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ").concat(h.type.indices,") -> ").concat(Qy(e,m)," {\n      var value = ").concat(Qy(e,m),"(0.0);\n      let col = colIn * ").concat(e,";\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ").concat(function(){for(var e=d.rank,t=h.rank,n="var bIndices: ".concat(d.type.indices,";"),r=e-2-1,i=t-1;r>=0;r--,i--)n+="\nbIndices[".concat(r,"] = ").concat(t>1?"batchIndices[".concat(i,"]"):"batchIndices",";");return g.forEach((function(e){n+="\nbIndices[".concat(e,"] = 0;")})),n+="\nbIndices[".concat(e-2,"] = u32(row);\n                   bIndices[").concat(e-1,"] = u32(colIn);")}(),"\n        value = ").concat(d.getByIndices("bIndices"),";\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ").concat(Qy(e,m),") {\n      let col = colIn * ").concat(e,";\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ").concat(t?"value = value + ".concat(o?"bias[colIn]":"".concat(Qy(e,m),"(bias[row])"),";"):"","\n        ").concat(n,"\n        ").concat(p.setByIndices("vec3<u32>(coords)","value"),"\n      }\n    }\n    ")},cg=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=e[0].dims,a=e[1].dims,s=o.slice(0,-2),u=a.slice(0,-2),c=r?r.slice(0,-2):n.slice(0,-2),l=Td(c.length),h=l?c.length:c,f=Ad("batchDims",e[0].dataType,h,1),d=sd.size(c),p=o[o.length-2],y=o[o.length-1],g=a[a.length-1],m=y%4==0&&g%4==0,v=p<=8?[4,1,1]:[4,4,1],w=[8,8,1],b=[Math.ceil(g/w[0]/v[0]),Math.ceil(p/w[1]/v[1]),Math.ceil(d/w[2]/v[2])],x=dd(e[0].dataType),_=m?4:1,I=[].concat(_toConsumableArray(s),[p,y/_]),A=Td(I.length),C=A?I.length:I,k=[].concat(_toConsumableArray(u),[y,g/_]),S=Td(k.length),T=S?k.length:k,E=[d,p,g/_],O=_d("a",e[0].dataType,C,_),P=_d("b",e[1].dataType,T,_),R=Id("result",e[0].dataType,E.length,_),B=[O,P],D=[{type:"int32",data:p},{type:"int32",data:g},{type:"int32",data:y}];l&&D.push.apply(D,_toConsumableArray(yd(c))),A&&D.push.apply(D,_toConsumableArray(yd(I))),S&&D.push.apply(D,_toConsumableArray(yd(k)));var M=[];M.push(A?"rank":"dims"),M.push(S?"rank":"dims");var L=e.length>2,F=qy(t,R.type.value),N=F.activationFunction,U=F.applyActivation,j=ug(_,L,U,[f,O,P,R],[s,u,c],i);if(L){var G=i?_:1;B.push(_d("bias",e[2].dataType,e[2].dims.length,G)),D.push.apply(D,_toConsumableArray(yd(e[2].dims))),M.push("rank")}return D.push.apply(D,_toConsumableArray(yd(E))),{name:"MatMul",shaderCache:{hint:t.activationCacheKey+"".concat(v).concat(m).concat(i),inputDependencies:M},getRunData:function(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:D}},getShaderSource:function(e){var t;return"\n  ".concat((t=e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(f)).declareVariables.apply(t,B.concat([R])),"\n  ").concat(N,"\n  ").concat(j,"\n  ").concat(m?ig(v,w,x,f):sg(v,w,x,f),"\n                   ")}}}})),Lw=Bh((function(){pw(),bw(),Rw(),Bw(),Dw(),Mw(),lg=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:4,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"f32",l=e?"\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    ":"\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    ",h=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",f=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",d=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",p=e?"row":"col",y=e?"col":"row",g="\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ".concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n    let outRow = ").concat(p," / outWidth;\n    let outCol = ").concat(p," % outWidth;\n\n    let WRow = ").concat(y," / (filterDims[1] * inChannels);\n    let WCol = ").concat(y," / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ").concat(y," % inChannels;\n    var resData = ").concat(Qy(a,c),"(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the 'same' padding type.\n    if (xRow >= 0 && xRow < ").concat(f," && xCol >= 0 && xCol < ").concat(d,") {\n      ").concat(l,"\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ").concat(function(e){switch(e){case 1:return"resData = x[xIndex];";case 3:return"resData = vec3<".concat(c,">(x[xIndex], x[xIndex + 1], x[xIndex + 2]);");case 4:return"resData = x[xIndex / 4];";default:throw new Error("innerElementSize ".concat(e," is not supported."))}}(a),"\n    }\n    return resData;"),m=e?t&&r?"\n    let col = colIn * ".concat(a,";\n    ").concat(g):"\n    let col = colIn * ".concat(a,";\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ").concat(g,"\n    }\n    return ").concat(Qy(a,c),"(0.0);"):r&&n?"\n    let col = colIn * ".concat(a,";\n    ").concat(g):"\n    let col = colIn * ".concat(a,";\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ").concat(g,"\n    }\n    return ").concat(Qy(a,c),"(0.0);"),v="".concat(function(e){switch(e){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error("innerElementSize ".concat(e," is not supported."))}}(s)),w=Qy(u,c),b=Qy(e?a:s,c),x=Qy(e?s:a,c),_=qy(o,w),I=_.activationFunction,A=_.applyActivation;return"\n    ".concat(I,"\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ").concat(b," {\n      ").concat(e?m:v,"\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ").concat(x," {\n      ").concat(e?v:m,"\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ").concat(w,") {\n      let col = colIn * ").concat(u,";\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ").concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n      ").concat(h,"\n      ").concat(eg(i),"\n      ").concat(A,"\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }")},hg=function(e,t,n,r,i,o,a,s){var u="NHWC"===t.format,c=u?e[0].dims[3]:e[0].dims[1],l=n[0],h=u?n[2]:n[3],f=u?n[1]:n[2],d=u?n[3]:n[1],p=u&&(c%4==0||c%3==0)&&d%4==0,y=u?d:h*f,g=u?h*f:d,m=[8,8,1],v=r<=8?[4,1,1]:[4,4,1],w=[Math.ceil(y/m[0]/v[0]),Math.ceil(g/m[1]/v[1]),Math.ceil(l/m[2]/v[2])];Xf("verbose",(function(){return"[conv2d_mm_webgpu] dispatch = ".concat(w)}));var b=p?u&&c%4!=0?3:4:1,x=m[1]*v[1],_=m[0]*v[0],I=Math.max(m[0]*b,m[1]),A=r%x==0,C=i%_==0,k=o%I==0,S=p?[b,4,4]:[1,1,1],T=dd(e[0].dataType),E=p?4:1,O=[{type:"int32",data:r},{type:"int32",data:i},{type:"int32",data:o}],P=[_d("x",e[0].dataType,e[0].dims.length,3===b?1:b),_d("w",e[1].dataType,e[1].dims.length,E)];O.push.apply(O,_toConsumableArray(yd(e[0].dims))),O.push.apply(O,_toConsumableArray(yd(e[1].dims)));var R="\n      fn setOutputAtIndex(flatIndex : i32, value : ".concat(p?"vec4<".concat(T,">"):T,") {\n        result[flatIndex] = ").concat(p?"vec4<".concat(T,">"):T,"(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ").concat(p?"vec4<".concat(T,">"):T,") {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ").concat(p?"/ 4":"",", value);\n      }");if(a){var B=_d("bias",e[2].dataType,e[2].dims.length,E);P.push(B),O.push.apply(O,_toConsumableArray(yd(e[2].dims))),R+="\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ".concat(p?"vec4<".concat(T,">"):T," {\n          return bias[coords.").concat(u?"w":"y").concat(p?"/ 4":"","];\n        }")}var D=Id("result",e[0].dataType,n.length,E);return O.push.apply(O,_toConsumableArray(yd(n))),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:function(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:w[0],y:w[1],z:w[2]},programUniforms:O}},getShaderSource:function(e){var n;return"\n        ".concat(tg("uniforms.result_strides"),"\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ").concat((n=e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32")).declareVariables.apply(n,P.concat([D])),"\n        const filterDims : vec2<i32> = vec2<i32>(").concat(t.kernelShape[0],", ").concat(t.kernelShape[1],");\n        const pad : vec2<i32> = vec2<i32>(").concat(t.pads[0],", ").concat(t.pads[1],");\n        const stride : vec2<i32> = vec2<i32>(").concat(t.strides[0],", ").concat(t.strides[1],");\n        const dilation : vec2<i32> = vec2<i32>(").concat(t.dilations[0],", ").concat(t.dilations[1],");\n        ").concat(R,"\n        ").concat(lg(u,A,C,k,a,t,S[0],S[1],S[2],T),"\n            ").concat(p?ig(v,m,T,void 0,!u,I):sg(v,m,T,void 0,!u,I,!1,void 0,s))}}}})),Fw=Bh((function(){ww(),bw(),Uw(),Rw(),fg=function(e,t,n){var r=e.length>2,i=r?"value += b[output_channel];":"",o=e[0].dims,a=e[1].dims,s=a[0]/t.group,u="NHWC"===t.format,c=gg(o,a,t.dilations,t.pads,t.strides,u),l=sd.size(c),h=Id("output",e[0].dataType,c),f=qy(t,h.type.value),d=f.activationFunction,p=f.applyActivation,y=_d("x",e[0].dataType,o),g=_d("w",e[1].dataType,a),m=[y,g];return r&&m.push(_d("b",e[2].dataType,e[2].dims)),{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:function(){return{outputs:[{dims:n?n(c):c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)}}},getShaderSource:function(e){return"\n  const strides: vec2<u32> = vec2(".concat(t.strides[0],"u, ").concat(t.strides[1],"u);\n  const pads: vec2<u32> = vec2(").concat(t.pads[0],"u, ").concat(t.pads[1],"u);\n\n  ").concat(e.declareVariables.apply(e,m.concat([h])),"\n\n  ").concat(d,"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(l),"\n\n    let outputIndices = ").concat(h.offsetToIndices("global_idx"),";\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[").concat(u?3:1,"];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[").concat(u?1:2,"], outputIndices[").concat(u?2:3,"]) * strides - pads;\n    let group_id: u32 = output_channel / ").concat(s,"u;\n\n    var value: ").concat(h.type.value," = ").concat(h.type.value,"(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ").concat(a[1],"u; wInChannel++) {\n      let input_channel = group_id * ").concat(a[1],"u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ").concat(a[2],"u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ").concat(t.dilations[0],"u;\n\n        if (xHeight < 0u || xHeight >= ").concat(o[u?1:2],"u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ").concat(a[3],"u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ").concat(t.dilations[1],"u;\n          if (xWidth < 0u || xWidth >= ").concat(o[u?2:3],"u) {\n            continue;\n          }\n\n          let xVal = ").concat(u?y.get("batch","xHeight","xWidth","input_channel"):y.get("batch","input_channel","xHeight","xWidth"),";\n          let wVal = ").concat(g.get("output_channel","wInChannel","wHeight","wWidth"),";\n          value += xVal*wVal;\n        }\n      }\n    }\n    ").concat(i,"\n    ").concat(p,"\n    ").concat(h.setByOffset("global_idx","value"),"\n  }")}}}})),Nw=Bh((function(){ww(),Mw(),bw(),Rw(),dg=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=e[0].dims,a=e[1].dims,s=o[o.length-2],u=a[a.length-1],c=o[o.length-1],l=gd(u),h=gd(c),f=gd(s),d=sd.size(n)/l/f,p=e.length>2,y=r?r.slice(0,-2):n.slice(0,-2),g=[sd.size(y),s,u],m=[{type:"uint32",data:d},{type:"uint32",data:s},{type:"uint32",data:u},{type:"uint32",data:c}].concat(_toConsumableArray(yd(y)),_toConsumableArray(yd(o)),_toConsumableArray(yd(a)));return p&&m.push.apply(m,_toConsumableArray(yd(e[2].dims))),m.push.apply(m,_toConsumableArray(yd(g))),{name:"MatMulNaive",shaderCache:{hint:"".concat(t.activationCacheKey,"_").concat(l,"_").concat(h,"_").concat(f,"_").concat(i),inputDependencies:p?["rank","rank","rank"]:["rank","rank"]},getRunData:function(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:m}},getShaderSource:function(r){var s,u=Ad("batch_dims",e[0].dataType,y.length),c=_d("a",e[0].dataType,o.length,h),d=_d("b",e[1].dataType,a.length,l),m=Id("output",e[0].dataType,g.length,l),v=qy(t,m.type.value),w=v.activationFunction,b=v.applyActivation,x=[c,d],_="";if(p){var I=i?l:1;x.push(_d("bias",e[2].dataType,e[2].dims.length,I)),_=""+(i?"value += bias[col / ".concat(I,"];"):"value += ".concat(m.type.value,"(bias[row + i]);"))}var A=o.slice(0,-2),C=a.slice(0,-2),k=Sd(A,y),S=Sd(C,y),T=function(e,t){var n=e.rank,r=e.name;if(2===n)return"var ".concat(r,"_indices = ").concat(e.type.indices,"(0u, 0u);");for(var i=u.rank,o="var ".concat(r,"_indices: ").concat(e.type.indices,";"),a=n-2-1,s=i-1;a>=0;a--,s--)o+="\n".concat(r,"_indices[").concat(a,"] = ").concat(i>1?"batch_indices[".concat(s,"]"):"batch_indices",";");return t.forEach((function(e){o+="\n".concat(r,"_indices[").concat(e,"] = 0;")})),o+="".concat(r,"_indices[").concat(n-2,"] = 0u;\n                     ").concat(r,"_indices[").concat(n-1,"] = 0u;")};return"\n  ".concat((s=r.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(u)).declareVariables.apply(s,x.concat([m])),"\n  ").concat(w,"\n  ").concat(r.mainStart(),"\n    ").concat(r.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n    let col = (global_idx % (uniforms.N / ").concat(l,")) * ").concat(l,";\n    var index1 = global_idx / (uniforms.N / ").concat(l,");\n    let stride1 = uniforms.M / ").concat(f,";\n    let row = (index1 % stride1) * ").concat(f,";\n    let batch = index1 / stride1;\n\n    ").concat(2===n.length?"":"let batch_indices = ".concat(u.offsetToIndices("batch"),";"),"\n    ").concat(T(c,k),"\n    let a_offset = ").concat(c.indicesToOffset("a_indices"),";\n    ").concat(T(d,S),"\n    let b_offset = ").concat(d.indicesToOffset("b_indices"),";\n    var values: array<").concat(m.type.value,", ").concat(f,">;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ").concat(h,") {\n      ").concat(function(){for(var e="var a_data: ".concat(c.type.value,";"),t=0;t<h;t++)e+="\n              let b_data".concat(t," = b[(b_offset + (k + ").concat(t,") * uniforms.N + col) / ").concat(l,"];");for(var n=0;n<f;n++){e+="a_data = a[(a_offset + (row + ".concat(n,") * uniforms.K + k) / ").concat(h,"];");for(var r=0;r<h;r++)e+="\n            values[".concat(n,"] = fma(").concat(d.type.value,"(a_data").concat(1===h?"":"[".concat(r,"]"),"), b_data").concat(r,", values[").concat(n,"]);\n")}return e}(),"\n    }\n    for (var i = 0u; i < ").concat(f,"u; i++) {\n      var value = values[i];\n      ").concat(_,"\n      ").concat(b,"\n      let cur_indices = ").concat(m.type.indices,"(batch, row + i, col);\n      let offset = ").concat(m.indicesToOffset("cur_indices"),";\n      ").concat(m.setByOffset("offset / ".concat(l),"value"),";\n    }\n  }\n  ")}}},pg=function(e){if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},yg=function(e){pg(e.inputs);var t=ad.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");var n=t[t.length-1],r=e.inputs[0].dims[e.inputs[0].dims.length-1];n<8&&r<8?e.compute(dg(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(cg(e.inputs,{activation:"",activationCacheKey:""},t))}})),Uw=Bh((function(){ww(),vw(),Lw(),Mw(),Fw(),Rw(),Nw(),xw(),gg=function(e,t,n,r,i,o){var a=e[0],s=e.slice(o?1:2,o?3:4),u=s.length,c=t[0],l=t.slice(2).map((function(e,t){return e+(e-1)*(n[t]-1)})),h=s.map((function(e,t){return e+r[t]+r[t+u]})).map((function(e,t){return Math.floor((e-l[t]+i[t])/i[t])}));return h.splice(0,0,a),h.splice(o?3:1,0,c),h},mg=[2,3,1,0],vg=function(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");var n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error("dilations should be ".concat(n,"D"));if(t.strides.length!==n)throw new Error("strides should be ".concat(n,"D"));if(t.pads.length!==2*n)throw new Error("pads should be ".concat(2*n,"D"));if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},wg=function(e,t){for(var n=e.kernelShape.slice(),r=2;r<t[1].dims.length;++r)0===n[r-2]&&(n[r-2]=t[1].dims[r]);var i=e.pads.slice();ud.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,n,i,"NHWC"===e.format,e.autoPad);var o=Object.assign({},e);return Object.assign(o,{kernelShape:n,pads:i,cacheKey:e.cacheKey}),o},bg=function(e){var t=Jy(e),n=e.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,o=e.group,a=e.kernel_shape,s=e.pads,u=e.strides,c=e.w_is_const();return id(_objectSpread({autoPad:r,format:n,dilations:i,group:o,kernelShape:a,pads:s,strides:u,wIsConst:c},t))},xg=function(e,t,n){var r,i=wg(n,t),o="NHWC"===n.format;if(1===n.group){var a=3===t.length,s=t[0].dims[o?1:2],u=t[0].dims[o?2:3],c=t[0].dims[o?3:1],l=t[1].dims[2],h=t[1].dims[3],f=gg(t[0].dims,t[1].dims,n.dilations,i.pads,n.strides,o),d=f[o?1:2],p=f[o?2:3],y=f[o?3:1],g=o&&l===s&&h===u&&0===n.pads[0]&&0===n.pads[1];if(g||1===l&&1===h&&1===n.dilations[0]&&1===n.dilations[1]&&1===n.strides[0]&&1===n.strides[1]&&0===n.pads[0]&&0===n.pads[1]){var m,v,w,b=f[0],x=[];if(o){var _,I=null!==(_=e.kernelCustomData.wT)&&void 0!==_?_:e.compute(Bd(t[1],mg),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];if(n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=I),g){var A=s*u*c;m=t[0].reshape([1,b,A]),v=I.reshape([1,A,y]),w=[1,b,y]}else m=t[0].reshape([b,s*u,c]),v=I.reshape([1,c,y]),w=[b,d*p,y];x.push(m),x.push(v)}else m=t[0].reshape([b,c,s*u]),v=t[1].reshape([1,y,c]),w=[b,y,d*p],x.push(v),x.push(m);a&&x.push(t[2]);var C=w[2],k=x[0].dims[x[0].dims.length-1];C<8&&k<8?e.compute(dg(x,i,f,w,o),{inputs:x}):e.compute(cg(x,i,f,w,o),{inputs:x})}else{var S=null!==(r=e.kernelCustomData.wT)&&void 0!==r?r:e.compute(Bd(t[1],mg),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=S);var T=[t[0],S];a&&T.push(t[2]);var E=o?d*p:y,O=o?y:d*p,P=l*h*c;e.compute(hg(T,i,f,E,O,P,a,!0),{inputs:T})}}else e.compute(fg(t,i))},_g=function(e,t){var n="NHWC"===t.format,r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&r.push(e.inputs[2]);var i=[0,t.pads[0],0,t.pads[1]],o=[1].concat(t.strides),a=[1].concat(t.dilations),s=[1].concat(t.kernelShape),u=wg(_objectSpread(_objectSpread({},t),{},{pads:i,strides:o,dilations:a,kernelShape:s}),r);e.compute(fg(r,u,(function(e){return n?[e[0],e[2],e[3]]:[]})))},Ig=function(e,t){vg(e.inputs,t),3===e.inputs[0].dims.length?_g(e,t):xg(e,e.inputs,t)}})),jw=Bh((function(){pw(),bw(),Rw(),Bw(),Dw(),Mw(),Ag=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,i=Qy(r,"f32"),o=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",a=e?"row":"col",s=e?"col":"row",u="\n      let inChannels = ".concat(e?"outBackprop[3]":"outBackprop[1]",";\n      let outWidth = ").concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n      let outRow = ").concat(a," / outWidth;\n      let outCol = ").concat(a," % outWidth;\n\n      let WRow = ").concat(s," / (filterDims[1] * inChannels);\n      let WCol = ").concat(s," / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(").concat(e?"outBackprop[1]":"outBackprop[2]",") || fract(xR) > 0.0) {\n        return ").concat(i,"(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(").concat(e?"outBackprop[2]":"outBackprop[3]",") || fract(xC) > 0.0) {\n        return ").concat(i,"(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ").concat(s," % inChannels;\n      ").concat(e?"\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      ":"\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      ","\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/").concat(r,"];"),c=e?"\n      let col = colIn * ".concat(r,";\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ").concat(u,"\n      }\n      return ").concat(i,"(0.0);"):"\n      let col = colIn * ".concat(r,";\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ").concat(u,"\n      }\n      return ").concat(i,"(0.0);"),l="\n      let col = colIn * ".concat(r,";\n      let inChannels = ").concat(e?"outBackprop[3]":"outBackprop[1]",";\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (").concat(e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter","  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ").concat(function(e){switch(e){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return"\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            ";default:throw new Error("innerElementSize ".concat(e," is not supported."))}}(r),"\n      }\n      return ").concat(i,"(0.0);\n      "),h=qy(n,i),f=h.activationFunction,d=h.applyActivation;return"\n      ".concat(f,"\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ").concat(i," {\n    ").concat(e?c:l,"\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ").concat(i," {\n    ").concat(e?l:c,"\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ").concat(i,") {\n    let col = colIn * ").concat(r,";\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ").concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n      ").concat(o,"\n      ").concat(eg(t),"\n      ").concat(d,"\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/").concat(r,"] = value;\n    }\n  }")},Cg=function(e,t,n,r,i,o,a,s){var u="NHWC"===t.format,c=u?e[0].dims[3]:e[0].dims[1],l=n[0],h=u?n[2]:n[3],f=u?n[1]:n[2],d=u?n[3]:n[1],p=u?c%4==0&&d%4==0:h%4==0&&d%4==0,y=u?d:h*f,g=u?h*f:d,m=p?[8,8,1]:[y<=4||g<=4?4:16,y>4&&g<=4?4:16,1],v=p?[4,4,1]:[y<=4?1:4,y>4&&g<=4?1:4,1],w=[Math.ceil(y/m[0]/v[0]),Math.ceil(g/m[1]/v[1]),Math.ceil(l/m[2]/v[2])];Xf("verbose",(function(){return"[conv_backprop_mm_webgpu] dispatch = ".concat(w)}));var b=p?4:1,x=Math.max(m[0]*b,m[1]),_=p?4:1,I=[{type:"int32",data:r},{type:"int32",data:i},{type:"int32",data:o}],A=_d("x",e[0].dataType,e[0].dims.length,_),C=_d("w",e[1].dataType,e[1].dims.length,1),k=Id("result",e[0].dataType,n.length,_),S=[A,C];I.push.apply(I,_toConsumableArray(yd(e[0].dims))),I.push.apply(I,_toConsumableArray(yd(e[1].dims)));var T="";if(a){var E=_d("bias",e[2].dataType,e[2].dims.length,_);S.push(E),I.push.apply(I,_toConsumableArray(yd(e[2].dims))),T+="\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ".concat(p?"vec4<f32>":"f32"," {\n          return bias[coords.").concat(u?"w":"y").concat(p?"/ 4":"","];\n        }")}return I.push.apply(I,_toConsumableArray(yd(n))),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:function(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:w[0],y:w[1],z:w[2]},programUniforms:I}},getShaderSource:function(n){var c;return"\n        ".concat(tg("uniforms.result_strides"),"\n        ").concat((c=n.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32")).declareVariables.apply(c,S.concat([k])),";\n        const outBackprop : vec4<i32> = vec4<i32>(").concat(e[0].dims.join(","),");\n        const filterDims : vec2<i32> = vec2<i32>(").concat(t.kernelShape[u?1:2],", ").concat(t.kernelShape[u?2:3],");\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ").concat(t.dilations[0]<=1?0:(t.kernelShape[u?1:2]-1)*(t.dilations[0]-1),",\n              ").concat(t.dilations[1]<=1?0:(t.kernelShape[u?2:3]-1)*(t.dilations[1]-1),");\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (").concat(t.pads[0]+t.pads[2],")/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (").concat(t.pads[1]+t.pads[3],")/2);\n        const strides : vec2<i32> = vec2<i32>(").concat(t.strides[0],", ").concat(t.strides[1],");\n        const dilation : vec2<i32> = vec2<i32>(").concat(t.dilations[0],", ").concat(t.dilations[1],");\n        const dimAOuter : i32 = ").concat(r,";\n        const dimBOuter : i32 = ").concat(i,";\n        const dimInner : i32 = ").concat(o,";\n        ").concat(T,"\n        ").concat(Ag(u,a,t,b),"\n        ").concat(p?ig(v,m,"f32",void 0,!u,x):sg(v,m,"f32",void 0,!u,x,!1,void 0,s))}}}})),Gw=Bh((function(){pw(),ww(),bw(),kg=function(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,u="NHWC"===n.format,c=u?1:2,l=u?2:3,h=u?3:1,f=sd.size(r),d=a?2:1,p=n.group,y=t[1].dims,g=y[0]/p,m=y[1],v="\n  fn setOutputAtIndex(flatIndex : u32, value : ".concat(a?"vec4<".concat(s,">"):s,") {\n    result[flatIndex] = ").concat(a?"vec4<".concat(s,">"):s,"(value);\n  }");i&&(v+="\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ".concat(a?"vec4<".concat(s,">"):s," {\n      return bias[coords.").concat(u?"w":"y").concat(a?"/ 4":"","];\n    }"));var w=a?4:1,b=_d("W",t[1].dataType,t[1].dims,w),x=_d("Dy",t[0].dataType,t[0].dims,w),_=[x,b];i&&_.push(_d("bias",t[2].dataType,[r[h]],w));var I=Id("result",t[0].dataType,r,w),A="{\n        let batch: u32 = ".concat(o?"global_id.z":"workgroup_id.z"," / outShape[1];\n        let r = ").concat(o?"global_id.z":"workgroup_id.z"," % outShape[1];\n        let c = ").concat(o?"global_id.y":"workgroup_id.y"," * ").concat(d,";\n        let d1: u32 = ").concat(o?"global_id.x":"workgroup_id.x"," * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<").concat(s,">, ").concat(d,">;\n        for (var i = 0; i < ").concat(d,"; i++) {\n          dotProd[i] = vec4<").concat(s,">(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (").concat(s,"(dyCorner.x) + ").concat(s,"(wR)) / ").concat(s,"(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ").concat(s,"(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (").concat(s,"(dyCorner.y) + ").concat(s,"(wC)) / ").concat(s,"(strides.y);\n            let dyC2 = (").concat(s,"(dyCorner.y) + 1.0 + ").concat(s,"(wC)) / ").concat(s,"(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ").concat(s,"(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ").concat(s,"(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1","d2"),";\n                let wValue1 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2"),";\n                let wValue2 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2"),";\n                let wValue3 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2"),";\n\n                var xValue = ").concat(x.get("batch","idyR","idyC","d2"),";\n                let tmpval = vec4<").concat(s,">(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ").concat(x.get("batch","idyR","idyC2","d2"),";\n\n                dotProd[1] = dotProd[1] + vec4<").concat(s,">(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[").concat(h,"];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1","d2"),";\n                let wValue1 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2"),";\n                let wValue2 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2"),";\n                let wValue3 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2"),";\n\n                var xValue = ").concat(x.get("batch","idyR","idyC","d2"),";\n                let tmpval = vec4<").concat(s,">(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1","d2"),";\n                let wValue1 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2"),";\n                let wValue2 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2"),";\n                let wValue3 = ").concat(b.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2"),";\n\n                var xValue = ").concat(x.get("batch","idyR","idyC2","d2"),";\n                let tmpval = vec4<").concat(s,">(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ").concat(d,"; i = i + 1) {\n          let value = dotProd[i] + ").concat(i?"bias[c+i]":"vec4<".concat(s,">(0.0)"),";\n          ").concat(I.set("batch","r","c + i","d1","value"),";\n        }\n      }"),C="\n          let outputIndices = ".concat(I.offsetToIndices("global_idx"),";\n          let batch = ").concat(I.indicesGet("outputIndices",0),";\n          let d1 = ").concat(I.indicesGet("outputIndices",h),";\n          let r = ").concat(I.indicesGet("outputIndices",c),";\n          let c = ").concat(I.indicesGet("outputIndices",l),";\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ").concat(m,";\n          let wOutChannel = d1 - groupId * ").concat(m,";\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ").concat(s,"(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (").concat(s,"(dyRCorner) + ").concat(s,"(wR)) / ").concat(s,"(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ").concat(s,"(outBackprop[").concat(c,"]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (").concat(s,"(dyCCorner) + ").concat(s,"(wC)) / ").concat(s,"(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ").concat(s,"(outBackprop[").concat(l,"]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ").concat(g,";\n              for (var d2: u32 = 0; d2 < ").concat(g,"; d2 = d2 + 1) {\n                let xValue = ").concat(u?x.get("batch","idyR","idyC","inputChannel"):x.get("batch","inputChannel","idyR","idyC"),";\n                let wValue = ").concat(b.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)"),";\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ").concat(i?"bias[d1]":"".concat(s,"(0.0)"),";\n          ").concat(I.setByOffset("global_idx","value"),";\n        ");return"\n  ".concat(e.declareVariables.apply(e,_.concat([I])),"\n  ").concat(v,"\n  const outShape : vec4<u32> = vec4<u32>(").concat(r.join(","),");\n  const outBackprop : vec4<u32> = vec4<u32>(").concat(t[0].dims.join(","),");\n  const strides : vec2<u32> = vec2<u32>(").concat(n.strides[0],", ").concat(n.strides[1],");\n  const filterDims : vec2<u32> = vec2<u32>(").concat(n.kernelShape[u?1:2],", ").concat(n.kernelShape[u?2:3],");\n  const dilations : vec2<u32> = vec2<u32>(").concat(n.dilations[0],", ").concat(n.dilations[1],");\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ").concat(n.dilations[0]<=1?0:(n.kernelShape[u?1:2]-1)*(n.dilations[0]-1),",\n          ").concat(n.dilations[1]<=1?0:(n.kernelShape[u?2:3]-1)*(n.dilations[1]-1),");\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (").concat(n.pads[0]+n.pads[2],")/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (").concat(n.pads[1]+n.pads[3],")/2);\n    ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(f),";\n  ").concat(a?A:C,"}")},Sg=function(e,t,n){var r=e.length>2,i=t.outputShape,o=sd.size(i),a=[Math.ceil(o/64),1,1];Xf("verbose",(function(){return"[conv2d_backprop_webgpu] dispatch = ".concat(a)}));var s=dd(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:function(){return{dispatchGroup:{x:a[0],y:a[1],z:a[2]},outputs:[{dims:n?n(i):i,dataType:e[0].dataType}]}},getShaderSource:function(n){return kg(n,e,t,i,r,1===a[1]&&1===a[2],!1,s)}}}})),zw=Bh((function(){vw(),jw(),Gw(),Rw(),xw(),Tg=function(e,t,n,r,i,o){return(e-1)*t+n+(r-1)*i+1-o},Eg=function(e,t,n,r,i){var o=Math.floor(e/2);"SAME_UPPER"===t?(n[r]=o,n[i]=e-o):"SAME_LOWER"===t&&(n[r]=e-o,n[i]=o)},Og=function(e,t,n,r,i,o,a,s,u,c){var l=e.length-2,h=0===c.length;if(0===u.length)for(var f=0;f<l;++f)u.push(0);for(var d=e[0],p=t[s?3:1]*i,y=0,g=e.length-l-(s?1:0);y<l;++y,++g){var m=e[g],v=h?m*a[y]:c[y],w=Tg(m,a[y],o[y],t[g],n[y],v);Eg(w,r,o,y,y+l),h&&c.push(a[y]*(m-1)+u[y]+(t[g]-1)*n[y]+1-o[y]-o[y+l])}c.splice(0,0,d),c.splice(s?3:1,0,p)},Pg=function(e,t){var n=e.kernelShape.slice();if(0===e.kernelShape.length||0===e.kernelShape.reduce((function(e,t){return e*t}),1)){n.length=0;for(var r=2;r<t[1].dims.length;++r)n.push(t[1].dims[r])}var i="NHWC"===e.format;n.splice(0,0,t[1].dims[0]),n.splice(i?3:1,0,t[1].dims[1]);var o=e.pads.slice(),a=e.outputShape.slice(),s=e.outputPadding.slice(),u=t[0].dims,c=e.dilations.slice();if(0===c.reduce((function(e,t){return e+t}),0)){var l=t[0].dims.length-2;c=new Array(l).fill(1)}var h=e.strides.slice();if(0===h.reduce((function(e,t){return e+t}),0)){var f=t[0].dims.length-2;h=new Array(f).fill(1)}Og(u,n,c,e.autoPad,e.group,o,h,i,s,a);var d=Object.assign({},e),p=e.cacheKey+[n.join("n,"),o.join(","),h.join(","),s.join(","),a.join(","),c.join(",")].join("_");return Object.assign(d,{kernelShape:n,pads:o,outputPadding:s,outputShape:a,dilations:c,strides:h,cacheKey:p}),d},Rg=function(e){var t=Jy(e),n=e.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][_typeof(e.autoPad)>"u"?0:e.autoPad],i=e.dilations,o=e.group,a=e.kernelShape,s=e.pads,u=e.strides,c=e.wIsConst(),l=e.outputPadding,h=e.outputShape;return id(_objectSpread({autoPad:r,format:n,dilations:i,group:o,kernelShape:a,outputPadding:l,outputShape:h,pads:s,strides:u,wIsConst:c},t))},Bg=function(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");var n=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==n))throw new Error("invalid bias");var r=e[0].dims.length-2;if(t.dilations.reduce((function(e,t){return e+t}),0)>0&&t.dilations.length!==r)throw new Error("dilations should be ".concat(r,"D"));if(t.strides.reduce((function(e,t){return e+t}),0)>0&&t.strides.length!==r)throw new Error("strides should be ".concat(r,"D"));if(t.pads.reduce((function(e,t){return e+t}),0)>0&&t.pads.length!==2*r)throw new Error("pads should be ".concat(2*r,"D"));if(t.outputPadding.length!==r&&0!==t.outputPadding.length)throw new Error("output_padding should be ".concat(r,"D"));if(t.kernelShape.reduce((function(e,t){return e+t}),0)>0&&0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Dg=[2,3,1,0],Mg=function(e,t,n){var r,i=Pg(n,t),o="NHWC"===n.format,a=i.outputShape,s=a[o?3:1],u=t[0].dims[o?3:1];if(1!==i.group||1===s&&1===u)e.compute(Sg(t,i));else{var c=a[o?1:2],l=a[o?2:3],h=o?c*l:s,f=o?s:c*l,d=t[1].dims[2]*t[1].dims[3]*u,p=null!==(r=e.kernelCustomData.wT)&&void 0!==r?r:e.compute(Bd(t[1],Dg),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=p);var y=[t[0],p],g=3===t.length;g&&(o||1!==t[2].dims.length?y.push(t[2]):y.push(t[2].reshape([t[2].dims[0],1,1]))),e.compute(Cg(y,i,a,h,f,d,g,!0),{inputs:y})}},Lg=function(e,t){var n="NHWC"===t.format,r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===r.length&&r.push(e.inputs[2]);var i=t.kernelShape;(0===i.length||0===i[0])&&(i=[e.inputs[1].dims[2]]);var o=t.dilations;(0===o.length||0===o[0])&&(o=[1]);var a=t.strides;(0===a.length||0===a[0])&&(a=[1]);var s=t.pads;0===s.length&&(s=[0,0]),s=[0,s[0],0,s[1]],a=[1].concat(a),o=[1].concat(o),i=[1].concat(i);var u=Pg(_objectSpread(_objectSpread({},t),{},{pads:s,strides:a,dilations:o,kernelShape:i}),r);e.compute(Sg(r,u,(function(e){return n?[e[0],e[2],e[3]]:[e[0],e[1],e[3]]})))},Fg=function(e,t){Bg(e.inputs,t),3===e.inputs[0].dims.length?Lg(e,t):Mg(e,e.inputs,t)}})),Hw=Bh((function(){fw(),ww(),vw(),bw(),Ng=function(e,t,n,r){var i=sd.size(t),o=t.length,a=_d("input",e,o),s=Id("output",e,o),u=6===n.dataType?n.getInt32Array()[0]:Number(n.getBigInt64Array()[0]),c=sd.normalizeAxis(u,o);return{name:"CumSum",shaderCache:{hint:r.cacheKey,inputDependencies:["rank"]},getRunData:function(){return{outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i},{type:"int32",data:c}].concat(_toConsumableArray(yd(t)),_toConsumableArray(yd(t)))}},getShaderSource:function(e){var t=" i32(".concat(a.indicesGet("inputIndices","uniforms.axis"),") "),n=bd("uniforms.input_shape","uniforms.axis",o),i=r.reverse?t+(r.exclusive?" + 1":""):"0",u=r.reverse?n:t+(r.exclusive?"":" + 1");return"\n                ".concat(e.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,s),"\n                ").concat(e.mainStart(),"\n                  ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n                  var inputIndices = ").concat(s.offsetToIndices("global_idx"),";\n                  var sum = ").concat(s.type.value,"(0);\n                  let first : i32 = ").concat(i,";\n                  let last : i32 = ").concat(u,";\n                  for (var i : i32 = first; i < last; i++) {\n                    ").concat(a.indicesSet("inputIndices","uniforms.axis","u32(i)"),";\n                    sum = sum + ").concat(a.getByIndices("inputIndices"),";\n                  }\n                  ").concat(s.setByOffset("global_idx","sum"),";\n                }")}}},Ug=function(e,t){var n=e.inputs[0].dims,r=e.inputs[0].dataType,i=e.inputs[1];e.compute(Ng(r,n,i,t),{inputs:[0]})},jg=function(e){var t=1===e.exclusive,n=1===e.reverse;return id({exclusive:t,reverse:n})}})),Vw=Bh((function(){ww(),vw(),bw(),Hg="^"+(zg="("+(Gg="[a-zA-Z]|\\.\\.\\.")+")+")+"$",Vg="^("+zg+",)*"+zg+"$",Wg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;_classCallCheck(this,e),this.symbolToIndices=new Map,this.inputIndex=t}return _createClass(e,[{key:"addSymbol",value:function(e,t){var n=this.symbolToIndices.get(e);void 0===n?n=[t]:n.push(t),this.symbolToIndices.set(e,n)}}]),e}(),$g=function(){function e(t,n){var r,i=this;_classCallCheck(this,e),this.equation=n,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];var o=_slicedToArray(n.includes("->")?n.split("->",2):[n,""],2),a=o[0],s=o[1];if(!a.match(RegExp(Vg)))throw new Error("Invalid LHS term");if(a.split(",").forEach((function(e,n){var r=t[n].dims.slice();if(!e.match(RegExp(Hg)))throw new Error("Invalid LHS term");var o=i.processTerm(e,!0,r,n);i.lhs.push(o)})),""===s)s+=_toConsumableArray(this.symbolToInfo.entries()).filter((function(e){var t=_slicedToArray(e,2),n=t[0];return 1===t[1].count||"..."===n})).map((function(e){return _slicedToArray(e,1)[0]})).join("");else if(!s.match(RegExp(zg)))throw new Error("Invalid RHS");null!==(r=s.match(RegExp(Gg,"g")))&&void 0!==r&&r.forEach((function(e){if("..."===e)i.outputDims=i.outputDims.concat(i.ellipsisDims);else{var t=i.symbolToInfo.get(e);if(void 0===t)throw new Error("Invalid RHS symbol");i.outputDims.push(t.dimValue)}})),this.rhs=this.processTerm(s,!1,this.outputDims)}return _createClass(e,[{key:"addSymbol",value:function(e,t,n){var r=this.symbolToInfo.get(e);if(void 0!==r){if(r.dimValue!==t&&1!==r.count)throw new Error("Dimension mismatch");r.count++,r.inputIndices.push(n)}else r={count:1,dimValue:t,inputIndices:[n]};this.symbolToInfo.set(e,r)}},{key:"processTerm",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=n.length,a=!1,s=[],u=0;if(!e.match(RegExp(Hg))&&!t&&""!==e)throw new Error("Invalid LHS term");var c=e.match(RegExp(Gg,"g")),l=new Wg(i);return null!==c&&void 0!==c&&c.forEach((function(e,h){if("..."===e){if(a)throw new Error("Only one ellipsis is allowed per input term");a=!0;var f=o-c.length+1;if(f<0)throw new Error("Ellipsis out of bounds");if(s=n.slice(u,u+f),r.hasEllipsis){if(r.ellipsisDims.length!==s.length||r.ellipsisDims.toString()!==s.toString())throw new Error("Ellipsis dimensions mismatch")}else{if(!t)throw new Error("Ellipsis must be specified in the LHS");r.hasEllipsis=!0,r.ellipsisDims=s}for(var d=0;d<s.length;d++){var p=String.fromCharCode("0".charCodeAt(0)+d);l.addSymbol(p,h+d),r.addSymbol(p,n[u++],i)}}else l.addSymbol(e,h+(r.hasEllipsis?r.ellipsisDims.length-1:0)),r.addSymbol(e,n[u++],i)})),l}}]),e}(),Yg=function(e){return e+"_max"},Kg=function(e,t,n,r,i){var o=t.map((function(t,n){return e[n]?t.length:t})).map((function(e,t){return _d("input".concat(t),n,e)})),a=sd.size(i),s=Td(i.length),u=s?i.length:i,c=Id("output",n,u),l=_toConsumableArray(r.symbolToInfo.keys()).filter((function(e){return!r.rhs.symbolToIndices.has(e)}));return{name:"Einsum",shaderCache:{hint:r.equation,inputDependencies:e.map((function(e){return e?"rank":"dims"}))},getRunData:function(){var o=l.filter((function(e){return r.symbolToInfo.has(e)})).map((function(e){var t;return{type:"uint32",data:(null===(t=r.symbolToInfo.get(e))||void 0===t?void 0:t.dimValue)||0}}));o.push({type:"uint32",data:a});var u=t.filter((function(t,n){return e[n]})).map((function(e,t){return _toConsumableArray(yd(e))})).reduce((function(e,t){return e.concat(t)}),o);return s&&u.push.apply(u,_toConsumableArray(yd(i))),{outputs:[{dims:i,dataType:n}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}},getShaderSource:function(e){var t,n=[],i=[],a=[],s=[],u=[],h=r.symbolToInfo.size===r.rhs.symbolToIndices.size;r.symbolToInfo.forEach((function(e,t){if(r.rhs.symbolToIndices.has(t)){var l,h=null===(l=r.rhs.symbolToIndices.get(t))||void 0===l?void 0:l[0];void 0!==h&&r.lhs.forEach((function(r,i){if(e.inputIndices.includes(i)){var a=r.symbolToIndices.get(t);if(void 0===a)throw new Error("Invalid symbol error");a.forEach((function(e){n.push("".concat(o[i].indicesSet("input".concat(i,"Indices"),e,c.indicesGet("outputIndices",h))))}))}}))}else r.lhs.forEach((function(n,r){if(e.inputIndices.includes(r)){var a=n.symbolToIndices.get(t);if(void 0===a)throw new Error("Invalid symbol error");a.forEach((function(e){i.push("".concat(o[r].indicesSet("input".concat(r,"Indices"),e,"".concat(t))))})),u.push("prod *= ".concat(o[r].getByIndices("input".concat(r,"Indices")),";"))}})),a.push("for(var ".concat(t,": u32 = 0; ").concat(t," < uniforms.").concat(Yg(t),"; ").concat(t,"++) {")),s.push("}")}));var f=h?[].concat(n,["let sum = ".concat(o.map((function(e,t){return e.getByIndices("input".concat(t,"Indices"))})).join(" * "),";")]):[].concat(n,["var sum = 0.0;"],a,i,["var prod = 1.0;"],u,["sum += prod;"],s);return"\n            ".concat((t=e.registerUniforms(l.map((function(e){return{name:"".concat(Yg(e)),type:"u32"}}))).registerUniform("outputSize","u32")).declareVariables.apply(t,_toConsumableArray(o).concat([c])),"\n\n            ").concat(e.mainStart(),"\n            ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n            var outputIndices = ").concat(c.offsetToIndices("global_idx"),";\n            ").concat(o.map((function(e,t){return"var input".concat(t,"Indices: ").concat(o[t].type.indices,";")})).join("\n"),"\n            ").concat(f.join("\n"),";\n            ").concat(c.setByOffset("global_idx","sum"),";\n          }")}}},Xg=function(e,t){var n=new $g(e.inputs,t.equation),r=e.inputs.map((function(e,t){return Td(e.dims.length)})),i=n.outputDims,o=e.inputs.map((function(e,t){return e.dims}));e.compute(Kg(r,o,e.inputs[0].dataType,n,i))},Zg=function(e){var t=e.equation.replace(/\s+/g,"");return id({equation:t})}})),Ww=Bh((function(){fw(),ww(),bw(),qg=function(e){if(!e||2!==e.length)throw new Error("Expand requires 2 input.");for(var t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=n.length<t.length?0:n.length-t.length,i=t.length<n.length?0:t.length-n.length;r<n.length&&i<t.length;++r,++i)if(n[r]!==t[i]&&1!==n[r]&&1!==t[i])throw new Error("Expand requires shape to be broadcastable to input")},Jg=function(e,t){for(var n=e.length-t.length,r=[],i=0;i<n;++i)r.push(e[i]);for(var o=0;o<t.length;++o)r.push(1===t[o]?e[o+n]:t[o]);return r},Qg=function(e,t){return e.length>t.length?Jg(e,t):Jg(t,e)},em=function(e){var t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=Qg(t,n),i=e[0].dataType,o=9===i?4:1,a=Math.ceil(sd.size(r)/o),s=Td(t.length),u=Td(r.length),c=[{type:"uint32",data:a}];return s&&c.push.apply(c,_toConsumableArray(yd(t))),u&&c.push.apply(c,_toConsumableArray(yd(r))),{name:"Expand",shaderCache:{hint:"".concat(r.length),inputDependencies:[s?"rank":"dims"]},getShaderSource:function(e){var n,a=s?t.length:t,c=u?r.length:r,l=_d("input",i,a,o),h=Id("output",i,c,o);if(9===i){var f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"\n          let outputIndices".concat(t," = ").concat(h.offsetToIndices("outputOffset + ".concat(t,"u")),";\n          let offset").concat(t," = ").concat(l.broadcastedIndicesToOffset("outputIndices".concat(t),h),";\n          let index").concat(t," = offset").concat(t," / 4u;\n          let component").concat(t," = offset").concat(t," % 4u;\n          ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(l.getByOffset("index".concat(t)),"[component").concat(t,"]);\n        ")};n="\n        let outputOffset = global_idx * ".concat(o,";\n        var data = vec4<u32>(0);\n        ").concat(f("data",0,"u32"),"\n        ").concat(f("data",1,"u32"),"\n        ").concat(f("data",2,"u32"),"\n        ").concat(f("data",3,"u32"),"\n        ").concat(h.setByOffset("global_idx","data"),"\n      }")}else n="\n        let outputIndices = ".concat(h.offsetToIndices("global_idx"),";\n        let inputOffset = ").concat(l.broadcastedIndicesToOffset("outputIndices",h),";\n        ").concat(h.setByOffset("global_idx",l.getByOffset("inputOffset")),"\n      }");return"\n    ".concat(e.registerUniform("vec_size","u32").declareVariables(l,h),"\n    ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n    ").concat(n)},getRunData:function(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:c}}}},tm=function(e){qg(e.inputs),e.compute(em(e.inputs),{inputs:[0]})}})),$w=Bh((function(){fw(),ww(),vw(),bw(),nm=function(e){if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.")},rm=function(e,t){var n=e[0].dims,r=e[1].dims,i=n.length,o=sd.normalizeAxis(t.axis,i),a=n.slice(0);a.splice.apply(a,[o,1].concat(_toConsumableArray(r)));var s=n[o],u=9===e[0].dataType?4:1,c=Math.ceil(sd.size(a)/u),l=Td(e[0].dims.length),h=l?e[0].dims.length:e[0].dims,f=Td(e[1].dims.length),d=f?e[1].dims.length:e[1].dims,p=Td(a.length),y=p?a.length:a,g=[{type:"uint32",data:c},{type:"int32",data:s},{type:"uint32",data:o}];l&&g.push.apply(g,_toConsumableArray(yd(e[0].dims))),f&&g.push.apply(g,_toConsumableArray(yd(e[1].dims))),p&&g.push.apply(g,_toConsumableArray(yd(a)));var m=[];return m.push(l?"rank":"dims"),m.push(f?"rank":"dims"),{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:m},getRunData:function(){return{outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:g}},getShaderSource:function(t){var n,s=_d("data",e[0].dataType,h,u),c=_d("inputIndices",e[1].dataType,d),l=Id("output",e[0].dataType,y,u),f=function(e){for(var t=r.length,n="var indicesIndices".concat(e,"  = ").concat(c.type.indices,"(0);"),u=0;u<t;u++)n+="".concat(t>1?"indicesIndices".concat(e,"[").concat(u,"]"):"indicesIndices".concat(e)," = ").concat(a.length>1?"outputIndices".concat(e,"[uniforms.axis + ").concat(u,"]"):"outputIndices".concat(e),";");n+="\n          var idx".concat(e," = ").concat(c.getByIndices("indicesIndices".concat(e)),";\n          if (idx").concat(e," < 0) {\n            idx").concat(e," = idx").concat(e," + uniforms.axisDimLimit;\n          }\n          var dataIndices").concat(e," = ").concat(s.type.indices,"(0);\n        ");for(var l=0,h=0;l<i;l++)l===o?(n+="".concat(i>1?"dataIndices".concat(e,"[").concat(l,"]"):"dataIndices".concat(e)," = u32(idx").concat(e,");"),h+=t):(n+="".concat(i>1?"dataIndices".concat(e,"[").concat(l,"]"):"dataIndices".concat(e)," = ").concat(a.length>1?"outputIndices".concat(e,"[").concat(h,"]"):"outputIndices".concat(e),";"),h++);return n};if(9===e[0].dataType){var p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"\n          let outputIndices".concat(t," = ").concat(l.offsetToIndices("outputOffset + ".concat(t,"u")),";\n          ").concat(f(t),";\n          let offset").concat(t," = ").concat(s.indicesToOffset("dataIndices".concat(t)),";\n          let index").concat(t," = offset").concat(t," / 4u;\n          let component").concat(t," = offset").concat(t," % 4u;\n          ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(s.getByOffset("index".concat(t)),"[component").concat(t,"]);\n        ")};n="\n        let outputOffset = global_idx * ".concat(u,";\n        var value = vec4<u32>(0);\n        ").concat(p("value",0,"u32"),"\n        ").concat(p("value",1,"u32"),"\n        ").concat(p("value",2,"u32"),"\n        ").concat(p("value",3,"u32"),"\n        ").concat(l.setByOffset("global_idx","value"),"\n      ")}else n="\n      let outputIndices = ".concat(l.offsetToIndices("global_idx"),";\n      ").concat(f(""),";\n      let value = ").concat(s.getByIndices("dataIndices"),";\n      ").concat(l.setByOffset("global_idx","value"),";\n      ");return"\n      ".concat(t.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(s,c,l),"\n      ").concat(t.mainStart(),"\n        ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n        ").concat(n,"\n      }")}}},im=function(e){return id({axis:e.axis})},om=function(e,t){var n=e.inputs;nm(n),e.compute(rm(e.inputs,t))}})),Yw=Bh((function(){ww(),vw(),bw(),am=function(e){if(!e||2!==e.length)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error("GatherElements requires that the data input and\n                     indices input tensors be of same rank.")},sm=function(e,t){var n=e[0].dims,r=e[0].dataType,i=n.length,o=e[1].dims,a=e[1].dataType,s=sd.normalizeAxis(t.axis,i),u=n[s],c=o.slice(0),l=sd.size(c),h=_d("input",r,i),f=_d("indicesInput",a,o.length),d=Id("output",r,c.length),p=[{type:"uint32",data:l},{type:"int32",data:u},{type:"uint32",data:s}];return p.push.apply(p,_toConsumableArray(yd(n))),p.push.apply(p,_toConsumableArray(yd(o))),p.push.apply(p,_toConsumableArray(yd(c))),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:function(){return{outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:p}},getShaderSource:function(e){return"\n      ".concat(e.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(h,f,d),"\n      ").concat(e.mainStart(),"\n      ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n      let outputIndices = ").concat(d.offsetToIndices("global_idx"),";\n\n      var idx = ").concat(f.getByOffset("global_idx"),";\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ").concat(h.type.indices,"(outputIndices);\n      ").concat(h.indicesSet("inputIndices","uniforms.axis","u32(idx)"),";\n      let value = ").concat(h.getByIndices("inputIndices"),";\n\n      ").concat(d.setByOffset("global_idx","value"),";\n  }")}}},um=function(e){return id({axis:e.axis})},cm=function(e,t){var n=e.inputs;am(n),e.compute(sm(e.inputs,t))}})),Kw=Bh((function(){ww(),bw(),lm=function(e){if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(3===e.length&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||3===e.length&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},hm=function(e,t){var n=e[0].dims.slice(),r=e[1].dims.slice(),i=_slicedToArray(cd.getShapeOfGemmResult(n,t.transA,r,t.transB,3===e.length?e[2].dims:void 0),3),o=i[0],a=i[1],s=i[2],u=[o,a];if(!u)throw new Error("Can't use gemm on the given tensors");var c=sd.size(u),l=[{type:"uint32",data:c},{type:"uint32",data:o},{type:"uint32",data:a},{type:"uint32",data:s},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],h=["type","type"];return 3===e.length&&(l.push.apply(l,_toConsumableArray(yd(e[2].dims))),h.push("rank")),l.push.apply(l,_toConsumableArray(yd(u))),{name:"Gemm",shaderCache:{hint:"".concat(t.cacheKey),inputDependencies:h},getRunData:function(){return{outputs:[{dims:u,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:l}},getShaderSource:function(n){var r,i="";t.transA&&t.transB?i="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?i="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?i="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(i="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");var o=1===t.alpha?"":"value *= uniforms.alpha;",a=_d("a",e[0].dataType,e[0].dims),s=_d("b",e[1].dataType,e[1].dims),c=a.type.value,l=null,h=[a,s];3===e.length&&(l=_d("c",e[2].dataType,e[2].dims.length),h.push(l));var f=Id("output",e[0].dataType,u.length);return h.push(f),"\n  ".concat((r=n.registerUniforms([{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}])).declareVariables.apply(r,h),"\n\n  ").concat(n.mainStart(),"\n    ").concat(n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ").concat(c,"(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ").concat(i,"\n    }\n\n    ").concat(o,"\n    ").concat(null!=l?"let cOffset = ".concat(l.broadcastedIndicesToOffset("vec2(m, n)",f),"; value += ").concat(c,"(uniforms.beta) * ").concat(l.getByOffset("cOffset"),";"):"","\n    output[global_idx] = value;\n  }")}}},fm=function(e){return{transA:e.transA,transB:e.transB,alpha:e.alpha,beta:e.beta,cacheKey:"".concat(e.transA,";").concat(e.transB,";").concat(1===e.alpha)}},dm=function(e,t){lm(e.inputs),e.compute(hm(e.inputs,t))}})),Xw=Bh((function(){fw(),ww(),bw(),pm=function(e,t){var n=e[0].dims,r=n,i=sd.sizeToDimension(n,2),o=sd.sizeFromDimension(n,2),a=gd(o),s=o/a,u=[n[0],n[1],s],c=[{type:"uint32",data:o},{type:"uint32",data:s}];return c.push.apply(c,_toConsumableArray(yd(u)).concat(_toConsumableArray(yd(u)))),{name:"InstanceNormalization",shaderCache:{hint:"".concat(t.epsilon,";").concat(a),inputDependencies:["rank","type","type"]},getRunData:function(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:i},programUniforms:c}},getShaderSource:function(n){var r,i=_d("x",e[0].dataType,u.length,a),o=_d("scale",e[1].dataType,e[1].dims),s=_d("bias",e[2].dataType,e[2].dims),c=Id("output",e[0].dataType,u.length,a),l=[i,o,s,c],h=i.type.value,f=1===a?"f32":"vec".concat(a,"<f32>");return"\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<".concat(f,", 64>;\n  const workgroupSize = 64u;\n  ").concat((r=n.registerUniforms([{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}])).declareVariables.apply(r,l),"\n  ").concat(n.mainStart(64),"\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ").concat(f,"(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ").concat(f,"(").concat(i.get("batch","channel","h"),");\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ").concat(wd("workgroupShared[0]",a)," / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ").concat(f,"(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ").concat(f,"(").concat(i.get("batch","channel","h"),") - ").concat(f,"(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ").concat(wd("workgroupShared[0]",a),";\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(").concat(t.epsilon,"));\n    let channelScale = invStdDev * f32(").concat(o.getByOffset("channel"),");\n    let channelShift = f32(").concat(s.getByOffset("channel"),") - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ").concat(i.get("batch","channel","h")," * ").concat(h,"(").concat(f,"(channelScale)) + ").concat(h,"(").concat(f,"(channelShift));\n      ").concat(c.set("batch","channel","h","value"),";\n    }\n  }")}}},ym=function(e,t,n,r,i,o,a,s){var u=gd(a),c=1===u?"vec2f":"mat2x".concat(u,"f"),l=1===u?"f32":"vec".concat(u,"f"),h=function(e,t){return"".concat(c,"(").concat(e,", ").concat(t,")")},f=i*a/u,d=[{type:"uint32",data:Math.ceil(o/64)},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(o*a/u)}],p=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:"".concat(u),inputDependencies:["type"]},getRunData:function(){return{outputs:[{dims:[i,a,64,2],dataType:1}],dispatchGroup:{x:i*a/u},programUniforms:d}},getShaderSource:function(e){var n=_d("input",t.dataType,t.dims,u);return"\n  ".concat(e.declareVariables(n),"\n  @group(0) @binding(1) var<storage, read_write> output : array<").concat(c,">;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ").concat(e.mainStart(64),"\n    let currentImageNumber = global_idx / 64 / uniforms.C;\n    let currentChannelNumber = (global_idx / 64) % uniforms.C;\n    let wgId = global_idx % 64;\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ").concat(md("f32",u),";\n    var squaredSum = ").concat(md("f32",u),";\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ").concat(l,"(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ").concat(h("sum","squaredSum"),";\n  }")}},{inputs:[t],outputs:[-1]})[0],y=[{type:"uint32",data:f},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(64*a/u)}];return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:"".concat(u,";").concat(s),inputDependencies:["type","type","type"]},getRunData:function(){return{outputs:[{dims:[i,a,2],dataType:1}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:y}},getShaderSource:function(e){var t=_d("scale",n.dataType,n.dims,u),i=_d("bias",r.dataType,r.dims,u);return"\n  @group(0) @binding(0) var<storage, read> input : array<".concat(c,">;\n  @group(0) @binding(1) var<storage, read> scale : array<").concat(t.type.storage,">;\n  @group(0) @binding(2) var<storage, read> bias : array<").concat(i.type.storage,">;\n  @group(0) @binding(3) var<storage, read_write> output : array<").concat(c,">;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work"),"\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ").concat(md("f32",u),";\n    var squaredSum = ").concat(md("f32",u),";\n    for (var i: u32 = 0; i < 64; i++) {\n        let value = input[offset + i + currentChannelNumber * 64];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(").concat(s,"));\n    let channelScale = invStdDev * ").concat(l,"(scale[currentChannelNumber]);\n    let channelShift = ").concat(l,"(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ").concat(h("channelScale","channelShift"),";\n  }")}},{inputs:[p,n,r],outputs:[-1]})[0]},gm=function(e,t,n){var r=t[0].dims,i=r,o=r[0],a=r[r.length-1],s=sd.sizeFromDimension(r,1)/a,u=gd(a),c=sd.size(i)/u,l=[{type:"uint32",data:s},{type:"uint32",data:Math.floor(a/u)}],h=ym(e,t[0],t[1],t[2],o,s,a,n.epsilon);e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:"".concat(u),inputDependencies:["type","type"]},getRunData:function(){return{outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:l}},getShaderSource:function(e){var n=dd(t[0].dataType),r=1===u?"vec2f":"mat2x".concat(u,"f"),o=1===u?n:"vec".concat(u,"<").concat(n,">"),a=_d("input",t[0].dataType,t[0].dims,u),s=Id("output",t[0].dataType,i,u);return"\n  @group(0) @binding(0) var<storage, read> input : array<".concat(a.type.storage,">;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<").concat(r,">;\n  @group(0) @binding(2) var<storage, read_write> output : array<").concat(s.type.storage,">;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ").concat(e.mainStart(),"\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ").concat(o,"(scale[0]), ").concat(o,"(scale[1]));\n  }")}},{inputs:[t[0],h]})},mm=function(e,t){"NHWC"===t.format?gm(e,e.inputs,t):e.compute(pm(e.inputs,t))}})),Zw=Bh((function(){fw(),ww(),bw(),vm=function(e){if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},wm=function(e,t,n){var r=e[0].dims,i=e[1],o=e[2],a=r,s=sd.normalizeAxis(t.axis,r.length),u=sd.sizeToDimension(r,s),c=sd.sizeFromDimension(r,s),l=sd.size(i.dims),h=o?sd.size(o.dims):0;if(l!==c||o&&h!==c)throw new Error("Size of X.shape()[axis:] == ".concat(c,".\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ").concat(l," and bias size of ").concat(h));for(var f=[],d=0;d<r.length;++d)d<s?f.push(r[d]):f.push(1);var p=gd(c),y=["type","type"],g=[{type:"uint32",data:u},{type:"float32",data:c},{type:"uint32",data:Math.floor(c/p)},{type:"float32",data:t.epsilon}];o&&y.push("type");var m=n>1,v=n>2,w=[{dims:a,dataType:e[0].dataType}];return m&&w.push({dims:f,dataType:1}),v&&w.push({dims:f,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:"".concat(p,";").concat(n),inputDependencies:y},getRunData:function(){return{outputs:w,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:g}},getShaderSource:function(t){var n,r=dd(e[0].dataType),s=[_d("x",e[0].dataType,e[0].dims,p),_d("scale",i.dataType,i.dims,p)];return o&&s.push(_d("bias",o.dataType,o.dims,p)),s.push(Id("output",e[0].dataType,a,p)),m&&s.push(Id("mean_data_output",1,f)),v&&s.push(Id("inv_std_output",1,f)),"\n  ".concat((n=t.registerUniforms([{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}])).declareVariables.apply(n,s),"\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count"),"\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ").concat(md("f32",p),";\n    var meanSquareVector = ").concat(md("f32",p),";\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ").concat(vd(r,p,"x[h + offset]"),";\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ").concat(wd("meanVector",p)," / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(").concat(wd("meanSquareVector",p)," / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ").concat(vd(r,p,"x[j + offset]"),";\n      let f32scale = ").concat(vd(r,p,"scale[j]"),";\n      output[j + offset] = ").concat(s[0].type.value,"((f32input - mean) * invStdDev * f32scale\n        ").concat(o?"+ ".concat(vd(r,p,"bias[j]")):"","\n      );\n    }\n\n    ").concat(m?"mean_data_output[global_idx] = mean":"",";\n    ").concat(v?"inv_std_output[global_idx] = invStdDev":"",";\n  }")}}},bm=function(e,t){vm(e.inputs),e.compute(wm(e.inputs,t,e.outputCount))}})),qw=Bh((function(){ww(),vw(),gw(),Cw(),bw(),xw(),xm=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7];if(3!==n.dims.length&&5!==n.dims.length)throw new Error("Input query is expected to have 3 or 5 dimensions");var l,h=n.dims[0],f=n.dims[1],d=3===n.dims.length?n.dims[2]:t.numHeads*n.dims[4],p=f,y=0,g=0,m=Math.floor(d/t.numHeads);if(u&&c){if(4!==u.dims.length)throw new Error('Input "past_key" is expected to have 4 dimensions');if(4!==c.dims.length)throw new Error('Input "past_value" is expected to have 4 dimensions');y=u.dims[2],g=u.dims[2]}else if(u||c)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');if(r){if(3!==n.dims.length)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===r.dims.length){if(r.dims[2]!==n.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');l=2,p=r.dims[1]}else if(5===r.dims.length){if(r.dims[2]!==t.numHeads||2!==r.dims[3]||r.dims[4]!==m)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');l=5,p=r.dims[1]}else{if(r.dims[1]!==t.numHeads||r.dims[3]!==m)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');l=0,p=r.dims[2]}}else{if(3!==n.dims.length&&5!==n.dims.length)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(5===n.dims.length&&(n.dims[2]!==t.numHeads||3!==n.dims[3]))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');l=3}if(o){if(1!==o.dims.length)throw new Error('Input "bias" is expected to have 1 dimension');if(i&&5===n.dims.length&&2===n.dims[3])throw new Error("bias is not allowed for packed kv.")}var v=0;if(a){v=8;var w=a.dims;throw 1===w.length?w[0]===h?v=1:w[0]===3*h+2&&(v=3):2===w.length&&w[0]===h&&w[1]===p&&(v=5),8===v?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)'):new Error("Mask not supported")}var b=!1,x=d;if(i){if(3!==i.dims.length&&4!==i.dims.length)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===i.dims.length){if(p!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');x=i.dims[2]}else{if(p!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');x=i.dims[1]*i.dims[3],b=!0}}var _=y+p;if(a)throw new Error("Key padding mask is not supported");if(s)throw new Error("extraAddQk is not supported");if(u)throw new Error("pastKey is not supported");if(c)throw new Error("pastValue is not supported");return{batchSize:h,sequenceLength:f,pastSequenceLength:y,kvSequenceLength:p,totalSequenceLength:_,maxSequenceLength:g,inputHiddenSize:0,hiddenSize:d,vHiddenSize:x,headSize:m,vHeadSize:Math.floor(x/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:v,scale:t.scale,broadcastResPosBias:!1,passPastInKv:b,qkvFormat:l}},_m=function(e){return id(_objectSpread({},e))},Im=id({perm:[0,2,1,3]}),Am=function(e,t,n,r,i,o,a){var s=[r,i,o],u=sd.size(s),c=[{type:"uint32",data:u},{type:"uint32",data:a},{type:"uint32",data:o}];return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:function(){return{outputs:[{dims:s,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c}},getShaderSource:function(e){var r=Id("qkv_with_bias",t.dataType,s),i=_d("qkv",t.dataType,s),o=_d("bias",n.dataType,s);return"\n  ".concat(e.registerUniforms([{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}]).declareVariables(i,o,r),"\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }")}},{inputs:[t,n],outputs:[-1]})[0]},Cm=function(e,t,n,r,i,o,a,s){var u=o;if(a){if(1===r)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return u=(u=Am(e,o,a,t,r,n*i,s)).reshape([t,r,n,i]),e.compute(Bd(u,Im.perm),{inputs:[u],outputs:[-1]})[0]}return 3===o.dims.length&&(u=o.reshape([t,r,n,i])),e.compute(Bd(u,Im.perm),{inputs:[u],outputs:[-1]})[0]},km=function(e,t){var n,r=xm(e.inputs,t);if(5===e.inputs[0].dims.length)throw new Error("Packed QKV is not implemented");if(5===(null===(n=e.inputs[1])||void 0===n?void 0:n.dims.length))throw new Error("Packed KV is not implemented");var i=e.inputs[1]&&e.inputs[2]&&4===e.inputs[1].dims.length&&4===e.inputs[2].dims.length,o=Cm(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(i)return Fp(e,o,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);var a=Cm(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),s=Cm(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);Fp(e,o,a,s,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t)}})),Jw=Bh((function(){fw(),ww(),bw(),Sm=function(e){if(!e||e.length<1)throw new Error("Too few inputs");if(1!==e[0].dataType)throw new Error("Input type must be float.");if(e.length>=2){var t=2*e[0].dims.length===e[1].dims[0];if(4===e.length&&(t=2*e[3].dims[0]===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},Tm=function(e,t,n){for(var r="",i=t-1;i>=0;--i)r+="\n            k = i32(".concat(e.indicesGet("indices",i),") - ").concat(bd("uniforms.pads",i,n),";\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(").concat(bd("uniforms.x_shape",i,t),")) {\n              break;\n            }\n            offset += k * i32(").concat(bd("uniforms.x_strides",i,t),");\n        ");return"\n          value = ".concat(e.type.value,"(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ").concat(r,"\n            value = x[offset];\n          }\n      ")},Em=function(e,t,n){for(var r="",i=t-1;i>=0;--i)r+="\n                k = i32(".concat(e.indicesGet("indices",i),") - ").concat(bd("uniforms.pads",i,n),";\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(").concat(bd("uniforms.x_shape",i,t),") - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(").concat(bd("uniforms.x_shape",i,t),")) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(").concat(bd("uniforms.x_strides",i,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(r,"\n              value = x[offset];\n          ")},Om=function(e,t,n){for(var r="",i=t-1;i>=0;--i)r+="\n                k = i32(".concat(e.indicesGet("indices",i),") - ").concat(bd("uniforms.pads",i,n),";\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(").concat(bd("uniforms.x_shape",i,t),")) {\n                  k = i32(").concat(bd("uniforms.x_shape",i,t),") - 1;\n                }\n                offset += k * i32(").concat(bd("uniforms.x_strides",i,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(r,"\n              value = x[offset];\n          ")},Pm=function(e,t,n){for(var r="",i=t-1;i>=0;--i)r+="\n                k = i32(".concat(e.indicesGet("indices",i),") - ").concat(bd("uniforms.pads",i,n),";\n                if (k < 0)  {\n                  k += i32(").concat(bd("uniforms.x_shape",i,t),"]);\n                }\n                if (k >= i32(").concat(bd("uniforms.x_shape",i,t),")) {\n                  k -= i32(").concat(bd("uniforms.x_shape",i,t),");\n                }\n                offset += k * i32(").concat(bd("uniforms.x_strides",i,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(r,"\n              value = x[offset];\n          ")},Rm=function(e,t,n){switch(n.mode){case 0:return Tm(e,t,n.pads.length);case 1:return Em(e,t,n.pads.length);case 2:return Om(e,t,n.pads.length);case 3:return Pm(e,t,n.pads.length);default:throw new Error("Invalid mode")}},Bm=function(e,t){var n=sd.padShape(e[0].dims.slice(),t.pads),r=e[0].dims,i=[{type:"uint32",data:sd.size(n)},{type:"uint32",data:t.pads}];if(0===t.mode){var o=Lf(e[0].dataType);i.push({type:o,data:t.value})}return i.push.apply(i,_toConsumableArray(yd(e[0].dims)).concat(_toConsumableArray(yd(n)))),{name:"Pad",shaderCache:{hint:"".concat(t.mode),inputDependencies:["rank"]},getRunData:function(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(sd.size(n)/64)},programUniforms:i}},getShaderSource:function(i){var o=Id("output",e[0].dataType,n.length),a=_d("x",e[0].dataType,r.length),s=a.type.value,u=Rm(o,r.length,t),c=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return 0===t.mode&&c.push({name:"constant_value",type:s}),"\n            ".concat(i.registerUniforms(c).declareVariables(a,o),"\n            ").concat(i.mainStart(),"\n            ").concat(i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n            let indices = ").concat(o.offsetToIndices("global_idx"),";\n\n            var value = ").concat(s,"(0);\n            ").concat(u,"\n            output[global_idx] = value;\n        }")}}},Dm=function(e,t){if(e.length>1){var n=e[1].getBigInt64Array(),r=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,i=e[0].dims.length,o=new Int32Array(2*i).fill(0);if(e.length>=4)for(var a=e[3].getBigInt64Array(),s=0;s<a.length;s++)o[Number(a[s])]=Number(n[s]),o[Number(a[s])+i]=Number(n[s+a.length]);else n.forEach((function(e,t){return o[Number(t)]=Number(e)}));var u=[];return o.forEach((function(e){return u.push(e)})),{mode:t.mode,value:r,pads:u}}return t},Mm=function(e,t){Sm(e.inputs);var n=Dm(e.inputs,t);e.compute(Bm(e.inputs,n),{inputs:[0]})}})),Qw=Bh((function(){ef(),ww(),bw(),Lm=function(e){if(Ql.webgpu.validateInputContent&&(!e||1!==e.length))throw new Error("Pool ops requires 1 input.")},Fm=function(e,t,n){var r="NHWC"===t.format,i=e.dims.slice();r&&i.splice(1,0,i.pop());var o=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),s=t.strides.slice(),u=o?t.dilations.slice():[],c=t.pads.slice();ud.adjustPoolAttributes(n,i,a,s,u,c);var l=ud.computePoolOutputShape(n,i,s,u,a,c,t.autoPad),h=Object.assign({},t);o?Object.assign(h,{kernelShape:a,strides:s,pads:c,dilations:u,cacheKey:t.cacheKey}):Object.assign(h,{kernelShape:a,strides:s,pads:c,cacheKey:t.cacheKey});var f=l.slice();return f.push(f.splice(1,1)[0]),[h,r?f:l]},Nm=function(e,t){var n="NHWC"===t.format,r=[{type:"uint32",data:sd.size(e)},{type:"uint32",data:sd.size(t.kernelShape)}],i=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){var o=t.kernelShape[t.kernelShape.length-1],a=t.strides[t.strides.length-1],s=t.pads[t.pads.length/2-1],u=t.pads[t.pads.length-1],c=!!(s+u);r.push({type:"uint32",data:o},{type:"uint32",data:a},{type:"uint32",data:s},{type:"uint32",data:u}),i.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});var l=!1;if(2===t.kernelShape.length){var h=t.kernelShape[t.kernelShape.length-2],f=t.strides[t.strides.length-2],d=t.pads[t.pads.length/2-2],p=t.pads[t.pads.length-2];l=!!(d+p),r.push({type:"uint32",data:h},{type:"uint32",data:f},{type:"uint32",data:d},{type:"uint32",data:p}),i.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[r,i,!0,c,l]}if(n)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");var y=sd.computeStrides(t.kernelShape);r.push({type:"uint32",data:y},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),i.push({name:"kernelStrides",type:"u32",length:y.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});var g=t.pads.reduce((function(e,t){return e+t}));return[r,i,!!g,!1,!1]},Um=function(e,t,n,r,i,o,a,s,u,c,l,h){var f="NHWC"===i.format,d=t.type.value,p=Id("output",t.type.tensor,r);if(i.kernelShape.length<=2){var y,g="",m="",v=n-(f?2:1);if(y=l?"\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[".concat(v,"] = indices[").concat(v,"] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[").concat(v,"] < 0 || xIndices[").concat(v,"]\n                      >= uniforms.x_shape[").concat(v,"]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[").concat(t.indicesToOffset("xIndices"),"];\n                  ").concat(o,"\n                }"):"\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[".concat(v,"] = indices[").concat(v,"] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[").concat(t.indicesToOffset("xIndices"),"];\n                  ").concat(o,"\n                }"),2===i.kernelShape.length){var w=n-(f?3:2);g=h?"\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[".concat(w,"] = indices[").concat(w,"] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[").concat(w,"] < 0 || xIndices[").concat(w,"] >= uniforms.x_shape[").concat(w,"]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              "):"\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[".concat(w,"] = indices[").concat(w,"] * uniforms.sh - uniforms.phStart + j;\n                "),m="\n              }\n            "}return"\n            ".concat(e.registerUniforms(u).declareVariables(t,p),"\n\n            ").concat(e.mainStart(),"\n              ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n              let indices = ").concat(p.offsetToIndices("global_idx"),";\n              var xIndices = ").concat(p.offsetToIndices("global_idx"),";\n\n              var value = ").concat(d,"(").concat(s,");\n              var pad = 0;\n              ").concat(g,"\n              ").concat(y,"\n              ").concat(m,"\n              ").concat(a,"\n\n              output[global_idx] = value;\n            }")}if(f)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");var b,x=i.kernelShape.length,_=i.pads.length;return b=c?"\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[".concat(t.indicesToOffset("xIndices"),"];\n                ").concat(o,"\n              }"):"\n              }\n              let x_val = x[".concat(t.indicesToOffset("xIndices"),"];\n              ").concat(o,"\n            "),"\n            ".concat(e.registerUniforms(u).declareVariables(t,p),"\n\n            ").concat(e.mainStart(),"\n              ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n              let indices = ").concat(p.offsetToIndices("global_idx"),";\n              var xIndices = ").concat(p.offsetToIndices("global_idx"),";\n\n              var offsets: array<u32, ").concat(x,">;\n\n              var value = ").concat(d,"(").concat(s,");\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ").concat(x-1,"u; j++) {\n                  offsets[j] = offset / ").concat(bd("uniforms.kernelStrides","j",x),";\n                  offset -= offsets[j] * ").concat(bd("uniforms.kernelStrides","j",x),";\n                }\n                offsets[").concat(x-1,"] = offset;\n\n                isPad = false;\n                for (var j = ").concat(n-x,"u; j < ").concat(n,"u; j++) {\n                  xIndices[j] = indices[j] * ").concat(bd("uniforms.strides","j - ".concat(n-x,"u"),x),"\n                    + offsets[j - ").concat(n-x,"u] - ").concat(bd("uniforms.pads","j - 2u",_),";\n                  ").concat(b,"\n              }\n              ").concat(a,"\n\n              output[global_idx] = value;\n            }")},jm=function(e){return"".concat(e.format,";").concat(e.ceilMode,";").concat(e.autoPad,";").concat(e.kernelShape.length)},Gm=function(e){return"".concat(jm(e),";").concat(e.countIncludePad)},zm=function(e){return"".concat(jm(e),";").concat(e.storageOrder,";").concat(e.dilations)},Hm=function(e){return{format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}},Vm=function(e,t,n,r){var i=_slicedToArray(Fm(t,r,n),2),o=i[0],a=i[1],s=_d("x",t.dataType,t.dims.length),u=s.type.value,c="";o.countIncludePad?c+="value /= ".concat(u,"(uniforms.kernelSize);"):c+="value /= ".concat(u,"(i32(uniforms.kernelSize) - pad);");var l=_slicedToArray(Nm(a,o),5),h=l[0],f=l[1],d=l[2],p=l[3],y=l[4];return h.push.apply(h,_toConsumableArray(yd(t.dims)).concat(_toConsumableArray(yd(a)))),{name:e,shaderCache:{hint:"".concat(r.cacheKey,";").concat(d,";").concat(p,";").concat(y),inputDependencies:["rank"]},getRunData:function(){return{outputs:[{dims:a,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(sd.size(a)/64)},programUniforms:h}},getShaderSource:function(e){return Um(e,s,t.dims.length,a.length,o,"value += x_val;",c,0,f,d,p,y)}}},Wm=function(e){var t=0!==e.count_include_pad,n=Hm(e);if(0!==n.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");var r=_objectSpread(_objectSpread({countIncludePad:t},n),{},{cacheKey:""});return _objectSpread(_objectSpread({},r),{},{cacheKey:Gm(r)})},$m=function(e,t){Lm(e.inputs),e.compute(Vm("AveragePool",e.inputs[0],!1,t))},Ym={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Km=function(e){var t=e.format;return _objectSpread(_objectSpread({format:t},Ym),{},{cacheKey:t})},Xm=function(e,t){Lm(e.inputs),e.compute(Vm("GlobalAveragePool",e.inputs[0],!0,t))},Zm=function(e,t,n,r){var i=_slicedToArray(Fm(t,r,n),2),o=i[0],a=i[1],s=_d("x",t.dataType,t.dims.length),u=_slicedToArray(Nm(a,o),5),c=u[0],l=u[1],h=u[2],f=u[3],d=u[4];return c.push.apply(c,_toConsumableArray(yd(t.dims)).concat(_toConsumableArray(yd(a)))),{name:e,shaderCache:{hint:"".concat(r.cacheKey,";").concat(h,";").concat(f,";").concat(d),inputDependencies:["rank"]},getRunData:function(){return{outputs:[{dims:a,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(sd.size(a)/64)},programUniforms:c}},getShaderSource:function(e){return Um(e,s,t.dims.length,a.length,o,"\n      value = max(x_val, value);\n    ","",-1e5,l,h,f,d)}}},qm=function(e,t){Lm(e.inputs),e.compute(Zm("MaxPool",e.inputs[0],!1,t))},Jm=function(e){var t=e.storage_order,n=e.dilations,r=Hm(e);if(0!==t)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==r.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");var i=_objectSpread(_objectSpread({storageOrder:t,dilations:n},r),{},{cacheKey:""});return _objectSpread(_objectSpread({},i),{},{cacheKey:zm(i)})},Qm=function(e){var t=e.format;return _objectSpread(_objectSpread({format:t},Ym),{},{cacheKey:t})},ev=function(e,t){Lm(e.inputs),e.compute(Zm("GlobalMaxPool",e.inputs[0],!0,t))}})),eb=Bh((function(){ef(),fw(),bw(),tv=function(e,t,n){if(e===t||e<t&&n<0||e>t&&n>0)throw new Error("Range these inputs' contents are invalid.")},nv=function(e,t,n,r){var i=Math.abs(Math.ceil((t-e)/n)),o=[i],a=i,s=Lf(r),u=[{type:"uint32",data:a},{type:s,data:e},{type:s,data:n}].concat(_toConsumableArray(yd(o)));return{name:"Range",shaderCache:{hint:"".concat(r)},getShaderSource:function(e){var t=Id("output",r,o.length),n=t.type.value,i=[{name:"outputSize",type:"u32"},{name:"start",type:n},{name:"delta",type:n}];return"\n        ".concat(e.registerUniforms(i).declareVariables(t),"\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n        output[global_idx] = uniforms.start + ").concat(n,"(global_idx) * uniforms.delta;\n      }")},getRunData:function(){return{outputs:[{dims:o,dataType:r}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}}}},rv=function(e){var t=0,n=0,r=0;6===e.inputs[0].dataType?(t=e.inputs[0].getInt32Array()[0],n=e.inputs[1].getInt32Array()[0],r=e.inputs[2].getInt32Array()[0]):1===e.inputs[0].dataType&&(t=e.inputs[0].getFloat32Array()[0],n=e.inputs[1].getFloat32Array()[0],r=e.inputs[2].getFloat32Array()[0]),Ql.webgpu.validateInputContent&&tv(t,n,r),e.compute(nv(t,n,r,e.inputs[0].dataType),{inputs:[]})}})),tb=Bh((function(){ww(),vw(),bw(),iv=function(e,t){if(e.every((function(e){return e>0||function(){throw new Error("Resize requires scales input values to be positive")}})),e.length>0)if("linear"===t.mode){if(!(2===e.length||3===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]||5===e.length&&1===e[0]&&1===e[1]))throw new Error("For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1")}else if("cubic"===t.mode&&!(2===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")},ov=function(e,t,n){t.every((function(e){return e>=0&&e<n||function(){throw new Error("Resize requires axes input values to be positive and less than rank")}}));var r=new Array(n).fill(1);return t.forEach((function(t,n){return r[t]=e[n]})),r},av=function(e,t,n,r,i,o){var a=_slicedToArray(n>10?[1,2,3]:[-1,e.length>1?1:-1,-1],3),s=a[0],u=a[1],c=a[2],l=e[0].dims.length;if(s>0&&e.length>s&&e[s].dims.length>0)e[s].getFloat32Array().forEach((function(e){return o.push(e)}));else if("tf_crop_and_resize"===t.coordinateTransformMode)throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(u>0&&e.length>u&&e[u].dims.length>0){if(e[u].getFloat32Array().forEach((function(e){return r.push(e)})),0!==r.length&&r.length!==l&&n>=18&&r.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");iv(r,t),t.axes.length>0&&ov(r,t.axes,l).forEach((function(e,t){return r[t]=e}))}if(c>0&&e.length>c&&(e[c].getBigInt64Array().forEach((function(e){return i.push(Number(e))})),i.length!==l||n>=18&&i.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(r.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(_typeof(r)<"u"&&_typeof(i)<"u"&&r.length>0&&i.length>l)throw new Error("Resize requires only of scales or sizes to be specified")},sv=function(e,t){return"fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ".concat(t," { ")+function(){switch(e){case"asymmetric":return"return ".concat(t,"(xResized) / ").concat(t,"(xScale);");case"pytorch_half_pixel":return"if (lengthResized > 1) {\n                    return (".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }");case"tf_half_pixel_for_nn":return"return (".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale);");case"align_corners":return"if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ".concat(t,"(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ").concat(t,"(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ").concat(t,"(lengthResized - 1);\n                    return whole + fract;\n                  }");case"tf_crop_and_resize":return"if (lengthResized > 1) {\n                    return ".concat(t,"(roiStart) * ").concat(t,"(lengthOriginal - 1) +\n                        (").concat(t,"(xResized) * ").concat(t,"(roiEnd - roiStart) * ").concat(t,"(lengthOriginal - 1)) /\n                        ").concat(t,"(lengthResized - 1);\n                  } else {\n                    return 0.5 * ").concat(t,"(roiStart + roiEnd) * ").concat(t,"(lengthOriginal - 1);\n                  }");case"half_pixel_symmetric":return"const outputWidth = ".concat(t,"xScale * ").concat(t,"(lengthResized);\n                  const adjustment = ").concat(t,"(lengthResized) / outputWidth;\n                  const center = ").concat(t,"(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((").concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale)) - 0.5;");case"half_pixel":return"return ((".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale)) - 0.5;");default:throw new Error("Coordinate transform mode ".concat(e," is not supported"))}}()+"}"},uv=function(e,t,n){return"fn getNearestPixelFromOriginal(xOriginal: ".concat(n,", isDownSample: bool) -> ").concat(n," {")+function(){switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error("Nearest mode ".concat(e," is not supported"))}}()+"}"},cv=function(e,t,n){var r=new Array(n).fill(0).concat(new Array(n).fill(1)),i=0===e.length?r:e.slice();return t.length>0?(t.forEach((function(e,o){r[e]=i[o],r[o+n]=i[t.length+o]})),r):i},lv=function(e,t,n,r){var i=[];if(n.length>0)if(r.length>0){if(e.forEach((function(e){return i.push(e)})),Math.max.apply(Math,_toConsumableArray(r))>e.length)throw new Error("axes is out of bound");r.forEach((function(e,t){return i[e]=n[t]}))}else n.forEach((function(e){return i.push(e)}));else{if(0===t.length)throw new Error("Resize requires either scales or sizes.");i=e.map((function(e,n){return Math.round(e*t[n])}))}return i},hv=function(e,t,n){var r=function(){switch(n.keepAspectRatioPolicy){case"not_larger":return n.axes.length>0?Math.min.apply(Math,_toConsumableArray(n.axes.map((function(e){return t[e]}))).concat([Number.MAX_VALUE])):Math.min.apply(Math,_toConsumableArray(t).concat([Number.MAX_VALUE]));case"not_smaller":return n.axes.length>0?Math.max.apply(Math,_toConsumableArray(n.axes.map((function(e){return t[e]}))).concat([Number.MIN_VALUE])):Math.max.apply(Math,_toConsumableArray(t).concat([Number.MIN_VALUE]));default:throw new Error("Keep aspect ratio policy ".concat(n.keepAspectRatioPolicy," is not supported"))}}();t.fill(1,0,t.length);var i=e.slice();return n.axes.length>0?(n.axes.forEach((function(e){return t[e]=r})),n.axes.forEach((function(n){return i[n]=Math.round(e[n]*t[n])}))):(t.fill(r,0,t.length),i.forEach((function(e,n){return i[n]=Math.round(e*t[n])}))),i},fv=function(e,t,n,r,i){return"\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ".concat(e.type.indices,") -> array<").concat(e.type.value,", ").concat(n.length,"> {\n      var original_indices: array<").concat(e.type.value,", ").concat(n.length,">;\n      for (var i:u32 = 0; i < ").concat(n.length,"; i++) {\n        var output_index = ").concat(e.indicesGet("output_indices","i"),";\n        var scale = ").concat(bd("uniforms.scales","i",r),";\n        var roi_low = ").concat(bd("uniforms.roi","i",i),";\n        var roi_hi = ").concat(bd("uniforms.roi","i + ".concat(t.length),i),";\n        if (scale == 1.0) {\n          original_indices[i] = ").concat(e.type.value,"(output_index);\n        } else {\n          var input_shape_i = ").concat(bd("uniforms.input_shape","i",t.length),";\n          var output_shape_i = ").concat(bd("uniforms.output_shape","i",n.length),";\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }")},dv=function(e,t,n,r,i,o,a){return"\n    fn calculateInputIndicesFromOutputIndices(output_indices: ".concat(t.type.indices,") -> ").concat(e.type.indices," {\n      var input_indices: ").concat(e.type.indices,";\n      for (var i:u32 = 0; i < ").concat(r.length,"; i++) {\n        var output_index = ").concat(t.indicesGet("output_indices","i"),";\n        var input_index: u32;\n        var scale = ").concat(bd("uniforms.scales","i",i),";\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ").concat(bd("uniforms.roi","i",o),";\n          var roi_hi = ").concat(bd("uniforms.roi","i + ".concat(n.length),o),";\n          var input_shape_i = ").concat(bd("uniforms.input_shape","i",n.length),";\n          var output_shape_i = ").concat(bd("uniforms.output_shape","i",r.length),";\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!").concat(a," || (original_idx >= 0 && original_idx < ").concat(t.type.value,"(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ").concat(t.type.value,"(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ").concat(e.indicesSet("input_indices","i"," input_index"),"\n      }\n      return input_indices;\n    }")},pv=function(e,t){return"\n    fn checkInputIndices(input_indices: ".concat(e.type.indices,") -> bool {\n      for (var i:u32 = 0; i < ").concat(t.length,"; i++) {\n        var input_index = ").concat(e.indicesGet("input_indices","i"),";\n        if (input_index < 0 || input_index >= ").concat(bd("uniforms.input_shape","i",t.length),") {\n          return false;\n        }\n      }\n      return true;\n    }")},yv=function(e,t,n,r){return e.rank>r?"\n    ".concat(e.indicesSet("input_indices",t,"channel"),";\n    ").concat(e.indicesSet("input_indices",n,"batch"),";\n"):""},gv=function(e,t,n,r,i){var o=_slicedToArray(2===n.length?[-1,0,1,-1]:[0,2,3,1],4),a=o[0],s=o[1],u=o[2],c=o[3],l=e.type.value;return"\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ".concat(l," {\n      var input_indices: ").concat(e.type.indices,";\n      ").concat(e.indicesSet("input_indices",s,"max(0, min(row, ".concat(n[s]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",u,"max(0, min(col, ".concat(n[u]," - 1))")),";\n      ").concat(yv(e,c,a,2),"\n      return ").concat(e.getByIndices("input_indices"),";\n    }\n\n    fn bilinearInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(l," {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:").concat(l," = originalIndices[").concat(s,"];\n      var col:").concat(l," = originalIndices[").concat(u,"];\n      ").concat(r?"if (row < 0 || row > (".concat(n[s]," - 1) || col < 0 || col > (").concat(n[u]," - 1)) {\n        return ").concat(i,";\n      }"):"",";\n      row = max(0, min(row, ").concat(n[s]," - 1));\n      col = max(0, min(col, ").concat(n[u]," - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ").concat(n.length>2?"u32(originalIndices[".concat(c,"])"):"0",";\n      var batch: u32 =  ").concat(n.length>2?"u32(originalIndices[".concat(a,"])"):"0",";\n      var x11: ").concat(l," = getInputValue(batch, channel, row1, col1);\n      var x12: ").concat(l," = getInputValue(batch, channel, row1, col2);\n      var x21: ").concat(l," = getInputValue(batch, channel, row2, col1);\n      var x22: ").concat(l," = getInputValue(batch, channel, row2, col2);\n      var dx1: ").concat(l," = abs(row - ").concat(l,"(row1));\n      var dx2: ").concat(l," = abs(").concat(l,"(row2) - row);\n      var dy1: ").concat(l," = abs(col - ").concat(l,"(col1));\n      var dy2: ").concat(l," = abs(").concat(l,"(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }")},mv=function(e,t,n,r,i,o,a,s,u,c){var l=_slicedToArray(2===n.length?[0,1]:[2,3],2),h=l[0],f=l[1],d=e.type.value,p=function(a){var l=a===h?"row":"col";return"\n      fn ".concat(l,"CubicInterpolation(input_indices: ").concat(e.type.indices,", output_indices: ").concat(t.type.indices,") -> ").concat(d," {\n        var output_index = ").concat(t.indicesGet("output_indices",a),";\n        var originalIdx: ").concat(d," = getOriginalCoordinateFromResizedCoordinate(output_index, ").concat(i[a],",\n        ").concat(r[a],", ").concat(n[a],", ").concat(o[a],", ").concat(o[a]," + ").concat(n.length,");\n        var fractOriginalIdx: ").concat(d," = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (").concat(s," && (originalIdx < 0 || originalIdx > (").concat(n[a]," - 1))) {\n          return ").concat(u,";\n        }\n        var data: array<").concat(d,", 4> = array<").concat(d,", 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ").concat(l,": ").concat(d," = originalIdx + ").concat(d,"(i);\n          if (").concat(l," < 0 || ").concat(l," >= ").concat(n[a],") {\n            ").concat(c?"coefs[i + 1] = 0.0;\n                        continue;":s?"return ".concat(u,";"):"".concat(l," = max(0, min(").concat(l,", ").concat(n[a]," - 1));"),";\n          }\n        var input_indices_copy: ").concat(e.type.indices," = input_indices;\n          ").concat(e.indicesSet("input_indices_copy",a,"u32(".concat(l,")")),";\n          data[i + 1] = ").concat(a===h?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)",";\n        }\n        return cubicInterpolation1D(data, coefs);\n      }")};return"\n    ".concat(p(h),";\n    ").concat(p(f),";\n  fn getCubicInterpolationCoefs(s: ").concat(d,") -> array<").concat(d,", 4> {\n    var absS = abs(s);\n    var coeffs: array<").concat(d,", 4> = array<").concat(d,", 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ").concat(d," = 1.0 - absS;\n    var twoMinusAbsS: ").concat(d," = 2.0 - absS;\n    var onePlusAbsS: ").concat(d," = 1.0 + absS;\n    coeffs[0] = ((").concat(a," * onePlusAbsS - 5 * ").concat(a,") * onePlusAbsS + 8 * ").concat(a,") * onePlusAbsS - 4 * ").concat(a,";\n    coeffs[1] = ((").concat(a," + 2) * absS - (").concat(a," + 3)) * absS * absS + 1;\n    coeffs[2] = ((").concat(a," + 2) * oneMinusAbsS - (").concat(a," + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((").concat(a," * twoMinusAbsS - 5 * ").concat(a,") * twoMinusAbsS + 8 * ").concat(a,") * twoMinusAbsS - 4 * ").concat(a,";\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<").concat(d,", 4>, coefs: array<").concat(d,", 4>) -> ").concat(d," {\n    var coefsSum: ").concat(d," = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(d," {\n    var input_indices: ").concat(e.type.indices," = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    ")},vv=function(e,t,n,r,i){var o=_slicedToArray(3===n.length?[-1,0,1,2,-1]:[0,2,3,4,1],5),a=o[0],s=o[1],u=o[2],c=o[3],l=o[4],h=e.type.value;return"\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ".concat(h," {\n      var input_indices: ").concat(e.type.indices,";\n      ").concat(e.indicesSet("input_indices",s,"max(0, min(depth, ".concat(n[s]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",u,"max(0, min(height, ".concat(n[u]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",c,"max(0, min(width, ".concat(n[c]," - 1))")),";\n      ").concat(yv(e,l,a,3),"\n      return ").concat(e.getByIndices("input_indices"),";\n    }\n\n    fn trilinearInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(h," {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:").concat(h," = originalIndices[").concat(s,"];\n      var height:").concat(h," = originalIndices[").concat(u,"];\n      var width:").concat(h," = originalIndices[").concat(c,"];\n      ").concat(r?"if (depth < 0 || depth > (".concat(n[s]," - 1) || height < 0 || height > (").concat(n[u]," - 1) || width < 0 || (width > ").concat(n[c]," - 1)) {\n      return ").concat(i,";\n        }"):"",";\n\n    depth = max(0, min(depth, ").concat(n[s]," - 1));\n      height = max(0, min(height, ").concat(n[u]," - 1));\n      width = max(0, min(width, ").concat(n[c]," - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ").concat(n.length>3?"u32(originalIndices[".concat(l,"])"):"0",";\n      var batch: u32 =  ").concat(n.length>3?"u32(originalIndices[".concat(a,"])"):"0",";\n\n      var x111: ").concat(h," = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ").concat(h," = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ").concat(h," = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ").concat(h," = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ").concat(h," = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ").concat(h," = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ").concat(h," = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ").concat(h," = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ").concat(h," = abs(depth - ").concat(h,"(depth1));\n      var dx2: ").concat(h," = abs(").concat(h,"(depth2) - depth);\n      var dy1: ").concat(h," = abs(height - ").concat(h,"(height1));\n      var dy2: ").concat(h," = abs(").concat(h,"(height2) - height);\n      var dz1: ").concat(h," = abs(width - ").concat(h,"(width1));\n      var dz2: ").concat(h," = abs(").concat(h,"(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }")},wv=function(e,t,n,r,i,o){var a=e.dims,s=cv(o,t.axes,a.length),u=lv(a,r,i,t.axes),c=r.slice();0===r.length&&(c=a.map((function(e,t){return 0===e?1:u[t]/e})),"stretch"!==t.keepAspectRatioPolicy&&(u=hv(a,c,t)));var l=Id("output",e.dataType,u.length),h=_d("input",e.dataType,a.length),f=sd.size(u),d=a.length===u.length&&a.every((function(e,t){return e===u[t]})),p="tf_crop_and_resize"===t.coordinateTransformMode,y=t.extrapolationValue,g=h.type.value;return{name:"Resize",shaderCache:{hint:"".concat(t.cacheKey,"|").concat(n,"|").concat(c.length>0?c:"","|").concat(i.length>0?i:"","|").concat(s.length>0?s:"","|").concat(d,"|").concat(a),inputDependencies:["rank"]},getShaderSource:function(e){return"\n      ".concat(d?"":"\n      ".concat(sv(t.coordinateTransformMode,g),";\n      ").concat(function(){switch(t.mode){case"nearest":return"\n              ".concat(pv(h,a),";\n              ").concat(uv(t.nearestMode,n,g),";\n              ").concat(dv(h,l,a,u,c.length,s.length,p),";\n              ");case"linear":return"\n              ".concat(fv(l,a,u,c.length,s.length),";\n              ").concat(function(){if(2===a.length||4===a.length)return"".concat(gv(h,l,a,p,y));if(3===a.length||5===a.length)return"".concat(vv(h,l,a,p,y));throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")}(),";\n            ");case"cubic":return"\n            ".concat(function(){if(2===a.length||4===a.length)return"".concat(mv(h,l,a,u,c,s,t.cubicCoeffA,p,t.extrapolationValue,t.excludeOutside));throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")}(),";\n            ");default:throw Error("Invalid resize mode")}}(),";\n      "),"\n      ").concat(e.registerUniform("output_size","u32").registerUniform("scales","f32",c.length).registerUniform("roi","f32",s.length).declareVariables(h,l),"\n      ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n        ").concat(d?"output[global_idx] = input[global_idx];":"\n        let output_indices = ".concat(l.offsetToIndices("global_idx"),";\n        var input_indices: ").concat(h.type.indices,";\n        ").concat(function(){switch(t.mode){case"nearest":return"input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ".concat(h.getByIndices("input_indices"),";\n                } else {\n                  output[global_idx] = ").concat(t.extrapolationValue,";\n                }");case"linear":return"output[global_idx] = ".concat(2===a.length||4===a.length?"bilinearInterpolation":"trilinearInterpolation","(output_indices);");case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error("Unsupported resize mode: ".concat(t.mode))}}(),";\n"),"\n      }")},getRunData:function(){return{outputs:[{dims:u,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:[{type:"uint32",data:f},{type:"float32",data:c},{type:"float32",data:s}].concat(_toConsumableArray(yd(a)),_toConsumableArray(yd(u)))}}}},bv=function(e){var t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},xv=function(e,t){var n=[],r=[],i=[],o=bv(e);if(0!==t.antialias)throw Error("Only default value (0) for Antialias attribute is supported");av(e.inputs,t,o,n,r,i),e.compute(wv(e.inputs[0],t,o,n,r,i),{inputs:[0]})},_v=function(e){var t=e.antialias,n=e.axes,r=e.coordinateTransformMode,i=e.cubicCoeffA,o=0!==e.excludeOutside,a=e.extrapolationValue,s=e.keepAspectRatioPolicy,u=e.mode,c=""===e.nearestMode?"simple":e.nearestMode;return id({antialias:t,axes:n,coordinateTransformMode:r,cubicCoeffA:i,excludeOutside:o,extrapolationValue:a,keepAspectRatioPolicy:s,mode:u,nearestMode:c})}})),nb=Bh((function(){fw(),ww(),vw(),bw(),Iv=function(e){if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");var t=e[0],n=e[1],r=e[2];if(t.dataType!==n.dataType||t.dataType!==r.dataType)throw new Error("All inputs must have the same data type");if(3!==t.dims.length&&2!==t.dims.length)throw new Error("Input must be 2D or 3D");if(3!==n.dims.length&&2!==n.dims.length)throw new Error("Skip must be 2D or 3D");var i=t.dims[t.dims.length-1],o=t.dims[t.dims.length-2];if(n.dims[n.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(n.dims[n.dims.length-2]!==o)throw new Error("Skip must have the same sequence length as input");if(1!==r.dims.length)throw new Error("Gamma must be 1D");if(r.dims[r.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){var a=e[3];if(1!==a.dims.length)throw new Error("Beta must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){var s=e[4];if(1!==s.dims.length)throw new Error("Bias must be 1D");if(s.dims[s.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},Av=function(e,t,n,r){var i=e[0].dims,o=i,a=sd.size(i),s=i.slice(-1)[0],u=r?i.slice(0,-1).concat(1):[],c=e.length>3,l=e.length>4,h=r&&n>1,f=r&&n>2,d=n>3,p=gd(s),y=[_d("x",e[0].dataType,e[0].dims,p),_d("skip",e[1].dataType,e[1].dims,p),_d("gamma",e[2].dataType,e[2].dims,p)];c&&y.push(_d("beta",e[3].dataType,e[3].dims,p)),l&&y.push(_d("bias",e[4].dataType,e[4].dims,p)),y.push(Id("output",e[0].dataType,o,p)),h&&y.push(Id("meanOutput",1,u)),f&&y.push(Id("invStdOutput",1,u)),d&&y.push(Id("inputSkipBiasSum",e[0].dataType,o,p));var g=dd(e[0].dataType),m=[{dims:o,dataType:e[0].dataType}];return n>1&&m.push({dims:u,dataType:1}),n>2&&m.push({dims:u,dataType:1}),n>3&&m.push({dims:i,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:function(e){return"\n      const hiddenSize: f32 = ".concat(s,";\n      const hiddenSizeVectorized: u32 = ").concat(s/p,";\n      const epsilon: f32 = ").concat(t.epsilon,";\n\n      ").concat(e.declareVariables.apply(e,y),"\n\n      ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(a/s),"\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ").concat(md("f32",p),";\n        var squareSum = ").concat(md("f32",p),";\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ").concat(l?"bias[i]":"0.0",";\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ").concat(d?"inputSkipBiasSum[offset + i] = value;":"","\n          output[offset + i] = value;\n          let f32Value = ").concat(vd(g,p,"value"),";\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ").concat(wd("sum",p)," / hiddenSize;\n        let invStdDev = inverseSqrt(").concat(wd("squareSum",p)," / hiddenSize - mean * mean + epsilon);\n        ").concat(h?"meanOutput[global_idx] = mean;":"","\n        ").concat(f?"invStdOutput[global_idx] = invStdDev;":"","\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ").concat(g,"(mean)) * ").concat(g,"(invStdDev) * gamma[i]\n           + ").concat(c?"beta[i]":"0.0",";\n        }\n      }")},getRunData:function(){return{outputs:m,dispatchGroup:{x:Math.ceil(a/s/64)}}}}},Cv=function(e,t){Iv(e.inputs);var n=[0];e.outputCount>1&&n.push(-3),e.outputCount>2&&n.push(-3),e.outputCount>3&&n.push(3),e.compute(Av(e.inputs,t,e.outputCount,!1),{outputs:n})},kv=function(e){var t=e.epsilon;return id({epsilon:t})}})),rb=Bh((function(){fw(),ww(),vw(),bw(),Sv=function(e,t){if(!e||e.length<1)throw new Error("too few inputs");if(0!==t.axes.length){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((function(t,n){if(6!==e[n+1].dataType&&7!==e[n+1].dataType)throw new Error("Input ".concat(n," must be an array of int32 or int64"))}))},Tv=function(e,t){var n=[];if(e.length>t)if(7===e[t].dataType)e[t].getBigInt64Array().forEach((function(e){return n.push(Number(e))}));else{if(6!==e[t].dataType)throw new Error("Input ".concat(t," must be an array of int32 or int64"));e[t].getInt32Array().forEach((function(e){return n.push(Number(e))}))}return n},Ev=function(e,t){if(e.length>1){var n=Tv(e,1),r=Tv(e,2),i=Tv(e,3);return 0===i.length&&(i=_toConsumableArray(Array(e[0].dims.length).keys())),id({starts:n,ends:r,axes:i})}return t},Ov=function(e,t,n,r,i){var o=e;return e<0&&(o+=n[r[t]]),i[t]<0?Math.max(0,Math.min(o,n[r[t]]-1)):Math.max(0,Math.min(o,n[r[t]]))},Pv=function(e,t,n){return"fn calculateInputIndices(output_indices: ".concat(t.type.indices,") -> ").concat(e.type.indices," {\n          var input_indices: ").concat(e.type.indices,";\n          var carry = 0u;\n          for (var i = ").concat(n.length,"; i >= 0; i--) {\n            let input_shape_i = ").concat(bd("uniforms.input_shape","i",n.length),";\n            let steps_i = ").concat(bd("uniforms.steps","i",n.length),";\n            let signs_i = ").concat(bd("uniforms.signs","i",n.length),";\n            let starts_i = ").concat(bd("uniforms.starts","i",n.length),";\n            var output_index = ").concat(t.indicesGet("output_indices","i"),";\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ").concat(e.indicesSet("input_indices","i","input_index"),";\n          }\n          return input_indices;\n      }")},Rv=function(e,t){var n=e[0].dims,r=sd.size(n),i=t.axes.length>0?sd.normalizeAxes(t.axes,n.length):_toConsumableArray(Array(n.length).keys()),o=Tv(e,4);o.forEach((function(e){return 0!==e||function(){throw new Error("step cannot be 0")}})),0===o.length&&(o=Array(i.length).fill(1));var a=t.starts.map((function(e,t){return Ov(e,t,n,i,o)})),s=t.ends.map((function(e,t){return Ov(e,t,n,i,o)}));if(i.length!==a.length||i.length!==s.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==n.length)for(var u=0;u<n.length;++u)i.includes(u)||(a.splice(u,0,0),s.splice(u,0,n[u]),o.splice(u,0,1));var c=o.map((function(e){return Math.sign(e)}));o.forEach((function(e,t,n){if(e<0){var r=(s[t]-a[t])/e,i=a[t],u=i+r*o[t];a[t]=u,s[t]=i,n[t]=-e}}));var l=n.slice(0);i.forEach((function(e,t){l[e]=Math.ceil((s[e]-a[e])/o[e])}));var h={dims:l,dataType:e[0].dataType},f=Id("output",e[0].dataType,l.length),d=_d("input",e[0].dataType,e[0].dims.length),p=sd.size(l),y=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:c.length},{name:"steps",type:"u32",length:o.length}],g=[{type:"uint32",data:p},{type:"uint32",data:a},{type:"int32",data:c},{type:"uint32",data:o}].concat(_toConsumableArray(yd(e[0].dims)),_toConsumableArray(yd(l)));return{name:"Slice",shaderCache:{hint:"".concat(c.length,"_").concat(a.length,"_").concat(o.length),inputDependencies:["rank"]},getShaderSource:function(e){return"\n      ".concat(e.registerUniforms(y).declareVariables(d,f),"\n        ").concat(Pv(d,f,n),"\n        ").concat(e.mainStart(),"\n          ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n          let output_indices = ").concat(f.offsetToIndices("global_idx"),";\n          let input_indices = calculateInputIndices(output_indices);\n          ").concat(f.setByOffset("global_idx",d.getByIndices("input_indices")),"\n      }")},getRunData:function(){return{outputs:[h],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:g}}}},Bv=function(e,t){Sv(e.inputs,t);var n=Ev(e.inputs,t);e.compute(Rv(e.inputs,n),{inputs:[0]})},Dv=function(e){var t=e.starts,n=e.ends,r=e.axes;return id({starts:t,ends:n,axes:r})}})),ib=Bh((function(){ww(),vw(),bw(),Mv=function(e){if(!e||1!==e.length)throw new Error("Softmax op requires 1 input.")},Lv=function(e,t){var n=e.dims,r=sd.size(n),i=t.axis;if(i<0&&(i=n.length+i),i<n.length-1)throw new Error("softmax only supports last axis for now.");var o=n[i],a=r/o,s=gd(o),u=o/s,c=_d("x",e.dataType,e.dims,s),l=Id("result",e.dataType,e.dims,s),h=c.type.value,f="f32"===dd(e.dataType)?"var threadMax = ".concat(h,"(-3.402823e+38f);"):"var threadMax = ".concat(h,"(-65504.0h);");return{name:"Softmax",shaderCache:{hint:"".concat(s),inputDependencies:["type"]},getRunData:function(){return{outputs:[{dims:n,dataType:e.dataType}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:u}]}},getShaderSource:function(e){return"\n      var<workgroup> rowMaxShared : ".concat(h,";\n      var<workgroup> rowSumShared : ").concat(h,";\n      var<workgroup> threadShared : array<").concat(h,", 64>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ").concat(h," {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ").concat(h,") {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ").concat(e.registerUniform("packedCols","i32").declareVariables(c,l),"\n      ").concat(e.mainStart(),"\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = 64;\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ").concat(f,"\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ").concat(h,"(").concat(function(e,t){return 4===t?"max(max(".concat(e,".x, ").concat(e,".y), max(").concat(e,".z, ").concat(e,".w))"):2===t?"max(".concat(e,".x, ").concat(e,".y)"):3===t?"max(max(".concat(e,".x, ").concat(e,".y), ").concat(e,".z)"):e}("threadShared[0]",s),");\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ").concat(h,"(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ").concat(h,"(").concat(wd("threadShared[0]",s),");\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }")}}},Fv=function(e,t){Mv(e.inputs),e.compute(Lv(e.inputs[0],t))},Nv=function(e){return id({axis:e.axis})}})),ob=Bh((function(){ww(),vw(),bw(),Uv=function(e){if(!e||e.length<1)throw new Error("too few inputs")},jv=function(e,t){var n=[],r=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach((function(e){return n.push(Number(e))})),r=n.length),id({numOutputs:r,axis:t.axis,splitSizes:n})},Gv=function(e){return"\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ".concat(e,"u; i += 1u ) {\n    if (index < ").concat(bd("uniforms.size_in_split_axis","i",e),") {\n        return i;\n    }\n    }\n    return ").concat(e,"u;\n}")},zv=function(e){for(var t=e.length,n=[],r=0;r<t;++r){var i=e[r].setByIndices("indices","input[global_idx]");1===t?n.push(i):0===r?n.push("if (output_number == ".concat(r,"u) { ").concat(i," }")):r===t-1?n.push("else { ".concat(i," }")):n.push("else if (output_number == ".concat(r,") { ").concat(i," }"))}return"\n      fn writeBufferData(output_number: u32, indices: ".concat(e[0].type.indices,", global_idx: u32) {\n        ").concat(n.join("\n"),"\n      }")},Hv=function(e,t){for(var n=e[0].dims,r=sd.size(n),i=e[0].dataType,o=sd.normalizeAxis(t.axis,n.length),a=new Array(t.numOutputs),s=_d("input",i,n),u=new Array(t.numOutputs),c=[],l=[],h=0,f=[{type:"uint32",data:r}],d=0;d<t.numOutputs;d++){h+=t.splitSizes[d],u[d]=h;var p=n.slice();p[t.axis]=t.splitSizes[d],l.push(p),a[d]=Id("output".concat(d),i,p),c.push({dims:l[d],dataType:e[0].dataType})}return f.push({type:"uint32",data:u}),f.push.apply(f,_toConsumableArray(yd(n))),l.forEach((function(e){return f.push.apply(f,_toConsumableArray(yd(e)))})),{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:function(e){var t;return"\n  ".concat((t=e.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",u.length)).declareVariables.apply(t,[s].concat(a)),"\n  ").concat(Gv(u.length),"\n  ").concat(zv(a),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size"),"\n\n    var indices = ").concat(s.offsetToIndices("global_idx"),";\n    var index = ").concat(s.indicesGet("indices",o),";\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ").concat(bd("uniforms.size_in_split_axis","output_number - 1u",u.length),";\n      ").concat(s.indicesSet("indices",o,"index"),";\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }")},getRunData:function(){return{outputs:c,dispatchGroup:{x:Math.ceil(r/64)},programUniforms:f}}}},Vv=function(e,t){Uv(e.inputs);var n=1===e.inputs.length?t:jv(e.inputs,t);e.compute(Hv(e.inputs,n),{inputs:[0]})},Wv=function(e){var t=e.axis,n=e.splitSizes,r=e.numOutputs<0?n.length:e.numOutputs;if(r!==n.length)throw new Error("numOutputs and splitSizes lengh must be equal");return id({axis:t,numOutputs:r,splitSizes:n})}})),ab=Bh((function(){fw(),ww(),bw(),$v=function(e){return Array.from(e.getBigInt64Array(),Number)},Yv=function(e){if(!e||2!==e.length)throw new Error("Tile requires 2 inputs.");if(1!==e[0].dataType&&6!==e[0].dataType&&12!==e[0].dataType)throw new Error("Tile only support float, int32, and uint32 data types");if(7!==e[1].dataType)throw new Error("Tile `repeats` input should be of int64 data type");if(1!==e[1].dims.length)throw new Error("Tile `repeats` input should be 1-D");if($v(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Kv=function(e,t){for(var n=[],r=0;r<e.length;++r)n.push(e[r]*t[r]);return n},Xv=function(e){var t=e[0].dims,n=$v(e[1]),r=Kv(t,n),i=sd.size(r),o=e[0].dataType,a=_d("input",o,t.length),s=Id("output",o,r.length);return{name:"Tile",shaderCache:{hint:"".concat(n),inputDependencies:["rank"]},getRunData:function(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i}].concat(_toConsumableArray(yd(e[0].dims)),_toConsumableArray(yd(r)))}},getShaderSource:function(e){return"\n      const inputShape = ".concat(a.indices.apply(a,_toConsumableArray(t)),";\n      ").concat(e.registerUniform("output_size","u32").declareVariables(a,s),"\n      ").concat(e.mainStart(),"\n      ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n      let output_indices = ").concat(s.offsetToIndices("global_idx"),";\n      var input_indices: ").concat(a.type.indices,";\n      for (var i = 0; i < ").concat(t.length,"; i++) {\n        let input_dim_i = ").concat(a.indicesGet("uniforms.input_shape","i"),";\n        let input_dim_value = ").concat(s.indicesGet("output_indices","i"),"  % input_dim_i;\n\n        ").concat(a.indicesSet("input_indices","i","input_dim_value"),"\n      }\n      ").concat(s.setByOffset("global_idx",a.getByIndices("input_indices")),"\n    }")}}},Zv=function(e){Yv(e.inputs),e.compute(Xv(e.inputs),{inputs:[0]})}})),sb=Bh((function(){fw(),ww(),bw(),qv=function(e,t,n,r,i){var o,a=Id("output_data",i,n.length,4),s=_d("a_data",t[1].dataType,t[1].dims.length,4),u=_d("b_data",t[2].dataType,t[2].dims.length,4),c=_d("c_data",t[0].dataType,t[0].dims.length,4),l=function(e,t,n){return"select(".concat(t,", ").concat(e,", ").concat(n,")")};if(r){var h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="a_data[index_a".concat(t,"][component_a").concat(t,"]"),i="b_data[index_b".concat(t,"][component_b").concat(t,"]"),o="bool(c_data[index_c".concat(t,"] & ").concat(4278190080>>>8*(3-t),"u)");return"\n            let output_indices".concat(t," = ").concat(a.offsetToIndices("global_idx * 4u + ".concat(t,"u")),";\n            let offset_a").concat(t," = ").concat(s.broadcastedIndicesToOffset("output_indices".concat(t),a),";\n            let offset_b").concat(t," = ").concat(u.broadcastedIndicesToOffset("output_indices".concat(t),a),";\n            let offset_c").concat(t," = ").concat(c.broadcastedIndicesToOffset("output_indices".concat(t),a),";\n            let index_a").concat(t," = offset_a").concat(t," / 4u;\n            let index_b").concat(t," = offset_b").concat(t," / 4u;\n            let index_c").concat(t," = offset_c").concat(t," / 4u;\n            let component_a").concat(t," = offset_a").concat(t," % 4u;\n            let component_b").concat(t," = offset_b").concat(t," % 4u;\n            ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(l(r,i,o),");\n          ")};o=9===i?"\n            var data = vec4<u32>(0);\n            ".concat(h("data",0,"u32"),"\n            ").concat(h("data",1,"u32"),"\n            ").concat(h("data",2,"u32"),"\n            ").concat(h("data",3,"u32"),"\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));"):"\n            ".concat(h("output_data[global_idx]",0),"\n            ").concat(h("output_data[global_idx]",1),"\n            ").concat(h("output_data[global_idx]",2),"\n            ").concat(h("output_data[global_idx]",3),"\n          ")}else o=a.setByOffset("global_idx",l(s.getByOffset("global_idx"),u.getByOffset("global_idx"),c.getByOffset("global_idx")));return"\n        ".concat(e.registerUniform("vec_size","u32").declareVariables(c,s,u,a),"\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n        ").concat(o,"\n      }")},Jv=function(e){var t=e[1].dims,n=e[2].dims,r=e[0].dims,i=e[1].dataType,o=!(sd.areEqual(t,n)&&sd.areEqual(n,r)),a=t,s=sd.size(t);if(o){var u=ad.calcShape(ad.calcShape(t,n,!1),r,!1);if(!u)throw new Error("Can't perform where op on the given tensors");a=u,s=sd.size(a)}var c=Math.ceil(s/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:function(t){return qv(t,e,a,o,i)},getRunData:function(){return{outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(s/64/4)},programUniforms:[{type:"uint32",data:c}].concat(_toConsumableArray(yd(r)),_toConsumableArray(yd(t)),_toConsumableArray(yd(n)),_toConsumableArray(yd(a)))}}}},Qv=function(e){e.compute(Jv(e.inputs))}})),ub=Bh((function(){Aw(),Cw(),kw(),Sw(),Ew(),Ow(),Pw(),Uw(),zw(),Hw(),Vw(),Ww(),$w(),Yw(),Kw(),Xw(),Zw(),Nw(),qw(),Jw(),Qw(),eb(),Iw(),tb(),nb(),rb(),ib(),ob(),ab(),xw(),Tw(),sb(),ew=new Map([["Abs",[Xp]],["Acos",[Zp]],["Acosh",[qp]],["Add",[My]],["ArgMax",[Pp,Rp]],["ArgMin",[Op,Rp]],["Asin",[Jp]],["Asinh",[Qp]],["Atan",[ey]],["Atanh",[ty]],["Attention",[Up]],["AveragePool",[$m,Wm]],["BatchNormalization",[Hp]],["BiasAdd",[$p]],["BiasSplitGelu",[Py]],["Cast",[ry,ny]],["Ceil",[ay]],["Clip",[oy]],["Concat",[Xy,Zy]],["Conv",[Ig,bg]],["ConvTranspose",[Fg,Rg]],["Cos",[sy]],["Cosh",[uy]],["CumSum",[Ug,jg]],["Div",[Ly]],["Einsum",[Xg,Zg]],["Elu",[ly,cy]],["Equal",[Fy]],["Erf",[fy]],["Exp",[dy]],["Expand",[tm]],["Floor",[py]],["FusedConv",[Ig,bg]],["Gather",[om,im]],["GatherElements",[cm,um]],["Gelu",[yy]],["Gemm",[dm,fm]],["GlobalAveragePool",[Xm,Km]],["GlobalMaxPool",[ev,Qm]],["Greater",[Gy]],["GreaterOrEqual",[Hy]],["InstanceNormalization",[mm]],["LayerNormalization",[bm]],["LeakyRelu",[gy,cy]],["Less",[zy]],["LessOrEqual",[Vy]],["Log",[Ty]],["MatMul",[yg]],["MaxPool",[qm,Jm]],["Mul",[Ny]],["MultiHeadAttention",[km,_m]],["Neg",[vy]],["Not",[my]],["Pad",[Mm]],["Pow",[Uy]],["Range",[rv]],["Reciprocal",[wy]],["ReduceMin",[Ap]],["ReduceMean",[wp]],["ReduceMax",[Ip]],["ReduceSum",[kp]],["ReduceProd",[Cp]],["ReduceL1",[bp]],["ReduceL2",[xp]],["ReduceLogSum",[Tp]],["ReduceLogSumExp",[_p]],["ReduceSumSquare",[Sp]],["Relu",[by]],["Resize",[xv,_v]],["Sigmoid",[xy]],["Sin",[_y]],["Sinh",[Iy]],["Slice",[Bv,Dv]],["SkipLayerNormalization",[Cv,kv]],["Split",[Vv,Wv]],["Sqrt",[Ay]],["Softmax",[Fv,Nv]],["Sub",[jy]],["Tan",[Cy]],["Tanh",[ky]],["ThresholdedRelu",[Sy,cy]],["Tile",[Zv]],["Transpose",[Dd,Md]],["Where",[Qv]]])})),cb=Bh((function(){ef(),pw(),bw(),tw=function(){function e(t){_classCallCheck(this,e),this.backend=t,this.repo=new Map,this.attributesBound=!1}return _createClass(e,[{key:"getArtifact",value:function(e){return this.repo.get(e)}},{key:"setArtifact",value:function(e,t){this.repo.set(e,t)}},{key:"run",value:function(e,t,n,r,i){mh(e.programInfo.name);var o=this.backend.device,a=this.backend.getComputePassEncoder();this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber),a.setPipeline(e.computePipeline);var s,u=[],c=_createForOfIteratorHelper(t);try{for(c.s();!(s=c.n()).done;){var l=s.value;u.push({binding:u.length,resource:{buffer:l.buffer}})}}catch(y){c.e(y)}finally{c.f()}var h,f=_createForOfIteratorHelper(n);try{for(f.s();!(h=f.n()).done;){var d=h.value;u.push({binding:u.length,resource:{buffer:d.buffer}})}}catch(y){f.e(y)}finally{f.f()}i&&u.push({binding:u.length,resource:i});var p=o.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:u,label:e.programInfo.name});a.setBindGroup(0,p),a.dispatchWorkgroups.apply(a,_toConsumableArray(r)),this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||"at-passes"===this.backend.queryType)&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),vh(e.programInfo.name)}},{key:"dispose",value:function(){}},{key:"build",value:function(e,t){mh(e.name);var n=this.backend.device,r=[];n.features.has("shader-f16")&&r.push("enable f16;");var i=kd(t),o=e.getShaderSource(i),a="".concat(r.join("\n"),"\n").concat(i.additionalImplementations,"\n").concat(o),s=n.createShaderModule({code:a,label:e.name});Xf("verbose",(function(){return"[WebGPU] ".concat(e.name," shader code: ").concat(a)}));var u=n.createComputePipeline({compute:{module:s,entryPoint:"main"},layout:"auto",label:e.name});return vh(e.name),{programInfo:e,computePipeline:u}}},{key:"normalizeDispatchGroupSize",value:function(e){var t="number"==typeof e?e:e.x,n="number"==typeof e?1:e.y||1,r="number"==typeof e?1:e.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=i&&n<=i&&r<=i)return[t,n,r];var o=t*n*r,a=Math.ceil(Math.sqrt(o));if(a>i){if((a=Math.ceil(Math.cbrt(o)))>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[a,a,a]}return[a,a,1]}}]),e}()})),lb=Bh((function(){ef(),fw(),pw(),yw(),mw(),ub(),cb(),nw=function(e,t){if(t.length!==e.length)throw new Error("inputDependencies length ".concat(t.length," is not equal to inputTensors length ").concat(e.length,"."));for(var n=[],r=0;r<e.length;++r){var i=e[r].dataType;switch(t[r]){case"none":n.push("");break;case"type":n.push("".concat(i));break;case"rank":var o=e[r].dims.length;n.push("".concat(i,";").concat(o));break;case"dims":var a=e[r].dims.join(",");n.push("".concat(i,";").concat(a));break;default:throw new Error("unsupported input dependency: ".concat(t[r]))}}return n.join("|")},rw=function(e,t,n){var r,i,o,a=e.name;return null!==(r=e.shaderCache)&&void 0!==r&&r.hint&&(a+="["+e.shaderCache.hint+"]"),a+=":"+n+":".concat(nw(t,null!==(i=null===(o=e.shaderCache)||void 0===o?void 0:o.inputDependencies)&&void 0!==i?i:new Array(t.length).fill("dims")))},iw=function(){function e(){_classCallCheck(this,e),this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionExternalDataMapping=new Map}return _createClass(e,[{key:"currentKernelCustomData",get:function(){if(null===this.currentKernelId)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");var e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}},{key:"initialize",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.env=t,r=[],i={requiredLimits:{maxComputeWorkgroupStorageSize:n.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:n.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:n.limits.maxStorageBufferBindingSize,maxBufferSize:n.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:n.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:n.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:n.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:n.limits.maxComputeWorkgroupSizeZ},requiredFeatures:r},n.features.has("chromium-experimental-timestamp-query-inside-passes")?r.push("chromium-experimental-timestamp-query-inside-passes"):n.features.has("timestamp-query")&&r.push("timestamp-query"),n.features.has("shader-f16")&&r.push("shader-f16"),e.next=6,n.requestDevice(i);case 6:this.device=e.sent,this.gpuDataManager=nd(this),this.programManager=new tw(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Yf(t.logLevel,!!t.debug),this.device.onuncapturederror=function(e){e.error instanceof GPUValidationError&&console.error("An uncaught WebGPU validation error was raised: ".concat(e.error.message))},Object.defineProperty(this.env.webgpu,"device",{value:this.device}),this.setQueryType();case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){_typeof(this.querySet)<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}},{key:"getCommandEncoder",value:function(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),"none"!==this.queryType&&_typeof(this.querySet)>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:2*this.maxDispatchNumber}),this.queryResolveBuffer=this.device.createBuffer({size:2*this.maxDispatchNumber*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder}},{key:"getComputePassEncoder",value:function(){if(!this.computePassEncoder){var e={};"at-passes"===this.queryType&&(e.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:2*this.pendingDispatchNumber,endOfPassWriteIndex:2*this.pendingDispatchNumber+1}),this.computePassEncoder=this.getCommandEncoder().beginComputePass(e)}return this.computePassEncoder}},{key:"endComputePass",value:function(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}},{key:"flush",value:function(){var e,t=this;this.commandEncoder&&(mh(),this.endComputePass(),"none"!==this.queryType&&(this.commandEncoder.resolveQuerySet(this.querySet,0,2*this.pendingDispatchNumber,this.queryResolveBuffer,0),e=this.device.createBuffer({size:2*this.pendingDispatchNumber*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,2*this.pendingDispatchNumber*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,"none"!==this.queryType&&e.mapAsync(GPUMapMode.READ).then((function(){for(var n=new BigUint64Array(e.getMappedRange()),r=t.pendingQueries.get(e),i=function(){var e,i=r[o],a=i.kernelId,s=t.kernels.get(a),u=s.kernelType,c=s.kernelName,l=i.programName,h=i.inputTensorViews,f=i.outputTensorViews,d=n[2*o],p=n[2*o+1];_typeof(t.queryTimeBase)>"u"&&(t.queryTimeBase=d);var y=Number(d-t.queryTimeBase),g=Number(p-t.queryTimeBase);if(!Number.isSafeInteger(y)||!Number.isSafeInteger(g))throw new RangeError("incorrect timestamp range");if(null!==(e=t.env.webgpu.profiling)&&void 0!==e&&e.ondata)t.env.webgpu.profiling.ondata({version:1,inputsMetadata:h.map((function(e){return{dims:e.dims,dataType:Lf(e.dataType)}})),outputsMetadata:f.map((function(e){return{dims:e.dims,dataType:Lf(e.dataType)}})),kernelId:a,kernelType:u,kernelName:c,programName:l,startTime:y,endTime:g});else{var m="";h.forEach((function(e,t){m+="input[".concat(t,"]: [").concat(e.dims,"] | ").concat(Lf(e.dataType),", ")}));var v="";f.forEach((function(e,t){v+="output[".concat(t,"]: [").concat(e.dims,"] | ").concat(Lf(e.dataType),", ")})),console.log('[profiling] kernel "'.concat(a,"|").concat(u,"|").concat(c,"|").concat(l,'" ').concat(m).concat(v,"execution time: ").concat(g-y," ns"))}yh("GPU","".concat(l,"::").concat(d,"::").concat(p))},o=0;o<n.length/2;o++)i();e.unmap(),t.pendingQueries.delete(e)})),vh())}},{key:"run",value:function(e,t,n,r,i){mh(e.name);for(var o=[],a=0;a<t.length;++a){var s=this.gpuDataManager.get(t[a].data);if(!s)throw new Error("no GPU data for input: ".concat(t[a].data));o[a]=s}var u=e.getRunData(t),c=u.outputs,l=u.dispatchGroup,h=u.programUniforms,f=0===n.length?c.map((function(e,t){return t})):n;if(f.length!==c.length)throw new Error("Output size ".concat(f.length," must be equal to ").concat(c.length,"."));for(var d,p=[],y=[],g=0;g<c.length;++g){if(!Number.isInteger(f[g])||f[g]<-3||f[g]>=c.length)throw new Error("Invalid output index: ".concat(f[g]));if(-3!==f[g]){var m=-1===f[g],v=-2===f[g],w=m||v?i(c[g].dataType,c[g].dims):r(f[g],c[g].dataType,c[g].dims),b=this.gpuDataManager.get(w.data);if(!b)throw new Error("no GPU data for output: ".concat(w.data));if(m&&this.temporaryData.push(b),v){var x=this.kernelPersistentData.get(this.currentKernelId);x||(x=[],this.kernelPersistentData.set(this.currentKernelId,x)),x.push(b)}p.push(w),y.push(b)}}if(h){var _=0,I=[];h.forEach((function(e){var t="number"==typeof e.data?[e.data]:e.data;if(0!==t.length){var n=t.length<=2?4*t.length:16;_=Math.ceil(_/n)*n,I.push(_),_+=t.length>4?16*Math.ceil(t.length/4):4*t.length}}));_=16*Math.ceil(_/16);var A=new ArrayBuffer(_);h.forEach((function(e,t){var n=I[t],r="number"==typeof e.data?[e.data]:e.data;"int32"===e.type?new Int32Array(A,n,r.length).set(r):"uint32"===e.type?new Uint32Array(A,n,r.length).set(r):new Float32Array(A,n,r.length).set(r)}));var C=this.gpuDataManager.create(_,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(C.buffer,0,A,0,_),this.gpuDataManager.release(C.id),d={offset:0,size:_,buffer:C.buffer}}var k=this.programManager.normalizeDispatchGroupSize(l),S=1===k[1]&&1===k[2],T=rw(e,t,S),E=this.programManager.getArtifact(T);if(E||(E=this.programManager.build(e,k),this.programManager.setArtifact(T,E),Xf("info",(function(){return"[artifact] key: ".concat(T,", programName: ").concat(e.name)}))),Xf("info",(function(){return'[ProgramManager] run "'.concat(e.name,'" (key=').concat(T,") with ").concat(k[0],"x").concat(k[1],"x").concat(k[2])})),"none"!==this.queryType){var O={kernelId:this.currentKernelId,programName:E.programInfo.name,inputTensorViews:t,outputTensorViews:p};this.pendingKernels.push(O)}return this.programManager.run(E,o,y,k,d),vh(e.name),p}},{key:"upload",value:function(e,t){this.gpuDataManager.upload(e,t)}},{key:"memcpy",value:function(e,t){this.gpuDataManager.memcpy(e,t)}},{key:"download",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gpuDataManager.download(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"alloc",value:function(e){return this.gpuDataManager.create(e).id}},{key:"free",value:function(e){return this.gpuDataManager.release(e)}},{key:"createKernel",value:function(e,t,n,r){var i=ew.get(e);if(!i)throw new Error("kernel not implemented: ".concat(e));var o={kernelType:e,kernelName:r,kernelEntry:i[0],attributes:[i[1],n]};this.kernels.set(t,o)}},{key:"releaseKernel",value:function(e){var t=this.kernelPersistentData.get(e);if(t){var n,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.gpuDataManager.release(i.id)}}catch(o){r.e(o)}finally{r.f()}this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}},{key:"computeKernel",value:function(e,t,n){var r=this.kernels.get(e);if(!r)throw new Error("kernel not created: ".concat(e));var i=r.kernelType,o=r.kernelName,a=r.kernelEntry,s=r.attributes;if(null!==this.currentKernelId)throw new Error('kernel "['.concat(i,"] ").concat(o,'" is not allowed to be called recursively'));this.currentKernelId=e,s[0]&&(s[1]=s[0](s[1]),s[0]=void 0),Xf("info",(function(){return'[WebGPU] Start to run kernel "['.concat(i,"] ").concat(o,'"...')}));var u=this.env.debug;this.temporaryData=[];try{return u&&this.device.pushErrorScope("validation"),a(t,s[1]),0}catch(e){return n.push(Promise.resolve('[WebGPU] Kernel "['.concat(i,"] ").concat(o,'" failed. ').concat(e))),1}finally{u&&n.push(this.device.popErrorScope().then((function(e){return e?'GPU validation error for kernel "['.concat(i,"] ").concat(o,'": ').concat(e.message):null})));var c,l=_createForOfIteratorHelper(this.temporaryData);try{for(l.s();!(c=l.n()).done;){var h=c.value;this.gpuDataManager.release(h.id)}}catch(f){l.e(f)}finally{l.f()}this.temporaryData=[],this.currentKernelId=null}}},{key:"registerBuffer",value:function(e,t,n,r){var i=this.sessionExternalDataMapping.get(e);i||(i=new Map,this.sessionExternalDataMapping.set(e,i));var o=i.get(t),a=this.gpuDataManager.registerExternalBuffer(n,r,null===o||void 0===o?void 0:o[1]);return i.set(t,[a,n]),a}},{key:"unregisterBuffers",value:function(e){var t=this,n=this.sessionExternalDataMapping.get(e);n&&(n.forEach((function(e){return t.gpuDataManager.unregisterExternalBuffer(e[1])})),this.sessionExternalDataMapping.delete(e))}},{key:"getBuffer",value:function(e){var t=this.gpuDataManager.get(e);if(!t)throw new Error("no GPU data for buffer: ".concat(e));return t.buffer}},{key:"createDownloader",value:function(e,t,n){var r=this;return _asyncToGenerator(_regeneratorRuntime().mark((function i(){var o;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,ed(r,e,t);case 2:return o=i.sent,i.abrupt("return",Zf(o.buffer,n));case 4:case"end":return i.stop()}}),i)})))}},{key:"writeTimestamp",value:function(e){"inside-passes"===this.queryType&&this.computePassEncoder.writeTimestamp(this.querySet,e)}},{key:"setQueryType",value:function(){var e;this.queryType="none",("default"===(null===(e=this.env.webgpu.profiling)||void 0===e?void 0:e.mode)||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"))}}]),e}()})),hb={};Mh(hb,{init:function(){return pb}});var fb,db,pb,yb,gb,mb,vb,wb,bb,xb,_b,Ib,Ab,Cb,kb,Sb,Tb,Eb,Ob,Pb,Rb,Bb,Db,Mb,Lb,Fb,Nb,Ub,jb,Gb,zb,Hb,Vb,Wb,$b,Yb,Kb,Xb,Zb,qb,Jb,Qb,ex=Bh((function(){fw(),lb(),pw(),ww(),fb=function(){function e(t,n,r,i){_classCallCheck(this,e),this.module=t,this.dataType=n,this.data=r,this.dims=i}return _createClass(e,[{key:"getFloat32Array",value:function(){if(1!==this.dataType)throw new Error("Invalid data type");var e=sd.size(this.dims);return 0===e?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}},{key:"getBigInt64Array",value:function(){if(7!==this.dataType)throw new Error("Invalid data type");var e=sd.size(this.dims);return 0===e?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}},{key:"getInt32Array",value:function(){if(6!==this.dataType)throw new Error("Invalid data type");var e=sd.size(this.dims);return 0===e?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}},{key:"reshape",value:function(t){if(sd.size(t)!==sd.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}}]),e}(),db=function(){function e(t,n,r){_classCallCheck(this,e),this.module=t,this.backend=n,this.customDataOffset=0,this.customDataSize=0;var i=t.HEAPU32,o=r>>>2;this.opKernelContext=i[o++];var a=i[o++];this.outputCount=i[o++],this.customDataOffset=i[o++],this.customDataSize=i[o++];for(var s=[],u=0;u<a;u++){for(var c=i[o++],l=i[o++],h=i[o++],f=[],d=0;d<h;d++)f.push(i[o++]);s.push(new fb(t,c,l,f))}this.inputs=s}return _createClass(e,[{key:"kernelCustomData",get:function(){return this.backend.currentKernelCustomData}},{key:"customDataBuffer",get:function(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}},{key:"compute",value:function(e,t){var n,r,i,o=this,a=null!==(n=null===t||void 0===t||null===(r=t.inputs)||void 0===r?void 0:r.map((function(e){return"number"==typeof e?o.inputs[e]:e})))&&void 0!==n?n:this.inputs,s=null!==(i=null===t||void 0===t?void 0:t.outputs)&&void 0!==i?i:[];return this.backend.run(e,a,s,(function(e,t,n){return new fb(o.module,t,o.output(e,n),n)}),(function(e,t){var n=Ff(e);if(!n)throw new Error("Unsupported data type: ".concat(e));var r=n*sd.size(t);return new fb(o.module,e,o.backend.gpuDataManager.create(r).id,t)}))}},{key:"output",value:function(e,t){var n=this.module.stackSave();try{var r=this.module.stackAlloc(4*(1+t.length)),i=r>>2;this.module.HEAPU32[i++]=t.length;for(var o=0;o<t.length;o++)this.module.HEAPU32[i++]=t[o];return this.module._JsepOutput(this.opKernelContext,e,r)}catch(n){throw new Error("Failed to generate kernel's output[".concat(e,"] with dims [").concat(t,"]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ").concat(n))}finally{this.module.stackRestore(n)}}}]),e}(),pb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.jsepInit){e.next=3;break}throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");case 3:return o=new iw,e.next=6,o.initialize(n,r);case 6:i(o,(function(e){return o.alloc(e)}),(function(e){return o.free(e)}),(function(e,n,r){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3])Xf("verbose",(function(){return"[WebGPU] jsepCopyGpuToGpu: src=".concat(e,", dst=").concat(n,", size=").concat(r)})),o.memcpy(e,n);else{Xf("verbose",(function(){return"[WebGPU] jsepCopyCpuToGpu: dataOffset=".concat(e,", gpuDataId=").concat(n,", size=").concat(r)}));var i=t.HEAPU8.subarray(e>>>0,(e>>>0)+r);o.upload(n,i)}}),function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,r,i){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xf("verbose",(function(){return"[WebGPU] jsepCopyGpuToCpu: gpuDataId=".concat(n,", dataOffset=").concat(r,", size=").concat(i)})),e.next=3,o.download(n,(function(){return t.HEAPU8.subarray(r>>>0,(r>>>0)+i)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),(function(e,n,r){return o.createKernel(e,n,r,t.UTF8ToString(t._JsepGetNodeName(n)))}),(function(e){return o.releaseKernel(e)}),(function(e,n,r,i){Xf("verbose",(function(){return"[WebGPU] jsepRun: sessionHandle=".concat(r,", kernel=").concat(e,", contextDataOffset=").concat(n)}));var a=new db(t,o,n);return o.computeKernel(e,a,i)}));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()})),tx=Bh((function(){lw(),hw(),fw(),uw(),cw(),dw(),yb=function(e,t){0!==Cf()._OrtInit(e,t)&&Tf("Can't initialize onnxruntime.")},gb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:yb(t.wasm.numThreads,Uf(t.logLevel));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("webgpu"!==n){e.next=13;break}if(!(("undefined"===typeof navigator?"undefined":_typeof(navigator))>"u")&&navigator.gpu){e.next=3;break}throw new Error("WebGPU is not supported in current environment");case 3:return e.next=5,navigator.gpu.requestAdapter();case 5:if(r=e.sent){e.next=8;break}throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.');case 8:if(t.wasm.simd){e.next=10;break}throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");case 10:return i=(ex(),Lh(hb)).init,e.next=13,i(Cf(),t,r);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),vb=new Map,wb=function(e){var t=Cf(),n=t.stackSave();try{var r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&Tf("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(n)}},bb=function(e){var t=Cf(),n=t._malloc(e.byteLength);if(0===n)throw new Error("Can't create a session. failed to allocate a buffer of size ".concat(e.byteLength,"."));return t.HEAPU8.set(e,n),[n,e.byteLength]},xb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o,a,s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_,I,A,C,k,S,T,E,O,P,R,B,D,M,L,F,N;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Cf(),Array.isArray(t)?(r=_slicedToArray(t,2),s=r[0],u=r[1]):t.buffer===c.HEAPU8.buffer?(i=[t.byteOffset,t.byteLength],s=i[0],u=i[1]):(o=bb(t),a=_slicedToArray(o,2),s=a[0],u=a[1]),l=0,h=0,f=0,d=[],p=[],y=[],e.prev=3,g=Df(n),m=_slicedToArray(g,2),h=m[0],d=m[1],null===n||void 0===n||!n.externalData||!c.mountExternalData){e.next=24;break}v=[],w=_createForOfIteratorHelper(n.externalData),e.prev=7,x=_regeneratorRuntime().mark((function e(){var t,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=b.value,n="string"==typeof t?t:t.path,v.push(zf("string"==typeof t?t:t.data).then((function(e){c.mountExternalData(n,e)})));case 3:case"end":return e.stop()}}),e)})),w.s();case 10:if((b=w.n()).done){e.next=14;break}return e.delegateYield(x(),"t0",12);case 12:e.next=10;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(7),w.e(e.t1);case 19:return e.prev=19,w.f(),e.finish(19);case 22:return e.next=24,Promise.all(v);case 24:for(0===(l=c._OrtCreateSession(s,u,h))&&Tf("Can't create a session."),_=wb(l),I=_slicedToArray(_,2),A=I[0],C=I[1],k=[],S=[],T=[],E=0;E<A;E++)0===(O=c._OrtGetInputName(l,E))&&Tf("Can't get an input name."),p.push(O),k.push(c.UTF8ToString(O));P=0;case 28:if(!(P<C)){e.next=40;break}if(0===(R=c._OrtGetOutputName(l,P))&&Tf("Can't get an output name."),y.push(R),B=c.UTF8ToString(R),S.push(B),"cpu"===(L="string"==typeof(null===n||void 0===n?void 0:n.preferredOutputLocation)?n.preferredOutputLocation:null!==(D=null===n||void 0===n||null===(M=n.preferredOutputLocation)||void 0===M?void 0:M[B])&&void 0!==D?D:"cpu")||"cpu-pinned"===L||"gpu-buffer"===L){e.next=36;break}throw new Error("Not supported preferred output location: ".concat(L,"."));case 36:T.push(L);case 37:P++,e.next=28;break;case 40:return F=null,e.abrupt("return",(T.some((function(e){return"gpu-buffer"===e}))&&(0===(f=c._OrtCreateBinding(l))&&Tf("Can't create IO binding."),F={handle:f,outputPreferredLocations:T,outputPreferredLocationsEncoded:T.map((function(e){return Gf(e)}))}),vb.set(l,[l,p,y,F]),[l,k,S]));case 44:throw e.prev=44,e.t2=e.catch(3),p.forEach((function(e){return c._OrtFree(e)})),y.forEach((function(e){return c._OrtFree(e)})),0!==f&&c._OrtReleaseBinding(f),0!==l&&c._OrtReleaseSession(l),e.t2;case 47:return e.prev=47,c._free(s),0!==h&&c._OrtReleaseSessionOptions(h),d.forEach((function(e){return c._free(e)})),null===(N=c.unmountExternalData)||void 0===N||N.call(c),e.finish(47);case 50:case"end":return e.stop()}}),e,null,[[3,44,47,50],[7,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}(),_b=function(e){var t,n=Cf(),r=vb.get(e);if(!r)throw new Error("cannot release session. invalid session id: ".concat(e));var i=_slicedToArray(r,4),o=i[0],a=i[1],s=i[2],u=i[3];u&&n._OrtReleaseBinding(u.handle),null!==(t=n.jsepUnregisterBuffers)&&void 0!==t&&t.call(n,e),a.forEach((function(e){return n._OrtFree(e)})),s.forEach((function(e){return n._OrtFree(e)})),n._OrtReleaseSession(o),vb.delete(e)},Ib=function(e,t,n,r,i){if(e){var o,a,s=Cf(),u=e[0],c=e[1],l=e[3];if("string"===u&&"gpu-buffer"===l)throw new Error("String tensor is not supported on GPU.");if("gpu-buffer"===l){var h=e[2].gpuBuffer,f=Ff(Mf(u));a=c.reduce((function(e,t){return e*t}),1)*f,o=s.jsepRegisterBuffer(r,i,h,a)}else{var d=e[2];if(Array.isArray(d)){a=4*d.length,o=s._malloc(a),n.push(o);for(var p=o/4,y=0;y<d.length;y++){if("string"!=typeof d[y])throw new TypeError("tensor data at index ".concat(y," is not a string"));s.HEAPU32[p++]=kf(d[y],n)}}else a=d.byteLength,o=s._malloc(a),n.push(o),s.HEAPU8.set(new Uint8Array(d.buffer,d.byteOffset,a),o)}var g=s.stackSave(),m=s.stackAlloc(4*c.length);try{var v=m/4;c.forEach((function(e){return s.HEAP32[v++]=e}));var w=s._OrtCreateTensor(Mf(u),o,a,m,c.length,Gf(l));0===w&&Tf("Can't create tensor for input/output. session=".concat(r,", index=").concat(i,".")),t.push(w)}finally{s.stackRestore(g)}}else t.push(0)},Ab=function(e){var t=(new TextEncoder).encode(e),n=Cf(),r=n._malloc(t.byteLength);n.HEAPU8.set(t,r);var i=n._OrtConfigure(r,t.byteLength);if(0===i)throw new Error("Can't get an configure key");var o=n.UTF8ToString(i);return n._OrtFree(i),o},Cb=function(e){var t=(new TextEncoder).encode(e),n=Cf(),r=n._malloc(t.byteLength);n.HEAPU8.set(t,r);var i=n._OrtAuth(r,t.byteLength);if(0===i)throw new Error("Can't get an auth result");var o=n.UTF8ToString(i);return n._OrtFree(i),o},kb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i,o,a){var s,u,c,l,h,f,d,p,y,g,m,v,w,b,x,_,I,A,C,k,S,T,E,O,P,R,B,D,M,L,F,N,U,j,G,z,H,V,W,$;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=Cf(),u=vb.get(t)){e.next=3;break}throw new Error("cannot run inference. invalid session id: ".concat(t));case 3:for(c=_slicedToArray(u,4),l=c[0],h=c[1],f=c[2],d=c[3],p=n.length,y=i.length,g=0,m=[],v=[],w=[],b=[],x=s.stackSave(),_=s.stackAlloc(4*p),I=s.stackAlloc(4*p),A=s.stackAlloc(4*y),C=s.stackAlloc(4*y),e.prev=4,k=Ef(a),S=_slicedToArray(k,2),g=S[0],m=S[1],T=0;T<p;T++)Ib(r[T],v,b,t,n[T]);for(E=0;E<y;E++)Ib(o[E],w,b,t,p+i[E]);for(O=_/4,P=I/4,R=A/4,B=C/4,D=0;D<p;D++)s.HEAPU32[O++]=v[D],s.HEAPU32[P++]=h[n[D]];for(M=0;M<y;M++)s.HEAPU32[R++]=w[M],s.HEAPU32[B++]=f[i[M]];if(!d){e.next=31;break}if(L=d.handle,F=d.outputPreferredLocations,N=d.outputPreferredLocationsEncoded,h.length===p){e.next=18;break}throw new Error("input count from feeds (".concat(p,") is expected to be always equal to model's input count (").concat(h.length,")."));case 18:U=0;case 19:if(!(U<p)){e.next=30;break}return j=n[U],e.next=23,s._OrtBindInput(L,h[j],v[U]);case 23:if(e.t0=e.sent,e.t1=0!==e.t0,!e.t1){e.next=27;break}Tf("Can't bind input[".concat(U,"] for session=").concat(t,"."));case 27:U++,e.next=19;break;case 30:for(G=0;G<y;G++)H=i[G],null!==(z=o[G])&&void 0!==z&&z[3]?0!==s._OrtBindOutput(L,f[H],w[G],0)&&Tf("Can't bind pre-allocated output[".concat(G,"] for session=").concat(t,".")):0!==s._OrtBindOutput(L,f[H],0,N[H])&&Tf("Can't bind output[".concat(G,"] to ").concat(F[G]," for session=").concat(t,"."));case 31:if(!d){e.next=37;break}return e.next=34,s._OrtRunWithBinding(l,d.handle,y,A,g);case 34:e.t2=e.sent,e.next=40;break;case 37:return e.next=39,s._OrtRun(l,I,_,p,C,y,A,g);case 39:e.t2=e.sent;case 40:0!==e.t2&&Tf("failed to call OrtRun()."),V=[],W=_regeneratorRuntime().mark((function e(){var t,n,r,a,u,c,l,h,f,p,y,g,m,v,b,x,_,I,C,k,S,T;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=s.HEAPU32[A/4+$])!==w[$]){e.next=4;break}return V.push(o[$]),e.abrupt("return",1);case 4:for(r=s.stackSave(),a=s.stackAlloc(16),u=!1,c=0,e.prev=5,0!==s._OrtGetTensorData(t,a,a+4,a+8,a+12)&&Tf("Can't access output tensor data on index ".concat($,".")),l=a/4,h=s.HEAPU32[l++],c=s.HEAPU32[l++],f=s.HEAPU32[l++],p=s.HEAPU32[l++],y=[],g=0;g<p;g++)y.push(s.HEAPU32[f/4+g]);if(s._OrtFree(f),m=y.reduce((function(e,t){return e*t}),1),n=Lf(h),v=null===d||void 0===d?void 0:d.outputPreferredLocations[i[$]],"string"!==n){e.next=23;break}if("gpu-buffer"!==v){e.next=18;break}throw new Error("String tensor is not supported on GPU.");case 18:for(b=[],x=c/4,_=0;_<m;_++)I=s.HEAPU32[x++],C=_===m-1?void 0:s.HEAPU32[x]-I,b.push(s.UTF8ToString(I,C));V.push([n,y,b,"cpu"]),e.next=32;break;case 23:if(!("gpu-buffer"===v&&m>0)){e.next=30;break}if(k=s.jsepGetBuffer(c),void 0!==(S=Ff(h))&&jf(n)){e.next=27;break}throw new Error("Unsupported data type: ".concat(n));case 27:u=!0,V.push([n,y,{gpuBuffer:k,download:s.jsepCreateDownloader(k,m*S,n),dispose:function(){s._OrtReleaseTensor(t)}},"gpu-buffer"]),e.next=32;break;case 30:T=new(Nf(n))(m),new Uint8Array(T.buffer,T.byteOffset,T.byteLength).set(s.HEAPU8.subarray(c,c+T.byteLength)),V.push([n,y,T,"cpu"]);case 32:return e.prev=32,s.stackRestore(r),"string"===n&&c&&s._free(c),u||s._OrtReleaseTensor(t),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[5,,32,35]])})),$=0;case 45:if(!($<y)){e.next=52;break}return e.delegateYield(W(),"t3",47);case 47:if(!e.t3){e.next=49;break}return e.abrupt("continue",49);case 49:$++,e.next=45;break;case 52:return e.abrupt("return",(d&&s._OrtClearBoundOutputs(d.handle),V));case 53:return e.prev=53,s.stackRestore(x),v.forEach((function(e){return s._OrtReleaseTensor(e)})),w.forEach((function(e){return s._OrtReleaseTensor(e)})),b.forEach((function(e){return s._free(e)})),0!==g&&s._OrtReleaseRunOptions(g),m.forEach((function(e){return s._free(e)})),e.finish(53);case 56:case"end":return e.stop()}}),e,null,[[4,,53,56]])})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}(),Sb=function(e){var t=Cf(),n=vb.get(e);if(!n)throw new Error("invalid session id");var r=n[0],i=t._OrtEndProfiling(r);0===i&&Tf("Can't get an profile file name."),t._OrtFree(i)},Tb=function(e){var t,n=[],r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var i=t.value[2];!Array.isArray(i)&&"buffer"in i&&n.push(i.buffer)}}catch(o){r.e(o)}finally{r.f()}return n}})),nx=Dh((function(e,t){t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var Cn=Object.defineProperty;var el=Object.getOwnPropertyDescriptor;var tl=Object.getOwnPropertyNames;var rl=Object.prototype.hasOwnProperty;var ko=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error(\'Dynamic require of "\'+e+\'" is not supported\')});var q=(e,t)=>()=>(e&&(t=e(e=0)),t);var wr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Gr=(e,t)=>{for(var r in t)Cn(e,r,{get:t[r],enumerable:!0})},nl=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of tl(t))!rl.call(e,n)&&n!==r&&Cn(e,n,{get:()=>t[n],enumerable:!(o=el(t,n))||o.enumerable});return e};var Jt=e=>nl(Cn({},"__esModule",{value:!0}),e);var In={};Gr(In,{createReadStream:()=>Bo,readFile:()=>ol,readFileSync:()=>al});var ol,al,Bo,An=q(()=>{ol=void 0,al=void 0,Bo=void 0});var Tn={};Gr(Tn,{join:()=>il});var il,En=q(()=>{il=void 0});var Mo=wr((Do,On)=>{"use strict";var Ro=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){var r=t,o,n;r.ready=new Promise((l,p)=>{o=l,n=p}),r.mountExternalData=(l,p)=>{(r.Ka||(r.Ka=new Map)).set(l,p)},r.unmountExternalData=()=>{delete r.Ka},r.jsepInit=(l,p,b,x,O,W,L,te)=>{r.gb=l,r.Wa=p,r.Ya=b,r.Qa=x,r.Xa=O,r.Ba=W,r.Za=L,r.$a=te,p=(ee,ue,le)=>(...ve)=>{let Ie=Je,k=ue?.();ve=ee(...ve);let de=ue?.();return k!==de&&(ee=de,le(k),ue=le=null),Je!=Ie?kr():ve},b=ee=>async(...ue)=>{try{if(r.Ja)throw Error("Session already started");let le=r.Ja={ab:ue[0],errors:[]},ve=await ee(...ue);if(r.Ja!==le)throw Error("Session mismatch");l.flush();let Ie=le.errors;if(0<Ie.length){let k=await Promise.all(Ie);if(k=k.filter(de=>de),0<k.length)throw Error(k.join(`\n`))}return ve}finally{r.Ja=null}},r._OrtRun=b(p(r._OrtRun,()=>r._OrtRun,ee=>r._OrtRun=ee)),r._OrtRunWithBinding=b(p(r._OrtRunWithBinding,()=>r._OrtRunWithBinding,ee=>r._OrtRunWithBinding=ee)),r._OrtBindInput=p(r._OrtBindInput,()=>r._OrtBindInput,ee=>r._OrtBindInput=ee),r.jsepRegisterBuffer=(ee,ue,le,ve)=>l.registerBuffer(ee,ue,le,ve),r.jsepUnregisterBuffers=ee=>{l.unregisterBuffers(ee)},r.jsepGetBuffer=ee=>l.getBuffer(ee),r.jsepCreateDownloader=(ee,ue,le)=>l.createDownloader(ee,ue,le)};var s=Object.assign({},r),u="./this.program",d=(l,p)=>{throw p},a=typeof window=="object",m=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g="",w,v,y;if(h){var C=(An(),Jt(In)),I=(En(),Jt(Tn));g=m?I.dirname(g)+"/":__dirname+"/",w=(l,p)=>(l=We(l)?new URL(l):I.normalize(l),C.readFileSync(l,p?void 0:"utf8")),y=l=>(l=w(l,!0),l.buffer||(l=new Uint8Array(l)),l),v=(l,p,b,x=!0)=>{l=We(l)?new URL(l):I.normalize(l),C.readFile(l,x?void 0:"utf8",(O,W)=>{O?b(O):p(x?W.buffer:W)})},!r.thisProgram&&1<process.argv.length&&(u=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),d=(l,p)=>{throw process.exitCode=l,p},r.inspect=()=>"[Emscripten Module object]"}else(a||m)&&(m?g=self.location.href:typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),e&&(g=e),g.indexOf("blob:")!==0?g=g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):g="",w=l=>{var p=new XMLHttpRequest;return p.open("GET",l,!1),p.send(null),p.responseText},m&&(y=l=>{var p=new XMLHttpRequest;return p.open("GET",l,!1),p.responseType="arraybuffer",p.send(null),new Uint8Array(p.response)}),v=(l,p,b)=>{var x=new XMLHttpRequest;x.open("GET",l,!0),x.responseType="arraybuffer",x.onload=()=>{x.status==200||x.status==0&&x.response?p(x.response):b()},x.onerror=b,x.send(null)});var S=console.log.bind(console),_=console.error.bind(console);Object.assign(r,s),s=null,typeof WebAssembly!="object"&&he("no native wasm support detected");var P,A=!1,z,R,N,T,H,ie,Z;function K(){var l=P.buffer;r.HEAP8=R=new Int8Array(l),r.HEAP16=new Int16Array(l),r.HEAPU8=N=new Uint8Array(l),r.HEAPU16=new Uint16Array(l),r.HEAP32=T=new Int32Array(l),r.HEAPU32=H=new Uint32Array(l),r.HEAPF32=ie=new Float32Array(l),r.HEAPF64=Z=new Float64Array(l)}var Q=[],X=[],Ee=[],Pe=0,fe=null,Ce=null;function he(l){throw l="Aborted("+l+")",_(l),A=!0,z=1,l=new WebAssembly.RuntimeError(l+". Build with -sASSERTIONS for more info."),n(l),l}var ye=l=>l.startsWith("data:application/octet-stream;base64,"),We=l=>l.startsWith("file://"),Me;if(Me="ort-wasm-simd.wasm",!ye(Me)){var Ge=Me;Me=r.locateFile?r.locateFile(Ge,g):g+Ge}function G(l){if(y)return y(l);throw"both async and sync fetching of the wasm failed"}function re(l){if(a||m){if(typeof fetch=="function"&&!We(l))return fetch(l,{credentials:"same-origin"}).then(p=>{if(!p.ok)throw"failed to load wasm binary file at \'"+l+"\'";return p.arrayBuffer()}).catch(()=>G(l));if(v)return new Promise((p,b)=>{v(l,x=>p(new Uint8Array(x)),b)})}return Promise.resolve().then(()=>G(l))}function be(l,p,b){return re(l).then(x=>WebAssembly.instantiate(x,p)).then(x=>x).then(b,x=>{_(`failed to asynchronously prepare wasm: ${x}`),he(x)})}function rt(l,p){var b=Me;return typeof WebAssembly.instantiateStreaming!="function"||ye(b)||We(b)||h||typeof fetch!="function"?be(b,l,p):fetch(b,{credentials:"same-origin"}).then(x=>WebAssembly.instantiateStreaming(x,l).then(p,function(O){return _(`wasm streaming compile failed: ${O}`),_("falling back to ArrayBuffer instantiation"),be(b,l,p)}))}var ze,Ve={898080:(l,p,b,x)=>{if(typeof r>"u"||!r.Ka)return 1;if(l=qe(l>>>0),l.startsWith("./")&&(l=l.substring(2)),l=r.Ka.get(l),!l)return 2;if(p>>>=0,b>>>=0,p+b>l.byteLength)return 3;try{return N.set(l.subarray(p,p+b),x>>>0>>>0),0}catch{return 4}},898581:l=>r.Wa(l),898614:l=>r.Ya(l),898646:(l,p,b)=>{r.Qa(l,p,b,!0)},898685:(l,p,b)=>{r.Qa(l,p,b)},898718:l=>{r.Ba("Abs",l,void 0)},898769:l=>{r.Ba("Neg",l,void 0)},898820:l=>{r.Ba("Floor",l,void 0)},898873:l=>{r.Ba("Ceil",l,void 0)},898925:l=>{r.Ba("Reciprocal",l,void 0)},898983:l=>{r.Ba("Sqrt",l,void 0)},899035:l=>{r.Ba("Exp",l,void 0)},899086:l=>{r.Ba("Erf",l,void 0)},899137:l=>{r.Ba("Sigmoid",l,void 0)},899192:l=>{r.Ba("Log",l,void 0)},899243:l=>{r.Ba("Sin",l,void 0)},899294:l=>{r.Ba("Cos",l,void 0)},899345:l=>{r.Ba("Tan",l,void 0)},899396:l=>{r.Ba("Asin",l,void 0)},899448:l=>{r.Ba("Acos",l,void 0)},899500:l=>{r.Ba("Atan",l,void 0)},899552:l=>{r.Ba("Sinh",l,void 0)},899604:l=>{r.Ba("Cosh",l,void 0)},899656:l=>{r.Ba("Asinh",l,void 0)},899709:l=>{r.Ba("Acosh",l,void 0)},899762:l=>{r.Ba("Atanh",l,void 0)},899815:l=>{r.Ba("Tanh",l,void 0)},899867:l=>{r.Ba("Not",l,void 0)},899918:(l,p,b)=>{r.Ba("Clip",l,{min:p,max:b})},899987:l=>{r.Ba("Clip",l,void 0)},900039:(l,p)=>{r.Ba("Elu",l,{alpha:p})},900097:l=>{r.Ba("Relu",l,void 0)},900149:(l,p)=>{r.Ba("LeakyRelu",l,{alpha:p})},900213:(l,p)=>{r.Ba("ThresholdedRelu",l,{alpha:p})},900283:(l,p)=>{r.Ba("Cast",l,{to:p})},900341:l=>{r.Ba("Add",l,void 0)},900392:l=>{r.Ba("Sub",l,void 0)},900443:l=>{r.Ba("Mul",l,void 0)},900494:l=>{r.Ba("Div",l,void 0)},900545:l=>{r.Ba("Pow",l,void 0)},900596:l=>{r.Ba("Equal",l,void 0)},900649:l=>{r.Ba("Greater",l,void 0)},900704:l=>{r.Ba("GreaterOrEqual",l,void 0)},900766:l=>{r.Ba("Less",l,void 0)},900818:l=>{r.Ba("LessOrEqual",l,void 0)},900877:(l,p,b,x,O)=>{r.Ba("ReduceMean",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901036:(l,p,b,x,O)=>{r.Ba("ReduceMax",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901194:(l,p,b,x,O)=>{r.Ba("ReduceMin",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901352:(l,p,b,x,O)=>{r.Ba("ReduceProd",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901511:(l,p,b,x,O)=>{r.Ba("ReduceSum",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901669:(l,p,b,x,O)=>{r.Ba("ReduceL1",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901826:(l,p,b,x,O)=>{r.Ba("ReduceL2",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901983:(l,p,b,x,O)=>{r.Ba("ReduceLogSum",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902144:(l,p,b,x,O)=>{r.Ba("ReduceSumSquare",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902308:(l,p,b,x,O)=>{r.Ba("ReduceLogSumExp",l,{keepDims:!!p,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902472:l=>{r.Ba("Where",l,void 0)},902525:(l,p,b)=>{r.Ba("Transpose",l,{perm:p?Array.from(T.subarray(p>>>0,b>>>0)):[]})},902633:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de)=>{r.Ba("ConvTranspose",l,{format:ee?"NHWC":"NCHW",autoPad:p,dilations:[b],group:x,kernel_shape:[O],pads:[W,L],strides:[te],wIsConst:()=>!!R[ue>>>0],outputPadding:le?Array.from(T.subarray(le>>>0,ve>>>0)):[],outputShape:Ie?Array.from(T.subarray(Ie>>>0,k>>>0)):[],activation:qe(de)})},903035:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k)=>{r.Ba("ConvTranspose",l,{format:te?"NHWC":"NCHW",autoPad:p,dilations:Array.from(T.subarray(b>>>0,(b>>>0)+2>>>0)),group:x,kernelShape:Array.from(T.subarray(O>>>0,(O>>>0)+2>>>0)),pads:Array.from(T.subarray(W>>>0,(W>>>0)+4>>>0)),strides:Array.from(T.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!R[ee>>>0],outputPadding:ue?Array.from(T.subarray(ue>>>0,le>>>0)):[],outputShape:ve?Array.from(T.subarray(ve>>>0,Ie>>>0)):[],activation:qe(k)})},903600:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de)=>{r.Ba("ConvTranspose",l,{format:ee?"NHWC":"NCHW",autoPad:p,dilations:[b],group:x,kernel_shape:[O],pads:[W,L],strides:[te],wIsConst:()=>!!R[ue>>>0],outputPadding:le?Array.from(T.subarray(le>>>0,ve>>>0)):[],outputShape:Ie?Array.from(T.subarray(Ie>>>0,k>>>0)):[],activation:qe(de)})},904002:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k)=>{r.Ba("ConvTranspose",l,{format:te?"NHWC":"NCHW",autoPad:p,dilations:Array.from(T.subarray(b>>>0,(b>>>0)+2>>>0)),group:x,kernelShape:Array.from(T.subarray(O>>>0,(O>>>0)+2>>>0)),pads:Array.from(T.subarray(W>>>0,(W>>>0)+4>>>0)),strides:Array.from(T.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!R[ee>>>0],outputPadding:ue?Array.from(T.subarray(ue>>>0,le>>>0)):[],outputShape:ve?Array.from(T.subarray(ve>>>0,Ie>>>0)):[],activation:qe(k)})},904567:(l,p)=>{r.Ba("GlobalAveragePool",l,{format:p?"NHWC":"NCHW"})},904658:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("AveragePool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},904942:(l,p)=>{r.Ba("GlobalAveragePool",l,{format:p?"NHWC":"NCHW"})},905033:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("AveragePool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},905317:(l,p)=>{r.Ba("GlobalMaxPool",l,{format:p?"NHWC":"NCHW"})},905404:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("MaxPool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},905684:(l,p)=>{r.Ba("GlobalMaxPool",l,{format:p?"NHWC":"NCHW"})},905771:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("MaxPool",l,{format:Se?"NHWC":"NCHW",auto_pad:p,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[W,L],kernel_shape:[te,ee],pads:[ue,le,ve,Ie],strides:[k,de]})},906051:(l,p,b,x,O)=>{r.Ba("Gemm",l,{alpha:p,beta:b,transA:x,transB:O})},906155:l=>{r.Ba("MatMul",l,void 0)},906209:(l,p,b,x)=>{r.Ba("ArgMax",l,{keepDims:!!p,selectLastIndex:!!b,axis:x})},906317:(l,p,b,x)=>{r.Ba("ArgMin",l,{keepDims:!!p,selectLastIndex:!!b,axis:x})},906425:(l,p)=>{r.Ba("Softmax",l,{axis:p})},906488:(l,p)=>{r.Ba("Concat",l,{axis:p})},906548:(l,p,b,x,O)=>{r.Ba("Split",l,{axis:p,numOutputs:b,splitSizes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},906688:l=>{r.Ba("Expand",l,void 0)},906742:(l,p)=>{r.Ba("Gather",l,{axis:Number(p)})},906813:(l,p)=>{r.Ba("GatherElements",l,{axis:Number(p)})},906892:(l,p,b,x,O,W,L,te,ee,ue,le)=>{r.Ba("Resize",l,{antialias:p,axes:b?Array.from(T.subarray(b>>>0,x>>>0)):[],coordinateTransformMode:qe(O),cubicCoeffA:W,excludeOutside:L,extrapolationValue:te,keepAspectRatioPolicy:qe(ee),mode:qe(ue),nearestMode:qe(le)})},907238:(l,p,b,x,O,W,L)=>{r.Ba("Slice",l,{starts:p?Array.from(T.subarray(p>>>0,b>>>0)):[],ends:x?Array.from(T.subarray(x>>>0,O>>>0)):[],axes:W?Array.from(T.subarray(W>>>0,L>>>0)):[]})},907454:l=>{r.Ba("Tile",l,void 0)},907506:(l,p,b)=>{r.Ba("LayerNormalization",l,{axis:Number(p),epsilon:Number(b)})},907613:(l,p,b)=>{r.Ba("InstanceNormalization",l,{epsilon:p,format:b?"NHWC":"NCHW"})},907727:(l,p,b)=>{r.Ba("InstanceNormalization",l,{epsilon:p,format:b?"NHWC":"NCHW"})},907841:l=>{r.Ba("Range",l,void 0)},907894:(l,p)=>{r.Ba("Einsum",l,{equation:qe(p)})},907975:(l,p,b,x,O)=>{r.Ba("Pad",l,{mode:p,value:b,pads:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},908102:(l,p,b,x,O,W)=>{r.Ba("BatchNormalization",l,{epsilon:p,momentum:b,spatial:!!O,trainingMode:!!x,format:W?"NHWC":"NCHW"})},908271:(l,p,b,x,O,W)=>{r.Ba("BatchNormalization",l,{epsilon:p,momentum:b,spatial:!!O,trainingMode:!!x,format:W?"NHWC":"NCHW"})},908440:(l,p,b)=>{r.Ba("CumSum",l,{exclusive:Number(p),reverse:Number(b)})},908537:(l,p,b,x,O,W,L,te,ee)=>{r.Ba("Attention",l,{numHeads:p,isUnidirectional:b,maskFilterValue:x,scale:O,doRotary:W,qkvHiddenSizes:L?Array.from(T.subarray(Number(te)>>>0,Number(te)+L>>>0)):[],pastPresentShareBuffer:!!ee})},908809:l=>{r.Ba("Gelu",l,void 0)},908861:(l,p,b,x,O,W)=>{r.Ba("MultiHeadAttention",l,{numHeads:p,isUnidirectional:b,maskFilterValue:x,scale:O,doRotary:W})},909020:l=>{r.Ba("BiasAdd",l,void 0)},909075:l=>{r.Ba("BiasSplitGelu",l,void 0)},909136:(l,p)=>{r.Ba("SkipLayerNormalization",l,{epsilon:p})},909217:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie)=>{r.Ba("Conv",l,{format:ee?"NHWC":"NCHW",auto_pad:p,dilations:[b],group:x,kernel_shape:[O],pads:W?Array.from(T.subarray(W>>>0,L>>>0)):[],strides:[te],w_is_const:()=>!!R[ue>>>0],activation:qe(le),activation_params:ve?Array.from(ie.subarray(ve>>>0,Ie>>>0)):[]})},909587:(l,p,b,x,O,W,L,te,ee,ue,le,ve,Ie,k,de,Se)=>{r.Ba("Conv",l,{format:ve?"NHWC":"NCHW",auto_pad:p,dilations:[b,x],group:O,kernel_shape:[W,L],pads:te?Array.from(T.subarray(te>>>0,ee>>>0)):[],strides:[ue,le],w_is_const:()=>!!R[Ie>>>0],activation:qe(k),activation_params:de?Array.from(ie.subarray(de>>>0,Se>>>0)):[]})},909978:l=>{r.Za(l)},910012:(l,p)=>r.$a(l,p,r.Ja.ab,r.Ja.errors)};function Ue(l){this.name="ExitStatus",this.message=`Program terminated with exit(${l})`,this.status=l}function St(l){this.Na=l-24,this.Ua=function(p){H[this.Na+4>>>2>>>0]=p},this.Ta=function(p){H[this.Na+8>>>2>>>0]=p},this.Ra=function(p,b){this.Sa(),this.Ua(p),this.Ta(b)},this.Sa=function(){H[this.Na+16>>>2>>>0]=0}}var nt=0,zt=0,Tt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,xt=(l,p,b)=>{p>>>=0;var x=p+b;for(b=p;l[b]&&!(b>=x);)++b;if(16<b-p&&l.buffer&&Tt)return Tt.decode(l.subarray(p,b));for(x="";p<b;){var O=l[p++];if(O&128){var W=l[p++]&63;if((O&224)==192)x+=String.fromCharCode((O&31)<<6|W);else{var L=l[p++]&63;O=(O&240)==224?(O&15)<<12|W<<6|L:(O&7)<<18|W<<12|L<<6|l[p++]&63,65536>O?x+=String.fromCharCode(O):(O-=65536,x+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else x+=String.fromCharCode(O)}return x},qe=(l,p)=>(l>>>=0)?xt(N,l,p):"",rr=l=>{for(var p=0,b=0;b<l.length;++b){var x=l.charCodeAt(b);127>=x?p++:2047>=x?p+=2:55296<=x&&57343>=x?(p+=4,++b):p+=3}return p},Vt=(l,p,b,x)=>{if(b>>>=0,!(0<x))return 0;var O=b;x=b+x-1;for(var W=0;W<l.length;++W){var L=l.charCodeAt(W);if(55296<=L&&57343>=L){var te=l.charCodeAt(++W);L=65536+((L&1023)<<10)|te&1023}if(127>=L){if(b>=x)break;p[b++>>>0]=L}else{if(2047>=L){if(b+1>=x)break;p[b++>>>0]=192|L>>6}else{if(65535>=L){if(b+2>=x)break;p[b++>>>0]=224|L>>12}else{if(b+3>=x)break;p[b++>>>0]=240|L>>18,p[b++>>>0]=128|L>>12&63}p[b++>>>0]=128|L>>6&63}p[b++>>>0]=128|L&63}}return p[b>>>0]=0,b-O},_t=l=>l%4===0&&(l%100!==0||l%400===0),yt=[0,31,60,91,121,152,182,213,244,274,305,335],Nt=[0,31,59,90,120,151,181,212,243,273,304,334],Wt=l=>{var p=rr(l)+1,b=jt(p);return b&&Vt(l,N,b,p),b},Et=[],nr=(l,p)=>{Et.length=0;for(var b;b=N[l++>>>0];){var x=b!=105;x&=b!=112,p+=x&&p%8?4:0,Et.push(b==112?H[p>>>2>>>0]:b==105?T[p>>>2>>>0]:Z[p>>>3>>>0]),p+=x?8:4}return Et},ot={},or=()=>{if(!Ht){var l={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"},p;for(p in ot)ot[p]===void 0?delete l[p]:l[p]=ot[p];var b=[];for(p in l)b.push(`${p}=${l[p]}`);Ht=b}return Ht},Ht,Ye=[null,[],[]],yn=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return b=>crypto.getRandomValues(b);if(h)try{var l=ko("crypto");if(l.randomFillSync)return b=>l.randomFillSync(b);var p=l.randomBytes;return b=>(b.set(p(b.byteLength)),b)}catch{}he("initRandomDevice")},Oe=l=>(Oe=yn())(l),ar=[31,29,31,30,31,30,31,31,30,31,30,31],Gt=[31,28,31,30,31,30,31,31,30,31,30,31];function ir(l){var p=Array(rr(l)+1);return Vt(l,p,0,p.length),p}function Tr(l,p,b,x){function O(k,de,Se){for(k=typeof k=="number"?k.toString():k||"";k.length<de;)k=Se[0]+k;return k}function W(k,de){return O(k,de,"0")}function L(k,de){function Se(Ur){return 0>Ur?-1:0<Ur?1:0}var $t;return($t=Se(k.getFullYear()-de.getFullYear()))===0&&($t=Se(k.getMonth()-de.getMonth()))===0&&($t=Se(k.getDate()-de.getDate())),$t}function te(k){switch(k.getDay()){case 0:return new Date(k.getFullYear()-1,11,29);case 1:return k;case 2:return new Date(k.getFullYear(),0,3);case 3:return new Date(k.getFullYear(),0,2);case 4:return new Date(k.getFullYear(),0,1);case 5:return new Date(k.getFullYear()-1,11,31);case 6:return new Date(k.getFullYear()-1,11,30)}}function ee(k){var de=k.Ha;for(k=new Date(new Date(k.Ia+1900,0,1).getTime());0<de;){var Se=k.getMonth(),$t=(_t(k.getFullYear())?ar:Gt)[Se];if(de>$t-k.getDate())de-=$t-k.getDate()+1,k.setDate(1),11>Se?k.setMonth(Se+1):(k.setMonth(0),k.setFullYear(k.getFullYear()+1));else{k.setDate(k.getDate()+de);break}}return Se=new Date(k.getFullYear()+1,0,4),de=te(new Date(k.getFullYear(),0,4)),Se=te(Se),0>=L(de,k)?0>=L(Se,k)?k.getFullYear()+1:k.getFullYear():k.getFullYear()-1}l>>>=0,p>>>=0,b>>>=0,x>>>=0;var ue=H[x+40>>>2>>>0];x={eb:T[x>>>2>>>0],cb:T[x+4>>>2>>>0],La:T[x+8>>>2>>>0],Pa:T[x+12>>>2>>>0],Ma:T[x+16>>>2>>>0],Ia:T[x+20>>>2>>>0],Ga:T[x+24>>>2>>>0],Ha:T[x+28>>>2>>>0],hb:T[x+32>>>2>>>0],bb:T[x+36>>>2>>>0],fb:ue?qe(ue):""},b=qe(b),ue={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var le in ue)b=b.replace(new RegExp(le,"g"),ue[le]);var ve="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ie="January February March April May June July August September October November December".split(" ");ue={"%a":k=>ve[k.Ga].substring(0,3),"%A":k=>ve[k.Ga],"%b":k=>Ie[k.Ma].substring(0,3),"%B":k=>Ie[k.Ma],"%C":k=>W((k.Ia+1900)/100|0,2),"%d":k=>W(k.Pa,2),"%e":k=>O(k.Pa,2," "),"%g":k=>ee(k).toString().substring(2),"%G":k=>ee(k),"%H":k=>W(k.La,2),"%I":k=>(k=k.La,k==0?k=12:12<k&&(k-=12),W(k,2)),"%j":k=>{for(var de=0,Se=0;Se<=k.Ma-1;de+=(_t(k.Ia+1900)?ar:Gt)[Se++]);return W(k.Pa+de,3)},"%m":k=>W(k.Ma+1,2),"%M":k=>W(k.cb,2),"%n":()=>`\n`,"%p":k=>0<=k.La&&12>k.La?"AM":"PM","%S":k=>W(k.eb,2),"%t":()=>"\t","%u":k=>k.Ga||7,"%U":k=>W(Math.floor((k.Ha+7-k.Ga)/7),2),"%V":k=>{var de=Math.floor((k.Ha+7-(k.Ga+6)%7)/7);if(2>=(k.Ga+371-k.Ha-2)%7&&de++,de)de==53&&(Se=(k.Ga+371-k.Ha)%7,Se==4||Se==3&&_t(k.Ia)||(de=1));else{de=52;var Se=(k.Ga+7-k.Ha-1)%7;(Se==4||Se==5&&_t(k.Ia%400-1))&&de++}return W(de,2)},"%w":k=>k.Ga,"%W":k=>W(Math.floor((k.Ha+7-(k.Ga+6)%7)/7),2),"%y":k=>(k.Ia+1900).toString().substring(2),"%Y":k=>k.Ia+1900,"%z":k=>{k=k.bb;var de=0<=k;return k=Math.abs(k)/60,(de?"+":"-")+("0000"+(k/60*100+k%60)).slice(-4)},"%Z":k=>k.fb,"%%":()=>"%"},b=b.replace(/%%/g,"\\0\\0");for(le in ue)b.includes(le)&&(b=b.replace(new RegExp(le,"g"),ue[le](x)));return b=b.replace(/\\0\\0/g,"%"),le=ir(b),le.length>p?0:(R.set(le,l>>>0),le.length-1)}var Ot=l=>{try{l()}catch(p){he(p)}};function bn(){var l=oe,p={};for(let[b,x]of Object.entries(l))p[b]=typeof x=="function"?function(){Lt.push(b);try{return x.apply(null,arguments)}finally{A||(Lt.pop(),Je&&ne===1&&Lt.length===0&&(ne=0,Ot(vt),typeof Fibers<"u"&&Fibers.ib()))}}:x;return p}var ne=0,Je=null,sr=0,Lt=[],ur={},Er={},Or=0,Ft=null,Pr=[];function kr(){return new Promise((l,p)=>{Ft={resolve:l,reject:p}})}function lr(){var l=jt(65548),p=l+12;H[l>>>2>>>0]=p,H[l+4>>>2>>>0]=p+65536,p=Lt[0];var b=ur[p];return b===void 0&&(b=Or++,ur[p]=b,Er[b]=p),T[l+8>>>2>>>0]=b,l}function Br(l){if(!A){if(ne===0){var p=!1,b=!1;l((x=0)=>{if(!A&&(sr=x,p=!0,b)){ne=2,Ot(()=>gr(Je)),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),x=!1;try{var O=(0,oe[Er[T[Je+8>>>2>>>0]]])()}catch(te){O=te,x=!0}var W=!1;if(!Je){var L=Ft;L&&(Ft=null,(x?L.reject:L.resolve)(O),W=!0)}if(x&&!W)throw O}}),b=!0,p||(ne=1,Je=lr(),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),Ot(()=>Kt(Je)))}else ne===2?(ne=0,Ot(yr),mr(Je),Je=null,Pr.forEach(x=>{if(!A)try{x();try{z=z=x=z,r.onExit?.(x),A=!0,d(x,new Ue(x))}catch(O){O instanceof Ue||O=="unwind"||d(1,O)}}catch(O){O instanceof Ue||O=="unwind"||d(1,O)}})):he(`invalid state: ${ne}`);return sr}}function Rr(l){return Br(p=>{l().then(p)})}var bt=[],Xe,wt,dr=[],cr=(l,p)=>{if(!wt){wt=new WeakMap;var b=Xe.length;if(wt)for(var x=0;x<0+b;x++){var O=x,W=bt[O];W||(O>=bt.length&&(bt.length=O+1),bt[O]=W=Xe.get(O)),(O=W)&&wt.set(O,x)}}if(b=wt.get(l)||0)return b;if(dr.length)b=dr.pop();else{try{Xe.grow(1)}catch(te){throw te instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":te}b=Xe.length-1}try{x=b,Xe.set(x,l),bt[x]=Xe.get(x)}catch(te){if(!(te instanceof TypeError))throw te;if(typeof WebAssembly.Function=="function"){x=WebAssembly.Function,O={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},W={parameters:[],results:p[0]=="v"?[]:[O[p[0]]]};for(var L=1;L<p.length;++L)W.parameters.push(O[p[L]]);p=new x(W,l)}else{for(x=[1],O=p.slice(0,1),p=p.slice(1),W={i:127,p:127,j:126,f:125,d:124,e:111},x.push(96),L=p.length,128>L?x.push(L):x.push(L%128|128,L>>7),L=0;L<p.length;++L)x.push(W[p[L]]);O=="v"?x.push(0):x.push(1,W[O]),p=[0,97,115,109,1,0,0,0,1],O=x.length,128>O?p.push(O):p.push(O%128|128,O>>7),p.push.apply(p,x),p.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),p=new WebAssembly.Module(new Uint8Array(p)),p=new WebAssembly.Instance(p,{e:{f:l}}).exports.f}x=b,Xe.set(x,p),bt[x]=Xe.get(x)}return wt.set(l,b),b},Dr={n:function(l,p,b){return Rr(async()=>{await r.Xa(l,p,b)})},a:function(l,p,b){throw l>>>=0,new St(l).Ra(p>>>0,b>>>0),nt=l,zt++,nt},g:function(){return 0},M:function(){},C:function(){},E:function(){},v:function(){return 0},K:function(){},F:function(){},J:function(){},m:function(){},D:function(){},A:function(){},L:function(){},B:function(){},N:()=>1,q:function(l,p,b){l=p+2097152>>>0<4194305-!!l?(l>>>0)+4294967296*p:NaN,b>>>=0,l=new Date(1e3*l),T[b>>>2>>>0]=l.getUTCSeconds(),T[b+4>>>2>>>0]=l.getUTCMinutes(),T[b+8>>>2>>>0]=l.getUTCHours(),T[b+12>>>2>>>0]=l.getUTCDate(),T[b+16>>>2>>>0]=l.getUTCMonth(),T[b+20>>>2>>>0]=l.getUTCFullYear()-1900,T[b+24>>>2>>>0]=l.getUTCDay(),T[b+28>>>2>>>0]=(l.getTime()-Date.UTC(l.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},r:function(l,p,b){l=p+2097152>>>0<4194305-!!l?(l>>>0)+4294967296*p:NaN,b>>>=0,l=new Date(1e3*l),T[b>>>2>>>0]=l.getSeconds(),T[b+4>>>2>>>0]=l.getMinutes(),T[b+8>>>2>>>0]=l.getHours(),T[b+12>>>2>>>0]=l.getDate(),T[b+16>>>2>>>0]=l.getMonth(),T[b+20>>>2>>>0]=l.getFullYear()-1900,T[b+24>>>2>>>0]=l.getDay(),T[b+28>>>2>>>0]=(_t(l.getFullYear())?yt:Nt)[l.getMonth()]+l.getDate()-1|0,T[b+36>>>2>>>0]=-(60*l.getTimezoneOffset()),p=new Date(l.getFullYear(),6,1).getTimezoneOffset();var x=new Date(l.getFullYear(),0,1).getTimezoneOffset();T[b+32>>>2>>>0]=(p!=x&&l.getTimezoneOffset()==Math.min(x,p))|0},s:function(l){l>>>=0;var p=new Date(T[l+20>>>2>>>0]+1900,T[l+16>>>2>>>0],T[l+12>>>2>>>0],T[l+8>>>2>>>0],T[l+4>>>2>>>0],T[l>>>2>>>0],0),b=T[l+32>>>2>>>0],x=p.getTimezoneOffset(),O=new Date(p.getFullYear(),6,1).getTimezoneOffset(),W=new Date(p.getFullYear(),0,1).getTimezoneOffset(),L=Math.min(W,O);return 0>b?T[l+32>>>2>>>0]=+(O!=W&&L==x):0<b!=(L==x)&&(O=Math.max(W,O),p.setTime(p.getTime()+6e4*((0<b?L:O)-x))),T[l+24>>>2>>>0]=p.getDay(),T[l+28>>>2>>>0]=(_t(p.getFullYear())?yt:Nt)[p.getMonth()]+p.getDate()-1|0,T[l>>>2>>>0]=p.getSeconds(),T[l+4>>>2>>>0]=p.getMinutes(),T[l+8>>>2>>>0]=p.getHours(),T[l+12>>>2>>>0]=p.getDate(),T[l+16>>>2>>>0]=p.getMonth(),T[l+20>>>2>>>0]=p.getYear(),l=p.getTime(),isNaN(l)?(T[pr()>>>2>>>0]=61,l=-1):l/=1e3,fr((ze=l,1<=+Math.abs(ze)?0<ze?+Math.floor(ze/4294967296)>>>0:~~+Math.ceil((ze-+(~~ze>>>0))/4294967296)>>>0:0)),l>>>0},o:function(){return-52},p:function(){},y:function(l,p,b){function x(ee){return(ee=ee.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ee[1]:"GMT"}b>>>=0;var O=new Date().getFullYear(),W=new Date(O,0,1),L=new Date(O,6,1);O=W.getTimezoneOffset();var te=L.getTimezoneOffset();H[l>>>0>>>2>>>0]=60*Math.max(O,te),T[p>>>0>>>2>>>0]=+(O!=te),l=x(W),p=x(L),l=Wt(l),p=Wt(p),te<O?(H[b>>>2>>>0]=l,H[b+4>>>2>>>0]=p):(H[b>>>2>>>0]=p,H[b+4>>>2>>>0]=l)},e:()=>{he("")},b:function(l,p,b){return l>>>=0,p=nr(p>>>0,b>>>0),Ve[l].apply(null,p)},j:function(l,p,b){return l>>>=0,p=nr(p>>>0,b>>>0),Ve[l].apply(null,p)},h:()=>Date.now(),z:function(){return 4294901760},c:()=>performance.now(),I:function(l,p,b){return p>>>=0,N.copyWithin(l>>>0>>>0,p>>>0,p+(b>>>0)>>>0)},w:function(l){l>>>=0;var p=N.length;if(4294901760<l)return!1;for(var b=1;4>=b;b*=2){var x=p*(1+.2/b);x=Math.min(x,l+100663296);var O=Math;x=Math.max(l,x);e:{O=(O.min.call(O,4294901760,x+(65536-x%65536)%65536)-P.buffer.byteLength+65535)/65536;try{P.grow(O),K();var W=1;break e}catch{}W=void 0}if(W)return!0}return!1},G:function(l,p){l>>>=0,p>>>=0;var b=0;return or().forEach((x,O)=>{var W=p+b;for(O=H[l+4*O>>>2>>>0]=W,W=0;W<x.length;++W)R[O++>>>0>>>0]=x.charCodeAt(W);R[O>>>0>>>0]=0,b+=x.length+1}),0},H:function(l,p){l>>>=0,p>>>=0;var b=or();H[l>>>2>>>0]=b.length;var x=0;return b.forEach(O=>x+=O.length+1),H[p>>>2>>>0]=x,0},f:()=>52,l:function(){return 52},t:function(){return 70},k:function(l,p,b,x){p>>>=0,b>>>=0,x>>>=0;for(var O=0,W=0;W<b;W++){var L=H[p>>>2>>>0],te=H[p+4>>>2>>>0];p+=8;for(var ee=0;ee<te;ee++){var ue=N[L+ee>>>0],le=Ye[l];ue===0||ue===10?((l===1?S:_)(xt(le,0)),le.length=0):le.push(ue)}O+=te}return H[x>>>2>>>0]=O,0},u:function(l,p){return l>>>=0,Oe(N.subarray(l>>>0,l+(p>>>0)>>>0)),0},x:Tr,d:function(l,p,b,x){return Tr(l>>>0,p>>>0,b>>>0,x>>>0)},i:function(l,p,b,x){let O=Xe.length;l=new Uint8Array(N.slice(l+p,l+b));try{var W=new WebAssembly.Module(l),L=new WebAssembly.Instance(W,{env:{memory:P}}),te;for(te in L.exports)cr(L.exports[te]);return O<Xe.length?O:x}catch(ee){return console.log(ee),x}}},oe=function(){function l(b){return oe=b.exports,oe=bn(),oe=Mr(),P=oe.O,K(),Xe=oe.wa,X.unshift(oe.P),Pe--,Pe==0&&(fe!==null&&(clearInterval(fe),fe=null),Ce&&(b=Ce,Ce=null,b())),oe}var p={a:Dr};if(Pe++,r.instantiateWasm)try{return r.instantiateWasm(p,l)}catch(b){_(`Module.instantiateWasm callback failed with error: ${b}`),n(b)}return rt(p,function(b){l(b.instance)}).catch(n),{}}();r._OrtInit=(l,p)=>(r._OrtInit=oe.Q)(l,p),r._OrtGetLastError=(l,p)=>(r._OrtGetLastError=oe.R)(l,p),r._OrtCreateSessionOptions=(l,p,b,x,O,W,L,te,ee,ue)=>(r._OrtCreateSessionOptions=oe.S)(l,p,b,x,O,W,L,te,ee,ue),r._OrtAppendExecutionProvider=(l,p)=>(r._OrtAppendExecutionProvider=oe.T)(l,p),r._OrtAddFreeDimensionOverride=(l,p,b)=>(r._OrtAddFreeDimensionOverride=oe.U)(l,p,b),r._OrtAddSessionConfigEntry=(l,p,b)=>(r._OrtAddSessionConfigEntry=oe.V)(l,p,b),r._OrtReleaseSessionOptions=l=>(r._OrtReleaseSessionOptions=oe.W)(l),r._OrtCreateSession=(l,p,b)=>(r._OrtCreateSession=oe.X)(l,p,b),r._OrtReleaseSession=l=>(r._OrtReleaseSession=oe.Y)(l),r._OrtGetInputOutputCount=(l,p,b)=>(r._OrtGetInputOutputCount=oe.Z)(l,p,b),r._OrtGetInputName=(l,p)=>(r._OrtGetInputName=oe._)(l,p),r._OrtGetOutputName=(l,p)=>(r._OrtGetOutputName=oe.$)(l,p),r._OrtFree=l=>(r._OrtFree=oe.aa)(l),r._OrtCreateTensor=(l,p,b,x,O,W)=>(r._OrtCreateTensor=oe.ba)(l,p,b,x,O,W),r._OrtGetTensorData=(l,p,b,x,O)=>(r._OrtGetTensorData=oe.ca)(l,p,b,x,O),r._OrtReleaseTensor=l=>(r._OrtReleaseTensor=oe.da)(l),r._OrtCreateRunOptions=(l,p,b,x)=>(r._OrtCreateRunOptions=oe.ea)(l,p,b,x),r._OrtAddRunConfigEntry=(l,p,b)=>(r._OrtAddRunConfigEntry=oe.fa)(l,p,b),r._OrtReleaseRunOptions=l=>(r._OrtReleaseRunOptions=oe.ga)(l),r._OrtCreateBinding=l=>(r._OrtCreateBinding=oe.ha)(l),r._OrtBindInput=(l,p,b)=>(r._OrtBindInput=oe.ia)(l,p,b),r._OrtBindOutput=(l,p,b,x)=>(r._OrtBindOutput=oe.ja)(l,p,b,x),r._OrtClearBoundOutputs=l=>(r._OrtClearBoundOutputs=oe.ka)(l),r._OrtReleaseBinding=l=>(r._OrtReleaseBinding=oe.la)(l),r._OrtRunWithBinding=(l,p,b,x,O)=>(r._OrtRunWithBinding=oe.ma)(l,p,b,x,O),r._OrtRun=(l,p,b,x,O,W,L,te)=>(r._OrtRun=oe.na)(l,p,b,x,O,W,L,te),r._OrtEndProfiling=l=>(r._OrtEndProfiling=oe.oa)(l),r._OrtConfigure=(l,p)=>(r._OrtConfigure=oe.pa)(l,p),r._OrtAuth=(l,p)=>(r._OrtAuth=oe.qa)(l,p),r._JsepOutput=(l,p,b)=>(r._JsepOutput=oe.ra)(l,p,b),r._JsepGetNodeName=l=>(r._JsepGetNodeName=oe.sa)(l);var pr=()=>(pr=oe.ta)(),jt=r._malloc=l=>(jt=r._malloc=oe.ua)(l),mr=r._free=l=>(mr=r._free=oe.va)(l),fr=l=>(fr=oe.xa)(l),hr=()=>(hr=oe.ya)(),qt=l=>(qt=oe.za)(l),Pt=l=>(Pt=oe.Aa)(l),Kt=l=>(Kt=oe.Ca)(l),vt=()=>(vt=oe.Da)(),gr=l=>(gr=oe.Ea)(l),yr=()=>(yr=oe.Fa)();r.___start_em_js=910124,r.___stop_em_js=910897;function Mr(){var l=oe;l=Object.assign({},l);var p=x=>()=>x()>>>0,b=x=>O=>x(O)>>>0;return l.ta=p(l.ta),l.ua=b(l.ua),l.ya=p(l.ya),l.Aa=b(l.Aa),l}r.stackAlloc=Pt,r.stackSave=hr,r.stackRestore=qt,r.addFunction=cr,r.UTF8ToString=qe,r.stringToUTF8=(l,p,b)=>Vt(l,N,p,b),r.lengthBytesUTF8=rr;var kt;Ce=function l(){kt||br(),kt||(Ce=l)};function br(){if(!(0<Pe)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;){var l=r.preRun.shift();Q.unshift(l)}for(;0<Q.length;)Q.shift()(r);if(!(0<Pe||kt||(kt=!0,r.calledRun=!0,A))){for(;0<X.length;)X.shift()(r);for(o(r);0<Ee.length;)Ee.shift()(r)}}}return br(),t.ready}})();typeof Do=="object"&&typeof On=="object"?On.exports=Ro:typeof define=="function"&&define.amd&&define([],()=>Ro)});var Uo=wr(()=>{});var zo=wr(()=>{});var Vo={};Gr(Vo,{cpus:()=>sl});var sl,No=q(()=>{sl=void 0});var Go=wr((Ho,Pn)=>{"use strict";var Wo=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){function r(){return Q.buffer!=fe.buffer&&Ge(),fe}function o(){return Q.buffer!=fe.buffer&&Ge(),Ce}function n(){return Q.buffer!=fe.buffer&&Ge(),he}function s(){return Q.buffer!=fe.buffer&&Ge(),ye}function u(){return Q.buffer!=fe.buffer&&Ge(),We}function d(){return Q.buffer!=fe.buffer&&Ge(),Me}var a=t,m,h;a.ready=new Promise((i,c)=>{m=i,h=c}),a.mountExternalData=(i,c)=>{(a.ib||(a.ib=new Map)).set(i,c)},a.unmountExternalData=()=>{delete a.ib},a.jsepInit=(i,c,f,$,E,D,U,J)=>{a.Rb=i,a.Bb=c,a.Db=f,a.pb=$,a.Cb=E,a.Ua=D,a.Eb=U,a.Fb=J,c=(ae,se,pe)=>(...xe)=>{let Te=ut,B=se?.();xe=ae(...xe);let me=se?.();return B!==me&&(ae=me,pe(B),se=pe=null),ut!=Te?ju():xe},f=ae=>async(...se)=>{try{if(a.hb)throw Error("Session already started");let pe=a.hb={Hb:se[0],errors:[]},xe=await ae(...se);if(a.hb!==pe)throw Error("Session mismatch");i.flush();let Te=pe.errors;if(0<Te.length){let B=await Promise.all(Te);if(B=B.filter(me=>me),0<B.length)throw Error(B.join(`\n`))}return xe}finally{a.hb=null}},a._OrtRun=f(c(a._OrtRun,()=>a._OrtRun,ae=>a._OrtRun=ae)),a._OrtRunWithBinding=f(c(a._OrtRunWithBinding,()=>a._OrtRunWithBinding,ae=>a._OrtRunWithBinding=ae)),a._OrtBindInput=c(a._OrtBindInput,()=>a._OrtBindInput,ae=>a._OrtBindInput=ae),a.jsepRegisterBuffer=(ae,se,pe,xe)=>i.registerBuffer(ae,se,pe,xe),a.jsepUnregisterBuffers=ae=>{i.unregisterBuffers(ae)},a.jsepGetBuffer=ae=>i.getBuffer(ae),a.jsepCreateDownloader=(ae,se,pe)=>i.createDownloader(ae,se,pe)};var g=Object.assign({},a),w="./this.program",v=(i,c)=>{throw c},y=typeof window=="object",C=typeof importScripts=="function",I=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",S=a.ENVIRONMENT_IS_PTHREAD||!1,_="";function P(i){return a.locateFile?a.locateFile(i,_):_+i}var A,z,R;if(I){var N=(An(),Jt(In)),T=(En(),Jt(Tn));_=C?T.dirname(_)+"/":__dirname+"/",A=(c,f)=>(c=Tt(c)?new URL(c):T.normalize(c),N.readFileSync(c,f?void 0:"utf8")),R=c=>(c=A(c,!0),c.buffer||(c=new Uint8Array(c)),c),z=(c,f,$,E=!0)=>{c=Tt(c)?new URL(c):T.normalize(c),N.readFile(c,E?void 0:"utf8",(D,U)=>{D?$(D):f(E?U.buffer:U)})},!a.thisProgram&&1<process.argv.length&&(w=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),v=(c,f)=>{throw process.exitCode=c,f},a.inspect=()=>"[Emscripten Module object]";let i;try{i=Uo()}catch(c){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),c}global.Worker=i.Worker}else(y||C)&&(C?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),typeof e<"u"&&e&&(_=e),_.indexOf("blob:")!==0?_=_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1):_="",I||(A=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.send(null),c.responseText},C&&(R=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.responseType="arraybuffer",c.send(null),new Uint8Array(c.response)}),z=(i,c,f)=>{var $=new XMLHttpRequest;$.open("GET",i,!0),$.responseType="arraybuffer",$.onload=()=>{$.status==200||$.status==0&&$.response?c($.response):f()},$.onerror=f,$.send(null)}));I&&typeof performance>"u"&&(global.performance=zo().performance);var H=console.log.bind(console),ie=console.error.bind(console);I&&(H=(...i)=>N.writeSync(1,i.join(" ")+`\n`),ie=(...i)=>N.writeSync(2,i.join(" ")+`\n`));var Z=H,K=ie;Object.assign(a,g),g=null,typeof WebAssembly!="object"&&nt("no native wasm support detected");var Q,X,Ee=!1,Pe,fe,Ce,he,ye,We,Me;function Ge(){var i=Q.buffer;a.HEAP8=fe=new Int8Array(i),a.HEAP16=new Int16Array(i),a.HEAPU8=Ce=new Uint8Array(i),a.HEAPU16=new Uint16Array(i),a.HEAP32=he=new Int32Array(i),a.HEAPU32=ye=new Uint32Array(i),a.HEAPF32=We=new Float32Array(i),a.HEAPF64=Me=new Float64Array(i)}var G=16777216;if(S)Q=a.wasmMemory;else if(a.wasmMemory)Q=a.wasmMemory;else if(Q=new WebAssembly.Memory({initial:G/65536,maximum:65536,shared:!0}),!(Q.buffer instanceof SharedArrayBuffer))throw K("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),I&&K("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ge(),G=Q.buffer.byteLength;var re=[],be=[],rt=[],ze=0,Ve=null,Ue=null;function St(){if(ze--,ze==0&&(Ve!==null&&(clearInterval(Ve),Ve=null),Ue)){var i=Ue;Ue=null,i()}}function nt(i){throw i="Aborted("+i+")",K(i),Ee=!0,Pe=1,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),h(i),i}var zt=i=>i.startsWith("data:application/octet-stream;base64,"),Tt=i=>i.startsWith("file://"),xt;xt="ort-wasm-simd-threaded.wasm",zt(xt)||(xt=P(xt));function qe(i){if(R)return R(i);throw"both async and sync fetching of the wasm failed"}function rr(i){if(y||C){if(typeof fetch=="function"&&!Tt(i))return fetch(i,{credentials:"same-origin"}).then(c=>{if(!c.ok)throw"failed to load wasm binary file at \'"+i+"\'";return c.arrayBuffer()}).catch(()=>qe(i));if(z)return new Promise((c,f)=>{z(i,$=>c(new Uint8Array($)),f)})}return Promise.resolve().then(()=>qe(i))}function Vt(i,c,f){return rr(i).then($=>WebAssembly.instantiate($,c)).then($=>$).then(f,$=>{K(`failed to asynchronously prepare wasm: ${$}`),nt($)})}function _t(i,c){var f=xt;return typeof WebAssembly.instantiateStreaming!="function"||zt(f)||Tt(f)||I||typeof fetch!="function"?Vt(f,i,c):fetch(f,{credentials:"same-origin"}).then($=>WebAssembly.instantiateStreaming($,i).then(c,function(E){return K(`wasm streaming compile failed: ${E}`),K("falling back to ArrayBuffer instantiation"),Vt(f,i,c)}))}var yt,Nt={902596:(i,c,f,$)=>{if(typeof a>"u"||!a.ib)return 1;if(i=Ye(i>>>0),i.startsWith("./")&&(i=i.substring(2)),i=a.ib.get(i),!i)return 2;if(c>>>=0,f>>>=0,$>>>=0,c+f>i.byteLength)return 3;try{return o().set(i.subarray(c,c+f),$>>>0),0}catch{return 4}},903097:i=>a.Bb(i),903130:i=>a.Db(i),903162:(i,c,f)=>{a.pb(i,c,f,!0)},903201:(i,c,f)=>{a.pb(i,c,f)},903234:i=>{a.Ua("Abs",i,void 0)},903285:i=>{a.Ua("Neg",i,void 0)},903336:i=>{a.Ua("Floor",i,void 0)},903389:i=>{a.Ua("Ceil",i,void 0)},903441:i=>{a.Ua("Reciprocal",i,void 0)},903499:i=>{a.Ua("Sqrt",i,void 0)},903551:i=>{a.Ua("Exp",i,void 0)},903602:i=>{a.Ua("Erf",i,void 0)},903653:i=>{a.Ua("Sigmoid",i,void 0)},903708:i=>{a.Ua("Log",i,void 0)},903759:i=>{a.Ua("Sin",i,void 0)},903810:i=>{a.Ua("Cos",i,void 0)},903861:i=>{a.Ua("Tan",i,void 0)},903912:i=>{a.Ua("Asin",i,void 0)},903964:i=>{a.Ua("Acos",i,void 0)},904016:i=>{a.Ua("Atan",i,void 0)},904068:i=>{a.Ua("Sinh",i,void 0)},904120:i=>{a.Ua("Cosh",i,void 0)},904172:i=>{a.Ua("Asinh",i,void 0)},904225:i=>{a.Ua("Acosh",i,void 0)},904278:i=>{a.Ua("Atanh",i,void 0)},904331:i=>{a.Ua("Tanh",i,void 0)},904383:i=>{a.Ua("Not",i,void 0)},904434:(i,c,f)=>{a.Ua("Clip",i,{min:c,max:f})},904503:i=>{a.Ua("Clip",i,void 0)},904555:(i,c)=>{a.Ua("Elu",i,{alpha:c})},904613:i=>{a.Ua("Relu",i,void 0)},904665:(i,c)=>{a.Ua("LeakyRelu",i,{alpha:c})},904729:(i,c)=>{a.Ua("ThresholdedRelu",i,{alpha:c})},904799:(i,c)=>{a.Ua("Cast",i,{to:c})},904857:i=>{a.Ua("Add",i,void 0)},904908:i=>{a.Ua("Sub",i,void 0)},904959:i=>{a.Ua("Mul",i,void 0)},905010:i=>{a.Ua("Div",i,void 0)},905061:i=>{a.Ua("Pow",i,void 0)},905112:i=>{a.Ua("Equal",i,void 0)},905165:i=>{a.Ua("Greater",i,void 0)},905220:i=>{a.Ua("GreaterOrEqual",i,void 0)},905282:i=>{a.Ua("Less",i,void 0)},905334:i=>{a.Ua("LessOrEqual",i,void 0)},905393:(i,c,f,$,E)=>{a.Ua("ReduceMean",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905552:(i,c,f,$,E)=>{a.Ua("ReduceMax",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905710:(i,c,f,$,E)=>{a.Ua("ReduceMin",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905868:(i,c,f,$,E)=>{a.Ua("ReduceProd",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906027:(i,c,f,$,E)=>{a.Ua("ReduceSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906185:(i,c,f,$,E)=>{a.Ua("ReduceL1",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906342:(i,c,f,$,E)=>{a.Ua("ReduceL2",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906499:(i,c,f,$,E)=>{a.Ua("ReduceLogSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906660:(i,c,f,$,E)=>{a.Ua("ReduceSumSquare",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906824:(i,c,f,$,E)=>{a.Ua("ReduceLogSumExp",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906988:i=>{a.Ua("Where",i,void 0)},907041:(i,c,f)=>{a.Ua("Transpose",i,{perm:c?Array.from(n().subarray(c>>>0,f>>>0)):[]})},907149:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me)=>{a.Ua("ConvTranspose",i,{format:ae?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[E],pads:[D,U],strides:[J],wIsConst:()=>!!r()[se>>>0],outputPadding:pe?Array.from(n().subarray(pe>>>0,xe>>>0)):[],outputShape:Te?Array.from(n().subarray(Te>>>0,B>>>0)):[],activation:Ye(me)})},907551:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B)=>{a.Ua("ConvTranspose",i,{format:J?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(E>>>0,(E>>>0)+2>>>0)),pads:Array.from(n().subarray(D>>>0,(D>>>0)+4>>>0)),strides:Array.from(n().subarray(U>>>0,(U>>>0)+2>>>0)),wIsConst:()=>!!r()[ae>>>0],outputPadding:se?Array.from(n().subarray(se>>>0,pe>>>0)):[],outputShape:xe?Array.from(n().subarray(xe>>>0,Te>>>0)):[],activation:Ye(B)})},908116:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me)=>{a.Ua("ConvTranspose",i,{format:ae?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[E],pads:[D,U],strides:[J],wIsConst:()=>!!r()[se>>>0],outputPadding:pe?Array.from(n().subarray(pe>>>0,xe>>>0)):[],outputShape:Te?Array.from(n().subarray(Te>>>0,B>>>0)):[],activation:Ye(me)})},908518:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B)=>{a.Ua("ConvTranspose",i,{format:J?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(E>>>0,(E>>>0)+2>>>0)),pads:Array.from(n().subarray(D>>>0,(D>>>0)+4>>>0)),strides:Array.from(n().subarray(U>>>0,(U>>>0)+2>>>0)),wIsConst:()=>!!r()[ae>>>0],outputPadding:se?Array.from(n().subarray(se>>>0,pe>>>0)):[],outputShape:xe?Array.from(n().subarray(xe>>>0,Te>>>0)):[],activation:Ye(B)})},909083:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909174:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("AveragePool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},909458:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909549:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("AveragePool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},909833:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},909920:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("MaxPool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},910200:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},910287:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("MaxPool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[D,U],kernel_shape:[J,ae],pads:[se,pe,xe,Te],strides:[B,me]})},910567:(i,c,f,$,E)=>{a.Ua("Gemm",i,{alpha:c,beta:f,transA:$,transB:E})},910671:i=>{a.Ua("MatMul",i,void 0)},910725:(i,c,f,$)=>{a.Ua("ArgMax",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},910833:(i,c,f,$)=>{a.Ua("ArgMin",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},910941:(i,c)=>{a.Ua("Softmax",i,{axis:c})},911004:(i,c)=>{a.Ua("Concat",i,{axis:c})},911064:(i,c,f,$,E)=>{a.Ua("Split",i,{axis:c,numOutputs:f,splitSizes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},911204:i=>{a.Ua("Expand",i,void 0)},911258:(i,c)=>{a.Ua("Gather",i,{axis:Number(c)})},911329:(i,c)=>{a.Ua("GatherElements",i,{axis:Number(c)})},911408:(i,c,f,$,E,D,U,J,ae,se,pe)=>{a.Ua("Resize",i,{antialias:c,axes:f?Array.from(n().subarray(f>>>0,$>>>0)):[],coordinateTransformMode:Ye(E),cubicCoeffA:D,excludeOutside:U,extrapolationValue:J,keepAspectRatioPolicy:Ye(ae),mode:Ye(se),nearestMode:Ye(pe)})},911754:(i,c,f,$,E,D,U)=>{a.Ua("Slice",i,{starts:c?Array.from(n().subarray(c>>>0,f>>>0)):[],ends:$?Array.from(n().subarray($>>>0,E>>>0)):[],axes:D?Array.from(n().subarray(D>>>0,U>>>0)):[]})},911970:i=>{a.Ua("Tile",i,void 0)},912022:(i,c,f)=>{a.Ua("LayerNormalization",i,{axis:Number(c),epsilon:Number(f)})},912129:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912243:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912357:i=>{a.Ua("Range",i,void 0)},912410:(i,c)=>{a.Ua("Einsum",i,{equation:Ye(c)})},912491:(i,c,f,$,E)=>{a.Ua("Pad",i,{mode:c,value:f,pads:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},912618:(i,c,f,$,E,D)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!E,trainingMode:!!$,format:D?"NHWC":"NCHW"})},912787:(i,c,f,$,E,D)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!E,trainingMode:!!$,format:D?"NHWC":"NCHW"})},912956:(i,c,f)=>{a.Ua("CumSum",i,{exclusive:Number(c),reverse:Number(f)})},913053:(i,c,f,$,E,D,U,J,ae)=>{a.Ua("Attention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:E,doRotary:D,qkvHiddenSizes:U?Array.from(n().subarray(Number(J)>>>0,Number(J)+U>>>0)):[],pastPresentShareBuffer:!!ae})},913325:i=>{a.Ua("Gelu",i,void 0)},913377:(i,c,f,$,E,D)=>{a.Ua("MultiHeadAttention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:E,doRotary:D})},913536:i=>{a.Ua("BiasAdd",i,void 0)},913591:i=>{a.Ua("BiasSplitGelu",i,void 0)},913652:(i,c)=>{a.Ua("SkipLayerNormalization",i,{epsilon:c})},913733:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te)=>{a.Ua("Conv",i,{format:ae?"NHWC":"NCHW",auto_pad:c,dilations:[f],group:$,kernel_shape:[E],pads:D?Array.from(n().subarray(D>>>0,U>>>0)):[],strides:[J],w_is_const:()=>!!r()[se>>>0],activation:Ye(pe),activation_params:xe?Array.from(u().subarray(xe>>>0,Te>>>0)):[]})},914103:(i,c,f,$,E,D,U,J,ae,se,pe,xe,Te,B,me,_e)=>{a.Ua("Conv",i,{format:xe?"NHWC":"NCHW",auto_pad:c,dilations:[f,$],group:E,kernel_shape:[D,U],pads:J?Array.from(n().subarray(J>>>0,ae>>>0)):[],strides:[se,pe],w_is_const:()=>!!r()[Te>>>0],activation:Ye(B),activation_params:me?Array.from(u().subarray(me>>>0,_e>>>0)):[]})},914494:i=>{a.Eb(i)},914528:(i,c)=>a.Fb(i,c,a.hb.Hb,a.hb.errors)};function Wt(i){this.name="ExitStatus",this.message=`Program terminated with exit(${i})`,this.status=i}var Et=i=>{i.terminate(),i.onmessage=()=>{}},nr=i=>{ne.cb.length==0&&(Ot(),ne.qb(ne.cb[0]));var c=ne.cb.pop();if(!c)return 6;ne.eb.push(c),ne.$a[i.bb]=c,c.bb=i.bb;var f={cmd:"run",start_routine:i.Ib,arg:i.xb,pthread_ptr:i.bb};return I&&c.unref(),c.postMessage(f,i.Ob),0},ot=0,or=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ht=(i,c,f)=>{c>>>=0;var $=c+f;for(f=c;i[f]&&!(f>=$);)++f;if(16<f-c&&i.buffer&&or)return or.decode(i.buffer instanceof SharedArrayBuffer?i.slice(c,f):i.subarray(c,f));for($="";c<f;){var E=i[c++];if(E&128){var D=i[c++]&63;if((E&224)==192)$+=String.fromCharCode((E&31)<<6|D);else{var U=i[c++]&63;E=(E&240)==224?(E&15)<<12|D<<6|U:(E&7)<<18|D<<12|U<<6|i[c++]&63,65536>E?$+=String.fromCharCode(E):(E-=65536,$+=String.fromCharCode(55296|E>>10,56320|E&1023))}}else $+=String.fromCharCode(E)}return $},Ye=(i,c)=>(i>>>=0)?Ht(o(),i,c):"",yn=i=>{var c=xn();return i=i(),Wr(c),i};function Oe(i,c){var f=arguments.length-2,$=arguments;return yn(()=>{for(var E=_n(8*f),D=E>>>3,U=0;U<f;U++){var J=$[2+U];d()[D+U>>>0]=J}return $o(i,f,E,c)})}function ar(i){if(S)return Oe(0,1,i);Pe=i,0<ot||(ne.Jb(),a.onExit?.(i),Ee=!0),v(i,new Wt(i))}var Gt=i=>{if(Pe=i,S)throw sr(i),"unwind";ar(i)},ir=i=>{i instanceof Wt||i=="unwind"||v(1,i)};function Tr(){for(var i=a.numThreads;i--;)Ot();re.unshift(()=>{ze++,bn(()=>St())})}function Ot(){var i=P("ort-wasm-simd-threaded.worker.js");i=new Worker(i),ne.cb.push(i)}function bn(i){S?i():Promise.all(ne.cb.map(ne.qb)).then(i)}var ne={cb:[],eb:[],ub:[],$a:{},mb(){S?(ne.receiveObjectTransfer=ne.Gb,ne.threadInitTLS=ne.tb,ne.setExitStatus=ne.sb):Tr()},sb:i=>Pe=i,Sb:["$terminateWorker"],Jb:()=>{for(var i of ne.eb)Et(i);for(i of ne.cb)Et(i);ne.cb=[],ne.eb=[],ne.$a=[]},rb:i=>{var c=i.bb;delete ne.$a[c],ne.cb.push(i),ne.eb.splice(ne.eb.indexOf(i),1),i.bb=0,$n(c)},Gb(){},tb(){ne.ub.forEach(i=>i())},qb:i=>new Promise(c=>{i.onmessage=D=>{D=D.data;var U=D.cmd;if(D.targetThread&&D.targetThread!=Nr()){var J=ne.$a[D.targetThread];J?J.postMessage(D,D.transferList):K(`Internal error! Worker sent a message "${U}" to target pthread ${D.targetThread}, but that thread no longer exists!`)}else U==="checkMailbox"?Pt():U==="spawnThread"?nr(D):U==="cleanupThread"?ne.rb(ne.$a[D.thread]):U==="killThread"?(D=D.thread,U=ne.$a[D],delete ne.$a[D],Et(U),$n(D),ne.eb.splice(ne.eb.indexOf(U),1),U.bb=0):U==="cancelThread"?ne.$a[D.thread].postMessage({cmd:"cancel"}):U==="loaded"?(i.loaded=!0,I&&!i.bb&&i.unref(),c(i)):U==="alert"?alert(`Thread ${D.threadId}: ${D.text}`):D.target==="setimmediate"?i.postMessage(D):U==="callHandler"?a[D.handler](...D.args):U&&K(`worker sent an unknown command ${U}`)},i.onerror=D=>{throw K(`worker sent an error! ${D.filename}:${D.lineno}: ${D.message}`),D},I&&(i.on("message",D=>i.onmessage({data:D})),i.on("error",D=>i.onerror(D)));var f=[],$=["onExit"],E;for(E of $)a.hasOwnProperty(E)&&f.push(E);i.postMessage({cmd:"load",handlers:f,urlOrBlob:a.mainScriptUrlOrBlob||e,wasmMemory:Q,wasmModule:X})})};a.PThread=ne;var Je=i=>{for(;0<i.length;)i.shift()(a)};a.establishStackSpace=()=>{var i=Nr(),c=s()[i+52>>>2>>>0];i=s()[i+56>>>2>>>0],_o(c,c-i),Wr(c)};function sr(i){if(S)return Oe(1,0,i);Gt(i)}a.invokeEntryPoint=(i,c)=>{i=Co.apply(null,[i,c]),0<ot?ne.sb(i):Sn(i)};function Lt(i){this.lb=i-24,this.yb=function(c){s()[this.lb+4>>>2>>>0]=c},this.wb=function(c){s()[this.lb+8>>>2>>>0]=c},this.mb=function(c,f){this.vb(),this.yb(c),this.wb(f)},this.vb=function(){s()[this.lb+16>>>2>>>0]=0}}var ur=0,Er=0;function Or(i,c,f,$){return S?Oe(2,1,i,c,f,$):Ft(i,c,f,$)}function Ft(i,c,f,$){if(i>>>=0,c>>>=0,f>>>=0,$>>>=0,typeof SharedArrayBuffer>"u")return K("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var E=[];return S&&E.length===0?Or(i,c,f,$):(i={Ib:f,bb:i,xb:$,Ob:E},S?(i.Qb="spawnThread",postMessage(i,E),0):nr(i))}function Pr(i,c,f){return S?Oe(3,1,i,c,f):0}function kr(i,c){if(S)return Oe(4,1,i,c)}var lr=i=>{for(var c=0,f=0;f<i.length;++f){var $=i.charCodeAt(f);127>=$?c++:2047>=$?c+=2:55296<=$&&57343>=$?(c+=4,++f):c+=3}return c},Br=(i,c,f,$)=>{if(f>>>=0,!(0<$))return 0;var E=f;$=f+$-1;for(var D=0;D<i.length;++D){var U=i.charCodeAt(D);if(55296<=U&&57343>=U){var J=i.charCodeAt(++D);U=65536+((U&1023)<<10)|J&1023}if(127>=U){if(f>=$)break;c[f++>>>0]=U}else{if(2047>=U){if(f+1>=$)break;c[f++>>>0]=192|U>>6}else{if(65535>=U){if(f+2>=$)break;c[f++>>>0]=224|U>>12}else{if(f+3>=$)break;c[f++>>>0]=240|U>>18,c[f++>>>0]=128|U>>12&63}c[f++>>>0]=128|U>>6&63}c[f++>>>0]=128|U&63}}return c[f>>>0]=0,f-E},Rr=(i,c,f)=>Br(i,o(),c,f);function bt(i,c){if(S)return Oe(5,1,i,c)}function Xe(i,c,f){if(S)return Oe(6,1,i,c,f)}function wt(i,c,f){return S?Oe(7,1,i,c,f):0}function dr(i,c){if(S)return Oe(8,1,i,c)}function cr(i,c,f){if(S)return Oe(9,1,i,c,f)}function Dr(i,c,f,$){if(S)return Oe(10,1,i,c,f,$)}function oe(i,c,f,$){if(S)return Oe(11,1,i,c,f,$)}function pr(i,c,f,$){if(S)return Oe(12,1,i,c,f,$)}function jt(i){if(S)return Oe(13,1,i)}function mr(i,c){if(S)return Oe(14,1,i,c)}function fr(i,c,f){if(S)return Oe(15,1,i,c,f)}var hr=()=>{if(!(0<ot))try{S?Sn(Pe):Gt(Pe)}catch(i){ir(i)}};function qt(i){i>>>=0,typeof Atomics.Pb=="function"&&(Atomics.Pb(n(),i>>>2,i).value.then(Pt),i+=128,Atomics.store(n(),i>>>2,1))}a.__emscripten_thread_mailbox_await=qt;var Pt=()=>{var i=Nr();if(i&&(qt(i),!Ee))try{So(),hr()}catch(c){ir(c)}};a.checkMailbox=Pt;var Kt=[],vt=i=>i%4===0&&(i%100!==0||i%400===0),gr=[0,31,60,91,121,152,182,213,244,274,305,335],yr=[0,31,59,90,120,151,181,212,243,273,304,334];function Mr(i,c,f,$,E,D,U,J){return S?Oe(16,1,i,c,f,$,E,D,U,J):-52}function kt(i,c,f,$,E,D,U){if(S)return Oe(17,1,i,c,f,$,E,D,U)}var br=i=>{var c=lr(i)+1,f=vn(c);return f&&Rr(i,f,c),f},l=[],p=(i,c)=>{l.length=0;for(var f;f=o()[i++>>>0];){var $=f!=105;$&=f!=112,c+=$&&c%8?4:0,l.push(f==112?s()[c>>>2>>>0]:f==105?n()[c>>>2>>>0]:d()[c>>>3>>>0]),c+=$?8:4}return l},b={},x=()=>{if(!O){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:w||"./this.program"},c;for(c in b)b[c]===void 0?delete i[c]:i[c]=b[c];var f=[];for(c in i)f.push(`${c}=${i[c]}`);O=f}return O},O;function W(i,c){if(S)return Oe(18,1,i,c);i>>>=0,c>>>=0;var f=0;return x().forEach(($,E)=>{var D=c+f;for(E=s()[i+4*E>>>2>>>0]=D,D=0;D<$.length;++D)r()[E++>>>0>>>0]=$.charCodeAt(D);r()[E>>>0>>>0]=0,f+=$.length+1}),0}function L(i,c){if(S)return Oe(19,1,i,c);i>>>=0,c>>>=0;var f=x();s()[i>>>2>>>0]=f.length;var $=0;return f.forEach(E=>$+=E.length+1),s()[c>>>2>>>0]=$,0}function te(i){return S?Oe(20,1,i):52}function ee(i,c,f,$){return S?Oe(21,1,i,c,f,$):52}function ue(i,c,f,$,E){return S?Oe(22,1,i,c,f,$,E):70}var le=[null,[],[]];function ve(i,c,f,$){if(S)return Oe(23,1,i,c,f,$);c>>>=0,f>>>=0,$>>>=0;for(var E=0,D=0;D<f;D++){var U=s()[c>>>2>>>0],J=s()[c+4>>>2>>>0];c+=8;for(var ae=0;ae<J;ae++){var se=o()[U+ae>>>0],pe=le[i];se===0||se===10?((i===1?Z:K)(Ht(pe,0)),pe.length=0):pe.push(se)}E+=J}return s()[$>>>2>>>0]=E,0}var Ie=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return f=>(f.set(crypto.getRandomValues(new Uint8Array(f.byteLength))),f);if(I)try{var i=ko("crypto");if(i.randomFillSync)return f=>i.randomFillSync(f);var c=i.randomBytes;return f=>(f.set(c(f.byteLength)),f)}catch{}nt("initRandomDevice")},k=i=>(k=Ie())(i),de=[31,29,31,30,31,30,31,31,30,31,30,31],Se=[31,28,31,30,31,30,31,31,30,31,30,31];function $t(i){var c=Array(lr(i)+1);return Br(i,c,0,c.length),c}var Ur=(i,c)=>{r().set(i,c>>>0)};function po(i,c,f,$){function E(B,me,_e){for(B=typeof B=="number"?B.toString():B||"";B.length<me;)B=_e[0]+B;return B}function D(B,me){return E(B,me,"0")}function U(B,me){function _e(Po){return 0>Po?-1:0<Po?1:0}var Bt;return(Bt=_e(B.getFullYear()-me.getFullYear()))===0&&(Bt=_e(B.getMonth()-me.getMonth()))===0&&(Bt=_e(B.getDate()-me.getDate())),Bt}function J(B){switch(B.getDay()){case 0:return new Date(B.getFullYear()-1,11,29);case 1:return B;case 2:return new Date(B.getFullYear(),0,3);case 3:return new Date(B.getFullYear(),0,2);case 4:return new Date(B.getFullYear(),0,1);case 5:return new Date(B.getFullYear()-1,11,31);case 6:return new Date(B.getFullYear()-1,11,30)}}function ae(B){var me=B.fb;for(B=new Date(new Date(B.gb+1900,0,1).getTime());0<me;){var _e=B.getMonth(),Bt=(vt(B.getFullYear())?de:Se)[_e];if(me>Bt-B.getDate())me-=Bt-B.getDate()+1,B.setDate(1),11>_e?B.setMonth(_e+1):(B.setMonth(0),B.setFullYear(B.getFullYear()+1));else{B.setDate(B.getDate()+me);break}}return _e=new Date(B.getFullYear()+1,0,4),me=J(new Date(B.getFullYear(),0,4)),_e=J(_e),0>=U(me,B)?0>=U(_e,B)?B.getFullYear()+1:B.getFullYear():B.getFullYear()-1}i>>>=0,c>>>=0,f>>>=0,$>>>=0;var se=s()[$+40>>>2>>>0];$={Mb:n()[$>>>2>>>0],Lb:n()[$+4>>>2>>>0],jb:n()[$+8>>>2>>>0],ob:n()[$+12>>>2>>>0],kb:n()[$+16>>>2>>>0],gb:n()[$+20>>>2>>>0],ab:n()[$+24>>>2>>>0],fb:n()[$+28>>>2>>>0],Tb:n()[$+32>>>2>>>0],Kb:n()[$+36>>>2>>>0],Nb:se?Ye(se):""},f=Ye(f),se={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var pe in se)f=f.replace(new RegExp(pe,"g"),se[pe]);var xe="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Te="January February March April May June July August September October November December".split(" ");se={"%a":B=>xe[B.ab].substring(0,3),"%A":B=>xe[B.ab],"%b":B=>Te[B.kb].substring(0,3),"%B":B=>Te[B.kb],"%C":B=>D((B.gb+1900)/100|0,2),"%d":B=>D(B.ob,2),"%e":B=>E(B.ob,2," "),"%g":B=>ae(B).toString().substring(2),"%G":B=>ae(B),"%H":B=>D(B.jb,2),"%I":B=>(B=B.jb,B==0?B=12:12<B&&(B-=12),D(B,2)),"%j":B=>{for(var me=0,_e=0;_e<=B.kb-1;me+=(vt(B.gb+1900)?de:Se)[_e++]);return D(B.ob+me,3)},"%m":B=>D(B.kb+1,2),"%M":B=>D(B.Lb,2),"%n":()=>`\n`,"%p":B=>0<=B.jb&&12>B.jb?"AM":"PM","%S":B=>D(B.Mb,2),"%t":()=>"\t","%u":B=>B.ab||7,"%U":B=>D(Math.floor((B.fb+7-B.ab)/7),2),"%V":B=>{var me=Math.floor((B.fb+7-(B.ab+6)%7)/7);if(2>=(B.ab+371-B.fb-2)%7&&me++,me)me==53&&(_e=(B.ab+371-B.fb)%7,_e==4||_e==3&&vt(B.gb)||(me=1));else{me=52;var _e=(B.ab+7-B.fb-1)%7;(_e==4||_e==5&&vt(B.gb%400-1))&&me++}return D(me,2)},"%w":B=>B.ab,"%W":B=>D(Math.floor((B.fb+7-(B.ab+6)%7)/7),2),"%y":B=>(B.gb+1900).toString().substring(2),"%Y":B=>B.gb+1900,"%z":B=>{B=B.Kb;var me=0<=B;return B=Math.abs(B)/60,(me?"+":"-")+("0000"+(B/60*100+B%60)).slice(-4)},"%Z":B=>B.Nb,"%%":()=>"%"},f=f.replace(/%%/g,"\\0\\0");for(pe in se)f.includes(pe)&&(f=f.replace(new RegExp(pe,"g"),se[pe]($)));return f=f.replace(/\\0\\0/g,"%"),pe=$t(f),pe.length>c?0:(Ur(pe,i),pe.length-1)}var zr=i=>{try{i()}catch(c){nt(c)}};function Gu(){var i=Y,c={};for(let[f,$]of Object.entries(i))c[f]=typeof $=="function"?function(){Vr.push(f);try{return $.apply(null,arguments)}finally{Ee||(Vr.pop(),ut&&Ct===1&&Vr.length===0&&(Ct=0,ot+=1,zr(Ao),typeof Fibers<"u"&&Fibers.Ub()))}}:$;return c}var Ct=0,ut=null,mo=0,Vr=[],fo={},ho={},Lu=0,wn=null,Fu=[];function ju(){return new Promise((i,c)=>{wn={resolve:i,reject:c}})}function qu(){var i=vn(65548),c=i+12;s()[i>>>2>>>0]=c,s()[i+4>>>2>>>0]=c+65536,c=Vr[0];var f=fo[c];return f===void 0&&(f=Lu++,fo[c]=f,ho[f]=c),c=f,n()[i+8>>>2>>>0]=c,i}function Ku(){var i=n()[ut+8>>>2>>>0];return i=Y[ho[i]],--ot,i()}function Yu(i){if(!Ee){if(Ct===0){var c=!1,f=!1;i(($=0)=>{if(!Ee&&(mo=$,c=!0,f)){Ct=2,zr(()=>To(ut)),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.resume(),$=!1;try{var E=Ku()}catch(J){E=J,$=!0}var D=!1;if(!ut){var U=wn;U&&(wn=null,($?U.reject:U.resolve)(E),D=!0)}if($&&!D)throw E}}),f=!0,c||(Ct=1,ut=qu(),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.pause(),zr(()=>Io(ut)))}else Ct===2?(Ct=0,zr(Eo),wo(ut),ut=null,Fu.forEach($=>{if(!Ee)try{$(),hr()}catch(E){ir(E)}})):nt(`invalid state: ${Ct}`);return mo}}function Zu(i){return Yu(c=>{i().then(c)})}var Yt=[],at,Zt,go=[],yo=(i,c)=>{if(!Zt){Zt=new WeakMap;var f=at.length;if(Zt)for(var $=0;$<0+f;$++){var E=$,D=Yt[E];D||(E>=Yt.length&&(Yt.length=E+1),Yt[E]=D=at.get(E)),(E=D)&&Zt.set(E,$)}}if(f=Zt.get(i)||0)return f;if(go.length)f=go.pop();else{try{at.grow(1)}catch(J){throw J instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":J}f=at.length-1}try{$=f,at.set($,i),Yt[$]=at.get($)}catch(J){if(!(J instanceof TypeError))throw J;if(typeof WebAssembly.Function=="function"){$=WebAssembly.Function,E={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},D={parameters:[],results:c[0]=="v"?[]:[E[c[0]]]};for(var U=1;U<c.length;++U)D.parameters.push(E[c[U]]);c=new $(D,i)}else{for($=[1],E=c.slice(0,1),c=c.slice(1),D={i:127,p:127,j:126,f:125,d:124,e:111},$.push(96),U=c.length,128>U?$.push(U):$.push(U%128|128,U>>7),U=0;U<c.length;++U)$.push(D[c[U]]);E=="v"?$.push(0):$.push(1,D[E]),c=[0,97,115,109,1,0,0,0,1],E=$.length,128>E?c.push(E):c.push(E%128|128,E>>7),c.push.apply(c,$),c.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),c=new WebAssembly.Module(new Uint8Array(c)),c=new WebAssembly.Instance(c,{e:{f:i}}).exports.f}$=f,at.set($,c),Yt[$]=at.get($)}return Zt.set(i,f),f};ne.mb();var Ju=[ar,sr,Or,Pr,kr,bt,Xe,wt,dr,cr,Dr,oe,pr,jt,mr,fr,Mr,kt,W,L,te,ee,ue,ve],Qu={r:function(i,c,f){return Zu(async()=>{await a.Cb(i,c,f)})},b:function(i,c,f){throw i>>>=0,new Lt(i).mb(c>>>0,f>>>0),ur=i,Er++,ur},P:function(i){vo(i>>>0,!C,1,!y,131072,!1),ne.tb()},n:function(i){i>>>=0,S?postMessage({cmd:"cleanupThread",thread:i}):ne.rb(ne.$a[i])},L:Ft,i:Pr,V:kr,H:bt,J:Xe,z:wt,T:dr,N:cr,S:Dr,p:oe,I:pr,F:jt,U:mr,G:fr,Y:()=>1,D:function(i,c){i>>>=0,i==c>>>0?setTimeout(()=>Pt()):S?postMessage({targetThread:i,cmd:"checkMailbox"}):(i=ne.$a[i])&&i.postMessage({cmd:"checkMailbox"})},M:function(i,c,f,$){c>>>=0,Kt.length=f,$=$>>>0>>>3;for(var E=0;E<f;E++)Kt[E]=d()[$+E>>>0];return i=0>i?Nt[-i-1]:Ju[i],ne.zb=c,c=i.apply(null,Kt),ne.zb=0,c},O:qt,X:function(i){I&&ne.$a[i>>>0].ref()},u:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getUTCSeconds(),n()[f+4>>>2>>>0]=i.getUTCMinutes(),n()[f+8>>>2>>>0]=i.getUTCHours(),n()[f+12>>>2>>>0]=i.getUTCDate(),n()[f+16>>>2>>>0]=i.getUTCMonth(),n()[f+20>>>2>>>0]=i.getUTCFullYear()-1900,n()[f+24>>>2>>>0]=i.getUTCDay(),i=(i.getTime()-Date.UTC(i.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,n()[f+28>>>2>>>0]=i},v:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getSeconds(),n()[f+4>>>2>>>0]=i.getMinutes(),n()[f+8>>>2>>>0]=i.getHours(),n()[f+12>>>2>>>0]=i.getDate(),n()[f+16>>>2>>>0]=i.getMonth(),n()[f+20>>>2>>>0]=i.getFullYear()-1900,n()[f+24>>>2>>>0]=i.getDay(),c=(vt(i.getFullYear())?gr:yr)[i.getMonth()]+i.getDate()-1|0,n()[f+28>>>2>>>0]=c,n()[f+36>>>2>>>0]=-(60*i.getTimezoneOffset()),c=new Date(i.getFullYear(),6,1).getTimezoneOffset();var $=new Date(i.getFullYear(),0,1).getTimezoneOffset();i=(c!=$&&i.getTimezoneOffset()==Math.min($,c))|0,n()[f+32>>>2>>>0]=i},w:function(i){i>>>=0;var c=new Date(n()[i+20>>>2>>>0]+1900,n()[i+16>>>2>>>0],n()[i+12>>>2>>>0],n()[i+8>>>2>>>0],n()[i+4>>>2>>>0],n()[i>>>2>>>0],0),f=n()[i+32>>>2>>>0],$=c.getTimezoneOffset(),E=new Date(c.getFullYear(),6,1).getTimezoneOffset(),D=new Date(c.getFullYear(),0,1).getTimezoneOffset(),U=Math.min(D,E);return 0>f?n()[i+32>>>2>>>0]=+(E!=D&&U==$):0<f!=(U==$)&&(E=Math.max(D,E),c.setTime(c.getTime()+6e4*((0<f?U:E)-$))),n()[i+24>>>2>>>0]=c.getDay(),f=(vt(c.getFullYear())?gr:yr)[c.getMonth()]+c.getDate()-1|0,n()[i+28>>>2>>>0]=f,n()[i>>>2>>>0]=c.getSeconds(),n()[i+4>>>2>>>0]=c.getMinutes(),n()[i+8>>>2>>>0]=c.getHours(),n()[i+12>>>2>>>0]=c.getDate(),n()[i+16>>>2>>>0]=c.getMonth(),n()[i+20>>>2>>>0]=c.getYear(),i=c.getTime(),isNaN(i)?(n()[bo()>>>2>>>0]=61,i=-1):i/=1e3,xo((yt=i,1<=+Math.abs(yt)?0<yt?+Math.floor(yt/4294967296)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)),i>>>0},s:Mr,t:kt,C:function(i,c,f){function $(se){return(se=se.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?se[1]:"GMT"}i>>>=0,c>>>=0,f>>>=0;var E=new Date().getFullYear(),D=new Date(E,0,1),U=new Date(E,6,1);E=D.getTimezoneOffset();var J=U.getTimezoneOffset(),ae=Math.max(E,J);s()[i>>>2>>>0]=60*ae,n()[c>>>2>>>0]=+(E!=J),i=$(D),c=$(U),i=br(i),c=br(c),J<E?(s()[f>>>2>>>0]=i,s()[f+4>>>2>>>0]=c):(s()[f>>>2>>>0]=c,s()[f+4>>>2>>>0]=i)},d:()=>{nt("")},c:function(i,c,f){return i>>>=0,c=p(c>>>0,f>>>0),Nt[i].apply(null,c)},k:function(i,c,f){return i>>>=0,c=p(c>>>0,f>>>0),Nt[i].apply(null,c)},o:()=>{},q:()=>Date.now(),W:()=>{throw ot+=1,"unwind"},E:function(){return 4294901760},f:()=>performance.timeOrigin+performance.now(),g:()=>I?(No(),Jt(Vo)).cpus().length:navigator.hardwareConcurrency,A:function(i){i>>>=0;var c=o().length;if(i<=c||4294901760<i)return!1;for(var f=1;4>=f;f*=2){var $=c*(1+.2/f);$=Math.min($,i+100663296);var E=Math;$=Math.max(i,$);e:{E=(E.min.call(E,4294901760,$+(65536-$%65536)%65536)-Q.buffer.byteLength+65535)/65536;try{Q.grow(E),Ge();var D=1;break e}catch{}D=void 0}if(D)return!0}return!1},Q:W,R:L,K:Gt,h:te,m:ee,x:ue,l:ve,y:function(i,c){return i>>>=0,c>>>=0,k(o().subarray(i>>>0,i+c>>>0)),0},a:Q||a.wasmMemory,B:po,e:function(i,c,f,$){return po(i>>>0,c>>>0,f>>>0,$>>>0)},j:function(i,c,f,$){let E=at.length;i=new Uint8Array(o().slice(i+c,i+f));try{var D=new WebAssembly.Module(i),U=new WebAssembly.Instance(D,{env:{memory:Q}}),J;for(J in U.exports)yo(U.exports[J]);return E<at.length?E:$}catch(ae){return console.log(ae),$}}},Y=function(){function i(f,$){return Y=f.exports,Y=Gu(),Y=Xu(),ne.ub.push(Y.Ha),at=Y.Ia,be.unshift(Y.Z),X=$,St(),Y}var c={a:Qu};if(ze++,a.instantiateWasm)try{return a.instantiateWasm(c,i)}catch(f){K(`Module.instantiateWasm callback failed with error: ${f}`),h(f)}return _t(c,function(f){i(f.instance,f.module)}).catch(h),{}}();a._OrtInit=(i,c)=>(a._OrtInit=Y._)(i,c),a._OrtGetLastError=(i,c)=>(a._OrtGetLastError=Y.$)(i,c),a._OrtCreateSessionOptions=(i,c,f,$,E,D,U,J,ae,se)=>(a._OrtCreateSessionOptions=Y.aa)(i,c,f,$,E,D,U,J,ae,se),a._OrtAppendExecutionProvider=(i,c)=>(a._OrtAppendExecutionProvider=Y.ba)(i,c),a._OrtAddFreeDimensionOverride=(i,c,f)=>(a._OrtAddFreeDimensionOverride=Y.ca)(i,c,f),a._OrtAddSessionConfigEntry=(i,c,f)=>(a._OrtAddSessionConfigEntry=Y.da)(i,c,f),a._OrtReleaseSessionOptions=i=>(a._OrtReleaseSessionOptions=Y.ea)(i),a._OrtCreateSession=(i,c,f)=>(a._OrtCreateSession=Y.fa)(i,c,f),a._OrtReleaseSession=i=>(a._OrtReleaseSession=Y.ga)(i),a._OrtGetInputOutputCount=(i,c,f)=>(a._OrtGetInputOutputCount=Y.ha)(i,c,f),a._OrtGetInputName=(i,c)=>(a._OrtGetInputName=Y.ia)(i,c),a._OrtGetOutputName=(i,c)=>(a._OrtGetOutputName=Y.ja)(i,c),a._OrtFree=i=>(a._OrtFree=Y.ka)(i),a._OrtCreateTensor=(i,c,f,$,E,D)=>(a._OrtCreateTensor=Y.la)(i,c,f,$,E,D),a._OrtGetTensorData=(i,c,f,$,E)=>(a._OrtGetTensorData=Y.ma)(i,c,f,$,E),a._OrtReleaseTensor=i=>(a._OrtReleaseTensor=Y.na)(i),a._OrtCreateRunOptions=(i,c,f,$)=>(a._OrtCreateRunOptions=Y.oa)(i,c,f,$),a._OrtAddRunConfigEntry=(i,c,f)=>(a._OrtAddRunConfigEntry=Y.pa)(i,c,f),a._OrtReleaseRunOptions=i=>(a._OrtReleaseRunOptions=Y.qa)(i),a._OrtCreateBinding=i=>(a._OrtCreateBinding=Y.ra)(i),a._OrtBindInput=(i,c,f)=>(a._OrtBindInput=Y.sa)(i,c,f),a._OrtBindOutput=(i,c,f,$)=>(a._OrtBindOutput=Y.ta)(i,c,f,$),a._OrtClearBoundOutputs=i=>(a._OrtClearBoundOutputs=Y.ua)(i),a._OrtReleaseBinding=i=>(a._OrtReleaseBinding=Y.va)(i),a._OrtRunWithBinding=(i,c,f,$,E)=>(a._OrtRunWithBinding=Y.wa)(i,c,f,$,E),a._OrtRun=(i,c,f,$,E,D,U,J)=>(a._OrtRun=Y.xa)(i,c,f,$,E,D,U,J),a._OrtEndProfiling=i=>(a._OrtEndProfiling=Y.ya)(i),a._OrtConfigure=(i,c)=>(a._OrtConfigure=Y.za)(i,c),a._OrtAuth=(i,c)=>(a._OrtAuth=Y.Aa)(i,c),a._JsepOutput=(i,c,f)=>(a._JsepOutput=Y.Ba)(i,c,f),a._JsepGetNodeName=i=>(a._JsepGetNodeName=Y.Ca)(i);var bo=()=>(bo=Y.Da)(),Nr=a._pthread_self=()=>(Nr=a._pthread_self=Y.Ea)(),vn=a._malloc=i=>(vn=a._malloc=Y.Fa)(i),wo=a._free=i=>(wo=a._free=Y.Ga)(i);a.__emscripten_tls_init=()=>(a.__emscripten_tls_init=Y.Ha)();var vo=a.__emscripten_thread_init=(i,c,f,$,E,D)=>(vo=a.__emscripten_thread_init=Y.Ja)(i,c,f,$,E,D);a.__emscripten_thread_crashed=()=>(a.__emscripten_thread_crashed=Y.Ka)();var $o=(i,c,f,$)=>($o=Y.La)(i,c,f,$),$n=i=>($n=Y.Ma)(i),Sn=a.__emscripten_thread_exit=i=>(Sn=a.__emscripten_thread_exit=Y.Na)(i),So=()=>(So=Y.Oa)(),xo=i=>(xo=Y.Pa)(i),_o=(i,c)=>(_o=Y.Qa)(i,c),xn=()=>(xn=Y.Ra)(),Wr=i=>(Wr=Y.Sa)(i),_n=i=>(_n=Y.Ta)(i),Co=a.dynCall_ii=(i,c)=>(Co=a.dynCall_ii=Y.Va)(i,c),Io=i=>(Io=Y.Wa)(i),Ao=()=>(Ao=Y.Xa)(),To=i=>(To=Y.Ya)(i),Eo=()=>(Eo=Y.Za)();a.___start_em_js=914640,a.___stop_em_js=915413;function Xu(){var i=Y;i=Object.assign({},i);var c=$=>()=>$()>>>0,f=$=>E=>$(E)>>>0;return i.Da=c(i.Da),i.Ea=c(i.Ea),i.Fa=f(i.Fa),i.emscripten_main_runtime_thread_id=c(i.emscripten_main_runtime_thread_id),i.Ra=c(i.Ra),i.Ta=f(i.Ta),i}a.wasmMemory=Q,a.stackAlloc=_n,a.stackSave=xn,a.stackRestore=Wr,a.keepRuntimeAlive=()=>0<ot,a.addFunction=yo,a.UTF8ToString=Ye,a.stringToUTF8=Rr,a.lengthBytesUTF8=lr,a.ExitStatus=Wt,a.PThread=ne;var Hr;Ue=function i(){Hr||Oo(),Hr||(Ue=i)};function Oo(){if(!(0<ze))if(S)m(a),S||Je(be),startWorker(a);else{if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)re.unshift(a.preRun.shift());Je(re),0<ze||Hr||(Hr=!0,a.calledRun=!0,Ee||(S||Je(be),m(a),S||Je(rt)))}}return Oo(),t.ready}})();typeof Ho=="object"&&typeof Pn=="object"?Pn.exports=Wo:typeof define=="function"&&define.amd&&define([],()=>Wo)});var Lo=wr((np,ul)=>{ul.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Rn,et,$r,Fr,Sr,Zo,Dn,Ne=q(()=>{"use strict";Rn=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},et=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},$r=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Fr=e=>{switch(e){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Sr=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Zo=e=>e==="float32"||e==="int32"||e==="int64"||e==="bool"||e==="float16"||e==="uint32",Dn=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}});var jr=q(()=>{"use strict"});var Qo=q(()=>{"use strict";jr()});var Xo,ea=q(()=>{"use strict";Xo="1.17.0"});var ta,Rt,Mn=q(()=>{"use strict";ea();ta="warning",Rt={wasm:{},webgl:{},webgpu:{},versions:{common:Xo},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);ta=e}},get logLevel(){return ta}};Object.defineProperty(Rt,"logLevel",{enumerable:!0})});var Qt,ra=q(()=>{"use strict";Mn();Qt=Rt});var na=q(()=>{"use strict"});var oa=q(()=>{"use strict";qr()});var ia=q(()=>{"use strict"});var sa=q(()=>{"use strict";qr()});var qr=q(()=>{"use strict";na();oa();ia();sa()});var Kr=q(()=>{"use strict";qr()});var Un,ua,Dt,Mt,zn=q(()=>{"use strict";Mn();Un=(e,t)=>{Rt.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},ua=(e,t)=>{let r=new Error().stack?.split(/\\r\\n|\\r|\\n/g)||[],o=!1;for(let n=0;n<r.length;n++){if(o&&!r[n].includes("TRACE_FUNC")){let s=`FUNC_${e}::${r[n].trim().split(" ")[1]}`;t&&(s+=`::${t}`),Un("CPU",s);return}r[n].includes("TRACE_FUNC")&&(o=!0)}},Dt=e=>{Rt.wasm.trace&&ua("BEGIN",e)},Mt=e=>{Rt.wasm.trace&&ua("END",e)}});var la=q(()=>{"use strict";jr();Kr();zn()});var da=q(()=>{"use strict";la()});var ca=q(()=>{"use strict"});var pa=q(()=>{"use strict";jr();Kr()});var ma=q(()=>{"use strict";pa()});var Xt=q(()=>{"use strict";Qo();ra();da();Kr();zn();ca();ma()});var wl,vl,fa,ha,ga,$l,De,It=q(()=>{"use strict";Ne();wl=["V","I","W","E","F"],vl=(e,t)=>{console.log(`[${wl[e]},${new Date().toISOString()}]${t}`)},ga=(e,t)=>{fa=e,ha=t},$l=(e,t)=>{let r=Sr(e),o=Sr(fa);r>=o&&vl(r,typeof t=="function"?t():t)},De=(...e)=>{ha&&$l(...e)}});var ya,ba=q(()=>{"use strict";Ne();ya=(e,t)=>new(Fr(t))(e)});var Yr=q(()=>{"use strict"});var Zr,Sl,wa,Nn,Vn,$a,Sa=q(()=>{"use strict";It();Yr();Zr=e=>Math.ceil(e/16)*16,Sl=1,wa=()=>Sl++,Nn=async(e,t,r,o)=>{let n=Zr(r),s=e.device.createBuffer({size:n,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let u=e.getCommandEncoder();e.endComputePass(),u.copyBufferToBuffer(t,0,s,0,n),e.flush(),await s.mapAsync(GPUMapMode.READ);let d=s.getMappedRange();if(o){let a=o();return a.set(new Uint8Array(d,0,r)),a}else return new Uint8Array(d.slice(0,r))}finally{s.destroy()}},Vn=class{constructor(t){this.backend=t;this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map}upload(t,r){let o=r.buffer,n=r.byteOffset,s=r.byteLength,u=Zr(s),d=this.storageCache.get(t);if(!d)throw new Error("gpu data for uploading does not exist");if(d.originalSize!==s)throw new Error(`inconsistent data size. gpu data size=${d.originalSize}, data size=${s}`);let a=this.backend.device.createBuffer({mappedAtCreation:!0,size:u,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),m=a.getMappedRange();new Uint8Array(m).set(new Uint8Array(o,n,s)),a.unmap();let h=this.backend.getCommandEncoder();this.backend.endComputePass(),h.copyBufferToBuffer(a,0,d.gpuData.buffer,0,u),De("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${t})`),this.buffersForUploadingPending.push(a)}memcpy(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(r);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(o.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let s=Zr(o.originalSize),u=this.backend.getCommandEncoder();this.backend.endComputePass(),u.copyBufferToBuffer(o.gpuData.buffer,0,n.gpuData.buffer,0,s)}registerExternalBuffer(t,r,o){let n;if(o){if(n=this.externalBuffers.get(o),n===void 0)throw new Error("previous buffer is not registered");if(t===o)return De("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, buffer is the same, skip.`),n;this.externalBuffers.delete(o)}else n=wa();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:t},originalSize:r}),this.externalBuffers.set(t,n),De("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, registered.`),n}unregisterExternalBuffer(t){let r=this.externalBuffers.get(t);r!==void 0&&(this.storageCache.delete(r),this.externalBuffers.delete(t),De("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${r}`))}create(t,r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let o=Zr(t),n,s=(r&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,u=(r&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(s||u){let a=s?this.freeBuffers:this.freeUniformBuffers,m=a.get(o);m||(m=[],a.set(o,m)),m.length>0?n=m.pop():n=this.backend.device.createBuffer({size:o,usage:r})}else n=this.backend.device.createBuffer({size:o,usage:r});let d={id:wa(),type:0,buffer:n};return this.storageCache.set(d.id,{gpuData:d,originalSize:t}),De("verbose",()=>`[WebGPU] GpuDataManager.create(size=${t}) => id=${d.id}`),d}get(t){return this.storageCache.get(t)?.gpuData}release(t){let r=this.storageCache.get(t);if(!r)throw new Error("releasing data does not exist");return De("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(r.gpuData.buffer),r.originalSize}async download(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("data does not exist");await Nn(this.backend,o.gpuData.buffer,o.originalSize,r)}refreshPendingBuffers(){for(let t of this.buffersForUploadingPending)t.destroy();this.buffersForUploadingPending=[];for(let t of this.buffersPending)(t.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(t.size).push(t):(t.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(t.size).push(t):t.destroy();this.buffersPending=[]}dispose(){this.freeBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.freeUniformBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map}},$a=(...e)=>new Vn(...e)});var Wn,ge,je=q(()=>{"use strict";Wn=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},ge=e=>new Wn(e)});var Hn,lt,V,Ut,Jr,Qr,Xr,$e=q(()=>{"use strict";Hn=class{static calcMatMulShape(t,r){return t[1]!==r[0]?void 0:[t[0],r[1]]}},lt=class{static calcShape(t,r,o=!1){let n=t.length,s=r.length;if(n===0)return r;if(s===0)return t;let u=Math.max(t.length,r.length),d=new Array(u);if(o){if(n<2||s<2)return;let a=Hn.calcMatMulShape([t[n-2],t[n-1]],[r[s-2],r[s-1]]);if(a===void 0)return;[d[u-2],d[u-1]]=a}for(let a=o?3:1;a<=u;a++){let m=n-a<0?1:t[n-a],h=s-a<0?1:r[s-a];if(m!==h&&m>1&&h>1)return;d[u-a]=Math.max(m,h)}return d}static isValidBroadcast(t,r){let o=t.length,n=r.length;if(o>n)return!1;for(let s=1;s<=o;s++)if(t[o-s]!==1&&t[o-s]!==r[n-s])return!1;return!0}},V=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,o){let n=1;for(let s=r;s<o;s++){if(t[s]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");n*=t[s]}return n}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let o=new Array(r);o[r-1]=1,o[r-2]=t[r-1];for(let n=r-3;n>=0;--n)o[n]=o[n+1]*t[n+1];return o}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(o=>this.normalizeAxis(o,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(o=>t[o]):t.slice().reverse()}static padShape(t,r){let o=t.length;return t.map((n,s)=>n+r[s]+r[s+o])}static areEqual(t,r){return t.length!==r.length?!1:t.every((o,n)=>o===r[n])}},Ut=class e{static adjustPoolAttributes(t,r,o,n,s,u){if(!t&&o.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let d=0;d<r.length-2;d++)d>=o.length?o.push(r[d+2]):o[d]=r[d+2];for(let d=0;d<o.length;d++)if(d<n.length){if(n[d]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let d=0;d<o.length;d++)if(d<s.length){if(s[d]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let d=0;d<o.length*2;d++)if(d<u.length){if(u[d]<0)throw new Error("pad should be greater than or equal to 1")}else u.push(0);for(let d=0;d<o.length;d++){if(o[d]<=0)throw new Error("kernel shapes need to be greater than 0");if(u[d]>=o[d]||u[d+o.length]>=o[d])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,o,n,s,u,d){if(d){if(s.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let a=0;a<t.length-2;a++)e.adjustPadAndReturnShape(t[a+(u?1:2)],r[a],o[a],n[a],s,a,a+t.length-2,d)}}static computePoolOutputShape(t,r,o,n,s,u,d){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let a=[r[0],r[1]];return e.computeShapeHelper(t,r,a,o,n,s,u,d),a}static computeConvOutputShape(t,r,o,n,s,u,d){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let a=[t[0],r[0]];return e.computeShapeHelper(!1,t,a,o,n,s,u,d),a}static computeShapeHelper(t,r,o,n,s,u,d,a){if(t)for(let m=0;m<r.length-2;m++)o.push(1);else for(let m=0;m<r.length-2;m++)o.push(e.adjustPadAndReturnShape(r[m+2],n[m],s[m],u[m],d,m,m+r.length-2,a))}static adjustPadAndReturnShape(t,r,o,n,s,u,d,a){let m=o*(n-1)+1;if(a&&a!=="NOTSET")switch(a){case"VALID":return s[u]=0,s[d]=0,Math.floor((t-m)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let g=((t+r-1)/r-1)*r+n-t;return s[u]=Math.floor(a==="SAME_LOWER"?(g+1)/2:g/2),s[d]=g-s[u],Math.floor((t+g-n)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+s[u]+s[d]-m)/r+1)}},Jr=class{static getShapeOfGemmResult(t,r,o,n,s){if(t.length!==2||o.length!==2)throw new Error("shape need to be of size 2");let u,d,a;r?(u=t[1],d=t[0]):(u=t[0],d=t[1]);let m=-1;if(n?(a=o[0],m=1):(a=o[1],m=0),o[m]!==d)throw new Error("dimension mismatch");if(u<=0||a<=0||d<=0)throw new Error("invalid shape specified");if(s&&!lt.isValidBroadcast(s,[u,a]))throw new Error("gemm: invalid bias shape for broadcast");return[u,a,d]}},Qr=-34028234663852886e22,Xr=34028234663852886e22});var xl,Ln,Le,dt,F,Fe,Ze,it,tt,ce,Fn,M,j,en,Gn,xa,er,Be,we=q(()=>{"use strict";Ne();$e();xl=64,Ln=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},Le=(e,t=1)=>{let r=Ln(e,t);return typeof r=="string"?r:r[0]},dt=(e,t=1)=>{let r=Ln(e,t);return typeof r=="string"?r:r[1]},F=e=>e.length===0?[]:[{type:"uint32",data:e},{type:"uint32",data:V.computeStrides(e)}],Fe=e=>e%4===0?4:e%2===0?2:1,Ze=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,it=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}f(${r})`,tt=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,ce=(e,t,r)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?`${e}[(${t}) / 4][(${t}) % 4]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Fn=(e,t,r,o,n)=>{let s=typeof r=="number",u=s?r:r.length,d=[...new Array(u).keys()],a=u<2?"u32":u<=4?`vec${u}<u32>`:`array<u32, ${u}>`,m=Ln(t,n),h=typeof m=="string"?m:m[1],g=typeof m=="string"?m:m[0],w={indices:a,value:h,storage:g,tensor:t},v=G=>typeof G=="string"?G:`${G}u`,y={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},C=s?"uniforms.":"",I=`${C}${e}_shape`,S=`${C}${e}_strides`,_="";for(let G=0;G<u-1;G++)_+=`\n    let dim${G} = current / ${ce(S,G,u)};\n    let rest${G} = current % ${ce(S,G,u)};\n    indices[${G}] = dim${G};\n    current = rest${G};\n    `;_+=`indices[${u-1}] = current;`;let P=u<2?"":`\n  fn o2i_${e}(offset: u32) -> ${w.indices} {\n    var indices: ${w.indices};\n    var current = offset;\n    ${_}\n    return indices;\n  }`,A=G=>(y.offsetToIndices=!0,u<2?G:`o2i_${e}(${G})`),z=[];if(u>=2)for(let G=u-1;G>=0;G--)z.push(`${ce(S,G,u)} * (indices[${G}])`);let R=u<2?"":`\n  fn i2o_${e}(indices: ${w.indices}) -> u32 {\n    return ${z.join("+")};\n  }`,N=G=>(y.indicesToOffset=!0,u<2?G:`i2o_${e}(${G})`),T=(...G)=>u===0?"0u":`${w.indices}(${G.map(v).join(",")})`,H=(G,re)=>u<2?`${G}`:`${ce(G,re,u)}`,ie=(G,re,be)=>u<2?`${G}=${be};`:`${ce(G,re,u)}=${be};`,Z={},K=(G,re)=>{y.broadcastedIndicesToOffset=!0;let be=`${re.name}broadcastedIndicesTo${e}Offset`;if(be in Z)return`${be}(${G})`;let rt=[];for(let ze=u-1;ze>=0;ze--){let Ve=re.indicesGet("outputIndices",ze+re.rank-u);rt.push(`${H(S,ze)} * (${Ve} % ${H(I,ze)})`)}return Z[be]=`fn ${be}(outputIndices: ${re.type.indices}) -> u32 {\n             return ${rt.length>0?rt.join("+"):"0u"};\n           }`,`${be}(${G})`},Q=(G,re)=>(()=>{if(w.storage===w.value)return`${e}[${G}]=${re};`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`${e}[${G}]=vec2<u32>(u32(${re}), select(0u, 0xFFFFFFFFu, ${re} < 0));`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`${e}[${G}]=vec2<u32>(u32(${re}), 0u);`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`${e}[${G}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${re}));`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),X=G=>(()=>{if(w.storage===w.value)return`${e}[${G}]`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`i32(${e}[${G}].x)`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`u32(${e}[${G}].x)`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${G}] & 0xFFu), bool(${e}[${G}] & 0xFF00u), bool(${e}[${G}] & 0xFF0000u), bool(${e}[${G}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),Ee=u<2?"":`\n  fn get_${e}ByIndices(indices: ${w.indices}) -> ${h} {\n    return ${X(`i2o_${e}(indices)`)};\n  }`,Pe=u<2?"":(()=>{let G=d.map(be=>`d${be}: u32`).join(", "),re=d.map(be=>`d${be}`).join(", ");return`\n  fn get_${e}(${G}) -> ${h} {\n    return get_${e}ByIndices(${T(re)});\n  }`})(),fe=(...G)=>{if(G.length!==u)throw new Error(`indices length must be ${u}`);let re=G.map(v).join(",");return u===0?X("0u"):u===1?X(re[0]):(y.get=!0,y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}(${re})`)},Ce=G=>u<2?X(G):(y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}ByIndices(${G})`),he=u<2?"":`\n  fn set_${e}ByIndices(indices: ${w.indices}, value: ${h}) {\n    ${Q(`i2o_${e}(indices)`,"value")}\n  }`,ye=u<2?"":(()=>{let G=d.map(be=>`d${be}: u32`).join(", "),re=d.map(be=>`d${be}`).join(", ");return`\n  fn set_${e}(${G}, value: ${h}) {\n    set_${e}ByIndices(${T(re)}, value);\n  }`})();return{impl:()=>{let G=[],re=!1;return y.offsetToIndices&&(G.push(P),re=!0),y.indicesToOffset&&(G.push(R),re=!0),y.broadcastedIndicesToOffset&&(Object.values(Z).forEach(be=>G.push(be)),re=!0),y.set&&(G.push(ye),re=!0),y.setByIndices&&(G.push(he),re=!0),y.get&&(G.push(Pe),re=!0),y.getByIndices&&(G.push(Ee),re=!0),!s&&re&&G.unshift(`const ${I} = ${w.indices}(${r.join(",")});`,`const ${S} = ${w.indices}(${V.computeStrides(r).join(",")});`),G.join(`\n`)},type:w,offsetToIndices:A,indicesToOffset:N,broadcastedIndicesToOffset:K,indices:T,indicesGet:H,indicesSet:ie,set:(...G)=>{if(G.length!==u+1)throw new Error(`indices length must be ${u}`);let re=G[u];if(typeof re!="string")throw new Error("value must be string");let be=G.slice(0,u).map(v).join(",");return u===0?Q("0u",re):u===1?Q(be[0],re):(y.set=!0,y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}(${be}, ${re})`)},setByOffset:Q,setByIndices:(G,re)=>u<2?Q(G,re):(y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}ByIndices(${G}, ${re});`),get:fe,getByOffset:X,getByIndices:Ce,usage:o,name:e,strides:S,shape:I,rank:u}},M=(e,t,r,o=1)=>Fn(e,t,r,"input",o),j=(e,t,r,o=1)=>Fn(e,t,r,"output",o),en=(e,t,r,o=1)=>Fn(e,t,r,"internal",o),Gn=class{constructor(t){this.normalizedDispatchGroup=t;this.internalVariables=[];this.variables=[];this.uniforms=[];this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(t){return`if (global_idx >= ${typeof t=="number"?`${t}u`:t}) { return; }`}mainStart(t=xl){let r=typeof t=="number"?t:t[0],o=typeof t=="number"?1:t[1],n=typeof t=="number"?1:t[2],s=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,u=s?`@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>`,d=s?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${r*o*n}u + local_idx;`;return`@compute @workgroup_size(${r}, ${o}, ${n})\n  fn main(${u}) {\n    ${d}\n  `}appendVariableUniforms(t){t.rank!==0&&(t.shape.startsWith("uniforms.")&&this.uniforms.push({name:t.shape.replace("uniforms.",""),type:"u32",length:t.rank}),t.strides.startsWith("uniforms.")&&this.uniforms.push({name:t.strides.replace("uniforms.",""),type:"u32",length:t.rank}))}declareVariable(t,r){if(t.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(t),this.appendVariableUniforms(t);let o=t.usage==="input"?"read":"read_write",n=t.type.storage;return`@group(0) @binding(${r}) var<storage, ${o}> ${t.name}: array<${n}>;`}declareVariables(...t){return t.map(r=>this.declareVariable(r,this.variableIndex++)).join(`\n`)}registerInternalVariable(t){if(t.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(t),this.appendVariableUniforms(t)}registerInternalVariables(...t){return t.forEach(r=>this.registerInternalVariable(r)),this}registerUniform(t,r,o=1){return this.uniforms.push({name:t,type:r,length:o}),this}registerUniforms(t){return this.uniforms=this.uniforms.concat(t),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let t=[];for(let{name:r,type:o,length:n}of this.uniforms)if(n&&n>4)t.push(`${r}:array<vec4<${o}>, ${Math.ceil(n/4)}>`);else{let s=n==null||n===1?o:`vec${n}<${o}>`;t.push(`${r}:${s}`)}return`\n      struct Uniforms { ${t.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(t=>t.impl()).join(`\n`)+this.internalVariables.map(t=>t.impl()).join(`\n`)}},xa=e=>new Gn(e),er=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;n++){let s=r-1-n,u=e[s]||1;(t[t.length-1-n]||1)>1&&u===1&&o.unshift(s)}return o},Be=e=>!0});var _l,_a,Cl,Il,st,Ca,Ia,tr=q(()=>{"use strict";$e();je();we();_l=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.")},_a=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,Cl=(e,t)=>V.sortBasedOnPerm(e,_a(e.length,t)),Il=(e,t,r,o)=>{let n=[];n.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let s=0;s<t;++s)n.push(r.indicesSet("a",e[s],`i[${s}]`));return n.push("return a;}"),n.join(`\n`)},st=(e,t)=>{let r=e.dataType,o=e.dims.length,n=_a(o,t),s=Be(o),u=Cl(e.dims,n),d=s?u.length:u,a=s?o:e.dims,m=j("output",r,d),h=M("a",r,a),g=w=>`\n  ${w.registerUniform("output_size","u32").declareVariables(h,m)}\n\n  ${Il(n,o,h,m)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${m.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${m.setByOffset("global_idx",h.getByIndices("aIndices"))}\n  }`;return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:s?["rank"]:["dims"]},getRunData:w=>{let v=V.size(u);return{outputs:[{dims:u,dataType:w[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:s?[{type:"uint32",data:v},...F(w[0].dims),...F(u)]:[{type:"uint32",data:v}]}},getShaderSource:g}},Ca=(e,t)=>{_l(e.inputs),e.compute(st(e.inputs[0],t.perm))},Ia=e=>ge({perm:e.perm})});var Al,Tl,El,Ol,Pl,kl,Bl,Rl,Dl,Ml,ct,Aa,Ta,Ea,Oa,Pa,ka,Ba,Ra,Da,Ma,Ua=q(()=>{"use strict";$e();we();tn();tr();Al={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Tl={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},El={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Ol={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Pl=(e,t)=>{let r=[];for(let o=t-e;o<t;++o)r.push(o);return r},kl=(e,t)=>{let r=[],o=e.length;for(let s=0;s<o;s++)t.indexOf(s)===-1&&r.push(e[s]);let n=t.map(s=>e[s]);return[r,n]},Bl=(e,t)=>{let r=e.length+t.length,o=[],n=0;for(let s=0;s<r;s++)t.indexOf(s)===-1?o.push(e[n++]):o.push(1);return o},Rl=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},Dl=(e,t)=>{let r=[];if(!Rl(e,t)){for(let o=0;o<t;++o)e.indexOf(o)===-1&&r.push(o);e.forEach(o=>r.push(o))}return r},Ml=(e,t,r,o,n,s,u)=>{let d=r[0].dims,a=V.size(s),m=V.size(u),h=M("_A",r[0].dataType,d),g=j("output",n,s),w=32,v=`\n          var<workgroup> aBestValues : array<${g.type.storage}, ${w}>;\n       `;return{name:e,shaderCache:t,getShaderSource:C=>`\n        ${C.registerUniform("reduceSize","u32").declareVariables(h,g)}\n        ${v}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${C.mainStart(w)}\n\n          let outputIndex = global_idx / ${w};\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ${g.type.storage}(${El[o]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + ${w}) {\n           let candidate = ${g.type.storage}(${h.getByOffset("offset + k")});\n           bestValue = ${Al[o]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, ${w}u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${Tl[o]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${g.setByOffset("outputIndex",`${o==="mean"?`bestValue / ${g.type.storage}(uniforms.reduceSize)`:`${Ol[o]}`}`)};\n         }\n        }`,getRunData:()=>({outputs:[{dims:s,dataType:n}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:m}]})}},ct=(e,t,r,o)=>{let n=e.inputs.length===1?r:jn(e.inputs,r),s=n.axes;s.length===0&&!n.noopWithEmptyAxes&&(s=e.inputs[0].dims.map((v,y)=>y));let u=V.normalizeAxes(s,e.inputs[0].dims.length),d=u,a=e.inputs[0],m=Dl(d,e.inputs[0].dims.length);m.length>0&&(a=e.compute(st(e.inputs[0],m),{inputs:[0],outputs:[-1]})[0],d=Pl(d.length,a.dims.length));let[h,g]=kl(a.dims,d),w=h;n.keepDims&&(w=Bl(h,u)),e.compute(Ml(t,{hint:n.cacheKey,inputDependencies:["type"]},[a],o,e.inputs[0].dataType,w,g),{inputs:[a]})},Aa=(e,t)=>{ct(e,"ReduceMeanShared",t,"mean")},Ta=(e,t)=>{ct(e,"ReduceL1Shared",t,"l1")},Ea=(e,t)=>{ct(e,"ReduceL2Shared",t,"l2")},Oa=(e,t)=>{ct(e,"ReduceLogSumExpShared",t,"logSumExp")},Pa=(e,t)=>{ct(e,"ReduceMaxShared",t,"max")},ka=(e,t)=>{ct(e,"ReduceMinShared",t,"min")},Ba=(e,t)=>{ct(e,"ReduceProdShared",t,"prod")},Ra=(e,t)=>{ct(e,"ReduceSumShared",t,"sum")},Da=(e,t)=>{ct(e,"ReduceSumSquareShared",t,"sumSquare")},Ma=(e,t)=>{ct(e,"ReduceLogSumShared",t,"logSum")}});var pt,Ul,rn,jn,mt,zl,Vl,Nl,Wl,Hl,Gl,Ll,Fl,jl,ql,ft,za,Va,Na,Wa,Ha,Ga,La,Fa,ja,qa,tn=q(()=>{"use strict";$e();je();we();Ua();pt=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Ul=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],rn=(e,t,r,o,n,s,u=!1,d=!1)=>{let a=[],m=r[0].dims,h=m.length,g=V.normalizeAxes(n,h),w=!d&&g.length===0;m.forEach((I,S)=>{w||g.indexOf(S)>=0?u&&a.push(1):a.push(I)});let v=a.length,y=V.size(a);return{name:e,shaderCache:t,getShaderSource:I=>{let S=[],_=M("_A",r[0].dataType,h),P=j("output",s,v),A=o(_,P,g),z=A[2];for(let R=0,N=0;R<h;R++)w||g.indexOf(R)>=0?(u&&N++,z=`for(var j${R}: u32 = 0; j${R} < ${m[R]}; j${R}++) {\n                  ${A[2].includes("last_index")?`let last_index = j${R};`:""}\n                  ${_.indicesSet("input_indices",R,`j${R}`)}\n                  ${z}\n                }`):(S.push(`${_.indicesSet("input_indices",R,P.indicesGet("output_indices",N))};`),N++);return`\n\n        ${I.registerUniform("output_size","u32").declareVariables(_,P)}\n\n        ${I.mainStart()}\n          ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${_.type.indices};\n          let output_indices = ${P.offsetToIndices("global_idx")};\n\n          ${S.join(`\n`)}\n          ${A[0]}       // init ops for reduce max/min\n          ${A[1]}\n          ${z}\n          ${A[3]}\n          ${A.length===4?P.setByOffset("global_idx","value"):A.slice(4).join(`\n`)}\n        }`},getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:[{type:"uint32",data:y},...F(m),...F(a)]})}},jn=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>r.push(Number(o))),ge({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},mt=(e,t,r,o)=>{let n=e.inputs,s=n.length===1?r:jn(n,r);e.compute(rn(t,{hint:s.cacheKey,inputDependencies:["rank"]},[n[0]],s.noopWithEmptyAxes&&s.axes.length===0?Ul:o,s.axes,n[0].dataType,s.keepDims,s.noopWithEmptyAxes),{inputs:[0]})},zl=(e,t)=>{pt(e.inputs),mt(e,"ReduceLogSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,"value = log(value);"])},Vl=(e,t)=>{pt(e.inputs),mt(e,"ReduceL1",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += abs(${o.getByIndices("input_indices")});`,""])},Nl=(e,t)=>{pt(e.inputs),mt(e,"ReduceL2",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Wl=(e,t)=>{pt(e.inputs),mt(e,"ReduceLogSumExp",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += exp(${o.getByIndices("input_indices")});`,"value = log(value);"])},Hl=(e,t)=>{pt(e.inputs),mt(e,"ReduceMax",t,(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(o.indicesSet("input_indices",d,0));return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = max(value, ${o.getByIndices("input_indices")});`,""]})},Gl=(e,t)=>{pt(e.inputs),mt(e,"ReduceMean",t,(o,n,s)=>{let u=1;for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&(u*=e.inputs[0].dims[d]);return["var sum = f32(0);","",`sum += f32(${o.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${u});`]})},Ll=(e,t)=>{pt(e.inputs),mt(e,"ReduceMin",t,(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(`input_indices[${d}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = min(value, ${o.getByIndices("input_indices")});`,""]})},Fl=(e,t)=>{pt(e.inputs),mt(e,"ReduceProd",t,(o,n)=>[`var value = ${n.type.storage}(1);`,"",`value *= ${o.getByIndices("input_indices")};`,""])},jl=(e,t)=>{pt(e.inputs),mt(e,"ReduceSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,""])},ql=(e,t)=>{pt(e.inputs),mt(e,"ReduceSumSquare",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += t * t;`,""])},ft=(e,t,r)=>{if(t.length===0)return r;let o=1,n=1;for(let s=0;s<t.length;s++)t.indexOf(s)===-1?o*=e[s]:n*=e[s];return n<32&&o>1024},za=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Gl(e,t):Aa(e,t)},Va=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Vl(e,t):Ta(e,t)},Na=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Nl(e,t):Ea(e,t)},Wa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Wl(e,t):Oa(e,t)},Ha=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Hl(e,t):Pa(e,t)},Ga=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ll(e,t):ka(e,t)},La=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Fl(e,t):Ba(e,t)},Fa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jl(e,t):Ra(e,t)},ja=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?ql(e,t):Da(e,t)},qa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?zl(e,t):Ma(e,t)}});var Ka,Ya,Za,qn,Ja=q(()=>{"use strict";Ne();je();tn();Ka=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Ya=(e,t)=>{Ka(e.inputs);let r=(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(`input_indices[${d}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(rn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Za=(e,t)=>{Ka(e.inputs);let r=(o,n,s)=>{let u=[];for(let d=0;d<o.rank;d++)(s.indexOf(d)>=0||s.length===0)&&u.push(`input_indices[${d}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(rn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},qn=e=>ge(e)});var Kl,Yl,Zl,Jl,nn,Ql,Qa,Kn=q(()=>{"use strict";Ne();Yr();we();Kl=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],d=e[5];if(u&&d)throw new Error("Attention cannot have both past and relative_position_bias");if(r.dims.length!==3)throw new Error(\'Input "input" must have 3 dimensions\');let a=r.dims[0],m=r.dims[1],h=r.dims[2];if(n.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimensions\');if(o.dims.length!==2)throw new Error(\'Input "weights" is expected to have 2 dimensions\');if(o.dims[0]!==h)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(n.dims[0]!==o.dims[1])throw new Error(\'Input "bias" dimension 0 should have same length as dimension 1 of input "weights"\');let g=n.dims[0]/3,w=g,v=w;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let P of t.qkvHiddenSizes)if(P%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");g=t.qkvHiddenSizes[0],w=t.qkvHiddenSizes[1],v=t.qkvHiddenSizes[2]}let y=m;if(g!==w)throw new Error("qkv_hidden_sizes first element should be same as the second");if(n.dims[0]!==g+w+v)throw new Error(\'Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes\');let C=0;if(u){if(w!==v)throw new Error(\'Input "past" expect k_hidden_size == v_hidden_size\');if(u.dims.length!==5)throw new Error(\'Input "past" must have 5 dimensions\');if(u.dims[0]!==2)throw new Error(\'Input "past" first dimension must be 2\');if(u.dims[1]!==a)throw new Error(\'Input "past" second dimension must be batch_size\');if(u.dims[2]!==t.numHeads)throw new Error(\'Input "past" third dimension must be num_heads\');if(u.dims[4]!==w/t.numHeads)throw new Error(\'Input "past" fifth dimension must be k_hidden_size / num_heads\');t.pastPresentShareBuffer||(C=u.dims[3])}let I=y+C,S=-1,_=0;if(s)throw new Error("Mask not supported");if(u)throw new Error("past is not supported");if(d)throw new Error("relativePositionBias is not supported");return{batchSize:a,sequenceLength:m,pastSequenceLength:C,kvSequenceLength:y,totalSequenceLength:I,maxSequenceLength:S,inputHiddenSize:h,hiddenSize:g,vHiddenSize:v,headSize:Math.floor(g/t.numHeads),vHeadSize:Math.floor(v/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:_,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Yl=(e,t,r,o)=>{let n=Fe(o),s=64,u=o/n;u<s?s=1:u/8<64&&(s=Math.ceil(u/8));let d=Math.ceil(o/n/s),m=[{type:et(t.dataType),data:1/o},{type:"uint32",data:u},{type:"uint32",data:d}],h=Le(t.dataType,n),g=w=>{let v=j("x",t.dataType,t.dims,n),y="thread_max_vector";n===2?y="max(thread_max_vector.x, thread_max_vector.y)":n===4&&(y="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");let C=dt(t.dataType),I=[{name:"d_inv",type:C},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return`\n  var<workgroup> wgMax: array<f32, ${s}>;\n  var<workgroup> wgSum: array<f32, ${s}>;\n  ${w.registerUniforms(I).declareVariables(v)}\n  ${w.mainStart([s,1,1])}\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ${Ze("f32",n,"-3.402823e+38f")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${it(C,n,"x[offset + i]")}, thread_max_vector);\n    }\n    wgMax[local_idx] = ${y};\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ${s}; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ${Ze("f32",n,"0")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(${it(C,n,"x[offset + i]")} - maxValue);\n    }\n    wgSum[local_idx] = ${tt("sumVector",n)};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${s}; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ${Ze("f32",n,"uniforms.d_inv")};\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ${it(C,n,"x[offset + i]")};\n        x[offset + i] = ${v.type.value}(exp(f32input - maxValue) / sum);\n      }\n    }\n  }`};e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:`${s};${h};${n}`},getShaderSource:g,getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:m})},{inputs:[t],outputs:[]})},Zl=(e,t,r,o,n,s)=>{let u=[n.batchSize,n.numHeads,n.sequenceLength,n.kvSequenceLength+n.pastSequenceLength],d=s.scale===0?1/Math.sqrt(n.headSize):s.scale,a=Fe(n.headSize),m=n.headSize/a,h=12,g={x:Math.ceil(n.totalSequenceLength/h),y:Math.ceil(n.sequenceLength/h),z:n.batchSize*n.numHeads},w=et(t.dataType),v=[{type:"uint32",data:n.sequenceLength},{type:"uint32",data:m},{type:"uint32",data:n.totalSequenceLength},{type:"uint32",data:n.kvSequenceLength},{type:w,data:d}],y=[t,r],C=S=>{let _=M("q",t.dataType,t.dims,a),P=M("key",r.dataType,r.dims,a),A=j("output",t.dataType,u),z=Le(t.dataType),R=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:z}];return`\n  const beta: ${z} = 1.0;\n  const TILE_SIZE = ${h}u;\n\n  var<workgroup> tileQ: array<${_.type.storage}, ${h*h}>;\n  var<workgroup> tileK: array<${_.type.storage}, ${h*h}>;\n  ${S.registerUniforms(R).declareVariables(_,P,A)}\n  ${S.mainStart([h,h,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${Ze(z,a)};\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ${tt("value",a)} * uniforms.alpha;\n    }\n  }`},I=e.compute({name:"AttentionProbs",shaderCache:{hint:`${a}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType,gpuDataType:0}],dispatchGroup:g,programUniforms:v}),getShaderSource:C},{inputs:y,outputs:[-1]})[0];return Yl(e,I,n.batchSize*n.numHeads*n.sequenceLength,n.totalSequenceLength),I},Jl=(e,t,r,o)=>{let n=[o.batchSize,o.sequenceLength,o.vHiddenSize],s=12,u={x:Math.ceil(o.vHeadSize/s),y:Math.ceil(o.sequenceLength/s),z:o.batchSize*o.numHeads},d=[{type:"uint32",data:o.sequenceLength},{type:"uint32",data:o.totalSequenceLength},{type:"uint32",data:o.vHeadSize},{type:"uint32",data:o.numHeads},{type:"uint32",data:o.vHiddenSize}],a=m=>{let h=M("probs",t.dataType,t.dims),g=M("v",r.dataType,r.dims),w=j("output",t.dataType,n),v=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`\n  const TILE_SIZE = ${s}u;\n  var<workgroup> tileQ: array<${h.type.value}, ${s*s}>;\n  var<workgroup> tileK: array<${h.type.value}, ${s*s}>;\n  ${m.registerUniforms(v).declareVariables(h,g,w)}\n  ${m.mainStart([s,s,1])}\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${h.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`};return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:t.dataType,gpuDataType:0}],dispatchGroup:u,programUniforms:d}),getShaderSource:a},{inputs:[t,r],outputs:[0]})[0]},nn=(e,t,r,o,n,s,u,d,a,m,h)=>{let g=Zl(e,t,r,a,m,h);Jl(e,g,o,m)},Ql=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],o=t.sequenceLength,n=t.inputHiddenSize,s=t.headSize,u=12,d={x:Math.ceil(t.headSize/u),y:Math.ceil(t.sequenceLength/u),z:t.batchSize*t.numHeads},a=[e.inputs[0],e.inputs[1],e.inputs[2]],m=[{type:"uint32",data:o},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],h=g=>{let w=j("output_q",a[0].dataType,r),v=j("output_k",a[0].dataType,r),y=j("output_v",a[0].dataType,r),C=M("input",a[0].dataType,a[0].dims),I=M("weight",a[1].dataType,a[1].dims),S=M("bias",a[2].dataType,a[2].dims),_=C.type.storage,P=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`\n  const TILE_SIZE = ${u}u;\n  var<workgroup> tileInput: array<${_}, ${u*u}>;\n  var<workgroup> tileWeightQ: array<${_}, ${u*u}>;\n  var<workgroup> tileWeightK: array<${_}, ${u*u}>;\n  var<workgroup> tileWeightV: array<${_}, ${u*u}>;\n  ${g.registerUniforms(P).declareVariables(C,I,S,w,v,y)}\n  ${g.mainStart([u,u,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${_}(0);\n    var valueK = ${_}(0);\n    var valueV = ${_}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:d,programUniforms:m}),getShaderSource:h},{inputs:a,outputs:[-1,-1,-1]})},Qa=(e,t)=>{let r=Kl(e.inputs,t),[o,n,s]=Ql(e,r);return nn(e,o,n,s,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}});var Xl,ed,td,Xa,ei=q(()=>{"use strict";Xt();$e();je();we();Xl=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(o,n,s)=>{let u=n.length;if(u!==o.length)throw new Error(`${s}: num dimensions != ${u}`);n.forEach((d,a)=>{if(d!==o[a])throw new Error(`${s}: dim[${a}] do not match`)})};if(e[0].dims.length>1){let o=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,o,"Invalid input scale"),r(e[2].dims,o,"Invalid input B"),r(e[3].dims,o,"Invalid input mean"),r(e[4].dims,o,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},ed=(e,t)=>{let{epsilon:r,spatial:o,format:n}=t,s=e[0].dims,u=o?Fe(s[s.length-1]):1,d=n==="NHWC"&&s.length>1?u:1,a=V.size(s)/u,m=Be(s.length)&&o,h=m?s.length:s,g=M("x",e[0].dataType,e[0].dims,u),w=M("scale",e[1].dataType,e[1].dims,d),v=M("bias",e[2].dataType,e[2].dims,d),y=M("inputMean",e[3].dataType,e[3].dims,d),C=M("inputVar",e[4].dataType,e[4].dims,d),I=j("y",e[0].dataType,h,u),S=()=>{let P="";if(o)P=`let cOffset = ${s.length===1?"0u":n==="NHWC"?`outputIndices[${s.length-1}] / ${u}`:"outputIndices[1]"};`;else if(n==="NCHW")P=`\n            ${I.indicesSet("outputIndices","0","0")}\n            let cOffset = ${I.indicesToOffset("outputIndices")};`;else{P=`var cIndices = ${w.type.indices}(0);\n                       cIndices[0] = outputIndices[${s.length-1}];`;for(let A=1;A<w.rank;A++)P+=`cIndices[${A}] = outputIndices[${A}];`;P+=`let cOffset = ${w.indicesToOffset("cIndices")};`}return P},_=P=>`\n  const epsilon = ${r};\n  ${P.registerUniform("outputSize","u32").declareVariables(g,w,v,y,C,I)}\n  ${P.mainStart()}\n  ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${I.offsetToIndices(`global_idx * ${u}`)};\n    ${S()}\n    let scale = ${w.getByOffset("cOffset")};\n    let bias = ${v.getByOffset("cOffset")};\n    let inputMean = ${y.getByOffset("cOffset")};\n    let inputVar = ${C.getByOffset("cOffset")};\n    let x = ${g.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${I.setByOffset("global_idx","value")}\n  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${o}_${u}`,inputDependencies:m?["rank","type","type","type","type"]:void 0},getShaderSource:_,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:m?[{type:"uint32",data:a},...F(s)]:[{type:"uint32",data:a}]})}},td=e=>ge(e),Xa=(e,t)=>{let{inputs:r,outputCount:o}=e,n=td({...t,outputCount:o});if(Qt.webgpu.validateInputContent&&Xl(r,n),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(ed(r,n))}});var rd,nd,ti,ri=q(()=>{"use strict";$e();we();rd=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},nd=e=>{let t=e[0].dims,r=e[0].dims[2],o=V.size(t)/4,n=e[0].dataType,s=M("input",n,t,4),u=M("bias",n,[r],4),d=M("residual",n,t,4),a=j("output",n,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:h=>`\n  const channels = ${r}u / 4;\n  ${h.declareVariables(s,u,d,a)}\n\n  ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let value = ${s.getByOffset("global_idx")}\n      + ${u.getByOffset("global_idx % channels")} + ${d.getByOffset("global_idx")};\n    ${a.setByOffset("global_idx","value")}\n  }`}},ti=e=>{rd(e.inputs),e.compute(nd(e.inputs))}});var od,Ae,ni,oi,ai,ii,si,ui,li,di,ci,ad,pi,mi,fi,hi,on,gi,an,yi,bi,wi,vi,$i,Si,xi,_i,Ci,Ii,Ai,Ti,Ei,Oi,Pi,ki,Bi,Yn=q(()=>{"use strict";Ne();$e();je();we();od=(e,t,r,o,n,s)=>{let u=Math.ceil(t/4),d="";typeof n=="string"?d=`${n}(a)`:d=n("a");let a=M("inputData",r,[u],4),m=j("outputData",o,[u],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(a,m)}\n\n  ${s??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${a.getByOffset("global_idx")};\n    ${m.setByOffset("global_idx",d)}\n  }`},Ae=(e,t,r,o,n,s=e.dataType)=>({name:t,shaderCache:{hint:n,inputDependencies:["type"]},getShaderSource:u=>od(u,V.size(e.dims),e.dataType,s,r,o),getRunData:u=>({outputs:[{dims:e.dims,dataType:s}],dispatchGroup:{x:Math.ceil(V.size(u[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(V.size(e.dims)/4)}]})}),ni=e=>{e.compute(Ae(e.inputs[0],"Abs","abs"))},oi=e=>{e.compute(Ae(e.inputs[0],"Acos","acos"))},ai=e=>{e.compute(Ae(e.inputs[0],"Acosh","acosh"))},ii=e=>{e.compute(Ae(e.inputs[0],"Asin","asin"))},si=e=>{e.compute(Ae(e.inputs[0],"Asinh","asinh"))},ui=e=>{e.compute(Ae(e.inputs[0],"Atan","atan"))},li=e=>{e.compute(Ae(e.inputs[0],"Atanh","atanh"))},di=e=>ge(e),ci=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute \'to\' from \'Cast\' operator): ${t.to}`)}e.compute(Ae(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},ad=e=>{let t=e.length>=2&&e[1].data!==0?e[1].getFloat32Array()[0]:Qr,r=e.length>=3&&e[2].data!==0?e[2].getFloat32Array()[0]:Xr;return ge({min:t,max:r})},pi=(e,t)=>{let r=e.inputs.length===1?t:ad(e.inputs),o=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Clip",n=>`clamp(${n}, clip_min_, clip_max_)`,`\n    const clip_min_: vec4<${o}> = vec4(${o}(${r.min}));\n    const clip_max_: vec4<${o}> = vec4(${o}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},mi=e=>{e.compute(Ae(e.inputs[0],"Ceil","ceil"))},fi=e=>{e.compute(Ae(e.inputs[0],"Cos","cos"))},hi=e=>{e.compute(Ae(e.inputs[0],"Cosh","cosh"))},on=e=>ge(e),gi=(e,t)=>{let r=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},an=(e,t="f32")=>`\nconst r0: ${t} = 0.3275911;\nconst r1: ${t} = 0.254829592;\nconst r2: ${t} = -0.284496736;\nconst r3: ${t} = 1.421413741;\nconst r4: ${t} = -1.453152027;\nconst r5: ${t} = 1.061405429;\n\nfn erf_vf32(v: ${e}) -> ${e} {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,yi=e=>{let t=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,an(`vec4<${t}>`,t)))},bi=e=>{e.compute(Ae(e.inputs[0],"Exp","exp"))},wi=e=>{e.compute(Ae(e.inputs[0],"Floor","floor"))},vi=e=>{let t=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,an(`vec4<${t}>`,t)))},$i=(e,t)=>{let r=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},Si=e=>{e.compute(Ae(e.inputs[0],"Not",t=>`!${t}`))},xi=e=>{e.compute(Ae(e.inputs[0],"Neg",t=>`-${t}`))},_i=e=>{e.compute(Ae(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},Ci=e=>{let t=dt(e.inputs[0].dataType);e.compute(Ae(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},Ii=e=>{e.compute(Ae(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},Ai=e=>{e.compute(Ae(e.inputs[0],"Sin","sin"))},Ti=e=>{e.compute(Ae(e.inputs[0],"Sinh","sinh"))},Ei=e=>{e.compute(Ae(e.inputs[0],"Sqrt","sqrt"))},Oi=e=>{e.compute(Ae(e.inputs[0],"Tan","tan"))},Pi=e=>{e.compute(Ae(e.inputs[0],"Tanh","tanh"))},ki=(e,t)=>{let r=dt(e.inputs[0].dataType);return e.compute(Ae(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${r}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},Bi=e=>{e.compute(Ae(e.inputs[0],"Log","log"))}});var sd,ud,Ri,Di=q(()=>{"use strict";$e();we();Yn();sd=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},ud=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=M("input",e[0].dataType,e[0].dims,4),o=M("bias",e[0].dataType,[e[0].dims[2]],4),n=j("output",e[0].dataType,t,4),s=V.size(t)/4,u=Le(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:a=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${a.declareVariables(r,o,n)}\n\n  ${an(`vec4<${u}>`,u)}\n\n  ${a.mainStart()}\n    ${a.guardAgainstOutOfBoundsWorkgroupSizes(s)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${n.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},Ri=e=>{sd(e.inputs),e.compute(ud(e.inputs))}});var ld,dd,ht,Mi,Ui,zi,Vi,Ni,Wi,Hi,Gi,Li,Fi,ji=q(()=>{"use strict";Ne();$e();we();ld=(e,t,r,o,n,s,u,d,a,m,h,g,w)=>{let v,y;typeof d=="string"?v=y=(R,N)=>`${d}((${R}),(${N}))`:typeof d=="function"?v=y=d:(v=d.scalar,y=d.vector);let C=g?t.length:t,I=g?r.length:r,S=g?o.length:o,_=j("outputData",h,S,4),P=M("aData",a,C,4),A=M("bData",m,I,4),z;if(n)if(s){let R=V.size(t)===1,N=V.size(r)===1,T=t.length>0&&t[t.length-1]%4===0,H=r.length>0&&r[r.length-1]%4===0;R||N?z=_.setByOffset("global_idx",y(R?`${P.type.value}(${P.getByOffset("0")}.x)`:P.getByOffset("global_idx"),N?`${A.type.value}(${A.getByOffset("0")}.x)`:A.getByOffset("global_idx"))):z=`\n            let outputIndices = ${_.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${P.broadcastedIndicesToOffset("outputIndices",_)};\n            let offsetB = ${A.broadcastedIndicesToOffset("outputIndices",_)};\n            ${_.setByOffset("global_idx",y(u||T?P.getByOffset("offsetA / 4u"):`${P.type.value}(${P.getByOffset("offsetA / 4u")}[offsetA % 4u])`,u||H?A.getByOffset("offsetB / 4u"):`${A.type.value}(${A.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else z=_.setByOffset("global_idx",y(P.getByOffset("global_idx"),A.getByOffset("global_idx")));else{if(!s)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let R=(N,T,H="")=>{let ie=`aData[indexA${T}][componentA${T}]`,Z=`bData[indexB${T}][componentB${T}]`;return`\n            let outputIndices${T} = ${_.offsetToIndices(`global_idx * 4u + ${T}u`)};\n            let offsetA${T} = ${P.broadcastedIndicesToOffset(`outputIndices${T}`,_)};\n            let offsetB${T} = ${A.broadcastedIndicesToOffset(`outputIndices${T}`,_)};\n            let indexA${T} = offsetA${T} / 4u;\n            let indexB${T} = offsetB${T} / 4u;\n            let componentA${T} = offsetA${T} % 4u;\n            let componentB${T} = offsetB${T} % 4u;\n            ${N}[${T}] = ${H}(${v(ie,Z)});\n          `};h===9?z=`\n            var data = vec4<u32>(0);\n            ${R("data",0,"u32")}\n            ${R("data",1,"u32")}\n            ${R("data",2,"u32")}\n            ${R("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:z=`\n            ${R("outputData[global_idx]",0)}\n            ${R("outputData[global_idx]",1)}\n            ${R("outputData[global_idx]",2)}\n            ${R("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(P,A,_)}\n\n        ${w??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${z}\n      }`},dd=(e,t,r,o,n,s,u=r.dataType)=>{let d=!V.areEqual(r.dims,o.dims),a=r.dims,m=V.size(r.dims),h=!1,g=!1,w=[d];if(d){let y=lt.calcShape(r.dims,o.dims,!1);if(!y)throw new Error("Can\'t perform binary op on the given tensors");a=y,m=V.size(a);let C=V.size(r.dims)===1,I=V.size(o.dims)===1,S=r.dims.length>0&&r.dims[r.dims.length-1]%4===0,_=o.dims.length>0&&o.dims[o.dims.length-1]%4===0;w.push(C),w.push(I),w.push(S),w.push(_);let P=1;for(let A=1;A<a.length;A++){let z=r.dims[r.dims.length-A]??1,R=o.dims[o.dims.length-A]??1;if(z===R)P*=z;else break}P%4===0?(g=!0,h=!0):(C||I||S||_)&&(h=!0)}else h=!0;w.push(h);let v=Be(r.dims.length)&&Be(o.dims.length)&&Be(a.length);return{name:e,shaderCache:{hint:t+w.map(y=>y.toString()).join("_"),inputDependencies:v?["rank","rank"]:["dims","dims"]},getShaderSource:y=>ld(y,r.dims,o.dims,a,h,d,g,n,r.dataType,o.dataType,u,v,s),getRunData:()=>({outputs:[{dims:a,dataType:u}],dispatchGroup:{x:Math.ceil(m/64/4)},programUniforms:v?[{type:"uint32",data:Math.ceil(V.size(a)/4)},...F(r.dims),...F(o.dims),...F(a)]:[{type:"uint32",data:Math.ceil(V.size(a)/4)}]})}},ht=(e,t,r,o,n,s)=>{e.compute(dd(t,n??"",e.inputs[0],e.inputs[1],r,o,s))},Mi=e=>{ht(e,"Add",(t,r)=>`${t}+${r}`)},Ui=e=>{ht(e,"Div",(t,r)=>`${t}/${r}`)},zi=e=>{ht(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},Vi=e=>{ht(e,"Mul",(t,r)=>`${t}*${r}`)},Ni=e=>{let t=M("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;ht(e,"Pow",{scalar:(o,n)=>`pow_custom(${o},${n})`,vector:(o,n)=>`pow_vector_custom(${o},${n})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},Wi=e=>{ht(e,"Sub",(t,r)=>`${t}-${r}`)},Hi=e=>{ht(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},Gi=e=>{ht(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},Li=e=>{ht(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},Fi=e=>{ht(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}});var pd,md,fd,hd,qi,Ki,Yi=q(()=>{"use strict";$e();je();we();pd=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].dataType,r=e[0].dims.length;for(let o of e){if(o.dataType!==t)throw new Error("input tensors should be one type");if(o.dims.length!==r)throw new Error("input tensors should have the same shape")}},md=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,fd=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;++n){let s=t.setByOffset("global_idx",e[n].getByIndices("indices"));r===1?o.push(s):n===0?o.push(`if (inputIndex == ${n}u) { ${s} }`):n===r-1?o.push(`else { ${s} }`):o.push(`else if (inputIndex == ${n}) { ${s} }`)}return o.join(`\n`)},hd=(e,t)=>{let r=e[0].dims.slice();if(t>=r.length||t<-1*r.length)throw new Error("axis specified for concat doesn\'t match input dimensionality");let o=t<0?r.length+t:t,n=r.slice(0);for(let A=1;A<e.length;A++){let z=e[A].dims.slice();for(let R=0;R<r.length;R++)if(R===o)n[o]+=z[R];else if(r[R]!==z[R])throw new Error("non concat dimensions must match")}let s=V.size(n),u=new Array(e.length),d=new Array(e.length),a=e[0].dataType,m=0,h=[],g=[],w=[],v=[{type:"uint32",data:s}];for(let A=0;A<e.length;++A)m+=e[A].dims[o],u[A]=m,w.push(Be(e[A].dims.length)),g.push(w[A]?e[A].dims.length:e[A].dims),d[A]=M(`input${A}`,a,g[A]),h.push(w[A]?"rank":"dims"),v.push({type:"uint32",data:u[A]});for(let A=0;A<e.length;++A)w[A]&&v.push(...F(e[A].dims));let y=Be(n.length);y&&v.push(...F(n));let C=y?n.length:n,I=j("output",a,C),S=I.indicesGet("indices",o),_=Array.from(Array(u.length).keys()).map(A=>`uniforms.sizeInConcatAxis${A}`).join(","),P=A=>`\n\n  ${(()=>{A.registerUniform("outputSize","u32");for(let z=0;z<e.length;z++)A.registerUniform(`sizeInConcatAxis${z}`,"u32");return A.declareVariables(...d,I)})()}\n\n  ${md(u.length,_)}\n\n  ${A.mainStart()}\n    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${I.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${S});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${u.length}u>(${_});\n      ${S} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${fd(d,I)}\n  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:v}),getShaderSource:P}},qi=(e,t)=>{pd(e.inputs),e.compute(hd(e.inputs,t.axis))},Ki=e=>ge({axis:e.axis})});var gt,sn,At=q(()=>{"use strict";$e();gt=(e,t)=>{switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:`value = max(value, ${t}(0.0));`};case"Sigmoid":return{activationFunction:"",applyActivation:`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`};case"Clip":return{activationFunction:`const clip_min_=${t}(${e.clipMin});const clip_max_=${t}(${e.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},sn=e=>{let t=e?.activation||"";if(t==="Clip"){let[r,o]=e?.activation_params||[Qr,Xr];return{activation:t,clipMax:o,clipMin:r,activationCacheKey:`${t}:${r},${o}`}}return{activation:t,activationCacheKey:t}}});var Ke,un,ln=q(()=>{"use strict";Ke=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},un=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `});var dn,Zn=q(()=>{"use strict";dn=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`});var gd,yd,xr,Zi,bd,_r,wd,cn,Cr=q(()=>{"use strict";$e();we();At();ln();gd=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,yd=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,xr=(e,t,r="f32",o,n=!1,s=32,u=!1,d=32)=>{let a=t[1]*e[1],m=t[0]*e[0],h=n?a:s,g=n?s:a,w=h/t[0],v=s/t[1];if(!((n&&w===4&&e[1]===4||!n&&(w===3||w===4))&&h%t[0]===0&&s%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${n} is true, innerElementSize ${w} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${w} must be 3 or 4.\n  tileAWidth ${h} must be divisible by workgroupSize[0]${t[0]}. tileInner ${s} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${w}<${r}>, ${h/w}>, ${g}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${m/e[0]}>, ${s}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${w};\nconst tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${u?"0":"i32(globalId.z)"};\n  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${a};\n\n  let numTiles = ${u?`${Math.ceil(d/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n  var kStart = ${u?`i32(globalId.z) * ${d}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${v};\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${gd(n,o)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${w===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${yd(n,w)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},Zi=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,bd=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",_r=(e,t,r="f32",o,n=!1,s=32,u=!1,d=32,a=!1)=>{let m=e[1]*t[1],h=e[0]*t[0],g=n?m:s,w=n?s:m;if(!(w%t[1]===0&&g%t[0]===0&&s%t[1]===0))throw new Error(`tileAHight ${w} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${g} must be divisible by workgroupSize[0]${t[0]}, tileInner ${s} must be divisible by workgroupSize[1]${t[1]}`);let v=w/t[1],y=g/t[0],C=s/t[1],I=a?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${m};\n    let globalColStart = i32(workgroupId.x) * ${h};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${w}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${g}; inputCol = inputCol + ${t[0]}) {\n          ${Zi(n,o)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${s}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${h}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${o?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${m};\n\nlet tileRowA = i32(localId.y) * ${v};\nlet tileColA = i32(localId.x) * ${y};\nlet tileRowB = i32(localId.y) * ${C};\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${y}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${Zi(n,o)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${C}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${o?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${bd(n)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${g}>, ${w}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${h}>, ${s}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${u?"0":"i32(globalId.z)"};\n    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n    let numTiles = ${u?`${Math.ceil(d/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n    var kStart = ${u?`i32(globalId.z) * ${d}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${I}\n  }\n`},wd=(e,t,r,o,n,s=!1)=>{let[u,d,a]=n,[m,h,g,w]=o,v=er(u,a),y=er(d,a),C=Le(o[0].type.tensor),I=()=>{let P=h.rank,A=m.rank,z=`var aIndices: ${h.type.indices};`;for(let R=P-2-1,N=A-1;R>=0;R--,N--)z+=`\naIndices[${R}] = ${A>1?`batchIndices[${N}]`:"batchIndices"};`;return v.forEach(R=>{z+=`\naIndices[${R}] = 0;`}),z+=`\naIndices[${P-2}] = u32(row);\n                   aIndices[${P-1}] = u32(colIn);`,z},S=()=>{let P=g.rank,A=m.rank,z=`var bIndices: ${g.type.indices};`;for(let R=P-2-1,N=A-1;R>=0;R--,N--)z+=`\nbIndices[${R}] = ${A>1?`batchIndices[${N}]`:"batchIndices"};`;return y.forEach(R=>{z+=`\nbIndices[${R}] = 0;`}),z+=`\nbIndices[${P-2}] = u32(row);\n                   bIndices[${P-1}] = u32(colIn);`,z};return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${m.type.indices}) -> ${Ke(e,C)} {\n      var value = ${Ke(e,C)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ${I()}\n        value = ${h.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${m.type.indices}) -> ${Ke(e,C)} {\n      var value = ${Ke(e,C)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ${S()}\n        value = ${g.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Ke(e,C)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${s?"bias[colIn]":`${Ke(e,C)}(bias[row])`};`:""}\n        ${r}\n        ${w.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},cn=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,d=s.slice(0,-2),a=u.slice(0,-2),m=o?o.slice(0,-2):r.slice(0,-2),h=Be(m.length),g=h?m.length:m,w=en("batchDims",e[0].dataType,g,1),v=V.size(m),y=s[s.length-2],C=s[s.length-1],I=u[u.length-1],S=C%4===0&&I%4===0,_=y<=8?[4,1,1]:[4,4,1],P=[8,8,1],A=[Math.ceil(I/P[0]/_[0]),Math.ceil(y/P[1]/_[1]),Math.ceil(v/P[2]/_[2])],z=Le(e[0].dataType),R=S?4:1,N=[...d,y,C/R],T=Be(N.length),H=T?N.length:N,ie=[...a,C,I/R],Z=Be(ie.length),K=Z?ie.length:ie,Q=[v,y,I/R],X=M("a",e[0].dataType,H,R),Ee=M("b",e[1].dataType,K,R),Pe=j("result",e[0].dataType,Q.length,R),fe=[X,Ee],Ce=[{type:"int32",data:y},{type:"int32",data:I},{type:"int32",data:C}];h&&Ce.push(...F(m)),T&&Ce.push(...F(N)),Z&&Ce.push(...F(ie));let he=[];he.push(T?"rank":"dims"),he.push(Z?"rank":"dims");let ye=e.length>2,{activationFunction:We,applyActivation:Me}=gt(t,Pe.type.value),Ge=wd(R,ye,Me,[w,X,Ee,Pe],[d,a,m],n);if(ye){let re=n?R:1;fe.push(M("bias",e[2].dataType,e[2].dims.length,re)),Ce.push(...F(e[2].dims)),he.push("rank")}Ce.push(...F(Q));let G=re=>`\n  ${re.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(w).declareVariables(...fe,Pe)}\n  ${We}\n  ${Ge}\n  ${S?xr(_,P,z,w):_r(_,P,z,w)}\n                   `;return{name:"MatMul",shaderCache:{hint:t.activationCacheKey+`${_}${S}${n}`,inputDependencies:he},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:A[0],y:A[1],z:A[2]},programUniforms:Ce}),getShaderSource:G}}});var vd,Ji,Qi=q(()=>{"use strict";It();we();At();ln();Zn();Cr();vd=(e,t,r,o,n=!1,s,u=4,d=4,a=4,m="f32")=>{let h=Z=>{switch(Z){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${m}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${Z} is not supported.`)}},g=Z=>{switch(Z){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${Z} is not supported.`)}},w=e?`\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    `:`\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    `,v=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,y=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",C=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",I=e?"row":"col",S=e?"col":"row",_=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${I} / outWidth;\n    let outCol = ${I} % outWidth;\n\n    let WRow = ${S} / (filterDims[1] * inChannels);\n    let WCol = ${S} / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ${S} % inChannels;\n    var resData = ${Ke(u,m)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the \'same\' padding type.\n    if (xRow >= 0 && xRow < ${y} && xCol >= 0 && xCol < ${C}) {\n      ${w}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${h(u)}\n    }\n    return resData;`,P=e?t&&o?`\n    let col = colIn * ${u};\n    ${_}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ${_}\n    }\n    return ${Ke(u,m)}(0.0);`:o&&r?`\n    let col = colIn * ${u};\n    ${_}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ${_}\n    }\n    return ${Ke(u,m)}(0.0);`,A=`${g(d)}`,z=Ke(a,m),R=e?Ke(u,m):Ke(d,m),N=e?Ke(d,m):Ke(u,m),{activationFunction:T,applyActivation:H}=gt(s,z);return`\n    ${T}\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${R} {\n      ${e?P:A}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${N} {\n      ${e?A:P}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${z}) {\n      let col = colIn * ${a};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${v}\n      ${un(n)}\n      ${H}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},Ji=(e,t,r,o,n,s,u,d)=>{let a=t.format==="NHWC",m=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a&&(m%4===0||m%3===0)&&v%4===0,C=a?v:g*w,I=a?g*w:v,S=[8,8,1],_=o<=8?[4,1,1]:[4,4,1],P=[Math.ceil(C/S[0]/_[0]),Math.ceil(I/S[1]/_[1]),Math.ceil(h/S[2]/_[2])];De("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${P}`);let A=y?a&&m%4!==0?3:4:1,z=S[1]*_[1],R=S[0]*_[0],N=Math.max(S[0]*A,S[1]),T=o%z===0,H=n%R===0,ie=s%N===0,Z=y?[A,4,4]:[1,1,1],K=Le(e[0].dataType),Q=y?4:1,X=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],Ee=M("x",e[0].dataType,e[0].dims.length,A===3?1:A),Pe=M("w",e[1].dataType,e[1].dims.length,Q),fe=[Ee,Pe];X.push(...F(e[0].dims)),X.push(...F(e[1].dims));let Ce=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${y?`vec4<${K}>`:K}) {\n        result[flatIndex] = ${y?`vec4<${K}>`:K}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${y?`vec4<${K}>`:K}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${y?"/ 4":""}, value);\n      }`;if(u){let ye=M("bias",e[2].dataType,e[2].dims.length,Q);fe.push(ye),X.push(...F(e[2].dims)),Ce+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?`vec4<${K}>`:K} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}let he=j("result",e[0].dataType,r.length,Q);return X.push(...F(r)),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:P[0],y:P[1],z:P[2]},programUniforms:X}),getShaderSource:ye=>`\n        ${dn("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${ye.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...fe,he)}\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[0]}, ${t.kernelShape[1]});\n        const pad : vec2<i32> = vec2<i32>(${t.pads[0]}, ${t.pads[1]});\n        const stride : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        ${Ce}\n        ${vd(a,T,H,ie,u,t,Z[0],Z[1],Z[2],K)}\n            ${y?xr(_,S,K,void 0,!a,N):_r(_,S,K,void 0,!a,N,!1,void 0,d)}`}}});var Jn,Xi=q(()=>{"use strict";$e();we();Xn();At();Jn=(e,t,r)=>{let o=e.length>2,n=o?"value += b[output_channel];":"",s=e[0].dims,u=e[1].dims,d=u[0]/t.group,a=t.format==="NHWC",m=Qn(s,u,t.dilations,t.pads,t.strides,a),h=V.size(m),g=j("output",e[0].dataType,m),{activationFunction:w,applyActivation:v}=gt(t,g.type.value),y=M("x",e[0].dataType,s),C=M("w",e[1].dataType,u),I=[y,C];o&&I.push(M("b",e[2].dataType,e[2].dims));let S=_=>`\n  const strides: vec2<u32> = vec2(${t.strides[0]}u, ${t.strides[1]}u);\n  const pads: vec2<u32> = vec2(${t.pads[0]}u, ${t.pads[1]}u);\n\n  ${_.declareVariables(...I,g)}\n\n  ${w}\n\n  ${_.mainStart()}\n    ${_.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n    let outputIndices = ${g.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${a?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${a?1:2}], outputIndices[${a?2:3}]) * strides - pads;\n    let group_id: u32 = output_channel / ${d}u;\n\n    var value: ${g.type.value} = ${g.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ${u[1]}u; wInChannel++) {\n      let input_channel = group_id * ${u[1]}u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ${u[2]}u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ${t.dilations[0]}u;\n\n        if (xHeight < 0u || xHeight >= ${s[a?1:2]}u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ${u[3]}u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ${t.dilations[1]}u;\n          if (xWidth < 0u || xWidth >= ${s[a?2:3]}u) {\n            continue;\n          }\n\n          let xVal = ${a?y.get("batch","xHeight","xWidth","input_channel"):y.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${C.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${n}\n    ${v}\n    ${g.setByOffset("global_idx","value")}\n  }`;return{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r?r(m):m,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:S}}});var eo,$d,es,to=q(()=>{"use strict";$e();Cr();we();At();eo=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,d=s[s.length-2],a=u[u.length-1],m=s[s.length-1],h=Fe(a),g=Fe(m),w=Fe(d),v=V.size(r)/h/w,y=e.length>2,C=o?o.slice(0,-2):r.slice(0,-2),S=[V.size(C),d,a],_=[{type:"uint32",data:v},{type:"uint32",data:d},{type:"uint32",data:a},{type:"uint32",data:m},...F(C),...F(s),...F(u)];y&&_.push(...F(e[2].dims)),_.push(...F(S));let P=A=>{let z=en("batch_dims",e[0].dataType,C.length),R=M("a",e[0].dataType,s.length,g),N=M("b",e[1].dataType,u.length,h),T=j("output",e[0].dataType,S.length,h),{activationFunction:H,applyActivation:ie}=gt(t,T.type.value),Z=[R,N],K="";if(y){let he=n?h:1;Z.push(M("bias",e[2].dataType,e[2].dims.length,he)),K=`${n?`value += bias[col / ${he}];`:`value += ${T.type.value}(bias[row + i]);`}`}let Q=s.slice(0,-2),X=u.slice(0,-2),Ee=er(Q,C),Pe=er(X,C),fe=(he,ye)=>{let We=he.rank,Me=he.name;if(We===2)return`var ${Me}_indices = ${he.type.indices}(0u, 0u);`;let Ge=z.rank,G=`var ${Me}_indices: ${he.type.indices};`;for(let re=We-2-1,be=Ge-1;re>=0;re--,be--)G+=`\n${Me}_indices[${re}] = ${Ge>1?`batch_indices[${be}]`:"batch_indices"};`;return ye.forEach(re=>{G+=`\n${Me}_indices[${re}] = 0;`}),G+=`${Me}_indices[${We-2}] = 0u;\n                     ${Me}_indices[${We-1}] = 0u;`,G},Ce=()=>{let he=`var a_data: ${R.type.value};`;for(let ye=0;ye<g;ye++)he+=`\n              let b_data${ye} = b[(b_offset + (k + ${ye}) * uniforms.N + col) / ${h}];`;for(let ye=0;ye<w;ye++){he+=`a_data = a[(a_offset + (row + ${ye}) * uniforms.K + k) / ${g}];`;for(let We=0;We<g;We++)he+=`\n            values[${ye}] = fma(${N.type.value}(a_data${g===1?"":`[${We}]`}), b_data${We}, values[${ye}]);\n`}return he};return`\n  ${A.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(z).declareVariables(...Z,T)}\n  ${H}\n  ${A.mainStart()}\n    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    let col = (global_idx % (uniforms.N / ${h})) * ${h};\n    var index1 = global_idx / (uniforms.N / ${h});\n    let stride1 = uniforms.M / ${w};\n    let row = (index1 % stride1) * ${w};\n    let batch = index1 / stride1;\n\n    ${r.length===2?"":`let batch_indices = ${z.offsetToIndices("batch")};`}\n    ${fe(R,Ee)}\n    let a_offset = ${R.indicesToOffset("a_indices")};\n    ${fe(N,Pe)}\n    let b_offset = ${N.indicesToOffset("b_indices")};\n    var values: array<${T.type.value}, ${w}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${g}) {\n      ${Ce()}\n    }\n    for (var i = 0u; i < ${w}u; i++) {\n      var value = values[i];\n      ${K}\n      ${ie}\n      let cur_indices = ${T.type.indices}(batch, row + i, col);\n      let offset = ${T.indicesToOffset("cur_indices")};\n      ${T.setByOffset(`offset / ${h}`,"value")};\n    }\n  }\n  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activationCacheKey}_${h}_${g}_${w}_${n}`,inputDependencies:y?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:_}),getShaderSource:P}},$d=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},es=e=>{$d(e.inputs);let t=lt.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can\'t use matmul on the given tensors");let r=t[t.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&o<8?e.compute(eo(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(cn(e.inputs,{activation:"",activationCacheKey:""},t))}});var Qn,ts,Sd,rs,ro,xd,_d,no,Xn=q(()=>{"use strict";$e();je();Qi();Cr();Xi();At();to();tr();Qn=(e,t,r,o,n,s)=>{let u=e[0],d=e.slice(s?1:2,s?3:4),a=d.length,m=t[0],g=t.slice(2).map((y,C)=>y+(y-1)*(r[C]-1)),v=d.map((y,C)=>y+o[C]+o[C+a]).map((y,C)=>Math.floor((y-g[C]+n[C])/n[C]));return v.splice(0,0,u),v.splice(s?3:1,0,m),v},ts=[2,3,1,0],Sd=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*t.group;if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==n*2)throw new Error(`pads should be ${n*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},rs=(e,t)=>{let r=e.kernelShape.slice();for(let s=2;s<t[1].dims.length;++s)r[s-2]===0&&(r[s-2]=t[1].dims[s]);let o=e.pads.slice();Ut.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,o,e.format==="NHWC",e.autoPad);let n=Object.assign({},e);return Object.assign(n,{kernelShape:r,pads:o,cacheKey:e.cacheKey}),n},ro=e=>{let t=sn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],n=e.dilations,s=e.group,u=e.kernel_shape,d=e.pads,a=e.strides,m=e.w_is_const();return ge({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,pads:d,strides:a,wIsConst:m,...t})},xd=(e,t,r)=>{let o=rs(r,t),n=r.format==="NHWC";if(r.group!==1){e.compute(Jn(t,o));return}let s=t.length===3,u=t[0].dims[n?1:2],d=t[0].dims[n?2:3],a=t[0].dims[n?3:1],m=t[1].dims[2],h=t[1].dims[3],g=Qn(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,n),w=g[n?1:2],v=g[n?2:3],y=g[n?3:1],C=n&&m===u&&h===d&&r.pads[0]===0&&r.pads[1]===0;if(C||m===1&&h===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let R=g[0],N,T,H,ie=[];if(n){let Q=e.kernelCustomData.wT??e.compute(st(t[1],ts),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=Q),C){let X=u*d*a;N=t[0].reshape([1,R,X]),T=Q.reshape([1,X,y]),H=[1,R,y]}else N=t[0].reshape([R,u*d,a]),T=Q.reshape([1,a,y]),H=[R,w*v,y];ie.push(N),ie.push(T)}else N=t[0].reshape([R,a,u*d]),T=t[1].reshape([1,y,a]),H=[R,y,w*v],ie.push(T),ie.push(N);s&&ie.push(t[2]);let Z=H[2],K=ie[0].dims[ie[0].dims.length-1];Z<8&&K<8?e.compute(eo(ie,o,g,H,n),{inputs:ie}):e.compute(cn(ie,o,g,H,n),{inputs:ie});return}let I=!0,S=e.kernelCustomData.wT??e.compute(st(t[1],ts),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=S);let _=[t[0],S];s&&_.push(t[2]);let P=n?w*v:y,A=n?y:w*v,z=m*h*a;e.compute(Ji(_,o,g,P,A,z,s,I),{inputs:_})},_d=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let n=[0,t.pads[0],0,t.pads[1]],s=[1].concat(t.strides),u=[1].concat(t.dilations),d=[1].concat(t.kernelShape),a=rs({...t,pads:n,strides:s,dilations:u,kernelShape:d},o);e.compute(Jn(o,a,m=>r?[m[0],m[2],m[3]]:[]))},no=(e,t)=>{Sd(e.inputs,t),e.inputs[0].dims.length===3?_d(e,t):xd(e,e.inputs,t)}});var Cd,ns,os=q(()=>{"use strict";It();we();At();ln();Zn();Cr();Cd=(e,t=!1,r,o=4)=>{let n=Ke(o,"f32"),s=_=>{switch(_){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            `;default:throw new Error(`innerElementSize ${_} is not supported.`)}},u=e?`\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      `:`\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      `,d=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,a=e?"outBackprop[1]":"outBackprop[2]",m=e?"outBackprop[2]":"outBackprop[3]",h=e?"row":"col",g=e?"col":"row",w=`\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${h} / outWidth;\n      let outCol = ${h} % outWidth;\n\n      let WRow = ${g} / (filterDims[1] * inChannels);\n      let WCol = ${g} / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(${a}) || fract(xR) > 0.0) {\n        return ${n}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${m}) || fract(xC) > 0.0) {\n        return ${n}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${g} % inChannels;\n      ${u}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${o}];`,v=e?`\n      let col = colIn * ${o};\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ${w}\n      }\n      return ${n}(0.0);`:`\n      let col = colIn * ${o};\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ${w}\n      }\n      return ${n}(0.0);`,y=`\n      let col = colIn * ${o};\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (${e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${s(o)}\n      }\n      return ${n}(0.0);\n      `,{activationFunction:C,applyActivation:I}=gt(r,n);return`\n      ${C}\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?v:y}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?y:v}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${n}) {\n    let col = colIn * ${o};\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${d}\n      ${un(t)}\n      ${I}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${o}] = value;\n    }\n  }`},ns=(e,t,r,o,n,s,u,d)=>{let a=t.format==="NHWC",m=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a?m%4===0&&v%4===0:g%4===0&&v%4===0,C=a?v:g*w,I=a?g*w:v,S=y?[8,8,1]:[C<=4||I<=4?4:16,C>4&&I<=4?4:16,1],_=y?[4,4,1]:[C<=4?1:4,C>4&&I<=4?1:4,1],P=[Math.ceil(C/S[0]/_[0]),Math.ceil(I/S[1]/_[1]),Math.ceil(h/S[2]/_[2])];De("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${P}`);let A=y?4:1,z=Math.max(S[0]*A,S[1]),R=y?4:1,N=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],T=M("x",e[0].dataType,e[0].dims.length,R),H=M("w",e[1].dataType,e[1].dims.length,1),ie=j("result",e[0].dataType,r.length,R),Z=[T,H];N.push(...F(e[0].dims)),N.push(...F(e[1].dims));let K="";if(u){let Q=M("bias",e[2].dataType,e[2].dims.length,R);Z.push(Q),N.push(...F(e[2].dims)),K+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?"vec4<f32>":"f32"} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}return N.push(...F(r)),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:P[0],y:P[1],z:P[2]},programUniforms:N}),getShaderSource:Q=>`\n        ${dn("uniforms.result_strides")}\n        ${Q.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...Z,ie)};\n        const outBackprop : vec4<i32> = vec4<i32>(${e[0].dims.join(",")});\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[a?1:2]}, ${t.kernelShape[a?2:3]});\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ${t.dilations[0]<=1?0:(t.kernelShape[a?1:2]-1)*(t.dilations[0]-1)},\n              ${t.dilations[1]<=1?0:(t.kernelShape[a?2:3]-1)*(t.dilations[1]-1)});\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${t.pads[0]+t.pads[2]})/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (${t.pads[1]+t.pads[3]})/2);\n        const strides : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        const dimAOuter : i32 = ${o};\n        const dimBOuter : i32 = ${n};\n        const dimInner : i32 = ${s};\n        ${K}\n        ${Cd(a,u,t,A)}\n        ${y?xr(_,S,"f32",void 0,!a,z):_r(_,S,"f32",void 0,!a,z,!1,void 0,d)}`}}});var Id,oo,as=q(()=>{"use strict";It();$e();we();Id=(e,t,r,o,n,s,u=!1,d)=>{let a=r.format==="NHWC",m=a?1:2,h=a?2:3,g=a?3:1,w=V.size(o),v=u?2:1,y=r.group,C=t[1].dims,I=C[0]/y,S=C[1],_=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${u?`vec4<${d}>`:d}) {\n    result[flatIndex] = ${u?`vec4<${d}>`:d}(value);\n  }`;n&&(_+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${u?`vec4<${d}>`:d} {\n      return bias[coords.${a?"w":"y"}${u?"/ 4":""}];\n    }`);let P=u?4:1,A=M("W",t[1].dataType,t[1].dims,P),z=M("Dy",t[0].dataType,t[0].dims,P),R=[z,A];n&&R.push(M("bias",t[2].dataType,[o[g]],P));let N=j("result",t[0].dataType,o,P),T=`{\n        let batch: u32 = ${s?"global_id.z":"workgroup_id.z"} / outShape[1];\n        let r = ${s?"global_id.z":"workgroup_id.z"} % outShape[1];\n        let c = ${s?"global_id.y":"workgroup_id.y"} * ${v};\n        let d1: u32 = ${s?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${d}>, ${v}>;\n        for (var i = 0; i < ${v}; i++) {\n          dotProd[i] = vec4<${d}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (${d}(dyCorner.x) + ${d}(wR)) / ${d}(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${d}(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (${d}(dyCorner.y) + ${d}(wC)) / ${d}(strides.y);\n            let dyC2 = (${d}(dyCorner.y) + 1.0 + ${d}(wC)) / ${d}(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${d}(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${d}(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${z.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${d}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${z.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${d}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[${g}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${z.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${d}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${A.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${z.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${d}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${v}; i = i + 1) {\n          let value = dotProd[i] + ${n?"bias[c+i]":`vec4<${d}>(0.0)`};\n          ${N.set("batch","r","c + i","d1","value")};\n        }\n      }`,H=`\n          let outputIndices = ${N.offsetToIndices("global_idx")};\n          let batch = ${N.indicesGet("outputIndices",0)};\n          let d1 = ${N.indicesGet("outputIndices",g)};\n          let r = ${N.indicesGet("outputIndices",m)};\n          let c = ${N.indicesGet("outputIndices",h)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ${S};\n          let wOutChannel = d1 - groupId * ${S};\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${d}(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${d}(dyRCorner) + ${d}(wR)) / ${d}(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ${d}(outBackprop[${m}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${d}(dyCCorner) + ${d}(wC)) / ${d}(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ${d}(outBackprop[${h}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ${I};\n              for (var d2: u32 = 0; d2 < ${I}; d2 = d2 + 1) {\n                let xValue = ${a?z.get("batch","idyR","idyC","inputChannel"):z.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${A.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${n?"bias[d1]":`${d}(0.0)`};\n          ${N.setByOffset("global_idx","value")};\n        `;return`\n  ${e.declareVariables(...R,N)}\n  ${_}\n  const outShape : vec4<u32> = vec4<u32>(${o.join(",")});\n  const outBackprop : vec4<u32> = vec4<u32>(${t[0].dims.join(",")});\n  const strides : vec2<u32> = vec2<u32>(${r.strides[0]}, ${r.strides[1]});\n  const filterDims : vec2<u32> = vec2<u32>(${r.kernelShape[a?1:2]}, ${r.kernelShape[a?2:3]});\n  const dilations : vec2<u32> = vec2<u32>(${r.dilations[0]}, ${r.dilations[1]});\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ${r.dilations[0]<=1?0:(r.kernelShape[a?1:2]-1)*(r.dilations[0]-1)},\n          ${r.dilations[1]<=1?0:(r.kernelShape[a?2:3]-1)*(r.dilations[1]-1)});\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${r.pads[0]+r.pads[2]})/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (${r.pads[1]+r.pads[3]})/2);\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(w)};\n  ${u?T:H}}`},oo=(e,t,r)=>{let o=e.length>2,n=t.outputShape,s=V.size(n),u=[Math.ceil(s/64),1,1];De("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${u}`);let d=Le(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:()=>({dispatchGroup:{x:u[0],y:u[1],z:u[2]},outputs:[{dims:r?r(n):n,dataType:e[0].dataType}]}),getShaderSource:a=>Id(a,e,t,n,o,u[1]===1&&u[2]===1,!1,d)}}});var Ad,Td,Ed,is,ss,Od,Pd,kd,Bd,us,ls=q(()=>{"use strict";je();os();as();At();tr();Ad=(e,t,r,o,n,s)=>(e-1)*t+r+(o-1)*n+1-s,Td=(e,t,r,o,n)=>{let s=Math.floor(e/2);t==="SAME_UPPER"?(r[o]=s,r[n]=e-s):t==="SAME_LOWER"&&(r[o]=e-s,r[n]=s)},Ed=(e,t,r,o,n,s,u,d,a,m)=>{let h=e.length-2,g=m.length===0;if(a.length===0)for(let y=0;y<h;++y)a.push(0);let w=e[0],v=t[d?3:1]*n;for(let y=0,C=e.length-h-(d?1:0);y<h;++y,++C){let I=e[C],S=g?I*u[y]:m[y],_=Ad(I,u[y],s[y],t[C],r[y],S);Td(_,o,s,y,y+h),g&&m.push(u[y]*(I-1)+a[y]+(t[C]-1)*r[y]+1-s[y]-s[y+h])}m.splice(0,0,w),m.splice(d?3:1,0,v)},is=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((w,v)=>w*v,1)===0){r.length=0;for(let w=2;w<t[1].dims.length;++w)r.push(t[1].dims[w])}let o=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(o?3:1,0,t[1].dims[1]);let n=e.pads.slice(),s=e.outputShape.slice(),u=e.outputPadding.slice(),d=t[0].dims,a=e.dilations.slice();if(a.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;a=new Array(w).fill(1)}let m=e.strides.slice();if(m.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;m=new Array(w).fill(1)}Ed(d,r,a,e.autoPad,e.group,n,m,o,u,s);let h=Object.assign({},e),g=e.cacheKey+[r.join("n,"),n.join(","),m.join(","),u.join(","),s.join(","),a.join(",")].join("_");return Object.assign(h,{kernelShape:r,pads:n,outputPadding:u,outputShape:s,dilations:a,strides:m,cacheKey:g}),h},ss=e=>{let t=sn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],n=e.dilations,s=e.group,u=e.kernelShape,d=e.pads,a=e.strides,m=e.wIsConst(),h=e.outputPadding,g=e.outputShape;return ge({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,outputPadding:h,outputShape:g,pads:d,strides:a,wIsConst:m,...t})},Od=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==n))throw new Error("invalid bias");let s=e[0].dims.length-2;if(t.dilations.reduce((h,g)=>h+g,0)>0&&t.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(t.strides.reduce((h,g)=>h+g,0)>0&&t.strides.length!==s)throw new Error(`strides should be ${s}D`);if(t.pads.reduce((h,g)=>h+g,0)>0&&t.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(t.outputPadding.length!==s&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${s}D`);if(t.kernelShape.reduce((h,g)=>h+g,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Pd=[2,3,1,0],kd=(e,t,r)=>{let o=is(r,t),n=r.format==="NHWC",s=o.outputShape,u=s[n?3:1],d=t[0].dims[n?3:1];if(o.group!==1||u===1&&d===1){e.compute(oo(t,o));return}let a=s[n?1:2],m=s[n?2:3],h=t[1].dims[2],g=t[1].dims[3],w=n?a*m:u,v=n?u:a*m,y=h*g*d,C=!0,I=e.kernelCustomData.wT??e.compute(st(t[1],Pd),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=I);let S=[t[0],I],_=t.length===3;_&&(!n&&t[2].dims.length===1?S.push(t[2].reshape([t[2].dims[0],1,1])):S.push(t[2])),e.compute(ns(S,o,s,w,v,y,_,C),{inputs:S})},Bd=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];o.length===3&&o.push(e.inputs[2]);let n=t.kernelShape;(n.length===0||n[0]===0)&&(n=[e.inputs[1].dims[2]]);let s=t.dilations;(s.length===0||s[0]===0)&&(s=[1]);let u=t.strides;(u.length===0||u[0]===0)&&(u=[1]);let d=t.pads;d.length===0&&(d=[0,0]),d=[0,d[0],0,d[1]],u=[1].concat(u),s=[1].concat(s),n=[1].concat(n);let a=is({...t,pads:d,strides:u,dilations:s,kernelShape:n},o);e.compute(oo(o,a,m=>r?[m[0],m[2],m[3]]:[m[0],m[1],m[3]]))},us=(e,t)=>{Od(e.inputs,t),e.inputs[0].dims.length===3?Bd(e,t):kd(e,e.inputs,t)}});var Rd,ds,cs,ps=q(()=>{"use strict";Ne();$e();je();we();Rd=(e,t,r,o)=>{let n=V.size(t),s=t.length,u=M("input",e,s),d=j("output",e,s),a=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),m=V.normalizeAxis(a,s),h=g=>{let w=` i32(${u.indicesGet("inputIndices","uniforms.axis")}) `,v=ce("uniforms.input_shape","uniforms.axis",s),y=o.reverse?w+(o.exclusive?" + 1":""):"0",C=o.reverse?v:w+(o.exclusive?"":" + 1");return`\n                ${g.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(u,d)}\n                ${g.mainStart()}\n                  ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${d.offsetToIndices("global_idx")};\n                  var sum = ${d.type.value}(0);\n                  let first : i32 = ${y};\n                  let last : i32 = ${C};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${u.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${u.getByIndices("inputIndices")};\n                  }\n                  ${d.setByOffset("global_idx","sum")};\n                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},{type:"int32",data:m},...F(t),...F(t)]}),getShaderSource:h}},ds=(e,t)=>{let r=e.inputs[0].dims,o=e.inputs[0].dataType,n=e.inputs[1];e.compute(Rd(o,r,n,t),{inputs:[0]})},cs=e=>{let t=e.exclusive===1,r=e.reverse===1;return ge({exclusive:t,reverse:r})}});var ao,pn,ms,Dd,Md,io,so,fs,Ud,hs,gs,ys=q(()=>{"use strict";$e();je();we();ao="[a-zA-Z]|\\\\.\\\\.\\\\.",pn="("+ao+")+",ms="^"+pn+"$",Dd="("+pn+",)*"+pn,Md="^"+Dd+"$",io=class{constructor(t=-1){this.symbolToIndices=new Map,this.inputIndex=t}addSymbol(t,r){let o=this.symbolToIndices.get(t);o===void 0?o=[r]:o.push(r),this.symbolToIndices.set(t,o)}},so=class{constructor(t,r){this.equation=r;this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[o,n]=r.includes("->")?r.split("->",2):[r,""];if(!o.match(RegExp(Md)))throw new Error("Invalid LHS term");if(o.split(",").forEach((d,a)=>{let m=t[a].dims.slice();if(!d.match(RegExp(ms)))throw new Error("Invalid LHS term");let h=this.processTerm(d,!0,m,a);this.lhs.push(h)}),n==="")n+=[...this.symbolToInfo.entries()].filter(([d,a])=>a.count===1||d==="...").map(([d])=>d).join("");else if(!n.match(RegExp(pn)))throw new Error("Invalid RHS");n.match(RegExp(ao,"g"))?.forEach(d=>{if(d==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let a=this.symbolToInfo.get(d);if(a===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(a.dimValue)}}),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(t,r,o){let n=this.symbolToInfo.get(t);if(n!==void 0){if(n.dimValue!==r&&n.count!==1)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(o)}else n={count:1,dimValue:r,inputIndices:[o]};this.symbolToInfo.set(t,n)}processTerm(t,r,o,n=-1){let s=o.length,u=!1,d=[],a=0;if(!t.match(RegExp(ms))&&!r&&t!=="")throw new Error("Invalid LHS term");let m=t.match(RegExp(ao,"g")),h=new io(n);return m?.forEach((g,w)=>{if(g==="..."){if(u)throw new Error("Only one ellipsis is allowed per input term");u=!0;let v=s-m.length+1;if(v<0)throw new Error("Ellipsis out of bounds");if(d=o.slice(a,a+v),this.hasEllipsis){if(this.ellipsisDims.length!==d.length||this.ellipsisDims.toString()!==d.toString())throw new Error("Ellipsis dimensions mismatch")}else if(r)this.hasEllipsis=!0,this.ellipsisDims=d;else throw new Error("Ellipsis must be specified in the LHS");for(let y=0;y<d.length;y++){let C=String.fromCharCode("0".charCodeAt(0)+y);h.addSymbol(C,w+y),this.addSymbol(C,o[a++],n)}}else h.addSymbol(g,w+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(g,o[a++],n)}),h}},fs=e=>e+"_max",Ud=(e,t,r,o,n)=>{let u=t.map((v,y)=>e[y]?v.length:v).map((v,y)=>M(`input${y}`,r,v)),d=V.size(n),a=Be(n.length),m=a?n.length:n,h=j("output",r,m),g=[...o.symbolToInfo.keys()].filter(v=>!o.rhs.symbolToIndices.has(v)),w=v=>{let y=[],C="var prod = 1.0;",I="var sum = 0.0;",S="sum += prod;",_=[],P=[],A=[],z=[],R=o.symbolToInfo.size===o.rhs.symbolToIndices.size;o.symbolToInfo.forEach((T,H)=>{if(o.rhs.symbolToIndices.has(H)){let ie=o.rhs.symbolToIndices.get(H)?.[0];ie!==void 0&&o.lhs.forEach((Z,K)=>{if(T.inputIndices.includes(K)){let Q=Z.symbolToIndices.get(H);if(Q===void 0)throw new Error("Invalid symbol error");Q.forEach(X=>{y.push(`${u[K].indicesSet(`input${K}Indices`,X,h.indicesGet("outputIndices",ie))}`)})}})}else o.lhs.forEach((ie,Z)=>{if(T.inputIndices.includes(Z)){let K=ie.symbolToIndices.get(H);if(K===void 0)throw new Error("Invalid symbol error");K.forEach(Q=>{_.push(`${u[Z].indicesSet(`input${Z}Indices`,Q,`${H}`)}`)}),z.push(`prod *= ${u[Z].getByIndices(`input${Z}Indices`)};`)}}),P.push(`for(var ${H}: u32 = 0; ${H} < uniforms.${fs(H)}; ${H}++) {`),A.push("}")});let N=R?[...y,`let sum = ${u.map((T,H)=>T.getByIndices(`input${H}Indices`)).join(" * ")};`]:[...y,I,...P,..._,C,...z,S,...A];return`\n            ${v.registerUniforms(g.map(T=>({name:`${fs(T)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...u,h)}\n\n            ${v.mainStart()}\n            ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${h.offsetToIndices("global_idx")};\n            ${u.map((T,H)=>`var input${H}Indices: ${u[H].type.indices};`).join(`\n`)}\n            ${N.join(`\n`)};\n            ${h.setByOffset("global_idx","sum")};\n          }`};return{name:"Einsum",shaderCache:{hint:o.equation,inputDependencies:e.map(v=>v?"rank":"dims")},getRunData:()=>{let v=g.filter(C=>o.symbolToInfo.has(C)).map(C=>({type:"uint32",data:o.symbolToInfo.get(C)?.dimValue||0}));v.push({type:"uint32",data:d});let y=t.filter((C,I)=>e[I]).map((C,I)=>[...F(C)]).reduce((C,I)=>C.concat(I),v);return a&&y.push(...F(n)),{outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:y}},getShaderSource:w}},hs=(e,t)=>{let r=new so(e.inputs,t.equation),o=e.inputs.map((u,d)=>Be(u.dims.length)),n=r.outputDims,s=e.inputs.map((u,d)=>u.dims);e.compute(Ud(o,s,e.inputs[0].dataType,r,n))},gs=e=>{let t=e.equation.replace(/\\s+/g,"");return ge({equation:t})}});var zd,bs,Vd,Nd,ws,vs=q(()=>{"use strict";Ne();$e();we();zd=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=r.length<t.length?0:r.length-t.length,n=t.length<r.length?0:t.length-r.length;for(;o<r.length&&n<t.length;++o,++n)if(r[o]!==t[n]&&r[o]!==1&&t[n]!==1)throw new Error("Expand requires shape to be broadcastable to input")},bs=(e,t)=>{let r=e.length-t.length,o=[];for(let n=0;n<r;++n)o.push(e[n]);for(let n=0;n<t.length;++n)o.push(t[n]===1?e[n+r]:t[n]);return o},Vd=(e,t)=>e.length>t.length?bs(e,t):bs(t,e),Nd=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=Vd(t,r),n=e[0].dataType,s=n===9?4:1,u=Math.ceil(V.size(o)/s),d=Be(t.length),a=Be(o.length),m=g=>{let w=d?t.length:t,v=a?o.length:o,y=M("input",n,w,s),C=j("output",n,v,s),I;if(n===9){let S=(_,P,A="")=>`\n          let outputIndices${P} = ${C.offsetToIndices(`outputOffset + ${P}u`)};\n          let offset${P} = ${y.broadcastedIndicesToOffset(`outputIndices${P}`,C)};\n          let index${P} = offset${P} / 4u;\n          let component${P} = offset${P} % 4u;\n          ${_}[${P}] = ${A}(${y.getByOffset(`index${P}`)}[component${P}]);\n        `;I=`\n        let outputOffset = global_idx * ${s};\n        var data = vec4<u32>(0);\n        ${S("data",0,"u32")}\n        ${S("data",1,"u32")}\n        ${S("data",2,"u32")}\n        ${S("data",3,"u32")}\n        ${C.setByOffset("global_idx","data")}\n      }`}else I=`\n        let outputIndices = ${C.offsetToIndices("global_idx")};\n        let inputOffset = ${y.broadcastedIndicesToOffset("outputIndices",C)};\n        ${C.setByOffset("global_idx",y.getByOffset("inputOffset"))}\n      }`;return`\n    ${g.registerUniform("vec_size","u32").declareVariables(y,C)}\n    ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${I}`},h=[{type:"uint32",data:u}];return d&&h.push(...F(t)),a&&h.push(...F(o)),{name:"Expand",shaderCache:{hint:`${o.length}`,inputDependencies:[d?"rank":"dims"]},getShaderSource:m,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:h})}},ws=e=>{zd(e.inputs),e.compute(Nd(e.inputs),{inputs:[0]})}});var Wd,Hd,$s,Ss,xs=q(()=>{"use strict";Ne();$e();je();we();Wd=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},Hd=(e,t)=>{let r=e[0].dims,o=e[1].dims,n=r.length,s=V.normalizeAxis(t.axis,n),u=r.slice(0);u.splice(s,1,...o);let d=r[s],a=e[0].dataType===9?4:1,m=Math.ceil(V.size(u)/a),h=Be(e[0].dims.length),g=h?e[0].dims.length:e[0].dims,w=Be(e[1].dims.length),v=w?e[1].dims.length:e[1].dims,y=Be(u.length),C=y?u.length:u,I=[{type:"uint32",data:m},{type:"int32",data:d},{type:"uint32",data:s}];h&&I.push(...F(e[0].dims)),w&&I.push(...F(e[1].dims)),y&&I.push(...F(u));let S=[];S.push(h?"rank":"dims"),S.push(w?"rank":"dims");let _=P=>{let A=M("data",e[0].dataType,g,a),z=M("inputIndices",e[1].dataType,v),R=j("output",e[0].dataType,C,a),N=H=>{let ie=o.length,Z=`var indicesIndices${H}  = ${z.type.indices}(0);`;for(let K=0;K<ie;K++)Z+=`${ie>1?`indicesIndices${H}[${K}]`:`indicesIndices${H}`} = ${u.length>1?`outputIndices${H}[uniforms.axis + ${K}]`:`outputIndices${H}`};`;Z+=`\n          var idx${H} = ${z.getByIndices(`indicesIndices${H}`)};\n          if (idx${H} < 0) {\n            idx${H} = idx${H} + uniforms.axisDimLimit;\n          }\n          var dataIndices${H} = ${A.type.indices}(0);\n        `;for(let K=0,Q=0;K<n;K++)K===s?(Z+=`${n>1?`dataIndices${H}[${K}]`:`dataIndices${H}`} = u32(idx${H});`,Q+=ie):(Z+=`${n>1?`dataIndices${H}[${K}]`:`dataIndices${H}`} = ${u.length>1?`outputIndices${H}[${Q}]`:`outputIndices${H}`};`,Q++);return Z},T;if(e[0].dataType===9){let H=(ie,Z,K="")=>`\n          let outputIndices${Z} = ${R.offsetToIndices(`outputOffset + ${Z}u`)};\n          ${N(Z)};\n          let offset${Z} = ${A.indicesToOffset(`dataIndices${Z}`)};\n          let index${Z} = offset${Z} / 4u;\n          let component${Z} = offset${Z} % 4u;\n          ${ie}[${Z}] = ${K}(${A.getByOffset(`index${Z}`)}[component${Z}]);\n        `;T=`\n        let outputOffset = global_idx * ${a};\n        var value = vec4<u32>(0);\n        ${H("value",0,"u32")}\n        ${H("value",1,"u32")}\n        ${H("value",2,"u32")}\n        ${H("value",3,"u32")}\n        ${R.setByOffset("global_idx","value")}\n      `}else T=`\n      let outputIndices = ${R.offsetToIndices("global_idx")};\n      ${N("")};\n      let value = ${A.getByIndices("dataIndices")};\n      ${R.setByOffset("global_idx","value")};\n      `;return`\n      ${P.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(A,z,R)}\n      ${P.mainStart()}\n        ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${T}\n      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:S},getRunData:()=>({outputs:[{dims:u,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:I}),getShaderSource:_}},$s=e=>ge({axis:e.axis}),Ss=(e,t)=>{let r=e.inputs;Wd(r),e.compute(Hd(e.inputs,t))}});var Gd,Ld,_s,Cs,Is=q(()=>{"use strict";$e();je();we();Gd=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and\n                     indices input tensors be of same rank.`)},Ld=(e,t)=>{let r=e[0].dims,o=e[0].dataType,n=r.length,s=e[1].dims,u=e[1].dataType,d=V.normalizeAxis(t.axis,n),a=r[d],m=s.slice(0),h=V.size(m),g=M("input",o,n),w=M("indicesInput",u,s.length),v=j("output",o,m.length),y=[{type:"uint32",data:h},{type:"int32",data:a},{type:"uint32",data:d}];return y.push(...F(r)),y.push(...F(s)),y.push(...F(m)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:m,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:y}),getShaderSource:S=>`\n      ${S.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(g,w,v)}\n      ${S.mainStart()}\n      ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${v.offsetToIndices("global_idx")};\n\n      var idx = ${w.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${g.type.indices}(outputIndices);\n      ${g.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${g.getByIndices("inputIndices")};\n\n      ${v.setByOffset("global_idx","value")};\n  }`}},_s=e=>ge({axis:e.axis}),Cs=(e,t)=>{let r=e.inputs;Gd(r),e.compute(Ld(e.inputs,t))}});var Fd,jd,As,Ts,Es=q(()=>{"use strict";$e();we();Fd=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},jd=(e,t)=>{let r=e[0].dims.slice(),o=e[1].dims.slice(),[n,s,u]=Jr.getShapeOfGemmResult(r,t.transA,o,t.transB,e.length===3?e[2].dims:void 0),d=[n,s];if(!d)throw new Error("Can\'t use gemm on the given tensors");let a=V.size(d),m=[{type:"uint32",data:a},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:u},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],h=["type","type"];e.length===3&&(m.push(...F(e[2].dims)),h.push("rank")),m.push(...F(d));let g=w=>{let v="";t.transA&&t.transB?v="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?v="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?v="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(v="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let y=t.alpha===1?"":"value *= uniforms.alpha;",C=M("a",e[0].dataType,e[0].dims),I=M("b",e[1].dataType,e[1].dims),S=C.type.value,_=null,P=[C,I];e.length===3&&(_=M("c",e[2].dataType,e[2].dims.length),P.push(_));let A=j("output",e[0].dataType,d.length);P.push(A);let z=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`\n  ${w.registerUniforms(z).declareVariables(...P)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${S}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${v}\n    }\n\n    ${y}\n    ${(()=>_!=null?`let cOffset = ${_.broadcastedIndicesToOffset("vec2(m, n)",A)}; value += ${S}(uniforms.beta) * ${_.getByOffset("cOffset")};`:"")()}\n    output[global_idx] = value;\n  }`};return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:d,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:m}),getShaderSource:g}},As=e=>{let t=e.transA,r=e.transB,o=e.alpha,n=e.beta;return{transA:t,transB:r,alpha:o,beta:n,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Ts=(e,t)=>{Fd(e.inputs),e.compute(jd(e.inputs,t))}});var qd,Kd,Yd,Os,Ps=q(()=>{"use strict";Ne();$e();we();qd=(e,t)=>{let r=e[0].dims,o=r,n=2,s=V.sizeToDimension(r,n),u=V.sizeFromDimension(r,n),d=Fe(u),a=u/d,m=[r[0],r[1],a],h=["rank","type","type"],g=[{type:"uint32",data:u},{type:"uint32",data:a}];g.push(...F(m),...F(m));let w=v=>{let y=M("x",e[0].dataType,m.length,d),C=M("scale",e[1].dataType,e[1].dims),I=M("bias",e[2].dataType,e[2].dims),S=j("output",e[0].dataType,m.length,d),_=[y,C,I,S],P=y.type.value,A=d===1?"f32":`vec${d}<f32>`,z=64,R=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${A}, ${z}>;\n  const workgroupSize = ${z}u;\n  ${v.registerUniforms(R).declareVariables(..._)}\n  ${v.mainStart(z)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${A}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${A}(${y.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${tt("workgroupShared[0]",d)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${A}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${A}(${y.get("batch","channel","h")}) - ${A}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${tt("workgroupShared[0]",d)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${C.getByOffset("channel")});\n    let channelShift = f32(${I.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${y.get("batch","channel","h")} * ${P}(${A}(channelScale)) + ${P}(${A}(channelShift));\n      ${S.set("batch","channel","h","value")};\n    }\n  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${d}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:s},programUniforms:g}),getShaderSource:w}},Kd=(e,t,r,o,n,s,u,d)=>{let a=Fe(u),m=64,h=a===1?"vec2f":`mat2x${a}f`,g=a===1?"f32":`vec${a}f`,w=(R,N)=>`${h}(${R}, ${N})`,v=n*u/a,y=Math.ceil(s/m),C=["type"],I=[{type:"uint32",data:y},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(s*u/a)}],S=R=>{let N=M("input",t.dataType,t.dims,a);return`\n  ${R.declareVariables(N)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart(m)}\n    let currentImageNumber = global_idx / ${m} / uniforms.C;\n    let currentChannelNumber = (global_idx / ${m}) % uniforms.C;\n    let wgId = global_idx % ${m};\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${Ze("f32",a)};\n    var squaredSum = ${Ze("f32",a)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${g}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${w("sum","squaredSum")};\n  }`},_=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${a}`,inputDependencies:C},getRunData:()=>({outputs:[{dims:[n,u,m,2],dataType:1}],dispatchGroup:{x:n*u/a},programUniforms:I}),getShaderSource:S},{inputs:[t],outputs:[-1]})[0],P=[{type:"uint32",data:v},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(m*u/a)}],A=["type","type","type"],z=R=>{let N=M("scale",r.dataType,r.dims,a),T=M("bias",o.dataType,o.dims,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${h}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${N.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${T.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart()}\n    ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${Ze("f32",a)};\n    var squaredSum = ${Ze("f32",a)};\n    for (var i: u32 = 0; i < ${m}; i++) {\n        let value = input[offset + i + currentChannelNumber * ${m}];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${d}));\n    let channelScale = invStdDev * ${g}(scale[currentChannelNumber]);\n    let channelShift = ${g}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${w("channelScale","channelShift")};\n  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${a};${d}`,inputDependencies:A},getRunData:()=>({outputs:[{dims:[n,u,2],dataType:1}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:P}),getShaderSource:z},{inputs:[_,r,o],outputs:[-1]})[0]},Yd=(e,t,r)=>{let o=t[0].dims,n=o,s=o[0],u=o[o.length-1],d=V.sizeFromDimension(o,1)/u,a=Fe(u),m=V.size(n)/a,h=[{type:"uint32",data:d},{type:"uint32",data:Math.floor(u/a)}],g=["type","type"],w=Kd(e,t[0],t[1],t[2],s,d,u,r.epsilon),v=y=>{let C=Le(t[0].dataType),I=a===1?"vec2f":`mat2x${a}f`,S=a===1?C:`vec${a}<${C}>`,_=M("input",t[0].dataType,t[0].dims,a),P=j("output",t[0].dataType,n,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${_.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${I}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${P.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${y.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${S}(scale[0]), ${S}(scale[1]));\n  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${a}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:h}),getShaderSource:v},{inputs:[t[0],w]})},Os=(e,t)=>{t.format==="NHWC"?Yd(e,e.inputs,t):e.compute(qd(e.inputs,t))}});var Zd,Jd,ks,Bs=q(()=>{"use strict";Ne();$e();we();Zd=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},Jd=(e,t,r)=>{let o=e[0].dims,n=e[1],s=e[2],u=o,d=V.normalizeAxis(t.axis,o.length),a=V.sizeToDimension(o,d),m=V.sizeFromDimension(o,d),h=V.size(n.dims),g=s?V.size(s.dims):0;if(h!==m||s&&g!==m)throw new Error(`Size of X.shape()[axis:] == ${m}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${h} and bias size of ${g}`);let w=[];for(let A=0;A<o.length;++A)A<d?w.push(o[A]):w.push(1);let v=Fe(m),y=["type","type"],C=[{type:"uint32",data:a},{type:"float32",data:m},{type:"uint32",data:Math.floor(m/v)},{type:"float32",data:t.epsilon}];s&&y.push("type");let I=r>1,S=r>2,_=A=>{let z=Le(e[0].dataType),R=[M("x",e[0].dataType,e[0].dims,v),M("scale",n.dataType,n.dims,v)];s&&R.push(M("bias",s.dataType,s.dims,v)),R.push(j("output",e[0].dataType,u,v)),I&&R.push(j("mean_data_output",1,w)),S&&R.push(j("inv_std_output",1,w));let N=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`\n  ${A.registerUniforms(N).declareVariables(...R)}\n  ${A.mainStart()}\n    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ${Ze("f32",v)};\n    var meanSquareVector = ${Ze("f32",v)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${it(z,v,"x[h + offset]")};\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ${tt("meanVector",v)} / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(${tt("meanSquareVector",v)} / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${it(z,v,"x[j + offset]")};\n      let f32scale = ${it(z,v,"scale[j]")};\n      output[j + offset] = ${R[0].type.value}((f32input - mean) * invStdDev * f32scale\n        ${s?`+ ${it(z,v,"bias[j]")}`:""}\n      );\n    }\n\n    ${I?"mean_data_output[global_idx] = mean":""};\n    ${S?"inv_std_output[global_idx] = invStdDev":""};\n  }`},P=[{dims:u,dataType:e[0].dataType}];return I&&P.push({dims:w,dataType:1}),S&&P.push({dims:w,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${v};${r}`,inputDependencies:y},getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(a/64)},programUniforms:C}),getShaderSource:_}},ks=(e,t)=>{Zd(e.inputs),e.compute(Jd(e.inputs,t,e.outputCount))}});var Qd,Ds,Rs,Xd,uo,Ms,Us=q(()=>{"use strict";$e();je();Yr();Kn();we();tr();Qd=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],d=e[5],a=e[6],m=e[7];if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let h=!1,g=r.dims[0],w=r.dims[1],v=r.dims.length===3?h?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],y=w,C=0,I=0,S=Math.floor(v/t.numHeads);if(a&&m){if(a.dims.length!==4)throw new Error(\'Input "past_key" is expected to have 4 dimensions\');if(m.dims.length!==4)throw new Error(\'Input "past_value" is expected to have 4 dimensions\');C=a.dims[2],I=a.dims[2]}else if(a||m)throw new Error(\'Input "past_key" and "past_value" shall be both present or both absent\');let _;if(o){if(r.dims.length!==3)throw new Error(\'Input "query" is expected to have 3 dimensions when key is given\');if(o.dims.length<3||o.dims.length>5)throw new Error(\'Input "key" is expected to have 3, 4, or 5 dimensions\');if(r.dims[0]!==o.dims[0])throw new Error(\'Input "query" and "key" shall have same dim 0 (batch size)\');if(o.dims.length===3){if(o.dims[2]!==r.dims[2])throw new Error(\'Input "query" and "key" shall have same dim 2 (hidden_size)\');_=2,y=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==t.numHeads||o.dims[3]!==2||o.dims[4]!==S)throw new Error(\'Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv\');if(n)throw new Error(\'Expect "value" be none when "key" has packed kv format.\');_=5,y=o.dims[1]}else{if(o.dims[1]!==t.numHeads||o.dims[3]!==S)throw new Error(\'Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key\');_=0,y=o.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error(\'Input "query" is expected to have 3 or 5 dimensions when key is empty\');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error(\'Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv\');_=3}if(s){if(s.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimension\');if(n&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let P=0;if(u){P=8;let T=u.dims;throw T.length===1?T[0]===g?P=1:T[0]===3*g+2&&(P=3):T.length===2&&T[0]===g&&T[1]===y&&(P=5),P===8?new Error(\'Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)\'):new Error("Mask not supported")}let A=!1,z=v;if(n){if(n.dims.length!==3&&n.dims.length!==4)throw new Error(\'Input "value" is expected to have 3 or 4 dimensions\');if(r.dims[0]!==n.dims[0])throw new Error(\'Input "query" and "value" shall have same dim 0 (batch_size)\');if(n.dims.length===3){if(y!==n.dims[1])throw new Error(\'Input "key" and "value" shall have the same dim 1 (kv_sequence_length)\');z=n.dims[2]}else{if(y!==n.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)\');z=n.dims[1]*n.dims[3],A=!0}}let R=C+y,N=!1;if(u)throw new Error("Key padding mask is not supported");if(d)throw new Error("extraAddQk is not supported");if(a)throw new Error("pastKey is not supported");if(m)throw new Error("pastValue is not supported");return{batchSize:g,sequenceLength:w,pastSequenceLength:C,kvSequenceLength:y,totalSequenceLength:R,maxSequenceLength:I,inputHiddenSize:0,hiddenSize:v,vHiddenSize:z,headSize:S,vHeadSize:Math.floor(z/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:P,scale:t.scale,broadcastResPosBias:N,passPastInKv:A,qkvFormat:_}},Ds=e=>ge({...e}),Rs=ge({perm:[0,2,1,3]}),Xd=(e,t,r,o,n,s,u)=>{let d=[o,n,s],a=V.size(d),m=[{type:"uint32",data:a},{type:"uint32",data:u},{type:"uint32",data:s}],h=g=>{let w=j("qkv_with_bias",t.dataType,d),v=M("qkv",t.dataType,d),y=M("bias",r.dataType,d),C=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`\n  ${g.registerUniforms(C).declareVariables(v,y,w)}\n  ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:d,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:m}),getShaderSource:h},{inputs:[t,r],outputs:[-1]})[0]},uo=(e,t,r,o,n,s,u,d)=>{let a=s;if(u){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return a=Xd(e,s,u,t,o,r*n,d),a=a.reshape([t,o,r,n]),e.compute(st(a,Rs.perm),{inputs:[a],outputs:[-1]})[0]}else return s.dims.length===3&&(a=s.reshape([t,o,r,n])),e.compute(st(a,Rs.perm),{inputs:[a],outputs:[-1]})[0]},Ms=(e,t)=>{let r=Qd(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let o=e.inputs[1]&&e.inputs[2]&&e.inputs[1].dims.length===4&&e.inputs[2].dims.length===4,n=uo(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(o)return nn(e,n,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);let s=uo(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),u=uo(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);nn(e,n,s,u,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t)}});var ec,tc,rc,nc,oc,ac,ic,sc,zs,Vs=q(()=>{"use strict";Ne();$e();we();ec=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1)throw new Error("Input type must be float.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},tc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n            k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${ce("uniforms.x_shape",n,t)})) {\n              break;\n            }\n            offset += k * i32(${ce("uniforms.x_strides",n,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${o}\n            value = x[offset];\n          }\n      `},rc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${ce("uniforms.x_shape",n,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${ce("uniforms.x_shape",n,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${ce("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},nc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${ce("uniforms.x_shape",n,t)})) {\n                  k = i32(${ce("uniforms.x_shape",n,t)}) - 1;\n                }\n                offset += k * i32(${ce("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},oc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${ce("uniforms.pads",n,r)};\n                if (k < 0)  {\n                  k += i32(${ce("uniforms.x_shape",n,t)}]);\n                }\n                if (k >= i32(${ce("uniforms.x_shape",n,t)})) {\n                  k -= i32(${ce("uniforms.x_shape",n,t)});\n                }\n                offset += k * i32(${ce("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},ac=(e,t,r)=>{switch(r.mode){case 0:return tc(e,t,r.pads.length);case 1:return rc(e,t,r.pads.length);case 2:return nc(e,t,r.pads.length);case 3:return oc(e,t,r.pads.length);default:throw new Error("Invalid mode")}},ic=(e,t)=>{let r=V.padShape(e[0].dims.slice(),t.pads),o=e[0].dims,s=[{type:"uint32",data:V.size(r)},{type:"uint32",data:t.pads}];if(t.mode===0){let a=et(e[0].dataType);s.push({type:a,data:t.value})}s.push(...F(e[0].dims),...F(r));let u=["rank"],d=a=>{let m=j("output",e[0].dataType,r.length),h=M("x",e[0].dataType,o.length),g=h.type.value,w=ac(m,o.length,t),v=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&v.push({name:"constant_value",type:g}),`\n            ${a.registerUniforms(v).declareVariables(h,m)}\n            ${a.mainStart()}\n            ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${m.offsetToIndices("global_idx")};\n\n            var value = ${g}(0);\n            ${w}\n            output[global_idx] = value;\n        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(V.size(r)/64)},programUniforms:s}),getShaderSource:d}},sc=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,n=e[0].dims.length,s=new Int32Array(2*n).fill(0);if(e.length>=4){let d=e[3].getBigInt64Array();for(let a=0;a<d.length;a++)s[Number(d[a])]=Number(r[a]),s[Number(d[a])+n]=Number(r[a+d.length])}else r.forEach((d,a)=>s[Number(a)]=Number(d));let u=[];return s.forEach(d=>u.push(d)),{mode:t.mode,value:o,pads:u}}else return t},zs=(e,t)=>{ec(e.inputs);let r=sc(e.inputs,t);e.compute(ic(e.inputs,r),{inputs:[0]})}});var mn,Ns,Ws,Hs,Gs,uc,lc,Ls,Fs,js,qs,Ks,Ys,Zs,Js,Qs,Xs,eu,tu,ru=q(()=>{"use strict";Xt();$e();we();mn=e=>{if(Qt.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Ns=(e,t,r)=>{let o=t.format==="NHWC",n=e.dims.slice();o&&n.splice(1,0,n.pop());let s=Object.hasOwnProperty.call(t,"dilations"),u=t.kernelShape.slice(),d=t.strides.slice(),a=s?t.dilations.slice():[],m=t.pads.slice();Ut.adjustPoolAttributes(r,n,u,d,a,m);let h=Ut.computePoolOutputShape(r,n,d,a,u,m,t.autoPad),g=Object.assign({},t);s?Object.assign(g,{kernelShape:u,strides:d,pads:m,dilations:a,cacheKey:t.cacheKey}):Object.assign(g,{kernelShape:u,strides:d,pads:m,cacheKey:t.cacheKey});let w=h.slice();return w.push(w.splice(1,1)[0]),[g,o?w:h]},Ws=(e,t)=>{let r=t.format==="NHWC",o=V.size(e),n=V.size(t.kernelShape),s=[{type:"uint32",data:o},{type:"uint32",data:n}],u=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let d=t.kernelShape[t.kernelShape.length-1],a=t.strides[t.strides.length-1],m=t.pads[t.pads.length/2-1],h=t.pads[t.pads.length-1],g=!!(m+h);s.push({type:"uint32",data:d},{type:"uint32",data:a},{type:"uint32",data:m},{type:"uint32",data:h}),u.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let w=!1;if(t.kernelShape.length===2){let v=t.kernelShape[t.kernelShape.length-2],y=t.strides[t.strides.length-2],C=t.pads[t.pads.length/2-2],I=t.pads[t.pads.length-2];w=!!(C+I),s.push({type:"uint32",data:v},{type:"uint32",data:y},{type:"uint32",data:C},{type:"uint32",data:I}),u.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[s,u,!0,g,w]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let d=V.computeStrides(t.kernelShape);s.push({type:"uint32",data:d},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),u.push({name:"kernelStrides",type:"u32",length:d.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let a=t.pads.reduce((m,h)=>m+h);return[s,u,!!a,!1,!1]}},Hs=(e,t,r,o,n,s,u,d,a,m,h,g)=>{let w=n.format==="NHWC",v=t.type.value,y=j("output",t.type.tensor,o);if(n.kernelShape.length<=2){let C="",I="",S="",_=r-(w?2:1);if(h?C=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${_}] = indices[${_}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${_}] < 0 || xIndices[${_}]\n                      >= uniforms.x_shape[${_}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`:C=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${_}] = indices[${_}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`,n.kernelShape.length===2){let A=r-(w?3:2);g?I=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${A}] = indices[${A}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${A}] < 0 || xIndices[${A}] >= uniforms.x_shape[${A}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:I=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${A}] = indices[${A}] * uniforms.sh - uniforms.phStart + j;\n                `,S=`\n              }\n            `}return`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var value = ${v}(${d});\n              var pad = 0;\n              ${I}\n              ${C}\n              ${S}\n              ${u}\n\n              output[global_idx] = value;\n            }`}else{if(w)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let C=n.kernelShape.length,I=n.pads.length,S="";return m?S=`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${s}\n              }`:S=`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${s}\n            `,`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${C}>;\n\n              var value = ${v}(${d});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${C-1}u; j++) {\n                  offsets[j] = offset / ${ce("uniforms.kernelStrides","j",C)};\n                  offset -= offsets[j] * ${ce("uniforms.kernelStrides","j",C)};\n                }\n                offsets[${C-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-C}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${ce("uniforms.strides",`j - ${r-C}u`,C)}\n                    + offsets[j - ${r-C}u] - ${ce("uniforms.pads","j - 2u",I)};\n                  ${S}\n              }\n              ${u}\n\n              output[global_idx] = value;\n            }`}},Gs=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,uc=e=>`${Gs(e)};${e.countIncludePad}`,lc=e=>`${Gs(e)};${e.storageOrder};${e.dilations}`,Ls=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),Fs=(e,t,r,o)=>{let[n,s]=Ns(t,o,r),u=M("x",t.dataType,t.dims.length),d=u.type.value,a="value += x_val;",m="";n.countIncludePad?m+=`value /= ${d}(uniforms.kernelSize);`:m+=`value /= ${d}(i32(uniforms.kernelSize) - pad);`;let[h,g,w,v,y]=Ws(s,n);h.push(...F(t.dims),...F(s));let C=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:C},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(V.size(s)/64)},programUniforms:h}),getShaderSource:I=>Hs(I,u,t.dims.length,s.length,n,a,m,0,g,w,v,y)}},js=e=>{let t=e.count_include_pad!==0,r=Ls(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:t,...r,cacheKey:""};return{...o,cacheKey:uc(o)}},qs=(e,t)=>{mn(e.inputs),e.compute(Fs("AveragePool",e.inputs[0],!1,t))},Ks={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Ys=e=>{let t=e.format;return{format:t,...Ks,cacheKey:t}},Zs=(e,t)=>{mn(e.inputs),e.compute(Fs("GlobalAveragePool",e.inputs[0],!0,t))},Js=(e,t,r,o)=>{let[n,s]=Ns(t,o,r),u=`\n      value = max(x_val, value);\n    `,d="",a=M("x",t.dataType,t.dims.length),m=["rank"],[h,g,w,v,y]=Ws(s,n);return h.push(...F(t.dims),...F(s)),{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:m},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(V.size(s)/64)},programUniforms:h}),getShaderSource:C=>Hs(C,a,t.dims.length,s.length,n,u,d,-1e5,g,w,v,y)}},Qs=(e,t)=>{mn(e.inputs),e.compute(Js("MaxPool",e.inputs[0],!1,t))},Xs=e=>{let t=e.storage_order,r=e.dilations,o=Ls(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let n={storageOrder:t,dilations:r,...o,cacheKey:""};return{...n,cacheKey:lc(n)}},eu=e=>{let t=e.format;return{format:t,...Ks,cacheKey:t}},tu=(e,t)=>{mn(e.inputs),e.compute(Js("GlobalMaxPool",e.inputs[0],!0,t))}});var cc,pc,nu,ou=q(()=>{"use strict";Xt();Ne();we();cc=(e,t,r)=>{let o=e===t,n=e<t&&r<0,s=e>t&&r>0;if(o||n||s)throw new Error("Range these inputs\' contents are invalid.")},pc=(e,t,r,o)=>{let n=Math.abs(Math.ceil((t-e)/r)),s=[n],u=n,d=et(o),a=[{type:"uint32",data:u},{type:d,data:e},{type:d,data:r},...F(s)],m=h=>{let g=j("output",o,s.length),w=g.type.value,v=[{name:"outputSize",type:"u32"},{name:"start",type:w},{name:"delta",type:w}];return`\n        ${h.registerUniforms(v).declareVariables(g)}\n        ${h.mainStart()}\n        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${w}(global_idx) * uniforms.delta;\n      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:m,getRunData:()=>({outputs:[{dims:s,dataType:o}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:a})}},nu=e=>{let t=0,r=0,o=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),Qt.webgpu.validateInputContent&&cc(t,r,o),e.compute(pc(t,r,o,e.inputs[0].dataType),{inputs:[]})}});var mc,fc,hc,gc,yc,bc,wc,vc,$c,Sc,xc,au,_c,Cc,Ic,Ac,Tc,iu,su,uu=q(()=>{"use strict";$e();je();we();mc=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},fc=(e,t,r)=>{t.every(n=>n>=0&&n<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(r).fill(1);return t.forEach((n,s)=>o[n]=e[s]),o},hc=(e,t,r,o,n,s)=>{let[u,d,a]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],m=e[0].dims.length;if(u>0&&e.length>u&&e[u].dims.length>0)e[u].getFloat32Array().forEach(h=>s.push(h));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(d>0&&e.length>d&&e[d].dims.length>0){if(e[d].getFloat32Array().forEach(h=>o.push(h)),o.length!==0&&o.length!==m&&r>=18&&o.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");mc(o,t),t.axes.length>0&&fc(o,t.axes,m).forEach((h,g)=>o[g]=h)}if(a>0&&e.length>a&&(e[a].getBigInt64Array().forEach(h=>n.push(Number(h))),n.length!==m||r>=18&&n.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(o.length!==t.axes.length)throw new Error(\'Resize requires "scales" input size to be of axes rank when axes attributes is specified\');if(n.length!==t.axes.length)throw new Error(\'Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified\')}if(typeof o<"u"&&typeof n<"u"&&o.length>0&&n.length>m)throw new Error("Resize requires only of scales or sizes to be specified")},gc=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",yc=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",bc=(e,t,r)=>{let o=new Array(r).fill(0).concat(new Array(r).fill(1)),n=e.length===0?o:e.slice();return t.length>0?(t.forEach((s,u)=>{o[s]=n[u],o[u+r]=n[t.length+u]}),o):n},wc=(e,t,r,o)=>{let n=[];if(r.length>0)if(o.length>0){if(e.forEach(s=>n.push(s)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((s,u)=>n[s]=r[u])}else r.forEach(s=>n.push(s));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");n=e.map((s,u)=>Math.round(s*t[u]))}return n},vc=(e,t,r)=>{let o=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(s=>t[s]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(s=>t[s]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let n=e.slice();return r.axes.length>0?(r.axes.forEach(s=>t[s]=o),r.axes.forEach(s=>n[s]=Math.round(e[s]*t[s]))):(t.fill(o,0,t.length),n.forEach((s,u)=>n[u]=Math.round(s*t[u]))),n},$c=(e,t,r,o,n)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${ce("uniforms.scales","i",o)};\n        var roi_low = ${ce("uniforms.roi","i",n)};\n        var roi_hi = ${ce("uniforms.roi",`i + ${t.length}`,n)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${ce("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${ce("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,Sc=(e,t,r,o,n,s,u)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${o.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${ce("uniforms.scales","i",n)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${ce("uniforms.roi","i",s)};\n          var roi_hi = ${ce("uniforms.roi",`i + ${r.length}`,s)};\n          var input_shape_i = ${ce("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${ce("uniforms.output_shape","i",o.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${u} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,xc=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${ce("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,au=(e,t,r,o)=>e.rank>o?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",_c=(e,t,r,o,n)=>{let[u,d,a,m]=r.length===2?[-1,0,1,-1]:[0,2,3,1],h=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${h} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",d,`max(0, min(row, ${r[d]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(col, ${r[a]} - 1))`)};\n      ${au(e,m,u,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${h} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${h} = originalIndices[${d}];\n      var col:${h} = originalIndices[${a}];\n      ${o?`if (row < 0 || row > (${r[d]} - 1) || col < 0 || col > (${r[a]} - 1)) {\n        return ${n};\n      }`:""};\n      row = max(0, min(row, ${r[d]} - 1));\n      col = max(0, min(col, ${r[a]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${m}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${u}])`:"0"};\n      var x11: ${h} = getInputValue(batch, channel, row1, col1);\n      var x12: ${h} = getInputValue(batch, channel, row1, col2);\n      var x21: ${h} = getInputValue(batch, channel, row2, col1);\n      var x22: ${h} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${h} = abs(row - ${h}(row1));\n      var dx2: ${h} = abs(${h}(row2) - row);\n      var dy1: ${h} = abs(col - ${h}(col1));\n      var dy2: ${h} = abs(${h}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Cc=(e,t,r,o,n,s,u,d,a,m)=>{let h=r.length===2,g=!0,[w,v]=h?[0,1]:g?[2,3]:[1,2],y=e.type.value,C=I=>{let S=I===w?"row":"col";return`\n      fn ${S}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${y} {\n        var output_index = ${t.indicesGet("output_indices",I)};\n        var originalIdx: ${y} = getOriginalCoordinateFromResizedCoordinate(output_index, ${n[I]},\n        ${o[I]}, ${r[I]}, ${s[I]}, ${s[I]} + ${r.length});\n        var fractOriginalIdx: ${y} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${d} && (originalIdx < 0 || originalIdx > (${r[I]} - 1))) {\n          return ${a};\n        }\n        var data: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${S}: ${y} = originalIdx + ${y}(i);\n          if (${S} < 0 || ${S} >= ${r[I]}) {\n            ${(()=>m?`coefs[i + 1] = 0.0;\n                        continue;`:d?`return ${a};`:`${S} = max(0, min(${S}, ${r[I]} - 1));`)()};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",I,`u32(${S})`)};\n          data[i + 1] = ${I===w?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${C(w)};\n    ${C(v)};\n  fn getCubicInterpolationCoefs(s: ${y}) -> array<${y}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${y} = 1.0 - absS;\n    var twoMinusAbsS: ${y} = 2.0 - absS;\n    var onePlusAbsS: ${y} = 1.0 + absS;\n    coeffs[0] = ((${u} * onePlusAbsS - 5 * ${u}) * onePlusAbsS + 8 * ${u}) * onePlusAbsS - 4 * ${u};\n    coeffs[1] = ((${u} + 2) * absS - (${u} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${u} + 2) * oneMinusAbsS - (${u} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${u} * twoMinusAbsS - 5 * ${u}) * twoMinusAbsS + 8 * ${u}) * twoMinusAbsS - 4 * ${u};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${y}, 4>, coefs: array<${y}, 4>) -> ${y} {\n    var coefsSum: ${y} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${y} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Ic=(e,t,r,o,n)=>{let[u,d,a,m,h]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],g=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${g} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",d,`max(0, min(depth, ${r[d]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(height, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",m,`max(0, min(width, ${r[m]} - 1))`)};\n      ${au(e,h,u,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${g} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${g} = originalIndices[${d}];\n      var height:${g} = originalIndices[${a}];\n      var width:${g} = originalIndices[${m}];\n      ${o?`if (depth < 0 || depth > (${r[d]} - 1) || height < 0 || height > (${r[a]} - 1) || width < 0 || (width > ${r[m]} - 1)) {\n      return ${n};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[d]} - 1));\n      height = max(0, min(height, ${r[a]} - 1));\n      width = max(0, min(width, ${r[m]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${h}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${u}])`:"0"};\n\n      var x111: ${g} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${g} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${g} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${g} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${g} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${g} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${g} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${g} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${g} = abs(depth - ${g}(depth1));\n      var dx2: ${g} = abs(${g}(depth2) - depth);\n      var dy1: ${g} = abs(height - ${g}(height1));\n      var dy2: ${g} = abs(${g}(height2) - height);\n      var dz1: ${g} = abs(width - ${g}(width1));\n      var dz2: ${g} = abs(${g}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},Ac=(e,t,r,o,n,s)=>{let u=e.dims,d=bc(s,t.axes,u.length),a=wc(u,o,n,t.axes),m=o.slice();o.length===0&&(m=u.map((_,P)=>_===0?1:a[P]/_),t.keepAspectRatioPolicy!=="stretch"&&(a=vc(u,m,t)));let h=j("output",e.dataType,a.length),g=M("input",e.dataType,u.length),w=V.size(a),v=u.length===a.length&&u.every((_,P)=>_===a[P]),y=t.coordinateTransformMode==="tf_crop_and_resize",C=t.extrapolationValue,I=g.type.value,S=_=>`\n      ${v?"":`\n      ${gc(t.coordinateTransformMode,I)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${xc(g,u)};\n              ${yc(t.nearestMode,r,I)};\n              ${Sc(g,h,u,a,m.length,d.length,y)};\n              `;case"linear":return`\n              ${$c(h,u,a,m.length,d.length)};\n              ${(()=>{if(u.length===2||u.length===4)return`${_c(g,h,u,y,C)}`;if(u.length===3||u.length===5)return`${Ic(g,h,u,y,C)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(u.length===2||u.length===4)return`${Cc(g,h,u,a,m,d,t.cubicCoeffA,y,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${_.registerUniform("output_size","u32").registerUniform("scales","f32",m.length).registerUniform("roi","f32",d.length).declareVariables(g,h)}\n      ${_.mainStart()}\n        ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${v?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${h.offsetToIndices("global_idx")};\n        var input_indices: ${g.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${g.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${u.length===2||u.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${m.length>0?m:""}|${n.length>0?n:""}|${d.length>0?d:""}|${v}|${u}`,inputDependencies:["rank"]},getShaderSource:S,getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:"uint32",data:w},{type:"float32",data:m},{type:"float32",data:d},...F(u),...F(a)]})}},Tc=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},iu=(e,t)=>{let r=[],o=[],n=[],s=Tc(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");hc(e.inputs,t,s,r,o,n),e.compute(Ac(e.inputs[0],t,s,r,o,n),{inputs:[0]})},su=e=>{let t=e.antialias,r=e.axes,o=e.coordinateTransformMode,n=e.cubicCoeffA,s=e.excludeOutside!==0,u=e.extrapolationValue,d=e.keepAspectRatioPolicy,a=e.mode,m=e.nearestMode===""?"simple":e.nearestMode;return ge({antialias:t,axes:r,coordinateTransformMode:o,cubicCoeffA:n,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:d,mode:a,nearestMode:m})}});var Ec,Oc,lu,du,cu=q(()=>{"use strict";Ne();$e();je();we();Ec=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],o=e[2];if(t.dataType!==r.dataType||t.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let n=t.dims[t.dims.length-1],s=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==n)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==s)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==n)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let u=e[3];if(u.dims.length!==1)throw new Error("Beta must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let u=e[4];if(u.dims.length!==1)throw new Error("Bias must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Bias must have the same hidden size as input")}},Oc=(e,t,r,o)=>{let n=e[0].dims,s=V.size(n),u=n,d=s,a=n.slice(-1)[0],m=o?n.slice(0,-1).concat(1):[],h=e.length>3,g=e.length>4,w=o&&r>1,v=o&&r>2,y=r>3,C=Fe(a),I=[M("x",e[0].dataType,e[0].dims,C),M("skip",e[1].dataType,e[1].dims,C),M("gamma",e[2].dataType,e[2].dims,C)];h&&I.push(M("beta",e[3].dataType,e[3].dims,C)),g&&I.push(M("bias",e[4].dataType,e[4].dims,C)),I.push(j("output",e[0].dataType,u,C)),w&&I.push(j("meanOutput",1,m)),v&&I.push(j("invStdOutput",1,m)),y&&I.push(j("inputSkipBiasSum",e[0].dataType,u,C));let S=Le(e[0].dataType),_=A=>`\n      const hiddenSize: f32 = ${a};\n      const hiddenSizeVectorized: u32 = ${a/C};\n      const epsilon: f32 = ${t.epsilon};\n\n      ${A.declareVariables(...I)}\n\n      ${A.mainStart()}\n        ${A.guardAgainstOutOfBoundsWorkgroupSizes(d/a)}\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ${Ze("f32",C)};\n        var squareSum = ${Ze("f32",C)};\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ${g?"bias[i]":"0.0"};\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ${y?"inputSkipBiasSum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32Value = ${it(S,C,"value")};\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ${tt("sum",C)} / hiddenSize;\n        let invStdDev = inverseSqrt(${tt("squareSum",C)} / hiddenSize - mean * mean + epsilon);\n        ${w?"meanOutput[global_idx] = mean;":""}\n        ${v?"invStdOutput[global_idx] = invStdDev;":""}\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ${S}(mean)) * ${S}(invStdDev) * gamma[i]\n           + ${h?"beta[i]":"0.0"};\n        }\n      }`,P=[{dims:u,dataType:e[0].dataType}];return r>1&&P.push({dims:m,dataType:1}),r>2&&P.push({dims:m,dataType:1}),r>3&&P.push({dims:n,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:_,getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(d/a/64)}})}},lu=(e,t)=>{Ec(e.inputs);let o=[0];e.outputCount>1&&o.push(-3),e.outputCount>2&&o.push(-3),e.outputCount>3&&o.push(3),e.compute(Oc(e.inputs,t,e.outputCount,!1),{outputs:o})},du=e=>{let t=e.epsilon;return ge({epsilon:t})}});var Pc,fn,kc,pu,Bc,Rc,mu,fu,hu=q(()=>{"use strict";Ne();$e();je();we();Pc=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},fn=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(o=>r.push(Number(o)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(o=>r.push(Number(o)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},kc=(e,t)=>{if(e.length>1){let r=fn(e,1),o=fn(e,2),n=fn(e,3);return n.length===0&&(n=[...Array(e[0].dims.length).keys()]),ge({starts:r,ends:o,axes:n})}else return t},pu=(e,t,r,o,n)=>{let s=e;return e<0&&(s+=r[o[t]]),n[t]<0?Math.max(0,Math.min(s,r[o[t]]-1)):Math.max(0,Math.min(s,r[o[t]]))},Bc=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${ce("uniforms.input_shape","i",r.length)};\n            let steps_i = ${ce("uniforms.steps","i",r.length)};\n            let signs_i = ${ce("uniforms.signs","i",r.length)};\n            let starts_i = ${ce("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,Rc=(e,t)=>{let r=e[0].dims,o=V.size(r),n=t.axes.length>0?V.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],s=fn(e,4);s.forEach(S=>S!==0||(()=>{throw new Error("step cannot be 0")})),s.length===0&&(s=Array(n.length).fill(1));let u=t.starts.map((S,_)=>pu(S,_,r,n,s)),d=t.ends.map((S,_)=>pu(S,_,r,n,s));if(n.length!==u.length||n.length!==d.length)throw new Error("start, ends and axes should have the same number of elements");if(n.length!==r.length)for(let S=0;S<r.length;++S)n.includes(S)||(u.splice(S,0,0),d.splice(S,0,r[S]),s.splice(S,0,1));let a=s.map(S=>Math.sign(S));s.forEach((S,_,P)=>{if(S<0){let A=(d[_]-u[_])/S,z=u[_],R=z+A*s[_];u[_]=R,d[_]=z,P[_]=-S}});let m=r.slice(0);n.forEach((S,_)=>{m[S]=Math.ceil((d[S]-u[S])/s[S])});let h={dims:m,dataType:e[0].dataType},g=j("output",e[0].dataType,m.length),w=M("input",e[0].dataType,e[0].dims.length),v=V.size(m),y=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:u.length},{name:"signs",type:"i32",length:a.length},{name:"steps",type:"u32",length:s.length}],C=[{type:"uint32",data:v},{type:"uint32",data:u},{type:"int32",data:a},{type:"uint32",data:s},...F(e[0].dims),...F(m)],I=S=>`\n      ${S.registerUniforms(y).declareVariables(w,g)}\n        ${Bc(w,g,r)}\n        ${S.mainStart()}\n          ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${g.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${g.setByOffset("global_idx",w.getByIndices("input_indices"))}\n      }`;return{name:"Slice",shaderCache:{hint:`${a.length}_${u.length}_${s.length}`,inputDependencies:["rank"]},getShaderSource:I,getRunData:()=>({outputs:[h],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:C})}},mu=(e,t)=>{Pc(e.inputs,t);let r=kc(e.inputs,t);e.compute(Rc(e.inputs,r),{inputs:[0]})},fu=e=>{let t=e.starts,r=e.ends,o=e.axes;return ge({starts:t,ends:r,axes:o})}});var Dc,Mc,gu,yu,bu=q(()=>{"use strict";$e();je();we();Dc=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Mc=(e,t)=>{let r=e.dims,o=V.size(r),n=64,s=t.axis;if(s<0&&(s=r.length+s),s<r.length-1)throw new Error("softmax only supports last axis for now.");let u=r[s],d=o/u,a=Fe(u),m=u/a,h=(I,S)=>S===4?`max(max(${I}.x, ${I}.y), max(${I}.z, ${I}.w))`:S===2?`max(${I}.x, ${I}.y)`:S===3?`max(max(${I}.x, ${I}.y), ${I}.z)`:I,g=M("x",e.dataType,e.dims,a),w=j("result",e.dataType,e.dims,a),v=g.type.value,y=Le(e.dataType)==="f32"?`var threadMax = ${v}(-3.402823e+38f);`:`var threadMax = ${v}(-65504.0h);`,C=I=>`\n      var<workgroup> rowMaxShared : ${v};\n      var<workgroup> rowSumShared : ${v};\n      var<workgroup> threadShared : array<${v}, ${n}>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${v} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${v}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${I.registerUniform("packedCols","i32").declareVariables(g,w)}\n      ${I.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = ${n};\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${y}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${v}(${h("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${v}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${v}(${tt("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`;return{name:"Softmax",shaderCache:{hint:`${a}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:d},programUniforms:[{type:"uint32",data:m}]}),getShaderSource:C}},gu=(e,t)=>{Dc(e.inputs),e.compute(Mc(e.inputs[0],t))},yu=e=>ge({axis:e.axis})});var Uc,zc,Vc,Nc,Wc,wu,vu,$u=q(()=>{"use strict";$e();je();we();Uc=e=>{if(!e||e.length<1)throw new Error("too few inputs")},zc=(e,t)=>{let r=[],o=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(n=>r.push(Number(n))),o=r.length),ge({numOutputs:o,axis:t.axis,splitSizes:r})},Vc=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${ce("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Nc=e=>{let t=e.length,r=[];for(let o=0;o<t;++o){let n=e[o].setByIndices("indices","input[global_idx]");t===1?r.push(n):o===0?r.push(`if (output_number == ${o}u) { ${n} }`):o===t-1?r.push(`else { ${n} }`):r.push(`else if (output_number == ${o}) { ${n} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join(`\n`)}\n      }`},Wc=(e,t)=>{let r=e[0].dims,o=V.size(r),n=e[0].dataType,s=V.normalizeAxis(t.axis,r.length),u=new Array(t.numOutputs),d=M("input",n,r),a=new Array(t.numOutputs),m=[],h=[],g=0,w=[{type:"uint32",data:o}];for(let y=0;y<t.numOutputs;y++){g+=t.splitSizes[y],a[y]=g;let C=r.slice();C[t.axis]=t.splitSizes[y],h.push(C),u[y]=j(`output${y}`,n,C),m.push({dims:h[y],dataType:e[0].dataType})}w.push({type:"uint32",data:a}),w.push(...F(r)),h.forEach(y=>w.push(...F(y)));let v=y=>`\n  ${y.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",a.length).declareVariables(d,...u)}\n  ${Vc(a.length)}\n  ${Nc(u)}\n\n  ${y.mainStart()}\n    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${d.offsetToIndices("global_idx")};\n    var index = ${d.indicesGet("indices",s)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${ce("uniforms.size_in_split_axis","output_number - 1u",a.length)};\n      ${d.indicesSet("indices",s,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:v,getRunData:()=>({outputs:m,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:w})}},wu=(e,t)=>{Uc(e.inputs);let r=e.inputs.length===1?t:zc(e.inputs,t);e.compute(Wc(e.inputs,r),{inputs:[0]})},vu=e=>{let t=e.axis,r=e.splitSizes,o=e.numOutputs<0?r.length:e.numOutputs;if(o!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return ge({axis:t,numOutputs:o,splitSizes:r})}});var Su,Hc,Gc,Lc,xu,_u=q(()=>{"use strict";Ne();$e();we();Su=e=>Array.from(e.getBigInt64Array(),Number),Hc=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Su(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Gc=(e,t)=>{let r=[];for(let o=0;o<e.length;++o)r.push(e[o]*t[o]);return r},Lc=e=>{let t=e[0].dims,r=Su(e[1]),o=Gc(t,r),n=V.size(o),s=e[0].dataType,u=M("input",s,t.length),d=j("output",s,o.length),a=m=>`\n      const inputShape = ${u.indices(...t)};\n      ${m.registerUniform("output_size","u32").declareVariables(u,d)}\n      ${m.mainStart()}\n      ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${d.offsetToIndices("global_idx")};\n      var input_indices: ${u.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${u.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${d.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${u.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${d.setByOffset("global_idx",u.getByIndices("input_indices"))}\n    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},...F(e[0].dims),...F(o)]}),getShaderSource:a}},xu=e=>{Hc(e.inputs),e.compute(Lc(e.inputs),{inputs:[0]})}});var Fc,jc,Cu,Iu=q(()=>{"use strict";Ne();$e();we();Fc=(e,t,r,o,n)=>{let s=j("output_data",n,r.length,4),u=M("a_data",t[1].dataType,t[1].dims.length,4),d=M("b_data",t[2].dataType,t[2].dims.length,4),a=M("c_data",t[0].dataType,t[0].dims.length,4),m,h=(g,w,v)=>`select(${w}, ${g}, ${v})`;if(!o)m=s.setByOffset("global_idx",h(u.getByOffset("global_idx"),d.getByOffset("global_idx"),a.getByOffset("global_idx")));else{let g=(w,v,y="")=>{let C=`a_data[index_a${v}][component_a${v}]`,I=`b_data[index_b${v}][component_b${v}]`,S=`bool(c_data[index_c${v}] & ${4278190080>>>(3-v)*8}u)`;return`\n            let output_indices${v} = ${s.offsetToIndices(`global_idx * 4u + ${v}u`)};\n            let offset_a${v} = ${u.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_b${v} = ${d.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_c${v} = ${a.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let index_a${v} = offset_a${v} / 4u;\n            let index_b${v} = offset_b${v} / 4u;\n            let index_c${v} = offset_c${v} / 4u;\n            let component_a${v} = offset_a${v} % 4u;\n            let component_b${v} = offset_b${v} % 4u;\n            ${w}[${v}] = ${y}(${h(C,I,S)});\n          `};n===9?m=`\n            var data = vec4<u32>(0);\n            ${g("data",0,"u32")}\n            ${g("data",1,"u32")}\n            ${g("data",2,"u32")}\n            ${g("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:m=`\n            ${g("output_data[global_idx]",0)}\n            ${g("output_data[global_idx]",1)}\n            ${g("output_data[global_idx]",2)}\n            ${g("output_data[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(a,u,d,s)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${m}\n      }`},jc=e=>{let t=e[1].dims,r=e[2].dims,o=e[0].dims,n=e[1].dataType,s=!(V.areEqual(t,r)&&V.areEqual(r,o)),u=t,d=V.size(t);if(s){let m=lt.calcShape(lt.calcShape(t,r,!1),o,!1);if(!m)throw new Error("Can\'t perform where op on the given tensors");u=m,d=V.size(u)}let a=Math.ceil(d/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:m=>Fc(m,e,u,s,n),getRunData:()=>({outputs:[{dims:u,dataType:n}],dispatchGroup:{x:Math.ceil(d/64/4)},programUniforms:[{type:"uint32",data:a},...F(o),...F(t),...F(r),...F(u)]})}},Cu=e=>{e.compute(jc(e.inputs))}});var Au,Tu=q(()=>{"use strict";Ja();Kn();ei();ri();Di();ji();Yi();Xn();ls();ps();ys();vs();xs();Is();Es();Ps();Bs();to();Us();Vs();ru();ou();tn();uu();cu();hu();bu();$u();_u();tr();Yn();Iu();Au=new Map([["Abs",[ni]],["Acos",[oi]],["Acosh",[ai]],["Add",[Mi]],["ArgMax",[Za,qn]],["ArgMin",[Ya,qn]],["Asin",[ii]],["Asinh",[si]],["Atan",[ui]],["Atanh",[li]],["Attention",[Qa]],["AveragePool",[qs,js]],["BatchNormalization",[Xa]],["BiasAdd",[ti]],["BiasSplitGelu",[Ri]],["Cast",[ci,di]],["Ceil",[mi]],["Clip",[pi]],["Concat",[qi,Ki]],["Conv",[no,ro]],["ConvTranspose",[us,ss]],["Cos",[fi]],["Cosh",[hi]],["CumSum",[ds,cs]],["Div",[Ui]],["Einsum",[hs,gs]],["Elu",[gi,on]],["Equal",[zi]],["Erf",[yi]],["Exp",[bi]],["Expand",[ws]],["Floor",[wi]],["FusedConv",[no,ro]],["Gather",[Ss,$s]],["GatherElements",[Cs,_s]],["Gelu",[vi]],["Gemm",[Ts,As]],["GlobalAveragePool",[Zs,Ys]],["GlobalMaxPool",[tu,eu]],["Greater",[Hi]],["GreaterOrEqual",[Li]],["InstanceNormalization",[Os]],["LayerNormalization",[ks]],["LeakyRelu",[$i,on]],["Less",[Gi]],["LessOrEqual",[Fi]],["Log",[Bi]],["MatMul",[es]],["MaxPool",[Qs,Xs]],["Mul",[Vi]],["MultiHeadAttention",[Ms,Ds]],["Neg",[xi]],["Not",[Si]],["Pad",[zs]],["Pow",[Ni]],["Range",[nu]],["Reciprocal",[_i]],["ReduceMin",[Ga]],["ReduceMean",[za]],["ReduceMax",[Ha]],["ReduceSum",[Fa]],["ReduceProd",[La]],["ReduceL1",[Va]],["ReduceL2",[Na]],["ReduceLogSum",[qa]],["ReduceLogSumExp",[Wa]],["ReduceSumSquare",[ja]],["Relu",[Ci]],["Resize",[iu,su]],["Sigmoid",[Ii]],["Sin",[Ai]],["Sinh",[Ti]],["Slice",[mu,fu]],["SkipLayerNormalization",[lu,du]],["Split",[wu,vu]],["Sqrt",[Ei]],["Softmax",[gu,yu]],["Sub",[Wi]],["Tan",[Oi]],["Tanh",[Pi]],["ThresholdedRelu",[ki,on]],["Tile",[xu]],["Transpose",[Ca,Ia]],["Where",[Cu]]])});var hn,Eu=q(()=>{"use strict";Xt();It();we();hn=class{constructor(t){this.backend=t;this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,r){this.repo.set(t,r)}run(t,r,o,n,s){Dt(t.programInfo.name);let u=this.backend.device,d=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2),d.setPipeline(t.computePipeline);let a=[];for(let h of r)a.push({binding:a.length,resource:{buffer:h.buffer}});for(let h of o)a.push({binding:a.length,resource:{buffer:h.buffer}});s&&a.push({binding:a.length,resource:s});let m=u.createBindGroup({layout:t.computePipeline.getBindGroupLayout(0),entries:a,label:t.programInfo.name});d.setBindGroup(0,m),d.dispatchWorkgroups(...n),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Mt(t.programInfo.name)}dispose(){}build(t,r){Dt(t.name);let o=this.backend.device,n=[];o.features.has("shader-f16")&&n.push("enable f16;");let s=xa(r),u=t.getShaderSource(s),d=`${n.join(`\n`)}\n${s.additionalImplementations}\n${u}`,a=o.createShaderModule({code:d,label:t.name});De("verbose",()=>`[WebGPU] ${t.name} shader code: ${d}`);let m=o.createComputePipeline({compute:{module:a,entryPoint:"main"},layout:"auto",label:t.name});return Mt(t.name),{programInfo:t,computePipeline:m}}normalizeDispatchGroupSize(t){let r=typeof t=="number"?t:t.x,o=typeof t=="number"?1:t.y||1,n=typeof t=="number"?1:t.z||1,s=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(r<=s&&o<=s&&n<=s)return[r,o,n];let u=r*o*n,d=Math.ceil(Math.sqrt(u));if(d>s){if(d=Math.ceil(Math.cbrt(u)),d>s)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[d,d,d]}else return[d,d,1]}}});var qc,Kc,gn,Ou=q(()=>{"use strict";Xt();Ne();It();ba();Sa();Tu();Eu();qc=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let o=0;o<e.length;++o){let n=e[o].dataType;switch(t[o]){case"none":{r.push("");break}case"type":{r.push(`${n}`);break}case"rank":{let s=e[o].dims.length;r.push(`${n};${s}`);break}case"dims":{let s=e[o].dims.join(",");r.push(`${n};${s}`);break}default:throw new Error(`unsupported input dependency: ${t[o]}`)}}return r.join("|")},Kc=(e,t,r)=>{let o=e.name;return e.shaderCache?.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+r+`:${qc(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,o},gn=class{constructor(){this.currentKernelId=null;this.commandEncoder=null;this.computePassEncoder=null;this.maxDispatchNumber=16;this.pendingDispatchNumber=0;this.pendingKernels=[];this.pendingQueries=new Map;this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let t=this.kernelCustomData.get(this.currentKernelId);return t||(t={},this.kernelCustomData.set(this.currentKernelId,t)),t}async initialize(t,r){this.env=t;let o=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:r.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:r.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:r.limits.maxStorageBufferBindingSize,maxBufferSize:r.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:r.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:r.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:r.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:r.limits.maxComputeWorkgroupSizeZ},requiredFeatures:o};r.features.has("chromium-experimental-timestamp-query-inside-passes")?o.push("chromium-experimental-timestamp-query-inside-passes"):r.features.has("timestamp-query")&&o.push("timestamp-query"),r.features.has("shader-f16")&&o.push("shader-f16"),this.device=await r.requestDevice(n),this.gpuDataManager=$a(this),this.programManager=new hn(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,ga(t.logLevel,!!t.debug),this.device.onuncapturederror=s=>{s.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${s.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=this.getCommandEncoder().beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Dt(),this.endComputePass();let t;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),t=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(t,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&t.mapAsync(GPUMapMode.READ).then(()=>{let r=new BigUint64Array(t.getMappedRange()),o=this.pendingQueries.get(t);for(let n=0;n<r.length/2;n++){let s=o[n],u=s.kernelId,d=this.kernels.get(u),a=d.kernelType,m=d.kernelName,h=s.programName,g=s.inputTensorViews,w=s.outputTensorViews,v=r[n*2],y=r[n*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=v);let C=Number(v-this.queryTimeBase),I=Number(y-this.queryTimeBase);if(!Number.isSafeInteger(C)||!Number.isSafeInteger(I))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:g.map(S=>({dims:S.dims,dataType:et(S.dataType)})),outputsMetadata:w.map(S=>({dims:S.dims,dataType:et(S.dataType)})),kernelId:u,kernelType:a,kernelName:m,programName:h,startTime:C,endTime:I});else{let S="";g.forEach((P,A)=>{S+=`input[${A}]: [${P.dims}] | ${et(P.dataType)}, `});let _="";w.forEach((P,A)=>{_+=`output[${A}]: [${P.dims}] | ${et(P.dataType)}, `}),console.log(`[profiling] kernel "${u}|${a}|${m}|${h}" ${S}${_}execution time: ${I-C} ns`)}Un("GPU",`${h}::${v}::${y}`)}t.unmap(),this.pendingQueries.delete(t)}),Mt()}run(t,r,o,n,s){Dt(t.name);let u=[];for(let _=0;_<r.length;++_){let P=this.gpuDataManager.get(r[_].data);if(!P)throw new Error(`no GPU data for input: ${r[_].data}`);u[_]=P}let{outputs:d,dispatchGroup:a,programUniforms:m}=t.getRunData(r),h=o.length===0?d.map((_,P)=>P):o;if(h.length!==d.length)throw new Error(`Output size ${h.length} must be equal to ${d.length}.`);let g=[],w=[];for(let _=0;_<d.length;++_){if(!Number.isInteger(h[_])||h[_]<-3||h[_]>=d.length)throw new Error(`Invalid output index: ${h[_]}`);if(h[_]===-3)continue;let P=h[_]===-1,A=h[_]===-2,z=P||A?s(d[_].dataType,d[_].dims):n(h[_],d[_].dataType,d[_].dims),R=this.gpuDataManager.get(z.data);if(!R)throw new Error(`no GPU data for output: ${z.data}`);if(P&&this.temporaryData.push(R),A){let N=this.kernelPersistentData.get(this.currentKernelId);N||(N=[],this.kernelPersistentData.set(this.currentKernelId,N)),N.push(R)}g.push(z),w.push(R)}let v;if(m){let _=0,P=[];m.forEach(N=>{let T=typeof N.data=="number"?[N.data]:N.data;if(T.length===0)return;let H=T.length<=2?T.length*4:16;_=Math.ceil(_/H)*H,P.push(_),_+=T.length>4?Math.ceil(T.length/4)*16:T.length*4});let A=16;_=Math.ceil(_/A)*A;let z=new ArrayBuffer(_);m.forEach((N,T)=>{let H=P[T],ie=typeof N.data=="number"?[N.data]:N.data;N.type==="int32"?new Int32Array(z,H,ie.length).set(ie):N.type==="uint32"?new Uint32Array(z,H,ie.length).set(ie):new Float32Array(z,H,ie.length).set(ie)});let R=this.gpuDataManager.create(_,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(R.buffer,0,z,0,_),this.gpuDataManager.release(R.id),v={offset:0,size:_,buffer:R.buffer}}let y=this.programManager.normalizeDispatchGroupSize(a),C=y[1]===1&&y[2]===1,I=Kc(t,r,C),S=this.programManager.getArtifact(I);if(S||(S=this.programManager.build(t,y),this.programManager.setArtifact(I,S),De("info",()=>`[artifact] key: ${I}, programName: ${t.name}`)),De("info",()=>`[ProgramManager] run "${t.name}" (key=${I}) with ${y[0]}x${y[1]}x${y[2]}`),this.queryType!=="none"){let _={kernelId:this.currentKernelId,programName:S.programInfo.name,inputTensorViews:r,outputTensorViews:g};this.pendingKernels.push(_)}return this.programManager.run(S,u,w,y,v),Mt(t.name),g}upload(t,r){this.gpuDataManager.upload(t,r)}memcpy(t,r){this.gpuDataManager.memcpy(t,r)}async download(t,r){await this.gpuDataManager.download(t,r)}alloc(t){return this.gpuDataManager.create(t).id}free(t){return this.gpuDataManager.release(t)}createKernel(t,r,o,n){let s=Au.get(t);if(!s)throw new Error(`kernel not implemented: ${t}`);let u={kernelType:t,kernelName:n,kernelEntry:s[0],attributes:[s[1],o]};this.kernels.set(r,u)}releaseKernel(t){let r=this.kernelPersistentData.get(t);if(r){for(let o of r)this.gpuDataManager.release(o.id);this.kernelPersistentData.delete(t)}this.kernelCustomData.delete(t),this.kernels.delete(t)}computeKernel(t,r,o){let n=this.kernels.get(t);if(!n)throw new Error(`kernel not created: ${t}`);let s=n.kernelType,u=n.kernelName,d=n.kernelEntry,a=n.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${s}] ${u}" is not allowed to be called recursively`);this.currentKernelId=t,a[0]&&(a[1]=a[0](a[1]),a[0]=void 0),De("info",()=>`[WebGPU] Start to run kernel "[${s}] ${u}"...`);let m=this.env.debug;this.temporaryData=[];try{return m&&this.device.pushErrorScope("validation"),d(r,a[1]),0}catch(h){return o.push(Promise.resolve(`[WebGPU] Kernel "[${s}] ${u}" failed. ${h}`)),1}finally{m&&o.push(this.device.popErrorScope().then(h=>h?`GPU validation error for kernel "[${s}] ${u}": ${h.message}`:null));for(let h of this.temporaryData)this.gpuDataManager.release(h.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(t,r,o,n){let s=this.sessionExternalDataMapping.get(t);s||(s=new Map,this.sessionExternalDataMapping.set(t,s));let u=s.get(r),d=this.gpuDataManager.registerExternalBuffer(o,n,u?.[1]);return s.set(r,[d,o]),d}unregisterBuffers(t){let r=this.sessionExternalDataMapping.get(t);r&&(r.forEach(o=>this.gpuDataManager.unregisterExternalBuffer(o[1])),this.sessionExternalDataMapping.delete(t))}getBuffer(t){let r=this.gpuDataManager.get(t);if(!r)throw new Error(`no GPU data for buffer: ${t}`);return r.buffer}createDownloader(t,r,o){return async()=>{let n=await Nn(this,t,r);return ya(n.buffer,o)}}writeTimestamp(t){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,t)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"))}}});var Pu={};Gr(Pu,{init:()=>Yc});var Ir,lo,Yc,ku=q(()=>{"use strict";Ne();Ou();It();$e();Ir=class e{constructor(t,r,o,n){this.module=t;this.dataType=r;this.data=o;this.dims=n}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(V.size(t)!==V.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},lo=class{constructor(t,r,o){this.module=t;this.backend=r;this.customDataOffset=0;this.customDataSize=0;let n=t.HEAPU32,s=o>>>2;this.opKernelContext=n[s++];let u=n[s++];this.outputCount=n[s++],this.customDataOffset=n[s++],this.customDataSize=n[s++];let d=[];for(let a=0;a<u;a++){let m=n[s++],h=n[s++],g=n[s++],w=[];for(let v=0;v<g;v++)w.push(n[s++]);d.push(new Ir(t,m,h,w))}this.inputs=d}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(t,r){let o=r?.inputs?.map(d=>typeof d=="number"?this.inputs[d]:d)??this.inputs,n=r?.outputs??[],s=(d,a,m)=>new Ir(this.module,a,this.output(d,m),m),u=(d,a)=>{let m=$r(d);if(!m)throw new Error(`Unsupported data type: ${d}`);let h=m*V.size(a);return new Ir(this.module,d,this.backend.gpuDataManager.create(h).id,a)};return this.backend.run(t,o,n,s,u)}output(t,r){let o=this.module.stackSave();try{let n=this.module.stackAlloc((1+r.length)*4),s=n>>2;this.module.HEAPU32[s++]=r.length;for(let u=0;u<r.length;u++)this.module.HEAPU32[s++]=r[u];return this.module._JsepOutput(this.opKernelContext,t,n)}catch(n){throw new Error(`Failed to generate kernel\'s output[${t}] with dims [${r}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(o)}}},Yc=async(e,t,r)=>{let o=e.jsepInit;if(!o)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");let n=new gn;await n.initialize(t,r),o(n,s=>n.alloc(s),s=>n.free(s),(s,u,d,a=!1)=>{if(a)De("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${s}, dst=${u}, size=${d}`),n.memcpy(s,u);else{De("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${s}, gpuDataId=${u}, size=${d}`);let m=e.HEAPU8.subarray(s>>>0,(s>>>0)+d);n.upload(u,m)}},async(s,u,d)=>{De("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${s}, dataOffset=${u}, size=${d}`),await n.download(s,()=>e.HEAPU8.subarray(u>>>0,(u>>>0)+d))},(s,u,d)=>n.createKernel(s,u,d,e.UTF8ToString(e._JsepGetNodeName(u))),s=>n.releaseKernel(s),(s,u,d,a)=>{De("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${d}, kernel=${s}, contextDataOffset=${u}`);let m=new lo(e,n,u);return n.computeKernel(s,m,a)})}});var jo;jo=Mo();var ll=Go(),kn,Bn=!1,Lr=!1,Fo=!1,dl=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},cl=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},pl=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",qo=async e=>{if(Bn)return Promise.resolve();if(Lr)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Fo)throw new Error("previous call to \'initializeWebAssembly()\' failed.");Lr=!0;let t=e.initTimeout,r=e.numThreads,o=e.simd,n=dl(r),s=o&&cl(),u=e.wasmPaths,d=typeof u=="string"?u:void 0,a=pl(s,n),m=typeof u=="object"?u[a]:void 0,h=!1,g=[];if(t>0&&g.push(new Promise(w=>{setTimeout(()=>{h=!0,w()},t)})),g.push(new Promise((w,v)=>{let y=n?ll:jo,C={locateFile:(I,S)=>{if(n&&I.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([Lo()],{type:"text/javascript"}));if(I.endsWith(".wasm")){if(m)return m;let _=d??S;return a==="ort-wasm-simd.wasm"?_+"ort-wasm-simd.jsep.wasm":a==="ort-wasm-simd-threaded.wasm"?_+"ort-wasm-simd-threaded.jsep.wasm":_+a}return S+I}};if(n)if(C.numThreads=r,typeof Blob>"u")C.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let I=`var ortWasmThreaded=${y.toString()};`;C.mainScriptUrlOrBlob=new Blob([I],{type:"text/javascript"})}y(C).then(I=>{Lr=!1,Bn=!0,kn=I,w()},I=>{Lr=!1,Fo=!0,v(I)})})),await Promise.race(g),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Re=()=>{if(Bn&&kn)return kn;throw new Error("WebAssembly is not initialized yet.")};var He=(e,t)=>{let r=Re(),o=r.lengthBytesUTF8(e)+1,n=r._malloc(o);return r.stringToUTF8(e,n,o),t.push(n),n},vr=(e,t,r,o)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([n,s])=>{let u=t?t+n:n;if(typeof s=="object")vr(s,u+".",r,o);else if(typeof s=="string"||typeof s=="number")o(u,s.toString());else if(typeof s=="boolean")o(u,s?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof s}`)})},ke=e=>{let t=Re(),r=t.stackSave();try{let o=t.stackAlloc(8);t._OrtGetLastError(o,o+4);let n=t.HEAP32[o/4],s=t.HEAPU32[o/4+1],u=s?t.UTF8ToString(s):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${u}`)}finally{t.stackRestore(r)}};var Ko=e=>{let t=Re(),r=0,o=[],n=e||{};try{if(e?.logSeverityLevel===void 0)n.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)n.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(n.terminate=!1);let s=0;return e?.tag!==void 0&&(s=He(e.tag,o)),r=t._OrtCreateRunOptions(n.logSeverityLevel,n.logVerbosityLevel,!!n.terminate,s),r===0&&ke("Can\'t create run options."),e?.extra!==void 0&&vr(e.extra,"",new WeakSet,(u,d)=>{let a=He(u,o),m=He(d,o);t._OrtAddRunConfigEntry(r,a,m)!==0&&ke(`Can\'t set a run config entry: ${u} - ${d}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseRunOptions(r),o.forEach(u=>t._free(u)),s}};var ml=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},fl=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},hl=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},gl=(e,t,r)=>{for(let o of t){let n=typeof o=="string"?o:o.name;switch(n){case"webnn":if(n="WEBNN",typeof o!="string"){let u=o;if(u?.deviceType){let d=He("deviceType",r),a=He(u.deviceType,r);Re()._OrtAddSessionConfigEntry(e,d,a)!==0&&ke(`Can\'t set a session config entry: \'deviceType\' - ${u.deviceType}.`)}if(u?.numThreads){let d=u.numThreads;(typeof d!="number"||!Number.isInteger(d)||d<0)&&(d=0);let a=He("numThreads",r),m=He(d.toString(),r);Re()._OrtAddSessionConfigEntry(e,a,m)!==0&&ke(`Can\'t set a session config entry: \'numThreads\' - ${u.numThreads}.`)}if(u?.powerPreference){let d=He("powerPreference",r),a=He(u.powerPreference,r);Re()._OrtAddSessionConfigEntry(e,d,a)!==0&&ke(`Can\'t set a session config entry: \'powerPreference\' - ${u.powerPreference}.`)}}break;case"webgpu":if(n="JS",typeof o!="string"){let u=o;if(u?.preferredLayout){if(u.preferredLayout!=="NCHW"&&u.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${u.preferredLayout}`);let d=He("preferredLayout",r),a=He(u.preferredLayout,r);Re()._OrtAddSessionConfigEntry(e,d,a)!==0&&ke(`Can\'t set a session config entry: \'preferredLayout\' - ${u.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${n}`)}let s=He(n,r);Re()._OrtAppendExecutionProvider(e,s)!==0&&ke(`Can\'t append execution provider: ${n}.`)}},Yo=e=>{let t=Re(),r=0,o=[],n=e||{};hl(n);try{let s=ml(n.graphOptimizationLevel??"all"),u=fl(n.executionMode??"sequential"),d=typeof n.logId=="string"?He(n.logId,o):0,a=n.logSeverityLevel??2;if(!Number.isInteger(a)||a<0||a>4)throw new Error(`log serverity level is not valid: ${a}`);let m=n.logVerbosityLevel??0;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log verbosity level is not valid: ${m}`);let h=typeof n.optimizedModelFilePath=="string"?He(n.optimizedModelFilePath,o):0;if(r=t._OrtCreateSessionOptions(s,!!n.enableCpuMemArena,!!n.enableMemPattern,u,!!n.enableProfiling,0,d,a,m,h),r===0&&ke("Can\'t create session options."),n.executionProviders&&gl(r,n.executionProviders,o),n.freeDimensionOverrides)for(let[g,w]of Object.entries(n.freeDimensionOverrides)){if(typeof g!="string")throw new Error(`free dimension override name must be a string: ${g}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let v=He(g,o);t._OrtAddFreeDimensionOverride(r,v,w)!==0&&ke(`Can\'t set a free dimension override: ${g} - ${w}.`)}return n.extra!==void 0&&vr(n.extra,"",new WeakSet,(g,w)=>{let v=He(g,o),y=He(w,o);t._OrtAddSessionConfigEntry(r,v,y)!==0&&ke(`Can\'t set a session config entry: ${g} - ${w}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseSessionOptions(r),o.forEach(u=>t._free(u)),s}};Ne();var Jo=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(t){if(t.code==="ERR_FS_FILE_TOO_LARGE"){let r=(void 0)(e),o=[];for await(let n of r)o.push(n);return new Uint8Array(Buffer.concat(o))}throw t}else{let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),o=r?parseInt(r,10):0;if(o<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let n=t.body.getReader(),s;try{s=new ArrayBuffer(o)}catch(d){if(d instanceof RangeError){let a=Math.ceil(o/65536);s=new WebAssembly.Memory({initial:a,maximum:a}).buffer}else throw d}let u=0;for(;;){let{done:d,value:a}=await n.read();if(d)break;let m=a.byteLength;new Uint8Array(s,u,m).set(a),u+=m}return new Uint8Array(s,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)};var Zc=(e,t)=>{Re()._OrtInit(e,t)!==0&&ke("Can\'t initialize onnxruntime.")},Ru=async e=>{Zc(e.wasm.numThreads,Sr(e.logLevel))},Du=async(e,t)=>{if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=await navigator.gpu.requestAdapter();if(!r)throw new Error(\'Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.\');if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");let o=(ku(),Jt(Pu)).init;await o(Re(),e,r)}},Ar=new Map,Jc=e=>{let t=Re(),r=t.stackSave();try{let o=t.stackAlloc(8);return t._OrtGetInputOutputCount(e,o,o+4)!==0&&ke("Can\'t get session input/output count."),[t.HEAP32[o/4],t.HEAP32[o/4+1]]}finally{t.stackRestore(r)}},co=e=>{let t=Re(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},Mu=async(e,t)=>{let r,o,n=Re();Array.isArray(e)?[r,o]=e:e.buffer===n.HEAPU8.buffer?[r,o]=[e.byteOffset,e.byteLength]:[r,o]=co(e);let s=0,u=0,d=0,a=[],m=[],h=[];try{if([u,a]=Yo(t),t?.externalData&&n.mountExternalData){let S=[];for(let _ of t.externalData){let P=typeof _=="string"?_:_.path;S.push(Jo(typeof _=="string"?_:_.data).then(A=>{n.mountExternalData(P,A)}))}await Promise.all(S)}s=n._OrtCreateSession(r,o,u),s===0&&ke("Can\'t create a session.");let[g,w]=Jc(s),v=[],y=[],C=[];for(let S=0;S<g;S++){let _=n._OrtGetInputName(s,S);_===0&&ke("Can\'t get an input name."),m.push(_),v.push(n.UTF8ToString(_))}for(let S=0;S<w;S++){let _=n._OrtGetOutputName(s,S);_===0&&ke("Can\'t get an output name."),h.push(_);let P=n.UTF8ToString(_);y.push(P);{let A=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[P]??"cpu";if(A!=="cpu"&&A!=="cpu-pinned"&&A!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${A}.`);C.push(A)}}let I=null;return C.some(S=>S==="gpu-buffer")&&(d=n._OrtCreateBinding(s),d===0&&ke("Can\'t create IO binding."),I={handle:d,outputPreferredLocations:C,outputPreferredLocationsEncoded:C.map(S=>Dn(S))}),Ar.set(s,[s,m,h,I]),[s,v,y]}catch(g){throw m.forEach(w=>n._OrtFree(w)),h.forEach(w=>n._OrtFree(w)),d!==0&&n._OrtReleaseBinding(d),s!==0&&n._OrtReleaseSession(s),g}finally{n._free(r),u!==0&&n._OrtReleaseSessionOptions(u),a.forEach(g=>n._free(g)),n.unmountExternalData?.()}},Uu=e=>{let t=Re(),r=Ar.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,n,s,u]=r;u&&t._OrtReleaseBinding(u.handle),t.jsepUnregisterBuffers?.(e),n.forEach(d=>t._OrtFree(d)),s.forEach(d=>t._OrtFree(d)),t._OrtReleaseSession(o),Ar.delete(e)},Bu=(e,t,r,o,n)=>{if(!e){t.push(0);return}let s=Re(),u=e[0],d=e[1],a=e[3],m,h;if(u==="string"&&a==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(a==="gpu-buffer"){let v=e[2].gpuBuffer,y=$r(Rn(u));h=d.reduce((C,I)=>C*I,1)*y,m=s.jsepRegisterBuffer(o,n,v,h)}else{let v=e[2];if(Array.isArray(v)){h=4*v.length,m=s._malloc(h),r.push(m);let y=m/4;for(let C=0;C<v.length;C++){if(typeof v[C]!="string")throw new TypeError(`tensor data at index ${C} is not a string`);s.HEAPU32[y++]=He(v[C],r)}}else h=v.byteLength,m=s._malloc(h),r.push(m),s.HEAPU8.set(new Uint8Array(v.buffer,v.byteOffset,h),m)}let g=s.stackSave(),w=s.stackAlloc(4*d.length);try{let v=w/4;d.forEach(C=>s.HEAP32[v++]=C);let y=s._OrtCreateTensor(Rn(u),m,h,w,d.length,Dn(a));y===0&&ke(`Can\'t create tensor for input/output. session=${o}, index=${n}.`),t.push(y)}finally{s.stackRestore(g)}},zu=e=>{let r=new TextEncoder().encode(e),o=Re(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtConfigure(n,r.byteLength);if(s===0)throw new Error("Can\'t get an configure key");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Vu=e=>{let r=new TextEncoder().encode(e),o=Re(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtAuth(n,r.byteLength);if(s===0)throw new Error("Can\'t get an auth result");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Nu=async(e,t,r,o,n,s)=>{let u=Re(),d=Ar.get(e);if(!d)throw new Error(`cannot run inference. invalid session id: ${e}`);let[a,m,h,g]=d,w=t.length,v=o.length,y=0,C=[],I=[],S=[],_=[],P=u.stackSave(),A=u.stackAlloc(w*4),z=u.stackAlloc(w*4),R=u.stackAlloc(v*4),N=u.stackAlloc(v*4);try{[y,C]=Ko(s);for(let X=0;X<w;X++)Bu(r[X],I,_,e,t[X]);for(let X=0;X<v;X++)Bu(n[X],S,_,e,w+o[X]);let T=A/4,H=z/4,ie=R/4,Z=N/4;for(let X=0;X<w;X++)u.HEAPU32[T++]=I[X],u.HEAPU32[H++]=m[t[X]];for(let X=0;X<v;X++)u.HEAPU32[ie++]=S[X],u.HEAPU32[Z++]=h[o[X]];if(g){let{handle:X,outputPreferredLocations:Ee,outputPreferredLocationsEncoded:Pe}=g;if(m.length!==w)throw new Error(`input count from feeds (${w}) is expected to be always equal to model\'s input count (${m.length}).`);for(let fe=0;fe<w;fe++){let Ce=t[fe];await u._OrtBindInput(X,m[Ce],I[fe])!==0&&ke(`Can\'t bind input[${fe}] for session=${e}.`)}for(let fe=0;fe<v;fe++){let Ce=o[fe];n[fe]?.[3]?u._OrtBindOutput(X,h[Ce],S[fe],0)!==0&&ke(`Can\'t bind pre-allocated output[${fe}] for session=${e}.`):u._OrtBindOutput(X,h[Ce],0,Pe[Ce])!==0&&ke(`Can\'t bind output[${fe}] to ${Ee[fe]} for session=${e}.`)}}let K;g?K=await u._OrtRunWithBinding(a,g.handle,v,R,y):K=await u._OrtRun(a,z,A,w,N,v,R,y),K!==0&&ke("failed to call OrtRun().");let Q=[];for(let X=0;X<v;X++){let Ee=u.HEAPU32[R/4+X];if(Ee===S[X]){Q.push(n[X]);continue}let Pe=u.stackSave(),fe=u.stackAlloc(4*4),Ce=!1,he,ye=0;try{u._OrtGetTensorData(Ee,fe,fe+4,fe+8,fe+12)!==0&&ke(`Can\'t access output tensor data on index ${X}.`);let Me=fe/4,Ge=u.HEAPU32[Me++];ye=u.HEAPU32[Me++];let G=u.HEAPU32[Me++],re=u.HEAPU32[Me++],be=[];for(let Ve=0;Ve<re;Ve++)be.push(u.HEAPU32[G/4+Ve]);u._OrtFree(G);let rt=be.reduce((Ve,Ue)=>Ve*Ue,1);he=et(Ge);let ze=g?.outputPreferredLocations[o[X]];if(he==="string"){if(ze==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let Ve=[],Ue=ye/4;for(let St=0;St<rt;St++){let nt=u.HEAPU32[Ue++],zt=St===rt-1?void 0:u.HEAPU32[Ue]-nt;Ve.push(u.UTF8ToString(nt,zt))}Q.push([he,be,Ve,"cpu"])}else if(ze==="gpu-buffer"&&rt>0){let Ve=u.jsepGetBuffer(ye),Ue=$r(Ge);if(Ue===void 0||!Zo(he))throw new Error(`Unsupported data type: ${he}`);Ce=!0,Q.push([he,be,{gpuBuffer:Ve,download:u.jsepCreateDownloader(Ve,rt*Ue,he),dispose:()=>{u._OrtReleaseTensor(Ee)}},"gpu-buffer"])}else{let Ve=Fr(he),Ue=new Ve(rt);new Uint8Array(Ue.buffer,Ue.byteOffset,Ue.byteLength).set(u.HEAPU8.subarray(ye,ye+Ue.byteLength)),Q.push([he,be,Ue,"cpu"])}}finally{u.stackRestore(Pe),he==="string"&&ye&&u._free(ye),Ce||u._OrtReleaseTensor(Ee)}}return g&&u._OrtClearBoundOutputs(g.handle),Q}finally{u.stackRestore(P),I.forEach(T=>u._OrtReleaseTensor(T)),S.forEach(T=>u._OrtReleaseTensor(T)),_.forEach(T=>u._free(T)),y!==0&&u._OrtReleaseRunOptions(y),C.forEach(T=>u._free(T))}},Wu=e=>{let t=Re(),r=Ar.get(e);if(!r)throw new Error("invalid session id");let o=r[0],n=t._OrtEndProfiling(o);n===0&&ke("Can\'t get an profile file name."),t._OrtFree(n)},Hu=e=>{let t=[];for(let r of e){let o=r[2];!Array.isArray(o)&&"buffer"in o&&t.push(o.buffer)}return t};self.onmessage=e=>{let{type:t,in:r}=e.data;try{switch(t){case"init-wasm":qo(r.wasm).then(()=>{Ru(r).then(()=>{postMessage({type:t})},o=>{postMessage({type:t,err:o})})},o=>{postMessage({type:t,err:o})});break;case"init-ep":{let{epName:o,env:n}=r;Du(n,o).then(()=>{postMessage({type:t})},s=>{postMessage({type:t,err:s})});break}case"copy-from":{let{buffer:o}=r,n=co(o);postMessage({type:t,out:n});break}case"create":{let{model:o,options:n}=r;Mu(o,n).then(s=>{postMessage({type:t,out:s})},s=>{postMessage({type:t,err:s})});break}case"release":Uu(r),postMessage({type:t});break;case"run":{let{sessionId:o,inputIndices:n,inputs:s,outputIndices:u,options:d}=r;Nu(o,n,s,u,new Array(u.length).fill(null),d).then(a=>{a.some(m=>m[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:a},Hu(a))},a=>{postMessage({type:t,err:a})});break}case"configure":try{let o=zu(e.data.in);postMessage({type:"configure",out:o})}catch(o){postMessage({type:"configure",err:o})}break;case"auth":try{let o=Vu(e.data.in);postMessage({type:"auth",out:o})}catch(o){postMessage({type:"auth",err:o})}break;case"end-profiling":Wu(r),postMessage({type:t});break;default:}}catch(o){postMessage({type:t,err:o})}};})();\n/**\n * @license\n * Copyright 2021 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n'})),rx=Bh((function(){var e;ef(),tx(),uw(),Eb=function(){return!!Ql.wasm.proxy&&("undefined"===typeof document?"undefined":_typeof(document))<"u"},Pb=!1,Rb=!1,Bb=!1,Mb=new Map,Lb=function(e,t){var n=Mb.get(e);n?n.push(t):Mb.set(e,[t])},Fb=function(){if(Pb||!Rb||Bb||!Ob)throw new Error("worker not ready")},Nb=function(e){switch(e.data.type){case"init-wasm":Pb=!1,e.data.err?(Bb=!0,Db[1](e.data.err)):(Rb=!0,Db[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"run":case"end-profiling":var t=Mb.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out)}},Ub=("undefined"===typeof document?"undefined":_typeof(document))<"u"?null===(e=document)||void 0===e||null===(e=e.currentScript)||void 0===e?void 0:e.src:void 0,jb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Rb){e.next=21;break}if(!Pb){e.next=3;break}throw new Error("multiple calls to 'initWasm()' detected.");case 3:if(!Bb){e.next=5;break}throw new Error("previous call to 'initWasm()' failed.");case 5:if(Pb=!0,!Eb()){e.next=7;break}return e.abrupt("return",(void 0===Ql.wasm.wasmPaths&&Ub&&0!==Ub.indexOf("blob:")&&(Ql.wasm.wasmPaths=Ub.substr(0,+Ub.lastIndexOf("/")+1)),new Promise((function(e,t){var n;null===(n=Ob)||void 0===n||n.terminate();var r=URL.createObjectURL(new Blob([nx()],{type:"text/javascript"}));(Ob=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=function(e){return t(e)},Ob.onmessage=Nb,URL.revokeObjectURL(r),Db=[e,t];var i={type:"init-wasm",in:Ql};Ob.postMessage(i)}))));case 7:return e.prev=7,e.next=10,Af(Ql.wasm);case 10:return e.next=12,gb(Ql);case 12:Rb=!0,e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(7),Bb=!0,e.t0;case 18:return e.prev=18,Pb=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[7,15,18,21]])})));return function(){return e.apply(this,arguments)}}(),Gb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Eb()){e.next=2;break}return e.abrupt("return",(Fb(),new Promise((function(e,n){Lb("init-ep",[e,n]);var r={type:"init-ep",in:{epName:t,env:Ql}};Ob.postMessage(r)}))));case 2:return e.next=4,mb(Ql,t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),zb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eb()?(Fb(),new Promise((function(e,n){Lb("copy-from",[e,n]);var r={type:"copy-from",in:{buffer:t}};Ob.postMessage(r,[t.buffer])}))):bb(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Hb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Eb()){e.next=4;break}if(null===n||void 0===n||!n.preferredOutputLocation){e.next=3;break}throw new Error('session option "preferredOutputLocation" is not supported for proxy.');case 3:return e.abrupt("return",(Fb(),new Promise((function(e,r){Lb("create",[e,r]);var i={type:"create",in:{model:t,options:n}},o=[];t instanceof Uint8Array&&o.push(t.buffer),Ob.postMessage(i,o)}))));case 4:return e.abrupt("return",xb(t,n));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Vb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Eb()){e.next=2;break}return e.abrupt("return",(Fb(),new Promise((function(e,n){Lb("release",[e,n]);var r={type:"release",in:t};Ob.postMessage(r)}))));case 2:_b(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Wb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eb()?(Fb(),new Promise((function(e,n){Lb("configure",[e,n]);var r={type:"configure",in:t};Ob.postMessage(r)}))):Ab(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$b=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eb()?(Fb(),new Promise((function(e,n){Lb("auth",[e,n]);var r={type:"auth",in:t};Ob.postMessage(r)}))):Cb(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Yb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i,o,a){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Eb()){e.next=6;break}if(!r.some((function(e){return"cpu"!==e[3]}))){e.next=3;break}throw new Error("input tensor on GPU is not supported for proxy.");case 3:if(!o.some((function(e){return e}))){e.next=5;break}throw new Error("pre-allocated output tensor is not supported for proxy.");case 5:return e.abrupt("return",(Fb(),new Promise((function(e,o){Lb("run",[e,o]);var s=r,u={type:"run",in:{sessionId:t,inputIndices:n,inputs:s,outputIndices:i,options:a}};Ob.postMessage(u,Tb(s))}))));case 6:return e.abrupt("return",kb(t,n,r,i,o,a));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}(),Kb=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Eb()){e.next=2;break}return e.abrupt("return",(Fb(),new Promise((function(e,n){Lb("end-profiling",[e,n]);var r={type:"end-profiling",in:t};Ob.postMessage(r)}))));case 2:Sb(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),ix=Bh((function(){ef(),rx(),fw(),dw(),Xb=function(e,t){switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error("invalid data location: ".concat(e.location," for ").concat(t()))}},Zb=function(e){switch(e[3]){case"cpu":return new ph(e[0],e[2],e[1]);case"gpu-buffer":var t=e[0];if(!jf(t))throw new Error("not supported data type: ".concat(t," for deserializing GPU tensor"));var n=e[2],r=n.gpuBuffer,i=n.download,o=n.dispose;return ph.fromGpuBuffer(r,{dataType:t,dims:e[1],download:i,dispose:o});default:throw new Error("invalid data location: ".concat(e[3]))}},qb=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"fetchModelAndCopyToWasmMemory",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=zb,e.next=3,zf(t);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadModel",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,i,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mh(),"string"!=typeof t){e.next=14;break}if(!(_typeof(kh)<"u"&&kh.versions&&kh.versions.node)){e.next=8;break}return e.next=5,zf(t);case 5:e.t1=e.sent,e.next=11;break;case 8:return e.next=10,this.fetchModelAndCopyToWasmMemory(t);case 10:e.t1=e.sent;case 11:e.t0=e.t1,e.next=15;break;case 14:e.t0=t;case 15:return o=e.t0,e.next=18,Hb(o,n);case 18:r=e.sent,i=_slicedToArray(r,3),this.sessionId=i[0],this.inputNames=i[1],this.outputNames=i[2],vh();case 24:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vb(this.sessionId));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Wb(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"auth",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$b(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o,a,s,u,c,l,h,f,d,p=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mh(),i=[],o=[],Object.entries(t).forEach((function(e){var t=e[0],n=e[1],r=p.inputNames.indexOf(t);if(-1===r)throw new Error("invalid input '".concat(t,"'"));i.push(n),o.push(r)})),a=[],s=[],Object.entries(n).forEach((function(e){var t=e[0],n=e[1],r=p.outputNames.indexOf(t);if(-1===r)throw new Error("invalid output '".concat(t,"'"));a.push(n),s.push(r)})),u=i.map((function(e,t){return Xb(e,(function(){return'input "'.concat(p.inputNames[o[t]],'"')}))})),c=a.map((function(e,t){return e?Xb(e,(function(){return'output "'.concat(p.outputNames[s[t]],'"')})):null})),e.next=9,Yb(this.sessionId,o,u,s,c,r);case 9:for(l=e.sent,h={},f=0;f<l.length;f++)h[this.outputNames[s[f]]]=null!==(d=a[f])&&void 0!==d?d:Zb(l[f]);return e.abrupt("return",(vh(),h));case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"startProfiling",value:function(){}},{key:"endProfiling",value:function(){Kb(this.sessionId)}}]),e}()})),ox=Bh((function(){ef(),rx(),ix(),Jb=function(){if(("number"!=typeof Ql.wasm.initTimeout||Ql.wasm.initTimeout<0)&&(Ql.wasm.initTimeout=0),"boolean"!=typeof Ql.wasm.simd&&(Ql.wasm.simd=!0),"boolean"!=typeof Ql.wasm.proxy&&(Ql.wasm.proxy=!1),"boolean"!=typeof Ql.wasm.trace&&(Ql.wasm.trace=!1),"number"!=typeof Ql.wasm.numThreads||!Number.isInteger(Ql.wasm.numThreads)||Ql.wasm.numThreads<=0){(("undefined"===typeof self?"undefined":_typeof(self))<"u"&&!self.crossOriginIsolated||_typeof(kh)<"u"&&kh.versions&&kh.versions.node)&&(Ql.wasm.numThreads=1);var e=("undefined"===typeof navigator?"undefined":_typeof(navigator))>"u"?(void 0)().length:navigator.hardwareConcurrency;Ql.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},Qb=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Jb(),e.next=3,jb();case 3:return e.next=5,Gb(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createInferenceSessionHandler",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new qb,e.next=3,r.loadModel(t,n);case 3:return e.abrupt("return",Promise.resolve(r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()})),ax={};Mh(ax,{wasmBackend:function(){return sx}});var sx,ux=Bh((function(){ox(),sx=new Qb}));ef(),ef(),ef();var cx=(ux(),Lh(ax)).wasmBackend;Kl("webgpu",cx,5),Kl("cpu",cx,10),Kl("wasm",cx,10),Object.defineProperty(Ql.versions,"web",{value:"1.17.0",enumerable:!0});var lx=__nested_webpack_require_1427617__(5620),hx=__nested_webpack_require_1427617__(4941),fx=__nested_webpack_require_1427617__(9899),dx=__nested_webpack_require_1427617__.n(fx);function px(e){return px="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},px(e)}function yx(){yx=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==px(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(px(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function gx(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function mx(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){gx(o,r,i,a,s,"next",e)}function s(e){gx(o,r,i,a,s,"throw",e)}a(void 0)}))}}function vx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wx(r.key),r)}}function wx(e){var t=function(e){if("object"!=px(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=px(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==px(t)?t:String(t)}var bx,xx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name="tsvb"}var t,n,i;return t=e,n=[{key:"get",value:function(){var e=mx(yx().mark((function e(t,n){var i,o;return yx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cache){e.next=4;break}return e.next=3,caches.open(this._name);case 3:this._cache=e.sent;case 4:return e.next=6,this._cache.match(t);case 6:if(void 0===(i=e.sent)){e.next=9;break}return e.abrupt("return",i);case 9:return e.next=11,fetch(t);case 11:if((i=e.sent).ok){e.next=15;break}return r.ie.notify({message:"".concat(t," don't found"),emitter:r.E7.ML_INFERENCE}),e.abrupt("return",i);case 15:if(!n){e.next=20;break}return o=i.clone(),e.next=19,this._cache.put(t,i);case 19:return e.abrupt("return",o);case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:(i=mx(yx().mark((function e(){return yx().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.delete(this._name);case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],n&&vx(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _x(e){return _x="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},_x(e)}function Ix(){Ix=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_x(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(_x(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Ax(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Cx(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ax(o,r,i,a,s,"next",e)}function s(e){Ax(o,r,i,a,s,"throw",e)}a(void 0)}))}}function kx(){return Sx.apply(this,arguments)}function Sx(){return Sx=Cx(Ix().mark((function e(){var t,n=arguments;return Ix().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},void 0===bx){e.next=3;break}return e.abrupt("return",bx);case 3:return e.next=5,Cx(Ix().mark((function e(){var n;return Ix().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.gpu){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.gpu.requestAdapter(t);case 6:return n=e.sent,e.next=9,n.requestDevice();case 9:return e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})))();case 5:return bx=e.sent,e.abrupt("return",bx);case 7:case"end":return e.stop()}}),e)}))),Sx.apply(this,arguments)}function Tx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ex(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ex(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ex(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ox(e){return Ox="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Ox(e)}function Px(){Px=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Ox(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Ox(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Rx(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Bx(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Rx(o,r,i,a,s,"next",e)}function s(e){Rx(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Dx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fx(r.key),r)}}function Lx(e,t,n){return t&&Mx(e.prototype,t),n&&Mx(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fx(e){var t=function(e){if("object"!=Ox(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ox(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ox(t)?t:String(t)}var Nx={segmentation:4,facedetector:3,colorcorrector:3,lowlighter:3},Ux=function(){function e(){Dx(this,e),this.inference=null,this.ready=!1,this.preset="balanced",this.isGPU=!1}var t,n,i;return Lx(e,[{key:"onAuth",value:function(){}},{key:"setPresetManager",value:function(e){this.presetManager=e}},{key:"preload",value:(i=Bx(Px().mark((function e(t){return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"cache",value:(n=Bx(Px().mark((function e(t,n){return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"getType",value:function(){return"custom"}},{key:"setPreset",value:function(e){this.preset=e}},{key:"setBackend",value:function(e){this.inference=e}},{key:"init",value:(t=Bx(Px().mark((function e(t){var n,i,o,a;return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.inference.setPreset(this.preset);case 3:return e.next=5,this.inference.configure(t);case 5:return i=e.sent,e.next=8,Hx(i,t);case 8:return o=e.sent,e.next=11,this.inference.auth(o.data.key);case 11:if(a=e.sent,"active"==JSON.parse(a).status){e.next=15;break}throw new Error("Authentication failed");case 15:this.ready=!0,r.ie.notify({message:"custom ".concat(this.preset),type:r.cL.INFO,emitter:r.E7.ML_INFERENCE}),e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(0),r.ie.notify({message:null!==(n=e.t0.message)&&void 0!==n?n:e.t0,emitter:r.E7.ML_INFERENCE,cause:e.t0}),e.t0;case 23:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(e){return t.apply(this,arguments)})},{key:"isReady",value:function(){return this.ready}},{key:"run",value:function(e,t,n){var r=this;return new Promise((function(t,n){t(r.inference.run(e))}))}}]),e}(),jx=function(){function e(){Dx(this,e),this.sessions=new Map,this.sessionPromises=new Map,this.ready=!1,this.preset="balanced",this.segmentationModel="",this.isGPU=!1,this._loader=new xx}var t,n,i,o,a;return Lx(e,[{key:"onAuth",value:function(e){var t="function"==typeof e;this.authFunction=t?e:void 0}},{key:"setPresetManager",value:function(e){this.presetManager=e}},{key:"getModel",value:function(e){return"segmentation"===e?this.segmentationModel:lx.M.getModelUrl(lx.M.MODELS[e])}},{key:"getType",value:function(){return"onnx"}},{key:"setBackend",value:function(e){}},{key:"setPreset",value:function(e){this.preset=e,this.presetManager?this.segmentationModel=this.presetManager.getModelURL(this.preset):this.segmentationModel=lx.M.getModelUrl(lx.M.PRESETS[lx.M.PRESET])}},{key:"cache",value:(a=Bx(Px().mark((function e(){var t,n,r,i,o,a=arguments;return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>1&&void 0!==a[1]&&a[1],!(a.length>0&&void 0!==a[0]&&a[0])){e.next=6;break}return e.next=5,this._loader.delete();case 5:return e.abrupt("return");case 6:for(n=0,r=Object.entries(lx.M.MODELS);n<r.length;n++)i=Tx(r[n],2),o=i[0],""!==i[1]&&this._loader.get(this.getModel(o),!0);t||(this.setPreset(lx.M.PRESET),this._loader.get(this.getModel("segmentation"),!0));case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"preload",value:(o=Bx(Px().mark((function e(){var t,n,r,i,o,a=arguments;return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]&&a[0],n=0,r=Object.entries(lx.M.MODELS);case 2:if(!(n<r.length)){e.next=10;break}if(i=Tx(r[n],2),o=i[0],""===i[1]){e.next=7;break}return e.next=7,this.init(lx.M.CUSTOMER_ID,o);case 7:n++,e.next=2;break;case 10:if(t){e.next=14;break}return this.setPreset(lx.M.PRESET),e.next=14,this.init(lx.M.CUSTOMER_ID,"segmentation");case 14:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"init",value:(i=Bx(Px().mark((function e(t,n){var i,o,a,s,u,c,l,h,f,d=this;return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],this.sessionPromises.forEach((function(e,t,n){"pending"==e.state&&o.push(e.promise)})),e.next=4,Promise.all(o);case 4:if(a=this.getModel(n),!this.sessionPromises.has(a)){e.next=7;break}return e.abrupt("return",null===(i=this.sessionPromises.get(a))||void 0===i?void 0:i.promise);case 7:return s=new tl,this.sessionPromises.set(a,s),e.next=11,this._loader.get(a);case 11:return u=e.sent,e.next=14,u.arrayBuffer();case 14:if(c=e.sent,Ch.CU,l="wasm","segmentation"!=n){e.next=23;break}if("webgpu"!=lx.M.PROVIDER&&"auto"!=lx.M.PROVIDER){e.next=23;break}return e.next=21,kx();case 21:e.sent?l="webgpu":r.ie.notify({message:"WebGPU is not supported",emitter:r.E7.ML_INFERENCE});case 23:return"webgpu"==l?(h=this.createGPUSession(c),this.isGPU=!0):h=this.createCPUSession(c),e.abrupt("return",h.then((function(e){return(f=e).configure(t)})).then((function(e){if("extension"!==lx.M.APP_ENV)return Hx(e,lx.M.CUSTOMER_ID);if("function"!=typeof d.authFunction)throw"Can't find auth function";var t=lx.M.API_URL+lx.M.CUSTOMER_ID,n=hx.i.getInstance().getUID(lx.M.CUSTOMER_ID);return d.authFunction(t,{user_id:n,payload:e})})).then((function(e){var t;return f.auth(null!==(t=e.key)&&void 0!==t?t:e.data.key)})).then((function(e){if("active"!==JSON.parse(e).status)throw new Error("Authentication failed");d.ready=!0,d.sessions.set(a,f),s.resolve(),r.ie.notify({message:"init ".concat(n),type:r.cL.INFO,emitter:r.E7.ML_INFERENCE})})).catch((function(e){var t;throw r.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:r.E7.ML_INFERENCE,cause:e}),e})));case 25:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"createCPUSession",value:(n=Bx(Px().mark((function e(t){var n;return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={executionProviders:["wasm"],enableCpuMemArena:!0,enableMemPattern:!0,executionMode:"parallel",graphOptimizationLevel:"all",extra:{session:{set_denormal_as_zero:"1",disable_prepacking:"1",dynamic_block_base:"4"},optimization:{enable_gelu_approximation:"1"}}},Ch._K.wasm.numThreads=1,lx.M.PROXY&&(Ch._K.wasm.proxy=!0),Object.keys(lx.M.WASM_PATHS).length&&(Ch._K.wasm.wasmPaths=lx.M.WASM_PATHS),e.abrupt("return",Ch.CU.create(t,n));case 5:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"createGPUSession",value:(t=Bx(Px().mark((function e(t){var n,r,i,o,a,s,u,c;return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={executionProviders:["webgpu"]},Ql.wasm.numThreads=1,lx.M.PROXY&&(Ql.wasm.proxy=!0),Object.keys(lx.M.WASM_PATHS).length){for(r=[],i=0,o=Object.entries(lx.M.WASM_PATHS);i<o.length;i++)a=Tx(o[i],2),s=a[0],u=a[1],r[s]=u.replace(".wasm",".jsep.wasm");c=Object.assign({},r),Ql.wasm.wasmPaths=c}return e.abrupt("return",bh.create(t,n));case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"isReady",value:function(){return this.ready}},{key:"run",value:function(e,t,n,i){var o,a=new Ch.w3("float32",e,[1,Nx[i],n,t]),s=this.getModel(i);return this.sessions.has(s)?null===(o=this.sessions.get(s))||void 0===o?void 0:o.run({input:a}):(r.ie.notify({message:"ML inference for ".concat(i," model is not initialized"),emitter:r.E7.ML_INFERENCE}),null)}}]),e}(),Gx={onnx:jx,custom:Ux},zx=function(){function e(){Dx(this,e)}return Lx(e,null,[{key:"getInference",value:function(e){return new Gx[e]}}]),e}();function Hx(e,t){return Vx.apply(this,arguments)}function Vx(){return(Vx=Bx(Px().mark((function e(t,n){return Px().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",dx().post(lx.M.API_URL+n,{user_id:hx.i.getInstance().getUID(n),payload:t},{headers:{"Tsvb-Version":lx.M.VERSION}}).catch((function(e){throw new Error(e.response.data.message)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wx(e){return Wx="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Wx(e)}function $x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yx(r.key),r)}}function Yx(e){var t=function(e){if("object"!=Wx(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Wx(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Wx(t)?t:String(t)}var Kx=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=n,this.container=new fo,this.background=new go(kr.WHITE),this.background.tint=0,t.background&&(this.background.tint=t.background);var r={fontFamily:"Arial",fontSize:t.size?t.size:24,fill:t.color?t.color:16777215,align:"left"};this.text=new Fu("",r);var i=t.padding?t.padding:7;this.text.x=i,this.text.y=i,this.container.addChild(this.background),this.container.addChild(this.text),this.container.visible=!1,this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,n;return t=e,(n=[{key:"onOptionsUpdate",value:function(){this.text.style.fontSize=Math.round(.02*this.sdkOptions.width)}},{key:"updateText",value:function(e){this.text.text=e;var t=this.text.getLocalBounds();this.background.width=2*this.text.x+t.width,this.background.height=2*this.text.y+t.height}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}])&&$x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xx(e){return Xx="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Xx(e)}function Zx(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Zx=function(){return!!e})()}function qx(e){return qx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qx(e)}function Jx(e,t){return Jx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jx(e,t)}var Qx=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=qx(t),function(e,t){if(t&&("object"===Xx(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Zx()?Reflect.construct(t,n||[],qx(e).constructor):t.apply(e,n))}(this,t,["in vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nout vec2 vVertexPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition; // * (outputFrame.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n}\n","precision mediump float;\nuniform sampler2D uSampler;\nin vec2 vTextureCoord;\nuniform vec4 filterArea;\nlayout(location = 0) out vec4 outColor;\n\nuniform sampler2D u_Texture;\nuniform float u_Offset;\nuniform vec2 u_ImgSize;\n//Y =  0.299R + 0.587G + 0.114B\n//U = -0.147R - 0.289G + 0.436B\n//V =  0.615R - 0.515G - 0.100B\nconst vec3 COEF_Y = vec3(0.2126, 0.7152, 0.0722);\nconst vec3 COEF_U = vec3(-0.1146, -0.3854, 0.5);\nconst vec3 COEF_V = vec3(0.5, -0.4542, -0.0458);\nconst float U_DIVIDE_LINE = 2.0 / 3.0;\nconst float V_DIVIDE_LINE = 5.0 / 6.0;\n\nvoid main() {\n  vec2 texelOffset = vec2(u_Offset, 0.0);\n  //outColor = vec4(vTextureCoord.y, vTextureCoord.y, vTextureCoord.y, vTextureCoord.y);\n\n  if (vTextureCoord.y <= U_DIVIDE_LINE) {\n    vec2 texCoord = vec2(vTextureCoord.x, vTextureCoord.y * 3.0 / 2.0);\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 3.0);\n\n    float y0 = dot(color0.rgb, COEF_Y);\n    float y1 = dot(color1.rgb, COEF_Y);\n    float y2 = dot(color2.rgb, COEF_Y);\n    float y3 = dot(color3.rgb, COEF_Y);\n    outColor = vec4(y0, y1, y2, y3);\n  } else if (vTextureCoord.y <= V_DIVIDE_LINE) {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - U_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - U_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float u0 = dot(color0.rgb, COEF_U) + 0.5;\n    float u1 = dot(color1.rgb, COEF_U) + 0.5;\n    float u2 = dot(color2.rgb, COEF_U) + 0.5;\n    float u3 = dot(color3.rgb, COEF_U) + 0.5;\n    outColor = vec4(u0, u1, u2, u3);\n  } else {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - V_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - V_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float v0 = dot(color0.rgb, COEF_V) + 0.5;\n    float v1 = dot(color1.rgb, COEF_V) + 0.5;\n    float v2 = dot(color2.rgb, COEF_V) + 0.5;\n    float v3 = dot(color3.rgb, COEF_V) + 0.5;\n    outColor = vec4(v0, v1, v2, v3);\n  }\n}\n",e.uniforms])).program.fragmentSrc.includes("#version 300 es")||(n.program.fragmentSrc="#version 300 es \n"+n.program.fragmentSrc),n.program.vertexSrc.includes("#version 300 es")||(n.program.vertexSrc="#version 300 es \n"+n.program.vertexSrc),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jx(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(pr);function e_(e){return e_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},e_(e)}function t_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n_(r.key),r)}}function n_(e){var t=function(e){if("object"!=e_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=e_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==e_(t)?t:String(t)}var r_=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=n;var r=this.sdkOptions.width,i=this.sdkOptions.height;this.renderer=t,this.widthYUV=r/4,this.heightYUV=3*i/2,this.textureYUV=Sr.create({width:this.widthYUV,height:this.heightYUV}),this.textureRBG=Sr.create({width:r,height:i}),this.spriteYUV=new go(this.textureYUV),this.filterYUV=new Qx({uniforms:{u_Offset:1/r,u_ImgSize:[r,i],u_Texture:this.textureRBG}}),this.spriteYUV.filters=[this.filterYUV],this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,n;return t=e,n=[{key:"onOptionsUpdate",value:function(){var e=this.sdkOptions.width,t=this.sdkOptions.height;this.widthYUV=e/4,this.heightYUV=3*t/2,this.textureYUV.resize(this.widthYUV,this.heightYUV),this.textureRBG.resize(e,t),this.filterYUV.uniforms.u_Offset=1/e,this.filterYUV.uniforms.u_ImgSize=[e,t]}},{key:"getVideoFrameArray",value:function(){var e=new Uint8Array(4*this.widthYUV*this.heightYUV),t=this.renderer.generateTexture(this.spriteYUV);this.renderer.renderTexture.bind(t);var n=t.framebuffer.glFramebuffers[this.renderer.CONTEXT_UID];n.blitFramebuffer&&this.renderer.framebuffer.bind(n.blitFramebuffer);var r=this.renderer.gl;return r.readPixels(0,0,this.widthYUV,this.heightYUV,r.RGBA,r.UNSIGNED_BYTE,e),t.destroy(!0),e}},{key:"getVideoFrameSettings",value:function(){return{format:"I420",codedWidth:this.sdkOptions.width,codedHeight:this.sdkOptions.height}}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&t_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i_(e){return i_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},i_(e)}function o_(){o_=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==i_(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(i_(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function a_(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function s_(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){a_(o,r,i,a,s,"next",e)}function s(e){a_(o,r,i,a,s,"throw",e)}a(void 0)}))}}function u_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c_(r.key),r)}}function c_(e){var t=function(e){if("object"!=i_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i_(t)?t:String(t)}var l_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,i;return t=e,n=[{key:"clientWaitAsync",value:function(e,t,n,r){return new Promise((function(i,o){!function a(){var s=e.clientWaitSync(t,n,0);s!==e.WAIT_FAILED?s!==e.TIMEOUT_EXPIRED?i(!0):Mc(a,r):o()}()}))}},{key:"getBufferSubDataAsync",value:(i=s_(o_().mark((function e(t,n,r,i,o,a,s){var u;return o_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0),t.flush(),e.next=4,this.clientWaitAsync(t,u,0,2);case 4:t.deleteSync(u),t.bindBuffer(n,r),t.getBufferSubData(n,i,o,a,s),t.bindBuffer(n,null);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o,a,s){return i.apply(this,arguments)})},{key:"readPixelsAsync",value:(r=s_(o_().mark((function e(t,n,r,i,o,a,s,u){var c;return o_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.createBuffer(),t.bindBuffer(t.PIXEL_PACK_BUFFER,c),t.bufferData(t.PIXEL_PACK_BUFFER,u.byteLength,t.STREAM_READ),t.readPixels(n,r,i,o,a,s,0),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),e.next=7,this.getBufferSubDataAsync(t,t.PIXEL_PACK_BUFFER,c,0,u);case 7:return t.deleteBuffer(c),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,o,a,s,u){return r.apply(this,arguments)})}],n&&u_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h_(e){return h_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},h_(e)}function f_(){f_=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==h_(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(h_(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function d_(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function p_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y_(r.key),r)}}function y_(e){var t=function(e){if("object"!=h_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=h_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h_(t)?t:String(t)}var g_=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.color=65280,this.frameFormat="RGBX",r&&(this.frameFormat=r),this.sdkOptions=t,this.PIXI=n,this.renderer=new Wo({width:this.sdkOptions.width,height:this.sdkOptions.height,antialias:!0}),this.filter_manager=new Dr(this.renderer.renderer),this.timinngs={stats:new S,sprite:new Kx({size:Math.round(.02*this.sdkOptions.width),padding:5},this.sdkOptions)},this.effectsContainer=new fo,this.renderer.stage.addChild(this.effectsContainer),this.overlayContainer=new fo,this.renderer.stage.addChild(this.overlayContainer),this.stopTickers(),this.GLHelper=new l_,"I420"===this.frameFormat&&(this.converterYUV=new r_(this.renderer.renderer,this.sdkOptions)),this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,i,o;return t=e,i=[{key:"onOptionsUpdate",value:function(){this.renderer.renderer.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"stopTickers",value:function(){this.renderer.ticker.stop(),Li.system.stop()}},{key:"startTickers",value:function(){this.renderer.ticker.start(),Li.system.start()}},{key:"updateVideoFrame",value:function(e){this.video_frame||(this.video_frame=this.createFrom(e)),this.video_frame.texture.destroy(!0),this.video_frame.texture=kr.from(e)}},{key:"addStatistics",value:function(){this.addToStage(this.timinngs.sprite.container)}},{key:"removeStatistics",value:function(){this.removeFromStage(this.timinngs.sprite.container)}},{key:"updateStatistics",value:function(e,t){this.timinngs.stats.updateStats(e,t)}},{key:"hideStatistics",value:function(){this.timinngs.sprite.container.visible=!1}},{key:"drawStatistics",value:function(){this.timinngs.sprite.updateText(this.timinngs.stats.getText()),this.timinngs.sprite.container.visible=!0}},{key:"destroy",value:function(){this.renderer.renderer&&(this.sdkOptions.off("update",this.onOptionsUpdate,this),this.converterYUV&&this.converterYUV.destroy(),this.timinngs.sprite&&this.timinngs.sprite.destroy(),this.renderer.destroy(!0,{children:!0,texture:!0,baseTexture:!0}))}},{key:"renderTo",value:function(e,t){var n;try{this.renderer.renderer.render(e,{renderTexture:t})}catch(e){r.ie.notify({message:null!==(n=e.message)&&void 0!==n?n:e,emitter:r.E7.RENDERER,cause:e})}}},{key:"createCanvas",value:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}},{key:"createTextureFromBuffer",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return kr.fromBuffer(e,t,n,r)}},{key:"createRenderTexture",value:function(e,t){return Sr.create({width:e,height:t})}},{key:"pixels",value:function(e){return this.renderer.renderer.extract.pixels(e)}},{key:"pixelsAsync",value:(o=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){d_(o,r,i,a,s,"next",e)}function s(e){d_(o,r,i,a,s,"throw",e)}a(void 0)}))}}(f_().mark((function e(t){var n,r,i;return f_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.renderer.renderer,r=new Uint8Array(4*t._frame.width*t._frame.height),n.renderTexture.bind(t),(i=t.framebuffer.glFramebuffers[n.CONTEXT_UID]).blitFramebuffer&&n.framebuffer.bind(i.blitFramebuffer),e.next=8,this.GLHelper.readPixelsAsync(n.gl,0,0,t._frame.width,t._frame.height,n.gl.RGBA,n.gl.UNSIGNED_BYTE,r);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"calculateSpriteMatrix",value:function(e){var t=new On;return this.filter_manager.calculateSpriteMatrix(t,e)}},{key:"getFilterManager",value:function(){return this.filter_manager}},{key:"setTintColor",value:function(e){this.color=e}},{key:"getTintColor",value:function(){return this.color}},{key:"createTexture",value:function(e){return e instanceof kr?e:kr.from(e)}},{key:"createFromTexture",value:function(e){return new go(e)}},{key:"createFrom",value:function(e){return new go(kr.from(e))}},{key:"createFromURL",value:function(e){var t;return"string"==typeof e&&"color"===e?((t=new go(kr.WHITE)).tint=this.getTintColor(),t.width=this.sdkOptions.width,t.height=this.sdkOptions.height,t):t=go.from(e)}},{key:"createContainer",value:function(){return new fo}},{key:"addToStage",value:function(e){var t;null===(t=this.renderer.stage)||void 0===t||t.addChild(e)}},{key:"addToEffects",value:function(e){var t;this.renderer.renderer&&(null===(t=this.effectsContainer)||void 0===t||t.addChild(e))}},{key:"addToOverlay",value:function(e){var t;null===(t=this.overlayContainer)||void 0===t||t.addChild(e)}},{key:"addToStageAt",value:function(e,t){var n;null===(n=this.renderer.stage)||void 0===n||n.addChildAt(e,t)}},{key:"addToEffectsAt",value:function(e,t){var n;null===(n=this.effectsContainer)||void 0===n||n.addChildAt(e,t)}},{key:"addToOverlayAt",value:function(e,t){var n;null===(n=this.overlayContainer)||void 0===n||n.addChildAt(e,t)}},{key:"removeFromStage",value:function(e){var t;null===(t=this.renderer.stage)||void 0===t||t.removeChild(e)}},{key:"removeFromEffects",value:function(e){var t;null===(t=this.effectsContainer)||void 0===t||t.removeChild(e)}},{key:"removeFromOverlay",value:function(e){var t;null===(t=this.overlayContainer)||void 0===t||t.removeChild(e)}},{key:"useAsMask",value:function(e){this.renderer.stage.mask=e}},{key:"setCanvas",value:function(e){this.canvas=e}},{key:"render",value:function(){var e;try{this.renderer.render(),this.converterYUV&&(this.renderTo(this.renderer.stage,this.converterYUV.textureRBG),this.renderer.renderer.render(this.renderer.stage,{renderTexture:this.converterYUV.textureYUV}))}catch(n){r.ie.notify({message:null!==(e=n.message)&&void 0!==e?e:n,emitter:r.E7.RENDERER,cause:n})}}},{key:"getVideoFrameData",value:function(){return this.converterYUV?this.converterYUV.getVideoFrameArray():this.renderer.renderer.view}},{key:"getVideoFrameSettings",value:function(){return this.converterYUV?this.converterYUV.getVideoFrameSettings():{displayHeight:this.sdkOptions.height,displayWidth:this.sdkOptions.width}}}],i&&p_(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m_(e){return m_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},m_(e)}function v_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||b_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w_(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=b_(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function b_(e,t){if(e){if("string"==typeof e)return x_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x_(e,t):void 0}}function x_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function __(){__=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==m_(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(m_(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function I_(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function A_(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){I_(o,r,i,a,s,"next",e)}function s(e){I_(o,r,i,a,s,"throw",e)}a(void 0)}))}}function C_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S_(r.key),r)}}function k_(e,t,n){return t&&C_(e.prototype,t),n&&C_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S_(e){var t=function(e){if("object"!=m_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=m_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m_(t)?t:String(t)}function T_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var E_=k_((function e(){T_(this,e),this.filters=[],this.transform=null})),O_=function(){function e(t){T_(this,e),this.isEnabled=!1,this.sdkOptions=t}var t;return k_(e,[{key:"useResources",value:function(e){this.resources=e}},{key:"prepare",value:function(){}},{key:"process",value:(t=A_(__().mark((function e(){return __().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"nextFrame",value:function(e){}},{key:"clearBuffers",value:function(){}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1}},{key:"isDisabled",get:function(){return!this.isEnabled}},{key:"destroy",value:function(){}}]),e}(),P_=function(){function e(t,n){T_(this,e),this.effects=[],this.isPaused=!1,this.isSkipPipeline=!1,this.components={},this.hasFrames=!1,this.textures=[],this.resources=new E_,this.resources.renderer=t,this.components=null!=n?n:{},this.resources.texture=new Hc}var t;return k_(e,[{key:"destroy",value:function(){this.removeComponents(),this.resources.renderer.destroy(),this.effects.forEach((function(e){e.destroy()}))}},{key:"addEffect",value:function(e){e.useResources(this.resources),e.prepare(),this.effects.push(e)}},{key:"clearBuffers",value:function(){this.textures=[],this.effects.forEach((function(e,t){e.clearBuffers()}))}},{key:"pause",value:function(){this.isPaused=!0}},{key:"unpause",value:function(){this.isPaused=!1}},{key:"enablePipelineSkipping",value:function(){this.isSkipPipeline=!0}},{key:"disablePipelineSkipping",value:function(){this.isSkipPipeline=!1}},{key:"nextFrame",value:function(e){if(this.isPaused||this.isSkipPipeline)return e.texture.destroy(!0),void(this.textures=[]);if(this.effects.forEach((function(t,n){t.nextFrame(e)})),this.textures.length>1){var t=this.textures.shift();null==t||t.destroy()}this.textures.push(e)}},{key:"updateFrame",value:function(){if(this.textures.length){var e=this.textures.shift();e&&this.resources.texture.update(e.texture)}}},{key:"addComponents",value:function(){var e=this;this.components._getSortedComponentsArr.forEach((function(t){return e.resources.renderer.addToStage(t.container)}))}},{key:"removeComponents",value:function(){var e=this;Object.values(this.components).forEach((function(t){return e.resources.renderer.removeFromStage(t.container)}))}},{key:"process",value:(t=A_(__().mark((function e(){var t,n,r,i,o,a;return __().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPaused){e.next=2;break}return e.abrupt("return");case 2:if(!this.isSkipPipeline){e.next=7;break}return this.addComponents(),this.resources.renderer.render(),this.removeComponents(),e.abrupt("return");case 7:this.updateFrame(),t=w_(this.effects.entries()),e.prev=9,t.s();case 11:if((n=t.n()).done){e.next=20;break}return r=v_(n.value,2),i=r[0],o=r[1],(a=i+1===this.effects.length)&&this.addComponents(),e.next=17,o.process();case 17:a&&this.removeComponents();case 18:e.next=11;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),t.e(e.t0);case 25:return e.prev=25,t.f(),e.finish(25);case 28:this.hasFrames=!0;case 29:case"end":return e.stop()}}),e,this,[[9,22,25,28]])}))),function(){return t.apply(this,arguments)})}]),e}();function R_(e){return R_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},R_(e)}function B_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,D_(r.key),r)}}function D_(e){var t=function(e){if("object"!=R_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=R_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==R_(t)?t:String(t)}function M_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M_=function(){return!!e})()}function L_(e){return L_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L_(e)}function F_(e,t){return F_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},F_(e,t)}var N_=function(e){function t(e){var n,r,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=L_(t),function(e,t){if(t&&("object"===R_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,M_()?Reflect.construct(t,n||[],L_(e).constructor):t.apply(e,n))}(this,t,[void 0,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\n\nuniform float uFilterPart;\nuniform float uFilterPower;\nuniform float uLutSize;\nuniform float uNormalizator;\nuniform float uHalfPx;\nuniform int uEdges;\nuniform int uEnabled;\n\nvec4 newColor(float rectNum, vec2 coord) {\n  int num = int(rectNum);\n  int red = num - uEdges * (num / uEdges);\n  int green = num / uEdges;\n\n  vec2 bCoord = vec2(float(red) / float(uEdges), float(green) / float(uEdges));\n\n  vec2 lutTextureCoord = vec2(coord.r + bCoord.r, coord.g + bCoord.g);\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nfloat normalizeColor(float color) {\n  return color * uNormalizator + uHalfPx;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  //. Check enabled\n  if (uEnabled < 1) {\n    gl_FragColor = color;\n    return;\n  }\n\n  //. Check filter part\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(normalizeColor(color.r), normalizeColor(color.g));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * (uLutSize - 1.0);\n\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec4 colorInterpolated = mix(colorLut1, colorLut2, rectNumReal - rectNumMin);\n  vec3 resultColor = mix(color.rgb, colorLut1.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n\n",{uFilterPart:1,uFilterPower:1,uEnabled:0,uLutSize:null!==(r=null==e?void 0:e.lutSize)&&void 0!==r?r:36,uEdges:null!==(i=null==e?void 0:e.edges)&&void 0!==i?i:6,uLUT:null!==(o=null==e?void 0:e.texture)&&void 0!==o?o:kr.WHITE}])).calcNormatizator(),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F_(e,t)}(t,e),n=t,r=[{key:"setLUT",value:function(e){var t;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=this.uniforms.uLUT)||void 0===t||t.destroy(!0)),(null==e?void 0:e.edges)&&(this.uniforms.uEdges=e.edges),(null==e?void 0:e.lutSize)&&(this.uniforms.uLutSize=e.lutSize),this.calcNormatizator(),(null==e?void 0:e.texture)?(this.uniforms.uLUT=e.texture,this.uniforms.uEnabled=1):this.uniforms.uEnabled=0}},{key:"setFilterPart",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e}},{key:"setFilterPower",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e}},{key:"calcNormatizator",value:function(){var e=this.uniforms,t=e.uLutSize,n=e.uEdges;this.uniforms.uNormalizator=(t-1)/(t*n),this.uniforms.uHalfPx=.5/(t*n)}}],r&&B_(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr);function U_(e){return U_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},U_(e)}function j_(e){return function(e){if(Array.isArray(e))return G_(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return G_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G_(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z_(){z_=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==U_(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(U_(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function H_(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function V_(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){H_(o,r,i,a,s,"next",e)}function s(e){H_(o,r,i,a,s,"throw",e)}a(void 0)}))}}function W_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$_(r.key),r)}}function $_(e){var t=function(e){if("object"!=U_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=U_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==U_(t)?t:String(t)}var Y_=["cube"],K_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"parse",value:function(e){var t,n=this;return new Promise(function(){var r=V_(z_().mark((function r(i,o){var a,s,u,c,l;return z_().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(e instanceof File)){r.next=14;break}if(n.checkFileExtention(e.name)){r.next=4;break}return o('[ Lut Parser ] - Invalid file extention (file "'.concat(e.name,'", available extentions: ').concat(Y_.join(", "),")")),r.abrupt("return");case 4:return r.prev=4,r.next=7,n.readFile(e);case 7:t=r.sent,r.next=14;break;case 10:return r.prev=10,r.t0=r.catch(4),o(r.t0),r.abrupt("return");case 14:if("string"!=typeof e){r.next=25;break}return r.prev=15,r.next=18,fetch(e).then((function(e){return e.text()}));case 18:t=r.sent,r.next=25;break;case 21:return r.prev=21,r.t1=r.catch(15),o(r.t1),r.abrupt("return");case 25:if("3D"===(a=n.parseCUBE(t)).type.toUpperCase()){r.next=29;break}return o("[ Lut Parser ] - invalid lut type(".concat(a.type,"). Support 3DLUT only")),r.abrupt("return");case 29:return s=Math.ceil(Math.sqrt(a.size)),u=n.prepareTextureArray(a,s),c=a.size*s,l=kr.fromBuffer(u,c,c,{scaleMode:1,mipmap:H.OFF}),i({texture:l,lutSize:a.size,textureSize:c,edges:s}),r.abrupt("return");case 35:case"end":return r.stop()}}),r,null,[[4,10],[15,21]])})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"parseCUBE",value:function(e){for(var t,n={title:"",type:"",size:0,domain:[[0,0,0],[1,1,1]],data:[]},r=e.split("\n"),i=0;i<r.length;i++){var o=r[i].trim();if("#"!==o[0]&&""!==o){var a=o.split(/\s+/);switch(a[0]){case"TITLE":n.title=o.slice(7,-1);break;case"DOMAIN_MIN":n.domain[0]=a.slice(1).map(Number);break;case"DOMAIN_MAX":n.domain[1]=a.slice(1).map(Number);break;case"LUT_1D_SIZE":n.type="1D",n.size=Number(a[1]);break;case"LUT_3D_SIZE":n.type="3D",n.size=Number(a[1]);break;default:(t=n.data).push.apply(t,j_(a.map(Number)))}}}return n}},{key:"prepareTextureArray",value:function(e,t){var n=e.data,r=e.size,i=r*r*r,o=new Uint8ClampedArray(4*Math.pow(r*t,2)),a={value:0,isNil:function(){return 0===a.value},setDefault:function(){return a.value=r*r},dec:function(){return a.value--}};a.setDefault();for(var s=0,u=0,c=function(e,n){return 4*(r*(t*u+s)+n%r)+e},l=0;l<3*i;l+=3)o[c(0,l/3)]=255*n[l+0],o[c(1,l/3)]=255*n[l+1],o[c(2,l/3)]=255*n[l+2],o[c(3,l/3)]=255,a.dec(),l/3%r==r-2&&u++,a.isNil()&&(a.setDefault(),++s>=t?s=0:u-=r);return o}},{key:"checkFileExtention",value:function(e){var t=e.split(".").pop();return!!t&&Y_.includes(t.toLowerCase())}},{key:"readFile",value:(r=V_(z_().mark((function e(t){return z_().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.readAsText(t),r.onload=function(){e(r.result)},r.onerror=function(){n("[ Lut Parser ] - filereader: ".concat(r.error))}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}],n&&W_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function X_(e){return X_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},X_(e)}function Z_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q_(r.key),r)}}function q_(e){var t=function(e){if("object"!=X_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=X_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X_(t)?t:String(t)}var J_=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=null!==(n=t.size)&&void 0!==n?n:1,this.store=[]}var t,n;return t=e,n=[{key:"add",value:function(e){var t=this,n=this.store.find((function(t){return t.id===e})),r=Date.now();if(n)return n.time=r,{hasItem:!0};var i={id:e,time:r};if(this.store.push(i),this.store.length<=this.size)return{};var o=this.store.reduce((function(e,n,r){return t.store[e].time<n.time?e:r}),0);return{removedID:this.store.splice(o,1)[0].id}}},{key:"setSize",value:function(e){var t;if(this.size=e,!(this.store.length<=e)){this.store=this.store.sort((function(e,t){return t.time-e.time}));for(var n=[];this.store.length>this.size;){var r=null===(t=this.store.pop())||void 0===t?void 0:t.id;void 0!==r&&n.push(r)}return n}}},{key:"checkItemByID",value:function(e){return!!~this.store.findIndex((function(t){return t.id===e}))}}],n&&Z_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Q_(e){return Q_="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Q_(e)}function eI(){eI=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Q_(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Q_(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function tI(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function nI(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){tI(o,r,i,a,s,"next",e)}function s(e){tI(o,r,i,a,s,"throw",e)}a(void 0)}))}}function rI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iI(r.key),r)}}function iI(e){var t=function(e){if("object"!=Q_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Q_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q_(t)?t:String(t)}function oI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(oI=function(){return!!e})()}function aI(e){return aI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},aI(e)}function sI(e,t){return sI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sI(e,t)}var uI=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=aI(t),function(e,t){if(t&&("object"===Q_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,oI()?Reflect.construct(t,n||[],aI(e).constructor):t.apply(e,n))}(this,t,[e])).parser=new K_,n.lutStore={},n.config={lut:"none",part:1,power:1,capacity:1},n.activityIndexator=new J_({size:n.config.capacity}),n}var n,r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sI(e,t)}(t,e),n=t,r=[{key:"prepare",value:function(){var e=this.resources.texture;this.original=new qc(e,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.filter=new N_,this.original.frame.filters=[this.filter],this.setConfig(this.config),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"process",value:(o=nI(eI().mark((function e(){return eI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled&&"none"!==this.config.lut){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setConfig",value:function(e){this.setFilterPart(e.part),this.setFilterPower(e.power),this.setFilterLut(e.lut,e.promise),this.setCapacity(e.capacity)}},{key:"setFilterPart",value:function(e){void 0!==e&&(this.config.part=e,this.filter.setFilterPart(e))}},{key:"setFilterPower",value:function(e){void 0!==e&&(this.config.power=e,this.filter.setFilterPower(e))}},{key:"setFilterLut",value:(i=nI(eI().mark((function e(t,n){var r,i,o,a,s;return eI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if("none"!==t){e.next=5;break}return this.config.lut="none",e.abrupt("return");case 5:if(r=this.countID(t),this.config.lut=t,this.selectedID=r,i=this.activityIndexator.add(r),o=i.hasItem,a=i.removedID,o){e.next=19;break}return e.next=12,this.parser.parse(t);case 12:if(s=e.sent,this.activityIndexator.checkItemByID(r)){e.next=18;break}return s.texture.destroy(),this.removeLutByID(a),this.resolver(r,null==n?void 0:n.resolve()),e.abrupt("return");case 18:this.lutStore[r]=s;case 19:this.filter.setLUT(this.lutStore[this.selectedID],!1),this.removeLutByID(a),this.resolver(r,null==n?void 0:n.resolve());case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"setCapacity",value:function(e){var t=this;if(void 0!==e){this.config.capacity=e;var n=this.activityIndexator.setSize(e);(null==n?void 0:n.length)&&n.forEach((function(e){return t.removeLutByID(e)}))}}},{key:"removeLutByID",value:function(e){var t,n;void 0!==e&&(null===(n=null===(t=this.lutStore[e])||void 0===t?void 0:t.texture)||void 0===n||n.destroy(),delete this.lutStore[e])}},{key:"countID",value:function(e){return e instanceof File?e.name:e}},{key:"onSuccess",value:function(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0}},{key:"resolver",value:function(e,t){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction(e),"function"==typeof t&&t()}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],r&&rI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(O_);function cI(e){return cI="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},cI(e)}function lI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hI(r.key),r)}}function hI(e){var t=function(e){if("object"!=cI(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=cI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==cI(t)?t:String(t)}function fI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fI=function(){return!!e})()}function dI(e){return dI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dI(e)}function pI(e,t){return pI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pI(e,t)}var yI=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=dI(t),function(e,t){if(t&&("object"===cI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fI()?Reflect.construct(t,n||[],dI(e).constructor):t.apply(e,n))}(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\n#define SIGMA (10.0)\n#define BSIGMA (0.1)\n#define MSIZE (15)\n\nfloat kernel[MSIZE];\n\nuniform float uBeautyficationLevel;\nuniform int uWidth;\nuniform int uHeight;\n\nfloat normpdf(float x, float sigma) {\n  return 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n}\n\nfloat normpdf3(vec3 v, float sigma) {\n  return 0.39894 * exp(-0.5 * dot(v, v) / (sigma * sigma)) / sigma;\n}\n\nvec4 overlay(vec4 a, vec4 b) {\n  vec4 x = vec4(2.0) * a * b;\n  vec4 y = vec4(1.0) - vec4(2.0) * (vec4(1.0) - a) * (vec4(1.0) - b);\n  vec4 result;\n  result.r = mix(x.r, y.r, float(a.r > 0.5));\n  result.g = mix(x.g, y.g, float(a.g > 0.5));\n  result.b = mix(x.b, y.b, float(a.b > 0.5));\n  result.a = mix(x.a, y.a, float(a.a > 0.5));\n  return result;\n}\n\nvec3 rgb2xyz(vec3 c) {\n  vec3 tmp;\n  tmp.x = c.r > 0.04045 ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n  tmp.y = c.g > 0.04045 ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n    tmp.z = c.b > 0.04045 ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n  return 100.0 *\n  tmp *\n  mat3(0.4124, 0.3576, 0.1805, 0.2126, 0.7152, 0.0722, 0.0193, 0.1192, 0.9505);\n}\n\nvec3 xyz2lab(vec3 c) {\n  vec3 n = c / vec3(95.047, 100, 108.883);\n  vec3 v;\n  v.x = n.x > 0.008856 ? pow(n.x, 1.0 / 3.0) : 7.787 * n.x + 16.0 / 116.0;\n  v.y = n.y > 0.008856 ? pow(n.y, 1.0 / 3.0) : 7.787 * n.y + 16.0 / 116.0;\n  v.z = n.z > 0.008856 ? pow(n.z, 1.0 / 3.0) : 7.787 * n.z + 16.0 / 116.0;\n  return vec3(116.0 * v.y - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 rgb2lab(vec3 c) {\n  vec3 lab = xyz2lab(rgb2xyz(c));\n  return vec3(\n    lab.x / 100.0,\n    0.5 + 0.5 * (lab.y / 127.0),\n    0.5 + 0.5 * (lab.z / 127.0)\n  );\n}\n\nbool skin_mask(vec4 color) {\n  vec3 lab = rgb2lab(color.rgb);\n  return lab.g >= uBeautyficationLevel + 0.05 &&\n  lab.b >= uBeautyficationLevel + 0.04 &&\n  lab.r <= 0.98 &&\n  length(lab.gb) <= 0.9;\n}\n\nvoid main() {\n  vec2 iResolution = vec2(float(uWidth), float(uHeight));\n  vec3 c = texture2D(uSampler, vTextureCoord).rgb;\n  float a = texture2D(uSampler, vTextureCoord).a;\n\n  if (a > 0.9 && (uBeautyficationLevel > 0.95 || skin_mask(texture2D(uSampler, vTextureCoord)))) {\n    const int kSize = (MSIZE - 1) / 2;\n    vec3 final_colour = vec3(0.0);\n    float Z = 0.0;\n\n    kernel[0] = kernel[14] = 0.031225216;\n    kernel[1] = kernel[13] = 0.033322271;\n    kernel[2] = kernel[12] = 0.035206333;\n    kernel[3] = kernel[11] = 0.036826804;\n    kernel[4] = kernel[10] = 0.038138565;\n    kernel[5] = kernel[9] = 0.039104044;\n    kernel[6] = kernel[8] = 0.039695028;\n    kernel[7] = 0.039894;\n    float bZ = 0.2506642602897679;\n\n    //create the 1-D kernel\n\n    //   for (int j = 0; j <= kSize; ++j)\n    //   {\n    //     kernel[kSize+j] = kernel[kSize-j] = normpdf(float(j), SIGMA);\n    //   }\n\n    vec3 cc;\n    float factor;\n    //float bZ = 1.0/normpdf(0.0, BSIGMA);\n    //read out the texels\n    for (int i = -kSize; i <= kSize; ++i) {\n      for (int j = -kSize; j <= kSize; ++j) {\n        cc = texture2D(\n          uSampler,\n          vTextureCoord.xy + vec2(float(i), float(j)) / iResolution.xy\n        ).rgb;\n        factor =\n          normpdf3(cc - c, BSIGMA) * bZ * kernel[kSize + j] * kernel[kSize + i];\n        Z += factor;\n        final_colour += factor * cc;\n      }\n    }\n\n    //fragColor = vec4(final_colour / Z, 1.0);\n\n    vec4 origin = texture2D(uSampler, vTextureCoord);\n    vec4 blurred = vec4(final_colour / Z, 1.0);\n    vec4 highpass =\n      vec4(\n        origin.r - blurred.r,\n        origin.g - blurred.g,\n        origin.b - blurred.b,\n        1\n      ) +\n      vec4(0.5, 0.5, 0.5, 0);\n    vec4 highpass_inverted = vec4(\n      1.0 - highpass.r,\n      1.0 - highpass.g,\n      1.0 - highpass.b,\n      1\n    );\n    gl_FragColor = overlay(origin, highpass_inverted);\n\n  } else {\n    gl_FragColor = vec4(c, a);\n\n  }\n}\n",Object.assign({},e)])}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pI(e,t)}(t,e),n=t,(r=[{key:"setBeautificationLevel",value:function(e){this.uniforms.uBeautyficationLevel=e}}])&&lI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr);function gI(e){return gI="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},gI(e)}function mI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vI(r.key),r)}}function vI(e){var t=function(e){if("object"!=gI(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=gI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==gI(t)?t:String(t)}function wI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(wI=function(){return!!e})()}function bI(e){return bI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bI(e)}function xI(e,t){return xI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xI(e,t)}var _I=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t,n){return t=bI(t),function(e,t){if(t&&("object"===gI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,wI()?Reflect.construct(t,n||[],bI(e).constructor):t.apply(e,n))}(this,t,["attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\nuniform mat3 uTransformMatrix;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n\n  vOriginCoord = (uTransformMatrix * vec3(vTextureCoord * inputSize.xy / outputFrame.zw, 1.0)).xy;\n}\n","uniform sampler2D uSampler;\nuniform sampler2D uOriginFrame;\n\nuniform bool useMask;\nuniform float distColor;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\n\nvec3 screen(vec3 a, vec3 b) {\n  return 1.0 - (1.0 - a) * (1.0 - b);\n}\nvec3 linearDodge(vec3 a, vec3 b) {\n  return a + b;\n}\n\nvoid main() {\n  float personMask = texture2D(uSampler, vTextureCoord).r;\n\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n\n  vec4 background = texture2D(uOriginFrame, vOriginCoord);\n  if (useMask) {\n    gl_FragColor = mix(vec4(0), background, personMask);  \n  } else {\n    gl_FragColor = mix(vec4(0), background, distColor);\n  }\n  //gl_FragColor = background;\n  //gl_FragColor = mix(vec4(0), background, 0.0);\n}\n",Object.assign({},e)])).matrix=new On,i.originalFrame=n,i.maskSprite=r,i.setLayout(),i}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xI(e,t)}(t,e),n=t,(r=[{key:"setLayout",value:function(){var e=this.maskSprite.position.x<0?1-Math.abs(this.maskSprite.position.x)/this.maskSprite.width:(this.originalFrame.width-this.maskSprite.position.x)/this.maskSprite.width;e=Math.min(1,e);var t=this.maskSprite.position.x<0?-this.maskSprite.position.x/this.maskSprite.width:0,n=this.maskSprite.position.y<0?1-Math.abs(this.maskSprite.position.y)/this.maskSprite.height:(this.originalFrame.height-this.maskSprite.position.y)/this.maskSprite.height;n=Math.min(1,n);var r=this.maskSprite.position.y<0?-this.maskSprite.position.y/this.maskSprite.height:0;this.matrix.a=e,this.matrix.d=n,this.matrix.tx=t,this.matrix.ty=r,this.uniforms.uTransformMatrix=this.matrix}},{key:"setOrigin",value:function(e){this.uniforms.uOriginFrame=e}},{key:"setLayoutMode",value:function(e){switch(e){case"segmentation":this.uniforms.useMask=!0,this.uniforms.distColor=0;break;case"full":this.uniforms.useMask=!1,this.uniforms.distColor=1;break;case"hide":this.uniforms.useMask=!1,this.uniforms.distColor=0}}},{key:"setIsBoundaryStrong",value:function(e){this.uniforms.uIsBoundaryStrong=e}}])&&mI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr);function II(e){return II="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},II(e)}function AI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,CI(r.key),r)}}function CI(e){var t=function(e){if("object"!=II(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=II(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==II(t)?t:String(t)}function kI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(kI=function(){return!!e})()}function SI(e){return SI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},SI(e)}function TI(e,t){return TI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},TI(e,t)}var EI=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=SI(t),function(e,t){if(t&&("object"===II(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,kI()?Reflect.construct(t,n||[],SI(e).constructor):t.apply(e,n))}(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 pixelSize;\nuniform vec2 quarter;\nuniform vec2 _vrScale;\nuniform vec4 toPosTransform;\nuniform vec4 fromPosTransform;\nvec4 readTex(vec2 uv)\n{\n    return texture2D(uSampler, uv);\n}\nvec2 mapInsideChannel(vec2 pos)\n{\n    vec2 result = mod(pos, quarter) * 4.0;\n    result.y += floor(pos.x / quarter.x);\n    \n    return result;\n}\nvec4 extractChannel(vec4 c0, vec4 c1, vec4 c2, vec4 c3, float yPos)\n{\n    vec4 result = vec4(c0.r, c1.r, c2.r, c3.r);\n    \n    float condition = step(quarter.y, yPos);\n    result = mix(result, vec4(c0.g, c1.g, c2.g, c3.g), condition);\n    condition = step(2.0 * quarter.y, yPos);\n    result = mix(result, vec4(c0.b, c1.b, c2.b, c3.b), condition);\n    \n    \n    return result;\n}\nvec2 toPos(vec2 uv)\n{\n    return uv * toPosTransform.xy + toPosTransform.zw;\n}\nvec2 fromPos(vec2 pos)\n{\n    return ( pos * fromPosTransform.xy ) + fromPosTransform.zw;\n}\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    \n    vec2 pos = toPos(uv);\n    vec2 chPos = mapInsideChannel(pos);\n    uv = fromPos(chPos);\n    \n    vec4 c0 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c1 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c2 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c3 = readTex(uv);\n    gl_FragColor = extractChannel(c0, c1, c2, c3, pos.y);\n}"])).setSize(e,n),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TI(e,t)}(t,e),n=t,(r=[{key:"setSize",value:function(e,t){var n=e,r=t;t>128&&(r=256),e<256&&(n=256),this.virtualSize=new In(e,t),this.realSize=new In(n,r),this._vrScale=new In(this.realSize.x/this.virtualSize.x,this.realSize.y/this.virtualSize.y),this.pixelSize=new In(1/this.realSize.x,1/this.realSize.y),this.quarter=new In(this.virtualSize.x/4,this.virtualSize.y/4),this.toPosTransform=[1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1),1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1),-.5*this.pixelSize.x*(1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1)),-.5*this.pixelSize.y*(1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1))],this.fromPosTransform=[(this.virtualSize.x-1)*this.pixelSize.x/(this.virtualSize.x-1),(this.virtualSize.y-1)*this.pixelSize.y/(this.virtualSize.y-1),.5*this.pixelSize.x,.5*this.pixelSize.y],this.uniforms.pixelSize=this.pixelSize,this.uniforms.quarter=this.quarter,this.uniforms.toPosTransform=this.toPosTransform,this.uniforms.fromPosTransform=this.fromPosTransform}}])&&AI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr);function OI(e){return OI="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},OI(e)}function PI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function RI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,BI(r.key),r)}}function BI(e){var t=function(e){if("object"!=OI(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=OI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==OI(t)?t:String(t)}function DI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(DI=function(){return!!e})()}function MI(e){return MI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},MI(e)}function LI(e,t){return LI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},LI(e,t)}var FI=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=MI(t),function(e,t){if(t&&("object"===OI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,DI()?Reflect.construct(t,n||[],MI(e).constructor):t.apply(e,n))}(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uOffset;\n\nuniform int uHasMask;\nuniform sampler2D uMask;\n\nuniform int uClamped;\nuniform vec4 filterClamp;\n\nuniform mat3 uTransformMatrix;\n\nbool checkCoord(vec2 coord) {\n  vec4 color = texture2D(uMask, coord);\n  return color.r < 0.5;\n}\n\nvoid main(void ) {\n  vec4 color = vec4(0.0);\n  bool hasMask = uHasMask > 0;\n  bool isClamped = uClamped > 0;\n  bool isInside = hasMask && !checkCoord(vTextureCoord);\n\n  vec2 pickCoord[4];\n  pickCoord[0] = vTextureCoord + vec2(-1.0, +1.0) * uOffset;\n  pickCoord[1] = vTextureCoord + vec2(+1.0, +1.0) * uOffset;\n  pickCoord[2] = vTextureCoord + vec2(+1.0, -1.0) * uOffset;\n  pickCoord[3] = vTextureCoord + vec2(-1.0, -1.0) * uOffset;\n\n  for (int i = 0; i < 4; i += 1) {\n    vec2 coord = pickCoord[i];\n\n    //. Get original point if needed\n    if (hasMask && !isInside && !checkCoord(pickCoord[i])) {\n      coord = vTextureCoord;\n    }\n\n    //. Check clamped mode\n    color += isClamped\n      ? texture2D(uSampler, clamp(coord, filterClamp.xy, filterClamp.zw))\n      : texture2D(uSampler, coord);\n  }\n\n  gl_FragColor = color * 0.25;\n}\n"]))._kernels=[],n._blur=4,n._quality=3,n.isMaskEnabled=!0,n.uniforms.uOffset=new Float32Array(2),n.uniforms.uClamped=e.clamp?1:0,n.uniforms.uHasMask=0,n.uniforms.uMask=kr.WHITE,n.uniforms.uTransformMatrix=new On,n._pixelSize=new In,n.pixelSize=1,n._clamp=!!e.clamp,Array.isArray(e.blur)?n.kernels=e.blur:(n._blur=null!==(r=e.blur)&&void 0!==r?r:4,n.quality=null!==(i=e.quality)&&void 0!==i?i:3),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LI(e,t)}(t,e),n=t,r=[{key:"apply",value:function(e,t,n,r){var i,o=this._pixelSize.x/t._frame.width,a=this._pixelSize.y/t._frame.height;if(1===this._quality||0===this._blur)i=this._kernels[0]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,t,n,r);else{for(var s,u=e.getFilterTexture(),c=t,l=u,h=this._quality-1,f=0;f<h;f++)i=this._kernels[f]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,c,l,1),s=c,c=l,l=s;i=this._kernels[h]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,c,n,r),e.returnFilterTexture(u)}}},{key:"_updatePadding",value:function(){this.padding=Math.ceil(this._kernels.reduce((function(e,t){return e+t+.5}),0))}},{key:"_generateKernels",value:function(){var e=this._blur,t=this._quality,n=[e];if(e>0)for(var r=e,i=e/t,o=1;o<t;o++)r-=i,n.push(r);this._kernels=n,this._updatePadding()}},{key:"kernels",get:function(){return this._kernels},set:function(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max.apply(Math,function(e){return function(e){if(Array.isArray(e))return PI(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return PI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PI(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e))):(this._kernels=[0],this._quality=1)}},{key:"clamp",get:function(){return this._clamp}},{key:"pixelSize",get:function(){return this._pixelSize},set:function(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof In?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}},{key:"blur",get:function(){return this._blur},set:function(e){this._blur=e,this._generateKernels()}},{key:"enableMask",value:function(){this.isMaskEnabled=!0}},{key:"disableMask",value:function(){this.isMaskEnabled=!1}},{key:"setMask",value:function(e){this.uniforms.uMask=e,this.uniforms.uHasMask=this.isMaskEnabled?1:0}}],r&&RI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr);function NI(e){return NI="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},NI(e)}function UI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jI(r.key),r)}}function jI(e){var t=function(e){if("object"!=NI(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=NI(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==NI(t)?t:String(t)}function GI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(GI=function(){return!!e})()}function zI(e){return zI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zI(e)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},HI(e,t)}var VI=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=zI(t),function(e,t){if(t&&("object"===NI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,GI()?Reflect.construct(t,n||[],zI(e).constructor):t.apply(e,n))}(this,t)}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}(t,e),n=t,(r=[{key:"set",value:function(e,t,n){this.preset=e,this.width=t,this.height=n,this.size=4*this.width*this.height,this.emit("update",this)}}])&&UI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(i),WI=__nested_webpack_require_1427617__(4300),$I=__nested_webpack_require_1427617__.n(WI),YI=__nested_webpack_require_1427617__(8684),KI=__nested_webpack_require_1427617__.n(YI);function XI(e,t,n){return t=qI(t),function(e,t){if(t&&("object"===eA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ZI()?Reflect.construct(t,n||[],qI(e).constructor):t.apply(e,n))}function ZI(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ZI=function(){return!!e})()}function qI(e){return qI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qI(e)}function JI(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},QI(e,t)}function eA(e){return eA="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},eA(e)}function tA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iA(r.key),r)}}function rA(e,t,n){return t&&nA(e.prototype,t),n&&nA(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function iA(e){var t=function(e){if("object"!=eA(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=eA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==eA(t)?t:String(t)}var oA=function(){function e(t){tA(this,e),this.isLandscape=!0,this.sdkOptions=t,this.landscapeSize={height:144,width:256},this.portraitSize={height:192,width:192},this.updateOrientation()}return rA(e,[{key:"isOrientationChanged",value:function(){return this.isLandscape!=this.sdkOptions.isLandscape()}},{key:"updateOrientation",value:function(){this.isLandscape=this.sdkOptions.isLandscape()}},{key:"getModelSize",value:function(){return this.isLandscape?this.landscapeSize:this.portraitSize}},{key:"getURL",value:function(){var e=this.isLandscape?"PRESETS":"PRESETS_PORTRAIT",t=lx.M[e][this.preset];return t?lx.M.getPresetUrl(t):lx.M.MODEL_URL}}]),e}(),aA=function(e){function t(e){var n;return tA(this,t),(n=XI(this,t,[e])).preset="quality",n}return JI(t,e),rA(t)}(oA),sA=function(e){function t(e){var n;return tA(this,t),(n=XI(this,t,[e])).preset="balanced",n.landscapeSize={height:128,width:256},n}return JI(t,e),rA(t)}(oA),uA=function(e){function t(e){var n;return tA(this,t),(n=XI(this,t,[e])).preset="speed",n.landscapeSize={height:160,width:256},n}return JI(t,e),rA(t)}(oA),cA=function(e){function t(e){var n;return tA(this,t),(n=XI(this,t,[e])).preset="lightning",n}return JI(t,e),rA(t)}(oA),lA=function(){function e(t){tA(this,e),this.modelMap=new Map,this.modelMap.set("balanced",new sA(t)),this.modelMap.set("quality",new aA(t)),this.modelMap.set("speed",new uA(t)),this.modelMap.set("lightning",new cA(t))}return rA(e,[{key:"isOrientationChanged",value:function(e){var t;return null===(t=this.getModel(e))||void 0===t?void 0:t.isOrientationChanged()}},{key:"updateOrientation",value:function(){return this.modelMap.forEach((function(e,t){e.updateOrientation()}))}},{key:"getModelSize",value:function(e){var t,n;return null!==(n=null===(t=this.getModel(e))||void 0===t?void 0:t.getModelSize())&&void 0!==n?n:{height:144,width:256}}},{key:"getModelURL",value:function(e){var t,n;return null!==(n=null===(t=this.getModel(e))||void 0===t?void 0:t.getURL())&&void 0!==n?n:""}},{key:"getModel",value:function(e){return this.modelMap.has(e)?this.modelMap.get(e):(r.ie.notify({emitter:r.E7.PRESET_INIT,message:"Can't find preset ".concat(e)}),null)}}]),e}();function hA(e){return hA="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},hA(e)}function fA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dA(r.key),r)}}function dA(e){var t=function(e){if("object"!=hA(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=hA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==hA(t)?t:String(t)}function pA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(pA=function(){return!!e})()}function yA(e){return yA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yA(e)}function gA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mA(e,t){return mA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mA(e,t)}var vA,wA=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t,n){return t=yA(t),function(e,t){if(t&&("object"===hA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gA(e)}(e,pA()?Reflect.construct(t,n||[],yA(e).constructor):t.apply(e,n))}(this,t)).filters={blur:{}},i.sdkOptions=e,i.type="origin",i.options=Object.assign({},t.defaultOptions,r),i.frame=n,i.filters.blur=new FI({blur:5,quality:5}),i.backgroundTrack=new b,i.backgroundTrack.on("ended",i.clearBackground,gA(i)),i.backgroundTrack.on("update",i.calculateBackgroundSize,gA(i)),i.globalWidth=e.width,i.globalHeight=e.height,i.sdkOptions.on("update",i.onOptionsUpdate,gA(i)),i}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mA(e,t)}(t,e),n=t,r=[{key:"destroy",value:function(){this.backgroundTrack.off("ended",this.clearBackground,this),this.backgroundTrack.off("update",this.calculateBackgroundSize,this),this.sdkOptions.off("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(e){this.globalWidth=e.width,this.globalHeight=e.height,this.frame.resize(this.globalWidth,this.globalHeight),this.calculateBackgroundSize()}},{key:"render",value:function(){this.backgroundTrack.update(),document.hidden&&this.frame.frame.texture.baseTexture.resource&&this.frame.frame.texture.baseTexture.resource.source instanceof HTMLVideoElement&&this.frame.frame.texture.baseTexture.update()}},{key:"set",value:function(e){this.backgroundTrack.stop(),this.applyBackground(e)}},{key:"applyBlur",value:function(e){this.frame.frame.filters=[],this.filters.blur.disableMask(),e&&(this.filters.blur.blur=+e,this.frame.frame.filters.push(this.filters.blur),"origin"==this.frame.active&&this.filters.blur.enableMask())}},{key:"setMask",value:function(e){this.filters.blur.blur&&this.filters.blur.setMask(e)}},{key:"applyBackground",value:function(e){var t,n=this;if(this.frame.frame.tint="color"==e?this.options.color:16777215,this.options.source!=e){if(this.options.source=e,null==e)return this.type="origin",void(this.frame.active!==this.type&&(this.frame.activateTexture(this.type),this.calculateBackgroundSize(),(null===(t=this.frame.frame.filters)||void 0===t?void 0:t.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask()));var r,i,o;switch(e.constructor){case String:"color"==e?(this.type="color",r=kr.WHITE):(r=e,this.type="url");break;case MediaStream:this.backgroundTrack.set(e),(i=document.createElement("video")).srcObject=e,r=i,this.type="media_stream";break;case CanvasCaptureMediaStreamTrack:case BrowserCaptureMediaStreamTrack:case MediaStreamTrack:o=new MediaStream([e]),this.backgroundTrack.set(o),(i=document.createElement("video")).srcObject=o,r=i,this.type="media_stream_track";break;case HTMLVideoElement:r=e,this.type="video"}if(r&&r instanceof kr)this.texture=r;else{if(e.constructor==String)return void kr.fromURL(r).then((function(e){n.texture=e,n.onBackgroundLoaded()}));this.texture=kr.from(r)}this.texture.baseTexture.valid?this.onBackgroundLoaded():this.texture.baseTexture.once("loaded",(function(){return n.onBackgroundLoaded()}))}}},{key:"onBackgroundLoaded",value:function(){this.texture.baseTexture&&(this.frame.addTexture("swap",this.texture),this.switchBackground(),this.calculateBackgroundSize(),this.loopAndRestart())}},{key:"loopAndRestart",value:function(){this.frame.frame.texture.baseTexture.resource.source instanceof HTMLVideoElement&&(this.frame.frame.texture.baseTexture.resource.source.loop=!0,this.frame.frame.texture.baseTexture.resource.source.currentTime=0,this.frame.frame.texture.baseTexture.resource.source.muted=!0)}},{key:"setColor",value:function(e){this.options.color=e,this.frame.frame.tint=this.options.color}},{key:"switchBackground",value:function(){var e;this.frame.activateTexture("swap"),"color"==this.type&&(this.frame.frame.tint=this.options.color),(null===(e=this.frame.frame.filters)||void 0===e?void 0:e.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask(),this.emit("update",this)}},{key:"clearBackground",value:function(){this.backgroundTrack.stop(),this.applyBackground(null),this.emit("clear",this)}},{key:"updateBackgroundSize",value:function(e,t,n,r){this.frame.frame.width=n,this.frame.frame.height=r,this.frame.frame.x=e,this.frame.frame.y=t}},{key:"setFitMode",value:function(e){this.options.fit_mode=e,this.calculateBackgroundSize()}},{key:"calculateBackgroundSize",value:function(){var e=this.globalWidth,t=this.globalHeight;if("color"!=this.type&&"origin"!=this.type){if(!(this.frame.frame.texture.baseTexture.width<20)){var n=this.frame.frame.texture.baseTexture.width/this.frame.frame.texture.baseTexture.height;"fill"==this.options.fit_mode?e/n>=t?this.updateBackgroundSize(0,-Math.abs(t-e/n)/2,e,e/n):this.updateBackgroundSize(-Math.abs(e-t*n)/2,0,t*n,t):e/n<=t?this.updateBackgroundSize(0,Math.abs(t-e/n)/2,e,e/n):this.updateBackgroundSize(Math.abs(e-t*n)/2,0,t*n,t)}}else this.updateBackgroundSize(0,0,e,t)}}],r&&fA(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(i);function bA(e){return bA="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},bA(e)}function xA(){xA=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==bA(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(bA(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function _A(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function IA(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){_A(o,r,i,a,s,"next",e)}function s(e){_A(o,r,i,a,s,"throw",e)}a(void 0)}))}}function AA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,CA(r.key),r)}}function CA(e){var t=function(e){if("object"!=bA(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=bA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==bA(t)?t:String(t)}function kA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(kA=function(){return!!e})()}function SA(e){return SA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},SA(e)}function TA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EA(e,t){return EA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},EA(e,t)}wA.defaultOptions={source:null,fit_mode:"fill",color:16777215},function(e){e.Segmentation="segmentation",e.Full="full",e.Hide="hide"}(vA||(vA={}));var OA=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=SA(t),function(e,t){if(t&&("object"===bA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return TA(e)}(e,kA()?Reflect.construct(t,n||[],SA(e).constructor):t.apply(e,n))}(this,t,[e])).pixels=[],r.filters={blurMask:{},show:{},beautification:{},nchw:{}},r.skip_frames_counter=0,r.customLayoutOptions={width:1280,height:720,xOffset:0,yOffset:0},r.customLayoutOptions.width=e.width,r.customLayoutOptions.height=e.height,r.customer_id=n,r.presetManager=new lA(r.sdkOptions),r.inferenceTimer=new k,r.drawTimer=new k,r.settings={boundary_level:0,boundary_mode:"strong",beautification:!1,beautification_level:.48,blur:0,layout:"center",preset:lx.M.PRESET,skip_frames:!1,layout_mode:vA.Segmentation},r.model=new VI,r.model.on("update",r.updateModelSize,TA(r)),r.is_running=!1,r.isNewPreset=!1,r.enable(),r}var n,i,o,a,s,u,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EA(e,t)}(t,e),n=t,i=[{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.mask.resize(this.sdkOptions.width,this.sdkOptions.height),this.applyLayout()}},{key:"clearBuffers",value:function(){this.pixels=[]}},{key:"nextFrame",value:function(e){if(this.isActive()&&!(this.pixels.length>1)){if(this.small.addTexture("frame",e.texture),this.small.activateTexture("frame"),this.resources.transform){var t=this.resources.transform.xOffset,n=this.resources.transform.yOffset,r=Math.abs(this.sdkOptions.width*this.resources.transform.scaleValue),i=Math.abs(this.sdkOptions.height*this.resources.transform.scaleValue);this.small.frame.texture.trim=new Cn(t,n,r,i)}this.small.frame.filters=[this.filters.nchw],this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.small.frame.filters=[],this.small.frame.texture.trim=new Cn(0,0,this.sdkOptions.width,this.sdkOptions.height),this.small.activateTexture("origin");var o=this.small.getBuffer("model");this.pixels.push(this.resources.renderer.pixelsAsync(o))}}},{key:"init",value:(c=IA(xA().mark((function e(t){var n=this;return xA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.disable(),this.inference=t,this.inference.setPresetManager(this.presetManager),this.inference.setPreset(this.settings.preset),e.next=6,this.setPreset(this.settings.preset);case 6:return e.abrupt("return",this.inference.init(this.customer_id,"segmentation").then((function(){n.enable()})));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setPreset",value:(u=IA(xA().mark((function e(t){var n,r,i;return xA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.model.preset!=t||this.presetManager.isOrientationChanged(this.model.preset)){e.next=2;break}return e.abrupt("return");case 2:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break}return e.next=5,this.onProcessPromise.promise;case 5:this.isNewPreset=!0,this.settings.preset=t,this.presetManager.updateOrientation(),n=this.presetManager.getModelSize(t),r=n.width,i=n.height,this.model.set(t,r,i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"updateModelSize",value:(s=IA(xA().mark((function e(){var t,n;return xA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.buffer_pixels=new Uint8Array(this.model.size),this.buffer_mask=$I()(new Float32Array(this.model.size).fill(255),[1,this.model.height,this.model.width,4]),this.model.previous=$I()(new Float32Array(this.model.size),[1,1,this.model.height,this.model.width]),null===(t=this.small)||void 0===t||t.resize(this.model.width,this.model.height),null===(n=this.mask)||void 0===n||n.resize(this.model.width,this.model.height),this.filters.nchw=new EI(this.model.width,this.model.height),this.filters.nchw.setSize(this.model.width,this.model.height),this.mask&&this.applyLayout();case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"prepare",value:function(){var e=this.model.width,t=this.model.height;this.original=new qc(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.background=new wA(this.sdkOptions,new qc(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height})),this.small=new qc(this.resources.texture,{width:e,height:t}),this.small.addBuffer("model"),this.small.addBuffer("mask"),this.mask=new qc(this.small.getBuffer("mask"),{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.buffer_pixels=new Uint8Array(4*e*t),this.buffer_mask=$I()(new Float32Array(4*e*t).fill(255),[1,t,e,4]),this.prepareFilters(),this.applyBlur(),this.updateModelSize(),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"prepareFilters",value:function(){var e={uIsBoundaryStrong:"strong"===this.settings.boundary_mode,uOriginFrame:this.original.frame.texture,useMask:!0,distColor:1};this.filters.blurMask=new FI({blur:.1,quality:4,clamp:!0}),this.filters.show=new _I(e,this.original.frame,this.mask.frame),this.filters.nchw=new EI(this.model.width,this.model.height),this.filters.beautification=new yI({uBeautificationLevel:this.settings.beautification_level,uWidth:this.mask.frame.width,uHeight:this.mask.frame.height}),this.mask.frame.filters=[this.filters.show]}},{key:"clearBackground",value:function(){this.background.clearBackground()}},{key:"process",value:(a=IA(xA().mark((function e(){var t;return xA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break}return e.next=5,this.onProcessPromise.promise;case 5:if(this.onProcessPromise=new tl,this.drawTimer.start(),this.inference&&this.inference.isReady()){e.next=9;break}return e.abrupt("return");case 9:if(e.prev=9,!this.shouldSegmentationRun()){e.next=13;break}return e.next=13,this.prepareSegmentationMask();case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(9),r.ie.notify({message:null!==(t="Prepare segmentation mask. "+e.t0.message)&&void 0!==t?t:e.t0,emitter:r.E7.EFFECT_VIRTUAL_BACKGROUND,cause:e.t0}),this.disable();case 19:this.skip_frames_counter=this.skip_frames_counter?0:1,this.isActive()?(this.filters.show.setOrigin(this.original.frame.texture),this.resources.renderer.addToEffects(this.background.frame.frame),this.resources.renderer.addToEffects(this.mask.frame),this.resources.renderer.addStatistics(),this.background.render(),this.resources.renderer.render(),this.resources.renderer.removeStatistics(),this.resources.renderer.removeFromEffects(this.mask.frame),this.resources.renderer.removeFromEffects(this.background.frame.frame)):(this.resources.renderer.addToEffects(this.original.frame),this.resources.renderer.addStatistics(),this.resources.renderer.render(),this.resources.renderer.removeStatistics(),this.resources.renderer.removeFromEffects(this.original.frame)),this.drawTimer.finish(),this.resources.renderer.updateStatistics("frame_time",this.drawTimer.getFrameTime()),this.resources.renderer.updateStatistics("inference_time",this.inferenceTimer.getFrameTime()),this.onProcessPromise.resolve();case 25:case"end":return e.stop()}}),e,this,[[9,15]])}))),function(){return a.apply(this,arguments)})},{key:"isActive",value:function(){return null!==this.background.options.source||"center"!==this.settings.layout||!!this.settings.blur||!!this.settings.beautification}},{key:"shouldSegmentationRun",value:function(){return(!this.settings.skip_frames||!this.skip_frames_counter)&&this.isActive()}},{key:"setBoundaryMode",value:function(e){this.settings.boundary_mode=e,this.filters.show.setIsBoundaryStrong("strong"===e)}},{key:"setBoundaryLevel",value:function(e){r.ie.notify({type:r.cL.INFO,message:"Boundary level was deprecated and will not show any effect.",emitter:r.E7.EFFECT_VIRTUAL_BACKGROUND})}},{key:"setBeautificationLevel",value:function(e){e=.34+.34*(e=1-Math.min(Math.max(Number(e),0),1)),this.filters.beautification.setBeautificationLevel(e)}},{key:"enableFrameSkipping",value:function(){this.settings.skip_frames=!0}},{key:"disableFrameSkipping",value:function(){this.settings.skip_frames=!1}},{key:"enableBeautification",value:function(){this.settings.beautification||(this.mask.frame.filters.push(this.filters.beautification),this.settings.beautification=!0)}},{key:"disableBeautification",value:function(){this.settings.beautification&&(this.mask.frame.filters.pop(),this.settings.beautification=!1)}},{key:"getPreset",value:function(){return this.settings.preset}},{key:"setLayout",value:function(e){this.settings.layout=e,this.applyLayout()}},{key:"setLayoutMode",value:function(e){this.settings.layout_mode=e,this.filters.show.setLayoutMode(e)}},{key:"setCustomLayout",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.customLayoutOptions[n]=e[n]})),this.updateMaskPosition(this.customLayoutOptions.width,this.customLayoutOptions.height,this.customLayoutOptions.xOffset,this.customLayoutOptions.yOffset)}},{key:"applyLayout",value:function(){switch(this.settings.layout){case"left":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,-this.sdkOptions.width/4,0);break;case"right":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,this.sdkOptions.width/4,0);break;case"left-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,0,this.sdkOptions.height/2);break;case"right-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,this.sdkOptions.width/2,this.sdkOptions.height/2);break;case"center":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,0,0)}}},{key:"updateMaskPosition",value:function(e,t,n,r){this.mask.frame.width=e,this.mask.frame.height=t,this.mask.frame.position.x=n,this.mask.frame.position.y=r,this.filters.show.setLayout()}},{key:"setBackground",value:function(e){this.background.set(e)}},{key:"setBackgroundFitMode",value:function(e){this.background.setFitMode(e)}},{key:"setBackgroundColor",value:function(e){this.background.setColor(e)}},{key:"setBlur",value:function(e){this.settings.blur=e,this.applyBlur()}},{key:"clearBlur",value:function(){this.settings.blur=0,this.applyBlur()}},{key:"applyBlur",value:function(){this.background.applyBlur(this.settings.blur)}},{key:"prepareSegmentationMask",value:(o=IA(xA().mark((function e(){var t,n,i,o,a,s=this;return xA().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.model.width,n=this.model.height,this.pixels.length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.pixels.pop();case 6:if((null==(i=e.sent)?void 0:i.length)==4*t*n){e.next=9;break}return e.abrupt("return");case 9:return o=[1,1,n,t],a=$I()(new Float32Array(i),[1,4,n,t]),KI().assign(a.pick(0,3,null,null),this.model.previous.pick(0,0,null,null)),this.inferenceTimer.start(),e.abrupt("return",this.inference.run(a.data,t,n,"segmentation").then((function(e){var r,i,a;if(s.inferenceTimer.finish(),s.isNewPreset)s.isNewPreset=!1;else{var u=null!==(a=null!==(i=null===(r=e.seg)||void 0===r?void 0:r.data)&&void 0!==i?i:e.seg)&&void 0!==a?a:e,c=$I()(u,o);KI().assign(s.model.previous,c),KI().mulseq(c,255),KI().assign(s.buffer_mask.pick(0,null,null,0),c.pick(0,0,null,null));var l=s.resources.renderer.createTextureFromBuffer(new Uint8Array(s.buffer_mask.data),t,n);s.small.addTexture("mask",l,!0),s.small.activateTexture("mask"),s.small.frame.filters=[s.filters.blurMask],s.resources.renderer.renderTo(s.small.frame,s.small.getBuffer("mask")),s.small.frame.filters=[],s.small.activateTexture("origin"),s.background.setMask(s.small.getBuffer("mask"))}})).catch((function(e){var t;r.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:r.E7.EFFECT_VIRTUAL_BACKGROUND,cause:e})})));case 14:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this),this.model.off("update",this.updateModelSize,this),this.background.destroy()}}],i&&AA(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(O_);function PA(e){return PA="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},PA(e)}function RA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,BA(r.key),r)}}function BA(e){var t=function(e){if("object"!=PA(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=PA(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==PA(t)?t:String(t)}function DA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(DA=function(){return!!e})()}function MA(e){return MA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},MA(e)}function LA(e,t){return LA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},LA(e,t)}var FA=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=MA(t),function(e,t){if(t&&("object"===PA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,DA()?Reflect.construct(t,n||[],MA(e).constructor):t.apply(e,n))}(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLL;\nuniform int uEnabled;\n\nvoid main() {\n  vec4 texel = texture2D(uSampler, vTextureCoord);\n\n  if (uEnabled == 0) {\n    gl_FragColor = vec4(texel);\n    return;\n  }\n\n  vec3 curve = texture2D(uLL, vTextureCoord).rgb;\n\n  vec3 x = texel.rgb + curve * (texel.rgb * texel.rgb - texel.rgb);\n\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n\n  x = clamp(x, 0.0, 1.0);\n\n  gl_FragColor = vec4(x, texel.a);\n}\n",{uLL:kr.EMPTY,uEnabled:0}])}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LA(e,t)}(t,e),n=t,(r=[{key:"setLowLightTexture",value:function(e){this.uniforms.uLL=e,this.uniforms.uEnabled=1}}])&&RA(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr),NA={modelHeight:144,modelWidth:144,power:1},UA=Symbol("Comlink.proxy"),jA=Symbol("Comlink.endpoint"),GA=Symbol("Comlink.releaseProxy"),zA=Symbol("Comlink.finalizer"),HA=Symbol("Comlink.thrown"),VA=function(e){return"object"==_typeof(e)&&null!==e||"function"==typeof e},WA=new Map([["proxy",{canHandle:function(e){return VA(e)&&e[UA]},serialize:function(e){var t=new MessageChannel,n=t.port1,r=t.port2;return $A(e,n),[r,[r]]},deserialize:function(e){return e.start(),KA(e)}}],["throw",{canHandle:function(e){return VA(e)&&HA in e},serialize:function(e){var t=e.value;return[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]]},deserialize:function(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function $A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["*"];t.addEventListener("message",(function r(i){if(i&&i.data)if(function(e,t){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t===i||"*"===i)return!0;if(i instanceof RegExp&&i.test(t))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}(n,i.origin)){var o,a=Object.assign({path:[]},i.data),s=a.id,u=a.type,c=a.path,l=(i.data.argumentList||[]).map(rC);try{var h=c.slice(0,-1).reduce((function(e,t){return e[t]}),e),f=c.reduce((function(e,t){return e[t]}),e);switch(u){case"GET":o=f;break;case"SET":h[c.slice(-1)[0]]=rC(i.data.value),o=!0;break;case"APPLY":o=f.apply(h,l);break;case"CONSTRUCT":o=function(e){return Object.assign(e,_defineProperty({},UA,!0))}(_construct(f,_toConsumableArray(l)));break;case"ENDPOINT":var d=new MessageChannel,p=d.port1,y=d.port2;$A(e,y),o=function(e,t){return tC.set(e,t),e}(p,[p]);break;case"RELEASE":o=void 0;break;default:return}}catch(e){o=_defineProperty({value:e},HA,0)}Promise.resolve(o).catch((function(e){return _defineProperty({value:e},HA,0)})).then((function(n){var i=_slicedToArray(nC(n),2),o=i[0],a=i[1];t.postMessage(Object.assign(Object.assign({},o),{id:s}),a),"RELEASE"===u&&(t.removeEventListener("message",r),YA(t),zA in e&&"function"==typeof e[zA]&&e[zA]())})).catch((function(e){var n=_slicedToArray(nC(_defineProperty({value:new TypeError("Unserializable return value")},HA,0)),2),r=n[0],i=n[1];t.postMessage(Object.assign(Object.assign({},r),{id:s}),i)}))}else console.warn("Invalid origin '".concat(i.origin,"' for comlink proxy"))})),t.start&&t.start()}function YA(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function KA(e,t){return QA(e,[],t)}function XA(e){if(e)throw new Error("Proxy has been released and is not useable")}function ZA(e){return iC(e,{type:"RELEASE"}).then((function(){YA(e)}))}var qA=new WeakMap,JA="FinalizationRegistry"in globalThis&&new FinalizationRegistry((function(e){var t=(qA.get(e)||0)-1;qA.set(e,t),0===t&&ZA(e)}));function QA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,r=new Proxy(arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},{get:function(i,o){if(XA(n),o===GA)return function(){!function(e){JA&&JA.unregister(e)}(r),ZA(e),n=!0};if("then"===o){if(0===t.length)return{then:function(){return r}};var a=iC(e,{type:"GET",path:t.map((function(e){return e.toString()}))}).then(rC);return a.then.bind(a)}return QA(e,[].concat(_toConsumableArray(t),[o]))},set:function(r,i,o){XA(n);var a=_slicedToArray(nC(o),2),s=a[0],u=a[1];return iC(e,{type:"SET",path:[].concat(_toConsumableArray(t),[i]).map((function(e){return e.toString()})),value:s},u).then(rC)},apply:function(r,i,o){XA(n);var a=t[t.length-1];if(a===jA)return iC(e,{type:"ENDPOINT"}).then(rC);if("bind"===a)return QA(e,t.slice(0,-1));var s=_slicedToArray(eC(o),2),u=s[0],c=s[1];return iC(e,{type:"APPLY",path:t.map((function(e){return e.toString()})),argumentList:u},c).then(rC)},construct:function(r,i){XA(n);var o=_slicedToArray(eC(i),2),a=o[0],s=o[1];return iC(e,{type:"CONSTRUCT",path:t.map((function(e){return e.toString()})),argumentList:a},s).then(rC)}});return function(e,t){var n=(qA.get(t)||0)+1;qA.set(t,n),JA&&JA.register(e,t,e)}(r,e),r}function eC(e){var t,n=e.map(nC);return[n.map((function(e){return e[0]})),(t=n.map((function(e){return e[1]})),Array.prototype.concat.apply([],t))]}var tC=new WeakMap;function nC(e){var t,n=_createForOfIteratorHelper(WA);try{for(n.s();!(t=n.n()).done;){var r=_slicedToArray(t.value,2),i=r[0],o=r[1];if(o.canHandle(e)){var a=_slicedToArray(o.serialize(e),2);return[{type:"HANDLER",name:i,value:a[0]},a[1]]}}}catch(s){n.e(s)}finally{n.f()}return[{type:"RAW",value:e},tC.get(e)||[]]}function rC(e){switch(e.type){case"HANDLER":return WA.get(e.name).deserialize(e.value);case"RAW":return e.value}}function iC(e,t,n){return new Promise((function(r){var i=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}function oC(e){return oC="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},oC(e)}function aC(){aC=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==oC(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(oC(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function sC(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function uC(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){sC(o,r,i,a,s,"next",e)}function s(e){sC(o,r,i,a,s,"throw",e)}a(void 0)}))}}function cC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lC(r.key),r)}}function lC(e){var t=function(e){if("object"!=oC(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=oC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==oC(t)?t:String(t)}function hC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(hC=function(){return!!e})()}function fC(){return fC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dC(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},fC.apply(this,arguments)}function dC(e){return dC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dC(e)}function pC(e,t){return pC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pC(e,t)}var yC=new URL(__nested_webpack_require_1427617__(8804),__nested_webpack_require_1427617__.b).href,gC=new Worker(yC,{type:"module"}),mC=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=dC(t),function(e,t){if(t&&("object"===oC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,hC()?Reflect.construct(t,n||[],dC(e).constructor):t.apply(e,n))}(this,t,[e])).customer_id=n,r.setConfig(NA),r.worker=KA(gC),r}var n,i,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pC(e,t)}(t,e),n=t,i=[{key:"init",value:(a=uC(aC().mark((function e(t){return aC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"lowlighter");case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"prepare",value:function(){this.filterLowLight=new FA,this.original=new qc(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.original.addBuffer("output"),this.filterLUT=new N_,this.lut=new qc(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.lut.addBuffer("result"),this.lut.frame.filters=[this.filterLUT];var e=this.config,t=e.modelHeight,n=e.modelWidth;this.small=new qc(this.resources.texture,{width:n,height:t}),this.small.addBuffer("model"),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.lut.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"process",value:(o=uC(aC().mark((function e(){return aC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.isOutdatedLUT&&this.updateLUT(),this.resources.renderer.renderTo(this.lut.frame,this.lut.getBuffer("result")),this.resources.texture.update(this.lut.getBuffer("result"),!1);case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setConfig",value:function(e){var t;this.config=Object.assign(null!==(t=this.config)&&void 0!==t?t:{},e),this.setFilterPower(e.power)}},{key:"onSuccess",value:function(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0}},{key:"enable",value:function(){fC(dC(t.prototype),"enable",this).call(this),this.isOutdatedLUT=!this.inWork}},{key:"updateLUT",value:function(){var e=this;if(!this.inWork){this.inWork=!0;var t=this.config,n=t.modelHeight,i=t.modelWidth;this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model"));var o=this.small.getBuffer("model"),a=this.resources.renderer.pixels(o),s=function(e,t,n){var r=$I()(new Float32Array(e),[1,n,t,4]);r=r.transpose(0,3,1,2);var i=$I()(new Float32Array(n*t*3),[1,3,n,t]);return KI().assign(i.pick(0,0,null,null),r.pick(0,0,null,null)),KI().assign(i.pick(0,1,null,null),r.pick(0,1,null,null)),KI().assign(i.pick(0,2,null,null),r.pick(0,2,null,null)),r=r.transpose(2,0,1),KI().mulseq(i,1/255),i}(new Uint8ClampedArray(a),i,n);this.inference.run(s.data,i,n,"lowlighter").then((function(t){e.original.activateBuffer("result"),e.original.frame.filters=[e.filterLowLight],e.filterLowLight.setLowLightTexture(t.coefs),e.resources.renderer.renderTo(e.original.frame,e.original.getBuffer("output")),e.original.activateTexture("origin"),e.original.frame.filters=[];var n=e.resources.renderer.pixels(e.original.getBuffer("output")),r=e.resources.renderer.pixels(e.original.getBuffer("result"));return e.worker.getLUTTexture(new Uint8ClampedArray(r),new Uint8ClampedArray(n))})).then((function(t){e.applyLowlightLUT(t),e.emitSuccess()})).catch((function(e){var t;r.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:r.E7.EFFECT_LOW_LIGHT,cause:e})})).finally((function(){e.inWork=!1,e.isOutdatedLUT=!1}))}}},{key:"applyLowlightLUT",value:function(e){var t=this.getLutTextureData(e).LUTTexture;this.filterLUT.setLUT({texture:t})}},{key:"getLutTextureData",value:function(e){var t=Math.sqrt(e.length/4);return{LUTTexture:kr.fromBuffer(new Uint8Array(e),t,t,{scaleMode:1}),LUTSize:t}}},{key:"setFilterPower",value:function(e){var t;void 0!==e&&(this.config.power=e,null===(t=this.filterLUT)||void 0===t||t.setFilterPower(e))}},{key:"emitSuccess",value:function(){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction()}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],i&&cC(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(O_),vC={modelHeight:256,modelWidth:256,modelPediod_ms:1e3,filterPart:100,cc_power:100};function wC(e,t,n){var r=$I()(new Float32Array(e),[1,n,t,4]);r=r.transpose(0,3,1,2);var i=$I()(new Float32Array(n*t*3),[1,3,n,t]);return KI().assign(i.pick(0,0,null,null),r.pick(0,0,null,null)),KI().assign(i.pick(0,1,null,null),r.pick(0,1,null,null)),KI().assign(i.pick(0,2,null,null),r.pick(0,2,null,null)),i}function bC(e){var t=e.tensor,n=33,r=$I()(t.output.data,[3,n,n,n]).data,i=new Uint8ClampedArray(4*Math.pow(198,2)),o={value:0,isNil:function(){return 0===o.value},setDefault:function(){return o.value=1089},dec:function(){return o.value--}};o.setDefault();for(var a=0,s=0,u=function(e,t){return 4*(n*(6*s+a)+t%n)+e},c=function(e){[e,35937+e,71874+e].forEach((function(t,n){i[u(n,e)]=255*r[t]})),i[u(3,e)]=255,o.dec(),e%n==32&&s++,o.isNil()&&(o.setDefault(),++a>=6?a=0:s-=n)},l=0;l<35937;l++)c(l);return i}function xC(e){return xC="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},xC(e)}function _C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,IC(r.key),r)}}function IC(e){var t=function(e){if("object"!=xC(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=xC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==xC(t)?t:String(t)}function AC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(AC=function(){return!!e})()}function CC(e){return CC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},CC(e)}function kC(e,t){return kC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kC(e,t)}var SC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=CC(t),function(e,t){if(t&&("object"===xC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,AC()?Reflect.construct(t,n||[],CC(e).constructor):t.apply(e,n))}(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\nuniform float uFilterPart;\nuniform float uFilterPower;\n\nfloat clampedCoord(float coord) {\n  float min = 0.5 / 198.0;\n  float max = 1.0 - min;\n  return clamp(coord, min, max);\n}\n\nfloat clampColor(float color) {\n  float min = 1.0 / 256.0;\n  float max = 1.0 / 6.0 - min;\n  return clamp(color, min, max);\n}\n\nvec4 newColor(float rectNum, vec2 coord) {\n  vec2 bCoord = vec2(mod(rectNum, 6.0) / 6.0, floor(rectNum / 6.0) / 6.0);\n  vec2 lutTextureCoord = vec2(clampedCoord(coord.r + bCoord.r), clampedCoord(coord.g + bCoord.g));\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(clampColor(color.r / 6.0), clampColor(color.g / 6.0));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * 32.0;\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec3 interpolatedColor = mix(colorLut1.rgb, colorLut2.rgb, rectNumReal - rectNumMin);\n\n  //. Add filter power\n  vec3 resultColor = mix(color.rgb, interpolatedColor.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n",{uFilterPart:1,uFilterPower:1}])).lutTextureHeight=198,e.lutTextureWidth=198,e}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kC(e,t)}(t,e),n=t,r=[{key:"setLUT",value:function(e){var t;null===(t=this.lutTexture)||void 0===t||t.destroy(!0),this.lutTexture=kr.fromBuffer(e,this.lutTextureWidth,this.lutTextureHeight,{scaleMode:1}),this.uniforms.uLUT=this.lutTexture}},{key:"setFilterPart",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e}},{key:"setFilterPower",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e}}],r&&_C(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr);function TC(e){return TC="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},TC(e)}function EC(){EC=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==TC(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(TC(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function OC(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function PC(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){OC(o,r,i,a,s,"next",e)}function s(e){OC(o,r,i,a,s,"throw",e)}a(void 0)}))}}function RC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,BC(r.key),r)}}function BC(e){var t=function(e){if("object"!=TC(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=TC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==TC(t)?t:String(t)}function DC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(DC=function(){return!!e})()}function MC(e){return MC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},MC(e)}function LC(e,t){return LC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},LC(e,t)}var FC=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=MC(t),function(e,t){if(t&&("object"===TC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,DC()?Reflect.construct(t,n||[],MC(e).constructor):t.apply(e,n))}(this,t,[e])).hasLUT=!1,r.inWork=!1,r.customer_id=n,r.config=Object.assign({},vC),r}var n,i,o,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LC(e,t)}(t,e),n=t,i=[{key:"init",value:(s=PC(EC().mark((function e(t){return EC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"colorcorrector");case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"prepare",value:function(){var e=this.config,t=e.modelHeight,n=e.modelWidth,r=this.resources.texture;this.original=new qc(r,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.small=new qc(r,{width:n,height:t}),this.small.addBuffer("model"),this.ccFilter=new SC,this.original.frame.filters=[this.ccFilter],this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"process",value:(a=PC(EC().mark((function e(){return EC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.modelProcess(),this.hasLUT&&(this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1));case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"modelProcess",value:(o=PC(EC().mark((function e(){var t,n,i,o,a,s,u=this;return EC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break}return e.abrupt("return");case 4:return this.inWork=!0,t=this.config,n=t.modelHeight,i=t.modelWidth,o=this.small.getBuffer("model"),e.next=9,this.resources.renderer.pixelsAsync(o);case 9:return a=e.sent,s=wC(new Uint8ClampedArray(a),i,n),e.abrupt("return",this.inference.run(s.data,i,n,"colorcorrector").then((function(e){var t=bC({tensor:e});u.ccFilter.setLUT(t),u.hasLUT=!0})).catch((function(e){var t;r.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:r.E7.EFFECT_COLOR_CORRECTION,cause:e})})).finally((function(){return u.inWork=!1})));case 12:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setConfig",value:function(e,t){this.config[e]=t,"filterPart"===e&&this.ccFilter.setFilterPart(t),"cc_power"===e&&this.ccFilter.setFilterPower(t)}},{key:"checkTimer",value:function(){return this.modelTimer?(performance.now()-this.modelTimer<this.config.modelPediod_ms||(this.modelTimer=0),!1):(this.modelTimer=performance.now(),!0)}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],i&&RC(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(O_),NC={smoothPower:20,sensitivityValue:.15,faceAreaProportion:.1,modelHeight:240,modelWidth:320,faceDetectorAccuracy:.75,waiterSeconds:1,isFaceSquareDrawingEnabled:!1,isPreFaceSquareDrawingEnabled:!1,faceDetectorPediod_ms:250};function UC(e){return UC="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},UC(e)}function jC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,GC(r.key),r)}}function GC(e){var t=function(e){if("object"!=UC(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=UC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==UC(t)?t:String(t)}var zC=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setCoord(t),this.id=null!=n?n:Math.round(100*Math.random())}var t,n;return t=e,n=[{key:"setID",value:function(e){this.id=e}},{key:"getID",value:function(){return this.id}},{key:"checkSame",value:function(e){if(void 0===this.x1)return!1;if(!(e.x1>this.x1&&e.x1<this.x2||e.x2>this.x1&&e.x2<this.x2||this.x1>e.x1&&this.x1<e.x2||this.x2>e.x1&&this.x2<e.x2))return!1;if(!(e.y1>this.y1&&e.y1<this.y2||e.y2>this.y1&&e.y2<this.y2||this.y1>e.y1&&this.y1<e.y2||this.y2>e.y1&&this.y2<e.y2))return!1;var t=this.calcSquare(e),n=Math.abs(Math.max(this.x1,e.x1)-Math.min(this.x2,e.x2));return!!(Math.abs(Math.max(this.y1,e.y1)-Math.min(this.y2,e.y2))*n/Math.min(this.square,t)>.7)&&(this.setCoord(e),!0)}},{key:"getRect",value:function(){return{x1:this.x1,y1:this.y1,width:this.x2-this.x1,height:this.y2-this.y1}}},{key:"getCoord",value:function(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2}}},{key:"getSquare",value:function(){return this.square}},{key:"getCenter",value:function(){return{x:this.x1+(this.x2-this.x1)/2,y:this.y1+(this.y2-this.y1)/2}}},{key:"isEqual",value:function(e,t,n,r){if(!e)return!1;var i=e.getCoord();return!(Math.abs(this.x1-i.x1)/(null!=r?r:this.x2-this.x1)>t||Math.abs(this.x2-i.x2)/(null!=r?r:this.x2-this.x1)>t||Math.abs(this.y1-i.y1)/(null!=n?n:this.y2-this.y1)>t||Math.abs(this.y2-i.y2)/(null!=n?n:this.y2-this.y1)>t)}},{key:"setCoord",value:function(e){var t=void 0===this.x1;this.x1=t?e.x1:Math.min(this.x1,e.x1),this.y1=t?e.y1:Math.min(this.y1,e.y1),this.x2=t?e.x2:Math.max(this.x2,e.x2),this.y2=t?e.y2:Math.max(this.y2,e.y2),this.square=this.calcSquare(e)}},{key:"calcSquare",value:function(e){return(e.x2-e.x1)*(e.y2-e.y1)}}],n&&jC(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),HC=[{x:.0125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.016666666666666666,w:.075,h:.1},{x:.0375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.016666666666666666,w:.075,h:.1},{x:.0625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.016666666666666666,w:.075,h:.1},{x:.0875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.016666666666666666,w:.075,h:.1},{x:.1125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.016666666666666666,w:.075,h:.1},{x:.1375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.016666666666666666,w:.075,h:.1},{x:.1625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.016666666666666666,w:.075,h:.1},{x:.1875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.016666666666666666,w:.075,h:.1},{x:.2125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.016666666666666666,w:.075,h:.1},{x:.2375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.016666666666666666,w:.075,h:.1},{x:.2625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.016666666666666666,w:.075,h:.1},{x:.2875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.016666666666666666,w:.075,h:.1},{x:.3125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.016666666666666666,w:.075,h:.1},{x:.3375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.016666666666666666,w:.075,h:.1},{x:.3625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.016666666666666666,w:.075,h:.1},{x:.3875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.016666666666666666,w:.075,h:.1},{x:.4125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.016666666666666666,w:.075,h:.1},{x:.4375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.016666666666666666,w:.075,h:.1},{x:.4625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.016666666666666666,w:.075,h:.1},{x:.4875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.016666666666666666,w:.075,h:.1},{x:.5125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.016666666666666666,w:.075,h:.1},{x:.5375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.016666666666666666,w:.075,h:.1},{x:.5625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.016666666666666666,w:.075,h:.1},{x:.5875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.016666666666666666,w:.075,h:.1},{x:.6125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.016666666666666666,w:.075,h:.1},{x:.6375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.016666666666666666,w:.075,h:.1},{x:.6625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.016666666666666666,w:.075,h:.1},{x:.6875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.016666666666666666,w:.075,h:.1},{x:.7125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.016666666666666666,w:.075,h:.1},{x:.7375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.016666666666666666,w:.075,h:.1},{x:.7625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.016666666666666666,w:.075,h:.1},{x:.7875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.016666666666666666,w:.075,h:.1},{x:.8125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.016666666666666666,w:.075,h:.1},{x:.8375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.016666666666666666,w:.075,h:.1},{x:.8625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.016666666666666666,w:.075,h:.1},{x:.8875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.016666666666666666,w:.075,h:.1},{x:.9125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.016666666666666666,w:.075,h:.1},{x:.9375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.016666666666666666,w:.075,h:.1},{x:.9625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.016666666666666666,w:.075,h:.1},{x:.9875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.016666666666666666,w:.075,h:.1},{x:.0125,y:.05,w:.03125,h:.041666666666666664},{x:.0125,y:.05,w:.05,h:.06666666666666667},{x:.0125,y:.05,w:.075,h:.1},{x:.0375,y:.05,w:.03125,h:.041666666666666664},{x:.0375,y:.05,w:.05,h:.06666666666666667},{x:.0375,y:.05,w:.075,h:.1},{x:.0625,y:.05,w:.03125,h:.041666666666666664},{x:.0625,y:.05,w:.05,h:.06666666666666667},{x:.0625,y:.05,w:.075,h:.1},{x:.0875,y:.05,w:.03125,h:.041666666666666664},{x:.0875,y:.05,w:.05,h:.06666666666666667},{x:.0875,y:.05,w:.075,h:.1},{x:.1125,y:.05,w:.03125,h:.041666666666666664},{x:.1125,y:.05,w:.05,h:.06666666666666667},{x:.1125,y:.05,w:.075,h:.1},{x:.1375,y:.05,w:.03125,h:.041666666666666664},{x:.1375,y:.05,w:.05,h:.06666666666666667},{x:.1375,y:.05,w:.075,h:.1},{x:.1625,y:.05,w:.03125,h:.041666666666666664},{x:.1625,y:.05,w:.05,h:.06666666666666667},{x:.1625,y:.05,w:.075,h:.1},{x:.1875,y:.05,w:.03125,h:.041666666666666664},{x:.1875,y:.05,w:.05,h:.06666666666666667},{x:.1875,y:.05,w:.075,h:.1},{x:.2125,y:.05,w:.03125,h:.041666666666666664},{x:.2125,y:.05,w:.05,h:.06666666666666667},{x:.2125,y:.05,w:.075,h:.1},{x:.2375,y:.05,w:.03125,h:.041666666666666664},{x:.2375,y:.05,w:.05,h:.06666666666666667},{x:.2375,y:.05,w:.075,h:.1},{x:.2625,y:.05,w:.03125,h:.041666666666666664},{x:.2625,y:.05,w:.05,h:.06666666666666667},{x:.2625,y:.05,w:.075,h:.1},{x:.2875,y:.05,w:.03125,h:.041666666666666664},{x:.2875,y:.05,w:.05,h:.06666666666666667},{x:.2875,y:.05,w:.075,h:.1},{x:.3125,y:.05,w:.03125,h:.041666666666666664},{x:.3125,y:.05,w:.05,h:.06666666666666667},{x:.3125,y:.05,w:.075,h:.1},{x:.3375,y:.05,w:.03125,h:.041666666666666664},{x:.3375,y:.05,w:.05,h:.06666666666666667},{x:.3375,y:.05,w:.075,h:.1},{x:.3625,y:.05,w:.03125,h:.041666666666666664},{x:.3625,y:.05,w:.05,h:.06666666666666667},{x:.3625,y:.05,w:.075,h:.1},{x:.3875,y:.05,w:.03125,h:.041666666666666664},{x:.3875,y:.05,w:.05,h:.06666666666666667},{x:.3875,y:.05,w:.075,h:.1},{x:.4125,y:.05,w:.03125,h:.041666666666666664},{x:.4125,y:.05,w:.05,h:.06666666666666667},{x:.4125,y:.05,w:.075,h:.1},{x:.4375,y:.05,w:.03125,h:.041666666666666664},{x:.4375,y:.05,w:.05,h:.06666666666666667},{x:.4375,y:.05,w:.075,h:.1},{x:.4625,y:.05,w:.03125,h:.041666666666666664},{x:.4625,y:.05,w:.05,h:.06666666666666667},{x:.4625,y:.05,w:.075,h:.1},{x:.4875,y:.05,w:.03125,h:.041666666666666664},{x:.4875,y:.05,w:.05,h:.06666666666666667},{x:.4875,y:.05,w:.075,h:.1},{x:.5125,y:.05,w:.03125,h:.041666666666666664},{x:.5125,y:.05,w:.05,h:.06666666666666667},{x:.5125,y:.05,w:.075,h:.1},{x:.5375,y:.05,w:.03125,h:.041666666666666664},{x:.5375,y:.05,w:.05,h:.06666666666666667},{x:.5375,y:.05,w:.075,h:.1},{x:.5625,y:.05,w:.03125,h:.041666666666666664},{x:.5625,y:.05,w:.05,h:.06666666666666667},{x:.5625,y:.05,w:.075,h:.1},{x:.5875,y:.05,w:.03125,h:.041666666666666664},{x:.5875,y:.05,w:.05,h:.06666666666666667},{x:.5875,y:.05,w:.075,h:.1},{x:.6125,y:.05,w:.03125,h:.041666666666666664},{x:.6125,y:.05,w:.05,h:.06666666666666667},{x:.6125,y:.05,w:.075,h:.1},{x:.6375,y:.05,w:.03125,h:.041666666666666664},{x:.6375,y:.05,w:.05,h:.06666666666666667},{x:.6375,y:.05,w:.075,h:.1},{x:.6625,y:.05,w:.03125,h:.041666666666666664},{x:.6625,y:.05,w:.05,h:.06666666666666667},{x:.6625,y:.05,w:.075,h:.1},{x:.6875,y:.05,w:.03125,h:.041666666666666664},{x:.6875,y:.05,w:.05,h:.06666666666666667},{x:.6875,y:.05,w:.075,h:.1},{x:.7125,y:.05,w:.03125,h:.041666666666666664},{x:.7125,y:.05,w:.05,h:.06666666666666667},{x:.7125,y:.05,w:.075,h:.1},{x:.7375,y:.05,w:.03125,h:.041666666666666664},{x:.7375,y:.05,w:.05,h:.06666666666666667},{x:.7375,y:.05,w:.075,h:.1},{x:.7625,y:.05,w:.03125,h:.041666666666666664},{x:.7625,y:.05,w:.05,h:.06666666666666667},{x:.7625,y:.05,w:.075,h:.1},{x:.7875,y:.05,w:.03125,h:.041666666666666664},{x:.7875,y:.05,w:.05,h:.06666666666666667},{x:.7875,y:.05,w:.075,h:.1},{x:.8125,y:.05,w:.03125,h:.041666666666666664},{x:.8125,y:.05,w:.05,h:.06666666666666667},{x:.8125,y:.05,w:.075,h:.1},{x:.8375,y:.05,w:.03125,h:.041666666666666664},{x:.8375,y:.05,w:.05,h:.06666666666666667},{x:.8375,y:.05,w:.075,h:.1},{x:.8625,y:.05,w:.03125,h:.041666666666666664},{x:.8625,y:.05,w:.05,h:.06666666666666667},{x:.8625,y:.05,w:.075,h:.1},{x:.8875,y:.05,w:.03125,h:.041666666666666664},{x:.8875,y:.05,w:.05,h:.06666666666666667},{x:.8875,y:.05,w:.075,h:.1},{x:.9125,y:.05,w:.03125,h:.041666666666666664},{x:.9125,y:.05,w:.05,h:.06666666666666667},{x:.9125,y:.05,w:.075,h:.1},{x:.9375,y:.05,w:.03125,h:.041666666666666664},{x:.9375,y:.05,w:.05,h:.06666666666666667},{x:.9375,y:.05,w:.075,h:.1},{x:.9625,y:.05,w:.03125,h:.041666666666666664},{x:.9625,y:.05,w:.05,h:.06666666666666667},{x:.9625,y:.05,w:.075,h:.1},{x:.9875,y:.05,w:.03125,h:.041666666666666664},{x:.9875,y:.05,w:.05,h:.06666666666666667},{x:.9875,y:.05,w:.075,h:.1},{x:.0125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.08333333333333333,w:.075,h:.1},{x:.0375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.08333333333333333,w:.075,h:.1},{x:.0625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.08333333333333333,w:.075,h:.1},{x:.0875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.08333333333333333,w:.075,h:.1},{x:.1125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.08333333333333333,w:.075,h:.1},{x:.1375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.08333333333333333,w:.075,h:.1},{x:.1625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.08333333333333333,w:.075,h:.1},{x:.1875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.08333333333333333,w:.075,h:.1},{x:.2125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.08333333333333333,w:.075,h:.1},{x:.2375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.08333333333333333,w:.075,h:.1},{x:.2625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.08333333333333333,w:.075,h:.1},{x:.2875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.08333333333333333,w:.075,h:.1},{x:.3125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.08333333333333333,w:.075,h:.1},{x:.3375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.08333333333333333,w:.075,h:.1},{x:.3625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.08333333333333333,w:.075,h:.1},{x:.3875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.08333333333333333,w:.075,h:.1},{x:.4125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.08333333333333333,w:.075,h:.1},{x:.4375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.08333333333333333,w:.075,h:.1},{x:.4625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.08333333333333333,w:.075,h:.1},{x:.4875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.08333333333333333,w:.075,h:.1},{x:.5125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.08333333333333333,w:.075,h:.1},{x:.5375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.08333333333333333,w:.075,h:.1},{x:.5625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.08333333333333333,w:.075,h:.1},{x:.5875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.08333333333333333,w:.075,h:.1},{x:.6125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.08333333333333333,w:.075,h:.1},{x:.6375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.08333333333333333,w:.075,h:.1},{x:.6625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.08333333333333333,w:.075,h:.1},{x:.6875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.08333333333333333,w:.075,h:.1},{x:.7125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.08333333333333333,w:.075,h:.1},{x:.7375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.08333333333333333,w:.075,h:.1},{x:.7625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.08333333333333333,w:.075,h:.1},{x:.7875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.08333333333333333,w:.075,h:.1},{x:.8125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.08333333333333333,w:.075,h:.1},{x:.8375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.08333333333333333,w:.075,h:.1},{x:.8625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.08333333333333333,w:.075,h:.1},{x:.8875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.08333333333333333,w:.075,h:.1},{x:.9125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.08333333333333333,w:.075,h:.1},{x:.9375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.08333333333333333,w:.075,h:.1},{x:.9625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.08333333333333333,w:.075,h:.1},{x:.9875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.08333333333333333,w:.075,h:.1},{x:.0125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.11666666666666667,w:.075,h:.1},{x:.0375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.11666666666666667,w:.075,h:.1},{x:.0625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.11666666666666667,w:.075,h:.1},{x:.0875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.11666666666666667,w:.075,h:.1},{x:.1125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.11666666666666667,w:.075,h:.1},{x:.1375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.11666666666666667,w:.075,h:.1},{x:.1625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.11666666666666667,w:.075,h:.1},{x:.1875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.11666666666666667,w:.075,h:.1},{x:.2125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.11666666666666667,w:.075,h:.1},{x:.2375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.11666666666666667,w:.075,h:.1},{x:.2625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.11666666666666667,w:.075,h:.1},{x:.2875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.11666666666666667,w:.075,h:.1},{x:.3125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.11666666666666667,w:.075,h:.1},{x:.3375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.11666666666666667,w:.075,h:.1},{x:.3625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.11666666666666667,w:.075,h:.1},{x:.3875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.11666666666666667,w:.075,h:.1},{x:.4125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.11666666666666667,w:.075,h:.1},{x:.4375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.11666666666666667,w:.075,h:.1},{x:.4625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.11666666666666667,w:.075,h:.1},{x:.4875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.11666666666666667,w:.075,h:.1},{x:.5125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.11666666666666667,w:.075,h:.1},{x:.5375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.11666666666666667,w:.075,h:.1},{x:.5625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.11666666666666667,w:.075,h:.1},{x:.5875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.11666666666666667,w:.075,h:.1},{x:.6125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.11666666666666667,w:.075,h:.1},{x:.6375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.11666666666666667,w:.075,h:.1},{x:.6625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.11666666666666667,w:.075,h:.1},{x:.6875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.11666666666666667,w:.075,h:.1},{x:.7125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.11666666666666667,w:.075,h:.1},{x:.7375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.11666666666666667,w:.075,h:.1},{x:.7625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.11666666666666667,w:.075,h:.1},{x:.7875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.11666666666666667,w:.075,h:.1},{x:.8125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.11666666666666667,w:.075,h:.1},{x:.8375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.11666666666666667,w:.075,h:.1},{x:.8625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.11666666666666667,w:.075,h:.1},{x:.8875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.11666666666666667,w:.075,h:.1},{x:.9125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.11666666666666667,w:.075,h:.1},{x:.9375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.11666666666666667,w:.075,h:.1},{x:.9625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.11666666666666667,w:.075,h:.1},{x:.9875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.11666666666666667,w:.075,h:.1},{x:.0125,y:.15,w:.03125,h:.041666666666666664},{x:.0125,y:.15,w:.05,h:.06666666666666667},{x:.0125,y:.15,w:.075,h:.1},{x:.0375,y:.15,w:.03125,h:.041666666666666664},{x:.0375,y:.15,w:.05,h:.06666666666666667},{x:.0375,y:.15,w:.075,h:.1},{x:.0625,y:.15,w:.03125,h:.041666666666666664},{x:.0625,y:.15,w:.05,h:.06666666666666667},{x:.0625,y:.15,w:.075,h:.1},{x:.0875,y:.15,w:.03125,h:.041666666666666664},{x:.0875,y:.15,w:.05,h:.06666666666666667},{x:.0875,y:.15,w:.075,h:.1},{x:.1125,y:.15,w:.03125,h:.041666666666666664},{x:.1125,y:.15,w:.05,h:.06666666666666667},{x:.1125,y:.15,w:.075,h:.1},{x:.1375,y:.15,w:.03125,h:.041666666666666664},{x:.1375,y:.15,w:.05,h:.06666666666666667},{x:.1375,y:.15,w:.075,h:.1},{x:.1625,y:.15,w:.03125,h:.041666666666666664},{x:.1625,y:.15,w:.05,h:.06666666666666667},{x:.1625,y:.15,w:.075,h:.1},{x:.1875,y:.15,w:.03125,h:.041666666666666664},{x:.1875,y:.15,w:.05,h:.06666666666666667},{x:.1875,y:.15,w:.075,h:.1},{x:.2125,y:.15,w:.03125,h:.041666666666666664},{x:.2125,y:.15,w:.05,h:.06666666666666667},{x:.2125,y:.15,w:.075,h:.1},{x:.2375,y:.15,w:.03125,h:.041666666666666664},{x:.2375,y:.15,w:.05,h:.06666666666666667},{x:.2375,y:.15,w:.075,h:.1},{x:.2625,y:.15,w:.03125,h:.041666666666666664},{x:.2625,y:.15,w:.05,h:.06666666666666667},{x:.2625,y:.15,w:.075,h:.1},{x:.2875,y:.15,w:.03125,h:.041666666666666664},{x:.2875,y:.15,w:.05,h:.06666666666666667},{x:.2875,y:.15,w:.075,h:.1},{x:.3125,y:.15,w:.03125,h:.041666666666666664},{x:.3125,y:.15,w:.05,h:.06666666666666667},{x:.3125,y:.15,w:.075,h:.1},{x:.3375,y:.15,w:.03125,h:.041666666666666664},{x:.3375,y:.15,w:.05,h:.06666666666666667},{x:.3375,y:.15,w:.075,h:.1},{x:.3625,y:.15,w:.03125,h:.041666666666666664},{x:.3625,y:.15,w:.05,h:.06666666666666667},{x:.3625,y:.15,w:.075,h:.1},{x:.3875,y:.15,w:.03125,h:.041666666666666664},{x:.3875,y:.15,w:.05,h:.06666666666666667},{x:.3875,y:.15,w:.075,h:.1},{x:.4125,y:.15,w:.03125,h:.041666666666666664},{x:.4125,y:.15,w:.05,h:.06666666666666667},{x:.4125,y:.15,w:.075,h:.1},{x:.4375,y:.15,w:.03125,h:.041666666666666664},{x:.4375,y:.15,w:.05,h:.06666666666666667},{x:.4375,y:.15,w:.075,h:.1},{x:.4625,y:.15,w:.03125,h:.041666666666666664},{x:.4625,y:.15,w:.05,h:.06666666666666667},{x:.4625,y:.15,w:.075,h:.1},{x:.4875,y:.15,w:.03125,h:.041666666666666664},{x:.4875,y:.15,w:.05,h:.06666666666666667},{x:.4875,y:.15,w:.075,h:.1},{x:.5125,y:.15,w:.03125,h:.041666666666666664},{x:.5125,y:.15,w:.05,h:.06666666666666667},{x:.5125,y:.15,w:.075,h:.1},{x:.5375,y:.15,w:.03125,h:.041666666666666664},{x:.5375,y:.15,w:.05,h:.06666666666666667},{x:.5375,y:.15,w:.075,h:.1},{x:.5625,y:.15,w:.03125,h:.041666666666666664},{x:.5625,y:.15,w:.05,h:.06666666666666667},{x:.5625,y:.15,w:.075,h:.1},{x:.5875,y:.15,w:.03125,h:.041666666666666664},{x:.5875,y:.15,w:.05,h:.06666666666666667},{x:.5875,y:.15,w:.075,h:.1},{x:.6125,y:.15,w:.03125,h:.041666666666666664},{x:.6125,y:.15,w:.05,h:.06666666666666667},{x:.6125,y:.15,w:.075,h:.1},{x:.6375,y:.15,w:.03125,h:.041666666666666664},{x:.6375,y:.15,w:.05,h:.06666666666666667},{x:.6375,y:.15,w:.075,h:.1},{x:.6625,y:.15,w:.03125,h:.041666666666666664},{x:.6625,y:.15,w:.05,h:.06666666666666667},{x:.6625,y:.15,w:.075,h:.1},{x:.6875,y:.15,w:.03125,h:.041666666666666664},{x:.6875,y:.15,w:.05,h:.06666666666666667},{x:.6875,y:.15,w:.075,h:.1},{x:.7125,y:.15,w:.03125,h:.041666666666666664},{x:.7125,y:.15,w:.05,h:.06666666666666667},{x:.7125,y:.15,w:.075,h:.1},{x:.7375,y:.15,w:.03125,h:.041666666666666664},{x:.7375,y:.15,w:.05,h:.06666666666666667},{x:.7375,y:.15,w:.075,h:.1},{x:.7625,y:.15,w:.03125,h:.041666666666666664},{x:.7625,y:.15,w:.05,h:.06666666666666667},{x:.7625,y:.15,w:.075,h:.1},{x:.7875,y:.15,w:.03125,h:.041666666666666664},{x:.7875,y:.15,w:.05,h:.06666666666666667},{x:.7875,y:.15,w:.075,h:.1},{x:.8125,y:.15,w:.03125,h:.041666666666666664},{x:.8125,y:.15,w:.05,h:.06666666666666667},{x:.8125,y:.15,w:.075,h:.1},{x:.8375,y:.15,w:.03125,h:.041666666666666664},{x:.8375,y:.15,w:.05,h:.06666666666666667},{x:.8375,y:.15,w:.075,h:.1},{x:.8625,y:.15,w:.03125,h:.041666666666666664},{x:.8625,y:.15,w:.05,h:.06666666666666667},{x:.8625,y:.15,w:.075,h:.1},{x:.8875,y:.15,w:.03125,h:.041666666666666664},{x:.8875,y:.15,w:.05,h:.06666666666666667},{x:.8875,y:.15,w:.075,h:.1},{x:.9125,y:.15,w:.03125,h:.041666666666666664},{x:.9125,y:.15,w:.05,h:.06666666666666667},{x:.9125,y:.15,w:.075,h:.1},{x:.9375,y:.15,w:.03125,h:.041666666666666664},{x:.9375,y:.15,w:.05,h:.06666666666666667},{x:.9375,y:.15,w:.075,h:.1},{x:.9625,y:.15,w:.03125,h:.041666666666666664},{x:.9625,y:.15,w:.05,h:.06666666666666667},{x:.9625,y:.15,w:.075,h:.1},{x:.9875,y:.15,w:.03125,h:.041666666666666664},{x:.9875,y:.15,w:.05,h:.06666666666666667},{x:.9875,y:.15,w:.075,h:.1},{x:.0125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0125,y:.18333333333333332,w:.075,h:.1},{x:.0375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0375,y:.18333333333333332,w:.075,h:.1},{x:.0625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0625,y:.18333333333333332,w:.075,h:.1},{x:.0875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0875,y:.18333333333333332,w:.075,h:.1},{x:.1125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1125,y:.18333333333333332,w:.075,h:.1},{x:.1375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1375,y:.18333333333333332,w:.075,h:.1},{x:.1625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1625,y:.18333333333333332,w:.075,h:.1},{x:.1875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1875,y:.18333333333333332,w:.075,h:.1},{x:.2125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2125,y:.18333333333333332,w:.075,h:.1},{x:.2375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2375,y:.18333333333333332,w:.075,h:.1},{x:.2625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2625,y:.18333333333333332,w:.075,h:.1},{x:.2875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2875,y:.18333333333333332,w:.075,h:.1},{x:.3125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3125,y:.18333333333333332,w:.075,h:.1},{x:.3375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3375,y:.18333333333333332,w:.075,h:.1},{x:.3625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3625,y:.18333333333333332,w:.075,h:.1},{x:.3875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3875,y:.18333333333333332,w:.075,h:.1},{x:.4125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4125,y:.18333333333333332,w:.075,h:.1},{x:.4375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4375,y:.18333333333333332,w:.075,h:.1},{x:.4625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4625,y:.18333333333333332,w:.075,h:.1},{x:.4875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4875,y:.18333333333333332,w:.075,h:.1},{x:.5125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5125,y:.18333333333333332,w:.075,h:.1},{x:.5375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5375,y:.18333333333333332,w:.075,h:.1},{x:.5625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5625,y:.18333333333333332,w:.075,h:.1},{x:.5875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5875,y:.18333333333333332,w:.075,h:.1},{x:.6125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6125,y:.18333333333333332,w:.075,h:.1},{x:.6375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6375,y:.18333333333333332,w:.075,h:.1},{x:.6625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6625,y:.18333333333333332,w:.075,h:.1},{x:.6875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6875,y:.18333333333333332,w:.075,h:.1},{x:.7125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7125,y:.18333333333333332,w:.075,h:.1},{x:.7375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7375,y:.18333333333333332,w:.075,h:.1},{x:.7625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7625,y:.18333333333333332,w:.075,h:.1},{x:.7875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7875,y:.18333333333333332,w:.075,h:.1},{x:.8125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8125,y:.18333333333333332,w:.075,h:.1},{x:.8375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8375,y:.18333333333333332,w:.075,h:.1},{x:.8625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8625,y:.18333333333333332,w:.075,h:.1},{x:.8875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8875,y:.18333333333333332,w:.075,h:.1},{x:.9125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9125,y:.18333333333333332,w:.075,h:.1},{x:.9375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9375,y:.18333333333333332,w:.075,h:.1},{x:.9625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9625,y:.18333333333333332,w:.075,h:.1},{x:.9875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9875,y:.18333333333333332,w:.075,h:.1},{x:.0125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.21666666666666667,w:.075,h:.1},{x:.0375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.21666666666666667,w:.075,h:.1},{x:.0625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.21666666666666667,w:.075,h:.1},{x:.0875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.21666666666666667,w:.075,h:.1},{x:.1125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.21666666666666667,w:.075,h:.1},{x:.1375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.21666666666666667,w:.075,h:.1},{x:.1625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.21666666666666667,w:.075,h:.1},{x:.1875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.21666666666666667,w:.075,h:.1},{x:.2125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.21666666666666667,w:.075,h:.1},{x:.2375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.21666666666666667,w:.075,h:.1},{x:.2625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.21666666666666667,w:.075,h:.1},{x:.2875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.21666666666666667,w:.075,h:.1},{x:.3125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.21666666666666667,w:.075,h:.1},{x:.3375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.21666666666666667,w:.075,h:.1},{x:.3625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.21666666666666667,w:.075,h:.1},{x:.3875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.21666666666666667,w:.075,h:.1},{x:.4125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.21666666666666667,w:.075,h:.1},{x:.4375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.21666666666666667,w:.075,h:.1},{x:.4625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.21666666666666667,w:.075,h:.1},{x:.4875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.21666666666666667,w:.075,h:.1},{x:.5125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.21666666666666667,w:.075,h:.1},{x:.5375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.21666666666666667,w:.075,h:.1},{x:.5625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.21666666666666667,w:.075,h:.1},{x:.5875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.21666666666666667,w:.075,h:.1},{x:.6125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.21666666666666667,w:.075,h:.1},{x:.6375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.21666666666666667,w:.075,h:.1},{x:.6625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.21666666666666667,w:.075,h:.1},{x:.6875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.21666666666666667,w:.075,h:.1},{x:.7125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.21666666666666667,w:.075,h:.1},{x:.7375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.21666666666666667,w:.075,h:.1},{x:.7625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.21666666666666667,w:.075,h:.1},{x:.7875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.21666666666666667,w:.075,h:.1},{x:.8125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.21666666666666667,w:.075,h:.1},{x:.8375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.21666666666666667,w:.075,h:.1},{x:.8625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.21666666666666667,w:.075,h:.1},{x:.8875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.21666666666666667,w:.075,h:.1},{x:.9125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.21666666666666667,w:.075,h:.1},{x:.9375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.21666666666666667,w:.075,h:.1},{x:.9625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.21666666666666667,w:.075,h:.1},{x:.9875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.21666666666666667,w:.075,h:.1},{x:.0125,y:.25,w:.03125,h:.041666666666666664},{x:.0125,y:.25,w:.05,h:.06666666666666667},{x:.0125,y:.25,w:.075,h:.1},{x:.0375,y:.25,w:.03125,h:.041666666666666664},{x:.0375,y:.25,w:.05,h:.06666666666666667},{x:.0375,y:.25,w:.075,h:.1},{x:.0625,y:.25,w:.03125,h:.041666666666666664},{x:.0625,y:.25,w:.05,h:.06666666666666667},{x:.0625,y:.25,w:.075,h:.1},{x:.0875,y:.25,w:.03125,h:.041666666666666664},{x:.0875,y:.25,w:.05,h:.06666666666666667},{x:.0875,y:.25,w:.075,h:.1},{x:.1125,y:.25,w:.03125,h:.041666666666666664},{x:.1125,y:.25,w:.05,h:.06666666666666667},{x:.1125,y:.25,w:.075,h:.1},{x:.1375,y:.25,w:.03125,h:.041666666666666664},{x:.1375,y:.25,w:.05,h:.06666666666666667},{x:.1375,y:.25,w:.075,h:.1},{x:.1625,y:.25,w:.03125,h:.041666666666666664},{x:.1625,y:.25,w:.05,h:.06666666666666667},{x:.1625,y:.25,w:.075,h:.1},{x:.1875,y:.25,w:.03125,h:.041666666666666664},{x:.1875,y:.25,w:.05,h:.06666666666666667},{x:.1875,y:.25,w:.075,h:.1},{x:.2125,y:.25,w:.03125,h:.041666666666666664},{x:.2125,y:.25,w:.05,h:.06666666666666667},{x:.2125,y:.25,w:.075,h:.1},{x:.2375,y:.25,w:.03125,h:.041666666666666664},{x:.2375,y:.25,w:.05,h:.06666666666666667},{x:.2375,y:.25,w:.075,h:.1},{x:.2625,y:.25,w:.03125,h:.041666666666666664},{x:.2625,y:.25,w:.05,h:.06666666666666667},{x:.2625,y:.25,w:.075,h:.1},{x:.2875,y:.25,w:.03125,h:.041666666666666664},{x:.2875,y:.25,w:.05,h:.06666666666666667},{x:.2875,y:.25,w:.075,h:.1},{x:.3125,y:.25,w:.03125,h:.041666666666666664},{x:.3125,y:.25,w:.05,h:.06666666666666667},{x:.3125,y:.25,w:.075,h:.1},{x:.3375,y:.25,w:.03125,h:.041666666666666664},{x:.3375,y:.25,w:.05,h:.06666666666666667},{x:.3375,y:.25,w:.075,h:.1},{x:.3625,y:.25,w:.03125,h:.041666666666666664},{x:.3625,y:.25,w:.05,h:.06666666666666667},{x:.3625,y:.25,w:.075,h:.1},{x:.3875,y:.25,w:.03125,h:.041666666666666664},{x:.3875,y:.25,w:.05,h:.06666666666666667},{x:.3875,y:.25,w:.075,h:.1},{x:.4125,y:.25,w:.03125,h:.041666666666666664},{x:.4125,y:.25,w:.05,h:.06666666666666667},{x:.4125,y:.25,w:.075,h:.1},{x:.4375,y:.25,w:.03125,h:.041666666666666664},{x:.4375,y:.25,w:.05,h:.06666666666666667},{x:.4375,y:.25,w:.075,h:.1},{x:.4625,y:.25,w:.03125,h:.041666666666666664},{x:.4625,y:.25,w:.05,h:.06666666666666667},{x:.4625,y:.25,w:.075,h:.1},{x:.4875,y:.25,w:.03125,h:.041666666666666664},{x:.4875,y:.25,w:.05,h:.06666666666666667},{x:.4875,y:.25,w:.075,h:.1},{x:.5125,y:.25,w:.03125,h:.041666666666666664},{x:.5125,y:.25,w:.05,h:.06666666666666667},{x:.5125,y:.25,w:.075,h:.1},{x:.5375,y:.25,w:.03125,h:.041666666666666664},{x:.5375,y:.25,w:.05,h:.06666666666666667},{x:.5375,y:.25,w:.075,h:.1},{x:.5625,y:.25,w:.03125,h:.041666666666666664},{x:.5625,y:.25,w:.05,h:.06666666666666667},{x:.5625,y:.25,w:.075,h:.1},{x:.5875,y:.25,w:.03125,h:.041666666666666664},{x:.5875,y:.25,w:.05,h:.06666666666666667},{x:.5875,y:.25,w:.075,h:.1},{x:.6125,y:.25,w:.03125,h:.041666666666666664},{x:.6125,y:.25,w:.05,h:.06666666666666667},{x:.6125,y:.25,w:.075,h:.1},{x:.6375,y:.25,w:.03125,h:.041666666666666664},{x:.6375,y:.25,w:.05,h:.06666666666666667},{x:.6375,y:.25,w:.075,h:.1},{x:.6625,y:.25,w:.03125,h:.041666666666666664},{x:.6625,y:.25,w:.05,h:.06666666666666667},{x:.6625,y:.25,w:.075,h:.1},{x:.6875,y:.25,w:.03125,h:.041666666666666664},{x:.6875,y:.25,w:.05,h:.06666666666666667},{x:.6875,y:.25,w:.075,h:.1},{x:.7125,y:.25,w:.03125,h:.041666666666666664},{x:.7125,y:.25,w:.05,h:.06666666666666667},{x:.7125,y:.25,w:.075,h:.1},{x:.7375,y:.25,w:.03125,h:.041666666666666664},{x:.7375,y:.25,w:.05,h:.06666666666666667},{x:.7375,y:.25,w:.075,h:.1},{x:.7625,y:.25,w:.03125,h:.041666666666666664},{x:.7625,y:.25,w:.05,h:.06666666666666667},{x:.7625,y:.25,w:.075,h:.1},{x:.7875,y:.25,w:.03125,h:.041666666666666664},{x:.7875,y:.25,w:.05,h:.06666666666666667},{x:.7875,y:.25,w:.075,h:.1},{x:.8125,y:.25,w:.03125,h:.041666666666666664},{x:.8125,y:.25,w:.05,h:.06666666666666667},{x:.8125,y:.25,w:.075,h:.1},{x:.8375,y:.25,w:.03125,h:.041666666666666664},{x:.8375,y:.25,w:.05,h:.06666666666666667},{x:.8375,y:.25,w:.075,h:.1},{x:.8625,y:.25,w:.03125,h:.041666666666666664},{x:.8625,y:.25,w:.05,h:.06666666666666667},{x:.8625,y:.25,w:.075,h:.1},{x:.8875,y:.25,w:.03125,h:.041666666666666664},{x:.8875,y:.25,w:.05,h:.06666666666666667},{x:.8875,y:.25,w:.075,h:.1},{x:.9125,y:.25,w:.03125,h:.041666666666666664},{x:.9125,y:.25,w:.05,h:.06666666666666667},{x:.9125,y:.25,w:.075,h:.1},{x:.9375,y:.25,w:.03125,h:.041666666666666664},{x:.9375,y:.25,w:.05,h:.06666666666666667},{x:.9375,y:.25,w:.075,h:.1},{x:.9625,y:.25,w:.03125,h:.041666666666666664},{x:.9625,y:.25,w:.05,h:.06666666666666667},{x:.9625,y:.25,w:.075,h:.1},{x:.9875,y:.25,w:.03125,h:.041666666666666664},{x:.9875,y:.25,w:.05,h:.06666666666666667},{x:.9875,y:.25,w:.075,h:.1},{x:.0125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.2833333333333333,w:.075,h:.1},{x:.0375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.2833333333333333,w:.075,h:.1},{x:.0625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.2833333333333333,w:.075,h:.1},{x:.0875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.2833333333333333,w:.075,h:.1},{x:.1125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.2833333333333333,w:.075,h:.1},{x:.1375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.2833333333333333,w:.075,h:.1},{x:.1625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.2833333333333333,w:.075,h:.1},{x:.1875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.2833333333333333,w:.075,h:.1},{x:.2125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.2833333333333333,w:.075,h:.1},{x:.2375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.2833333333333333,w:.075,h:.1},{x:.2625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.2833333333333333,w:.075,h:.1},{x:.2875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.2833333333333333,w:.075,h:.1},{x:.3125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.2833333333333333,w:.075,h:.1},{x:.3375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.2833333333333333,w:.075,h:.1},{x:.3625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.2833333333333333,w:.075,h:.1},{x:.3875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.2833333333333333,w:.075,h:.1},{x:.4125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.2833333333333333,w:.075,h:.1},{x:.4375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.2833333333333333,w:.075,h:.1},{x:.4625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.2833333333333333,w:.075,h:.1},{x:.4875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.2833333333333333,w:.075,h:.1},{x:.5125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.2833333333333333,w:.075,h:.1},{x:.5375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.2833333333333333,w:.075,h:.1},{x:.5625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.2833333333333333,w:.075,h:.1},{x:.5875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.2833333333333333,w:.075,h:.1},{x:.6125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.2833333333333333,w:.075,h:.1},{x:.6375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.2833333333333333,w:.075,h:.1},{x:.6625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.2833333333333333,w:.075,h:.1},{x:.6875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.2833333333333333,w:.075,h:.1},{x:.7125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.2833333333333333,w:.075,h:.1},{x:.7375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.2833333333333333,w:.075,h:.1},{x:.7625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.2833333333333333,w:.075,h:.1},{x:.7875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.2833333333333333,w:.075,h:.1},{x:.8125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.2833333333333333,w:.075,h:.1},{x:.8375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.2833333333333333,w:.075,h:.1},{x:.8625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.2833333333333333,w:.075,h:.1},{x:.8875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.2833333333333333,w:.075,h:.1},{x:.9125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.2833333333333333,w:.075,h:.1},{x:.9375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.2833333333333333,w:.075,h:.1},{x:.9625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.2833333333333333,w:.075,h:.1},{x:.9875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.2833333333333333,w:.075,h:.1},{x:.0125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0125,y:.31666666666666665,w:.075,h:.1},{x:.0375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0375,y:.31666666666666665,w:.075,h:.1},{x:.0625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0625,y:.31666666666666665,w:.075,h:.1},{x:.0875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0875,y:.31666666666666665,w:.075,h:.1},{x:.1125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1125,y:.31666666666666665,w:.075,h:.1},{x:.1375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1375,y:.31666666666666665,w:.075,h:.1},{x:.1625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1625,y:.31666666666666665,w:.075,h:.1},{x:.1875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1875,y:.31666666666666665,w:.075,h:.1},{x:.2125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2125,y:.31666666666666665,w:.075,h:.1},{x:.2375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2375,y:.31666666666666665,w:.075,h:.1},{x:.2625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2625,y:.31666666666666665,w:.075,h:.1},{x:.2875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2875,y:.31666666666666665,w:.075,h:.1},{x:.3125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3125,y:.31666666666666665,w:.075,h:.1},{x:.3375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3375,y:.31666666666666665,w:.075,h:.1},{x:.3625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3625,y:.31666666666666665,w:.075,h:.1},{x:.3875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3875,y:.31666666666666665,w:.075,h:.1},{x:.4125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4125,y:.31666666666666665,w:.075,h:.1},{x:.4375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4375,y:.31666666666666665,w:.075,h:.1},{x:.4625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4625,y:.31666666666666665,w:.075,h:.1},{x:.4875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4875,y:.31666666666666665,w:.075,h:.1},{x:.5125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5125,y:.31666666666666665,w:.075,h:.1},{x:.5375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5375,y:.31666666666666665,w:.075,h:.1},{x:.5625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5625,y:.31666666666666665,w:.075,h:.1},{x:.5875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5875,y:.31666666666666665,w:.075,h:.1},{x:.6125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6125,y:.31666666666666665,w:.075,h:.1},{x:.6375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6375,y:.31666666666666665,w:.075,h:.1},{x:.6625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6625,y:.31666666666666665,w:.075,h:.1},{x:.6875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6875,y:.31666666666666665,w:.075,h:.1},{x:.7125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7125,y:.31666666666666665,w:.075,h:.1},{x:.7375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7375,y:.31666666666666665,w:.075,h:.1},{x:.7625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7625,y:.31666666666666665,w:.075,h:.1},{x:.7875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7875,y:.31666666666666665,w:.075,h:.1},{x:.8125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8125,y:.31666666666666665,w:.075,h:.1},{x:.8375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8375,y:.31666666666666665,w:.075,h:.1},{x:.8625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8625,y:.31666666666666665,w:.075,h:.1},{x:.8875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8875,y:.31666666666666665,w:.075,h:.1},{x:.9125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9125,y:.31666666666666665,w:.075,h:.1},{x:.9375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9375,y:.31666666666666665,w:.075,h:.1},{x:.9625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9625,y:.31666666666666665,w:.075,h:.1},{x:.9875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9875,y:.31666666666666665,w:.075,h:.1},{x:.0125,y:.35,w:.03125,h:.041666666666666664},{x:.0125,y:.35,w:.05,h:.06666666666666667},{x:.0125,y:.35,w:.075,h:.1},{x:.0375,y:.35,w:.03125,h:.041666666666666664},{x:.0375,y:.35,w:.05,h:.06666666666666667},{x:.0375,y:.35,w:.075,h:.1},{x:.0625,y:.35,w:.03125,h:.041666666666666664},{x:.0625,y:.35,w:.05,h:.06666666666666667},{x:.0625,y:.35,w:.075,h:.1},{x:.0875,y:.35,w:.03125,h:.041666666666666664},{x:.0875,y:.35,w:.05,h:.06666666666666667},{x:.0875,y:.35,w:.075,h:.1},{x:.1125,y:.35,w:.03125,h:.041666666666666664},{x:.1125,y:.35,w:.05,h:.06666666666666667},{x:.1125,y:.35,w:.075,h:.1},{x:.1375,y:.35,w:.03125,h:.041666666666666664},{x:.1375,y:.35,w:.05,h:.06666666666666667},{x:.1375,y:.35,w:.075,h:.1},{x:.1625,y:.35,w:.03125,h:.041666666666666664},{x:.1625,y:.35,w:.05,h:.06666666666666667},{x:.1625,y:.35,w:.075,h:.1},{x:.1875,y:.35,w:.03125,h:.041666666666666664},{x:.1875,y:.35,w:.05,h:.06666666666666667},{x:.1875,y:.35,w:.075,h:.1},{x:.2125,y:.35,w:.03125,h:.041666666666666664},{x:.2125,y:.35,w:.05,h:.06666666666666667},{x:.2125,y:.35,w:.075,h:.1},{x:.2375,y:.35,w:.03125,h:.041666666666666664},{x:.2375,y:.35,w:.05,h:.06666666666666667},{x:.2375,y:.35,w:.075,h:.1},{x:.2625,y:.35,w:.03125,h:.041666666666666664},{x:.2625,y:.35,w:.05,h:.06666666666666667},{x:.2625,y:.35,w:.075,h:.1},{x:.2875,y:.35,w:.03125,h:.041666666666666664},{x:.2875,y:.35,w:.05,h:.06666666666666667},{x:.2875,y:.35,w:.075,h:.1},{x:.3125,y:.35,w:.03125,h:.041666666666666664},{x:.3125,y:.35,w:.05,h:.06666666666666667},{x:.3125,y:.35,w:.075,h:.1},{x:.3375,y:.35,w:.03125,h:.041666666666666664},{x:.3375,y:.35,w:.05,h:.06666666666666667},{x:.3375,y:.35,w:.075,h:.1},{x:.3625,y:.35,w:.03125,h:.041666666666666664},{x:.3625,y:.35,w:.05,h:.06666666666666667},{x:.3625,y:.35,w:.075,h:.1},{x:.3875,y:.35,w:.03125,h:.041666666666666664},{x:.3875,y:.35,w:.05,h:.06666666666666667},{x:.3875,y:.35,w:.075,h:.1},{x:.4125,y:.35,w:.03125,h:.041666666666666664},{x:.4125,y:.35,w:.05,h:.06666666666666667},{x:.4125,y:.35,w:.075,h:.1},{x:.4375,y:.35,w:.03125,h:.041666666666666664},{x:.4375,y:.35,w:.05,h:.06666666666666667},{x:.4375,y:.35,w:.075,h:.1},{x:.4625,y:.35,w:.03125,h:.041666666666666664},{x:.4625,y:.35,w:.05,h:.06666666666666667},{x:.4625,y:.35,w:.075,h:.1},{x:.4875,y:.35,w:.03125,h:.041666666666666664},{x:.4875,y:.35,w:.05,h:.06666666666666667},{x:.4875,y:.35,w:.075,h:.1},{x:.5125,y:.35,w:.03125,h:.041666666666666664},{x:.5125,y:.35,w:.05,h:.06666666666666667},{x:.5125,y:.35,w:.075,h:.1},{x:.5375,y:.35,w:.03125,h:.041666666666666664},{x:.5375,y:.35,w:.05,h:.06666666666666667},{x:.5375,y:.35,w:.075,h:.1},{x:.5625,y:.35,w:.03125,h:.041666666666666664},{x:.5625,y:.35,w:.05,h:.06666666666666667},{x:.5625,y:.35,w:.075,h:.1},{x:.5875,y:.35,w:.03125,h:.041666666666666664},{x:.5875,y:.35,w:.05,h:.06666666666666667},{x:.5875,y:.35,w:.075,h:.1},{x:.6125,y:.35,w:.03125,h:.041666666666666664},{x:.6125,y:.35,w:.05,h:.06666666666666667},{x:.6125,y:.35,w:.075,h:.1},{x:.6375,y:.35,w:.03125,h:.041666666666666664},{x:.6375,y:.35,w:.05,h:.06666666666666667},{x:.6375,y:.35,w:.075,h:.1},{x:.6625,y:.35,w:.03125,h:.041666666666666664},{x:.6625,y:.35,w:.05,h:.06666666666666667},{x:.6625,y:.35,w:.075,h:.1},{x:.6875,y:.35,w:.03125,h:.041666666666666664},{x:.6875,y:.35,w:.05,h:.06666666666666667},{x:.6875,y:.35,w:.075,h:.1},{x:.7125,y:.35,w:.03125,h:.041666666666666664},{x:.7125,y:.35,w:.05,h:.06666666666666667},{x:.7125,y:.35,w:.075,h:.1},{x:.7375,y:.35,w:.03125,h:.041666666666666664},{x:.7375,y:.35,w:.05,h:.06666666666666667},{x:.7375,y:.35,w:.075,h:.1},{x:.7625,y:.35,w:.03125,h:.041666666666666664},{x:.7625,y:.35,w:.05,h:.06666666666666667},{x:.7625,y:.35,w:.075,h:.1},{x:.7875,y:.35,w:.03125,h:.041666666666666664},{x:.7875,y:.35,w:.05,h:.06666666666666667},{x:.7875,y:.35,w:.075,h:.1},{x:.8125,y:.35,w:.03125,h:.041666666666666664},{x:.8125,y:.35,w:.05,h:.06666666666666667},{x:.8125,y:.35,w:.075,h:.1},{x:.8375,y:.35,w:.03125,h:.041666666666666664},{x:.8375,y:.35,w:.05,h:.06666666666666667},{x:.8375,y:.35,w:.075,h:.1},{x:.8625,y:.35,w:.03125,h:.041666666666666664},{x:.8625,y:.35,w:.05,h:.06666666666666667},{x:.8625,y:.35,w:.075,h:.1},{x:.8875,y:.35,w:.03125,h:.041666666666666664},{x:.8875,y:.35,w:.05,h:.06666666666666667},{x:.8875,y:.35,w:.075,h:.1},{x:.9125,y:.35,w:.03125,h:.041666666666666664},{x:.9125,y:.35,w:.05,h:.06666666666666667},{x:.9125,y:.35,w:.075,h:.1},{x:.9375,y:.35,w:.03125,h:.041666666666666664},{x:.9375,y:.35,w:.05,h:.06666666666666667},{x:.9375,y:.35,w:.075,h:.1},{x:.9625,y:.35,w:.03125,h:.041666666666666664},{x:.9625,y:.35,w:.05,h:.06666666666666667},{x:.9625,y:.35,w:.075,h:.1},{x:.9875,y:.35,w:.03125,h:.041666666666666664},{x:.9875,y:.35,w:.05,h:.06666666666666667},{x:.9875,y:.35,w:.075,h:.1},{x:.0125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0125,y:.38333333333333336,w:.075,h:.1},{x:.0375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0375,y:.38333333333333336,w:.075,h:.1},{x:.0625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0625,y:.38333333333333336,w:.075,h:.1},{x:.0875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0875,y:.38333333333333336,w:.075,h:.1},{x:.1125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1125,y:.38333333333333336,w:.075,h:.1},{x:.1375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1375,y:.38333333333333336,w:.075,h:.1},{x:.1625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1625,y:.38333333333333336,w:.075,h:.1},{x:.1875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1875,y:.38333333333333336,w:.075,h:.1},{x:.2125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2125,y:.38333333333333336,w:.075,h:.1},{x:.2375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2375,y:.38333333333333336,w:.075,h:.1},{x:.2625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2625,y:.38333333333333336,w:.075,h:.1},{x:.2875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2875,y:.38333333333333336,w:.075,h:.1},{x:.3125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3125,y:.38333333333333336,w:.075,h:.1},{x:.3375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3375,y:.38333333333333336,w:.075,h:.1},{x:.3625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3625,y:.38333333333333336,w:.075,h:.1},{x:.3875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3875,y:.38333333333333336,w:.075,h:.1},{x:.4125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4125,y:.38333333333333336,w:.075,h:.1},{x:.4375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4375,y:.38333333333333336,w:.075,h:.1},{x:.4625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4625,y:.38333333333333336,w:.075,h:.1},{x:.4875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4875,y:.38333333333333336,w:.075,h:.1},{x:.5125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5125,y:.38333333333333336,w:.075,h:.1},{x:.5375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5375,y:.38333333333333336,w:.075,h:.1},{x:.5625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5625,y:.38333333333333336,w:.075,h:.1},{x:.5875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5875,y:.38333333333333336,w:.075,h:.1},{x:.6125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6125,y:.38333333333333336,w:.075,h:.1},{x:.6375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6375,y:.38333333333333336,w:.075,h:.1},{x:.6625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6625,y:.38333333333333336,w:.075,h:.1},{x:.6875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6875,y:.38333333333333336,w:.075,h:.1},{x:.7125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7125,y:.38333333333333336,w:.075,h:.1},{x:.7375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7375,y:.38333333333333336,w:.075,h:.1},{x:.7625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7625,y:.38333333333333336,w:.075,h:.1},{x:.7875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7875,y:.38333333333333336,w:.075,h:.1},{x:.8125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8125,y:.38333333333333336,w:.075,h:.1},{x:.8375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8375,y:.38333333333333336,w:.075,h:.1},{x:.8625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8625,y:.38333333333333336,w:.075,h:.1},{x:.8875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8875,y:.38333333333333336,w:.075,h:.1},{x:.9125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9125,y:.38333333333333336,w:.075,h:.1},{x:.9375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9375,y:.38333333333333336,w:.075,h:.1},{x:.9625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9625,y:.38333333333333336,w:.075,h:.1},{x:.9875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9875,y:.38333333333333336,w:.075,h:.1},{x:.0125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.4166666666666667,w:.075,h:.1},{x:.0375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.4166666666666667,w:.075,h:.1},{x:.0625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.4166666666666667,w:.075,h:.1},{x:.0875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.4166666666666667,w:.075,h:.1},{x:.1125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.4166666666666667,w:.075,h:.1},{x:.1375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.4166666666666667,w:.075,h:.1},{x:.1625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.4166666666666667,w:.075,h:.1},{x:.1875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.4166666666666667,w:.075,h:.1},{x:.2125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.4166666666666667,w:.075,h:.1},{x:.2375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.4166666666666667,w:.075,h:.1},{x:.2625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.4166666666666667,w:.075,h:.1},{x:.2875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.4166666666666667,w:.075,h:.1},{x:.3125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.4166666666666667,w:.075,h:.1},{x:.3375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.4166666666666667,w:.075,h:.1},{x:.3625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.4166666666666667,w:.075,h:.1},{x:.3875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.4166666666666667,w:.075,h:.1},{x:.4125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.4166666666666667,w:.075,h:.1},{x:.4375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.4166666666666667,w:.075,h:.1},{x:.4625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.4166666666666667,w:.075,h:.1},{x:.4875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.4166666666666667,w:.075,h:.1},{x:.5125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.4166666666666667,w:.075,h:.1},{x:.5375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.4166666666666667,w:.075,h:.1},{x:.5625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.4166666666666667,w:.075,h:.1},{x:.5875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.4166666666666667,w:.075,h:.1},{x:.6125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.4166666666666667,w:.075,h:.1},{x:.6375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.4166666666666667,w:.075,h:.1},{x:.6625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.4166666666666667,w:.075,h:.1},{x:.6875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.4166666666666667,w:.075,h:.1},{x:.7125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.4166666666666667,w:.075,h:.1},{x:.7375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.4166666666666667,w:.075,h:.1},{x:.7625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.4166666666666667,w:.075,h:.1},{x:.7875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.4166666666666667,w:.075,h:.1},{x:.8125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.4166666666666667,w:.075,h:.1},{x:.8375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.4166666666666667,w:.075,h:.1},{x:.8625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.4166666666666667,w:.075,h:.1},{x:.8875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.4166666666666667,w:.075,h:.1},{x:.9125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.4166666666666667,w:.075,h:.1},{x:.9375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.4166666666666667,w:.075,h:.1},{x:.9625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.4166666666666667,w:.075,h:.1},{x:.9875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.4166666666666667,w:.075,h:.1},{x:.0125,y:.45,w:.03125,h:.041666666666666664},{x:.0125,y:.45,w:.05,h:.06666666666666667},{x:.0125,y:.45,w:.075,h:.1},{x:.0375,y:.45,w:.03125,h:.041666666666666664},{x:.0375,y:.45,w:.05,h:.06666666666666667},{x:.0375,y:.45,w:.075,h:.1},{x:.0625,y:.45,w:.03125,h:.041666666666666664},{x:.0625,y:.45,w:.05,h:.06666666666666667},{x:.0625,y:.45,w:.075,h:.1},{x:.0875,y:.45,w:.03125,h:.041666666666666664},{x:.0875,y:.45,w:.05,h:.06666666666666667},{x:.0875,y:.45,w:.075,h:.1},{x:.1125,y:.45,w:.03125,h:.041666666666666664},{x:.1125,y:.45,w:.05,h:.06666666666666667},{x:.1125,y:.45,w:.075,h:.1},{x:.1375,y:.45,w:.03125,h:.041666666666666664},{x:.1375,y:.45,w:.05,h:.06666666666666667},{x:.1375,y:.45,w:.075,h:.1},{x:.1625,y:.45,w:.03125,h:.041666666666666664},{x:.1625,y:.45,w:.05,h:.06666666666666667},{x:.1625,y:.45,w:.075,h:.1},{x:.1875,y:.45,w:.03125,h:.041666666666666664},{x:.1875,y:.45,w:.05,h:.06666666666666667},{x:.1875,y:.45,w:.075,h:.1},{x:.2125,y:.45,w:.03125,h:.041666666666666664},{x:.2125,y:.45,w:.05,h:.06666666666666667},{x:.2125,y:.45,w:.075,h:.1},{x:.2375,y:.45,w:.03125,h:.041666666666666664},{x:.2375,y:.45,w:.05,h:.06666666666666667},{x:.2375,y:.45,w:.075,h:.1},{x:.2625,y:.45,w:.03125,h:.041666666666666664},{x:.2625,y:.45,w:.05,h:.06666666666666667},{x:.2625,y:.45,w:.075,h:.1},{x:.2875,y:.45,w:.03125,h:.041666666666666664},{x:.2875,y:.45,w:.05,h:.06666666666666667},{x:.2875,y:.45,w:.075,h:.1},{x:.3125,y:.45,w:.03125,h:.041666666666666664},{x:.3125,y:.45,w:.05,h:.06666666666666667},{x:.3125,y:.45,w:.075,h:.1},{x:.3375,y:.45,w:.03125,h:.041666666666666664},{x:.3375,y:.45,w:.05,h:.06666666666666667},{x:.3375,y:.45,w:.075,h:.1},{x:.3625,y:.45,w:.03125,h:.041666666666666664},{x:.3625,y:.45,w:.05,h:.06666666666666667},{x:.3625,y:.45,w:.075,h:.1},{x:.3875,y:.45,w:.03125,h:.041666666666666664},{x:.3875,y:.45,w:.05,h:.06666666666666667},{x:.3875,y:.45,w:.075,h:.1},{x:.4125,y:.45,w:.03125,h:.041666666666666664},{x:.4125,y:.45,w:.05,h:.06666666666666667},{x:.4125,y:.45,w:.075,h:.1},{x:.4375,y:.45,w:.03125,h:.041666666666666664},{x:.4375,y:.45,w:.05,h:.06666666666666667},{x:.4375,y:.45,w:.075,h:.1},{x:.4625,y:.45,w:.03125,h:.041666666666666664},{x:.4625,y:.45,w:.05,h:.06666666666666667},{x:.4625,y:.45,w:.075,h:.1},{x:.4875,y:.45,w:.03125,h:.041666666666666664},{x:.4875,y:.45,w:.05,h:.06666666666666667},{x:.4875,y:.45,w:.075,h:.1},{x:.5125,y:.45,w:.03125,h:.041666666666666664},{x:.5125,y:.45,w:.05,h:.06666666666666667},{x:.5125,y:.45,w:.075,h:.1},{x:.5375,y:.45,w:.03125,h:.041666666666666664},{x:.5375,y:.45,w:.05,h:.06666666666666667},{x:.5375,y:.45,w:.075,h:.1},{x:.5625,y:.45,w:.03125,h:.041666666666666664},{x:.5625,y:.45,w:.05,h:.06666666666666667},{x:.5625,y:.45,w:.075,h:.1},{x:.5875,y:.45,w:.03125,h:.041666666666666664},{x:.5875,y:.45,w:.05,h:.06666666666666667},{x:.5875,y:.45,w:.075,h:.1},{x:.6125,y:.45,w:.03125,h:.041666666666666664},{x:.6125,y:.45,w:.05,h:.06666666666666667},{x:.6125,y:.45,w:.075,h:.1},{x:.6375,y:.45,w:.03125,h:.041666666666666664},{x:.6375,y:.45,w:.05,h:.06666666666666667},{x:.6375,y:.45,w:.075,h:.1},{x:.6625,y:.45,w:.03125,h:.041666666666666664},{x:.6625,y:.45,w:.05,h:.06666666666666667},{x:.6625,y:.45,w:.075,h:.1},{x:.6875,y:.45,w:.03125,h:.041666666666666664},{x:.6875,y:.45,w:.05,h:.06666666666666667},{x:.6875,y:.45,w:.075,h:.1},{x:.7125,y:.45,w:.03125,h:.041666666666666664},{x:.7125,y:.45,w:.05,h:.06666666666666667},{x:.7125,y:.45,w:.075,h:.1},{x:.7375,y:.45,w:.03125,h:.041666666666666664},{x:.7375,y:.45,w:.05,h:.06666666666666667},{x:.7375,y:.45,w:.075,h:.1},{x:.7625,y:.45,w:.03125,h:.041666666666666664},{x:.7625,y:.45,w:.05,h:.06666666666666667},{x:.7625,y:.45,w:.075,h:.1},{x:.7875,y:.45,w:.03125,h:.041666666666666664},{x:.7875,y:.45,w:.05,h:.06666666666666667},{x:.7875,y:.45,w:.075,h:.1},{x:.8125,y:.45,w:.03125,h:.041666666666666664},{x:.8125,y:.45,w:.05,h:.06666666666666667},{x:.8125,y:.45,w:.075,h:.1},{x:.8375,y:.45,w:.03125,h:.041666666666666664},{x:.8375,y:.45,w:.05,h:.06666666666666667},{x:.8375,y:.45,w:.075,h:.1},{x:.8625,y:.45,w:.03125,h:.041666666666666664},{x:.8625,y:.45,w:.05,h:.06666666666666667},{x:.8625,y:.45,w:.075,h:.1},{x:.8875,y:.45,w:.03125,h:.041666666666666664},{x:.8875,y:.45,w:.05,h:.06666666666666667},{x:.8875,y:.45,w:.075,h:.1},{x:.9125,y:.45,w:.03125,h:.041666666666666664},{x:.9125,y:.45,w:.05,h:.06666666666666667},{x:.9125,y:.45,w:.075,h:.1},{x:.9375,y:.45,w:.03125,h:.041666666666666664},{x:.9375,y:.45,w:.05,h:.06666666666666667},{x:.9375,y:.45,w:.075,h:.1},{x:.9625,y:.45,w:.03125,h:.041666666666666664},{x:.9625,y:.45,w:.05,h:.06666666666666667},{x:.9625,y:.45,w:.075,h:.1},{x:.9875,y:.45,w:.03125,h:.041666666666666664},{x:.9875,y:.45,w:.05,h:.06666666666666667},{x:.9875,y:.45,w:.075,h:.1},{x:.0125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.48333333333333334,w:.075,h:.1},{x:.0375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.48333333333333334,w:.075,h:.1},{x:.0625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.48333333333333334,w:.075,h:.1},{x:.0875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.48333333333333334,w:.075,h:.1},{x:.1125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.48333333333333334,w:.075,h:.1},{x:.1375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.48333333333333334,w:.075,h:.1},{x:.1625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.48333333333333334,w:.075,h:.1},{x:.1875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.48333333333333334,w:.075,h:.1},{x:.2125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.48333333333333334,w:.075,h:.1},{x:.2375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.48333333333333334,w:.075,h:.1},{x:.2625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.48333333333333334,w:.075,h:.1},{x:.2875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.48333333333333334,w:.075,h:.1},{x:.3125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.48333333333333334,w:.075,h:.1},{x:.3375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.48333333333333334,w:.075,h:.1},{x:.3625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.48333333333333334,w:.075,h:.1},{x:.3875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.48333333333333334,w:.075,h:.1},{x:.4125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.48333333333333334,w:.075,h:.1},{x:.4375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.48333333333333334,w:.075,h:.1},{x:.4625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.48333333333333334,w:.075,h:.1},{x:.4875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.48333333333333334,w:.075,h:.1},{x:.5125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.48333333333333334,w:.075,h:.1},{x:.5375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.48333333333333334,w:.075,h:.1},{x:.5625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.48333333333333334,w:.075,h:.1},{x:.5875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.48333333333333334,w:.075,h:.1},{x:.6125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.48333333333333334,w:.075,h:.1},{x:.6375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.48333333333333334,w:.075,h:.1},{x:.6625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.48333333333333334,w:.075,h:.1},{x:.6875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.48333333333333334,w:.075,h:.1},{x:.7125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.48333333333333334,w:.075,h:.1},{x:.7375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.48333333333333334,w:.075,h:.1},{x:.7625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.48333333333333334,w:.075,h:.1},{x:.7875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.48333333333333334,w:.075,h:.1},{x:.8125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.48333333333333334,w:.075,h:.1},{x:.8375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.48333333333333334,w:.075,h:.1},{x:.8625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.48333333333333334,w:.075,h:.1},{x:.8875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.48333333333333334,w:.075,h:.1},{x:.9125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.48333333333333334,w:.075,h:.1},{x:.9375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.48333333333333334,w:.075,h:.1},{x:.9625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.48333333333333334,w:.075,h:.1},{x:.9875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.48333333333333334,w:.075,h:.1},{x:.0125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.5166666666666667,w:.075,h:.1},{x:.0375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.5166666666666667,w:.075,h:.1},{x:.0625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.5166666666666667,w:.075,h:.1},{x:.0875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.5166666666666667,w:.075,h:.1},{x:.1125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.5166666666666667,w:.075,h:.1},{x:.1375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.5166666666666667,w:.075,h:.1},{x:.1625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.5166666666666667,w:.075,h:.1},{x:.1875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.5166666666666667,w:.075,h:.1},{x:.2125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.5166666666666667,w:.075,h:.1},{x:.2375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.5166666666666667,w:.075,h:.1},{x:.2625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.5166666666666667,w:.075,h:.1},{x:.2875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.5166666666666667,w:.075,h:.1},{x:.3125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.5166666666666667,w:.075,h:.1},{x:.3375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.5166666666666667,w:.075,h:.1},{x:.3625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.5166666666666667,w:.075,h:.1},{x:.3875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.5166666666666667,w:.075,h:.1},{x:.4125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.5166666666666667,w:.075,h:.1},{x:.4375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.5166666666666667,w:.075,h:.1},{x:.4625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.5166666666666667,w:.075,h:.1},{x:.4875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.5166666666666667,w:.075,h:.1},{x:.5125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.5166666666666667,w:.075,h:.1},{x:.5375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.5166666666666667,w:.075,h:.1},{x:.5625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.5166666666666667,w:.075,h:.1},{x:.5875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.5166666666666667,w:.075,h:.1},{x:.6125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.5166666666666667,w:.075,h:.1},{x:.6375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.5166666666666667,w:.075,h:.1},{x:.6625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.5166666666666667,w:.075,h:.1},{x:.6875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.5166666666666667,w:.075,h:.1},{x:.7125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.5166666666666667,w:.075,h:.1},{x:.7375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.5166666666666667,w:.075,h:.1},{x:.7625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.5166666666666667,w:.075,h:.1},{x:.7875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.5166666666666667,w:.075,h:.1},{x:.8125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.5166666666666667,w:.075,h:.1},{x:.8375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.5166666666666667,w:.075,h:.1},{x:.8625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.5166666666666667,w:.075,h:.1},{x:.8875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.5166666666666667,w:.075,h:.1},{x:.9125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.5166666666666667,w:.075,h:.1},{x:.9375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.5166666666666667,w:.075,h:.1},{x:.9625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.5166666666666667,w:.075,h:.1},{x:.9875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.5166666666666667,w:.075,h:.1},{x:.0125,y:.55,w:.03125,h:.041666666666666664},{x:.0125,y:.55,w:.05,h:.06666666666666667},{x:.0125,y:.55,w:.075,h:.1},{x:.0375,y:.55,w:.03125,h:.041666666666666664},{x:.0375,y:.55,w:.05,h:.06666666666666667},{x:.0375,y:.55,w:.075,h:.1},{x:.0625,y:.55,w:.03125,h:.041666666666666664},{x:.0625,y:.55,w:.05,h:.06666666666666667},{x:.0625,y:.55,w:.075,h:.1},{x:.0875,y:.55,w:.03125,h:.041666666666666664},{x:.0875,y:.55,w:.05,h:.06666666666666667},{x:.0875,y:.55,w:.075,h:.1},{x:.1125,y:.55,w:.03125,h:.041666666666666664},{x:.1125,y:.55,w:.05,h:.06666666666666667},{x:.1125,y:.55,w:.075,h:.1},{x:.1375,y:.55,w:.03125,h:.041666666666666664},{x:.1375,y:.55,w:.05,h:.06666666666666667},{x:.1375,y:.55,w:.075,h:.1},{x:.1625,y:.55,w:.03125,h:.041666666666666664},{x:.1625,y:.55,w:.05,h:.06666666666666667},{x:.1625,y:.55,w:.075,h:.1},{x:.1875,y:.55,w:.03125,h:.041666666666666664},{x:.1875,y:.55,w:.05,h:.06666666666666667},{x:.1875,y:.55,w:.075,h:.1},{x:.2125,y:.55,w:.03125,h:.041666666666666664},{x:.2125,y:.55,w:.05,h:.06666666666666667},{x:.2125,y:.55,w:.075,h:.1},{x:.2375,y:.55,w:.03125,h:.041666666666666664},{x:.2375,y:.55,w:.05,h:.06666666666666667},{x:.2375,y:.55,w:.075,h:.1},{x:.2625,y:.55,w:.03125,h:.041666666666666664},{x:.2625,y:.55,w:.05,h:.06666666666666667},{x:.2625,y:.55,w:.075,h:.1},{x:.2875,y:.55,w:.03125,h:.041666666666666664},{x:.2875,y:.55,w:.05,h:.06666666666666667},{x:.2875,y:.55,w:.075,h:.1},{x:.3125,y:.55,w:.03125,h:.041666666666666664},{x:.3125,y:.55,w:.05,h:.06666666666666667},{x:.3125,y:.55,w:.075,h:.1},{x:.3375,y:.55,w:.03125,h:.041666666666666664},{x:.3375,y:.55,w:.05,h:.06666666666666667},{x:.3375,y:.55,w:.075,h:.1},{x:.3625,y:.55,w:.03125,h:.041666666666666664},{x:.3625,y:.55,w:.05,h:.06666666666666667},{x:.3625,y:.55,w:.075,h:.1},{x:.3875,y:.55,w:.03125,h:.041666666666666664},{x:.3875,y:.55,w:.05,h:.06666666666666667},{x:.3875,y:.55,w:.075,h:.1},{x:.4125,y:.55,w:.03125,h:.041666666666666664},{x:.4125,y:.55,w:.05,h:.06666666666666667},{x:.4125,y:.55,w:.075,h:.1},{x:.4375,y:.55,w:.03125,h:.041666666666666664},{x:.4375,y:.55,w:.05,h:.06666666666666667},{x:.4375,y:.55,w:.075,h:.1},{x:.4625,y:.55,w:.03125,h:.041666666666666664},{x:.4625,y:.55,w:.05,h:.06666666666666667},{x:.4625,y:.55,w:.075,h:.1},{x:.4875,y:.55,w:.03125,h:.041666666666666664},{x:.4875,y:.55,w:.05,h:.06666666666666667},{x:.4875,y:.55,w:.075,h:.1},{x:.5125,y:.55,w:.03125,h:.041666666666666664},{x:.5125,y:.55,w:.05,h:.06666666666666667},{x:.5125,y:.55,w:.075,h:.1},{x:.5375,y:.55,w:.03125,h:.041666666666666664},{x:.5375,y:.55,w:.05,h:.06666666666666667},{x:.5375,y:.55,w:.075,h:.1},{x:.5625,y:.55,w:.03125,h:.041666666666666664},{x:.5625,y:.55,w:.05,h:.06666666666666667},{x:.5625,y:.55,w:.075,h:.1},{x:.5875,y:.55,w:.03125,h:.041666666666666664},{x:.5875,y:.55,w:.05,h:.06666666666666667},{x:.5875,y:.55,w:.075,h:.1},{x:.6125,y:.55,w:.03125,h:.041666666666666664},{x:.6125,y:.55,w:.05,h:.06666666666666667},{x:.6125,y:.55,w:.075,h:.1},{x:.6375,y:.55,w:.03125,h:.041666666666666664},{x:.6375,y:.55,w:.05,h:.06666666666666667},{x:.6375,y:.55,w:.075,h:.1},{x:.6625,y:.55,w:.03125,h:.041666666666666664},{x:.6625,y:.55,w:.05,h:.06666666666666667},{x:.6625,y:.55,w:.075,h:.1},{x:.6875,y:.55,w:.03125,h:.041666666666666664},{x:.6875,y:.55,w:.05,h:.06666666666666667},{x:.6875,y:.55,w:.075,h:.1},{x:.7125,y:.55,w:.03125,h:.041666666666666664},{x:.7125,y:.55,w:.05,h:.06666666666666667},{x:.7125,y:.55,w:.075,h:.1},{x:.7375,y:.55,w:.03125,h:.041666666666666664},{x:.7375,y:.55,w:.05,h:.06666666666666667},{x:.7375,y:.55,w:.075,h:.1},{x:.7625,y:.55,w:.03125,h:.041666666666666664},{x:.7625,y:.55,w:.05,h:.06666666666666667},{x:.7625,y:.55,w:.075,h:.1},{x:.7875,y:.55,w:.03125,h:.041666666666666664},{x:.7875,y:.55,w:.05,h:.06666666666666667},{x:.7875,y:.55,w:.075,h:.1},{x:.8125,y:.55,w:.03125,h:.041666666666666664},{x:.8125,y:.55,w:.05,h:.06666666666666667},{x:.8125,y:.55,w:.075,h:.1},{x:.8375,y:.55,w:.03125,h:.041666666666666664},{x:.8375,y:.55,w:.05,h:.06666666666666667},{x:.8375,y:.55,w:.075,h:.1},{x:.8625,y:.55,w:.03125,h:.041666666666666664},{x:.8625,y:.55,w:.05,h:.06666666666666667},{x:.8625,y:.55,w:.075,h:.1},{x:.8875,y:.55,w:.03125,h:.041666666666666664},{x:.8875,y:.55,w:.05,h:.06666666666666667},{x:.8875,y:.55,w:.075,h:.1},{x:.9125,y:.55,w:.03125,h:.041666666666666664},{x:.9125,y:.55,w:.05,h:.06666666666666667},{x:.9125,y:.55,w:.075,h:.1},{x:.9375,y:.55,w:.03125,h:.041666666666666664},{x:.9375,y:.55,w:.05,h:.06666666666666667},{x:.9375,y:.55,w:.075,h:.1},{x:.9625,y:.55,w:.03125,h:.041666666666666664},{x:.9625,y:.55,w:.05,h:.06666666666666667},{x:.9625,y:.55,w:.075,h:.1},{x:.9875,y:.55,w:.03125,h:.041666666666666664},{x:.9875,y:.55,w:.05,h:.06666666666666667},{x:.9875,y:.55,w:.075,h:.1},{x:.0125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.5833333333333334,w:.075,h:.1},{x:.0375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.5833333333333334,w:.075,h:.1},{x:.0625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.5833333333333334,w:.075,h:.1},{x:.0875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.5833333333333334,w:.075,h:.1},{x:.1125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.5833333333333334,w:.075,h:.1},{x:.1375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.5833333333333334,w:.075,h:.1},{x:.1625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.5833333333333334,w:.075,h:.1},{x:.1875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.5833333333333334,w:.075,h:.1},{x:.2125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.5833333333333334,w:.075,h:.1},{x:.2375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.5833333333333334,w:.075,h:.1},{x:.2625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.5833333333333334,w:.075,h:.1},{x:.2875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.5833333333333334,w:.075,h:.1},{x:.3125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.5833333333333334,w:.075,h:.1},{x:.3375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.5833333333333334,w:.075,h:.1},{x:.3625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.5833333333333334,w:.075,h:.1},{x:.3875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.5833333333333334,w:.075,h:.1},{x:.4125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.5833333333333334,w:.075,h:.1},{x:.4375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.5833333333333334,w:.075,h:.1},{x:.4625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.5833333333333334,w:.075,h:.1},{x:.4875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.5833333333333334,w:.075,h:.1},{x:.5125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.5833333333333334,w:.075,h:.1},{x:.5375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.5833333333333334,w:.075,h:.1},{x:.5625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.5833333333333334,w:.075,h:.1},{x:.5875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.5833333333333334,w:.075,h:.1},{x:.6125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.5833333333333334,w:.075,h:.1},{x:.6375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.5833333333333334,w:.075,h:.1},{x:.6625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.5833333333333334,w:.075,h:.1},{x:.6875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.5833333333333334,w:.075,h:.1},{x:.7125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.5833333333333334,w:.075,h:.1},{x:.7375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.5833333333333334,w:.075,h:.1},{x:.7625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.5833333333333334,w:.075,h:.1},{x:.7875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.5833333333333334,w:.075,h:.1},{x:.8125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.5833333333333334,w:.075,h:.1},{x:.8375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.5833333333333334,w:.075,h:.1},{x:.8625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.5833333333333334,w:.075,h:.1},{x:.8875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.5833333333333334,w:.075,h:.1},{x:.9125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.5833333333333334,w:.075,h:.1},{x:.9375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.5833333333333334,w:.075,h:.1},{x:.9625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.5833333333333334,w:.075,h:.1},{x:.9875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.5833333333333334,w:.075,h:.1},{x:.0125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.6166666666666667,w:.075,h:.1},{x:.0375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.6166666666666667,w:.075,h:.1},{x:.0625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.6166666666666667,w:.075,h:.1},{x:.0875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.6166666666666667,w:.075,h:.1},{x:.1125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.6166666666666667,w:.075,h:.1},{x:.1375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.6166666666666667,w:.075,h:.1},{x:.1625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.6166666666666667,w:.075,h:.1},{x:.1875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.6166666666666667,w:.075,h:.1},{x:.2125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.6166666666666667,w:.075,h:.1},{x:.2375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.6166666666666667,w:.075,h:.1},{x:.2625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.6166666666666667,w:.075,h:.1},{x:.2875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.6166666666666667,w:.075,h:.1},{x:.3125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.6166666666666667,w:.075,h:.1},{x:.3375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.6166666666666667,w:.075,h:.1},{x:.3625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.6166666666666667,w:.075,h:.1},{x:.3875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.6166666666666667,w:.075,h:.1},{x:.4125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.6166666666666667,w:.075,h:.1},{x:.4375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.6166666666666667,w:.075,h:.1},{x:.4625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.6166666666666667,w:.075,h:.1},{x:.4875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.6166666666666667,w:.075,h:.1},{x:.5125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.6166666666666667,w:.075,h:.1},{x:.5375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.6166666666666667,w:.075,h:.1},{x:.5625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.6166666666666667,w:.075,h:.1},{x:.5875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.6166666666666667,w:.075,h:.1},{x:.6125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.6166666666666667,w:.075,h:.1},{x:.6375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.6166666666666667,w:.075,h:.1},{x:.6625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.6166666666666667,w:.075,h:.1},{x:.6875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.6166666666666667,w:.075,h:.1},{x:.7125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.6166666666666667,w:.075,h:.1},{x:.7375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.6166666666666667,w:.075,h:.1},{x:.7625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.6166666666666667,w:.075,h:.1},{x:.7875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.6166666666666667,w:.075,h:.1},{x:.8125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.6166666666666667,w:.075,h:.1},{x:.8375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.6166666666666667,w:.075,h:.1},{x:.8625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.6166666666666667,w:.075,h:.1},{x:.8875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.6166666666666667,w:.075,h:.1},{x:.9125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.6166666666666667,w:.075,h:.1},{x:.9375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.6166666666666667,w:.075,h:.1},{x:.9625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.6166666666666667,w:.075,h:.1},{x:.9875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.6166666666666667,w:.075,h:.1},{x:.0125,y:.65,w:.03125,h:.041666666666666664},{x:.0125,y:.65,w:.05,h:.06666666666666667},{x:.0125,y:.65,w:.075,h:.1},{x:.0375,y:.65,w:.03125,h:.041666666666666664},{x:.0375,y:.65,w:.05,h:.06666666666666667},{x:.0375,y:.65,w:.075,h:.1},{x:.0625,y:.65,w:.03125,h:.041666666666666664},{x:.0625,y:.65,w:.05,h:.06666666666666667},{x:.0625,y:.65,w:.075,h:.1},{x:.0875,y:.65,w:.03125,h:.041666666666666664},{x:.0875,y:.65,w:.05,h:.06666666666666667},{x:.0875,y:.65,w:.075,h:.1},{x:.1125,y:.65,w:.03125,h:.041666666666666664},{x:.1125,y:.65,w:.05,h:.06666666666666667},{x:.1125,y:.65,w:.075,h:.1},{x:.1375,y:.65,w:.03125,h:.041666666666666664},{x:.1375,y:.65,w:.05,h:.06666666666666667},{x:.1375,y:.65,w:.075,h:.1},{x:.1625,y:.65,w:.03125,h:.041666666666666664},{x:.1625,y:.65,w:.05,h:.06666666666666667},{x:.1625,y:.65,w:.075,h:.1},{x:.1875,y:.65,w:.03125,h:.041666666666666664},{x:.1875,y:.65,w:.05,h:.06666666666666667},{x:.1875,y:.65,w:.075,h:.1},{x:.2125,y:.65,w:.03125,h:.041666666666666664},{x:.2125,y:.65,w:.05,h:.06666666666666667},{x:.2125,y:.65,w:.075,h:.1},{x:.2375,y:.65,w:.03125,h:.041666666666666664},{x:.2375,y:.65,w:.05,h:.06666666666666667},{x:.2375,y:.65,w:.075,h:.1},{x:.2625,y:.65,w:.03125,h:.041666666666666664},{x:.2625,y:.65,w:.05,h:.06666666666666667},{x:.2625,y:.65,w:.075,h:.1},{x:.2875,y:.65,w:.03125,h:.041666666666666664},{x:.2875,y:.65,w:.05,h:.06666666666666667},{x:.2875,y:.65,w:.075,h:.1},{x:.3125,y:.65,w:.03125,h:.041666666666666664},{x:.3125,y:.65,w:.05,h:.06666666666666667},{x:.3125,y:.65,w:.075,h:.1},{x:.3375,y:.65,w:.03125,h:.041666666666666664},{x:.3375,y:.65,w:.05,h:.06666666666666667},{x:.3375,y:.65,w:.075,h:.1},{x:.3625,y:.65,w:.03125,h:.041666666666666664},{x:.3625,y:.65,w:.05,h:.06666666666666667},{x:.3625,y:.65,w:.075,h:.1},{x:.3875,y:.65,w:.03125,h:.041666666666666664},{x:.3875,y:.65,w:.05,h:.06666666666666667},{x:.3875,y:.65,w:.075,h:.1},{x:.4125,y:.65,w:.03125,h:.041666666666666664},{x:.4125,y:.65,w:.05,h:.06666666666666667},{x:.4125,y:.65,w:.075,h:.1},{x:.4375,y:.65,w:.03125,h:.041666666666666664},{x:.4375,y:.65,w:.05,h:.06666666666666667},{x:.4375,y:.65,w:.075,h:.1},{x:.4625,y:.65,w:.03125,h:.041666666666666664},{x:.4625,y:.65,w:.05,h:.06666666666666667},{x:.4625,y:.65,w:.075,h:.1},{x:.4875,y:.65,w:.03125,h:.041666666666666664},{x:.4875,y:.65,w:.05,h:.06666666666666667},{x:.4875,y:.65,w:.075,h:.1},{x:.5125,y:.65,w:.03125,h:.041666666666666664},{x:.5125,y:.65,w:.05,h:.06666666666666667},{x:.5125,y:.65,w:.075,h:.1},{x:.5375,y:.65,w:.03125,h:.041666666666666664},{x:.5375,y:.65,w:.05,h:.06666666666666667},{x:.5375,y:.65,w:.075,h:.1},{x:.5625,y:.65,w:.03125,h:.041666666666666664},{x:.5625,y:.65,w:.05,h:.06666666666666667},{x:.5625,y:.65,w:.075,h:.1},{x:.5875,y:.65,w:.03125,h:.041666666666666664},{x:.5875,y:.65,w:.05,h:.06666666666666667},{x:.5875,y:.65,w:.075,h:.1},{x:.6125,y:.65,w:.03125,h:.041666666666666664},{x:.6125,y:.65,w:.05,h:.06666666666666667},{x:.6125,y:.65,w:.075,h:.1},{x:.6375,y:.65,w:.03125,h:.041666666666666664},{x:.6375,y:.65,w:.05,h:.06666666666666667},{x:.6375,y:.65,w:.075,h:.1},{x:.6625,y:.65,w:.03125,h:.041666666666666664},{x:.6625,y:.65,w:.05,h:.06666666666666667},{x:.6625,y:.65,w:.075,h:.1},{x:.6875,y:.65,w:.03125,h:.041666666666666664},{x:.6875,y:.65,w:.05,h:.06666666666666667},{x:.6875,y:.65,w:.075,h:.1},{x:.7125,y:.65,w:.03125,h:.041666666666666664},{x:.7125,y:.65,w:.05,h:.06666666666666667},{x:.7125,y:.65,w:.075,h:.1},{x:.7375,y:.65,w:.03125,h:.041666666666666664},{x:.7375,y:.65,w:.05,h:.06666666666666667},{x:.7375,y:.65,w:.075,h:.1},{x:.7625,y:.65,w:.03125,h:.041666666666666664},{x:.7625,y:.65,w:.05,h:.06666666666666667},{x:.7625,y:.65,w:.075,h:.1},{x:.7875,y:.65,w:.03125,h:.041666666666666664},{x:.7875,y:.65,w:.05,h:.06666666666666667},{x:.7875,y:.65,w:.075,h:.1},{x:.8125,y:.65,w:.03125,h:.041666666666666664},{x:.8125,y:.65,w:.05,h:.06666666666666667},{x:.8125,y:.65,w:.075,h:.1},{x:.8375,y:.65,w:.03125,h:.041666666666666664},{x:.8375,y:.65,w:.05,h:.06666666666666667},{x:.8375,y:.65,w:.075,h:.1},{x:.8625,y:.65,w:.03125,h:.041666666666666664},{x:.8625,y:.65,w:.05,h:.06666666666666667},{x:.8625,y:.65,w:.075,h:.1},{x:.8875,y:.65,w:.03125,h:.041666666666666664},{x:.8875,y:.65,w:.05,h:.06666666666666667},{x:.8875,y:.65,w:.075,h:.1},{x:.9125,y:.65,w:.03125,h:.041666666666666664},{x:.9125,y:.65,w:.05,h:.06666666666666667},{x:.9125,y:.65,w:.075,h:.1},{x:.9375,y:.65,w:.03125,h:.041666666666666664},{x:.9375,y:.65,w:.05,h:.06666666666666667},{x:.9375,y:.65,w:.075,h:.1},{x:.9625,y:.65,w:.03125,h:.041666666666666664},{x:.9625,y:.65,w:.05,h:.06666666666666667},{x:.9625,y:.65,w:.075,h:.1},{x:.9875,y:.65,w:.03125,h:.041666666666666664},{x:.9875,y:.65,w:.05,h:.06666666666666667},{x:.9875,y:.65,w:.075,h:.1},{x:.0125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.6833333333333333,w:.075,h:.1},{x:.0375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.6833333333333333,w:.075,h:.1},{x:.0625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.6833333333333333,w:.075,h:.1},{x:.0875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.6833333333333333,w:.075,h:.1},{x:.1125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.6833333333333333,w:.075,h:.1},{x:.1375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.6833333333333333,w:.075,h:.1},{x:.1625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.6833333333333333,w:.075,h:.1},{x:.1875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.6833333333333333,w:.075,h:.1},{x:.2125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.6833333333333333,w:.075,h:.1},{x:.2375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.6833333333333333,w:.075,h:.1},{x:.2625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.6833333333333333,w:.075,h:.1},{x:.2875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.6833333333333333,w:.075,h:.1},{x:.3125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.6833333333333333,w:.075,h:.1},{x:.3375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.6833333333333333,w:.075,h:.1},{x:.3625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.6833333333333333,w:.075,h:.1},{x:.3875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.6833333333333333,w:.075,h:.1},{x:.4125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.6833333333333333,w:.075,h:.1},{x:.4375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.6833333333333333,w:.075,h:.1},{x:.4625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.6833333333333333,w:.075,h:.1},{x:.4875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.6833333333333333,w:.075,h:.1},{x:.5125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.6833333333333333,w:.075,h:.1},{x:.5375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.6833333333333333,w:.075,h:.1},{x:.5625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.6833333333333333,w:.075,h:.1},{x:.5875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.6833333333333333,w:.075,h:.1},{x:.6125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.6833333333333333,w:.075,h:.1},{x:.6375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.6833333333333333,w:.075,h:.1},{x:.6625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.6833333333333333,w:.075,h:.1},{x:.6875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.6833333333333333,w:.075,h:.1},{x:.7125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.6833333333333333,w:.075,h:.1},{x:.7375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.6833333333333333,w:.075,h:.1},{x:.7625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.6833333333333333,w:.075,h:.1},{x:.7875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.6833333333333333,w:.075,h:.1},{x:.8125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.6833333333333333,w:.075,h:.1},{x:.8375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.6833333333333333,w:.075,h:.1},{x:.8625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.6833333333333333,w:.075,h:.1},{x:.8875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.6833333333333333,w:.075,h:.1},{x:.9125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.6833333333333333,w:.075,h:.1},{x:.9375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.6833333333333333,w:.075,h:.1},{x:.9625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.6833333333333333,w:.075,h:.1},{x:.9875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.6833333333333333,w:.075,h:.1},{x:.0125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.7166666666666667,w:.075,h:.1},{x:.0375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.7166666666666667,w:.075,h:.1},{x:.0625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.7166666666666667,w:.075,h:.1},{x:.0875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.7166666666666667,w:.075,h:.1},{x:.1125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.7166666666666667,w:.075,h:.1},{x:.1375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.7166666666666667,w:.075,h:.1},{x:.1625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.7166666666666667,w:.075,h:.1},{x:.1875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.7166666666666667,w:.075,h:.1},{x:.2125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.7166666666666667,w:.075,h:.1},{x:.2375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.7166666666666667,w:.075,h:.1},{x:.2625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.7166666666666667,w:.075,h:.1},{x:.2875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.7166666666666667,w:.075,h:.1},{x:.3125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.7166666666666667,w:.075,h:.1},{x:.3375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.7166666666666667,w:.075,h:.1},{x:.3625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.7166666666666667,w:.075,h:.1},{x:.3875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.7166666666666667,w:.075,h:.1},{x:.4125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.7166666666666667,w:.075,h:.1},{x:.4375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.7166666666666667,w:.075,h:.1},{x:.4625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.7166666666666667,w:.075,h:.1},{x:.4875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.7166666666666667,w:.075,h:.1},{x:.5125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.7166666666666667,w:.075,h:.1},{x:.5375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.7166666666666667,w:.075,h:.1},{x:.5625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.7166666666666667,w:.075,h:.1},{x:.5875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.7166666666666667,w:.075,h:.1},{x:.6125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.7166666666666667,w:.075,h:.1},{x:.6375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.7166666666666667,w:.075,h:.1},{x:.6625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.7166666666666667,w:.075,h:.1},{x:.6875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.7166666666666667,w:.075,h:.1},{x:.7125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.7166666666666667,w:.075,h:.1},{x:.7375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.7166666666666667,w:.075,h:.1},{x:.7625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.7166666666666667,w:.075,h:.1},{x:.7875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.7166666666666667,w:.075,h:.1},{x:.8125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.7166666666666667,w:.075,h:.1},{x:.8375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.7166666666666667,w:.075,h:.1},{x:.8625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.7166666666666667,w:.075,h:.1},{x:.8875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.7166666666666667,w:.075,h:.1},{x:.9125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.7166666666666667,w:.075,h:.1},{x:.9375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.7166666666666667,w:.075,h:.1},{x:.9625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.7166666666666667,w:.075,h:.1},{x:.9875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.7166666666666667,w:.075,h:.1},{x:.0125,y:.75,w:.03125,h:.041666666666666664},{x:.0125,y:.75,w:.05,h:.06666666666666667},{x:.0125,y:.75,w:.075,h:.1},{x:.0375,y:.75,w:.03125,h:.041666666666666664},{x:.0375,y:.75,w:.05,h:.06666666666666667},{x:.0375,y:.75,w:.075,h:.1},{x:.0625,y:.75,w:.03125,h:.041666666666666664},{x:.0625,y:.75,w:.05,h:.06666666666666667},{x:.0625,y:.75,w:.075,h:.1},{x:.0875,y:.75,w:.03125,h:.041666666666666664},{x:.0875,y:.75,w:.05,h:.06666666666666667},{x:.0875,y:.75,w:.075,h:.1},{x:.1125,y:.75,w:.03125,h:.041666666666666664},{x:.1125,y:.75,w:.05,h:.06666666666666667},{x:.1125,y:.75,w:.075,h:.1},{x:.1375,y:.75,w:.03125,h:.041666666666666664},{x:.1375,y:.75,w:.05,h:.06666666666666667},{x:.1375,y:.75,w:.075,h:.1},{x:.1625,y:.75,w:.03125,h:.041666666666666664},{x:.1625,y:.75,w:.05,h:.06666666666666667},{x:.1625,y:.75,w:.075,h:.1},{x:.1875,y:.75,w:.03125,h:.041666666666666664},{x:.1875,y:.75,w:.05,h:.06666666666666667},{x:.1875,y:.75,w:.075,h:.1},{x:.2125,y:.75,w:.03125,h:.041666666666666664},{x:.2125,y:.75,w:.05,h:.06666666666666667},{x:.2125,y:.75,w:.075,h:.1},{x:.2375,y:.75,w:.03125,h:.041666666666666664},{x:.2375,y:.75,w:.05,h:.06666666666666667},{x:.2375,y:.75,w:.075,h:.1},{x:.2625,y:.75,w:.03125,h:.041666666666666664},{x:.2625,y:.75,w:.05,h:.06666666666666667},{x:.2625,y:.75,w:.075,h:.1},{x:.2875,y:.75,w:.03125,h:.041666666666666664},{x:.2875,y:.75,w:.05,h:.06666666666666667},{x:.2875,y:.75,w:.075,h:.1},{x:.3125,y:.75,w:.03125,h:.041666666666666664},{x:.3125,y:.75,w:.05,h:.06666666666666667},{x:.3125,y:.75,w:.075,h:.1},{x:.3375,y:.75,w:.03125,h:.041666666666666664},{x:.3375,y:.75,w:.05,h:.06666666666666667},{x:.3375,y:.75,w:.075,h:.1},{x:.3625,y:.75,w:.03125,h:.041666666666666664},{x:.3625,y:.75,w:.05,h:.06666666666666667},{x:.3625,y:.75,w:.075,h:.1},{x:.3875,y:.75,w:.03125,h:.041666666666666664},{x:.3875,y:.75,w:.05,h:.06666666666666667},{x:.3875,y:.75,w:.075,h:.1},{x:.4125,y:.75,w:.03125,h:.041666666666666664},{x:.4125,y:.75,w:.05,h:.06666666666666667},{x:.4125,y:.75,w:.075,h:.1},{x:.4375,y:.75,w:.03125,h:.041666666666666664},{x:.4375,y:.75,w:.05,h:.06666666666666667},{x:.4375,y:.75,w:.075,h:.1},{x:.4625,y:.75,w:.03125,h:.041666666666666664},{x:.4625,y:.75,w:.05,h:.06666666666666667},{x:.4625,y:.75,w:.075,h:.1},{x:.4875,y:.75,w:.03125,h:.041666666666666664},{x:.4875,y:.75,w:.05,h:.06666666666666667},{x:.4875,y:.75,w:.075,h:.1},{x:.5125,y:.75,w:.03125,h:.041666666666666664},{x:.5125,y:.75,w:.05,h:.06666666666666667},{x:.5125,y:.75,w:.075,h:.1},{x:.5375,y:.75,w:.03125,h:.041666666666666664},{x:.5375,y:.75,w:.05,h:.06666666666666667},{x:.5375,y:.75,w:.075,h:.1},{x:.5625,y:.75,w:.03125,h:.041666666666666664},{x:.5625,y:.75,w:.05,h:.06666666666666667},{x:.5625,y:.75,w:.075,h:.1},{x:.5875,y:.75,w:.03125,h:.041666666666666664},{x:.5875,y:.75,w:.05,h:.06666666666666667},{x:.5875,y:.75,w:.075,h:.1},{x:.6125,y:.75,w:.03125,h:.041666666666666664},{x:.6125,y:.75,w:.05,h:.06666666666666667},{x:.6125,y:.75,w:.075,h:.1},{x:.6375,y:.75,w:.03125,h:.041666666666666664},{x:.6375,y:.75,w:.05,h:.06666666666666667},{x:.6375,y:.75,w:.075,h:.1},{x:.6625,y:.75,w:.03125,h:.041666666666666664},{x:.6625,y:.75,w:.05,h:.06666666666666667},{x:.6625,y:.75,w:.075,h:.1},{x:.6875,y:.75,w:.03125,h:.041666666666666664},{x:.6875,y:.75,w:.05,h:.06666666666666667},{x:.6875,y:.75,w:.075,h:.1},{x:.7125,y:.75,w:.03125,h:.041666666666666664},{x:.7125,y:.75,w:.05,h:.06666666666666667},{x:.7125,y:.75,w:.075,h:.1},{x:.7375,y:.75,w:.03125,h:.041666666666666664},{x:.7375,y:.75,w:.05,h:.06666666666666667},{x:.7375,y:.75,w:.075,h:.1},{x:.7625,y:.75,w:.03125,h:.041666666666666664},{x:.7625,y:.75,w:.05,h:.06666666666666667},{x:.7625,y:.75,w:.075,h:.1},{x:.7875,y:.75,w:.03125,h:.041666666666666664},{x:.7875,y:.75,w:.05,h:.06666666666666667},{x:.7875,y:.75,w:.075,h:.1},{x:.8125,y:.75,w:.03125,h:.041666666666666664},{x:.8125,y:.75,w:.05,h:.06666666666666667},{x:.8125,y:.75,w:.075,h:.1},{x:.8375,y:.75,w:.03125,h:.041666666666666664},{x:.8375,y:.75,w:.05,h:.06666666666666667},{x:.8375,y:.75,w:.075,h:.1},{x:.8625,y:.75,w:.03125,h:.041666666666666664},{x:.8625,y:.75,w:.05,h:.06666666666666667},{x:.8625,y:.75,w:.075,h:.1},{x:.8875,y:.75,w:.03125,h:.041666666666666664},{x:.8875,y:.75,w:.05,h:.06666666666666667},{x:.8875,y:.75,w:.075,h:.1},{x:.9125,y:.75,w:.03125,h:.041666666666666664},{x:.9125,y:.75,w:.05,h:.06666666666666667},{x:.9125,y:.75,w:.075,h:.1},{x:.9375,y:.75,w:.03125,h:.041666666666666664},{x:.9375,y:.75,w:.05,h:.06666666666666667},{x:.9375,y:.75,w:.075,h:.1},{x:.9625,y:.75,w:.03125,h:.041666666666666664},{x:.9625,y:.75,w:.05,h:.06666666666666667},{x:.9625,y:.75,w:.075,h:.1},{x:.9875,y:.75,w:.03125,h:.041666666666666664},{x:.9875,y:.75,w:.05,h:.06666666666666667},{x:.9875,y:.75,w:.075,h:.1},{x:.0125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.7833333333333333,w:.075,h:.1},{x:.0375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.7833333333333333,w:.075,h:.1},{x:.0625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.7833333333333333,w:.075,h:.1},{x:.0875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.7833333333333333,w:.075,h:.1},{x:.1125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.7833333333333333,w:.075,h:.1},{x:.1375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.7833333333333333,w:.075,h:.1},{x:.1625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.7833333333333333,w:.075,h:.1},{x:.1875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.7833333333333333,w:.075,h:.1},{x:.2125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.7833333333333333,w:.075,h:.1},{x:.2375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.7833333333333333,w:.075,h:.1},{x:.2625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.7833333333333333,w:.075,h:.1},{x:.2875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.7833333333333333,w:.075,h:.1},{x:.3125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.7833333333333333,w:.075,h:.1},{x:.3375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.7833333333333333,w:.075,h:.1},{x:.3625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.7833333333333333,w:.075,h:.1},{x:.3875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.7833333333333333,w:.075,h:.1},{x:.4125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.7833333333333333,w:.075,h:.1},{x:.4375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.7833333333333333,w:.075,h:.1},{x:.4625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.7833333333333333,w:.075,h:.1},{x:.4875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.7833333333333333,w:.075,h:.1},{x:.5125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.7833333333333333,w:.075,h:.1},{x:.5375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.7833333333333333,w:.075,h:.1},{x:.5625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.7833333333333333,w:.075,h:.1},{x:.5875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.7833333333333333,w:.075,h:.1},{x:.6125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.7833333333333333,w:.075,h:.1},{x:.6375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.7833333333333333,w:.075,h:.1},{x:.6625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.7833333333333333,w:.075,h:.1},{x:.6875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.7833333333333333,w:.075,h:.1},{x:.7125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.7833333333333333,w:.075,h:.1},{x:.7375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.7833333333333333,w:.075,h:.1},{x:.7625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.7833333333333333,w:.075,h:.1},{x:.7875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.7833333333333333,w:.075,h:.1},{x:.8125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.7833333333333333,w:.075,h:.1},{x:.8375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.7833333333333333,w:.075,h:.1},{x:.8625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.7833333333333333,w:.075,h:.1},{x:.8875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.7833333333333333,w:.075,h:.1},{x:.9125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.7833333333333333,w:.075,h:.1},{x:.9375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.7833333333333333,w:.075,h:.1},{x:.9625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.7833333333333333,w:.075,h:.1},{x:.9875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.7833333333333333,w:.075,h:.1},{x:.0125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.8166666666666667,w:.075,h:.1},{x:.0375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.8166666666666667,w:.075,h:.1},{x:.0625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.8166666666666667,w:.075,h:.1},{x:.0875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.8166666666666667,w:.075,h:.1},{x:.1125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.8166666666666667,w:.075,h:.1},{x:.1375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.8166666666666667,w:.075,h:.1},{x:.1625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.8166666666666667,w:.075,h:.1},{x:.1875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.8166666666666667,w:.075,h:.1},{x:.2125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.8166666666666667,w:.075,h:.1},{x:.2375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.8166666666666667,w:.075,h:.1},{x:.2625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.8166666666666667,w:.075,h:.1},{x:.2875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.8166666666666667,w:.075,h:.1},{x:.3125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.8166666666666667,w:.075,h:.1},{x:.3375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.8166666666666667,w:.075,h:.1},{x:.3625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.8166666666666667,w:.075,h:.1},{x:.3875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.8166666666666667,w:.075,h:.1},{x:.4125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.8166666666666667,w:.075,h:.1},{x:.4375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.8166666666666667,w:.075,h:.1},{x:.4625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.8166666666666667,w:.075,h:.1},{x:.4875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.8166666666666667,w:.075,h:.1},{x:.5125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.8166666666666667,w:.075,h:.1},{x:.5375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.8166666666666667,w:.075,h:.1},{x:.5625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.8166666666666667,w:.075,h:.1},{x:.5875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.8166666666666667,w:.075,h:.1},{x:.6125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.8166666666666667,w:.075,h:.1},{x:.6375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.8166666666666667,w:.075,h:.1},{x:.6625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.8166666666666667,w:.075,h:.1},{x:.6875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.8166666666666667,w:.075,h:.1},{x:.7125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.8166666666666667,w:.075,h:.1},{x:.7375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.8166666666666667,w:.075,h:.1},{x:.7625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.8166666666666667,w:.075,h:.1},{x:.7875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.8166666666666667,w:.075,h:.1},{x:.8125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.8166666666666667,w:.075,h:.1},{x:.8375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.8166666666666667,w:.075,h:.1},{x:.8625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.8166666666666667,w:.075,h:.1},{x:.8875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.8166666666666667,w:.075,h:.1},{x:.9125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.8166666666666667,w:.075,h:.1},{x:.9375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.8166666666666667,w:.075,h:.1},{x:.9625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.8166666666666667,w:.075,h:.1},{x:.9875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.8166666666666667,w:.075,h:.1},{x:.0125,y:.85,w:.03125,h:.041666666666666664},{x:.0125,y:.85,w:.05,h:.06666666666666667},{x:.0125,y:.85,w:.075,h:.1},{x:.0375,y:.85,w:.03125,h:.041666666666666664},{x:.0375,y:.85,w:.05,h:.06666666666666667},{x:.0375,y:.85,w:.075,h:.1},{x:.0625,y:.85,w:.03125,h:.041666666666666664},{x:.0625,y:.85,w:.05,h:.06666666666666667},{x:.0625,y:.85,w:.075,h:.1},{x:.0875,y:.85,w:.03125,h:.041666666666666664},{x:.0875,y:.85,w:.05,h:.06666666666666667},{x:.0875,y:.85,w:.075,h:.1},{x:.1125,y:.85,w:.03125,h:.041666666666666664},{x:.1125,y:.85,w:.05,h:.06666666666666667},{x:.1125,y:.85,w:.075,h:.1},{x:.1375,y:.85,w:.03125,h:.041666666666666664},{x:.1375,y:.85,w:.05,h:.06666666666666667},{x:.1375,y:.85,w:.075,h:.1},{x:.1625,y:.85,w:.03125,h:.041666666666666664},{x:.1625,y:.85,w:.05,h:.06666666666666667},{x:.1625,y:.85,w:.075,h:.1},{x:.1875,y:.85,w:.03125,h:.041666666666666664},{x:.1875,y:.85,w:.05,h:.06666666666666667},{x:.1875,y:.85,w:.075,h:.1},{x:.2125,y:.85,w:.03125,h:.041666666666666664},{x:.2125,y:.85,w:.05,h:.06666666666666667},{x:.2125,y:.85,w:.075,h:.1},{x:.2375,y:.85,w:.03125,h:.041666666666666664},{x:.2375,y:.85,w:.05,h:.06666666666666667},{x:.2375,y:.85,w:.075,h:.1},{x:.2625,y:.85,w:.03125,h:.041666666666666664},{x:.2625,y:.85,w:.05,h:.06666666666666667},{x:.2625,y:.85,w:.075,h:.1},{x:.2875,y:.85,w:.03125,h:.041666666666666664},{x:.2875,y:.85,w:.05,h:.06666666666666667},{x:.2875,y:.85,w:.075,h:.1},{x:.3125,y:.85,w:.03125,h:.041666666666666664},{x:.3125,y:.85,w:.05,h:.06666666666666667},{x:.3125,y:.85,w:.075,h:.1},{x:.3375,y:.85,w:.03125,h:.041666666666666664},{x:.3375,y:.85,w:.05,h:.06666666666666667},{x:.3375,y:.85,w:.075,h:.1},{x:.3625,y:.85,w:.03125,h:.041666666666666664},{x:.3625,y:.85,w:.05,h:.06666666666666667},{x:.3625,y:.85,w:.075,h:.1},{x:.3875,y:.85,w:.03125,h:.041666666666666664},{x:.3875,y:.85,w:.05,h:.06666666666666667},{x:.3875,y:.85,w:.075,h:.1},{x:.4125,y:.85,w:.03125,h:.041666666666666664},{x:.4125,y:.85,w:.05,h:.06666666666666667},{x:.4125,y:.85,w:.075,h:.1},{x:.4375,y:.85,w:.03125,h:.041666666666666664},{x:.4375,y:.85,w:.05,h:.06666666666666667},{x:.4375,y:.85,w:.075,h:.1},{x:.4625,y:.85,w:.03125,h:.041666666666666664},{x:.4625,y:.85,w:.05,h:.06666666666666667},{x:.4625,y:.85,w:.075,h:.1},{x:.4875,y:.85,w:.03125,h:.041666666666666664},{x:.4875,y:.85,w:.05,h:.06666666666666667},{x:.4875,y:.85,w:.075,h:.1},{x:.5125,y:.85,w:.03125,h:.041666666666666664},{x:.5125,y:.85,w:.05,h:.06666666666666667},{x:.5125,y:.85,w:.075,h:.1},{x:.5375,y:.85,w:.03125,h:.041666666666666664},{x:.5375,y:.85,w:.05,h:.06666666666666667},{x:.5375,y:.85,w:.075,h:.1},{x:.5625,y:.85,w:.03125,h:.041666666666666664},{x:.5625,y:.85,w:.05,h:.06666666666666667},{x:.5625,y:.85,w:.075,h:.1},{x:.5875,y:.85,w:.03125,h:.041666666666666664},{x:.5875,y:.85,w:.05,h:.06666666666666667},{x:.5875,y:.85,w:.075,h:.1},{x:.6125,y:.85,w:.03125,h:.041666666666666664},{x:.6125,y:.85,w:.05,h:.06666666666666667},{x:.6125,y:.85,w:.075,h:.1},{x:.6375,y:.85,w:.03125,h:.041666666666666664},{x:.6375,y:.85,w:.05,h:.06666666666666667},{x:.6375,y:.85,w:.075,h:.1},{x:.6625,y:.85,w:.03125,h:.041666666666666664},{x:.6625,y:.85,w:.05,h:.06666666666666667},{x:.6625,y:.85,w:.075,h:.1},{x:.6875,y:.85,w:.03125,h:.041666666666666664},{x:.6875,y:.85,w:.05,h:.06666666666666667},{x:.6875,y:.85,w:.075,h:.1},{x:.7125,y:.85,w:.03125,h:.041666666666666664},{x:.7125,y:.85,w:.05,h:.06666666666666667},{x:.7125,y:.85,w:.075,h:.1},{x:.7375,y:.85,w:.03125,h:.041666666666666664},{x:.7375,y:.85,w:.05,h:.06666666666666667},{x:.7375,y:.85,w:.075,h:.1},{x:.7625,y:.85,w:.03125,h:.041666666666666664},{x:.7625,y:.85,w:.05,h:.06666666666666667},{x:.7625,y:.85,w:.075,h:.1},{x:.7875,y:.85,w:.03125,h:.041666666666666664},{x:.7875,y:.85,w:.05,h:.06666666666666667},{x:.7875,y:.85,w:.075,h:.1},{x:.8125,y:.85,w:.03125,h:.041666666666666664},{x:.8125,y:.85,w:.05,h:.06666666666666667},{x:.8125,y:.85,w:.075,h:.1},{x:.8375,y:.85,w:.03125,h:.041666666666666664},{x:.8375,y:.85,w:.05,h:.06666666666666667},{x:.8375,y:.85,w:.075,h:.1},{x:.8625,y:.85,w:.03125,h:.041666666666666664},{x:.8625,y:.85,w:.05,h:.06666666666666667},{x:.8625,y:.85,w:.075,h:.1},{x:.8875,y:.85,w:.03125,h:.041666666666666664},{x:.8875,y:.85,w:.05,h:.06666666666666667},{x:.8875,y:.85,w:.075,h:.1},{x:.9125,y:.85,w:.03125,h:.041666666666666664},{x:.9125,y:.85,w:.05,h:.06666666666666667},{x:.9125,y:.85,w:.075,h:.1},{x:.9375,y:.85,w:.03125,h:.041666666666666664},{x:.9375,y:.85,w:.05,h:.06666666666666667},{x:.9375,y:.85,w:.075,h:.1},{x:.9625,y:.85,w:.03125,h:.041666666666666664},{x:.9625,y:.85,w:.05,h:.06666666666666667},{x:.9625,y:.85,w:.075,h:.1},{x:.9875,y:.85,w:.03125,h:.041666666666666664},{x:.9875,y:.85,w:.05,h:.06666666666666667},{x:.9875,y:.85,w:.075,h:.1},{x:.0125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.8833333333333333,w:.075,h:.1},{x:.0375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.8833333333333333,w:.075,h:.1},{x:.0625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.8833333333333333,w:.075,h:.1},{x:.0875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.8833333333333333,w:.075,h:.1},{x:.1125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.8833333333333333,w:.075,h:.1},{x:.1375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.8833333333333333,w:.075,h:.1},{x:.1625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.8833333333333333,w:.075,h:.1},{x:.1875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.8833333333333333,w:.075,h:.1},{x:.2125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.8833333333333333,w:.075,h:.1},{x:.2375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.8833333333333333,w:.075,h:.1},{x:.2625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.8833333333333333,w:.075,h:.1},{x:.2875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.8833333333333333,w:.075,h:.1},{x:.3125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.8833333333333333,w:.075,h:.1},{x:.3375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.8833333333333333,w:.075,h:.1},{x:.3625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.8833333333333333,w:.075,h:.1},{x:.3875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.8833333333333333,w:.075,h:.1},{x:.4125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.8833333333333333,w:.075,h:.1},{x:.4375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.8833333333333333,w:.075,h:.1},{x:.4625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.8833333333333333,w:.075,h:.1},{x:.4875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.8833333333333333,w:.075,h:.1},{x:.5125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.8833333333333333,w:.075,h:.1},{x:.5375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.8833333333333333,w:.075,h:.1},{x:.5625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.8833333333333333,w:.075,h:.1},{x:.5875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.8833333333333333,w:.075,h:.1},{x:.6125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.8833333333333333,w:.075,h:.1},{x:.6375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.8833333333333333,w:.075,h:.1},{x:.6625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.8833333333333333,w:.075,h:.1},{x:.6875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.8833333333333333,w:.075,h:.1},{x:.7125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.8833333333333333,w:.075,h:.1},{x:.7375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.8833333333333333,w:.075,h:.1},{x:.7625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.8833333333333333,w:.075,h:.1},{x:.7875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.8833333333333333,w:.075,h:.1},{x:.8125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.8833333333333333,w:.075,h:.1},{x:.8375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.8833333333333333,w:.075,h:.1},{x:.8625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.8833333333333333,w:.075,h:.1},{x:.8875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.8833333333333333,w:.075,h:.1},{x:.9125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.8833333333333333,w:.075,h:.1},{x:.9375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.8833333333333333,w:.075,h:.1},{x:.9625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.8833333333333333,w:.075,h:.1},{x:.9875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.8833333333333333,w:.075,h:.1},{x:.0125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.9166666666666666,w:.075,h:.1},{x:.0375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.9166666666666666,w:.075,h:.1},{x:.0625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.9166666666666666,w:.075,h:.1},{x:.0875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.9166666666666666,w:.075,h:.1},{x:.1125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.9166666666666666,w:.075,h:.1},{x:.1375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.9166666666666666,w:.075,h:.1},{x:.1625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.9166666666666666,w:.075,h:.1},{x:.1875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.9166666666666666,w:.075,h:.1},{x:.2125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.9166666666666666,w:.075,h:.1},{x:.2375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.9166666666666666,w:.075,h:.1},{x:.2625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.9166666666666666,w:.075,h:.1},{x:.2875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.9166666666666666,w:.075,h:.1},{x:.3125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.9166666666666666,w:.075,h:.1},{x:.3375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.9166666666666666,w:.075,h:.1},{x:.3625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.9166666666666666,w:.075,h:.1},{x:.3875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.9166666666666666,w:.075,h:.1},{x:.4125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.9166666666666666,w:.075,h:.1},{x:.4375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.9166666666666666,w:.075,h:.1},{x:.4625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.9166666666666666,w:.075,h:.1},{x:.4875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.9166666666666666,w:.075,h:.1},{x:.5125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.9166666666666666,w:.075,h:.1},{x:.5375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.9166666666666666,w:.075,h:.1},{x:.5625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.9166666666666666,w:.075,h:.1},{x:.5875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.9166666666666666,w:.075,h:.1},{x:.6125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.9166666666666666,w:.075,h:.1},{x:.6375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.9166666666666666,w:.075,h:.1},{x:.6625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.9166666666666666,w:.075,h:.1},{x:.6875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.9166666666666666,w:.075,h:.1},{x:.7125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.9166666666666666,w:.075,h:.1},{x:.7375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.9166666666666666,w:.075,h:.1},{x:.7625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.9166666666666666,w:.075,h:.1},{x:.7875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.9166666666666666,w:.075,h:.1},{x:.8125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.9166666666666666,w:.075,h:.1},{x:.8375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.9166666666666666,w:.075,h:.1},{x:.8625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.9166666666666666,w:.075,h:.1},{x:.8875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.9166666666666666,w:.075,h:.1},{x:.9125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.9166666666666666,w:.075,h:.1},{x:.9375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.9166666666666666,w:.075,h:.1},{x:.9625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.9166666666666666,w:.075,h:.1},{x:.9875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.9166666666666666,w:.075,h:.1},{x:.0125,y:.95,w:.03125,h:.041666666666666664},{x:.0125,y:.95,w:.05,h:.06666666666666667},{x:.0125,y:.95,w:.075,h:.1},{x:.0375,y:.95,w:.03125,h:.041666666666666664},{x:.0375,y:.95,w:.05,h:.06666666666666667},{x:.0375,y:.95,w:.075,h:.1},{x:.0625,y:.95,w:.03125,h:.041666666666666664},{x:.0625,y:.95,w:.05,h:.06666666666666667},{x:.0625,y:.95,w:.075,h:.1},{x:.0875,y:.95,w:.03125,h:.041666666666666664},{x:.0875,y:.95,w:.05,h:.06666666666666667},{x:.0875,y:.95,w:.075,h:.1},{x:.1125,y:.95,w:.03125,h:.041666666666666664},{x:.1125,y:.95,w:.05,h:.06666666666666667},{x:.1125,y:.95,w:.075,h:.1},{x:.1375,y:.95,w:.03125,h:.041666666666666664},{x:.1375,y:.95,w:.05,h:.06666666666666667},{x:.1375,y:.95,w:.075,h:.1},{x:.1625,y:.95,w:.03125,h:.041666666666666664},{x:.1625,y:.95,w:.05,h:.06666666666666667},{x:.1625,y:.95,w:.075,h:.1},{x:.1875,y:.95,w:.03125,h:.041666666666666664},{x:.1875,y:.95,w:.05,h:.06666666666666667},{x:.1875,y:.95,w:.075,h:.1},{x:.2125,y:.95,w:.03125,h:.041666666666666664},{x:.2125,y:.95,w:.05,h:.06666666666666667},{x:.2125,y:.95,w:.075,h:.1},{x:.2375,y:.95,w:.03125,h:.041666666666666664},{x:.2375,y:.95,w:.05,h:.06666666666666667},{x:.2375,y:.95,w:.075,h:.1},{x:.2625,y:.95,w:.03125,h:.041666666666666664},{x:.2625,y:.95,w:.05,h:.06666666666666667},{x:.2625,y:.95,w:.075,h:.1},{x:.2875,y:.95,w:.03125,h:.041666666666666664},{x:.2875,y:.95,w:.05,h:.06666666666666667},{x:.2875,y:.95,w:.075,h:.1},{x:.3125,y:.95,w:.03125,h:.041666666666666664},{x:.3125,y:.95,w:.05,h:.06666666666666667},{x:.3125,y:.95,w:.075,h:.1},{x:.3375,y:.95,w:.03125,h:.041666666666666664},{x:.3375,y:.95,w:.05,h:.06666666666666667},{x:.3375,y:.95,w:.075,h:.1},{x:.3625,y:.95,w:.03125,h:.041666666666666664},{x:.3625,y:.95,w:.05,h:.06666666666666667},{x:.3625,y:.95,w:.075,h:.1},{x:.3875,y:.95,w:.03125,h:.041666666666666664},{x:.3875,y:.95,w:.05,h:.06666666666666667},{x:.3875,y:.95,w:.075,h:.1},{x:.4125,y:.95,w:.03125,h:.041666666666666664},{x:.4125,y:.95,w:.05,h:.06666666666666667},{x:.4125,y:.95,w:.075,h:.1},{x:.4375,y:.95,w:.03125,h:.041666666666666664},{x:.4375,y:.95,w:.05,h:.06666666666666667},{x:.4375,y:.95,w:.075,h:.1},{x:.4625,y:.95,w:.03125,h:.041666666666666664},{x:.4625,y:.95,w:.05,h:.06666666666666667},{x:.4625,y:.95,w:.075,h:.1},{x:.4875,y:.95,w:.03125,h:.041666666666666664},{x:.4875,y:.95,w:.05,h:.06666666666666667},{x:.4875,y:.95,w:.075,h:.1},{x:.5125,y:.95,w:.03125,h:.041666666666666664},{x:.5125,y:.95,w:.05,h:.06666666666666667},{x:.5125,y:.95,w:.075,h:.1},{x:.5375,y:.95,w:.03125,h:.041666666666666664},{x:.5375,y:.95,w:.05,h:.06666666666666667},{x:.5375,y:.95,w:.075,h:.1},{x:.5625,y:.95,w:.03125,h:.041666666666666664},{x:.5625,y:.95,w:.05,h:.06666666666666667},{x:.5625,y:.95,w:.075,h:.1},{x:.5875,y:.95,w:.03125,h:.041666666666666664},{x:.5875,y:.95,w:.05,h:.06666666666666667},{x:.5875,y:.95,w:.075,h:.1},{x:.6125,y:.95,w:.03125,h:.041666666666666664},{x:.6125,y:.95,w:.05,h:.06666666666666667},{x:.6125,y:.95,w:.075,h:.1},{x:.6375,y:.95,w:.03125,h:.041666666666666664},{x:.6375,y:.95,w:.05,h:.06666666666666667},{x:.6375,y:.95,w:.075,h:.1},{x:.6625,y:.95,w:.03125,h:.041666666666666664},{x:.6625,y:.95,w:.05,h:.06666666666666667},{x:.6625,y:.95,w:.075,h:.1},{x:.6875,y:.95,w:.03125,h:.041666666666666664},{x:.6875,y:.95,w:.05,h:.06666666666666667},{x:.6875,y:.95,w:.075,h:.1},{x:.7125,y:.95,w:.03125,h:.041666666666666664},{x:.7125,y:.95,w:.05,h:.06666666666666667},{x:.7125,y:.95,w:.075,h:.1},{x:.7375,y:.95,w:.03125,h:.041666666666666664},{x:.7375,y:.95,w:.05,h:.06666666666666667},{x:.7375,y:.95,w:.075,h:.1},{x:.7625,y:.95,w:.03125,h:.041666666666666664},{x:.7625,y:.95,w:.05,h:.06666666666666667},{x:.7625,y:.95,w:.075,h:.1},{x:.7875,y:.95,w:.03125,h:.041666666666666664},{x:.7875,y:.95,w:.05,h:.06666666666666667},{x:.7875,y:.95,w:.075,h:.1},{x:.8125,y:.95,w:.03125,h:.041666666666666664},{x:.8125,y:.95,w:.05,h:.06666666666666667},{x:.8125,y:.95,w:.075,h:.1},{x:.8375,y:.95,w:.03125,h:.041666666666666664},{x:.8375,y:.95,w:.05,h:.06666666666666667},{x:.8375,y:.95,w:.075,h:.1},{x:.8625,y:.95,w:.03125,h:.041666666666666664},{x:.8625,y:.95,w:.05,h:.06666666666666667},{x:.8625,y:.95,w:.075,h:.1},{x:.8875,y:.95,w:.03125,h:.041666666666666664},{x:.8875,y:.95,w:.05,h:.06666666666666667},{x:.8875,y:.95,w:.075,h:.1},{x:.9125,y:.95,w:.03125,h:.041666666666666664},{x:.9125,y:.95,w:.05,h:.06666666666666667},{x:.9125,y:.95,w:.075,h:.1},{x:.9375,y:.95,w:.03125,h:.041666666666666664},{x:.9375,y:.95,w:.05,h:.06666666666666667},{x:.9375,y:.95,w:.075,h:.1},{x:.9625,y:.95,w:.03125,h:.041666666666666664},{x:.9625,y:.95,w:.05,h:.06666666666666667},{x:.9625,y:.95,w:.075,h:.1},{x:.9875,y:.95,w:.03125,h:.041666666666666664},{x:.9875,y:.95,w:.05,h:.06666666666666667},{x:.9875,y:.95,w:.075,h:.1},{x:.0125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.9833333333333333,w:.075,h:.1},{x:.0375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.9833333333333333,w:.075,h:.1},{x:.0625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.9833333333333333,w:.075,h:.1},{x:.0875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.9833333333333333,w:.075,h:.1},{x:.1125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.9833333333333333,w:.075,h:.1},{x:.1375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.9833333333333333,w:.075,h:.1},{x:.1625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.9833333333333333,w:.075,h:.1},{x:.1875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.9833333333333333,w:.075,h:.1},{x:.2125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.9833333333333333,w:.075,h:.1},{x:.2375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.9833333333333333,w:.075,h:.1},{x:.2625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.9833333333333333,w:.075,h:.1},{x:.2875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.9833333333333333,w:.075,h:.1},{x:.3125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.9833333333333333,w:.075,h:.1},{x:.3375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.9833333333333333,w:.075,h:.1},{x:.3625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.9833333333333333,w:.075,h:.1},{x:.3875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.9833333333333333,w:.075,h:.1},{x:.4125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.9833333333333333,w:.075,h:.1},{x:.4375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.9833333333333333,w:.075,h:.1},{x:.4625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.9833333333333333,w:.075,h:.1},{x:.4875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.9833333333333333,w:.075,h:.1},{x:.5125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.9833333333333333,w:.075,h:.1},{x:.5375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.9833333333333333,w:.075,h:.1},{x:.5625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.9833333333333333,w:.075,h:.1},{x:.5875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.9833333333333333,w:.075,h:.1},{x:.6125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.9833333333333333,w:.075,h:.1},{x:.6375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.9833333333333333,w:.075,h:.1},{x:.6625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.9833333333333333,w:.075,h:.1},{x:.6875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.9833333333333333,w:.075,h:.1},{x:.7125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.9833333333333333,w:.075,h:.1},{x:.7375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.9833333333333333,w:.075,h:.1},{x:.7625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.9833333333333333,w:.075,h:.1},{x:.7875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.9833333333333333,w:.075,h:.1},{x:.8125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.9833333333333333,w:.075,h:.1},{x:.8375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.9833333333333333,w:.075,h:.1},{x:.8625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.9833333333333333,w:.075,h:.1},{x:.8875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.9833333333333333,w:.075,h:.1},{x:.9125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.9833333333333333,w:.075,h:.1},{x:.9375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.9833333333333333,w:.075,h:.1},{x:.9625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.9833333333333333,w:.075,h:.1},{x:.9875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.9833333333333333,w:.075,h:.1},{x:.025,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.03333333333333333,w:.15,h:.2},{x:.075,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.03333333333333333,w:.15,h:.2},{x:.125,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.03333333333333333,w:.15,h:.2},{x:.175,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.03333333333333333,w:.15,h:.2},{x:.225,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.03333333333333333,w:.15,h:.2},{x:.275,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.03333333333333333,w:.15,h:.2},{x:.325,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.03333333333333333,w:.15,h:.2},{x:.375,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.03333333333333333,w:.15,h:.2},{x:.425,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.03333333333333333,w:.15,h:.2},{x:.475,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.03333333333333333,w:.15,h:.2},{x:.525,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.03333333333333333,w:.15,h:.2},{x:.575,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.03333333333333333,w:.15,h:.2},{x:.625,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.03333333333333333,w:.15,h:.2},{x:.675,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.03333333333333333,w:.15,h:.2},{x:.725,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.03333333333333333,w:.15,h:.2},{x:.775,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.03333333333333333,w:.15,h:.2},{x:.825,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.03333333333333333,w:.15,h:.2},{x:.875,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.03333333333333333,w:.15,h:.2},{x:.925,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.03333333333333333,w:.15,h:.2},{x:.975,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.03333333333333333,w:.15,h:.2},{x:.025,y:.1,w:.1,h:.13333333333333333},{x:.025,y:.1,w:.15,h:.2},{x:.075,y:.1,w:.1,h:.13333333333333333},{x:.075,y:.1,w:.15,h:.2},{x:.125,y:.1,w:.1,h:.13333333333333333},{x:.125,y:.1,w:.15,h:.2},{x:.175,y:.1,w:.1,h:.13333333333333333},{x:.175,y:.1,w:.15,h:.2},{x:.225,y:.1,w:.1,h:.13333333333333333},{x:.225,y:.1,w:.15,h:.2},{x:.275,y:.1,w:.1,h:.13333333333333333},{x:.275,y:.1,w:.15,h:.2},{x:.325,y:.1,w:.1,h:.13333333333333333},{x:.325,y:.1,w:.15,h:.2},{x:.375,y:.1,w:.1,h:.13333333333333333},{x:.375,y:.1,w:.15,h:.2},{x:.425,y:.1,w:.1,h:.13333333333333333},{x:.425,y:.1,w:.15,h:.2},{x:.475,y:.1,w:.1,h:.13333333333333333},{x:.475,y:.1,w:.15,h:.2},{x:.525,y:.1,w:.1,h:.13333333333333333},{x:.525,y:.1,w:.15,h:.2},{x:.575,y:.1,w:.1,h:.13333333333333333},{x:.575,y:.1,w:.15,h:.2},{x:.625,y:.1,w:.1,h:.13333333333333333},{x:.625,y:.1,w:.15,h:.2},{x:.675,y:.1,w:.1,h:.13333333333333333},{x:.675,y:.1,w:.15,h:.2},{x:.725,y:.1,w:.1,h:.13333333333333333},{x:.725,y:.1,w:.15,h:.2},{x:.775,y:.1,w:.1,h:.13333333333333333},{x:.775,y:.1,w:.15,h:.2},{x:.825,y:.1,w:.1,h:.13333333333333333},{x:.825,y:.1,w:.15,h:.2},{x:.875,y:.1,w:.1,h:.13333333333333333},{x:.875,y:.1,w:.15,h:.2},{x:.925,y:.1,w:.1,h:.13333333333333333},{x:.925,y:.1,w:.15,h:.2},{x:.975,y:.1,w:.1,h:.13333333333333333},{x:.975,y:.1,w:.15,h:.2},{x:.025,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.025,y:.16666666666666666,w:.15,h:.2},{x:.075,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.075,y:.16666666666666666,w:.15,h:.2},{x:.125,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.125,y:.16666666666666666,w:.15,h:.2},{x:.175,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.175,y:.16666666666666666,w:.15,h:.2},{x:.225,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.225,y:.16666666666666666,w:.15,h:.2},{x:.275,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.275,y:.16666666666666666,w:.15,h:.2},{x:.325,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.325,y:.16666666666666666,w:.15,h:.2},{x:.375,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.375,y:.16666666666666666,w:.15,h:.2},{x:.425,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.425,y:.16666666666666666,w:.15,h:.2},{x:.475,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.475,y:.16666666666666666,w:.15,h:.2},{x:.525,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.525,y:.16666666666666666,w:.15,h:.2},{x:.575,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.575,y:.16666666666666666,w:.15,h:.2},{x:.625,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.625,y:.16666666666666666,w:.15,h:.2},{x:.675,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.675,y:.16666666666666666,w:.15,h:.2},{x:.725,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.725,y:.16666666666666666,w:.15,h:.2},{x:.775,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.775,y:.16666666666666666,w:.15,h:.2},{x:.825,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.825,y:.16666666666666666,w:.15,h:.2},{x:.875,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.875,y:.16666666666666666,w:.15,h:.2},{x:.925,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.925,y:.16666666666666666,w:.15,h:.2},{x:.975,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.975,y:.16666666666666666,w:.15,h:.2},{x:.025,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.23333333333333334,w:.15,h:.2},{x:.075,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.23333333333333334,w:.15,h:.2},{x:.125,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.23333333333333334,w:.15,h:.2},{x:.175,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.23333333333333334,w:.15,h:.2},{x:.225,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.23333333333333334,w:.15,h:.2},{x:.275,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.23333333333333334,w:.15,h:.2},{x:.325,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.23333333333333334,w:.15,h:.2},{x:.375,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.23333333333333334,w:.15,h:.2},{x:.425,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.23333333333333334,w:.15,h:.2},{x:.475,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.23333333333333334,w:.15,h:.2},{x:.525,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.23333333333333334,w:.15,h:.2},{x:.575,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.23333333333333334,w:.15,h:.2},{x:.625,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.23333333333333334,w:.15,h:.2},{x:.675,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.23333333333333334,w:.15,h:.2},{x:.725,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.23333333333333334,w:.15,h:.2},{x:.775,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.23333333333333334,w:.15,h:.2},{x:.825,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.23333333333333334,w:.15,h:.2},{x:.875,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.23333333333333334,w:.15,h:.2},{x:.925,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.23333333333333334,w:.15,h:.2},{x:.975,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.23333333333333334,w:.15,h:.2},{x:.025,y:.3,w:.1,h:.13333333333333333},{x:.025,y:.3,w:.15,h:.2},{x:.075,y:.3,w:.1,h:.13333333333333333},{x:.075,y:.3,w:.15,h:.2},{x:.125,y:.3,w:.1,h:.13333333333333333},{x:.125,y:.3,w:.15,h:.2},{x:.175,y:.3,w:.1,h:.13333333333333333},{x:.175,y:.3,w:.15,h:.2},{x:.225,y:.3,w:.1,h:.13333333333333333},{x:.225,y:.3,w:.15,h:.2},{x:.275,y:.3,w:.1,h:.13333333333333333},{x:.275,y:.3,w:.15,h:.2},{x:.325,y:.3,w:.1,h:.13333333333333333},{x:.325,y:.3,w:.15,h:.2},{x:.375,y:.3,w:.1,h:.13333333333333333},{x:.375,y:.3,w:.15,h:.2},{x:.425,y:.3,w:.1,h:.13333333333333333},{x:.425,y:.3,w:.15,h:.2},{x:.475,y:.3,w:.1,h:.13333333333333333},{x:.475,y:.3,w:.15,h:.2},{x:.525,y:.3,w:.1,h:.13333333333333333},{x:.525,y:.3,w:.15,h:.2},{x:.575,y:.3,w:.1,h:.13333333333333333},{x:.575,y:.3,w:.15,h:.2},{x:.625,y:.3,w:.1,h:.13333333333333333},{x:.625,y:.3,w:.15,h:.2},{x:.675,y:.3,w:.1,h:.13333333333333333},{x:.675,y:.3,w:.15,h:.2},{x:.725,y:.3,w:.1,h:.13333333333333333},{x:.725,y:.3,w:.15,h:.2},{x:.775,y:.3,w:.1,h:.13333333333333333},{x:.775,y:.3,w:.15,h:.2},{x:.825,y:.3,w:.1,h:.13333333333333333},{x:.825,y:.3,w:.15,h:.2},{x:.875,y:.3,w:.1,h:.13333333333333333},{x:.875,y:.3,w:.15,h:.2},{x:.925,y:.3,w:.1,h:.13333333333333333},{x:.925,y:.3,w:.15,h:.2},{x:.975,y:.3,w:.1,h:.13333333333333333},{x:.975,y:.3,w:.15,h:.2},{x:.025,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.025,y:.36666666666666664,w:.15,h:.2},{x:.075,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.075,y:.36666666666666664,w:.15,h:.2},{x:.125,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.125,y:.36666666666666664,w:.15,h:.2},{x:.175,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.175,y:.36666666666666664,w:.15,h:.2},{x:.225,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.225,y:.36666666666666664,w:.15,h:.2},{x:.275,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.275,y:.36666666666666664,w:.15,h:.2},{x:.325,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.325,y:.36666666666666664,w:.15,h:.2},{x:.375,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.375,y:.36666666666666664,w:.15,h:.2},{x:.425,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.425,y:.36666666666666664,w:.15,h:.2},{x:.475,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.475,y:.36666666666666664,w:.15,h:.2},{x:.525,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.525,y:.36666666666666664,w:.15,h:.2},{x:.575,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.575,y:.36666666666666664,w:.15,h:.2},{x:.625,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.625,y:.36666666666666664,w:.15,h:.2},{x:.675,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.675,y:.36666666666666664,w:.15,h:.2},{x:.725,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.725,y:.36666666666666664,w:.15,h:.2},{x:.775,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.775,y:.36666666666666664,w:.15,h:.2},{x:.825,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.825,y:.36666666666666664,w:.15,h:.2},{x:.875,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.875,y:.36666666666666664,w:.15,h:.2},{x:.925,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.925,y:.36666666666666664,w:.15,h:.2},{x:.975,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.975,y:.36666666666666664,w:.15,h:.2},{x:.025,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.025,y:.43333333333333335,w:.15,h:.2},{x:.075,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.075,y:.43333333333333335,w:.15,h:.2},{x:.125,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.125,y:.43333333333333335,w:.15,h:.2},{x:.175,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.175,y:.43333333333333335,w:.15,h:.2},{x:.225,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.225,y:.43333333333333335,w:.15,h:.2},{x:.275,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.275,y:.43333333333333335,w:.15,h:.2},{x:.325,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.325,y:.43333333333333335,w:.15,h:.2},{x:.375,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.375,y:.43333333333333335,w:.15,h:.2},{x:.425,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.425,y:.43333333333333335,w:.15,h:.2},{x:.475,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.475,y:.43333333333333335,w:.15,h:.2},{x:.525,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.525,y:.43333333333333335,w:.15,h:.2},{x:.575,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.575,y:.43333333333333335,w:.15,h:.2},{x:.625,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.625,y:.43333333333333335,w:.15,h:.2},{x:.675,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.675,y:.43333333333333335,w:.15,h:.2},{x:.725,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.725,y:.43333333333333335,w:.15,h:.2},{x:.775,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.775,y:.43333333333333335,w:.15,h:.2},{x:.825,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.825,y:.43333333333333335,w:.15,h:.2},{x:.875,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.875,y:.43333333333333335,w:.15,h:.2},{x:.925,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.925,y:.43333333333333335,w:.15,h:.2},{x:.975,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.975,y:.43333333333333335,w:.15,h:.2},{x:.025,y:.5,w:.1,h:.13333333333333333},{x:.025,y:.5,w:.15,h:.2},{x:.075,y:.5,w:.1,h:.13333333333333333},{x:.075,y:.5,w:.15,h:.2},{x:.125,y:.5,w:.1,h:.13333333333333333},{x:.125,y:.5,w:.15,h:.2},{x:.175,y:.5,w:.1,h:.13333333333333333},{x:.175,y:.5,w:.15,h:.2},{x:.225,y:.5,w:.1,h:.13333333333333333},{x:.225,y:.5,w:.15,h:.2},{x:.275,y:.5,w:.1,h:.13333333333333333},{x:.275,y:.5,w:.15,h:.2},{x:.325,y:.5,w:.1,h:.13333333333333333},{x:.325,y:.5,w:.15,h:.2},{x:.375,y:.5,w:.1,h:.13333333333333333},{x:.375,y:.5,w:.15,h:.2},{x:.425,y:.5,w:.1,h:.13333333333333333},{x:.425,y:.5,w:.15,h:.2},{x:.475,y:.5,w:.1,h:.13333333333333333},{x:.475,y:.5,w:.15,h:.2},{x:.525,y:.5,w:.1,h:.13333333333333333},{x:.525,y:.5,w:.15,h:.2},{x:.575,y:.5,w:.1,h:.13333333333333333},{x:.575,y:.5,w:.15,h:.2},{x:.625,y:.5,w:.1,h:.13333333333333333},{x:.625,y:.5,w:.15,h:.2},{x:.675,y:.5,w:.1,h:.13333333333333333},{x:.675,y:.5,w:.15,h:.2},{x:.725,y:.5,w:.1,h:.13333333333333333},{x:.725,y:.5,w:.15,h:.2},{x:.775,y:.5,w:.1,h:.13333333333333333},{x:.775,y:.5,w:.15,h:.2},{x:.825,y:.5,w:.1,h:.13333333333333333},{x:.825,y:.5,w:.15,h:.2},{x:.875,y:.5,w:.1,h:.13333333333333333},{x:.875,y:.5,w:.15,h:.2},{x:.925,y:.5,w:.1,h:.13333333333333333},{x:.925,y:.5,w:.15,h:.2},{x:.975,y:.5,w:.1,h:.13333333333333333},{x:.975,y:.5,w:.15,h:.2},{x:.025,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.5666666666666667,w:.15,h:.2},{x:.075,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.5666666666666667,w:.15,h:.2},{x:.125,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.5666666666666667,w:.15,h:.2},{x:.175,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.5666666666666667,w:.15,h:.2},{x:.225,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.5666666666666667,w:.15,h:.2},{x:.275,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.5666666666666667,w:.15,h:.2},{x:.325,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.5666666666666667,w:.15,h:.2},{x:.375,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.5666666666666667,w:.15,h:.2},{x:.425,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.5666666666666667,w:.15,h:.2},{x:.475,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.5666666666666667,w:.15,h:.2},{x:.525,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.5666666666666667,w:.15,h:.2},{x:.575,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.5666666666666667,w:.15,h:.2},{x:.625,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.5666666666666667,w:.15,h:.2},{x:.675,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.5666666666666667,w:.15,h:.2},{x:.725,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.5666666666666667,w:.15,h:.2},{x:.775,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.5666666666666667,w:.15,h:.2},{x:.825,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.5666666666666667,w:.15,h:.2},{x:.875,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.5666666666666667,w:.15,h:.2},{x:.925,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.5666666666666667,w:.15,h:.2},{x:.975,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.5666666666666667,w:.15,h:.2},{x:.025,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.6333333333333333,w:.15,h:.2},{x:.075,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.6333333333333333,w:.15,h:.2},{x:.125,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.6333333333333333,w:.15,h:.2},{x:.175,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.6333333333333333,w:.15,h:.2},{x:.225,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.6333333333333333,w:.15,h:.2},{x:.275,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.6333333333333333,w:.15,h:.2},{x:.325,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.6333333333333333,w:.15,h:.2},{x:.375,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.6333333333333333,w:.15,h:.2},{x:.425,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.6333333333333333,w:.15,h:.2},{x:.475,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.6333333333333333,w:.15,h:.2},{x:.525,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.6333333333333333,w:.15,h:.2},{x:.575,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.6333333333333333,w:.15,h:.2},{x:.625,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.6333333333333333,w:.15,h:.2},{x:.675,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.6333333333333333,w:.15,h:.2},{x:.725,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.6333333333333333,w:.15,h:.2},{x:.775,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.6333333333333333,w:.15,h:.2},{x:.825,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.6333333333333333,w:.15,h:.2},{x:.875,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.6333333333333333,w:.15,h:.2},{x:.925,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.6333333333333333,w:.15,h:.2},{x:.975,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.6333333333333333,w:.15,h:.2},{x:.025,y:.7,w:.1,h:.13333333333333333},{x:.025,y:.7,w:.15,h:.2},{x:.075,y:.7,w:.1,h:.13333333333333333},{x:.075,y:.7,w:.15,h:.2},{x:.125,y:.7,w:.1,h:.13333333333333333},{x:.125,y:.7,w:.15,h:.2},{x:.175,y:.7,w:.1,h:.13333333333333333},{x:.175,y:.7,w:.15,h:.2},{x:.225,y:.7,w:.1,h:.13333333333333333},{x:.225,y:.7,w:.15,h:.2},{x:.275,y:.7,w:.1,h:.13333333333333333},{x:.275,y:.7,w:.15,h:.2},{x:.325,y:.7,w:.1,h:.13333333333333333},{x:.325,y:.7,w:.15,h:.2},{x:.375,y:.7,w:.1,h:.13333333333333333},{x:.375,y:.7,w:.15,h:.2},{x:.425,y:.7,w:.1,h:.13333333333333333},{x:.425,y:.7,w:.15,h:.2},{x:.475,y:.7,w:.1,h:.13333333333333333},{x:.475,y:.7,w:.15,h:.2},{x:.525,y:.7,w:.1,h:.13333333333333333},{x:.525,y:.7,w:.15,h:.2},{x:.575,y:.7,w:.1,h:.13333333333333333},{x:.575,y:.7,w:.15,h:.2},{x:.625,y:.7,w:.1,h:.13333333333333333},{x:.625,y:.7,w:.15,h:.2},{x:.675,y:.7,w:.1,h:.13333333333333333},{x:.675,y:.7,w:.15,h:.2},{x:.725,y:.7,w:.1,h:.13333333333333333},{x:.725,y:.7,w:.15,h:.2},{x:.775,y:.7,w:.1,h:.13333333333333333},{x:.775,y:.7,w:.15,h:.2},{x:.825,y:.7,w:.1,h:.13333333333333333},{x:.825,y:.7,w:.15,h:.2},{x:.875,y:.7,w:.1,h:.13333333333333333},{x:.875,y:.7,w:.15,h:.2},{x:.925,y:.7,w:.1,h:.13333333333333333},{x:.925,y:.7,w:.15,h:.2},{x:.975,y:.7,w:.1,h:.13333333333333333},{x:.975,y:.7,w:.15,h:.2},{x:.025,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.7666666666666667,w:.15,h:.2},{x:.075,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.7666666666666667,w:.15,h:.2},{x:.125,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.7666666666666667,w:.15,h:.2},{x:.175,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.7666666666666667,w:.15,h:.2},{x:.225,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.7666666666666667,w:.15,h:.2},{x:.275,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.7666666666666667,w:.15,h:.2},{x:.325,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.7666666666666667,w:.15,h:.2},{x:.375,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.7666666666666667,w:.15,h:.2},{x:.425,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.7666666666666667,w:.15,h:.2},{x:.475,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.7666666666666667,w:.15,h:.2},{x:.525,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.7666666666666667,w:.15,h:.2},{x:.575,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.7666666666666667,w:.15,h:.2},{x:.625,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.7666666666666667,w:.15,h:.2},{x:.675,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.7666666666666667,w:.15,h:.2},{x:.725,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.7666666666666667,w:.15,h:.2},{x:.775,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.7666666666666667,w:.15,h:.2},{x:.825,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.7666666666666667,w:.15,h:.2},{x:.875,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.7666666666666667,w:.15,h:.2},{x:.925,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.7666666666666667,w:.15,h:.2},{x:.975,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.7666666666666667,w:.15,h:.2},{x:.025,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.8333333333333334,w:.15,h:.2},{x:.075,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.8333333333333334,w:.15,h:.2},{x:.125,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.8333333333333334,w:.15,h:.2},{x:.175,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.8333333333333334,w:.15,h:.2},{x:.225,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.8333333333333334,w:.15,h:.2},{x:.275,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.8333333333333334,w:.15,h:.2},{x:.325,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.8333333333333334,w:.15,h:.2},{x:.375,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.8333333333333334,w:.15,h:.2},{x:.425,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.8333333333333334,w:.15,h:.2},{x:.475,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.8333333333333334,w:.15,h:.2},{x:.525,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.8333333333333334,w:.15,h:.2},{x:.575,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.8333333333333334,w:.15,h:.2},{x:.625,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.8333333333333334,w:.15,h:.2},{x:.675,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.8333333333333334,w:.15,h:.2},{x:.725,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.8333333333333334,w:.15,h:.2},{x:.775,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.8333333333333334,w:.15,h:.2},{x:.825,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.8333333333333334,w:.15,h:.2},{x:.875,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.8333333333333334,w:.15,h:.2},{x:.925,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.8333333333333334,w:.15,h:.2},{x:.975,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.8333333333333334,w:.15,h:.2},{x:.025,y:.9,w:.1,h:.13333333333333333},{x:.025,y:.9,w:.15,h:.2},{x:.075,y:.9,w:.1,h:.13333333333333333},{x:.075,y:.9,w:.15,h:.2},{x:.125,y:.9,w:.1,h:.13333333333333333},{x:.125,y:.9,w:.15,h:.2},{x:.175,y:.9,w:.1,h:.13333333333333333},{x:.175,y:.9,w:.15,h:.2},{x:.225,y:.9,w:.1,h:.13333333333333333},{x:.225,y:.9,w:.15,h:.2},{x:.275,y:.9,w:.1,h:.13333333333333333},{x:.275,y:.9,w:.15,h:.2},{x:.325,y:.9,w:.1,h:.13333333333333333},{x:.325,y:.9,w:.15,h:.2},{x:.375,y:.9,w:.1,h:.13333333333333333},{x:.375,y:.9,w:.15,h:.2},{x:.425,y:.9,w:.1,h:.13333333333333333},{x:.425,y:.9,w:.15,h:.2},{x:.475,y:.9,w:.1,h:.13333333333333333},{x:.475,y:.9,w:.15,h:.2},{x:.525,y:.9,w:.1,h:.13333333333333333},{x:.525,y:.9,w:.15,h:.2},{x:.575,y:.9,w:.1,h:.13333333333333333},{x:.575,y:.9,w:.15,h:.2},{x:.625,y:.9,w:.1,h:.13333333333333333},{x:.625,y:.9,w:.15,h:.2},{x:.675,y:.9,w:.1,h:.13333333333333333},{x:.675,y:.9,w:.15,h:.2},{x:.725,y:.9,w:.1,h:.13333333333333333},{x:.725,y:.9,w:.15,h:.2},{x:.775,y:.9,w:.1,h:.13333333333333333},{x:.775,y:.9,w:.15,h:.2},{x:.825,y:.9,w:.1,h:.13333333333333333},{x:.825,y:.9,w:.15,h:.2},{x:.875,y:.9,w:.1,h:.13333333333333333},{x:.875,y:.9,w:.15,h:.2},{x:.925,y:.9,w:.1,h:.13333333333333333},{x:.925,y:.9,w:.15,h:.2},{x:.975,y:.9,w:.1,h:.13333333333333333},{x:.975,y:.9,w:.15,h:.2},{x:.025,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.9666666666666667,w:.15,h:.2},{x:.075,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.9666666666666667,w:.15,h:.2},{x:.125,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.9666666666666667,w:.15,h:.2},{x:.175,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.9666666666666667,w:.15,h:.2},{x:.225,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.9666666666666667,w:.15,h:.2},{x:.275,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.9666666666666667,w:.15,h:.2},{x:.325,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.9666666666666667,w:.15,h:.2},{x:.375,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.9666666666666667,w:.15,h:.2},{x:.425,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.9666666666666667,w:.15,h:.2},{x:.475,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.9666666666666667,w:.15,h:.2},{x:.525,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.9666666666666667,w:.15,h:.2},{x:.575,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.9666666666666667,w:.15,h:.2},{x:.625,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.9666666666666667,w:.15,h:.2},{x:.675,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.9666666666666667,w:.15,h:.2},{x:.725,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.9666666666666667,w:.15,h:.2},{x:.775,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.9666666666666667,w:.15,h:.2},{x:.825,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.9666666666666667,w:.15,h:.2},{x:.875,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.9666666666666667,w:.15,h:.2},{x:.925,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.9666666666666667,w:.15,h:.2},{x:.975,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.9666666666666667,w:.15,h:.2},{x:.05,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.06666666666666667,w:.3,h:.4},{x:.15,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.06666666666666667,w:.3,h:.4},{x:.25,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.06666666666666667,w:.3,h:.4},{x:.35,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.06666666666666667,w:.3,h:.4},{x:.45,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.06666666666666667,w:.3,h:.4},{x:.55,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.06666666666666667,w:.3,h:.4},{x:.65,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.06666666666666667,w:.3,h:.4},{x:.75,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.06666666666666667,w:.3,h:.4},{x:.85,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.06666666666666667,w:.3,h:.4},{x:.95,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.06666666666666667,w:.3,h:.4},{x:.05,y:.2,w:.2,h:.26666666666666666},{x:.05,y:.2,w:.3,h:.4},{x:.15,y:.2,w:.2,h:.26666666666666666},{x:.15,y:.2,w:.3,h:.4},{x:.25,y:.2,w:.2,h:.26666666666666666},{x:.25,y:.2,w:.3,h:.4},{x:.35,y:.2,w:.2,h:.26666666666666666},{x:.35,y:.2,w:.3,h:.4},{x:.45,y:.2,w:.2,h:.26666666666666666},{x:.45,y:.2,w:.3,h:.4},{x:.55,y:.2,w:.2,h:.26666666666666666},{x:.55,y:.2,w:.3,h:.4},{x:.65,y:.2,w:.2,h:.26666666666666666},{x:.65,y:.2,w:.3,h:.4},{x:.75,y:.2,w:.2,h:.26666666666666666},{x:.75,y:.2,w:.3,h:.4},{x:.85,y:.2,w:.2,h:.26666666666666666},{x:.85,y:.2,w:.3,h:.4},{x:.95,y:.2,w:.2,h:.26666666666666666},{x:.95,y:.2,w:.3,h:.4},{x:.05,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.3333333333333333,w:.3,h:.4},{x:.15,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.3333333333333333,w:.3,h:.4},{x:.25,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.3333333333333333,w:.3,h:.4},{x:.35,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.3333333333333333,w:.3,h:.4},{x:.45,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.3333333333333333,w:.3,h:.4},{x:.55,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.3333333333333333,w:.3,h:.4},{x:.65,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.3333333333333333,w:.3,h:.4},{x:.75,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.3333333333333333,w:.3,h:.4},{x:.85,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.3333333333333333,w:.3,h:.4},{x:.95,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.3333333333333333,w:.3,h:.4},{x:.05,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.4666666666666667,w:.3,h:.4},{x:.15,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.4666666666666667,w:.3,h:.4},{x:.25,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.4666666666666667,w:.3,h:.4},{x:.35,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.4666666666666667,w:.3,h:.4},{x:.45,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.4666666666666667,w:.3,h:.4},{x:.55,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.4666666666666667,w:.3,h:.4},{x:.65,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.4666666666666667,w:.3,h:.4},{x:.75,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.4666666666666667,w:.3,h:.4},{x:.85,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.4666666666666667,w:.3,h:.4},{x:.95,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.4666666666666667,w:.3,h:.4},{x:.05,y:.6,w:.2,h:.26666666666666666},{x:.05,y:.6,w:.3,h:.4},{x:.15,y:.6,w:.2,h:.26666666666666666},{x:.15,y:.6,w:.3,h:.4},{x:.25,y:.6,w:.2,h:.26666666666666666},{x:.25,y:.6,w:.3,h:.4},{x:.35,y:.6,w:.2,h:.26666666666666666},{x:.35,y:.6,w:.3,h:.4},{x:.45,y:.6,w:.2,h:.26666666666666666},{x:.45,y:.6,w:.3,h:.4},{x:.55,y:.6,w:.2,h:.26666666666666666},{x:.55,y:.6,w:.3,h:.4},{x:.65,y:.6,w:.2,h:.26666666666666666},{x:.65,y:.6,w:.3,h:.4},{x:.75,y:.6,w:.2,h:.26666666666666666},{x:.75,y:.6,w:.3,h:.4},{x:.85,y:.6,w:.2,h:.26666666666666666},{x:.85,y:.6,w:.3,h:.4},{x:.95,y:.6,w:.2,h:.26666666666666666},{x:.95,y:.6,w:.3,h:.4},{x:.05,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.7333333333333333,w:.3,h:.4},{x:.15,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.7333333333333333,w:.3,h:.4},{x:.25,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.7333333333333333,w:.3,h:.4},{x:.35,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.7333333333333333,w:.3,h:.4},{x:.45,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.7333333333333333,w:.3,h:.4},{x:.55,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.7333333333333333,w:.3,h:.4},{x:.65,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.7333333333333333,w:.3,h:.4},{x:.75,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.7333333333333333,w:.3,h:.4},{x:.85,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.7333333333333333,w:.3,h:.4},{x:.95,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.7333333333333333,w:.3,h:.4},{x:.05,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.8666666666666667,w:.3,h:.4},{x:.15,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.8666666666666667,w:.3,h:.4},{x:.25,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.8666666666666667,w:.3,h:.4},{x:.35,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.8666666666666667,w:.3,h:.4},{x:.45,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.8666666666666667,w:.3,h:.4},{x:.55,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.8666666666666667,w:.3,h:.4},{x:.65,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.8666666666666667,w:.3,h:.4},{x:.75,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.8666666666666667,w:.3,h:.4},{x:.85,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.8666666666666667,w:.3,h:.4},{x:.95,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.8666666666666667,w:.3,h:.4},{x:.05,y:1,w:.2,h:.26666666666666666},{x:.05,y:1,w:.3,h:.4},{x:.15,y:1,w:.2,h:.26666666666666666},{x:.15,y:1,w:.3,h:.4},{x:.25,y:1,w:.2,h:.26666666666666666},{x:.25,y:1,w:.3,h:.4},{x:.35,y:1,w:.2,h:.26666666666666666},{x:.35,y:1,w:.3,h:.4},{x:.45,y:1,w:.2,h:.26666666666666666},{x:.45,y:1,w:.3,h:.4},{x:.55,y:1,w:.2,h:.26666666666666666},{x:.55,y:1,w:.3,h:.4},{x:.65,y:1,w:.2,h:.26666666666666666},{x:.65,y:1,w:.3,h:.4},{x:.75,y:1,w:.2,h:.26666666666666666},{x:.75,y:1,w:.3,h:.4},{x:.85,y:1,w:.2,h:.26666666666666666},{x:.85,y:1,w:.3,h:.4},{x:.95,y:1,w:.2,h:.26666666666666666},{x:.95,y:1,w:.3,h:.4},{x:.1,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.13333333333333333,w:.6,h:.8},{x:.1,y:.13333333333333333,w:.8,h:1},{x:.3,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.13333333333333333,w:.6,h:.8},{x:.3,y:.13333333333333333,w:.8,h:1},{x:.5,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.13333333333333333,w:.6,h:.8},{x:.5,y:.13333333333333333,w:.8,h:1},{x:.7,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.13333333333333333,w:.6,h:.8},{x:.7,y:.13333333333333333,w:.8,h:1},{x:.9,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.13333333333333333,w:.6,h:.8},{x:.9,y:.13333333333333333,w:.8,h:1},{x:.1,y:.4,w:.4,h:.5333333333333333},{x:.1,y:.4,w:.6,h:.8},{x:.1,y:.4,w:.8,h:1},{x:.3,y:.4,w:.4,h:.5333333333333333},{x:.3,y:.4,w:.6,h:.8},{x:.3,y:.4,w:.8,h:1},{x:.5,y:.4,w:.4,h:.5333333333333333},{x:.5,y:.4,w:.6,h:.8},{x:.5,y:.4,w:.8,h:1},{x:.7,y:.4,w:.4,h:.5333333333333333},{x:.7,y:.4,w:.6,h:.8},{x:.7,y:.4,w:.8,h:1},{x:.9,y:.4,w:.4,h:.5333333333333333},{x:.9,y:.4,w:.6,h:.8},{x:.9,y:.4,w:.8,h:1},{x:.1,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.1,y:.6666666666666666,w:.6,h:.8},{x:.1,y:.6666666666666666,w:.8,h:1},{x:.3,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.3,y:.6666666666666666,w:.6,h:.8},{x:.3,y:.6666666666666666,w:.8,h:1},{x:.5,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.5,y:.6666666666666666,w:.6,h:.8},{x:.5,y:.6666666666666666,w:.8,h:1},{x:.7,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.7,y:.6666666666666666,w:.6,h:.8},{x:.7,y:.6666666666666666,w:.8,h:1},{x:.9,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.9,y:.6666666666666666,w:.6,h:.8},{x:.9,y:.6666666666666666,w:.8,h:1},{x:.1,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.9333333333333333,w:.6,h:.8},{x:.1,y:.9333333333333333,w:.8,h:1},{x:.3,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.9333333333333333,w:.6,h:.8},{x:.3,y:.9333333333333333,w:.8,h:1},{x:.5,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.9333333333333333,w:.6,h:.8},{x:.5,y:.9333333333333333,w:.8,h:1},{x:.7,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.9333333333333333,w:.6,h:.8},{x:.7,y:.9333333333333333,w:.8,h:1},{x:.9,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.9333333333333333,w:.6,h:.8},{x:.9,y:.9333333333333333,w:.8,h:1}];function VC(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return WC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?WC(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function WC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $C(e,t,n){var r=$I()(new Float32Array(e),[1,n,t,4]);r=r.transpose(0,3,1,2);var i=$I()(new Float32Array(n*t*3),[1,3,n,t]);return KI().assign(i.pick(0,0,null,null),r.pick(0,0,null,null)),KI().assign(i.pick(0,1,null,null),r.pick(0,1,null,null)),KI().assign(i.pick(0,2,null,null),r.pick(0,2,null,null)),KI().mulseq(i,1/127.5),KI().subseq(i,1),i}function YC(e){for(var t=e.tensor,n=e.faceDetectorAccuracy,r=void 0===n?.85:n,i=e.outputHeight,o=void 0===i?240:i,a=e.outputWidth,s=void 0===a?320:a,u=[],c=$I()(t.boxes.data,[1,4420,4]),l=$I()(t.scores.data,[1,4420,2]),h=0;h<4420;h++)if(!(l.data[2*h+1]<=r)){var f=.1*c.data[4*h+0]*HC[h].w+HC[h].x,d=.1*c.data[4*h+1]*HC[h].h+HC[h].y,p=Math.exp(.2*c.data[4*h+2])*HC[h].w,y=Math.exp(.2*c.data[4*h+3])*HC[h].h,g={x1:(f-p/2)*s,y1:(d-y/2)*o,x2:(f+p/2)*s,y2:(d+y/2)*o};if(u.length){var m,v=!1,w=VC(u);try{for(w.s();!(m=w.n()).done;)if(m.value.checkSame(g)){v=!0;break}}catch(e){w.e(e)}finally{w.f()}v||u.push(new zC(g))}else u.push(new zC(g))}return u}function KC(e){return KC="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},KC(e)}function XC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ZC(r.key),r)}}function ZC(e){var t=function(e){if("object"!=KC(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=KC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==KC(t)?t:String(t)}var qC=function(){function e(t){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isFinished=!0,this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(n=t.endValue)&&void 0!==n?n:t.startValue,this.smoothPower=null!==(r=t.smoothPower)&&void 0!==r?r:1,this.smoothFunction=function(e){switch(t.smoothFunctionType){case"ease-out-sine":return Math.sin(e*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-e,5);case"ease-out-cubic":Math.pow(1-e,3);default:return e}}}var t,n;return t=e,n=[{key:"isEnded",value:function(e){var t,n=Math.max(0,Math.min(1,null!==(t=null==e?void 0:e.percentage)&&void 0!==t?t:1));return(null==e?void 0:e.isreverse)&&(n=1-n),(null==e?void 0:e.isreverse)?this.currentStep<=this.smoothPower*n:this.currentStep>=this.smoothPower*n}},{key:"getCurrentValue",value:function(){return this.currentValue}},{key:"getEndValue",value:function(){return this.endValue}},{key:"setCurrentStep",value:function(e){this.currentStep=e}},{key:"checkEndValueChange",value:function(e){e!==this.endValue&&(this.startValue=this.currentValue,this.endValue=e,this.currentStep=1)}},{key:"useAnimationPart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=Math.min(1,Math.max(0,e));var n=Math.max(1,Math.round(this.smoothPower*e));t?this.currentStep<n&&(this.currentStep=n):this.currentStep>n&&(this.currentStep=n)}},{key:"useSmooth",value:function(e){var t;if(this.startValue===this.endValue)return this.currentValue;var n=(null==e?void 0:e.isReverse)?-1:1,r=this.currentStep/this.smoothPower,i=this.smoothFunction(r);return this.currentValue=this.startValue+(this.endValue-this.startValue)*i,this.smoothPower=null!==(t=null==e?void 0:e.newSmoothPower)&&void 0!==t?t:this.smoothPower,this.isFinished=this.currentStep===((null==e?void 0:e.isReverse)?0:this.smoothPower),this.currentStep=Math.max(0,Math.min(this.smoothPower,this.currentStep+n)),this.currentValue}}],n&&XC(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function JC(e){return JC="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},JC(e)}function QC(){QC=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==JC(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(JC(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function ek(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function tk(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ek(o,r,i,a,s,"next",e)}function s(e){ek(o,r,i,a,s,"throw",e)}a(void 0)}))}}function nk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rk(r.key),r)}}function rk(e){var t=function(e){if("object"!=JC(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=JC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==JC(t)?t:String(t)}function ik(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ik=function(){return!!e})()}function ok(){return ok="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ak(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},ok.apply(this,arguments)}function ak(e){return ak=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ak(e)}function sk(e,t){return sk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sk(e,t)}var uk=["x1","x2","y1","y2"],ck=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=ak(t),function(e,t){if(t&&("object"===JC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ik()?Reflect.construct(t,n||[],ak(e).constructor):t.apply(e,n))}(this,t,[e])).faceCoord={},r.inWork=!1,r.customer_id=n,r.config=Object.assign({},NC),r}var n,i,o,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sk(e,t)}(t,e),n=t,i=[{key:"init",value:(s=tk(QC().mark((function e(t){return QC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"facedetector");case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"prepare",value:function(){var e=this,t=this.config,n=t.modelHeight,r=t.modelWidth,i=t.smoothPower;this.globalWidth=this.sdkOptions.width,this.globalHeight=this.sdkOptions.height,this.original=new qc(this.resources.texture,{width:this.globalWidth,height:this.globalHeight}),this.original.addBuffer("result"),this.small=new qc(this.resources.texture,{width:r,height:n}),this.small.addBuffer("model"),this.scaleValue=1,this.xOffset=0,this.yOffset=0;var o=this.defaultFaceCoord(),a={};uk.forEach((function(t){e.faceCoord[t]=new qC({startValue:o[t],smoothPower:i}),a[t]=e.faceCoord[t].getCurrentValue()})),this.currentFace=new zC(a),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.globalWidth=this.sdkOptions.width,this.globalHeight=this.sdkOptions.height,this.original.resize(this.globalWidth,this.globalHeight),this.scaleValue=1,this.xOffset=0,this.yOffset=0}},{key:"process",value:(a=tk(QC().mark((function e(){var t=arguments;return QC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.fps=t[1]||1,this.updateWaiter(),this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.findFaces(),this.setCurrentFace(),this.calcScale(),this.calcOffset(),this.setTransfrom(),this.original.frame.setTransform(this.xOffset,this.yOffset,this.scaleValue,this.scaleValue),this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 13:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setCurrentFace",value:function(){var e,t=this;(null===(e=this.faces)||void 0===e?void 0:e.length)?this.checkCurrentFace():this.noFaceWay();var n={};uk.forEach((function(e){t.faceCoord[e].useSmooth({newSmoothPower:t.config.smoothPower}),n[e]=t.faceCoord[e].getCurrentValue()})),this.currentFace=new zC(n),this.config.isFaceSquareDrawingEnabled,this.config.isPreFaceSquareDrawingEnabled}},{key:"checkCurrentFace",value:function(){var e=this;this.updateWaiter(!0);var t=this.faces.reduce((function(e,t){return t.getSquare()>e.getSquare()&&(e=t),e}),this.faces[0]),n=this.config.sensitivityValue/this.scaleValue;if(!t.isEqual(this.currentFace,n,this.globalHeight,this.globalWidth)){var r=t.getCoord();uk.forEach((function(t){e.faceCoord[t].checkEndValueChange(r[t])}))}}},{key:"noFaceWay",value:function(){var e=this;if(this.waiter.value>0)return this.waiter.value--,void this.updateWaiter(!1);var t=this.defaultFaceCoord();uk.forEach((function(n){e.faceCoord[n].checkEndValueChange(t[n])})),this.updateWaiter(!0)}},{key:"calcScale",value:function(){var e=this.globalHeight*this.globalWidth,t=this.currentFace.getSquare()/e,n=this.config.faceAreaProportion/t;this.scaleValue=Math.sqrt(Math.max(n,1))}},{key:"calcOffset",value:function(){var e=this,t=this.currentFace.getCenter(),n={x:{faceCenter:t.x,newOffset:0,base:this.globalWidth},y:{faceCenter:t.y,newOffset:0,base:this.globalHeight}};Object.values(n).forEach((function(t){var n=(e.scaleValue-1)/2*t.base,r=(t.base/2-t.faceCenter)*e.scaleValue,i=(e.scaleValue-1)*t.base,o=Math.max(r-n,-i);t.newOffset=Math.min(0,o)})),this.xOffset=n.x.newOffset,this.yOffset=n.y.newOffset}},{key:"defaultFaceCoord",value:function(){var e=this.globalWidth/2,t=this.globalHeight/2,n=e*Math.sqrt(this.config.faceAreaProportion),r=t*Math.sqrt(this.config.faceAreaProportion);return{x1:e-n,x2:e+n,y1:t-r,y2:t+r}}},{key:"updateWaiter",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.waiter?this.waiter={value:this.fps*this.config.waiterSeconds,fps:this.fps}:(this.waiter.value=this.waiter.value/this.waiter.fps*this.fps,this.waiter.fps=this.fps)}},{key:"findFaces",value:(o=tk(QC().mark((function e(){var t,n,i,o,a,s,u,c=this;return QC().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break}return e.abrupt("return");case 4:return this.inWork=!0,t=this.config,n=t.faceDetectorAccuracy,i=t.modelHeight,o=t.modelWidth,a=this.small.getBuffer("model"),e.next=9,this.resources.renderer.pixelsAsync(a);case 9:return s=e.sent,u=$C(new Uint8ClampedArray(s),o,i),e.abrupt("return",this.inference.run(u.data,320,240,"facedetector").then((function(e){c.faces=YC({tensor:e,faceDetectorAccuracy:n,outputHeight:c.globalHeight,outputWidth:c.globalWidth})})).catch((function(e){var t;r.ie.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:r.E7.EFFECT_SMART_ZOOM,cause:e})})).finally((function(){return c.inWork=!1})));case 13:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"enable",value:function(){ok(ak(t.prototype),"enable",this).call(this),this.setTransfrom()}},{key:"setTransfrom",value:function(){this.resources.transform={xOffset:this.xOffset,yOffset:this.yOffset,scaleValue:this.scaleValue}}},{key:"disable",value:function(){ok(ak(t.prototype),"disable",this).call(this),this.resources.transform=null,this.scaleValue=1,this.xOffset=0,this.yOffset=0}},{key:"setConfig",value:function(e,t){this.config[e]=t}},{key:"checkTimer",value:function(){return this.faceDetectorTimer?(performance.now()-this.faceDetectorTimer<this.config.faceDetectorPediod_ms||(this.faceDetectorTimer=0),!1):(this.faceDetectorTimer=performance.now(),!0)}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],i&&nk(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(O_);function lk(e){return lk="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},lk(e)}function hk(){hk=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==lk(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(lk(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function fk(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function dk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pk(r.key),r)}}function pk(e){var t=function(e){if("object"!=lk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=lk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lk(t)?t:String(t)}function yk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yk=function(){return!!e})()}function gk(e){return gk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gk(e)}function mk(e,t){return mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mk(e,t)}var vk=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=gk(t),function(e,t){if(t&&("object"===lk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,yk()?Reflect.construct(t,n||[],gk(e).constructor):t.apply(e,n))}(this,t,[e])}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mk(e,t)}(t,e),n=t,r=[{key:"prepare",value:function(){var e=this.resources.texture;this.original=new qc(e,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){this.sdkOptions.isCustomSize()?(this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.enable()):this.disable()}},{key:"process",value:(i=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){fk(o,r,i,a,s,"next",e)}function s(e){fk(o,r,i,a,s,"throw",e)}a(void 0)}))}}(hk().mark((function e(){return hk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],r&&dk(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(O_);function wk(e){return wk="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},wk(e)}function bk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_k(r.key),r)}}function _k(e){var t=function(e){if("object"!=wk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=wk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wk(t)?t:String(t)}var Ik=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={},this.sdkOptions=t,this.container=new fo,this.setOptions(n)}var t,n;return t=e,n=[{key:"setOptions",value:function(e){var t=this;e&&Object.entries(e).forEach((function(e){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return bk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bk(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),r=n[0],i=n[1];t.options[r]=i}))}},{key:"show",value:function(){this.beforeShowFunction&&this.beforeShowFunction(),this.container.visible=!0,this.afterShowFunction&&this.afterShowFunction()}},{key:"hide",value:function(){this.beforeHideFunction&&this.beforeHideFunction(),this.container.visible=!1,this.afterHideFunction&&this.afterHideFunction()}},{key:"onBeforeShow",value:function(e){"function"==typeof e&&(this.beforeShowFunction=e)}},{key:"onAfterShow",value:function(e){"function"==typeof e&&(this.afterShowFunction=e)}},{key:"onBeforeHide",value:function(e){"function"==typeof e&&(this.beforeHideFunction=e)}},{key:"onAfterHide",value:function(e){"function"==typeof e&&(this.afterHideFunction=e)}},{key:"isVisible",value:function(){return this.container.visible}},{key:"getOptions",value:function(){return this.options}},{key:"destroy",value:function(){this.container.destroy(!0)}},{key:"px",value:function(e){return this.sdkOptions.width/640*e}},{key:"render",value:function(){}}],n&&xk(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ak={set:function(e,t,n){return n instanceof Ik?"_"!==t[0]?Reflect.set(e,t,n):e.hasOwnProperty(t)?void 0!==e[t]?(r.ie.notify({type:r.cL.WARNING,message:"You can't overwrite service component '".concat(t,"' (components that begin with a '_' character)"),emitter:r.E7.COMPONENTS_SYSTEM}),!1):Reflect.set(e,t,n):(r.ie.notify({type:r.cL.WARNING,message:"The component ID('".concat(t,"') cannot begin with the character '_', this case reserved for service components."),emitter:r.E7.COMPONENTS_SYSTEM}),!1):(r.ie.notify({type:r.cL.WARNING,message:"Wrong assigned value",emitter:r.E7.COMPONENTS_SYSTEM}),!1)},get:function(e,t,n){if("_getSortedComponentsArr"===t){var r=[],i=[];return Object.keys(e).forEach((function(t){e[t]&&("_"===t[0]?i.push(e[t]):r.push(e[t]))})),r.concat(i)}return Reflect.get(e,t,n)}},Ck=__nested_webpack_require_1427617__(9456);function kk(e){return kk="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},kk(e)}function Sk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tk(r.key),r)}}function Tk(e){var t=function(e){if("object"!=kk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=kk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==kk(t)?t:String(t)}var Ek=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sprite=go.from(t),this.sprite.width=null!=n?n:this.sprite.texture.baseTexture.width,this.sprite.height=null!=r?r:this.sprite.texture.baseTexture.height,this.ratio=this.sprite.width/this.sprite.height}var t,n;return t=e,n=[{key:"destroy",value:function(){var e,t;null===(t=null===(e=this.sprite)||void 0===e?void 0:e.texture)||void 0===t||t.destroy(!0)}}],n&&Sk(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ok(){Ok=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Uk(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Uk(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Pk(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Rk(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Pk(o,r,i,a,s,"next",e)}function s(e){Pk(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Bk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Dk(r.key),r)}}function Dk(e){var t=function(e){if("object"!=Uk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Uk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Uk(t)?t:String(t)}function Mk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mk=function(){return!!e})()}function Lk(){return Lk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fk(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Lk.apply(this,arguments)}function Fk(e){return Fk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fk(e)}function Nk(e,t){return Nk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nk(e,t)}function Uk(e){return Uk="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Uk(e)}var jk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Uk(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Gk=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":Uk(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},zk=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=Fk(t),function(e,t){if(t&&("object"===Uk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Mk()?Reflect.construct(t,n||[],Fk(e).constructor):t.apply(e,n))}(this,t,[e,n])).isVideo=!1,r.hide(),r.render(),r}var n,i,o,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nk(e,t)}(t,e),n=t,i=[{key:"render",value:function(){var e=this;this.container.removeChildren(),this.defaultOverlaySprite=new Ek(kr.WHITE,1920,1280),this.initOverlayFromUrl(this.options).finally((function(){return e.setOverlayImage()}))}},{key:"show",value:function(){this.switchVideoTexture(!0),Lk(Fk(t.prototype),"show",this).call(this)}},{key:"hide",value:function(){Lk(Fk(t.prototype),"hide",this).call(this),this.switchVideoTexture(!1)}},{key:"initOverlayFromUrl",value:(s=Rk(Ok().mark((function e(t){return Ok().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.loadImage(null==t?void 0:t.url).then((function(){var e;return null===(e=null==t?void 0:t.promise)||void 0===e?void 0:e.resolve()})).catch((function(e){var n;return null===(n=null==t?void 0:t.promise)||void 0===n?void 0:n.reject(e)})).finally((function(){return null==t||delete t.promise})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"setOptions",value:(a=Rk(Ok().mark((function e(t){return Ok().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:this.loadImage(t.url).then((function(){var e;return null===(e=t.promise)||void 0===e?void 0:e.resolve()})).catch((function(e){var n;return null===(n=t.promise)||void 0===n?void 0:n.reject(e)})).finally((function(){return null==t||delete t.promise}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"setOverlayImage",value:function(){var e,t=null!==(e=this.loadedOverlaySprite)&&void 0!==e?e:this.defaultOverlaySprite,n=t.sprite,r=t.ratio,i=this.sdkOptions.width,o=this.sdkOptions.height,a=i/o-r,s=n.width;n.width=a>0?i:i-i*a,n.height=n.height*n.width/s,n.anchor.set(.5-i/n.width/2,.5-o/n.height/2),this.container.addChild(n)}},{key:"loadImage",value:(o=Rk(Ok().mark((function e(t){var n=this;return Ok().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Invalid url");case 2:if(this.currentURL!==t&&this.processedURL!==t){e.next=4;break}throw new Error("Same url");case 4:return this.processedURL=t,e.next=7,fetch(t,{method:"HEAD"}).then((function(e){if(!e.ok)throw new Error("Overlay Screen: Image loading error")})).catch((function(e){throw r.ie.notify({type:r.cL.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:r.E7.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error")}));case 7:kr.fromURL(t).then((function(e){var r,i;n.isVideo=(null===(r=e.baseTexture.resource)||void 0===r?void 0:r.source)instanceof HTMLVideoElement,n.resource=e.baseTexture.resource,n.isVideo&&(n.resource.source.loop=!0,n.resource.source.autoplay=!1,n.container.visible&&n.resource.source.play(),n.resource.source.loop=!0,n.resource.source.muted=!0),n.container.removeChildren(),null===(i=n.loadedOverlaySprite)||void 0===i||i.destroy(),n.loadedOverlaySprite=new Ek(e),n.currentURL=t})).catch((function(e){throw r.ie.notify({type:r.cL.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:r.E7.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error")})).finally((function(){n.setOverlayImage(),n.processedURL=""}));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"switchVideoTexture",value:function(e){if(this.isVideo)return e?(this.resource.source.currentTime=0,void this.resource.source.play()):void this.resource.source.pause()}}],i&&Bk(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(Ik);function Hk(e){return Hk="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Hk(e)}function Vk(){Vk=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Hk(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Hk(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Wk(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function $k(e){return Yk.apply(this,arguments)}function Yk(){return Yk=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Wk(o,r,i,a,s,"next",e)}function s(e){Wk(o,r,i,a,s,"throw",e)}a(void 0)}))}}(Vk().mark((function e(t){return Vk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:if(e.sent.ok){e.next=5;break}throw new Error("Url is not available");case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)}))),Yk.apply(this,arguments)}function Kk(e){return Kk="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Kk(e)}function Xk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Zk(r.key),r)}}function Zk(e){var t=function(e){if("object"!=Kk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Kk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Kk(t)?t:String(t)}jk([(0,Ck.CS)("overlayScreen"),Gk("design:type",Function),Gk("design:paramtypes",[]),Gk("design:returntype",void 0)],zk.prototype,"show",null),jk([(0,Ck.CS)("overlayScreen"),Gk("design:type",Function),Gk("design:paramtypes",[]),Gk("design:returntype",void 0)],zk.prototype,"hide",null);var qk=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"calcPosition",value:function(e,t,n,r){return"custom"===n.placement?this.getCustomPosition(e,t,n.x,n.y):this.getPositionFromPlacement(e,t,n.placement,r)}},{key:"getPositionFromPlacement",value:function(e,t,n,r){var i=r.height,o=r.width,a=e,s=t,u={x:0,y:0};return"center"==n?(u.x=(a-o)/2,u.y=(s-i)/2,u):(n.endsWith("right")&&(u.x=a-o),n.startsWith("bottom")&&(u.y=s-i),u)}},{key:"getCustomPosition",value:function(e,t,n,r){return{x:e*n,y:t*r}}}],null&&Xk(t.prototype,null),n&&Xk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Jk(e){return Jk="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},Jk(e)}function Qk(){Qk=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Jk(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(Jk(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function eS(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function tS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nS(r.key),r)}}function nS(e){var t=function(e){if("object"!=Jk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Jk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jk(t)?t:String(t)}function rS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(rS=function(){return!!e})()}function iS(e){return iS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},iS(e)}function oS(e,t){return oS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oS(e,t)}var aS=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=iS(t),function(e,t){if(t&&("object"===Jk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,rS()?Reflect.construct(t,n||[],iS(e).constructor):t.apply(e,n))}(this,t,[e])).sprite=new go,r.sprite.visible=!1,r.container.addChild(r.sprite),r.setOptions(Object.assign({url:"",position:{placement:"top-left",x:0,y:0},size:.05},n)),r}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oS(e,t)}(t,e),n=t,i=[{key:"setOptions",value:function(e){(null==e?void 0:e.size)&&this.setSize(e.size),(null==e?void 0:e.position)&&this.setPosition(e.position),(null==e?void 0:e.url)&&this.setURL(e.url)}},{key:"setURL",value:(o=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){eS(o,r,i,a,s,"next",e)}function s(e){eS(o,r,i,a,s,"throw",e)}a(void 0)}))}}(Qk().mark((function e(t){var n=this;return Qk().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.url!==t){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",$k(t).then((function(){return kr.fromURL(t)})).then((function(e){n.sprite.visible=!0,n.sprite.texture=e,n.sprite.height=n.sdkOptions.height*n.options.size,n.sprite.width=e.width/e.height*n.sprite.height,n.options.url=t,n.sprite.visible=!0})).catch((function(e){var t;r.ie.notify({message:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e,emitter:r.E7.COMPONENTS_SYSTEM,cause:e})})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"setSize",value:function(e){this.options.size=Math.min(1,Math.max(.01,e));var t=this.sprite.width/this.sprite.height;this.sprite.height=this.sdkOptions.height*this.options.size,this.sprite.width=this.sprite.height*t,this.options.position&&"custom"!==this.options.position.placement&&this.setPosition(this.options.position)}},{key:"setPosition",value:function(e){this.options.position=e;var t={width:this.sprite.width,height:this.sprite.height},n=qk.calcPosition(this.sdkOptions.width,this.sdkOptions.height,e,t),r=n.x,i=n.y;this.sprite.position.x=r,this.sprite.position.y=i}},{key:"clear",value:function(){this.sprite.visible=!1}},{key:"render",value:function(){this.setSize(this.options.size),this.setPosition(this.options.position)}}],i&&tS(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(Ik);function sS(e){return sS="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},sS(e)}function uS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cS(r.key),r)}}function cS(e){var t=function(e){if("object"!=sS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=sS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==sS(t)?t:String(t)}var lS=function(){function e(t,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=t,this.sprite=n.sprite,this.id=n.id,this.player=n.player,this.canvas=n.canvas,this.aminationPhase=null!==(r=n.aminationPhase)&&void 0!==r?r:"static",this.sprite.alpha=0,this.shrink=Math.max(0,Math.min(1,n.shrink)),this.sourceRatio=this.sprite.texture.baseTexture.width/this.sprite.texture.baseTexture.height,this.setSpriteSize(n.size),this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink}var t,n;return t=e,(n=[{key:"isShowing",value:function(){return"showing"===this.aminationPhase}},{key:"isStatic",value:function(){return"static"===this.aminationPhase}},{key:"isHidingStop",value:function(){return 0===this.sprite.alpha}},{key:"animateAlpha",value:function(e){this.isStatic()||(this.sprite.alpha=this.isShowing()?Math.min(this.sprite.alpha+e,1):Math.max(this.sprite.alpha-e,0),1!==this.sprite.alpha&&0!==this.sprite.alpha||(this.aminationPhase="static"))}},{key:"animateSize",value:function(e){if(!this.isStatic()){var t=this.height*e*(1-this.shrink),n=this.width*e*(1-this.shrink);this.sprite.height=this.isShowing()?Math.min(this.sprite.height+t,this.height):Math.max(this.sprite.height-t,this.height*this.shrink),this.sprite.width=this.isShowing()?Math.min(this.sprite.width+n,this.width):Math.max(this.sprite.width-n,this.width*this.shrink)}}},{key:"animatePosition",value:function(e){this.isStatic()||(this.sprite.position.x=e.x+(this.width-this.sprite.width)/2,this.sprite.position.y=e.y+(this.height-this.sprite.height)/2)}},{key:"reset",value:function(){this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink,this.sprite.alpha=0}},{key:"setSpriteSize",value:function(e){this.height=this.sdkOptions.height*(null!=e?e:.3),this.width=this.height*this.sourceRatio,this.sprite.height=this.height,this.sprite.width=this.width}}])&&uS(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),hS=__nested_webpack_require_1427617__(6240),fS=__nested_webpack_require_1427617__.n(hS);function dS(){dS=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_S(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(_S(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function pS(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function yS(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){pS(o,r,i,a,s,"next",e)}function s(e){pS(o,r,i,a,s,"throw",e)}a(void 0)}))}}function gS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mS(r.key),r)}}function mS(e){var t=function(e){if("object"!=_S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_S(t)?t:String(t)}function vS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(vS=function(){return!!e})()}function wS(){return wS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bS(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},wS.apply(this,arguments)}function bS(e){return bS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bS(e)}function xS(e,t){return xS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xS(e,t)}function _S(e){return _S="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},_S(e)}var IS=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":_S(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},AS=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=bS(t),function(e,t){if(t&&("object"===_S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vS()?Reflect.construct(t,n||[],bS(e).constructor):t.apply(e,n))}(this,t,[e,Object.assign({capacity:8,duration:1500,animationSpeed:.08,position:{x:0,y:0,placement:"top-left"}},r)])).spriteStore=[],n.ticker=new Li,n.ticker.add((function(){return n.animateSticker()})),n.hide(),n}var n,r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xS(e,t)}(t,e),n=t,r=[{key:"show",value:function(){wS(bS(t.prototype),"show",this).call(this),this.ticker.start()}},{key:"hide",value:function(){wS(bS(t.prototype),"hide",this).call(this),this.ticker.stop()}},{key:"onLoadSucccess",value:function(e){var t="function"==typeof e;this.loadSuccesssFunc=t?e:void 0}},{key:"onLoadError",value:function(e){var t="function"==typeof e;this.loadErrorFunc=t?e:void 0}},{key:"setOptions",value:(o=yS(dS().mark((function e(n){return dS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:n.position&&(this.updateSpritePosition(n.position),delete n.position),n.sticker&&(this.addSticker(n.sticker),delete n.sticker),n.id&&(this.selectSticker(n.id),delete n.id),wS(bS(t.prototype),"setOptions",this).call(this,n),n.size&&this.activeSticker&&this.activeSticker.setSpriteSize(n.size),n.duration&&this.activeSticker&&!this.activeSticker.isHidingStop()&&this.setOptions({id:this.activeID});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"selectSticker",value:function(e){var t,n,r=this;if(e===this.activeID)return 0===this.activeSticker.sprite.alpha&&this.show(),this.activeSticker.aminationPhase="showing",clearTimeout(this.timerId),void(this.timerId=setTimeout((function(){return r.activeSticker.aminationPhase="hiding"}),this.options.duration));this.activeSticker&&(this.container.removeChildren(),null===(t=this.activeSticker.player)||void 0===t||t.stop(),this.activeSticker.reset()),this.activeID=e;var i=this.spriteStore.find((function(e){return e.id===r.activeID}));i&&(null===(n=i.player)||void 0===n||n.play(),i.sprite.position.x=this.options.position.x,i.sprite.position.y=this.options.position.y,i.aminationPhase="showing",this.container.addChild(i.sprite),this.activeSticker=i,this.activeSticker.setSpriteSize(this.options.size),this.calcPosition(),clearTimeout(this.timerId),this.show(),this.timerId=setTimeout((function(){r.activeSticker.aminationPhase="hiding"}),this.options.duration))}},{key:"loadSticker",value:(i=yS(dS().mark((function e(t){var n,r,i,o,a,s,u,c,l,h=arguments;return dS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>1&&void 0!==h[1]&&h[1],i=void 0,o=void 0,a=void 0,e.next=6,CS(t);case 6:if(!e.sent){e.next=16;break}return e.t0=go,e.next=11,kr.fromURL(t);case 11:e.t1=e.sent,(a=new e.t0(e.t1)).texture.baseTexture.resource.source.loop=!0,e.next=35;break;case 16:return e.next=18,fetch(t).then((function(e){return e.arrayBuffer()})).catch((function(e){throw console.log("[ Stickers component ] - url fetching: ".concat(e)),e}));case 18:if(s=e.sent,!((u=fS()(s))instanceof Error)){e.next=28;break}return e.t2=go,e.next=24,kr.fromURL(t);case 24:e.t3=e.sent,a=new e.t2(e.t3),e.next=35;break;case 28:return(i=document.createElement("canvas")).width=u.width,i.height=u.height,e.next=33,u.getPlayer(i.getContext("2d",{willReadFrequently:!0}),!0);case 33:o=e.sent,a=new go(kr.from(i));case 35:return this.spriteStore.push(new lS(this.sdkOptions,{id:t,sprite:a,player:o,canvas:i,shrink:.99,size:this.options.size})),n||this.setOptions({id:t}),c={},this.spriteStore.length>this.options.capacity&&(l=this.spriteStore.shift(),c.removedID=null==l?void 0:l.id,null==l||l.sprite.destroy(!0),null===(r=null==l?void 0:l.canvas)||void 0===r||r.remove()),e.abrupt("return",c);case 40:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"animateSticker",value:function(){var e,t,n;(null===(n=null===(t=null===(e=this.activeSticker)||void 0===e?void 0:e.sprite)||void 0===t?void 0:t.texture)||void 0===n?void 0:n.baseTexture)&&(this.activeSticker.animateSize(this.options.animationSpeed),this.activeSticker.animatePosition(this.options.position),this.activeSticker.animateAlpha(this.options.animationSpeed),this.activeSticker.isHidingStop()?this.hide():this.activeSticker.sprite.texture.update())}},{key:"updateSpritePosition",value:function(e){var t;this.options.position||(this.options.position={});var n=this.sdkOptions.width,r=this.sdkOptions.height;e.x&&(this.options.position.x=n*e.x),e.y&&(this.options.position.y=r*e.y),e.placement&&(this.options.position.placement=e.placement),(null===(t=this.activeSticker)||void 0===t?void 0:t.sprite)&&(this.calcPosition(),this.activeSticker.sprite.position.x=this.options.position.x,this.activeSticker.sprite.position.y=this.options.position.y)}},{key:"addSticker",value:function(e){var t=this,n=function(n){var r,i;"function"==typeof(null===(r=null==e?void 0:e.promise)||void 0===r?void 0:r.resolve)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.resolve(n)),"function"==typeof t.loadSuccesssFunc&&t.loadSuccesssFunc(e.url,null==n?void 0:n.removedID)};this.spriteStore.some((function(t){return t.id===e.url}))?n():this.loadSticker(e.url,null==e?void 0:e.silenceMode).then(n).catch((function(n){var r,i;"function"==typeof(null===(r=null==e?void 0:e.promise)||void 0===r?void 0:r.reject)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.reject(n)),"function"==typeof t.loadErrorFunc&&t.loadErrorFunc(e.url)}))}},{key:"calcPosition",value:function(){if("custom"!==this.options.position.placement&&this.options.position.placement){var e=this.sdkOptions.width-this.activeSticker.width,t=this.sdkOptions.height-this.activeSticker.height;if("center"===this.options.position.placement)return this.options.position.x=.5*e,void(this.options.position.y=.5*t);this.options.position.x=~this.options.position.placement.indexOf("left")?0:e,this.options.position.y=~this.options.position.placement.indexOf("top")?0:t}}}],r&&gS(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(Ik);function CS(e){return kS.apply(this,arguments)}function kS(){return kS=yS(dS().mark((function e(t){var n;return dS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:return n=e.sent,e.abrupt("return",!!~n.headers.get("content-type").indexOf("video"));case 4:case"end":return e.stop()}}),e)}))),kS.apply(this,arguments)}function SS(){SS=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==DS(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(DS(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function TS(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function ES(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,OS(r.key),r)}}function OS(e){var t=function(e){if("object"!=DS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=DS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==DS(t)?t:String(t)}function PS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(PS=function(){return!!e})()}function RS(e){return RS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RS(e)}function BS(e,t){return BS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},BS(e,t)}function DS(e){return DS="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},DS(e)}!function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":_S(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);o>3&&a&&Object.defineProperty(t,n,a)}([(0,Ck.CS)(),IS("design:type",Function),IS("design:paramtypes",[String]),IS("design:returntype",void 0)],AS.prototype,"selectSticker",null);var MS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":DS(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},LS=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":DS(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},FS=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=RS(t),function(e,t){if(t&&("object"===DS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,PS()?Reflect.construct(t,n||[],RS(e).constructor):t.apply(e,n))}(this,t,[e])).fonts={},r.isShowing=!1,r.isHiding=!1,r.options={position:{x:0,y:0,placement:"bottom-left"},color:{primary:33777,secondary:16777215,text:1118481},offset:{x:0,y:0},text:{title:"LowerThird Title",subtitle:"LowerThird Subtitle",maxLengthTitle:10,maxLengthSubtitle:100}},r.setOptions(n,!1),r.ticker=new Li,r.container.visible=!1,r}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BS(e,t)}(t,e),n=t,i=[{key:"render",value:function(){}},{key:"setOptions",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(this.setColor(e.color),this.setOffset(e.offset),this.setPosition(e.position),this.setText(e.text),t&&this.render())}},{key:"showLowerThird",value:function(){this.stopHiding(),"function"==typeof this.showFunction&&(this.ticker.add(this.showFunction),this.ticker.started||this.ticker.start(),this.isShowing=!0)}},{key:"hideLowerThird",value:function(){this.stopShowing(),"function"==typeof this.hideFunction&&(this.isHiding=!0,this.ticker.add(this.hideFunction),this.ticker.started||this.ticker.start())}},{key:"stopShowing",value:function(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.showFunction),this.isShowing=!1}},{key:"stopHiding",value:function(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.hideFunction),this.isHiding=!1}},{key:"setColor",value:function(e){var t=this;e&&Object.keys(e).forEach((function(n){t.options.color[n]=e[n]}))}},{key:"setOffset",value:function(e){var t=this;e&&Object.keys(e).forEach((function(n){t.options.offset[n]=Math.min(.25,Math.max(0,e[n]))}))}},{key:"setPosition",value:function(e){var t=this;e&&Object.keys(e).forEach((function(n){t.options.position[n]=e[n]}))}},{key:"setText",value:function(e){var t=this;e&&Object.keys(e).forEach((function(n){t.options.text[n]=e[n]}))}},{key:"offsetX",value:function(){var e;return this.sdkOptions.width*(null!==(e=this.options.offset.x)&&void 0!==e?e:0)}},{key:"offsetY",value:function(){var e;return this.sdkOptions.height*(null!==(e=this.options.offset.y)&&void 0!==e?e:0)}},{key:"strTrimAndEllipsis",value:function(e,t){return(e=e.trim()).length<t?e:e.substring(0,t-3)+"..."}},{key:"showOffset",value:function(){var e=new uu;e.lineStyle({color:14550873,width:1}).drawRect(this.offsetX(),this.offsetY(),this.sdkOptions.width-2*this.offsetX(),this.sdkOptions.height-2*this.offsetY()),this.container.addChild(e)}},{key:"drawRectPrimary",value:function(e,t,n,r){var i=new uu;return i.beginFill(this.options.color.primary).drawRect(e,t,n,r).endFill(),i}},{key:"drawRectSecondary",value:function(e,t,n,r){var i=new uu;return i.beginFill(this.options.color.secondary).drawRect(e,t,n,r).endFill(),i}},{key:"fontFamily",value:function(e){var t;return null!==(t=this.fonts[e])&&void 0!==t?t:"Arial, Helvetica, sans-serif"}},{key:"loadFont",value:(o=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){TS(o,r,i,a,s,"next",e)}function s(e){TS(o,r,i,a,s,"throw",e)}a(void 0)}))}}(SS().mark((function e(t,n){var i=this;return SS().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ra.load(n).then((function(e){i.fonts[t]||(i.fonts[t]=[]),i.fonts[t].push('"'.concat(e.family.replace(/[\\"]/g,"\\$&"),'"'))})).catch((function(e){r.ie.notify({type:r.cL.WARNING,message:"LowerThird font loading. ".concat(e),cause:e,emitter:r.E7.COMPONENTS_SYSTEM})}));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"destroy",value:function(){var e;this.stopShowing(),this.stopHiding(),this.hide(),null===(e=this.container)||void 0===e||e.destroy(!0)}}],i&&ES(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(Ik);function NS(e){return NS="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},NS(e)}function US(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jS(r.key),r)}}function jS(e){var t=function(e){if("object"!=NS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=NS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==NS(t)?t:String(t)}MS([(0,Ck.CS)(),LS("design:type",Function),LS("design:paramtypes",[]),LS("design:returntype",void 0)],FS.prototype,"showLowerThird",null),MS([(0,Ck.CS)(),LS("design:type",Function),LS("design:paramtypes",[]),LS("design:returntype",void 0)],FS.prototype,"hideLowerThird",null);var GS=function(){function e(t){var n,r,i,o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(n=t.endValue)&&void 0!==n?n:t.startValue,this.smoothPower=null!==(r=t.smoothPower)&&void 0!==r?r:1,this.range=this.endValue-this.startValue,this.speedNext=null!==(i=t.speedNext)&&void 0!==i?i:1,this.speedBack=null!==(a=null!==(o=t.speedBack)&&void 0!==o?o:t.speedNext)&&void 0!==a?a:1,this.smoothFunctionNext=this.getSmoothFunction(t.smoothFunctionNext),this.smoothFunctionBack=this.getSmoothFunction(null!==(s=t.smoothFunctionBack)&&void 0!==s?s:t.smoothFunctionNext)}var t,n;return t=e,n=[{key:"setCurrentStep",value:function(e){this.currentStep=Math.max(0,Math.min(e,this.smoothPower))}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"setEnd",value:function(){return this.currentStep=this.smoothPower,this.endValue}},{key:"isEnd",value:function(e){return this.currentStep>=this.smoothPower*(null!=e?e:1)}},{key:"isStart",value:function(e){return this.currentStep<=this.smoothPower*(null!=e?e:0)}},{key:"reset",value:function(){this.currentStep=0}},{key:"next",value:function(){if(this.startValue===this.endValue)return this.currentValue;var e=this.currentStep/this.smoothPower,t=this.smoothFunctionNext(e);return this.currentValue=this.startValue+this.range*t,this.currentStep=Math.min(this.smoothPower,this.currentStep+this.speedNext),this.currentValue}},{key:"back",value:function(){if(this.startValue===this.endValue)return this.currentValue;this.currentStep=Math.max(0,this.currentStep-this.speedBack);var e=this.currentStep/this.smoothPower,t=this.smoothFunctionBack(e);return this.currentValue=this.startValue+this.range*t,this.currentValue}},{key:"getSmoothFunction",value:function(e){return function(t){switch(e){case"ease-out-sine":return Math.sin(t*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-t,5);case"ease-out-cubic":Math.pow(1-t,3);default:return t}}}}],n&&US(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function zS(e){return zS="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},zS(e)}function HS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,VS(r.key),r)}}function VS(e){var t=function(e){if("object"!=zS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=zS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==zS(t)?t:String(t)}function WS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(WS=function(){return!!e})()}function $S(e){return $S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$S(e)}function YS(e,t){return YS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},YS(e,t)}var KS=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=$S(t),function(e,t){if(t&&("object"===zS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,WS()?Reflect.construct(t,n||[],$S(e).constructor):t.apply(e,n))}(this,t,[e,n])).animations={},r.smoothPower=65,r.ltContainer=new fo,r.container.addChild(r.ltContainer),r.addShowFunction(),r.addHideFunction(),r.render(),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YS(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e;null===(e=this.ltContainer)||void 0===e||e.destroy(!0),this.ltContainer=new fo,this.ltContainer.position.x=this.offsetX(),this.container.addChild(this.ltContainer),this.createText(),this.addRectangles(),this.addSpriteMask(),this.ltContainer.addChild(this.rectBack),this.ltContainer.addChild(this.rectFront),this.ltContainer.addChild(this.title),this.ltContainer.addChild(this.subtitle)}},{key:"createText",value:function(){var e=this,t=this.sdkOptions.width-2*this.offsetX()-this.px(70),n=function(n,r,i){return{fontFamily:"Trebuchet MS",fontSize:e.px(n),fontWeight:r,fill:i,wordWrapWidth:t,wordWrap:!0,breakWords:!0}};this.subtitle=new Fu(this.options.text.subtitle,n(12,"400",this.options.color.primary)),this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.sdkOptions.height-this.offsetY()-this.px(12)-this.subtitle.height,this.animations.subtitle=new GS({startValue:-this.subtitle.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.title=new Fu(this.options.text.title,n(20,"700",1118481)),this.title.width=Math.min(t,this.title.width),this.title.position.x=-this.title.width,this.title.position.y=this.sdkOptions.height-this.offsetY()-this.px(15)-this.subtitle.height-this.title.height,this.animations.title=new GS({startValue:-this.title.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(45),this.ltHeight=this.title.height+this.subtitle.height+this.px(23),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"addRectangles",value:function(){var e=this.sdkOptions.height-this.offsetY()-this.ltHeight;this.rectBack=(new uu).beginFill(this.options.color.primary).drawRoundedRect(0,e,this.ltWidth,this.ltHeight,this.px(5)).endFill(),this.animations.rectBack=new GS({startValue:-this.rectBack.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.rectFront=(new uu).beginFill(16777215).drawRoundedRect(0,e,this.ltWidth-this.px(15),this.ltHeight,this.px(5)).endFill(),this.rectFront.position.x=-this.ltWidth+this.px(15),this.animations.rectFront=new GS({startValue:-this.rectFront.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.isVisible()&&(this.rectBack.position.x=this.animations.rectBack.setEnd(),this.rectFront.position.x=this.animations.rectFront.setEnd())}},{key:"addSpriteMask",value:function(){this.mask=new go(kr.WHITE),this.mask.width=this.ltWidth,this.mask.height=this.sdkOptions.height,this.ltContainer.addChild(this.mask),this.ltContainer.mask=this.mask}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd(.3)&&(e.rectFront.position.x=e.animations.rectFront.next()),e.animations.rectBack.isEnd(.8)&&(e.title.position.x=e.animations.title.next()),e.animations.title.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next()),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing()}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){e.isHiding||(e.stopHiding(),e.hide()),e.subtitle.position.x=e.animations.subtitle.back(),e.title.position.x=e.animations.title.back(),e.rectFront.position.x=e.animations.rectFront.back(),e.rectBack.position.x=e.animations.rectBack.back(),e.isHiding=!e.animations.rectBack.isStart()}}}],r&&HS(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(FS);function XS(e){return XS="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},XS(e)}function ZS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qS(r.key),r)}}function qS(e){var t=function(e){if("object"!=XS(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=XS(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==XS(t)?t:String(t)}function JS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(JS=function(){return!!e})()}function QS(e){return QS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},QS(e)}function eT(e,t){return eT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},eT(e,t)}var tT="https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVYNyB1Wk.woff2",nT="https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVZNyB.woff2",rT="https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVYNyB1Wk.woff2",iT="https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVZNyB.woff2",oT=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=QS(t),function(e,t){if(t&&("object"===XS(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,JS()?Reflect.construct(t,n||[],QS(e).constructor):t.apply(e,n))}(this,t,[e,n])).isReady=!1,r.animations={},r.smoothPower={title:35,subtitle:35,middleLine:50},r.addShowFunction(),r.addHideFunction(),Promise.all([r.loadFont("title",tT),r.loadFont("title",nT),r.loadFont("subtitle",rT),r.loadFont("subtitle",iT)]).finally((function(){r.isReady=!0,r.render()})),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eT(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e,t;this.container.removeChild(this.middleLine),this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createText(),this.createRectangles(),this.container.addChild(this.middleLine),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer)}},{key:"createText",value:function(){this.title=new Fu(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(35),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.title.position.x=0,this.title.position.y=this.title.height,this.titleContainer=new fo,this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height+this.px(200);var e=new go(kr.WHITE);e.tint=0,e.width=this.title.width,e.height=this.title.height,e.position.x=0,e.position.y=0,this.titleContainer.addChild(e),this.titleContainer.mask=e,this.titleContainer.addChild(this.title),this.animations.title=new GS({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"}),this.subtitle=new Fu(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fontWeight:"100",fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.subtitle.position.x=0,this.subtitle.position.y=-this.subtitle.height-this.px(20),this.subtitleContainer=new fo,this.subtitleContainer.width=this.subtitle.width,this.subtitleContainer.height=this.subtitle.height+this.px(20);var t=new go(kr.WHITE);t.tint=0,t.width=this.subtitle.width,t.height=this.subtitle.height,t.position.x=0,t.position.y=0,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.subtitleContainer.addChild(this.subtitle),this.animations.subtitle=new GS({startValue:this.subtitle.position.y,smoothPower:this.smoothPower.subtitle,endValue:0,smoothFunctionNext:"ease-out-quint"}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(25),this.ltHeight=this.titleContainer.height+this.subtitleContainer.height+this.px(10),this.titleContainer.position.x=this.offsetX(),this.subtitleContainer.position.x=this.offsetX();var n=this.titleContainer.width-this.subtitleContainer.width;n>0?this.subtitleContainer.position.x+=n:this.titleContainer.position.x-=n,this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight,this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height,this.isVisible()&&(this.title.position.y=0,this.subtitle.position.y=0,this.animations.title.setCurrentStep(this.smoothPower.title),this.animations.subtitle.setCurrentStep(this.smoothPower.subtitle))}},{key:"createRectangles",value:function(){this.middleLine=new uu;var e=this.ltWidth+this.offsetX(),t=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height-this.px(8);this.middleLine.beginFill(this.options.color.primary).drawRoundedRect(-e-this.px(2),t,e,this.px(3),this.px(2)).endFill(),this.animations.middleLine=new GS({startValue:0,smoothPower:this.smoothPower.middleLine,endValue:e,smoothFunctionNext:"ease-out-quint"}),this.isVisible()&&(this.middleLine.position.x=e,this.animations.middleLine.setCurrentStep(this.smoothPower.middleLine))}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.middleLine.position.x=e.animations.middleLine.next(),e.animations.middleLine.isEnd(.5)&&(e.title.position.y=e.animations.title.next()),e.animations.middleLine.isEnd(.5)&&(e.subtitle.position.y=e.animations.subtitle.next()),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing())}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.y=e.animations.subtitle.back(),e.animations.title.isStart(.7)&&(e.middleLine.position.x=e.animations.middleLine.back()),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],r&&ZS(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(FS);function aT(e){return aT="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},aT(e)}function sT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uT(r.key),r)}}function uT(e){var t=function(e){if("object"!=aT(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=aT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==aT(t)?t:String(t)}function cT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(cT=function(){return!!e})()}function lT(e){return lT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lT(e)}function hT(e,t){return hT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hT(e,t)}var fT="https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w9aXpsog.woff2",dT="https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w5aXo.woff2",pT="https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw9aXpsog.woff2",yT="https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw5aXo.woff2",gT=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=lT(t),function(e,t){if(t&&("object"===aT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cT()?Reflect.construct(t,n||[],lT(e).constructor):t.apply(e,n))}(this,t,[e,n])).titleFontSize=35,r.animations={},r.isReady=!1,r.smoothPower={title:95,subtitle:95,titleRect:75,titleTextMask:75,titleRectMask:75,rectFront:40,rectBack:40},r.addShowFunction(),r.addHideFunction(),Promise.all([r.loadFont("title",fT),r.loadFont("title",dT),r.loadFont("subtitle",pT),r.loadFont("subtitle",yT)]).finally((function(){r.isReady=!0,r.render()})),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hT(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e,t,n;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),this.container.removeChild(this.vertLineContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),null===(n=this.vertLineContainer)||void 0===n||n.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer),this.container.addChild(this.vertLineContainer)}},{key:"createTitle",value:function(){var e;this.title=new Fu(null===(e=this.options.text.title)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("title"),fontSize:this.px(this.titleFontSize),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,lineHeight:this.px(this.titleFontSize)}),this.title.position.x=.3*this.title.width,this.animations.title=new GS({startValue:this.title.position.x,endValue:this.px(10),smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint",speedBack:1.3});var t=new fo;t.width=this.title.width+this.px(10),t.height=this.title.height,t.addChild(this.title),this.titleTextMask=new go(kr.WHITE),this.titleTextMask.width=0,this.titleTextMask.height=this.title.height,t.addChild(this.titleTextMask),t.mask=this.titleTextMask,this.animations.titleTextMask=new GS({startValue:0,endValue:this.title.width+this.px(10),smoothPower:this.smoothPower.titleTextMask,smoothFunctionNext:"ease-out-quint",speedBack:1.25}),this.titleRect=this.drawRectSecondary(0,this.px(this.titleFontSize/3.5),this.title.width,this.title.height-this.px(this.titleFontSize/2.2)),this.animations.titleRect=new GS({startValue:.2*-this.title.width,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRect,smoothFunctionNext:"ease-out-quint",speedNext:.5,speedBack:1.1});var n=new fo;n.width=this.titleRect.width,n.height=this.titleRect.height,n.addChild(this.titleRect),this.titleRectMask=new go(kr.WHITE),this.titleRectMask.width=0,this.titleRectMask.height=this.title.height,n.addChild(this.titleRectMask),n.mask=this.titleRectMask,this.animations.titleRectMask=new GS({startValue:0,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRectMask,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:1}),this.titleContainer=new fo,this.titleContainer.width=this.title.width+this.px(10),this.titleContainer.height=this.title.height,this.titleContainer.addChild(t),this.titleContainer.addChild(n),this.ltHeight=this.title.height+this.subtitleContainer.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight+this.px(3),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.titleTextMask.width=this.animations.titleTextMask.setEnd(),this.titleRect.position.x=this.animations.titleRect.setEnd(),this.titleRectMask.width=this.animations.titleRectMask.setEnd())}},{key:"createSubtitle",value:function(){var e;this.subtitle=new Fu(null===(e=this.options.text.subtitle)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(11),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.subtitle.position.x=-this.subtitle.width,this.animations.subtitle=new GS({startValue:this.subtitle.position.x,endValue:this.px(11),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint",speedBack:1.2}),this.subtitleContainer=new fo,this.subtitleContainer.width=this.subtitle.width+this.px(10),this.subtitleContainer.height=this.subtitle.height,this.subtitleContainer.addChild(this.subtitle),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height;var t=new go(kr.WHITE);t.width=this.subtitle.width+this.px(10),t.height=this.subtitle.height,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"createRectangles",value:function(){var e=this.title.height-this.px(this.titleFontSize/2.2);this.rectFront=this.drawRectPrimary(0,0,this.px(4),e),this.animations.rectFront=new GS({startValue:e,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:.8,speedBack:1}),this.rectBack=this.drawRectSecondary(0,0,this.px(4),this.px(4)),this.animations.rectBack=new GS({startValue:e,endValue:-this.px(4),smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:.6}),this.vertLineContainer=new fo,this.vertLineContainer.width=this.rectFront.width,this.vertLineContainer.height=e,this.vertLineContainer.addChild(this.rectBack),this.vertLineContainer.addChild(this.rectFront),this.vertLineContainer.position.x=this.offsetX(),this.vertLineContainer.position.y=this.titleContainer.position.y+this.px(this.titleFontSize/3.5);var t=new go(kr.WHITE);t.width=this.vertLineContainer.width,t.height=e,this.vertLineContainer.addChild(t),this.vertLineContainer.mask=t,this.isVisible()&&(this.rectFront.position.y=this.animations.rectFront.setEnd())}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectFront.position.y=e.animations.rectFront.next(),e.rectBack.position.y=e.animations.rectBack.next(),e.animations.rectFront.isEnd(.9)&&(e.title.position.x=e.animations.title.next(),e.subtitle.position.x=e.animations.subtitle.next(),e.titleTextMask.width=e.animations.titleTextMask.next(),e.titleRectMask.width=e.animations.titleRectMask.next(),e.titleRect.position.x=e.animations.titleRect.next(),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing()))}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.x=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.titleRect.getCurrentStep()<e.smoothPower.titleRect-2&&(e.titleTextMask.width=e.animations.titleTextMask.back()),e.titleRect.position.x=e.animations.titleRect.back(),e.titleRectMask.width=e.animations.titleRectMask.back(),e.animations.titleRectMask.isStart(.2)&&(e.rectBack.position.y=e.animations.rectBack.back(),e.rectFront.position.y=e.animations.rectFront.back()),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],r&&sT(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(FS);function mT(e){return mT="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},mT(e)}function vT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wT(r.key),r)}}function wT(e){var t=function(e){if("object"!=mT(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=mT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==mT(t)?t:String(t)}function bT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(bT=function(){return!!e})()}function xT(e){return xT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xT(e)}function _T(e,t){return _T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_T(e,t)}var IT="https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWF1lEP2A.woff2",AT="https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWE1lE.woff2",CT="https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",kT="https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2",ST=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=xT(t),function(e,t){if(t&&("object"===mT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,bT()?Reflect.construct(t,n||[],xT(e).constructor):t.apply(e,n))}(this,t,[e,n])).animations={},r.isReady=!1,r.smoothPower={title:75,subtitle:65,rectFront:40,rectBack:40},r.addShowFunction(),r.addHideFunction(),Promise.all([r.loadFont("title",IT),r.loadFont("title",AT),r.loadFont("subtitle",CT),r.loadFont("subtitle",kT)]).finally((function(){r.isReady=!0,r.render()})),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_T(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e,t;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer)}},{key:"createSubtitle",value:function(){this.subtitle=new Fu(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0});var e=this.subtitle.width+this.px(6);this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.px(3),this.animations.subtitle=new GS({startValue:this.subtitle.position.x,endValue:this.px(10),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint"}),this.subtitleContainer=new fo,this.subtitleContainer.width=e,this.subtitleContainer.height=this.subtitle.height+this.px(6),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height-this.px(6),this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"createTitle",value:function(){this.title=new Fu(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(30),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.title.position.y=this.title.height,this.animations.title=new GS({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"});var e=new go(kr.WHITE);e.width=this.title.width,e.height=this.title.height,this.titleContainer=new fo,this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height,this.titleContainer.addChild(this.title),this.titleContainer.addChild(e),this.titleContainer.mask=e,this.ltWidth=Math.max(this.title.width,this.subtitle.width+this.px(15)),this.ltHeight=this.title.height+this.subtitle.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight-this.px(6),this.isVisible()&&(this.title.position.y=this.animations.title.setEnd())}},{key:"createRectangles",value:function(){var e=this.subtitle.height+this.px(6),t=this.ltWidth;this.rectFront=this.drawRectPrimary(0,0,t,e),this.rectFront.position.x=-t,this.animations.rectFront=new GS({startValue:-t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"}),this.rectBack=this.drawRectSecondary(0,0,t,e),this.rectBack.position.x=t,this.animations.rectBack=new GS({startValue:t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"});var n=new go(kr.WHITE);n.width=t,n.height=this.subtitle.height+this.px(6),this.subtitleContainer.addChild(n),this.subtitleContainer.mask=n,this.subtitleContainer.addChild(this.rectBack),this.subtitleContainer.addChild(this.rectFront),this.subtitleContainer.addChild(this.subtitle),this.isVisible()&&(this.rectFront.position.x=this.animations.rectFront.setEnd(),this.rectBack.position.x=this.animations.rectBack.setEnd())}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd()&&(e.rectFront.position.x=e.animations.rectFront.next(),e.animations.rectFront.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next(),e.title.position.y=e.animations.title.next(),e.animations.title.isEnd()&&e.animations.subtitle.isEnd()&&e.stopShowing())))}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.subtitle.isStart(.5)&&(e.rectFront.position.x=e.animations.rectFront.back(),e.animations.rectFront.isStart()&&(e.rectBack.position.x=e.animations.rectBack.back())),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],r&&vT(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(FS);function TT(e){return TT="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},TT(e)}function ET(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,OT(r.key),r)}}function OT(e){var t=function(e){if("object"!=TT(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=TT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==TT(t)?t:String(t)}var PT=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.padding=20,this.smoothPower=75,this.startRectValue=0,this.sdkOptions=t,this.container=new fo,this.addText(n),this.addRect(n),this.addHidden(n);var r=new go(kr.WHITE);r.height=this.height,r.width=n.offsetX+this.width,r.position.x=-n.offsetX,this.container.addChild(r),this.container.mask=r,n.isVisible&&(this.text.position.x=this.textInAnimation.setEnd(),this.hiddenMask.position.x=this.hiddenMaskAnimation.setEnd(),this.rect.position.x=this.rectAnimation.setEnd())}var t,n;return t=e,n=[{key:"textInAnimateFunction",value:function(){this.text.position.x=this.textInAnimation.next()}},{key:"textOutAnimateFunction",value:function(){this.text.position.x=this.textOutAnimation.next()}},{key:"textResetFunction",value:function(){this.text.position.x=2*this.px(this.padding)+this.width}},{key:"rectAnimateFunction",value:function(e){this.rect.position.x=e?this.rectAnimation.next():this.rectAnimation.back()}},{key:"hiddenMaskAnimateFunction",value:function(e){this.hiddenMask.position.x=e?this.rectAnimation.next():this.rectAnimation.back()}},{key:"destroy",value:function(){var e;null===(e=this.container)||void 0===e||e.destroy(!0)}},{key:"addText",value:function(e){this.text=new Fu(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorText,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0}),this.height=1.2*this.text.height,this.width=this.text.width+2*this.px(this.padding);var t=2*this.px(this.padding)+this.width;this.text.position.x=t,this.text.position.y=this.px(e.size/8.5),this.textInAnimation=new GS({startValue:t,endValue:this.px(this.padding),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.textOutAnimation=new GS({startValue:this.px(this.padding),endValue:-this.width-this.px(this.padding)-e.offsetX,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.text)}},{key:"addRect",value:function(e){this.rect=(new uu).beginFill(e.colorRect).drawRect(0,0,this.width,this.height).endFill(),this.startRectValue=-e.offsetX-this.width,this.rect.position.x=this.startRectValue,this.rectAnimation=new GS({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.rect)}},{key:"addHidden",value:function(e){this.hiddenMask=new go(kr.WHITE),this.hiddenMask.width=this.width,this.hiddenMask.height=this.height,this.hiddenMask.position.x=this.startRectValue,this.hiddenMaskAnimation=new GS({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"});var t=new Fu(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorTextHidden,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0});this.hiddenContainer=new fo,this.hiddenContainer.addChild(t),this.hiddenContainer.position.x=this.px(this.padding),this.hiddenContainer.position.y=this.px(e.size/8.5),this.hiddenContainer.addChild(this.hiddenMask),this.hiddenContainer.mask=this.hiddenMask,this.container.addChild(this.hiddenContainer)}},{key:"px",value:function(e){return this.sdkOptions.width/640*e}}],n&&ET(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function RT(e){return RT="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},RT(e)}function BT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,DT(r.key),r)}}function DT(e){var t=function(e){if("object"!=RT(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=RT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==RT(t)?t:String(t)}function MT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(MT=function(){return!!e})()}function LT(e){return LT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},LT(e)}function FT(e,t){return FT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},FT(e,t)}var NT="https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",UT="https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2",jT="https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-ASAEWn.woff2",GT="https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-QSAA.woff2",zT=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,n){return t=LT(t),function(e,t){if(t&&("object"===RT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,MT()?Reflect.construct(t,n||[],LT(e).constructor):t.apply(e,n))}(this,t,[e,n])).isTitleTextShown=!1,r.isTitleRectHidden=!1,r.isSubtitleTextShown=!1,r.isSubtitleRectHidden=!1,r.delay=300,r.gap=3,r.isReady=!1,r.addShowFunction(),r.addHideFunction(),Promise.all([r.loadFont("title",NT),r.loadFont("title",UT),r.loadFont("subtitle",jT),r.loadFont("subtitle",GT)]).finally((function(){r.isReady=!0,r.render()})),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FT(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e,t,n,r;this.container.removeChild(null===(e=this.titleBox)||void 0===e?void 0:e.container),null===(t=this.titleBox)||void 0===t||t.destroy(),this.container.removeChild(null===(n=this.subtitleBox)||void 0===n?void 0:n.container),null===(r=this.subtitleBox)||void 0===r||r.destroy(),this.subtitleBox=new PT(this.sdkOptions,{fontfamily:this.fontFamily("subtitle"),text:this.options.text.subtitle,colorText:this.options.color.primary,colorTextHidden:16777215,colorRect:this.options.color.primary,size:12,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.subtitleBox.container.position.x=this.offsetX(),this.subtitleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleBox.height,this.titleBox=new PT(this.sdkOptions,{fontfamily:this.fontFamily("title"),text:this.options.text.title,colorText:this.options.color.primary,colorTextHidden:2236962,colorRect:this.options.color.secondary,size:25,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.titleBox.container.position.x=this.offsetX(),this.titleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.titleBox.height-this.subtitleBox.height-this.px(this.gap),this.container.addChild(this.titleBox.container),this.container.addChild(this.subtitleBox.container)}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){var t,n;e.isReady&&(e.isTitleRectHidden=!1,e.isSubtitleRectHidden=!1,null===(t=e.titleBox)||void 0===t||t.textOutAnimation.reset(),null===(n=e.subtitleBox)||void 0===n||n.textOutAnimation.reset(),e.show(),e.titleBox.textInAnimateFunction(),e.titleBox.textInAnimation.isEnd(.8)&&setTimeout((function(){return e.isTitleTextShown=!0}),e.delay),e.isTitleTextShown&&(e.titleBox.rectAnimateFunction(!0),e.titleBox.hiddenMaskAnimateFunction(!0)),e.subtitleBox.textInAnimateFunction(),e.subtitleBox.textInAnimation.isEnd(.8)&&setTimeout((function(){e.isSubtitleTextShown=!0}),e.delay),e.isSubtitleTextShown&&(e.subtitleBox.rectAnimateFunction(!0),e.subtitleBox.hiddenMaskAnimateFunction(!0)),e.titleBox.rectAnimation.isEnd()&&e.subtitleBox.rectAnimation.isEnd()&&e.stopShowing())}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(e.isTitleTextShown=!1,e.isSubtitleTextShown=!1,e.titleBox.textInAnimation.reset(),e.subtitleBox.textInAnimation.reset(),!e.isHiding)return e.stopHiding(),e.hide(),e.titleBox.textResetFunction(),void e.subtitleBox.textResetFunction();e.titleBox.rectAnimateFunction(!1),e.titleBox.hiddenMaskAnimateFunction(!1),e.titleBox.rectAnimation.isStart()&&setTimeout((function(){return e.isTitleRectHidden=!0}),e.delay),e.isTitleRectHidden&&e.titleBox.textOutAnimateFunction(),e.subtitleBox.rectAnimateFunction(!1),e.subtitleBox.hiddenMaskAnimateFunction(!1),e.subtitleBox.rectAnimation.isStart()&&setTimeout((function(){return e.isSubtitleRectHidden=!0}),e.delay),e.isSubtitleRectHidden&&e.subtitleBox.textOutAnimateFunction(),e.isHiding=!e.titleBox.textOutAnimation.isEnd()&&!e.subtitleBox.textOutAnimation.isEnd()}}}],r&&BT(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(FS);function HT(e){return HT="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},HT(e)}function VT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,WT(r.key),r)}}function WT(e){var t=function(e){if("object"!=HT(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=HT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==HT(t)?t:String(t)}var $T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=new Map}var t,n;return t=e,n=[{key:"setCallback",value:function(e,t){return"function"!=typeof t?(this.store.delete(e),!1):(this.store.set(e,t),!0)}},{key:"getCallback",value:function(e){return this.store.get(e)}},{key:"call",value:function(e){var t=this.store.get(e);if("function"==typeof t)return t()}}],n&&VT(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),YT=__nested_webpack_require_1427617__(4220),KT=__nested_webpack_require_1427617__(4412),XT=__nested_webpack_require_1427617__.n(KT);function ZT(e){return ZT="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},ZT(e)}function qT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,JT(r.key),r)}}function JT(e){var t=function(e){if("object"!=ZT(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ZT(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ZT(t)?t:String(t)}var QT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state="inactive",this._duration=0,this.timeStart=0}var t,n;return t=e,(n=[{key:"duration",get:function(){return"active"===this.state?Date.now()-this.timeStart+this._duration:this._duration}},{key:"start",value:function(){"inactive"===this.state&&(this._duration=0,this.state="active",this.timeStart=Date.now())}},{key:"stop",value:function(){"inactive"!==this.state&&("active"===this.state&&(this._duration=this._duration+Date.now()-this.timeStart),this.state="inactive")}},{key:"pause",value:function(){"active"===this.state&&(this.state="paused",this._duration=this._duration+Date.now()-this.timeStart)}},{key:"resume",value:function(){"paused"===this.state&&(this.state="active",this.timeStart=Date.now())}}])&&qT(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function eE(){eE=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==iE(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(iE(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function tE(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function nE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rE(r.key),r)}}function rE(e){var t=function(e){if("object"!=iE(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=iE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==iE(t)?t:String(t)}function iE(e){return iE="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},iE(e)}var oE=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onStartFunction=function(){},this.blobPromise=new YT.w,this.timer=new QT}var t,n,i;return t=e,n=[{key:"removeTracks",value:function(e){var t=this;this.stream&&("audio"===e?t.stream.getAudioTracks():"video"===e?t.stream.getVideoTracks():t.stream.getTracks()).forEach((function(e){t.stream.removeTrack(e)}))}},{key:"initRecorder",value:function(e){var t=this;this.isActive()&&this.stop(),this.recorder=new MediaRecorder(e,{mimeType:this.mimeType}),this.recorder.ondataavailable=function(e){return t.blobPromise.resolve(e.data)}}},{key:"start",value:function(){return!!this.recorder&&"inactive"===this.recorder.state&&(this.blobPromise.createPromise(),this.recorder.start(),this.timer.start(),this.onStartFunction(),!0)}},{key:"resume",value:function(){return!!this.recorder&&"paused"===this.recorder.state&&(this.recorder.resume(),this.timer.resume(),!0)}},{key:"pause",value:function(){return!!this.recorder&&"recording"===this.recorder.state&&(this.recorder.pause(),this.timer.pause(),!0)}},{key:"stop",value:function(){return!!this.recorder&&"inactive"!==this.recorder.state&&(this.recorder.stop(),this.timer.stop(),!0)}},{key:"getRecord",value:(i=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){tE(o,r,i,a,s,"next",e)}function s(e){tE(o,r,i,a,s,"throw",e)}a(void 0)}))}}(eE().mark((function e(){var t;return eE().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("inactive"===this.recorder.state){e.next=2;break}throw"[ recorder ]: Cannot get blob. First you need to stop the record.";case 2:return e.next=4,this.blobPromise.promise;case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.next=9,XT()(t,this.timer.duration,{logger:!1});case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setVideoTrack",value:function(e){e&&(this.removeTracks("video"),this.stream||(this.stream=new MediaStream),this.stream.addTrack(e),this.initRecorder(this.stream))}},{key:"setSDKVideoTrack",value:function(e){this.sdkVideoTrack=e,this.setVideoTrack(e)}},{key:"setAudioTracks",value:function(e){if(0!==e.length){if(this.removeTracks("audio"),this.stream||(this.stream=new MediaStream),1===e.length)return this.stream.addTrack(e[0]),void this.initRecorder(this.stream);var t=new AudioContext,n=t.createMediaStreamDestination();e.forEach((function(e){var r=new MediaStream;r.addTrack(e),t.createMediaStreamSource(r).connect(n)}));var r=n.stream;this.stream.addTrack(r.getAudioTracks()[0]),this.initRecorder(this.stream)}}},{key:"setMimeType",value:function(e){MediaRecorder.isTypeSupported(e)?(this.mimeType=e,this.recorder&&this.stream&&this.initRecorder(this.stream)):r.ie.notify({message:"mimeType ".concat(e," is not supported."),emitter:r.E7.RECORDER})}},{key:"onStart",value:function(e){"function"==typeof e&&(this.onStartFunction=e)}},{key:"isActive",value:function(){var e,t;return"recording"===(null===(e=this.recorder)||void 0===e?void 0:e.state)||"paused"===(null===(t=this.recorder)||void 0===t?void 0:t.state)}},{key:"getDuration",value:function(){return this.timer.duration}},{key:"getSDKTracks",value:function(){return{sdkAudioTrack:this.sdkAudioTrack,sdkVideoTrack:this.sdkVideoTrack}}}],n&&nE(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function aE(e){return aE="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},aE(e)}function sE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uE(r.key),r)}}function uE(e){var t=function(e){if("object"!=aE(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=aE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==aE(t)?t:String(t)}function cE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(cE=function(){return!!e})()}function lE(e){return lE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lE(e)}function hE(e,t){return hE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hE(e,t)}oE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":iE(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([(0,Ck.cB)("recorder"),function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":iE(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[])],oE);var fE=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=lE(t),function(e,t){if(t&&("object"===aE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cE()?Reflect.construct(t,n||[],lE(e).constructor):t.apply(e,n))}(this,t)).width=1280,e.height=720,e.customWidth=1280,e.customHeight=720,e.customSize=!1,e}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hE(e,t)}(t,e),n=t,(r=[{key:"setSize",value:function(e,t){var n=!1;this.width!=e&&(this.width=e,n=!0),this.height!=t&&(this.height=t,n=!0),n&&this.emit("update",this)}},{key:"setCustomSize",value:function(e,t){this.customSize=!0,this.setSize(e,t)}},{key:"isCustomSize",value:function(){return this.customSize}},{key:"isLandscape",value:function(){return this.getAspect()>1}},{key:"getAspect",value:function(){return this.width/this.height}}])&&sE(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(i);function dE(e){return dE="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},dE(e)}function pE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yE(r.key),r)}}function yE(e){var t=function(e){if("object"!=dE(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=dE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==dE(t)?t:String(t)}function gE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gE=function(){return!!e})()}function mE(e){return mE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mE(e)}function vE(e,t){return vE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},vE(e,t)}var wE=function(e){function t(e){var n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t,n){return t=mE(t),function(e,t){if(t&&("object"===dE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,gE()?Reflect.construct(t,n||[],mE(e).constructor):t.apply(e,n))}(this,t,[void 0,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 uStep;\nuniform float uSharpnessPower;\n\nconst float FSR_RCAS_LIMIT = 0.25 - 1.0 / 16.0;\n\nfloat calcLuma(vec3 texel) {\n  float luma = texel.b * 0.5 + (texel.r * 0.5 + texel.g);\n  return luma;\n}\n\nvec3 min4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 min_ab = min(a, b);\n  vec3 min_cd = min(c, d);\n\n  return min(min_ab, min_cd);\n}\n\nvec3 max4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 max_ab = max(a, b);\n  vec3 max_cd = max(c, d);\n\n  return max(max_ab, max_cd);\n}\n\nfloat max3_float(float a, float b, float c) {\n  float max_ab = max(a, b);\n\n  return max(max_ab, c);\n}\n\nfloat max5_float(float a, float b, float c, float d, float e) {\n  float max_ab = max(a, b);\n  float max_cd = max(c, d);\n  float max_ab_cd = max(max_ab, max_cd);\n\n  return max(max_ab_cd, e);\n}\n\nfloat min5_float(float a, float b, float c, float d, float e) {\n  float min_ab = min(a, b);\n  float min_cd = min(c, d);\n  float min_ab_cd = min(min_ab, min_cd);\n\n  return min(min_ab_cd, e);\n}\n\nfloat saturate(float val) {\n  return min(1.0, max(0.0, val));\n}\n\nfloat rcp(float val) {\n  return 1.0 / val;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n  // Algorithm uses minimal 3x3 pixel neighborhood.\n  //    b\n  //  d e f\n  //    h\n\n  vec3 e_texel = color.rgb;\n  vec3 b_texel = texture2D(uSampler, vTextureCoord + vec2(0, -uStep.y)).rgb;\n  vec3 h_texel = texture2D(uSampler, vTextureCoord + vec2(0, +uStep.y)).rgb;\n  vec3 d_texel = texture2D(uSampler, vTextureCoord + vec2(-uStep.x, 0)).rgb;\n  vec3 f_texel = texture2D(uSampler, vTextureCoord + vec2(+uStep.x, 0)).rgb;\n\n  float e_luma = calcLuma(e_texel);\n  float b_luma = calcLuma(b_texel);\n  float h_luma = calcLuma(h_texel);\n  float d_luma = calcLuma(d_texel);\n  float f_luma = calcLuma(f_texel);\n\n  // Min and max of ring.\n  vec3 min_ring = min4_vec3(b_texel, h_texel, d_texel, f_texel);\n  vec3 max_ring = max4_vec3(b_texel, h_texel, d_texel, f_texel);\n  // Immediate constants for peak range.\n  vec2 peakC = vec2(1.0, 1.0 * 4.0);\n  // Limiters, these need to be high precision RCPs.\n  vec3 hit_min = min_ring / (4.0 * max_ring);\n  vec3 hit_max = (1.0 - max_ring) / (4.0 * min_ring - peakC.y);\n  vec3 lobeC = max(-hit_min, hit_max);\n\n  float max_lobeC = max3_float(lobeC.r, lobeC.g, lobeC.b);\n  float lobe = max(-FSR_RCAS_LIMIT, min(max_lobeC, 0.0)) * uSharpnessPower;\n\n  // Noise detection.\n  float noise = 0.25 * b_luma + 0.25 * d_luma + 0.25 * f_luma + 0.25 * h_luma - e_luma;\n  float max_luma = max5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  float min_luma = min5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  noise = saturate(abs(noise) * rcp(max_luma - min_luma));\n  noise = -0.5 * noise + 1.0;\n  lobe = lobe * noise;\n\n  vec3 result = (lobe * (b_texel + d_texel + h_texel + f_texel) + e_texel) / (4.0 * lobe + 1.0);\n\n  gl_FragColor = vec4(result, color.a);\n}\n"]),e.outputResolution&&n.setOutputResolution(e.outputResolution),n.setPower(null!==(r=e.power)&&void 0!==r?r:0),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vE(e,t)}(t,e),n=t,(r=[{key:"setOutputResolution",value:function(e){var t=1/(e.width-1),n=1/(e.height-1);this.uniforms.uStep=[t,n]}},{key:"setPower",value:function(e){e=Math.max(0,e),e=Math.min(1,e),this.uniforms.uSharpnessPower=.3*e+1}}])&&pE(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(pr);function bE(e){return bE="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},bE(e)}function xE(){xE=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==bE(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(bE(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function _E(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function IE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,AE(r.key),r)}}function AE(e){var t=function(e){if("object"!=bE(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=bE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==bE(t)?t:String(t)}function CE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(CE=function(){return!!e})()}function kE(e){return kE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kE(e)}function SE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TE(e,t){return TE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},TE(e,t)}var EE,OE=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},PE=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t,n){return t=kE(t),function(e,t){if(t&&("object"===bE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return SE(e)}(e,CE()?Reflect.construct(t,n||[],kE(e).constructor):t.apply(e,n))}(this,t,[e]),EE.set(SE(n),void 0),n.config={power:0},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TE(e,t)}(t,e),n=t,r=[{key:"prepare",value:function(){var e=this.resources.texture,t=this.sdkOptions,n=t.width,r=t.height;(function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?i.call(e,n):i?i.value=n:t.set(e,n)})(this,EE,new qc(e,{width:n,height:r}),"f"),OE(this,EE,"f").addBuffer("result"),this.filterSharpness=new wE({outputResolution:{height:r,width:n}}),OE(this,EE,"f").frame.filters=[this.filterSharpness],this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){var e=this.sdkOptions,t=e.width,n=e.height;OE(this,EE,"f").resize(t,n),this.filterSharpness.setOutputResolution({height:n,width:t})}},{key:"process",value:(i=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){_E(o,r,i,a,s,"next",e)}function s(e){_E(o,r,i,a,s,"throw",e)}a(void 0)}))}}(xE().mark((function e(){return xE().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDisabled){e.next=2;break}return e.abrupt("return");case 2:this.resources.renderer.renderTo(OE(this,EE,"f").frame,OE(this,EE,"f").getBuffer("result")),this.resources.texture.update(OE(this,EE,"f").getBuffer("result"),!1);case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setConfig",value:function(e){this.setPower(e.power)}},{key:"setPower",value:function(e){void 0!==e&&(this.config.power=e,this.filterSharpness.setPower(e))}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],r&&IE(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(O_);function RE(){RE=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new O(r||[]);return i(a,"_invoke",{value:k(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",g={};function m(){}function v(){}function w(){}var b={};c(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(P([])));_&&_!==n&&r.call(_,a)&&(b=_);var I=w.prototype=m.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==FE(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,n,r){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?y:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function S(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(FE(t)+" is not iterable")}return v.prototype=w,i(I,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},A(C.prototype),c(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new C(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(I),c(I,u,"Generator"),c(I,a,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function BE(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function DE(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){BE(o,r,i,a,s,"next",e)}function s(e){BE(o,r,i,a,s,"throw",e)}a(void 0)}))}}function ME(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,LE(r.key),r)}}function LE(e){var t=function(e){if("object"!=FE(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=FE(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==FE(t)?t:String(t)}function FE(e){return FE="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},FE(e)}EE=new WeakMap;var NE,UE=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},jE=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.outputFrameFormat="RGBX",this.components=new Proxy({},Ak),NE.set(this,void 0),this.customer_id=t,lx.M.CUSTOMER_ID=t,lx.M.setVersion(),hx.i.getInstance().getUID(this.customer_id),Ck.k7.Instance.setCustomerID(this.customer_id),n&&(this.custom_inference=zx.getInference("custom"),this.custom_inference.setBackend(n)),this.onnx_inference=zx.getInference("onnx"),this.sdkOptions=new fE,this.recorder=new oE,this.callbackStore=new $T,this.colorFilterEffect=new uI(this.sdkOptions),this.customResolutionEffect=new vk(this.sdkOptions),this.sharpnessEffect=new PE(this.sdkOptions),this.sdkOptions.on("update",this.onOptionsUpdate,this)}var t,n,i,o,a,s;return t=e,n=[{key:"onOptionsUpdate",value:function(e){Object.values(this.components).forEach((function(e){return e.render()})),this.virtualBackgroundEffect&&this.setSegmentationPreset(this.virtualBackgroundEffect.settings.preset)}},{key:"cache",value:(s=DE(RE().mark((function e(){var t,n,r=arguments;return RE().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],n=!1,this.custom_inference&&(n=!0),e.abrupt("return",this.onnx_inference.cache(t,n));case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"preload",value:(a=DE(RE().mark((function e(){var t;return RE().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,this.custom_inference&&(t=!0),e.abrupt("return",this.onnx_inference.preload(t));case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"config",value:function(e){e.hasOwnProperty("app_env")&&(lx.M.APP_ENV=e.app_env),e.hasOwnProperty("api_url")&&(lx.M.API_URL=e.api_url),e.hasOwnProperty("model_url")&&(lx.M.MODEL_URL=e.model_url),e.hasOwnProperty("sdk_url")&&(lx.M.SDK_URL=e.sdk_url),e.hasOwnProperty("provider")&&(lx.M.PROVIDER=e.provider),e.hasOwnProperty("preset")&&(lx.M.PRESET=e.preset),e.hasOwnProperty("proxy")&&(lx.M.PROXY=e.proxy),e.hasOwnProperty("stats")&&(lx.M.STATS=e.stats),e.hasOwnProperty("wasmPaths")&&Object.keys(e.wasmPaths).length&&(lx.M.WASM_PATHS=Object.assign(lx.M.WASM_PATHS,e.wasmPaths)),e.hasOwnProperty("presets")&&Object.keys(e.presets).length&&(lx.M.PRESETS=Object.assign(lx.M.PRESETS,e.presets)),e.hasOwnProperty("models")&&Object.keys(e.models).length&&(lx.M.MODELS=Object.assign(lx.M.MODELS,e.models))}},{key:"init",value:(o=DE(RE().mark((function e(t){var n,i,o,a=this;return RE().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.aborted){e.next=2;break}return e.abrupt("return");case 2:if(this.streamProcessor&&(this.streamProcessor.destroy(),this.effectProcessor.destroy(),delete this.streamProcessor,delete this.effectProcessor),i="requestAnimationFrameCallback","MediaStreamTrackProcessor"in window&&"MediaStreamTrackGenerator"in window?(this.streamProcessor=Ah.getStreamProcessor("transform",this.sdkOptions),i="MediaStreamTrackProcessor"):"requestVideoFrameCallback"in HTMLVideoElement.prototype?(this.streamProcessor=Ah.getStreamProcessor("videocallback",this.sdkOptions),i="requestVideoFrameCallback"):this.streamProcessor=Ah.getStreamProcessor("animationcallback",this.sdkOptions),r.ie.notify({message:"".concat(i," supported"),type:r.cL.INFO,emitter:r.E7.TSVB}),this.streamProcessor.onFrameDraw(this.callbackStore.getCallback("onFrameDraw")),this.streamProcessor.onChangeInputResolution(this.callbackStore.getCallback("onChangeInputResolution")),o=new g_(this.sdkOptions,this.outputFrameFormat),this.streamProcessor.setRenderer(o),this.effectProcessor=new P_(o,this.components),t.aborted||this.effectProcessor.addEffect(this.customResolutionEffect),!lx.M.MODELS.lowlighter||""===lx.M.MODELS.lowlighter){e.next=16;break}return this.lowLightEffect=new mC(this.sdkOptions,this.customer_id),e.next=16,this.lowLightEffect.init(this.onnx_inference).then((function(){if(!t.aborted){a.effectProcessor.addEffect(a.lowLightEffect);var e=a.callbackStore.getCallback("onLowLightSuccess");a.lowLightEffect.onSuccess(e)}})).catch((function(){}));case 16:if(t.aborted||this.effectProcessor.addEffect(this.colorFilterEffect),t.aborted||this.effectProcessor.addEffect(this.sharpnessEffect),!lx.M.MODELS.colorcorrector||""===lx.M.MODELS.colorcorrector){e.next=22;break}return this.colorCorrectorEffect=new FC(this.sdkOptions,this.customer_id),e.next=22,this.colorCorrectorEffect.init(this.onnx_inference).then((function(){t.aborted||a.effectProcessor.addEffect(a.colorCorrectorEffect)})).catch((function(){}));case 22:if(!lx.M.MODELS.facedetector||""===lx.M.MODELS.facedetector){e.next=26;break}return this.smartZoomEffect=new ck(this.sdkOptions,this.customer_id),e.next=26,this.smartZoomEffect.init(this.onnx_inference).then((function(){t.aborted||a.effectProcessor.addEffect(a.smartZoomEffect)})).catch((function(){}));case 26:return this.virtualBackgroundEffect=new OA(this.sdkOptions,this.customer_id),e.next=29,this.virtualBackgroundEffect.init(null!==(n=this.custom_inference)&&void 0!==n?n:this.onnx_inference).then((function(){t.aborted||a.effectProcessor.addEffect(a.virtualBackgroundEffect)})).catch((function(){}));case 29:this.streamProcessor.useEffectProcessor(this.effectProcessor),this.callbackStore.call("onReady");case 31:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getCustomerId",value:function(){return this.customer_id}},{key:"useStream",value:function(e,t){var n;if(e.getVideoTracks().length){var i=e.getVideoTracks()[0].getSettings();if(t?this.sdkOptions.setCustomSize(t.width,t.height):this.sdkOptions.setSize(i.width,i.height),Object.values(this.components).forEach((function(e){return e.render()})),UE(this,NE,"f")&&UE(this,NE,"f").abort(),function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?i.call(e,n):i?i.value=n:t.set(e,n)}(this,NE,new AbortController,"f"),this.init(UE(this,NE,"f").signal),this.streamProcessor.useStream(e),this.streamProcessor.getInputVideoTrack()){this.streamProcessor.process();var o=null===(n=this.streamProcessor.getStream())||void 0===n?void 0:n.getVideoTracks()[0];o&&this.recorder.setSDKVideoTrack(o)}else r.ie.notify({message:"There is no input videoTrack to process",emitter:r.E7.TSVB})}else r.ie.notify({message:"There is no input videoTrack in the Media Stream",emitter:r.E7.TSVB})}},{key:"setSegmentationPreset",value:(i=DE(RE().mark((function e(t){var n;return RE().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.virtualBackgroundEffect){e.next=2;break}return e.abrupt("return",!1);case 2:if(!this.onnx_inference.isGPU||["quality","balanced"].includes(t)){e.next=5;break}return r.ie.notify({message:"WebGPU backend support only quality and balanced presets",emitter:r.E7.TSVB}),e.abrupt("return",!1);case 5:return this.effectProcessor.hasFrames?this.effectProcessor.pause():this.streamProcessor.pause(),this.streamProcessor.clearBuffers(),this.streamProcessor.clearBuffers(),e.next=10,this.virtualBackgroundEffect.setPreset(t);case 10:return e.next=12,this.virtualBackgroundEffect.init(null!==(n=this.custom_inference)&&void 0!==n?n:this.onnx_inference);case 12:return this.effectProcessor.hasFrames?this.effectProcessor.unpause():this.streamProcessor.unpause(),e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getSegmentationPreset",value:function(){return this.virtualBackgroundEffect.getPreset()}},{key:"setBackgroundColor",value:function(e){this.virtualBackgroundEffect.setBackgroundColor(e)}},{key:"getStream",value:function(){return this.streamProcessor.getStream()}},{key:"toCanvas",value:function(e){this.streamProcessor.renderToCanvas(e)}},{key:"setFpsLimit",value:function(e){return!!this.streamProcessor&&(this.streamProcessor.setFpsLimit(e),!0)}},{key:"showFps",value:function(){return!!this.streamProcessor&&(this.streamProcessor.showFps(),!0)}},{key:"hideFps",value:function(){return!!this.streamProcessor&&(this.streamProcessor.hideFps(),!0)}},{key:"freeze",value:function(){return!!this.effectProcessor&&(this.effectProcessor.pause(),!0)}},{key:"unfreeze",value:function(){return!!this.effectProcessor&&(this.effectProcessor.unpause(),!0)}},{key:"enableBeautification",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.enableBeautification(),!0)}},{key:"disableBeautification",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.disableBeautification(),!0)}},{key:"setBoundaryMode",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBoundaryMode(e),!0)}},{key:"setBackgroundFitMode",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBackgroundFitMode(e),!0)}},{key:"setBoundaryLevel",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBoundaryLevel(e),!0)}},{key:"setBeautificationLevel",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBeautificationLevel(e),!0)}},{key:"setBlur",value:function(e){if(!this.virtualBackgroundEffect)return!1;var t=15*Math.cbrt(this.sdkOptions.height*this.sdkOptions.width)/67;return this.virtualBackgroundEffect.setBlur(Math.round(e*t)),!0}},{key:"clearBlur",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.clearBlur(),!0)}},{key:"setBackground",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBackground(e),!0)}},{key:"clearBackground",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.clearBackground(),!0)}},{key:"enableFrameSkipping",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.enableFrameSkipping(),!0)}},{key:"disableFrameSkipping",value:function(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.disableFrameSkipping(),!0)}},{key:"setLayout",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setLayout(e),!0)}},{key:"setLayoutMode",value:function(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setLayoutMode(e),!0)}},{key:"setCustomLayout",value:function(e){if(!this.virtualBackgroundEffect)return!1;var t={};return void 0!==e.xOffset&&(t.xOffset=e.xOffset*this.sdkOptions.width),void 0!==e.yOffset&&(t.yOffset=e.yOffset*this.sdkOptions.height),void 0!==e.size&&(t.width=e.size*this.sdkOptions.width,t.height=e.size*this.sdkOptions.height),this.virtualBackgroundEffect.setCustomLayout(t),!0}},{key:"setFaceArea",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,.01),e=Math.min(e,1),this.smartZoomEffect.setConfig("faceAreaProportion",e),!0)}},{key:"setFaceDetectorAccuracy",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,.2),e=Math.min(e,1),this.smartZoomEffect.setConfig("faceDetectorAccuracy",e),!0)}},{key:"setSmartZoomSmoothing",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,.01),e=Math.min(e,1),this.smartZoomEffect.setConfig("smoothPower",100*e),!0)}},{key:"setSmartZoomSensitivity",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,0),e=Math.min(e,1),this.smartZoomEffect.setConfig("sensitivityValue",e),!0)}},{key:"setSmartZoomPerod",value:function(e){return!!this.smartZoomEffect&&(e=Math.max(e,0),e=Math.min(e,1e3),this.smartZoomEffect.setConfig("faceDetectorPediod_ms",e),!0)}},{key:"switchDrawFaceSquare",value:function(e){return!!this.smartZoomEffect&&(this.smartZoomEffect.setConfig("isFaceSquareDrawingEnabled",e),!0)}},{key:"switchDrawPreFaceSquare",value:function(e){return!!this.smartZoomEffect&&(this.smartZoomEffect.setConfig("isPreFaceSquareDrawingEnabled",e),!0)}},{key:"enableSmartZoom",value:function(){return!!this.smartZoomEffect&&(this.smartZoomEffect.enable(),!0)}},{key:"disableSmartZoom",value:function(){return!!this.smartZoomEffect&&(this.smartZoomEffect.disable(),!0)}},{key:"enableColorCorrector",value:function(){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.enable(),!0)}},{key:"disableColorCorrector",value:function(){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.disable(),!0)}},{key:"enableColorFilter",value:function(){return!!this.colorFilterEffect&&(this.colorFilterEffect.enable(),!0)}},{key:"disableColorFilter",value:function(){return!!this.colorFilterEffect&&(this.colorFilterEffect.disable(),!0)}},{key:"setColorFilterConfig",value:function(e){return!!this.colorFilterEffect&&(this.colorFilterEffect.setConfig(e),!0)}},{key:"setFilterPart",value:function(e){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.setConfig("filterPart",e),!0)}},{key:"setColorCorrectorPeriod",value:function(e){return!!this.colorCorrectorEffect&&(e=Math.max(e,0),e=Math.min(e,5e3),this.colorCorrectorEffect.setConfig("modelPediod_ms",e),!0)}},{key:"setColorCorrectorPower",value:function(e){return!!this.colorCorrectorEffect&&(e=Math.max(e,0),e=Math.min(e,1),this.colorCorrectorEffect.setConfig("cc_power",e),!0)}},{key:"enableLowLightEffect",value:function(){return!!this.lowLightEffect&&(this.lowLightEffect.enable(),!0)}},{key:"disableLowLightEffect",value:function(){return!!this.lowLightEffect&&(this.lowLightEffect.disable(),!0)}},{key:"setLowLightEffectConfig",value:function(e){return!!this.lowLightEffect&&(this.lowLightEffect.setConfig(e),!0)}},{key:"setLowLightEffectPower",value:function(e){return this.setLowLightEffectConfig({power:e}),!0}},{key:"enableSharpnessEffect",value:function(){return!!this.sharpnessEffect&&(this.sharpnessEffect.enable(),!0)}},{key:"disableSharpnessEffect",value:function(){return!!this.sharpnessEffect&&(this.sharpnessEffect.disable(),!0)}},{key:"setSharpnessEffectConfig",value:function(e){return!!this.sharpnessEffect&&(this.sharpnessEffect.setConfig(e),!0)}},{key:"clear",value:function(){return!!this.streamProcessor&&(this.streamProcessor.destroy(),!0)}},{key:"run",value:function(){return this.streamProcessor&&(this.streamProcessor.isRunning=!0),!0}},{key:"stop",value:function(){return this.streamProcessor&&(this.streamProcessor.isRunning=!1),!0}},{key:"enablePipelineSkipping",value:function(){var e;null===(e=this.effectProcessor)||void 0===e||e.enablePipelineSkipping()}},{key:"disablePipelineSkipping",value:function(){var e;null===(e=this.effectProcessor)||void 0===e||e.disablePipelineSkipping()}},{key:"getEffectProcessor",value:function(){return this.effectProcessor}},{key:"createComponent",value:function(e){return new GE[e.component](this.sdkOptions,e.options)}},{key:"addComponent",value:function(e,t){this.components[t]=e}},{key:"getComponentConstructor",value:function(e){return GE[e]}},{key:"setOutputResolution",value:function(e){this.streamProcessor&&this.streamProcessor.setOutputResolution(e.width,e.height)}},{key:"clearOutputResolution",value:function(){this.streamProcessor&&this.streamProcessor.clearOutputResolution()}},{key:"setOutputFrameFormat",value:function(e){this.outputFrameFormat=e}},{key:"onReady",set:function(e){this.callbackStore.setCallback("onReady",e)}},{key:"onError",value:function(e){r.ie.subscribe(e)}},{key:"onFrame",set:function(e){var t;this.callbackStore.setCallback("onFrameDraw",e),null===(t=this.streamProcessor)||void 0===t||t.onFrameDraw(e)}},{key:"onChangeInputResolution",value:function(e){var t;this.callbackStore.setCallback("onChangeInputResolution",e),null===(t=this.streamProcessor)||void 0===t||t.onChangeInputResolution(e)}},{key:"onAuthRequest",value:function(e){this.onnx_inference&&this.onnx_inference.onAuth(e)}},{key:"onColorFilterSuccess",value:function(e){this.callbackStore.setCallback("onColorFilterSuccess",e),this.colorFilterEffect.onSuccess(e)}},{key:"onLowLightSuccess",value:function(e){var t;this.callbackStore.setCallback("onLowLightSuccess",e),null===(t=this.lowLightEffect)||void 0===t||t.onSuccess(e)}}],n&&ME(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();NE=new WeakMap,jE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":FE(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([(0,Ck.cB)("tsvb"),function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":FE(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[String,Object])],jE);var GE={overlay_screen:zk,watermark:aS,lowerthird_1:KS,lowerthird_2:oT,lowerthird_3:gT,lowerthird_4:ST,lowerthird_5:zT,stickers:AS}}();var __webpack_exports__tsvb=exports.tsvb=__nested_webpack_exports__.O}}]);
//# sourceMappingURL=767.1251ba93.chunk.js.map